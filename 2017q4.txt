From mashranga at yahoo.com  Sun Oct  1 18:42:10 2017
From: mashranga at yahoo.com (Mohammad Tanvir Ahamed)
Date: Sun, 1 Oct 2017 16:42:10 +0000 (UTC)
Subject: Category (Subjection) in R documentation for package
References: <591525589.654408.1506876130041.ref@mail.yahoo.com>
Message-ID: <591525589.654408.1506876130041@mail.yahoo.com>

Hi,?
I am building package R-studio (Roxygen2).
In the package function documentation, now the standard format is to show all function name.

Now I want to categorize those function under some section/heading.
Can any one please hey me regarding this issue?
Is there any way or idea how one can do it ?



Regards.............Tanvir Ahamed 
Stockholm, Sweden???? |??mashranga at yahoo.com 
	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Sun Oct  1 20:50:19 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 1 Oct 2017 14:50:19 -0400
Subject: [R-pkg-devel] Category (Subjection) in R documentation for
 package
In-Reply-To: <mailman.265.1506876160.1577.r-package-devel@r-project.org>
References: <591525589.654408.1506876130041.ref@mail.yahoo.com>
 <mailman.265.1506876160.1577.r-package-devel@r-project.org>
Message-ID: <497bcbc1-f93e-a884-2afb-2d66878738f2@gmail.com>

On 01/10/2017 12:42 PM, Mohammad Tanvir Ahamed via R-package-devel wrote:
> I am building package R-studio (Roxygen2).
> In the package function documentation, now the standard format is to show all function name.
> 
> Now I want to categorize those function under some section/heading.
> Can any one please hey me regarding this issue?
> Is there any way or idea how one can do it ?


I don't know how to do this with Roxygen2, but what you want to get is a 
package help page (typically yourpackage-package.Rd with 
\alias{yourpackage-package}, and maybe also \alias{yourpackage}).  On 
that page you can have sections using

\section{section_title}{
    some content
}

The "some content" can be a list of links to your help topics using 
\itemize, \enumerate, or \tabular.  See the built-in manual "Writing R 
Extensions", and presumably some Roxygen2 documentation to tell you how 
to let all of this get through to the .Rd file.

Duncan Murdoch


From davidhughjones at gmail.com  Mon Oct  2 09:59:05 2017
From: davidhughjones at gmail.com (David Hugh-Jones)
Date: Mon, 2 Oct 2017 08:59:05 +0100
Subject: [R-pkg-devel] Category (Subjection) in R documentation for
	package
In-Reply-To: <497bcbc1-f93e-a884-2afb-2d66878738f2@gmail.com>
References: <591525589.654408.1506876130041.ref@mail.yahoo.com>
 <mailman.265.1506876160.1577.r-package-devel@r-project.org>
 <497bcbc1-f93e-a884-2afb-2d66878738f2@gmail.com>
Message-ID: <CAARY7kiBMxfvZLRjMpH04E6U8CBU49TdL_+nbVecgY8SQ6UuAw@mail.gmail.com>

In roxygen2 you do

@section Section name:

The colon is important.

David

On 1 October 2017 at 19:50, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:

> On 01/10/2017 12:42 PM, Mohammad Tanvir Ahamed via R-package-devel wrote:
>
>> I am building package R-studio (Roxygen2).
>> In the package function documentation, now the standard format is to show
>> all function name.
>>
>> Now I want to categorize those function under some section/heading.
>> Can any one please hey me regarding this issue?
>> Is there any way or idea how one can do it ?
>>
>
>
> I don't know how to do this with Roxygen2, but what you want to get is a
> package help page (typically yourpackage-package.Rd with
> \alias{yourpackage-package}, and maybe also \alias{yourpackage}).  On that
> page you can have sections using
>
> \section{section_title}{
>    some content
> }
>
> The "some content" can be a list of links to your help topics using
> \itemize, \enumerate, or \tabular.  See the built-in manual "Writing R
> Extensions", and presumably some Roxygen2 documentation to tell you how to
> let all of this get through to the .Rd file.
>
> Duncan Murdoch
>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From anh25 at cam.ac.uk  Mon Oct  2 08:23:50 2017
From: anh25 at cam.ac.uk (Andrew Holding)
Date: Mon, 02 Oct 2017 06:23:50 +0000
Subject: [R-pkg-devel] Confusion over CRAN build error for package Brundle
Message-ID: <CAMkS--agCmJ7KcN2Y81oRhiXTEoRiAJQryfb7=gSc6yU-6VLNw@mail.gmail.com>

Forgive me for possibly being naive. I have run the current version of my

package, Brundle,  through the test systems on win-builder, and the
development and stable tests both pass. The package builds on my desktop
(MacOS) still runs fine.

Yet for the last two days I the package has caused warnings from CRAN.

https://cran.r-project.org/web/checks/check_results_Brundle.html

>From the logs it appears to me that several of the errors are due missing
BioConductor package.

e.g.  Packages required but not available: ?DiffBind? ?Rsamtools? ?DESeq2?

Am I missing something obvious? I understood that the test environment
included these packages.

-- 
Dr Andrew Holding
Fellow of Biochemistry / Senior Research Associate
Downing College / Cancer Research UK Cambridge Institute
CRUK CI: 01223 769696
Mobile: 07595 666459

	[[alternative HTML version deleted]]


From mashranga at yahoo.com  Mon Oct  2 14:10:02 2017
From: mashranga at yahoo.com (Mohammad Tanvir Ahamed)
Date: Mon, 2 Oct 2017 12:10:02 +0000 (UTC)
Subject: [R-pkg-devel] Category (Subjection) in R documentation for package
In-Reply-To: <CAARY7kiBMxfvZLRjMpH04E6U8CBU49TdL_+nbVecgY8SQ6UuAw@mail.gmail.com>
References: <591525589.654408.1506876130041.ref@mail.yahoo.com>
 <mailman.265.1506876160.1577.r-package-devel@r-project.org>
 <497bcbc1-f93e-a884-2afb-2d66878738f2@gmail.com>
 <CAARY7kiBMxfvZLRjMpH04E6U8CBU49TdL_+nbVecgY8SQ6UuAw@mail.gmail.com>
Message-ID: <349711733.1053854.1506946202716@mail.yahoo.com>

Thanks.?
But @section makes some section in individual functions help file.? But I am in interested to add section in main index file of the package.?
This is more or less like sort functions by alphabetic order on the main help index of the package. But here I want to add section by my own, not with alphabetic order.? ?

Regards.............
Tanvir Ahamed 
Stockholm, Sweden???? |??mashranga at yahoo.com 




 
 
 On Monday, October 2, 2017, 9:59:06 AM GMT+2, David Hugh-Jones <davidhughjones at gmail.com> wrote: 





In roxygen2 you do

@section Section name:

The colon is important.

David

On 1 October 2017 at 19:50, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> On 01/10/2017 12:42 PM, Mohammad Tanvir Ahamed via R-package-devel wrote:
> 
>>??I am building package R-studio (Roxygen2).
>> In the package function documentation, now the standard format is to show all function name.
>> 
>> Now I want to categorize those function under some section/heading.
>> Can any one please hey me regarding this issue?
>> Is there any way or idea how one can do it ?
>> 
> 
> 
> I don't know how to do this with Roxygen2, but what you want to get is a package help page (typically yourpackage-package.Rd with \alias{yourpackage-package}, and maybe also \alias{yourpackage}).? On that page you can have sections using
> 
> \section{section_title}{
> ? ?some content
> }
> 
> The "some content" can be a list of links to your help topics using \itemize, \enumerate, or \tabular.? See the built-in manual "Writing R Extensions", and presumably some Roxygen2 documentation to tell you how to let all of this get through to the .Rd file.Duncan Murdoch
> 
> 
> ______________________________ ________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/l istinfo/r-package-devel
> 



	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Mon Oct  2 14:16:12 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 2 Oct 2017 14:16:12 +0200
Subject: [R-pkg-devel] Confusion over CRAN build error for package
	Brundle
In-Reply-To: <CAMkS--agCmJ7KcN2Y81oRhiXTEoRiAJQryfb7=gSc6yU-6VLNw@mail.gmail.com>
References: <CAMkS--agCmJ7KcN2Y81oRhiXTEoRiAJQryfb7=gSc6yU-6VLNw@mail.gmail.com>
Message-ID: <4ada9efb-c488-7bf6-d74e-3f6d1a5a1472@statistik.tu-dortmund.de>



On 02.10.2017 08:23, Andrew Holding wrote:
> Forgive me for possibly being naive. I have run the current version of my
> 
> package, Brundle,  through the test systems on win-builder, and the
> development and stable tests both pass. The package builds on my desktop
> (MacOS) still runs fine.
> 
> Yet for the last two days I the package has caused warnings from CRAN.
> 
> https://cran.r-project.org/web/checks/check_results_Brundle.html
> 
>  From the logs it appears to me that several of the errors are due missing
> BioConductor package.
> 
> e.g.  Packages required but not available: ?DiffBind? ?Rsamtools? ?DESeq2?
> 
> Am I missing something obvious? I understood that the test environment
> included these packages.
> 

The problem with missing BioC dependencies can be ignored as well as the 
R-devel Windows error. THe latter will be auto-resolved, the BioC stuff 
depends on the fact that CRAN upgraded to BioC 3.6 which is in 
development and will be released before R-devel, hence we check against 
it, but it is rather instable and sometimes we cannot intsall the BioC 
packagess yet.

Best,
Uwe Ligges


From anh25 at cam.ac.uk  Mon Oct  2 16:46:58 2017
From: anh25 at cam.ac.uk (Andrew Holding)
Date: Mon, 02 Oct 2017 14:46:58 +0000
Subject: [R-pkg-devel] Confusion over CRAN build error for package
	Brundle
In-Reply-To: <4ada9efb-c488-7bf6-d74e-3f6d1a5a1472@statistik.tu-dortmund.de>
References: <CAMkS--agCmJ7KcN2Y81oRhiXTEoRiAJQryfb7=gSc6yU-6VLNw@mail.gmail.com>
 <4ada9efb-c488-7bf6-d74e-3f6d1a5a1472@statistik.tu-dortmund.de>
Message-ID: <CAMkS--YjHWYWDGKTNstsmJb3Lp5O3mYqHVvZeoL8EhCQ4Dud2Q@mail.gmail.com>

Dear Uwe,

Thanks for your response.

Andy

On Mon, 2 Oct 2017 at 13:16 Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

>
>
> On 02.10.2017 08:23, Andrew Holding wrote:
> > Forgive me for possibly being naive. I have run the current version of my
> >
> > package, Brundle,  through the test systems on win-builder, and the
> > development and stable tests both pass. The package builds on my desktop
> > (MacOS) still runs fine.
> >
> > Yet for the last two days I the package has caused warnings from CRAN.
> >
> > https://cran.r-project.org/web/checks/check_results_Brundle.html
> >
> >  From the logs it appears to me that several of the errors are due
> missing
> > BioConductor package.
> >
> > e.g.  Packages required but not available: ?DiffBind? ?Rsamtools?
> ?DESeq2?
> >
> > Am I missing something obvious? I understood that the test environment
> > included these packages.
> >
>
> The problem with missing BioC dependencies can be ignored as well as the
> R-devel Windows error. THe latter will be auto-resolved, the BioC stuff
> depends on the fact that CRAN upgraded to BioC 3.6 which is in
> development and will be released before R-devel, hence we check against
> it, but it is rather instable and sometimes we cannot intsall the BioC
> packagess yet.
>
> Best,
> Uwe Ligges
>
> --
Dr Andrew Holding
Fellow of Biochemistry / Senior Research Associate
Downing College / Cancer Research UK Cambridge Institute
CRUK CI: 01223 769696
Mobile: 07595 666459

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Tue Oct  3 00:01:44 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 2 Oct 2017 18:01:44 -0400
Subject: [R-pkg-devel] Category (Subjection) in R documentation for
 package
In-Reply-To: <349711733.1053854.1506946202716@mail.yahoo.com>
References: <591525589.654408.1506876130041.ref@mail.yahoo.com>
 <mailman.265.1506876160.1577.r-package-devel@r-project.org>
 <497bcbc1-f93e-a884-2afb-2d66878738f2@gmail.com>
 <CAARY7kiBMxfvZLRjMpH04E6U8CBU49TdL_+nbVecgY8SQ6UuAw@mail.gmail.com>
 <349711733.1053854.1506946202716@mail.yahoo.com>
Message-ID: <e694ea0e-1ae7-f79e-e222-c748ea0ed65e@gmail.com>

On 02/10/2017 8:10 AM, Mohammad Tanvir Ahamed wrote:
> Thanks.
> But @section makes some section in individual functions help file. 

No, I said to put it in the package help file, not an individual 
function help file.

  But
> I am in interested to add section in main index file of the package.
> This is more or less like sort functions by alphabetic order on the main 
> help index of the package. But here I want to add section by my own, not 
> with alphabetic order.

There are at least a couple of different locations where a "help index" 
is stored.  One is in the file <...>/html/00Index.html, where <..> is 
the path given by system.file(package="yourpackage").  This file is 
produced automatically when the package is built or installed (I forget 
which), and there's no way to control the formatting at the level you 
want.  So a gross hack would be to replace that file with a file of your 
own choosing, but you would certainly not be allowed to do that if you 
wanted your package to appear on CRAN.

Duncan Murdoch

> 
> Regards.............
> Tanvir Ahamed
> Stockholm, Sweden???? |??mashranga at yahoo.com
> 
> 
> 
> 
> 
> 
> On Monday, October 2, 2017, 9:59:06 AM GMT+2, David Hugh-Jones 
> <davidhughjones at gmail.com> wrote:
> 
> 
> 
> 
> 
> In roxygen2 you do
> 
> @section Section name:
> 
> The colon is important.
> 
> David
> 
> On 1 October 2017 at 19:50, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>  > On 01/10/2017 12:42 PM, Mohammad Tanvir Ahamed via R-package-devel wrote:
>  >
>  >>??I am building package R-studio (Roxygen2).
>  >> In the package function documentation, now the standard format is to 
> show all function name.
>  >>
>  >> Now I want to categorize those function under some section/heading.
>  >> Can any one please hey me regarding this issue?
>  >> Is there any way or idea how one can do it ?
>  >>
>  >
>  >
>  > I don't know how to do this with Roxygen2, but what you want to get 
> is a package help page (typically yourpackage-package.Rd with 
> \alias{yourpackage-package}, and maybe also \alias{yourpackage}).? On 
> that page you can have sections using
>  >
>  > \section{section_title}{
>  > ? ?some content
>  > }
>  >
>  > The "some content" can be a list of links to your help topics using 
> \itemize, \enumerate, or \tabular.? See the built-in manual "Writing R 
> Extensions", and presumably some Roxygen2 documentation to tell you how 
> to let all of this get through to the .Rd file.Duncan Murdoch
>  >
>  >
>  > ______________________________ ________________
>  > R-package-devel at r-project.org mailing list
>  > https://stat.ethz.ch/mailman/l istinfo/r-package-devel
>  >
> 
>


From wdunlap at tibco.com  Wed Oct  4 19:52:08 2017
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 4 Oct 2017 10:52:08 -0700
Subject: [R-pkg-devel] Summary: tibbles are not data frames
In-Reply-To: <ef4a8147-b331-f018-5b82-9fd20700da3c@umu.se>
References: <5839235b-f52f-7942-1168-d99a07036213@umu.se>
 <CABdHhvE1Zeu18h=uL1__79-x3ysS3jmkEPgW5vWsU_CkLmbUyw@mail.gmail.com>
 <ef4a8147-b331-f018-5b82-9fd20700da3c@umu.se>
Message-ID: <CAF8bMcYhEUJowAJV-nami3o9nEBsOq+oX8zr84C815G7q0vUJg@mail.gmail.com>

> However, I learned that I should change things like
> 'dat[5:8, 1]' to 'dat[[1]][5:8]', respecting the fact that a data frame
is a list

In the old days we encouraged the dat[i,j] usage because it worked
on both matrices and data.frames.  Even now, the transformation to
dat[[j]][i] only works when length(j)==1.


Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Fri, Sep 29, 2017 at 2:50 AM, G?ran Brostr?m <goran.brostrom at umu.se>
wrote:

> Dear all,
>
> I got an overwhelming amount of response to my question, and making a
> complete summary is not possible. However, I learned that I should change
> things like 'dat[5:8, 1]' to 'dat[[1]][5:8]',
> respecting the fact that a data frame is a list, in my packages.
> Accidentally, this also solves the problem  of using tibbles where data
> frames are expected. The classes "tbl" and "tbl_df" will be preserved on
> output; no need to use 'as.data.frame', the simple check 'is.data.frame' is
> enough.
>
> Thanks for a very interesting and enlightening discussion! A special
> thanks to Hadley for sharing great packages with us; I could only wish they
> were easier to use in my own packages;)
>
> G?ran
>
> On 2017-09-26 15:37, Hadley Wickham wrote:
>
>> On Tue, Sep 26, 2017 at 2:30 AM, G?ran Brostr?m
>> <goran.brostrom at umu.se> wrote:
>>
>>> I am beginning to get complaints from users of my CRAN packages
>>> (especially 'eha') to the effect that they get error messages like
>>> "Error: Unsupported use of matrix or array for column indexing".
>>>
>>> It turns out that they are sticking in tibbles into functions that
>>> expect data frames as input. And I am using the kind of subsetting
>>> that Hadley dislikes (eha is an old package, much older than
>>> tibbles). It is of course a simple matter to change the code so it
>>> handles both data frames and tibbles correctly, but this affects
>>> many functions, and it will take some time. And when the next guy
>>> introduces 'troubles' as an improvement of 'tibbles', I will have
>>> to rewrite the code again.
>>>
>>
>> Changing df[, x] to df[[x]] is not very hard and makes your code easier
>> to understand because it more clearly conveys the intent that you want a
>> single column.
>>
>> While I like Hadley's way of doing it, I think it is a mistake to
>>> let a tibble also be of class data frame. To me it is a matter of
>>> inheritance and backwards compability: A tibble should add nice
>>> things to a data frame, not change basic behaviour, in order to
>>> call itself a data frame.
>>>
>>> Is it correct to let a tibble be of class "data.frame"?
>>>
>>
>> If it not inherit from data frame, it would be not work with the 99% of
>> functions that work with data frames and don't deliberately take advantage
>> of the dropping behaviour of [. In other words, it would
>> be pointless.
>>
>> I decided to make [.tibble type-stable (i.e. always return a data frame)
>> because this behaviour causes substantial problems in real
>> data analysis code. I did it understanding that it would cause some
>> package developers frustration, but I think it's better for a handful
>> of package maintainers to be frustrated than hundreds of users
>> creating dangerous code.
>>
>> Hadley
>>
>>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From i.ucar86 at gmail.com  Fri Oct  6 17:25:33 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Fri, 6 Oct 2017 17:25:33 +0200
Subject: [R-pkg-devel] r-quantities seeking feedback
Message-ID: <CALEXWq3y3wcpVgi2-7h2TzQOyscBx4C4zGj2SzGhe1ZJBXO4Pg@mail.gmail.com>

Dear all,

Edzer Pebesma and I are combining forces into a new GitHub
organisation called "r-quantities", to which we have moved the CRAN
packages 'units', 'errors' and 'constants'. The idea is to write a new
package called 'quantities' to integrate 'units' and 'errors' into a
comprehensive solution for dealing with quantity values + uncertainty
calculus.

Given that a significant fraction of R users, both practitioners and
researchers, use R to analyse measurements, we believe that the R
community would benefit from such a project. Moreover, to the best of
our knowledge, there exists no such an integrated and automated
framework outside the R language.

We would like to share a proposal [1] to be submitted to the R
Consortium before October 15. Until then, we kindly invite the R
package developers to review it. Any feedback or contribution would be
very helpful.

[1] https://github.com/r-quantities/proposal

Regards,
I?aki


From davidhughjones at gmail.com  Fri Oct  6 19:13:18 2017
From: davidhughjones at gmail.com (David Hugh-Jones)
Date: Fri, 06 Oct 2017 17:13:18 +0000
Subject: [R-pkg-devel] r-quantities seeking feedback
In-Reply-To: <CALEXWq3y3wcpVgi2-7h2TzQOyscBx4C4zGj2SzGhe1ZJBXO4Pg@mail.gmail.com>
References: <CALEXWq3y3wcpVgi2-7h2TzQOyscBx4C4zGj2SzGhe1ZJBXO4Pg@mail.gmail.com>
Message-ID: <CAARY7kix1as24FJM=NWC1jy5jA9US1qvk8GCZ=zH2xs01i+Dhg@mail.gmail.com>

One question that comes to mind: what's the synergy? I e why are units and
errors best handled together? I use standard errors a lot, but never
units... I would like a standard way to represent uncertainty but don't
think I need the other stuff.
Cheers,
D

On Fri, 6 Oct 2017 at 17:25, I?aki ?car <i.ucar86 at gmail.com> wrote:

> Dear all,
>
> Edzer Pebesma and I are combining forces into a new GitHub
> organisation called "r-quantities", to which we have moved the CRAN
> packages 'units', 'errors' and 'constants'. The idea is to write a new
> package called 'quantities' to integrate 'units' and 'errors' into a
> comprehensive solution for dealing with quantity values + uncertainty
> calculus.
>
> Given that a significant fraction of R users, both practitioners and
> researchers, use R to analyse measurements, we believe that the R
> community would benefit from such a project. Moreover, to the best of
> our knowledge, there exists no such an integrated and automated
> framework outside the R language.
>
> We would like to share a proposal [1] to be submitted to the R
> Consortium before October 15. Until then, we kindly invite the R
> package developers to review it. Any feedback or contribution would be
> very helpful.
>
> [1] https://github.com/r-quantities/proposal
>
> Regards,
> I?aki
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from Gmail Mobile

	[[alternative HTML version deleted]]


From i.ucar86 at gmail.com  Fri Oct  6 21:23:11 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Fri, 6 Oct 2017 21:23:11 +0200
Subject: [R-pkg-devel] r-quantities seeking feedback
In-Reply-To: <CAARY7kix1as24FJM=NWC1jy5jA9US1qvk8GCZ=zH2xs01i+Dhg@mail.gmail.com>
References: <CALEXWq3y3wcpVgi2-7h2TzQOyscBx4C4zGj2SzGhe1ZJBXO4Pg@mail.gmail.com>
 <CAARY7kix1as24FJM=NWC1jy5jA9US1qvk8GCZ=zH2xs01i+Dhg@mail.gmail.com>
Message-ID: <CALEXWq3stAon5_SnF1GwKhZaX4F+uGEX2qURf=T2CL9rqYqpiA@mail.gmail.com>

El 6 oct. 2017 19:13, "David Hugh-Jones" <davidhughjones at gmail.com>
escribi?:

One question that comes to mind: what's the synergy? I e why are units and
errors best handled together? I use standard errors a lot, but never
units... I would like a standard way to represent uncertainty but don't
think I need the other stuff.


You will always be able to use errors (or units) alone if you wish, but
every measurement has a unit and some uncertainty, so we think it's
interesting to have the possibility of handling them in a unified way (I/O,
propagation, automatic axes and error bars in plots...).

I?aki

Cheers,
D

On Fri, 6 Oct 2017 at 17:25, I?aki ?car <i.ucar86 at gmail.com> wrote:

> Dear all,
>
> Edzer Pebesma and I are combining forces into a new GitHub
> organisation called "r-quantities", to which we have moved the CRAN
> packages 'units', 'errors' and 'constants'. The idea is to write a new
> package called 'quantities' to integrate 'units' and 'errors' into a
> comprehensive solution for dealing with quantity values + uncertainty
> calculus.
>
> Given that a significant fraction of R users, both practitioners and
> researchers, use R to analyse measurements, we believe that the R
> community would benefit from such a project. Moreover, to the best of
> our knowledge, there exists no such an integrated and automated
> framework outside the R language.
>
> We would like to share a proposal [1] to be submitted to the R
> Consortium before October 15. Until then, we kindly invite the R
> package developers to review it. Any feedback or contribution would be
> very helpful.
>
> [1] https://github.com/r-quantities/proposal
>
> Regards,
> I?aki
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from Gmail Mobile

	[[alternative HTML version deleted]]


From davidhughjones at gmail.com  Fri Oct  6 22:28:53 2017
From: davidhughjones at gmail.com (David Hugh-Jones)
Date: Fri, 06 Oct 2017 20:28:53 +0000
Subject: [R-pkg-devel] r-quantities seeking feedback
In-Reply-To: <CALEXWq3stAon5_SnF1GwKhZaX4F+uGEX2qURf=T2CL9rqYqpiA@mail.gmail.com>
References: <CALEXWq3y3wcpVgi2-7h2TzQOyscBx4C4zGj2SzGhe1ZJBXO4Pg@mail.gmail.com>
 <CAARY7kix1as24FJM=NWC1jy5jA9US1qvk8GCZ=zH2xs01i+Dhg@mail.gmail.com>
 <CALEXWq3stAon5_SnF1GwKhZaX4F+uGEX2qURf=T2CL9rqYqpiA@mail.gmail.com>
Message-ID: <CAARY7kjOcZJxYV1JWTe+tgsgUNJU3PoRiodxARxsh0dpKWOfFw@mail.gmail.com>

Many measurements have no unit, but some uncertainty - e.g. the b and se
from an arbitrary regression. Can you give specific examples of the
advantages from binding these packages tightly together?

On Fri, 6 Oct 2017 at 21:23, I?aki ?car <i.ucar86 at gmail.com> wrote:

> El 6 oct. 2017 19:13, "David Hugh-Jones" <davidhughjones at gmail.com>
> escribi?:
>
> One question that comes to mind: what's the synergy? I e why are units and
> errors best handled together? I use standard errors a lot, but never
> units... I would like a standard way to represent uncertainty but don't
> think I need the other stuff.
>
>
> You will always be able to use errors (or units) alone if you wish, but
> every measurement has a unit and some uncertainty, so we think it's
> interesting to have the possibility of handling them in a unified way (I/O,
> propagation, automatic axes and error bars in plots...).
>
> I?aki
>
> Cheers,
> D
>
> On Fri, 6 Oct 2017 at 17:25, I?aki ?car <i.ucar86 at gmail.com> wrote:
>
>> Dear all,
>>
>> Edzer Pebesma and I are combining forces into a new GitHub
>> organisation called "r-quantities", to which we have moved the CRAN
>> packages 'units', 'errors' and 'constants'. The idea is to write a new
>> package called 'quantities' to integrate 'units' and 'errors' into a
>> comprehensive solution for dealing with quantity values + uncertainty
>> calculus.
>>
>> Given that a significant fraction of R users, both practitioners and
>> researchers, use R to analyse measurements, we believe that the R
>> community would benefit from such a project. Moreover, to the best of
>> our knowledge, there exists no such an integrated and automated
>> framework outside the R language.
>>
>> We would like to share a proposal [1] to be submitted to the R
>> Consortium before October 15. Until then, we kindly invite the R
>> package developers to review it. Any feedback or contribution would be
>> very helpful.
>>
>> [1] https://github.com/r-quantities/proposal
>>
>> Regards,
>> I?aki
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> --
> Sent from Gmail Mobile
>
>
> --
Sent from Gmail Mobile

	[[alternative HTML version deleted]]


From bill at denney.ws  Fri Oct  6 22:38:17 2017
From: bill at denney.ws (Bill Denney)
Date: Fri, 6 Oct 2017 16:38:17 -0400
Subject: [R-pkg-devel] r-quantities seeking feedback
In-Reply-To: <CAARY7kix1as24FJM=NWC1jy5jA9US1qvk8GCZ=zH2xs01i+Dhg@mail.gmail.com>
References: <CALEXWq3y3wcpVgi2-7h2TzQOyscBx4C4zGj2SzGhe1ZJBXO4Pg@mail.gmail.com>
 <CAARY7kix1as24FJM=NWC1jy5jA9US1qvk8GCZ=zH2xs01i+Dhg@mail.gmail.com>
Message-ID: <6FAE4FEF-333A-469B-984D-6A7A1EC63663@denney.ws>

Hi I?aki and David,

I fully see the need in a standardized unit package, and I understand the need for propagation of errors (though I'm in the opposite camp to David where I usually need unit tracking and conversion and rarely need error propagation-- though that's because my error propagation is often nonlinear and sometimes not normally distributed, so I have to do it myself).

I agree with David in that: error propagation and unit tracking and conversion are different with partially-overlapping audiences.  But, I agree with I?aki that there is a need for a consistent framework that can handle both.

The reason for the need of a consistent framework is that if we have two separate packages that handle both they generally will be unaware of each other and may not play nicely together (ref the recent discussion on tibbles not always playing nicely with code expecting data.frames).  I think that three packages should generally be the goal:
1) One that handles units
2) One that handles error propagation
3) One that uses the other two to handle both units and error propagation

The components that I didn't see in your discussion of your proposal is extension of both libraries.

For units, it should be possible to connect any set of units to any other set of units with a new conversion (e.g. mass and molar units could be connected with a molecular weight).  And, it should be possible to have multiple unit systems that can manage separate sets of rules (often an extension of a basic set of rules), and these should be possible to connect together.  The example for me again is with molecular weights, I may have molecule 1 that has a molecular weight of 100 g/mole and molecule 2 with a molecular weight of 200 g/mole; I would need to be able to store those at the same time without the system confusing the two.  And, I would slow need to store the rule that 2 count of molecule 1 make 1 count of molecule 2.  (FYI, parts of this are in https://github.com/pacificclimate/Rudunits2/pull/9 )

For both units and error propagation, these will need to work with general functions in packages that do not explicitly support the new packages.  As an example, the lm, glm, gls, etc. (along with thousands of other) functions are unlikely to be modified for support of the packages).  There should be some mechanism to make a simple wrapper function that looks at the input and understands how to map the output. Such as:

lm_quantities <- function(...) {
# look at the LHS of the formula argument, and apply any maths required to determine the units of the LHS.
# call lm normally
# assign units and/or error propagation to the result of the lm call
}

That would have to be repeated for any other function of interest.  Straight-forward examples that are part of the recommended libraries would hopefully be covered, and other library authors should have a simple way of assessing what the right units and error measures are to add it to their own libraries (optionally).

Thanks,

Bill

> On Oct 6, 2017, at 13:13, David Hugh-Jones <davidhughjones at gmail.com> wrote:
> 
> One question that comes to mind: what's the synergy? I e why are units and
> errors best handled together? I use standard errors a lot, but never
> units... I would like a standard way to represent uncertainty but don't
> think I need the other stuff.
> Cheers,
> D
> 
>> On Fri, 6 Oct 2017 at 17:25, I?aki ?car <i.ucar86 at gmail.com> wrote:
>> 
>> Dear all,
>> 
>> Edzer Pebesma and I are combining forces into a new GitHub
>> organisation called "r-quantities", to which we have moved the CRAN
>> packages 'units', 'errors' and 'constants'. The idea is to write a new
>> package called 'quantities' to integrate 'units' and 'errors' into a
>> comprehensive solution for dealing with quantity values + uncertainty
>> calculus.
>> 
>> Given that a significant fraction of R users, both practitioners and
>> researchers, use R to analyse measurements, we believe that the R
>> community would benefit from such a project. Moreover, to the best of
>> our knowledge, there exists no such an integrated and automated
>> framework outside the R language.
>> 
>> We would like to share a proposal [1] to be submitted to the R
>> Consortium before October 15. Until then, we kindly invite the R
>> package developers to review it. Any feedback or contribution would be
>> very helpful.
>> 
>> [1] https://github.com/r-quantities/proposal
>> 
>> Regards,
>> I?aki
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> -- 
> Sent from Gmail Mobile
> 
>    [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch.duncan at gmail.com  Fri Oct  6 22:40:29 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 6 Oct 2017 16:40:29 -0400
Subject: [R-pkg-devel] r-quantities seeking feedback
In-Reply-To: <CAARY7kjOcZJxYV1JWTe+tgsgUNJU3PoRiodxARxsh0dpKWOfFw@mail.gmail.com>
References: <CALEXWq3y3wcpVgi2-7h2TzQOyscBx4C4zGj2SzGhe1ZJBXO4Pg@mail.gmail.com>
 <CAARY7kix1as24FJM=NWC1jy5jA9US1qvk8GCZ=zH2xs01i+Dhg@mail.gmail.com>
 <CALEXWq3stAon5_SnF1GwKhZaX4F+uGEX2qURf=T2CL9rqYqpiA@mail.gmail.com>
 <CAARY7kjOcZJxYV1JWTe+tgsgUNJU3PoRiodxARxsh0dpKWOfFw@mail.gmail.com>
Message-ID: <66b440dc-4a99-aa1a-50d4-511cfec6905a@gmail.com>

On 06/10/2017 4:28 PM, David Hugh-Jones wrote:
> Many measurements have no unit, but some uncertainty - e.g. the b and se
> from an arbitrary regression. Can you give specific examples of the
> advantages from binding these packages tightly together?

Just to nitpick:  in the regression y = a + b x, b needs to have the 
units of y divided by the units of x.  Its se has the same units.  If 
you change the units for either x or y, you'll change the appropriate 
value of b and se.

Duncan Murdoch




> 
> On Fri, 6 Oct 2017 at 21:23, I?aki ?car <i.ucar86 at gmail.com> wrote:
> 
>> El 6 oct. 2017 19:13, "David Hugh-Jones" <davidhughjones at gmail.com>
>> escribi?:
>>
>> One question that comes to mind: what's the synergy? I e why are units and
>> errors best handled together? I use standard errors a lot, but never
>> units... I would like a standard way to represent uncertainty but don't
>> think I need the other stuff.
>>
>>
>> You will always be able to use errors (or units) alone if you wish, but
>> every measurement has a unit and some uncertainty, so we think it's
>> interesting to have the possibility of handling them in a unified way (I/O,
>> propagation, automatic axes and error bars in plots...).
>>
>> I?aki
>>
>> Cheers,
>> D
>>
>> On Fri, 6 Oct 2017 at 17:25, I?aki ?car <i.ucar86 at gmail.com> wrote:
>>
>>> Dear all,
>>>
>>> Edzer Pebesma and I are combining forces into a new GitHub
>>> organisation called "r-quantities", to which we have moved the CRAN
>>> packages 'units', 'errors' and 'constants'. The idea is to write a new
>>> package called 'quantities' to integrate 'units' and 'errors' into a
>>> comprehensive solution for dealing with quantity values + uncertainty
>>> calculus.
>>>
>>> Given that a significant fraction of R users, both practitioners and
>>> researchers, use R to analyse measurements, we believe that the R
>>> community would benefit from such a project. Moreover, to the best of
>>> our knowledge, there exists no such an integrated and automated
>>> framework outside the R language.
>>>
>>> We would like to share a proposal [1] to be submitted to the R
>>> Consortium before October 15. Until then, we kindly invite the R
>>> package developers to review it. Any feedback or contribution would be
>>> very helpful.
>>>
>>> [1] https://github.com/r-quantities/proposal
>>>
>>> Regards,
>>> I?aki
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> --
>> Sent from Gmail Mobile
>>
>>
>> --
> Sent from Gmail Mobile
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From i.ucar86 at gmail.com  Sat Oct  7 13:00:43 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Sat, 7 Oct 2017 13:00:43 +0200
Subject: [R-pkg-devel] r-quantities seeking feedback
In-Reply-To: <CAARY7kjOcZJxYV1JWTe+tgsgUNJU3PoRiodxARxsh0dpKWOfFw@mail.gmail.com>
References: <CALEXWq3y3wcpVgi2-7h2TzQOyscBx4C4zGj2SzGhe1ZJBXO4Pg@mail.gmail.com>
 <CAARY7kix1as24FJM=NWC1jy5jA9US1qvk8GCZ=zH2xs01i+Dhg@mail.gmail.com>
 <CALEXWq3stAon5_SnF1GwKhZaX4F+uGEX2qURf=T2CL9rqYqpiA@mail.gmail.com>
 <CAARY7kjOcZJxYV1JWTe+tgsgUNJU3PoRiodxARxsh0dpKWOfFw@mail.gmail.com>
Message-ID: <CALEXWq1c5i7tbFw+KGDHX56wbCLR-GyY8R2C3Anba_06G71mCw@mail.gmail.com>

2017-10-06 22:28 GMT+02:00 David Hugh-Jones <davidhughjones at gmail.com>:
> Many measurements have no unit, but some uncertainty - e.g. the b and se
> from an arbitrary regression. Can you give specific examples of the
> advantages from binding these packages tightly together?

As Duncan already pointed out, the units of b and se from an arbitrary
regression depend on the units of your variables. The advantages from
integrating both packages are the combination of advantages from each
one with the same workflow as if you were working with bare numbers.

It seems that you are already aware of the advantages of automatic
error propagation. Regarding the units package, it is very useful for
painless conversion of units. A conversion from kg to g is elementary,
but some others require more care, for example J to eV, or N.m-1 to
dyn.cm-1. In electromagnetism, it is very common to work with the CGS
units system, and an automatic conversion from/to the SI comes in
handy.

If you are not persuaded already, we can also talk about the Mars
Climate Orbiter, a robotic space probe launched by NASA on 1998 which
disintegrated in Mars' upper atmosphere due to a computation with
wrong units.

I?aki


From i.ucar86 at gmail.com  Sat Oct  7 13:29:18 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Sat, 7 Oct 2017 13:29:18 +0200
Subject: [R-pkg-devel] r-quantities seeking feedback
In-Reply-To: <6FAE4FEF-333A-469B-984D-6A7A1EC63663@denney.ws>
References: <CALEXWq3y3wcpVgi2-7h2TzQOyscBx4C4zGj2SzGhe1ZJBXO4Pg@mail.gmail.com>
 <CAARY7kix1as24FJM=NWC1jy5jA9US1qvk8GCZ=zH2xs01i+Dhg@mail.gmail.com>
 <6FAE4FEF-333A-469B-984D-6A7A1EC63663@denney.ws>
Message-ID: <CALEXWq00DX8LVKONMmvP7ByRx=Rx5KS6=aDjRtAuraDAMdcemA@mail.gmail.com>

2017-10-06 22:38 GMT+02:00 Bill Denney <bill at denney.ws>:
> Hi I?aki and David,
>
> I fully see the need in a standardized unit package, and I understand the need for propagation of errors (though I'm in the opposite camp to David where I usually need unit tracking and conversion and rarely need error propagation-- though that's because my error propagation is often nonlinear and sometimes not normally distributed, so I have to do it myself).

I plan to extend 'errors' to support also arbitrary distributions and
MC propagation methods. There are already excellent packages doing
this, but unlike with 'errors', you need a separate workflow to
propagate the uncertainty. I believe they could be integrated as
backends for 'errors'.

> I agree with David in that: error propagation and unit tracking and conversion are different with partially-overlapping audiences.  But, I agree with I?aki that there is a need for a consistent framework that can handle both.
>
> The reason for the need of a consistent framework is that if we have two separate packages that handle both they generally will be unaware of each other and may not play nicely together (ref the recent discussion on tibbles not always playing nicely with code expecting data.frames).  I think that three packages should generally be the goal:
> 1) One that handles units
> 2) One that handles error propagation
> 3) One that uses the other two to handle both units and error propagation

Yeap, that's exactly our intent.

> The components that I didn't see in your discussion of your proposal is extension of both libraries.
>
> For units, it should be possible to connect any set of units to any other set of units with a new conversion (e.g. mass and molar units could be connected with a molecular weight).  And, it should be possible to have multiple unit systems that can manage separate sets of rules (often an extension of a basic set of rules), and these should be possible to connect together.  The example for me again is with molecular weights, I may have molecule 1 that has a molecular weight of 100 g/mole and molecule 2 with a molecular weight of 200 g/mole; I would need to be able to store those at the same time without the system confusing the two.  And, I would slow need to store the rule that 2 count of molecule 1 make 1 count of molecule 2.  (FYI, parts of this are in https://github.com/pacificclimate/Rudunits2/pull/9 )

I'm not sure how much discussion should be dedicated in the proposal
to the feature extension of both libraries, because many issues and
needs have yet to be identified. We are in conversations with David
Flater, author of reference [3] in the proposal, and he raised very
interesting points too regarding units. For example, operations with
counting units: if you have 2 pixels * 2 pixels, you want 4 pixels as
output, and not 4 pixels^2.

> For both units and error propagation, these will need to work with general functions in packages that do not explicitly support the new packages.  As an example, the lm, glm, gls, etc. (along with thousands of other) functions are unlikely to be modified for support of the packages).  There should be some mechanism to make a simple wrapper function that looks at the input and understands how to map the output. Such as:
>
> lm_quantities <- function(...) {
> # look at the LHS of the formula argument, and apply any maths required to determine the units of the LHS.
> # call lm normally
> # assign units and/or error propagation to the result of the lm call
> }
>
> That would have to be repeated for any other function of interest.  Straight-forward examples that are part of the recommended libraries would hopefully be covered, and other library authors should have a simple way of assessing what the right units and error measures are to add it to their own libraries (optionally).

This, on the other hand, is not about new features, but about general
compatibility, and I agree it should be further discussed in the
proposal. I'll add some discussion along this lines.

Thank you very much, Bill. This feedback is very useful.

I?aki


From davidhughjones at gmail.com  Sat Oct  7 13:32:37 2017
From: davidhughjones at gmail.com (David Hugh-Jones)
Date: Sat, 7 Oct 2017 13:32:37 +0200
Subject: [R-pkg-devel] r-quantities seeking feedback
In-Reply-To: <CALEXWq1c5i7tbFw+KGDHX56wbCLR-GyY8R2C3Anba_06G71mCw@mail.gmail.com>
References: <CALEXWq3y3wcpVgi2-7h2TzQOyscBx4C4zGj2SzGhe1ZJBXO4Pg@mail.gmail.com>
 <CAARY7kix1as24FJM=NWC1jy5jA9US1qvk8GCZ=zH2xs01i+Dhg@mail.gmail.com>
 <CALEXWq3stAon5_SnF1GwKhZaX4F+uGEX2qURf=T2CL9rqYqpiA@mail.gmail.com>
 <CAARY7kjOcZJxYV1JWTe+tgsgUNJU3PoRiodxARxsh0dpKWOfFw@mail.gmail.com>
 <CALEXWq1c5i7tbFw+KGDHX56wbCLR-GyY8R2C3Anba_06G71mCw@mail.gmail.com>
Message-ID: <CAARY7kjhFkShAVyoTjiHedx=qAHSLAqys1s-iE2eot4TYDXyJQ@mail.gmail.com>

Hi I?aki,

OK, it sounds like we have no practical disagreement: you're planning to
keep separate packages and then have a third one for integration. That will
be fine for people like me who don't necessarily want to specify units for
our regressions. I look forward to seeing this!

Cheers,
David

On 7 October 2017 at 13:00, I?aki ?car <i.ucar86 at gmail.com> wrote:

> 2017-10-06 22:28 GMT+02:00 David Hugh-Jones <davidhughjones at gmail.com>:
> > Many measurements have no unit, but some uncertainty - e.g. the b and se
> > from an arbitrary regression. Can you give specific examples of the
> > advantages from binding these packages tightly together?
>
> As Duncan already pointed out, the units of b and se from an arbitrary
> regression depend on the units of your variables. The advantages from
> integrating both packages are the combination of advantages from each
> one with the same workflow as if you were working with bare numbers.
>
> It seems that you are already aware of the advantages of automatic
> error propagation. Regarding the units package, it is very useful for
> painless conversion of units. A conversion from kg to g is elementary,
> but some others require more care, for example J to eV, or N.m-1 to
> dyn.cm-1. In electromagnetism, it is very common to work with the CGS
> units system, and an automatic conversion from/to the SI comes in
> handy.
>
> If you are not persuaded already, we can also talk about the Mars
> Climate Orbiter, a robotic space probe launched by NASA on 1998 which
> disintegrated in Mars' upper atmosphere due to a computation with
> wrong units.
>
> I?aki
>

	[[alternative HTML version deleted]]


From jefferis at gmail.com  Sun Oct  8 09:40:28 2017
From: jefferis at gmail.com (Gregory Jefferis)
Date: Sun, 8 Oct 2017 08:40:28 +0100
Subject: [R-pkg-devel] referring to a package data object by two names
Message-ID: <158DBF89-F77D-4C70-8A7D-103185869563@gmail.com>

Dear R colleagues,

I have a set of versioned data objects in a package. Let's call them 

landmarks.2016
landmarks.2017

I need to have access to both of these objects for different calculations both internal to the package and for end users. The objects are saved as rda files in the package's data folder.

I would also like to define an object ? an alias if you will ? that contains the *current* landmarks. This is useful so that some package functions and external scripts do not require editing when the default object changes. 

For this, somewhere in the package, I would like to do something like:

# set the current default landmarks
landmarks <- landmarks.2017

I cannot figure out a place to do this in my package because check always complaints that landmarks.2017 does not exist ? I guess lazy loading can only happen after all the R code is evaluated.

* Can anyone suggest a workaround that does not involve saving a third redundant rda object into the package's data folder?

I have placed a toy example package on GitHub:

  https://github.com/jefferis/testdataalias

With many thanks,

Greg Jefferis.

--
Gregory Jefferis, PhD
Division of Neurobiology
MRC Laboratory of Molecular Biology
Francis Crick Avenue
Cambridge Biomedical Campus
Cambridge, CB2 OQH, UK

http://www2.mrc-lmb.cam.ac.uk/group-leaders/h-to-m/g-jefferis
http://jefferislab.org
http://www.zoo.cam.ac.uk/departments/connectomics


From lists at dewey.myzen.co.uk  Sun Oct  8 13:34:56 2017
From: lists at dewey.myzen.co.uk (Michael Dewey)
Date: Sun, 8 Oct 2017 12:34:56 +0100
Subject: [R-pkg-devel] referring to a package data object by two names
In-Reply-To: <158DBF89-F77D-4C70-8A7D-103185869563@gmail.com>
References: <158DBF89-F77D-4C70-8A7D-103185869563@gmail.com>
Message-ID: <808df6b6-601a-2bd2-1987-883cb029220d@dewey.myzen.co.uk>

Dear Greg

Do any of the suggestions in section 1.5.3 of Writing R Extensions "Load 
hooks" work?

Michael

On 08/10/2017 08:40, Gregory Jefferis wrote:
> Dear R colleagues,
> 
> I have a set of versioned data objects in a package. Let's call them
> 
> landmarks.2016
> landmarks.2017
> 
> I need to have access to both of these objects for different calculations both internal to the package and for end users. The objects are saved as rda files in the package's data folder.
> 
> I would also like to define an object ? an alias if you will ? that contains the *current* landmarks. This is useful so that some package functions and external scripts do not require editing when the default object changes.
> 
> For this, somewhere in the package, I would like to do something like:
> 
> # set the current default landmarks
> landmarks <- landmarks.2017
> 
> I cannot figure out a place to do this in my package because check always complaints that landmarks.2017 does not exist ? I guess lazy loading can only happen after all the R code is evaluated.
> 
> * Can anyone suggest a workaround that does not involve saving a third redundant rda object into the package's data folder?
> 
> I have placed a toy example package on GitHub:
> 
>    https://github.com/jefferis/testdataalias
> 
> With many thanks,
> 
> Greg Jefferis.
> 
> --
> Gregory Jefferis, PhD
> Division of Neurobiology
> MRC Laboratory of Molecular Biology
> Francis Crick Avenue
> Cambridge Biomedical Campus
> Cambridge, CB2 OQH, UK
> 
> http://www2.mrc-lmb.cam.ac.uk/group-leaders/h-to-m/g-jefferis
> http://jefferislab.org
> http://www.zoo.cam.ac.uk/departments/connectomics
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ---
> This email has been checked for viruses by AVG.
> http://www.avg.com
> 

-- 
Michael
http://www.dewey.myzen.co.uk/home.html


From jefferis at gmail.com  Sun Oct  8 14:45:42 2017
From: jefferis at gmail.com (Gregory Jefferis)
Date: Sun, 8 Oct 2017 13:45:42 +0100
Subject: [R-pkg-devel] referring to a package data object by two names
In-Reply-To: <808df6b6-601a-2bd2-1987-883cb029220d@dewey.myzen.co.uk>
References: <158DBF89-F77D-4C70-8A7D-103185869563@gmail.com>
 <808df6b6-601a-2bd2-1987-883cb029220d@dewey.myzen.co.uk>
Message-ID: <6B96063C-091B-4B2C-8733-E87C217CD740@gmail.com>

Dear Michael,

Many thanks for writing.

> Do any of the suggestions in section 1.5.3 of Writing R Extensions "Load hooks" work?

I thought I had tried all the various permutations in .onLoad but at your prompting I tried some more and this seems to work:

.onLoad <- function (libname, pkgname) {
  # set up default landmarks object
  assign('landmarks',
         envir = parent.env(environment()),
         testdataalias::landmarks.2017)

}

It doesn't seem to tickle R CMD check, but I'm not yet convinced that it is 100% safe. Any comments either way are welcome!

Best wishes,

Greg.


From berryboessenkool at hotmail.com  Mon Oct  9 14:36:51 2017
From: berryboessenkool at hotmail.com (Berry Boessenkool)
Date: Mon, 9 Oct 2017 12:36:51 +0000
Subject: [R-pkg-devel] referring to a package data object by two names
In-Reply-To: <6B96063C-091B-4B2C-8733-E87C217CD740@gmail.com>
References: <158DBF89-F77D-4C70-8A7D-103185869563@gmail.com>
 <808df6b6-601a-2bd2-1987-883cb029220d@dewey.myzen.co.uk>,
 <6B96063C-091B-4B2C-8733-E87C217CD740@gmail.com>
Message-ID: <DB5PR0401MB17817271110498C9D9784286D5740@DB5PR0401MB1781.eurprd04.prod.outlook.com>


Another approach, maybe overkill / not thought through:


latestLandmark <- function()
 {
 files <- dir(file.path(system.file(package="yourpackage"), "data"),
              pattern="landmark", full.names=TRUE)
 env <- environment()
 dataset <- load(tail(files, 1), envir=env)
 return(invisible(get(dataset, envir=env)))
 }

landmark <- latestLandmark()


Regards,
Berry


________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Gregory Jefferis <jefferis at gmail.com>
Sent: Sunday, October 8, 2017 14:45
To: Michael Dewey
Cc: r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] referring to a package data object by two names

Dear Michael,

Many thanks for writing.

> Do any of the suggestions in section 1.5.3 of Writing R Extensions "Load hooks" work?

I thought I had tried all the various permutations in .onLoad but at your prompting I tried some more and this seems to work:

.onLoad <- function (libname, pkgname) {
  # set up default landmarks object
  assign('landmarks',
         envir = parent.env(environment()),
         testdataalias::landmarks.2017)

}

It doesn't seem to tickle R CMD check, but I'm not yet convinced that it is[[elided Hotmail spam]]

Best wishes,

Greg.

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From jefferis at gmail.com  Mon Oct  9 20:39:07 2017
From: jefferis at gmail.com (Gregory Jefferis)
Date: Mon, 9 Oct 2017 19:39:07 +0100
Subject: [R-pkg-devel] referring to a package data object by two names
In-Reply-To: <DB5PR0401MB17817271110498C9D9784286D5740@DB5PR0401MB1781.eurprd04.prod.outlook.com>
References: <158DBF89-F77D-4C70-8A7D-103185869563@gmail.com>
 <808df6b6-601a-2bd2-1987-883cb029220d@dewey.myzen.co.uk>
 <6B96063C-091B-4B2C-8733-E87C217CD740@gmail.com>
 <DB5PR0401MB17817271110498C9D9784286D5740@DB5PR0401MB1781.eurprd04.prod.outlook.com>
Message-ID: <3ED801D6-A29F-4227-8C75-F743E2BEBF1C@gmail.com>

Thanks, Berry. Interesting! Both this suggestion and my previous effort seem a little baroque ? fighting against the system.

However after thinking about this some more, I found this:

delayedAssign('landmarks', testdataalias::landmarks.2017)

which feels a bit safer (although does not try to automatically find the most recent object as per your suggestion).

Thanks again,

Greg.


> On 9 Oct 2017, at 13:36, Berry Boessenkool <berryboessenkool at hotmail.com> wrote:
> 
> 
> Another approach, maybe overkill / not thought through:
> 
> latestLandmark <- function()
>  {
>  files <- dir(file.path(system.file(package="yourpackage"), "data"), 
>               pattern="landmark", full.names=TRUE)
>  env <- environment()
>  dataset <- load(tail(files, 1), envir=env)
>  return(invisible(get(dataset, envir=env)))
>  }
> 
> landmark <- latestLandmark()
> 
> 
> Regards,
> Berry
> 
> 
> From: R-package-devel <r-package-devel-bounces at r-project.org <mailto:r-package-devel-bounces at r-project.org>> on behalf of Gregory Jefferis <jefferis at gmail.com <mailto:jefferis at gmail.com>>
> Sent: Sunday, October 8, 2017 14:45
> To: Michael Dewey
> Cc: r-package-devel at r-project.org <mailto:r-package-devel at r-project.org>
> Subject: Re: [R-pkg-devel] referring to a package data object by two names
>  
> Dear Michael,
> 
> Many thanks for writing.
> 
> > Do any of the suggestions in section 1.5.3 of Writing R Extensions "Load hooks" work?
> 
> I thought I had tried all the various permutations in .onLoad but at your prompting I tried some more and this seems to work:
> 
> .onLoad <- function (libname, pkgname) {
>   # set up default landmarks object
>   assign('landmarks',
>          envir = parent.env(environment()),
>          testdataalias::landmarks.2017)
> 
> }
> 
> It doesn't seem to tickle R CMD check, but I'm not yet convinced that it is 100% safe. Any comments either way are welcome!
> 
> Best wishes,
> 
> Greg.
> 
> ______________________________________________
> R-package-devel at r-project.org <mailto:R-package-devel at r-project.org> mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
--
Gregory Jefferis, PhD
Division of Neurobiology
MRC Laboratory of Molecular Biology
Francis Crick Avenue
Cambridge Biomedical Campus
Cambridge, CB2 OQH, UK

http://www2.mrc-lmb.cam.ac.uk/group-leaders/h-to-m/g-jefferis
http://jefferislab.org
http://www.zoo.cam.ac.uk/departments/connectomics




	[[alternative HTML version deleted]]


From patrick.schratz at gmail.com  Sat Oct 14 11:19:34 2017
From: patrick.schratz at gmail.com (Patrick Schratz)
Date: Sat, 14 Oct 2017 11:19:34 +0200
Subject: [R-pkg-devel] caTools missing on WinBuilder?
Message-ID: <695b511d-299a-45b1-b9ba-8798b5b87cc0@Spark>

Hi guys,

during my recent check on win-builder I got this error:
** byte-compile and prepare package for lazy loading
Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]) :
 there is no package called 'caTools'
https://win-builder.r-project.org/xuET06RPfd7Q/00install.out

@Uwe Can you help here?

Cheers and thanks,
Patrick

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Sun Oct 15 16:44:47 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 15 Oct 2017 16:44:47 +0200
Subject: [R-pkg-devel] caTools missing on WinBuilder?
In-Reply-To: <695b511d-299a-45b1-b9ba-8798b5b87cc0@Spark>
References: <695b511d-299a-45b1-b9ba-8798b5b87cc0@Spark>
Message-ID: <f1018950-b7f6-8fdc-fa65-2856d139022a@statistik.tu-dortmund.de>



On 14.10.2017 11:19, Patrick Schratz wrote:
> Hi guys,
> 
> during my recent check on win-builder I got this error:
> 
> ** byte-compile and prepare package for lazy loading
> Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]) :
>    there is no package called 'caTools'
> 
> https://win-builder.r-project.org/xuET06RPfd7Q/00install.out
> 
> @Uwe Can you help here?

Have you declared it as Imports in the Description file? If so, perhaps 
some race condition and you have to try again.

Best,
Uwe Ligges


> 
> Cheers and thanks,
> Patrick


From tracyzhoeipng at gmail.com  Sun Oct 15 19:20:45 2017
From: tracyzhoeipng at gmail.com (=?utf-8?B?5ZGo5Lyf6bmP?=)
Date: Sun, 15 Oct 2017 12:20:45 -0500
Subject: [R-pkg-devel] Dropping empty section problems
Message-ID: <3A042D90-E4C1-46A9-A200-F55121D7C5B6@gmail.com>

Hi,

I have encountered this problem when using devtools to check my R package. I tried to google the key words and cannot find the solution. Can anyone tell what ?Dropping empty section? means?

R CMD check results
0 errors | 0 warnings | 1 note 
checking Rd files ... NOTE
prepare_Rd: QCAT.Rd:38-40: Dropping empty section \details
prepare_Rd: QCAT.Rd:56-58: Dropping empty section \note
prepare_Rd: QCAT.Rd:62-64: Dropping empty section \seealso
prepare_Rd: QCAT_GEE.Rd:44-46: Dropping empty section \details
prepare_Rd: QCAT_GEE.Rd:62-64: Dropping empty section \note
prepare_Rd: QCAT_GEE.Rd:68-70: Dropping empty section \seealso
prepare_Rd: data.real.Rd:19-21: Dropping empty section \details
prepare_Rd: data.real.Rd:25-27: Dropping empty section \references
prepare_Rd: data.toy.Rd:19-21: Dropping empty section \details
prepare_Rd: data.toy.Rd:25-27: Dropping empty section \references
prepare_Rd: miLineage-package.Rd:34-36: Dropping empty section \seealso

Best,
Weipeng
	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Sun Oct 15 19:54:57 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 15 Oct 2017 19:54:57 +0200
Subject: [R-pkg-devel] Dropping empty section problems
In-Reply-To: <3A042D90-E4C1-46A9-A200-F55121D7C5B6@gmail.com>
References: <3A042D90-E4C1-46A9-A200-F55121D7C5B6@gmail.com>
Message-ID: <3ef508f2-827b-dfda-cbb2-8d31812d564b@statistik.tu-dortmund.de>



On 15.10.2017 19:20, ??? wrote:
> Hi,
> 
> I have encountered this problem when using devtools to check my R package. I tried to google the key words and cannot find the solution. Can anyone tell what ?Dropping empty section? means?

You have empty sections in your Rd files, these are dropped when the 
database is built. Hence either fill these with content or delete them 
entirely.


Best,
Uwe Ligges



> R CMD check results
> 0 errors | 0 warnings | 1 note
> checking Rd files ... NOTE
> prepare_Rd: QCAT.Rd:38-40: Dropping empty section \details
> prepare_Rd: QCAT.Rd:56-58: Dropping empty section \note
> prepare_Rd: QCAT.Rd:62-64: Dropping empty section \seealso
> prepare_Rd: QCAT_GEE.Rd:44-46: Dropping empty section \details
> prepare_Rd: QCAT_GEE.Rd:62-64: Dropping empty section \note
> prepare_Rd: QCAT_GEE.Rd:68-70: Dropping empty section \seealso
> prepare_Rd: data.real.Rd:19-21: Dropping empty section \details
> prepare_Rd: data.real.Rd:25-27: Dropping empty section \references
> prepare_Rd: data.toy.Rd:19-21: Dropping empty section \details
> prepare_Rd: data.toy.Rd:25-27: Dropping empty section \references
> prepare_Rd: miLineage-package.Rd:34-36: Dropping empty section \seealso
> 
> Best,
> Weipeng
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From nfultz at gmail.com  Fri Oct 20 05:42:58 2017
From: nfultz at gmail.com (Neal Fultz)
Date: Thu, 19 Oct 2017 20:42:58 -0700
Subject: [R-pkg-devel] Where do demos fit in?
Message-ID: <CAL9B2vdf21BT7sHimXCcuwQa6NuQyB=KPR=ePziiLWVeECcGMw@mail.gmail.com>

A graduate student just asked me (copied below), in response to a bug I
wrote (
https://github.com/DeclareDesign/estimatr/pull/38/commits/99e82e253979d1307714632e9dc05d2e2c9c66df
):

How do demos normally relate to tests and vignettes? Is the purpose simply
> to have manually run tests that check the things work in the global
> environment?


...which is a fair and good question.

I replied:


> My current understanding is:



tests - verifies things aren't broken - implemented either via testthat or
> traditional tests in the test/ directory - run manually, by R CMD check, by
> CRAN, or by CI before build/shipping. End users typically don't run these.
>

demos - extended things a user might want to do, possibly interactive -
> basically just scripts that get source() as if a user had done so
> themself - run only when a user types demo()

vignettes - documentation mixed with code - usually supplemental to man
> pages and / or R-Journal or JSS articles - run at build time, static
> html/pdf file displayed when user types vignette(), also mirrored on CRAN
> IIRC.

examples - these live inside the function .Rd pages - for us they can come
> from a roxygen @examples <https://github.com/examples> block - run when
> the package is built, and when user runs example(foo) so to a large degree,
> there's a four-circle venn-diagram of where different snippets of code
> could live. For the particular NSE bug I caused, (where because of scoping
> a testthat passed where a demo would have failed), I think
> there's value in having and then testing demos.



Scoping bugs aside, R-exts.html describes all of these very procedurally,
and
it isn't completely obvious to me (or him) what current best practices
are...  Is
it dumb to have a test that calls demo?

Anyway, I've actually got a lot of value out of demos so far. If other
people feel that way,
I'd be happy to work on the tooling around them (roxygen indexes for
demos??? idk)
but if the trend is towards less demos and more of something else, I'd
follow that advice
also. (I also think there's a decent argument to be made that demos should
just be
functions, FWIW).


Thanks much,

-Neal
















PS hoping gmail sends this as plain text correctly...

	[[alternative HTML version deleted]]


From i.ucar86 at gmail.com  Fri Oct 20 08:18:35 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Fri, 20 Oct 2017 08:18:35 +0200
Subject: [R-pkg-devel] Where do demos fit in?
In-Reply-To: <CAL9B2vdf21BT7sHimXCcuwQa6NuQyB=KPR=ePziiLWVeECcGMw@mail.gmail.com>
References: <CAL9B2vdf21BT7sHimXCcuwQa6NuQyB=KPR=ePziiLWVeECcGMw@mail.gmail.com>
Message-ID: <CALEXWq1rjRhJ+_hO0RyFaSLj_YM=k_hsPNihnJHXPGZRM9gZfQ@mail.gmail.com>

2017-10-20 5:42 GMT+02:00 Neal Fultz <nfultz at gmail.com>:
> A graduate student just asked me (copied below), in response to a bug I
> wrote (
> https://github.com/DeclareDesign/estimatr/pull/38/commits/99e82e253979d1307714632e9dc05d2e2c9c66df
> ):
>
> How do demos normally relate to tests and vignettes? Is the purpose simply
>> to have manually run tests that check the things work in the global
>> environment?

There is a good definition and description here:
http://r-pkgs.had.co.nz/misc.html

Personally, I'm not a fan of demos, because I prefer to copy&paste
from vignettes as I read and understand the different parts of the
problem in question.

I?aki


From adrian601 at gmail.com  Fri Oct 20 05:38:26 2017
From: adrian601 at gmail.com (Adrian Cunningham)
Date: Thu, 19 Oct 2017 20:38:26 -0700
Subject: [R-pkg-devel] Help with Devtools Error
Message-ID: <CADt0D3Qy2jj0JNFrN7doSo0fWHEK9t-s4cbgcCfJJZsPzTk2Dg@mail.gmail.com>

Hello,


I hope that this email finds you all well. Any help with the following
error messages that I am getting when I run devtools::check() on my
package would be greatly appreciated. I think that it is a Namespace
error - but when I try to export my function, it doesn't pass the
install check of the devtools check.

Thank you in advance!


* checking examples ...
** running examples for arch 'i386' ... ERROR
Running examples in 'MDSPlot-Ex.R' failed
The error most likely occurred in:

> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: PlotMDS
> ### Title: PlotMDS
> ### Aliases: PlotMDS
> ### Keywords: ~kwd1 ~kwd2
>
> ### ** Examples
>
> PlotMDS()
Error in PlotMDS() : could not find function "PlotMDS"
Execution halted
** running examples for arch 'x64' ... ERROR
Running examples in 'MDSPlot-Ex.R' failed
The error most likely occurred in:

> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: PlotMDS
> ### Title: PlotMDS
> ### Aliases: PlotMDS
> ### Keywords: ~kwd1 ~kwd2
>
> ### ** Examples
>
> PlotMDS()
Error in PlotMDS() : could not find function "PlotMDS"
Execution halted
* checking PDF version of manual ... OK
* DONE
Status: 2 ERRORs, 4 WARNINGs, 5 NOTEs


Best,

*Adrian Cunningham, M.A.*

	[[alternative HTML version deleted]]


From thierry.onkelinx at inbo.be  Fri Oct 20 13:14:01 2017
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Fri, 20 Oct 2017 13:14:01 +0200
Subject: [R-pkg-devel] Help with Devtools Error
In-Reply-To: <CADt0D3Qy2jj0JNFrN7doSo0fWHEK9t-s4cbgcCfJJZsPzTk2Dg@mail.gmail.com>
References: <CADt0D3Qy2jj0JNFrN7doSo0fWHEK9t-s4cbgcCfJJZsPzTk2Dg@mail.gmail.com>
Message-ID: <CAJuCY5zO_E-GFJ4X+4MHLmZijGGd-aa+_G9pw0RYcpCtj93szQ@mail.gmail.com>

Dear Adrian,

Answering this would be much easier when you have access to the code.

Best regards,

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE
AND FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Kliniekstraat 25, B-1070 Brussel
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no
more than asking him to perform a post-mortem examination: he may be
able to say what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does
not ensure that a reasonable answer can be extracted from a given body
of data. ~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////


Van 14 tot en met 19 december 2017 verhuizen we uit onze vestiging in
Brussel naar het Herman Teirlinckgebouw op de site Thurn & Taxis.
Vanaf dan ben je welkom op het nieuwe adres: Havenlaan 88 bus 73, 1000 Brussel.

///////////////////////////////////////////////////////////////////////////////////////////



2017-10-20 5:38 GMT+02:00 Adrian Cunningham <adrian601 at gmail.com>:
> Hello,
>
>
> I hope that this email finds you all well. Any help with the following
> error messages that I am getting when I run devtools::check() on my
> package would be greatly appreciated. I think that it is a Namespace
> error - but when I try to export my function, it doesn't pass the
> install check of the devtools check.
>
> Thank you in advance!
>
>
> * checking examples ...
> ** running examples for arch 'i386' ... ERROR
> Running examples in 'MDSPlot-Ex.R' failed
> The error most likely occurred in:
>
>> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
>> ### Name: PlotMDS
>> ### Title: PlotMDS
>> ### Aliases: PlotMDS
>> ### Keywords: ~kwd1 ~kwd2
>>
>> ### ** Examples
>>
>> PlotMDS()
> Error in PlotMDS() : could not find function "PlotMDS"
> Execution halted
> ** running examples for arch 'x64' ... ERROR
> Running examples in 'MDSPlot-Ex.R' failed
> The error most likely occurred in:
>
>> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
>> ### Name: PlotMDS
>> ### Title: PlotMDS
>> ### Aliases: PlotMDS
>> ### Keywords: ~kwd1 ~kwd2
>>
>> ### ** Examples
>>
>> PlotMDS()
> Error in PlotMDS() : could not find function "PlotMDS"
> Execution halted
> * checking PDF version of manual ... OK
> * DONE
> Status: 2 ERRORs, 4 WARNINGs, 5 NOTEs
>
>
> Best,
>
> *Adrian Cunningham, M.A.*
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From Joris.Meys at ugent.be  Fri Oct 20 13:14:12 2017
From: Joris.Meys at ugent.be (Joris Meys)
Date: Fri, 20 Oct 2017 13:14:12 +0200
Subject: [R-pkg-devel] Help with Devtools Error
In-Reply-To: <CADt0D3Qy2jj0JNFrN7doSo0fWHEK9t-s4cbgcCfJJZsPzTk2Dg@mail.gmail.com>
References: <CADt0D3Qy2jj0JNFrN7doSo0fWHEK9t-s4cbgcCfJJZsPzTk2Dg@mail.gmail.com>
Message-ID: <CAO1zAVaFSjaASDKVBQhs_1_cjUVKE06tsf+skPvM5DzmyZSpRA@mail.gmail.com>

Dear Adrian,

I think the problem is rather obvious: plotMDS cannot be found. So if this
is a function of your own package, you forgot to export it. If it's a
function from another package, the package isn't loaded so it should be
added as Depends, Imports or Suggests. And when added as Suggests, you need
a library() statement in your example to load the function.

But as far as I can judge from the little info you gave, exporting the
function should do it.

On Fri, Oct 20, 2017 at 5:38 AM, Adrian Cunningham <adrian601 at gmail.com>
wrote:

> Hello,
>
>
> I hope that this email finds you all well. Any help with the following
> error messages that I am getting when I run devtools::check() on my
> package would be greatly appreciated. I think that it is a Namespace
> error - but when I try to export my function, it doesn't pass the
> install check of the devtools check.
>
> Thank you in advance!
>
>
> * checking examples ...
> ** running examples for arch 'i386' ... ERROR
> Running examples in 'MDSPlot-Ex.R' failed
> The error most likely occurred in:
>
> > base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> > ### Name: PlotMDS
> > ### Title: PlotMDS
> > ### Aliases: PlotMDS
> > ### Keywords: ~kwd1 ~kwd2
> >
> > ### ** Examples
> >
> > PlotMDS()
> Error in PlotMDS() : could not find function "PlotMDS"
> Execution halted
> ** running examples for arch 'x64' ... ERROR
> Running examples in 'MDSPlot-Ex.R' failed
> The error most likely occurred in:
>
> > base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> > ### Name: PlotMDS
> > ### Title: PlotMDS
> > ### Aliases: PlotMDS
> > ### Keywords: ~kwd1 ~kwd2
> >
> > ### ** Examples
> >
> > PlotMDS()
> Error in PlotMDS() : could not find function "PlotMDS"
> Execution halted
> * checking PDF version of manual ... OK
> * DONE
> Status: 2 ERRORs, 4 WARNINGs, 5 NOTEs
>
>
> Best,
>
> *Adrian Cunningham, M.A.*
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>



-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel : +32 9 264 59 87
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From peter.carbonetto at gmail.com  Fri Oct 20 22:11:43 2017
From: peter.carbonetto at gmail.com (Peter Carbonetto)
Date: Fri, 20 Oct 2017 15:11:43 -0500
Subject: [R-pkg-devel] Where do demos fit in?
In-Reply-To: <CALEXWq1rjRhJ+_hO0RyFaSLj_YM=k_hsPNihnJHXPGZRM9gZfQ@mail.gmail.com>
References: <CAL9B2vdf21BT7sHimXCcuwQa6NuQyB=KPR=ePziiLWVeECcGMw@mail.gmail.com>
 <CALEXWq1rjRhJ+_hO0RyFaSLj_YM=k_hsPNihnJHXPGZRM9gZfQ@mail.gmail.com>
Message-ID: <CAPvCojJFq9AZ20Ef_i81XoRbDr3911uYidigS4FMZ2rEbe9uVQ@mail.gmail.com>

Hi Neal,

Re-using demos for your package tests is a great idea, and should be done
more often.

However, I tend to agree with I?aki---I generally prefer vignettes to demos.

I wanted to point out that you could take a similar strategy to what you
suggested, but using a vignette instead of a demo. The code is slightly
more complicated but seems to work. See here for an example:

https://raw.githubusercontent.com/pcarbo/varbvs/test_vignette/varbvs-R/tests/testthat/test_vignette.R

(Anyone, please reply if you know of a better way to implement this!)

Peter

On Fri, Oct 20, 2017 at 1:18 AM, I?aki ?car <i.ucar86 at gmail.com> wrote:

> 2017-10-20 5:42 GMT+02:00 Neal Fultz <nfultz at gmail.com>:
> > A graduate student just asked me (copied below), in response to a bug I
> > wrote (
> > https://github.com/DeclareDesign/estimatr/pull/38/commits/
> 99e82e253979d1307714632e9dc05d2e2c9c66df
> > ):
> >
> > How do demos normally relate to tests and vignettes? Is the purpose
> simply
> >> to have manually run tests that check the things work in the global
> >> environment?
>
> There is a good definition and description here:
> http://r-pkgs.had.co.nz/misc.html
>
> Personally, I'm not a fan of demos, because I prefer to copy&paste
> from vignettes as I read and understand the different parts of the
> problem in question.
>
> I?aki
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From a.mohammadi at rug.nl  Sun Oct 22 16:54:37 2017
From: a.mohammadi at rug.nl (Mohammadi, A.)
Date: Sun, 22 Oct 2017 16:54:37 +0200
Subject: [R-pkg-devel] Package compiler error
Message-ID: <CAHoOeoVipbR6cggctz488-RHH+LLMn7BHRUCjjF-bHf6SN9fDg@mail.gmail.com>

Hi everyone,

In the new version of my package BDgraph
<https://cran.r-project.org/web/packages/BDgraph/index.html>, I got below
error (link
<https://cran.r-project.org/web/checks/check_results_BDgraph.html>). I
checked it in my Linux and it works. It's problem with MAC compilers
related to OpenMP.

I really appreciate any kind of help. Thank you in advance!


* installing to library ?/home/ripley/R/Lib32?

* installing *source* package ?BDgraph? ...
** package ?BDgraph? successfully unpacked and MD5 sums checked
** libs
/opt/csw/bin/g++ -std=gnu++11 -I/home/ripley/R/cc/include -DNDEBUG
-I/usr/local/include  -xopenmp -fPIC  -O2 -c MyLapack.cpp -o
MyLapack.o
g++: error: language openmp not recognized
g++: error: language openmp not recognized
*** Error code 1
make: Fatal error: Command failed for target `MyLapack.o'
Current working directory /tmp/Rtmpc6aat3/R.INSTALL6e986d4b27ab/BDgraph/src
ERROR: compilation failed for package ?BDgraph?
* removing ?/home/ripley/R/Lib32/BDgraph


Best,
Reza
---------------------------------------------
Dr. A. Mohammadi
Postdoc Researcher in Statistics
Tilburg University
My University Homepage
<https://www.tilburguniversity.edu/webwijs/show/a.mohammadi.htm>
---------------------------------------------

	[[alternative HTML version deleted]]


From julio.trecenti at gmail.com  Sun Oct 22 20:37:33 2017
From: julio.trecenti at gmail.com (Julio Trecenti)
Date: Sun, 22 Oct 2017 18:37:33 +0000
Subject: [R-pkg-devel] Add appveyor in package with RcppGSL dependency
Message-ID: <CABXZZZ14Jb19qWAcKGhms85ByELNwbnc9UmUawofs=i7y1Q5gQ@mail.gmail.com>

Hi!

We are trying to add CI to this package
https://github.com/brsantos/baquantreg.

We are trying to do add appveyor to work with our package based on @stewid
solution here: https://github.com/stewid/SimInf.

However, our shell knowledge is limited and we did not manage to do it.

Would you have any thoughts on this?

Thanks!

PS: thanks Dirk for the valuable advices!

	[[alternative HTML version deleted]]


From drjimlemon at gmail.com  Sun Oct 22 23:22:06 2017
From: drjimlemon at gmail.com (Jim Lemon)
Date: Mon, 23 Oct 2017 08:22:06 +1100
Subject: [R-pkg-devel] making packages available for 3.4.2
Message-ID: <CA+8X3fXEY1fX5m0LSb_KpBL-UECTFRKmfo9fWcdqV-yxkdzqqw@mail.gmail.com>

I noticed yesterday that at least two packages that I maintain were
"not available for R-3.4.2". Obviously I would not like to drift into
obsolescence, and I know that the packages function with 3.4.2 as I
have been using them on a daily basis. Clearly I have missed something
about package management that marks a package as suitable for the
current version. Any hints will be greatly appreciated.

Jim


From ligges at statistik.tu-dortmund.de  Sun Oct 22 23:23:16 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 22 Oct 2017 23:23:16 +0200
Subject: [R-pkg-devel] making packages available for 3.4.2
In-Reply-To: <CA+8X3fXEY1fX5m0LSb_KpBL-UECTFRKmfo9fWcdqV-yxkdzqqw@mail.gmail.com>
References: <CA+8X3fXEY1fX5m0LSb_KpBL-UECTFRKmfo9fWcdqV-yxkdzqqw@mail.gmail.com>
Message-ID: <35128ff6-4142-164e-557d-279e3a83d035@statistik.tu-dortmund.de>

It would be helpful to know which packages you are talking about.

Best,
Uwe Ligges


On 22.10.2017 23:22, Jim Lemon wrote:
> I noticed yesterday that at least two packages that I maintain were
> "not available for R-3.4.2". Obviously I would not like to drift into
> obsolescence, and I know that the packages function with 3.4.2 as I
> have been using them on a daily basis. Clearly I have missed something
> about package management that marks a package as suitable for the
> current version. Any hints will be greatly appreciated.
> 
> Jim
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From drjimlemon at gmail.com  Sun Oct 22 23:27:16 2017
From: drjimlemon at gmail.com (Jim Lemon)
Date: Mon, 23 Oct 2017 08:27:16 +1100
Subject: [R-pkg-devel] making packages available for 3.4.2
In-Reply-To: <35128ff6-4142-164e-557d-279e3a83d035@statistik.tu-dortmund.de>
References: <CA+8X3fXEY1fX5m0LSb_KpBL-UECTFRKmfo9fWcdqV-yxkdzqqw@mail.gmail.com>
 <35128ff6-4142-164e-557d-279e3a83d035@statistik.tu-dortmund.de>
Message-ID: <CA+8X3fWZ8SBF2x31BGw68izxqbH7BCgUNgOfCJS_sAjN1eF2PQ@mail.gmail.com>

Hi Uwe,
I know that plotrix and prettyR return this message when I tried to
install them last night (I'm not on my usual PC). I also maintain
clinsig, crank and eventInterval. I'll try to install these to see if
the same thing happens.

Jim

On Mon, Oct 23, 2017 at 8:23 AM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
> It would be helpful to know which packages you are talking about.
>
> Best,
> Uwe Ligges
>
>
>
> On 22.10.2017 23:22, Jim Lemon wrote:
>>
>> I noticed yesterday that at least two packages that I maintain were
>> "not available for R-3.4.2". Obviously I would not like to drift into
>> obsolescence, and I know that the packages function with 3.4.2 as I
>> have been using them on a daily basis. Clearly I have missed something
>> about package management that marks a package as suitable for the
>> current version. Any hints will be greatly appreciated.
>>
>> Jim
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>


From edd at debian.org  Sun Oct 22 23:36:08 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 22 Oct 2017 16:36:08 -0500
Subject: [R-pkg-devel] Add appveyor in package with RcppGSL dependency
In-Reply-To: <CABXZZZ14Jb19qWAcKGhms85ByELNwbnc9UmUawofs=i7y1Q5gQ@mail.gmail.com>
References: <CABXZZZ14Jb19qWAcKGhms85ByELNwbnc9UmUawofs=i7y1Q5gQ@mail.gmail.com>
Message-ID: <23021.3912.658497.870768@bud.eddelbuettel.com>


On 22 October 2017 at 18:37, Julio Trecenti wrote:
| We are trying to add CI to this package
| https://github.com/brsantos/baquantreg.
| 
| We are trying to do add appveyor to work with our package based on @stewid
| solution here: https://github.com/stewid/SimInf.
| 
| However, our shell knowledge is limited and we did not manage to do it.
| 
| Would you have any thoughts on this?

>From the top of my head:

  i)   Download the prebuild GSL library CRAN uses for Windows and install
       it on test machine 
  ii)  Set the LIB_GSL environment variable that RcppGSL's src/Makevars.win
       et al expect and depend upon
  iii) Use the same mechanism in your package

That should be doable, with some work and elbow grease.  Now, RcppGSL also
shows nine reverse-depends.  The sources for all these packages are visible
via GitHub (search using the 'user:cran' constraint to limit it to the CRAN
mirror under GitHub user 'cran').  Did you check whether one of these nine
uses appveyor?  (The RcppZiggurat package is mine and it doesn't as I usually
cannot be bothered the fight the windmills presented by non-Linux CI.)

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From ligges at statistik.tu-dortmund.de  Sun Oct 22 23:46:55 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 22 Oct 2017 23:46:55 +0200
Subject: [R-pkg-devel] making packages available for 3.4.2
In-Reply-To: <CA+8X3fWZ8SBF2x31BGw68izxqbH7BCgUNgOfCJS_sAjN1eF2PQ@mail.gmail.com>
References: <CA+8X3fXEY1fX5m0LSb_KpBL-UECTFRKmfo9fWcdqV-yxkdzqqw@mail.gmail.com>
 <35128ff6-4142-164e-557d-279e3a83d035@statistik.tu-dortmund.de>
 <CA+8X3fWZ8SBF2x31BGw68izxqbH7BCgUNgOfCJS_sAjN1eF2PQ@mail.gmail.com>
Message-ID: <4e5b7fbd-2be6-69ca-909e-d616a1d8f7e1@statistik.tu-dortmund.de>

Not sure what you did, but e.g.
https://cran.r-project.org/web/packages/plotrix/index.html
shows that the sources and binaries are available and I just verified 
that the Windows binary is actually on the CRAN master.

So perhaps your internet connection was flaky or you used a broken mirror?

Best,
Uwe Ligges




On 22.10.2017 23:27, Jim Lemon wrote:
> Hi Uwe,
> I know that plotrix and prettyR return this message when I tried to
> install them last night (I'm not on my usual PC). I also maintain
> clinsig, crank and eventInterval. I'll try to install these to see if
> the same thing happens.
> 
> Jim
> 
> On Mon, Oct 23, 2017 at 8:23 AM, Uwe Ligges
> <ligges at statistik.tu-dortmund.de> wrote:
>> It would be helpful to know which packages you are talking about.
>>
>> Best,
>> Uwe Ligges
>>
>>
>>
>> On 22.10.2017 23:22, Jim Lemon wrote:
>>>
>>> I noticed yesterday that at least two packages that I maintain were
>>> "not available for R-3.4.2". Obviously I would not like to drift into
>>> obsolescence, and I know that the packages function with 3.4.2 as I
>>> have been using them on a daily basis. Clearly I have missed something
>>> about package management that marks a package as suitable for the
>>> current version. Any hints will be greatly appreciated.
>>>
>>> Jim
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>


From drjimlemon at gmail.com  Mon Oct 23 00:04:22 2017
From: drjimlemon at gmail.com (Jim Lemon)
Date: Mon, 23 Oct 2017 09:04:22 +1100
Subject: [R-pkg-devel] making packages available for 3.4.2
In-Reply-To: <4e5b7fbd-2be6-69ca-909e-d616a1d8f7e1@statistik.tu-dortmund.de>
References: <CA+8X3fXEY1fX5m0LSb_KpBL-UECTFRKmfo9fWcdqV-yxkdzqqw@mail.gmail.com>
 <35128ff6-4142-164e-557d-279e3a83d035@statistik.tu-dortmund.de>
 <CA+8X3fWZ8SBF2x31BGw68izxqbH7BCgUNgOfCJS_sAjN1eF2PQ@mail.gmail.com>
 <4e5b7fbd-2be6-69ca-909e-d616a1d8f7e1@statistik.tu-dortmund.de>
Message-ID: <CA+8X3fU9FMOLxc+1aTJqbs-5U+XqaSf_ytR_5tqT2G=JW7gMfg@mail.gmail.com>

Hi Uwe,
I don't know what the problem was, but I just tried again and
everything went smoothly. I did use a different mirror (Perth instead
of Canberra), but the problem appears to be solved.

Jim


On Mon, Oct 23, 2017 at 8:46 AM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
> Not sure what you did, but e.g.
> https://cran.r-project.org/web/packages/plotrix/index.html
> shows that the sources and binaries are available and I just verified that
> the Windows binary is actually on the CRAN master.
>
> So perhaps your internet connection was flaky or you used a broken mirror?
>
> Best,
> Uwe Ligges
>
>
>
>
>
> On 22.10.2017 23:27, Jim Lemon wrote:
>>
>> Hi Uwe,
>> I know that plotrix and prettyR return this message when I tried to
>> install them last night (I'm not on my usual PC). I also maintain
>> clinsig, crank and eventInterval. I'll try to install these to see if
>> the same thing happens.
>>
>> Jim
>>
>> On Mon, Oct 23, 2017 at 8:23 AM, Uwe Ligges
>> <ligges at statistik.tu-dortmund.de> wrote:
>>>
>>> It would be helpful to know which packages you are talking about.
>>>
>>> Best,
>>> Uwe Ligges
>>>
>>>
>>>
>>> On 22.10.2017 23:22, Jim Lemon wrote:
>>>>
>>>>
>>>> I noticed yesterday that at least two packages that I maintain were
>>>> "not available for R-3.4.2". Obviously I would not like to drift into
>>>> obsolescence, and I know that the packages function with 3.4.2 as I
>>>> have been using them on a daily basis. Clearly I have missed something
>>>> about package management that marks a package as suitable for the
>>>> current version. Any hints will be greatly appreciated.
>>>>
>>>> Jim
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>


From nikolaos at kourentzes.com  Mon Oct 23 09:09:09 2017
From: nikolaos at kourentzes.com (Nikos Kourentzes)
Date: Mon, 23 Oct 2017 07:09:09 +0000 (UTC)
Subject: [R-pkg-devel] Fw: [CRAN-pretest-archived] CRAN submission nnfor 0.9
In-Reply-To: <01d34bcc$Blat.v2.2.2$45151886@mail.statistik.tu-dortmund.de>
References: <20171023064640.13F7916419A@xmpalantir.wu.ac.at>
 <01d34bcc$Blat.v2.2.2$45151886@mail.statistik.tu-dortmund.de>
Message-ID: <2102111271.2526156.1508742549156@mail.yahoo.com>

Dear all,
I am facing a problem with a package I am trying to submit. 
I am getting three notes, for which I am not sure what could be done. 
Any help is greatly appreciated. Please here for the summary:
https://win-builder.r-project.org/incoming_pretest/171023_084642_nnfor_09/00check.log
or look for the details at the forwarded email. 

Thank you,Nikos
?Associate Professor, Dept. Management Science Lancaster University Management School, UK Lancaster Centre for Forecastingblog: http://nikolaos.kourentzes.com twitter:?@nkourentzNew Book: Ord, Fildes & Kourentzes (2017) Principles of Business Forecasting (2nd ed.), Wessex.

     
----- Forwarded Message -----
 From: "Uwe.Ligges at R-Project.org" <Uwe.Ligges at R-Project.org>
 To: nikolaos at kourentzes.com 
Cc: CRAN-submissions at R-project.org
 Sent: Monday, 23 October 2017, 7:58
 Subject: [CRAN-pretest-archived] CRAN submission nnfor 0.9
   
Dear maintainer,
 
package nnfor_0.9.tar.gz does not pass the incoming checks automatically, please see the pre-test at:
<https://win-builder.r-project.org/incoming_pretest/171023_084642_nnfor_09/00check.log>
Status: 3 NOTEs
 

Please fix all problems and resubmit a fixed version via the webform.
If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
<https://stat.ethz.ch/mailman/listinfo/r-package-devel>
If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.
 
More details are given in the directory:
<https://win-builder.r-project.org/incoming_pretest/171023_084642_nnfor_09>
The files will be removed after roughly 7 days.
 
 
Best regards,
CRAN teams' auto-check service



   
	[[alternative HTML version deleted]]


From thierry.onkelinx at inbo.be  Mon Oct 23 14:31:05 2017
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Mon, 23 Oct 2017 14:31:05 +0200
Subject: [R-pkg-devel] Fw: [CRAN-pretest-archived] CRAN submission nnfor
	0.9
In-Reply-To: <2102111271.2526156.1508742549156@mail.yahoo.com>
References: <20171023064640.13F7916419A@xmpalantir.wu.ac.at>
 <01d34bcc$Blat.v2.2.2$45151886@mail.statistik.tu-dortmund.de>
 <2102111271.2526156.1508742549156@mail.yahoo.com>
Message-ID: <CAJuCY5w6mb4chYkVzEiLTGmxqTNNY9_vL+gkf27D0YuiP1x_rQ@mail.gmail.com>

Dear Nikos,

Your examples are taking too much time. Make them run faster. Or
remove some of them.

Best regards,

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE
AND FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Kliniekstraat 25, B-1070 Brussel
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no
more than asking him to perform a post-mortem examination: he may be
able to say what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does
not ensure that a reasonable answer can be extracted from a given body
of data. ~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////


Van 14 tot en met 19 december 2017 verhuizen we uit onze vestiging in
Brussel naar het Herman Teirlinckgebouw op de site Thurn & Taxis.
Vanaf dan ben je welkom op het nieuwe adres: Havenlaan 88 bus 73, 1000 Brussel.

///////////////////////////////////////////////////////////////////////////////////////////



2017-10-23 9:09 GMT+02:00 Nikos Kourentzes <nikolaos at kourentzes.com>:
> Dear all,
> I am facing a problem with a package I am trying to submit.
> I am getting three notes, for which I am not sure what could be done.
> Any help is greatly appreciated. Please here for the summary:
> https://win-builder.r-project.org/incoming_pretest/171023_084642_nnfor_09/00check.log
> or look for the details at the forwarded email.
>
> Thank you,Nikos
>  Associate Professor, Dept. Management Science Lancaster University Management School, UK Lancaster Centre for Forecastingblog: http://nikolaos.kourentzes.com twitter: @nkourentzNew Book: Ord, Fildes & Kourentzes (2017) Principles of Business Forecasting (2nd ed.), Wessex.
>
>
> ----- Forwarded Message -----
>  From: "Uwe.Ligges at R-Project.org" <Uwe.Ligges at R-Project.org>
>  To: nikolaos at kourentzes.com
> Cc: CRAN-submissions at R-project.org
>  Sent: Monday, 23 October 2017, 7:58
>  Subject: [CRAN-pretest-archived] CRAN submission nnfor 0.9
>
> Dear maintainer,
>
> package nnfor_0.9.tar.gz does not pass the incoming checks automatically, please see the pre-test at:
> <https://win-builder.r-project.org/incoming_pretest/171023_084642_nnfor_09/00check.log>
> Status: 3 NOTEs
>
>
> Please fix all problems and resubmit a fixed version via the webform.
> If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.
>
> More details are given in the directory:
> <https://win-builder.r-project.org/incoming_pretest/171023_084642_nnfor_09>
> The files will be removed after roughly 7 days.
>
>
> Best regards,
> CRAN teams' auto-check service
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From i.ucar86 at gmail.com  Mon Oct 23 14:43:36 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Mon, 23 Oct 2017 14:43:36 +0200
Subject: [R-pkg-devel] Fw: [CRAN-pretest-archived] CRAN submission nnfor
	0.9
In-Reply-To: <2102111271.2526156.1508742549156@mail.yahoo.com>
References: <20171023064640.13F7916419A@xmpalantir.wu.ac.at>
 <01d34bcc$Blat.v2.2.2$45151886@mail.statistik.tu-dortmund.de>
 <2102111271.2526156.1508742549156@mail.yahoo.com>
Message-ID: <CALEXWq0cTZBgssH6vJk4xv9NuSoE+Tm-DVyuAvi=eLYcrgkcWg@mail.gmail.com>

Hi Nikos,

2017-10-23 9:09 GMT+02:00 Nikos Kourentzes <nikolaos at kourentzes.com>:
> Dear all,
> I am facing a problem with a package I am trying to submit.
> I am getting three notes, for which I am not sure what could be done.
> Any help is greatly appreciated. Please here for the summary:
> https://win-builder.r-project.org/incoming_pretest/171023_084642_nnfor_09/00check.log
> or look for the details at the forwarded email.

NOTE 1: New submission. That's a flag for the CRAN people, no problem.

The other 2 NOTEs: As Thierry said, your examples take too much time.
You can simplify them or you can use \dontrun{}. See "Writing R
Extensions", Section 2.1.1.

I?aki


From julio.trecenti at gmail.com  Mon Oct 23 15:10:45 2017
From: julio.trecenti at gmail.com (Julio Trecenti)
Date: Mon, 23 Oct 2017 13:10:45 +0000
Subject: [R-pkg-devel] Add appveyor in package with RcppGSL dependency
In-Reply-To: <CANe9BHEX=95V2AygEU5AT0VDmwEQ0mB_keDQi5S9v6U8g8XyPw@mail.gmail.com>
References: <CABXZZZ14Jb19qWAcKGhms85ByELNwbnc9UmUawofs=i7y1Q5gQ@mail.gmail.com>
 <CANe9BHEX=95V2AygEU5AT0VDmwEQ0mB_keDQi5S9v6U8g8XyPw@mail.gmail.com>
Message-ID: <CABXZZZ2rrj2YuhRM628ZkKj_tguaew7MGYiMyvr1cM5M0GiknA@mail.gmail.com>

@Dirk, yes, we checked the revdeps but only SimInf seems to have appveyor
working. Thank you for the advices.

@Jenny Thank you! Now we'll do our homework and return with feedback,
hopefully having a complete solution :)

Julio

On Sun, Oct 22, 2017 at 7:51 PM Jennifer Bryan <jenny.f.bryan at gmail.com>
wrote:

> On travis, you're installing libgsl0-dev yet I don't see anything similar
> in your appveyor config. If you look at install.out in your AppVeyor build
> artefacts:
>
> https://ci.appveyor.com/project/brsantos/baquantreg/build/artifacts
>
> that seems to be why compilation is failing.
>
> That seems like a lead worth pursuing.
>
> Jenny
>
> * installing *source* package 'baquantreg' ...
> ** libs
> C:/Rtools/mingw_32/bin/g++  -I"c:/R/include" -DNDEBUG -I/include
> -I../inst/include -I"c:/RLibrary/Rcpp/include"
> -I"c:/RLibrary/RcppArmadillo/include" -I"c:/RLibrary/RcppGSL/include"
> -I"d:/Compiler/gcc-4.9.3/local330/include"     -O2 -Wall  -mtune=core2 -c
> BayesQR.cpp -o BayesQR.o
> In file included from c:/RLibrary/RcppGSL/include/RcppGSL.h:25:0,
>                  from BayesQR.cpp:2:
> c:/RLibrary/RcppGSL/include/RcppGSLForward.h:26:29: fatal error:
> gsl/gsl_vector.h: No such file or directory
>  #include <gsl/gsl_vector.h>
>                              ^
> compilation terminated.
> make: *** [BayesQR.o] Error 1
> Warning: running command 'make -f "Makevars.win" -f
> "c:/R/etc/i386/Makeconf" -f "c:/R/share/make/winshlib.mk"
> SHLIB_LDFLAGS='$(SHLIB_CXXLDFLAGS)' SHLIB_LD='$(SHLIB_CXXLD)'
> SHLIB="baquantreg.dll" OBJECTS="BayesQR.o RcppExports.o TwoPartBayesQR.o
> ZItobitBayesQR.o helper1.o helperAlpha.o helperGIG.o helperLV.o helperRD.o
> helperTN.o spBayesQR.o sppBayesQR.o"' had status 2
> ERROR: compilation failed for package 'baquantreg'
> * removing 'C:/projects/baquantreg/baquantreg.Rcheck/baquantreg'
>
>
>
> On Sun, Oct 22, 2017 at 11:37 AM, Julio Trecenti <julio.trecenti at gmail.com
> > wrote:
>
>> Hi!
>>
>> We are trying to add CI to this package
>> https://github.com/brsantos/baquantreg.
>>
>> We are trying to do add appveyor to work with our package based on @stewid
>> solution here: https://github.com/stewid/SimInf.
>>
>> However, our shell knowledge is limited and we did not manage to do it.
>>
>> Would you have any thoughts on this?
>>
>> Thanks!
>>
>> PS: thanks Dirk for the valuable advices!
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
>
>

	[[alternative HTML version deleted]]


From adrian601 at gmail.com  Tue Oct 24 06:30:55 2017
From: adrian601 at gmail.com (Adrian Cunningham)
Date: Mon, 23 Oct 2017 21:30:55 -0700
Subject: [R-pkg-devel] Trying to remove dot file
Message-ID: <CADt0D3QGV6sHdLMYJvviCZzh-T3WC7A_2MGvk9WehVdjAJ6MHw@mail.gmail.com>

Hello Everyone,


I am trying to eliminate a warning from my package so that it will pass the
devtools check.

* checking package subdirectories ... WARNING
Subdirectory 'man' contains invalid file names:
  '._PlotMDS.Rd'
Please remove or rename the files.


I tried using "dot_clean -m --keep=mostrecent /PlotMDS/man" and that didn't
seem to remove the file. I am not able to view the file (tried using sudo
ls).

Does anyone have any suggestions to help me? Any suggestions would be most
welcome and appreciated, thank you!


-- 
Adrian Cunningham

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Tue Oct 24 09:08:01 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 24 Oct 2017 09:08:01 +0200
Subject: [R-pkg-devel] Trying to remove dot file
In-Reply-To: <CADt0D3QGV6sHdLMYJvviCZzh-T3WC7A_2MGvk9WehVdjAJ6MHw@mail.gmail.com>
References: <CADt0D3QGV6sHdLMYJvviCZzh-T3WC7A_2MGvk9WehVdjAJ6MHw@mail.gmail.com>
Message-ID: <cca5adf3-3f9b-d270-d8cc-f1cb1e8a0987@statistik.tu-dortmund.de>



On 24.10.2017 06:30, Adrian Cunningham wrote:
> Hello Everyone,
> 
> 
> I am trying to eliminate a warning from my package so that it will pass the
> devtools check.
> 
> * checking package subdirectories ... WARNING
> Subdirectory 'man' contains invalid file names:
>    '._PlotMDS.Rd'
> Please remove or rename the files.
> 
> 
> I tried using "dot_clean -m --keep=mostrecent /PlotMDS/man" and that didn't
> seem to remove the file. I am not able to view the file (tried using sudo
> ls).

ls -a

Best,
Uwe Ligges


> 
> Does anyone have any suggestions to help me? Any suggestions would be most
> welcome and appreciated, thank you!
> 
>


From jens.oehlschlaegel at truecluster.com  Wed Oct 25 10:48:50 2017
From: jens.oehlschlaegel at truecluster.com (=?UTF-8?Q?=22Jens_Oehlschl=C3=A4gel=22?=)
Date: Wed, 25 Oct 2017 10:48:50 +0200
Subject: [R-pkg-devel] Future location of Rtools?
In-Reply-To: <cca5adf3-3f9b-d270-d8cc-f1cb1e8a0987@statistik.tu-dortmund.de>
References: <CADt0D3QGV6sHdLMYJvviCZzh-T3WC7A_2MGvk9WehVdjAJ6MHw@mail.gmail.com>
 <cca5adf3-3f9b-d270-d8cc-f1cb1e8a0987@statistik.tu-dortmund.de>
Message-ID: <trinity-223e6598-2cb0-4a13-9408-28f2c1231b62-1508921330096@3c-app-webde-bap46>

Good morning, 

Duncan has announced that he steps back from the maintenance of Rtools. 
Where will I find the new Rtools toolchain that complements Microsofts R-version?

Kind regards

Jens


> Gesendet: Donnerstag, 28. September 2017 um 12:27 Uhr
> Von: "Duncan Murdoch" <murdoch.duncan at gmail.com>
> An: r-announce at r-project.org
> Betreff: Re: [R] R 3.4.2 is released
>
> I've just finished the Windows build of R 3.4.2.  It will make it to 
> CRAN and its mirrors over the next few hours.
> 
> This is the last binary release that I will be producing.  I've been 
> building them for about 15 years, and it's time to retire.  Builds using 
> different tools and scripts are available from 
> https://mran.microsoft.com/download/.  I'll be putting my own scripts on 
> CRAN soon in case anyone wants to duplicate them.
> 
> Nightly builds of R-patched and R-devel will continue to run on 
> autopilot for the time being, without maintenance.
> 
> I will also be retiring from maintenance of the Rtools collection.
> 
> Duncan Murdoch
> 
> _______________________________________________
> R-announce at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-announce
>


From ligges at statistik.tu-dortmund.de  Wed Oct 25 10:52:04 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 25 Oct 2017 10:52:04 +0200
Subject: [R-pkg-devel] Future location of Rtools?
In-Reply-To: <trinity-223e6598-2cb0-4a13-9408-28f2c1231b62-1508921330096@3c-app-webde-bap46>
References: <CADt0D3QGV6sHdLMYJvviCZzh-T3WC7A_2MGvk9WehVdjAJ6MHw@mail.gmail.com>
 <cca5adf3-3f9b-d270-d8cc-f1cb1e8a0987@statistik.tu-dortmund.de>
 <trinity-223e6598-2cb0-4a13-9408-28f2c1231b62-1508921330096@3c-app-webde-bap46>
Message-ID: <b4ce6a30-230c-207b-f0c7-ba35cd7f1cb0@statistik.tu-dortmund.de>



On 25.10.2017 10:48, "Jens Oehlschl?gel" wrote:
> Good morning,
> 
> Duncan has announced that he steps back from the maintenance of Rtools.
> Where will I find the new Rtools toolchain that complements Microsofts R-version?

Just take the Rtools. Microsoft uses our toolchain as far as I know.
Also note that we will probably continue to build Windows binaries (and 
have never stopped doing so).

Best,
Uwe Ligges


> 
> Kind regards
> 
> Jens
> 
> 
>> Gesendet: Donnerstag, 28. September 2017 um 12:27 Uhr
>> Von: "Duncan Murdoch" <murdoch.duncan at gmail.com>
>> An: r-announce at r-project.org
>> Betreff: Re: [R] R 3.4.2 is released
>>
>> I've just finished the Windows build of R 3.4.2.  It will make it to
>> CRAN and its mirrors over the next few hours.
>>
>> This is the last binary release that I will be producing.  I've been
>> building them for about 15 years, and it's time to retire.  Builds using
>> different tools and scripts are available from
>> https://mran.microsoft.com/download/.  I'll be putting my own scripts on
>> CRAN soon in case anyone wants to duplicate them.
>>
>> Nightly builds of R-patched and R-devel will continue to run on
>> autopilot for the time being, without maintenance.
>>
>> I will also be retiring from maintenance of the Rtools collection.
>>
>> Duncan Murdoch
>>
>> _______________________________________________
>> R-announce at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-announce
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From plummerm at iarc.fr  Wed Oct 25 11:13:49 2017
From: plummerm at iarc.fr (Martyn Plummer)
Date: Wed, 25 Oct 2017 09:13:49 +0000
Subject: [R-pkg-devel] Future location of Rtools?
In-Reply-To: <b4ce6a30-230c-207b-f0c7-ba35cd7f1cb0@statistik.tu-dortmund.de>
References: <CADt0D3QGV6sHdLMYJvviCZzh-T3WC7A_2MGvk9WehVdjAJ6MHw@mail.gmail.com>
 <cca5adf3-3f9b-d270-d8cc-f1cb1e8a0987@statistik.tu-dortmund.de>
 <trinity-223e6598-2cb0-4a13-9408-28f2c1231b62-1508921330096@3c-app-webde-bap46>
 <b4ce6a30-230c-207b-f0c7-ba35cd7f1cb0@statistik.tu-dortmund.de>
Message-ID: <1508922828.8328.359.camel@iarc.fr>

On Wed, 2017-10-25 at 10:52 +0200, Uwe Ligges wrote:
> 
> On 25.10.2017 10:48, "Jens Oehlschl?gel" wrote:
> > Good morning,
> > 
> > Duncan has announced that he steps back from the maintenance of Rtools.
> > Where will I find the new Rtools toolchain that complements Microsofts R-version?
> 
> Just take the Rtools. Microsoft uses our toolchain as far as I know.
> Also note that we will probably continue to build Windows binaries (and 
> have never stopped doing so).

Jeroen Ooms is taking over the binary Windows builds of R from Duncan.

From a strategic viewpoint, we will need to update the toolchain at
some point, but this is not currently scheduled.

Martyn

> Best,
> Uwe Ligges
> 
> 
> > 
> > Kind regards
> > 
> > Jens
> > 
> > 
> > > Gesendet: Donnerstag, 28. September 2017 um 12:27 Uhr
> > > Von: "Duncan Murdoch" <murdoch.duncan at gmail.com>
> > > An: r-announce at r-project.org
> > > Betreff: Re: [R] R 3.4.2 is released
> > > 
> > > I've just finished the Windows build of R 3.4.2.  It will make it to
> > > CRAN and its mirrors over the next few hours.
> > > 
> > > This is the last binary release that I will be producing.  I've been
> > > building them for about 15 years, and it's time to retire.  Builds using
> > > different tools and scripts are available from
> > > https://mran.microsoft.com/download/.  I'll be putting my own scripts on
> > > CRAN soon in case anyone wants to duplicate them.
> > > 
> > > Nightly builds of R-patched and R-devel will continue to run on
> > > autopilot for the time being, without maintenance.
> > > 
> > > I will also be retiring from maintenance of the Rtools collection.
> > > 
> > > Duncan Murdoch
> > > 
> > > _______________________________________________
> > > R-announce at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-announce
> > > 
> > 
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> > 
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

From shivaram.venkataraman at gmail.com  Wed Oct 25 20:23:38 2017
From: shivaram.venkataraman at gmail.com (Shivaram Venkataraman)
Date: Wed, 25 Oct 2017 11:23:38 -0700
Subject: [R-pkg-devel] Semantic versioning and maintenance releases
Message-ID: <CAGiTW4_sdwH4uZFQNCcT80Ag1W=nxiR7rvGHx5+-V0+9VWzLuw@mail.gmail.com>

Hello

We have an R package that uses semantic versioning -- i.e. version numbers
are of the form major_version.minor_version.patch_version

One of the ways we use the patch_versions is to make maintenance releases
or security fixes that users can apply without worrying about any
functionality changes. For example if our users were on 1.6.2 it is often
easier for them to upgrade to 1.6.3 which has a security fix rather than
1.7.0

On the other hand our development continues towards the next minor version
and we sometimes have cases where say 1.6.3 is released after 1.7.0.

While running `R CMD check --as-cran` for version 1.6.3 we find that this
leads to a warning which looks like 'Insufficient package version (submitted:
1.6.3, existing: 1.7.0)'.

Our question is whether it is okay to upload these maintenance releases to
CRAN and if there is some way we can mark that the version numbers follow
semantic versioning.

Thanks
Shivaram

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Wed Oct 25 21:47:57 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 25 Oct 2017 15:47:57 -0400
Subject: [R-pkg-devel] Semantic versioning and maintenance releases
In-Reply-To: <CAGiTW4_sdwH4uZFQNCcT80Ag1W=nxiR7rvGHx5+-V0+9VWzLuw@mail.gmail.com>
References: <CAGiTW4_sdwH4uZFQNCcT80Ag1W=nxiR7rvGHx5+-V0+9VWzLuw@mail.gmail.com>
Message-ID: <331ec124-f1fa-9e24-797f-36cf19f48085@gmail.com>

On 25/10/2017 2:23 PM, Shivaram Venkataraman wrote:
> Hello
> 
> We have an R package that uses semantic versioning -- i.e. version numbers
> are of the form major_version.minor_version.patch_version
> 
> One of the ways we use the patch_versions is to make maintenance releases
> or security fixes that users can apply without worrying about any
> functionality changes. For example if our users were on 1.6.2 it is often
> easier for them to upgrade to 1.6.3 which has a security fix rather than
> 1.7.0
> 
> On the other hand our development continues towards the next minor version
> and we sometimes have cases where say 1.6.3 is released after 1.7.0.
> 
> While running `R CMD check --as-cran` for version 1.6.3 we find that this
> leads to a warning which looks like 'Insufficient package version (submitted:
> 1.6.3, existing: 1.7.0)'.
> 
> Our question is whether it is okay to upload these maintenance releases to
> CRAN and if there is some way we can mark that the version numbers follow
> semantic versioning.

CRAN won't accept 1.6.3 after 1.7.0 has been published there.  It 
requires version numbers to be increasing.  There's no provision for the 
scheme you're following.

Even if there were, it's not easy for a user to ask to install any 
version but the latest one.  They'd need to work out the URL and 
download the tarball and build it from source.  install.packages() has 
no provision for handling this automatically.

I'd suggest that you put the patch releases for older versions on Github 
or some other repository, and explain how users can install directly 
from there.

Duncan Murdoch


From edd at debian.org  Wed Oct 25 22:01:52 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 25 Oct 2017 15:01:52 -0500
Subject: [R-pkg-devel] Semantic versioning and maintenance releases
In-Reply-To: <CAGiTW4_sdwH4uZFQNCcT80Ag1W=nxiR7rvGHx5+-V0+9VWzLuw@mail.gmail.com>
References: <CAGiTW4_sdwH4uZFQNCcT80Ag1W=nxiR7rvGHx5+-V0+9VWzLuw@mail.gmail.com>
Message-ID: <23024.60848.273200.330961@bud.eddelbuettel.com>


On 25 October 2017 at 11:23, Shivaram Venkataraman wrote:
| Hello
| 
| We have an R package that uses semantic versioning -- i.e. version numbers
| are of the form major_version.minor_version.patch_version
| 
| One of the ways we use the patch_versions is to make maintenance releases
| or security fixes that users can apply without worrying about any
| functionality changes. For example if our users were on 1.6.2 it is often
| easier for them to upgrade to 1.6.3 which has a security fix rather than
| 1.7.0
| 
| On the other hand our development continues towards the next minor version
| and we sometimes have cases where say 1.6.3 is released after 1.7.0.
| 
| While running `R CMD check --as-cran` for version 1.6.3 we find that this
| leads to a warning which looks like 'Insufficient package version (submitted:
| 1.6.3, existing: 1.7.0)'.
| 
| Our question is whether it is okay to upload these maintenance releases to
| CRAN and if there is some way we can mark that the version numbers follow
| semantic versioning.

CRAN allows you one version, with strictly monotonic ordering.  So once 1.7.0
is there, all you can do is have 1.7.1, or 1.7.0.1, or ...

"Branch release" as as you suggested do not fit.  So you could have kept CRAN
at 1.6.2 with an update to 1.6.3 and then offer 1.7.0 "for now" via a
different repository.

That is "sort of" what I do with test releases for Rcpp and RcppArmadillo,
albeit irregularly.

The drat package on CRAN makes creation of auxiliary repos pretty easy.

Hth, Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From bbolker at gmail.com  Wed Oct 25 22:05:50 2017
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 25 Oct 2017 16:05:50 -0400
Subject: [R-pkg-devel] Semantic versioning and maintenance releases
In-Reply-To: <331ec124-f1fa-9e24-797f-36cf19f48085@gmail.com>
References: <CAGiTW4_sdwH4uZFQNCcT80Ag1W=nxiR7rvGHx5+-V0+9VWzLuw@mail.gmail.com>
 <331ec124-f1fa-9e24-797f-36cf19f48085@gmail.com>
Message-ID: <c92b741b-18b6-547c-4c15-de513f7770a0@gmail.com>



On 17-10-25 03:47 PM, Duncan Murdoch wrote:
> On 25/10/2017 2:23 PM, Shivaram Venkataraman wrote:
>> Hello
>>
>> We have an R package that uses semantic versioning -- i.e. version
>> numbers
>> are of the form major_version.minor_version.patch_version
>>
>> One of the ways we use the patch_versions is to make maintenance releases
>> or security fixes that users can apply without worrying about any
>> functionality changes. For example if our users were on 1.6.2 it is often
>> easier for them to upgrade to 1.6.3 which has a security fix rather than
>> 1.7.0
>>
>> On the other hand our development continues towards the next minor
>> version
>> and we sometimes have cases where say 1.6.3 is released after 1.7.0.
>>
>> While running `R CMD check --as-cran` for version 1.6.3 we find that this
>> leads to a warning which looks like 'Insufficient package version
>> (submitted:
>> 1.6.3, existing: 1.7.0)'.
>>
>> Our question is whether it is okay to upload these maintenance
>> releases to
>> CRAN and if there is some way we can mark that the version numbers follow
>> semantic versioning.
> 
> CRAN won't accept 1.6.3 after 1.7.0 has been published there.? It
> requires version numbers to be increasing.? There's no provision for the
> scheme you're following.
> 
> Even if there were, it's not easy for a user to ask to install any
> version but the latest one.? They'd need to work out the URL and
> download the tarball and build it from source.? install.packages() has
> no provision for handling this automatically.

  If an older version *were* on CRAN (I understand why this isn't
feasible), devtools::install_version() would take care of some of the
fussy bits (although it still requires having the build tools installed).

  You can use the 'ref' argument in devtools::install_github to point
your users to a tag/release number ...

> I'd suggest that you put the patch releases for older versions on Github
> or some other repository, and explain how users can install directly
> from there.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From shivaram.venkataraman at gmail.com  Wed Oct 25 22:28:54 2017
From: shivaram.venkataraman at gmail.com (Shivaram Venkataraman)
Date: Wed, 25 Oct 2017 13:28:54 -0700
Subject: [R-pkg-devel] Semantic versioning and maintenance releases
In-Reply-To: <c92b741b-18b6-547c-4c15-de513f7770a0@gmail.com>
References: <CAGiTW4_sdwH4uZFQNCcT80Ag1W=nxiR7rvGHx5+-V0+9VWzLuw@mail.gmail.com>
 <331ec124-f1fa-9e24-797f-36cf19f48085@gmail.com>
 <c92b741b-18b6-547c-4c15-de513f7770a0@gmail.com>
Message-ID: <CAGiTW48CU4w8NXHn_N-6yS_sQNjCzA2JS1NkZ1NnTuxMbqSZNQ@mail.gmail.com>

Thanks for all the replies. I can see that the monotonic ordering is
in-built to support the latest / best version model that CRAN has. That
said it would be great if the policy could be relaxed to allow uploading
older versions which don't necessarily become the "best" version.
Then we could ask users to use versions[1] and run something like do
`install.versions('mypackage', '1.6.3')` if they really want to be in the
1.6.x series.

Thanks
Shivaram

[1] https://github.com/goldingn/versions

On Wed, Oct 25, 2017 at 1:05 PM, Ben Bolker <bbolker at gmail.com> wrote:

>
>
> On 17-10-25 03:47 PM, Duncan Murdoch wrote:
> > On 25/10/2017 2:23 PM, Shivaram Venkataraman wrote:
> >> Hello
> >>
> >> We have an R package that uses semantic versioning -- i.e. version
> >> numbers
> >> are of the form major_version.minor_version.patch_version
> >>
> >> One of the ways we use the patch_versions is to make maintenance
> releases
> >> or security fixes that users can apply without worrying about any
> >> functionality changes. For example if our users were on 1.6.2 it is
> often
> >> easier for them to upgrade to 1.6.3 which has a security fix rather than
> >> 1.7.0
> >>
> >> On the other hand our development continues towards the next minor
> >> version
> >> and we sometimes have cases where say 1.6.3 is released after 1.7.0.
> >>
> >> While running `R CMD check --as-cran` for version 1.6.3 we find that
> this
> >> leads to a warning which looks like 'Insufficient package version
> >> (submitted:
> >> 1.6.3, existing: 1.7.0)'.
> >>
> >> Our question is whether it is okay to upload these maintenance
> >> releases to
> >> CRAN and if there is some way we can mark that the version numbers
> follow
> >> semantic versioning.
> >
> > CRAN won't accept 1.6.3 after 1.7.0 has been published there.  It
> > requires version numbers to be increasing.  There's no provision for the
> > scheme you're following.
> >
> > Even if there were, it's not easy for a user to ask to install any
> > version but the latest one.  They'd need to work out the URL and
> > download the tarball and build it from source.  install.packages() has
> > no provision for handling this automatically.
>
>   If an older version *were* on CRAN (I understand why this isn't
> feasible), devtools::install_version() would take care of some of the
> fussy bits (although it still requires having the build tools installed).
>
>   You can use the 'ref' argument in devtools::install_github to point
> your users to a tag/release number ...
>
> > I'd suggest that you put the patch releases for older versions on Github
> > or some other repository, and explain how users can install directly
> > from there.
> >
> > Duncan Murdoch
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Wed Oct 25 22:45:22 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 25 Oct 2017 16:45:22 -0400
Subject: [R-pkg-devel] Semantic versioning and maintenance releases
In-Reply-To: <CAGiTW48CU4w8NXHn_N-6yS_sQNjCzA2JS1NkZ1NnTuxMbqSZNQ@mail.gmail.com>
References: <CAGiTW4_sdwH4uZFQNCcT80Ag1W=nxiR7rvGHx5+-V0+9VWzLuw@mail.gmail.com>
 <331ec124-f1fa-9e24-797f-36cf19f48085@gmail.com>
 <c92b741b-18b6-547c-4c15-de513f7770a0@gmail.com>
 <CAGiTW48CU4w8NXHn_N-6yS_sQNjCzA2JS1NkZ1NnTuxMbqSZNQ@mail.gmail.com>
Message-ID: <d090ebf0-8c42-99b5-58ca-355ebb25b832@gmail.com>

On 25/10/2017 4:28 PM, Shivaram Venkataraman wrote:
> Thanks for all the replies. I can see that the monotonic ordering is
> in-built to support the latest / best version model that CRAN has. That
> said it would be great if the policy could be relaxed to allow uploading
> older versions which don't necessarily become the "best" version.
> Then we could ask users to use versions[1] and run something like do
> `install.versions('mypackage', '1.6.3')` if they really want to be in the
> 1.6.x series.

I think this would make life harder for CRAN and for other developers, 
so it's unlikely to happen.

For example, suppose both yourpackage 1.6.3 and 1.7.0 are active on 
CRAN, and mypackage declares that it depends on yourpackage.  Then if I 
upload an update to mypackage, which version of yourpackage does CRAN 
install when testing my update?  It would have to test both.

And if mypackage depended on herpackage and hispackage that also had 
multiple active versions on CRAN, things would become unwieldy very quickly.

Duncan Murdoch


> 
> Thanks
> Shivaram
> 
> [1] https://github.com/goldingn/versions
> 
> On Wed, Oct 25, 2017 at 1:05 PM, Ben Bolker <bbolker at gmail.com> wrote:
> 
>>
>>
>> On 17-10-25 03:47 PM, Duncan Murdoch wrote:
>>> On 25/10/2017 2:23 PM, Shivaram Venkataraman wrote:
>>>> Hello
>>>>
>>>> We have an R package that uses semantic versioning -- i.e. version
>>>> numbers
>>>> are of the form major_version.minor_version.patch_version
>>>>
>>>> One of the ways we use the patch_versions is to make maintenance
>> releases
>>>> or security fixes that users can apply without worrying about any
>>>> functionality changes. For example if our users were on 1.6.2 it is
>> often
>>>> easier for them to upgrade to 1.6.3 which has a security fix rather than
>>>> 1.7.0
>>>>
>>>> On the other hand our development continues towards the next minor
>>>> version
>>>> and we sometimes have cases where say 1.6.3 is released after 1.7.0.
>>>>
>>>> While running `R CMD check --as-cran` for version 1.6.3 we find that
>> this
>>>> leads to a warning which looks like 'Insufficient package version
>>>> (submitted:
>>>> 1.6.3, existing: 1.7.0)'.
>>>>
>>>> Our question is whether it is okay to upload these maintenance
>>>> releases to
>>>> CRAN and if there is some way we can mark that the version numbers
>> follow
>>>> semantic versioning.
>>>
>>> CRAN won't accept 1.6.3 after 1.7.0 has been published there.  It
>>> requires version numbers to be increasing.  There's no provision for the
>>> scheme you're following.
>>>
>>> Even if there were, it's not easy for a user to ask to install any
>>> version but the latest one.  They'd need to work out the URL and
>>> download the tarball and build it from source.  install.packages() has
>>> no provision for handling this automatically.
>>
>>    If an older version *were* on CRAN (I understand why this isn't
>> feasible), devtools::install_version() would take care of some of the
>> fussy bits (although it still requires having the build tools installed).
>>
>>    You can use the 'ref' argument in devtools::install_github to point
>> your users to a tag/release number ...
>>
>>> I'd suggest that you put the patch releases for older versions on Github
>>> or some other repository, and explain how users can install directly
>>> from there.
>>>
>>> Duncan Murdoch
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From PDunn2 at usc.edu.au  Thu Oct 26 05:16:12 2017
From: PDunn2 at usc.edu.au (Peter Dunn)
Date: Thu, 26 Oct 2017 03:16:12 +0000
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
Message-ID: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>

Hi all

I am trying to compile (on my Mac) an R package (tweedie) which includes Fortran 77 code. I?m not much of a programmer, but can still manage to write and update F77 code. I?m new to valgrind.

In checking my package (which passes the build-and-check with no errors), I use valgrind like this:

R -d "valgrind  --tool=memcheck --leak-check=full --track-origins=yes" --vanilla  < tweedie-Ex.R


?on my package example, which gives me a series of messages like this:

==53843== Conditional jump or move depends on uninitialised value(s)
==53843==    at 0x1118F61FB: smallp_ (in /Users/pdunn2/Library/R/3.4/library/tweedie/libs/tweedie.so)
==53843==    by 0xBFA4FB88FFFFFFEB: ???
==53843==    by 0x3FF91CB2DA3A50E7: ???
==53843==    by 0x104888757: ???
==53843==    by 0xFFFFFFEC03E375AF: ???
==53843==    by 0x3FE18C2EE1BE47CB: ???
==53843==    by 0x104885DEF: ???
==53843==    by 0x104885DF7: ???
==53843==    by 0x3FE518F314C67BE7: ???
==53843==    by 0x11364CEAF: ???
==53843==    by 0x104885DBF: ???
==53843==    by 0x100000007: ??? (in /Library/Frameworks/R.framework/Resources/bin/exec/R)
==53843==  Uninitialised value was created by a stack allocation
==53843==    at 0x1118F59A6: smallp_ (in /Users/pdunn2/Library/R/3.4/library/tweedie/libs/tweedie.so)



I can see the piece of R code in the example from which this comes.  The subroutine  smallp  is mentioned in the second line of the output.

I simply cannot find the issue.  (Spent days looking so far.)  There are only a few conditional jumps, and everything not passed to the subroutine  smallp  is initialised. I have checked the calls to  smallp  as well. I have compiled the fortran code separately (after wrapping into a complete program), with all kinds of flags:

gfortran -O2 -fimplicit-none  -Wall  -Wline-truncation  -Wcharacter-truncation  -Wsurprising  -Waliasing  -Wunused-parameter  -fwhole-file  -fcheck=all  -std=f2008  -pedantic  -fbacktrace),

Then, using valgrind shows no errors.

So it has got to the point where I simply don?t know what else to do.  I am happy to spend time looking and debugging? but I don?t know what else to do.  Clearly an issue must exist, but I cannot find it.

Can anyone suggest any tools or valgrind flags or anything else that might shed light? Or ways to get more info?  For example, a line number in the Fortran code where the issue first presents, or some such things?  I need some pointers or strategy to make progress with tracking down the issue.

The package has been on CRAN for many years, and I have never noticed any issues with its accuracy that have not been fixed.  But as it stands, I cannot update the package (which I want to do to fix an (unrelated) error).

Thanks for any advice.

P.

> sessionInfo()
R version 3.4.2 (2017-09-28)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Sierra 10.12.6

Matrix products: default
BLAS: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib

locale:
[1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_3.4.2 tools_3.4.2    yaml_2.1.14
>

USC, Locked Bag 4, Maroochydore DC, Queensland, 4558 Australia.
CRICOS Provider No: 01595D
Please consider the environment before printing this email.
This email is confidential. If received in error, please delete it from your system.

	[[alternative HTML version deleted]]


From i.ucar86 at gmail.com  Thu Oct 26 11:38:09 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Thu, 26 Oct 2017 11:38:09 +0200
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
In-Reply-To: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
References: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
Message-ID: <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>

Hi,

2017-10-26 5:16 GMT+02:00 Peter Dunn <PDunn2 at usc.edu.au>:
> Hi all
>
> I am trying to compile (on my Mac) an R package (tweedie) which includes Fortran 77 code. I?m not much of a programmer, but can still manage to write and update F77 code. I?m new to valgrind.
>
> In checking my package (which passes the build-and-check with no errors), I use valgrind like this:
>
> R -d "valgrind  --tool=memcheck --leak-check=full --track-origins=yes" --vanilla  < tweedie-Ex.R
>
>
> ?on my package example, which gives me a series of messages like this:
>
> ==53843== Conditional jump or move depends on uninitialised value(s)
> ==53843==    at 0x1118F61FB: smallp_ (in /Users/pdunn2/Library/R/3.4/library/tweedie/libs/tweedie.so)
> ==53843==    by 0xBFA4FB88FFFFFFEB: ???
> ==53843==    by 0x3FF91CB2DA3A50E7: ???
> ==53843==    by 0x104888757: ???
> ==53843==    by 0xFFFFFFEC03E375AF: ???
> ==53843==    by 0x3FE18C2EE1BE47CB: ???
> ==53843==    by 0x104885DEF: ???
> ==53843==    by 0x104885DF7: ???
> ==53843==    by 0x3FE518F314C67BE7: ???
> ==53843==    by 0x11364CEAF: ???
> ==53843==    by 0x104885DBF: ???
> ==53843==    by 0x100000007: ??? (in /Library/Frameworks/R.framework/Resources/bin/exec/R)
> ==53843==  Uninitialised value was created by a stack allocation
> ==53843==    at 0x1118F59A6: smallp_ (in /Users/pdunn2/Library/R/3.4/library/tweedie/libs/tweedie.so)

CRAN shows a complete backtrace:
https://www.stats.ox.ac.uk/pub/bdr/memtests/valgrind/tweedie/tweedie-Ex.Rout

According to it, the offending conditional jump seems to be this one:

         if (     ( its .LT. 3 )
     &         .OR.
     &            ( ( its .LT. maxit ) .AND.
     &              ( abs(relerr) .GT. aimrerr )
     &            )
     &      ) then

> I can see the piece of R code in the example from which this comes.  The subroutine  smallp  is mentioned in the second line of the output.
>
> I simply cannot find the issue.  (Spent days looking so far.)  There are only a few conditional jumps, and everything not passed to the subroutine  smallp  is initialised. I have checked the calls to  smallp  as well. I have compiled the fortran code separately (after wrapping into a complete program), with all kinds of flags:
>
> gfortran -O2 -fimplicit-none  -Wall  -Wline-truncation  -Wcharacter-truncation  -Wsurprising  -Waliasing  -Wunused-parameter  -fwhole-file  -fcheck=all  -std=f2008  -pedantic  -fbacktrace),

Did you try "-O0 -g" instead of "-O2"?

Regards,
I?aki


From bruce.hoff at sagebase.org  Thu Oct 26 16:36:17 2017
From: bruce.hoff at sagebase.org (Bruce Hoff)
Date: Thu, 26 Oct 2017 07:36:17 -0700
Subject: [R-pkg-devel] Semantic versioning and maintenance releases
Message-ID: <CAAeMkWtVcBvFtcBDajXAmcAB3N5qZOanc+rRbanJocAe-V4dyQ@mail.gmail.com>

Hi:

> I think this would make life harder for CRAN and for other developers,
> so it's unlikely to happen.
> For example, suppose both yourpackage 1.6.3 and 1.7.0 are active on
> CRAN, and mypackage declares that it depends on yourpackage.  Then if I
> upload an update to mypackage, which version of yourpackage does CRAN
> install when testing my update?  It would have to test both.

Respectfully, I don't see why this would be a problem for the author of
'mypackage'.  The author of 'mypackage' is simply one of Shivaram's users
(a consumer of 'yourpackage').  He/she decides whether to depend on v 1.6.3
*or* v 1.7.0 then builds, tests and publishes the appropriate revision of
'mypackage'.  The author of 'mypackage' is free to move up to 1.7.0 when
he/she sees fit, e.g., based on what additional functionality is included
in 1.7.0.

Also, it doesn't seem too bad for CRAN to only allow monotonic increases in
version numbers.  I would hope that Shivaram's series of revisions are
backwards compatible and that the 'patch' included in 1.6.3 is also
included in 1.7.0.  So he should be able to publish 1.7.0 to CRAN and ask
his users to update to that version to get the patch.   There should be no
downside of having the other changes to 'yourpackage'.  If, on the other
hand, 'yourpackage' has changed from 1.6 to 1.7 so much that it computes
different results, then perhaps it should be published under a different
package name ('yourpackage-2').  In that case CRAN should allow both
packages to exist side-by-side in the repository.

Cheers,

Bruce


Date: Wed, 25 Oct 2017 16:45:22 -0400
From: Duncan Murdoch <murdoch.duncan at gmail.com>
To: Shivaram Venkataraman <shivaram.venkataraman at gmail.com>, Ben
        Bolker <bbolker at gmail.com>
Cc: r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Semantic versioning and maintenance
        releases
Message-ID: <d090ebf0-8c42-99b5-58ca-355ebb25b832 at gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed

On 25/10/2017 4:28 PM, Shivaram Venkataraman wrote:
> Thanks for all the replies. I can see that the monotonic ordering is
> in-built to support the latest / best version model that CRAN has. That
> said it would be great if the policy could be relaxed to allow uploading
> older versions which don't necessarily become the "best" version.
> Then we could ask users to use versions[1] and run something like do
> `install.versions('mypackage', '1.6.3')` if they really want to be in the
> 1.6.x series.

I think this would make life harder for CRAN and for other developers,
so it's unlikely to happen.

For example, suppose both yourpackage 1.6.3 and 1.7.0 are active on
CRAN, and mypackage declares that it depends on yourpackage.  Then if I
upload an update to mypackage, which version of yourpackage does CRAN
install when testing my update?  It would have to test both.

And if mypackage depended on herpackage and hispackage that also had
multiple active versions on CRAN, things would become unwieldy very quickly.

Duncan Murdoch


>
> Thanks
> Shivaram
>
> [1] https://github.com/goldingn/versions
>
> On Wed, Oct 25, 2017 at 1:05 PM, Ben Bolker <bbolker at gmail.com> wrote:
>
>>
>>
>> On 17-10-25 03:47 PM, Duncan Murdoch wrote:
>>> On 25/10/2017 2:23 PM, Shivaram Venkataraman wrote:
>>>> Hello
>>>>
>>>> We have an R package that uses semantic versioning -- i.e. version
>>>> numbers
>>>> are of the form major_version.minor_version.patch_version
>>>>
>>>> One of the ways we use the patch_versions is to make maintenance
>> releases
>>>> or security fixes that users can apply without worrying about any
>>>> functionality changes. For example if our users were on 1.6.2 it is
>> often
>>>> easier for them to upgrade to 1.6.3 which has a security fix rather
than
>>>> 1.7.0
>>>>
>>>> On the other hand our development continues towards the next minor
>>>> version
>>>> and we sometimes have cases where say 1.6.3 is released after 1.7.0.
>>>>
>>>> While running `R CMD check --as-cran` for version 1.6.3 we find that
>> this
>>>> leads to a warning which looks like 'Insufficient package version
>>>> (submitted:
>>>> 1.6.3, existing: 1.7.0)'.
>>>>
>>>> Our question is whether it is okay to upload these maintenance
>>>> releases to
>>>> CRAN and if there is some way we can mark that the version numbers
>> follow
>>>> semantic versioning.
>>>
>>> CRAN won't accept 1.6.3 after 1.7.0 has been published there.  It
>>> requires version numbers to be increasing.  There's no provision for the
>>> scheme you're following.
>>>
>>> Even if there were, it's not easy for a user to ask to install any
>>> version but the latest one.  They'd need to work out the URL and
>>> download the tarball and build it from source.  install.packages() has
>>> no provision for handling this automatically.
>>
>>    If an older version *were* on CRAN (I understand why this isn't
>> feasible), devtools::install_version() would take care of some of the
>> fussy bits (although it still requires having the build tools installed).
>>
>>    You can use the 'ref' argument in devtools::install_github to point
>> your users to a tag/release number ...
>>
>>> I'd suggest that you put the patch releases for older versions on Github
>>> or some other repository, and explain how users can install directly
>>> from there.
>>>
>>> Duncan Murdoch
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Thu Oct 26 16:53:24 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 26 Oct 2017 10:53:24 -0400
Subject: [R-pkg-devel] Semantic versioning and maintenance releases
In-Reply-To: <CAAeMkWtVcBvFtcBDajXAmcAB3N5qZOanc+rRbanJocAe-V4dyQ@mail.gmail.com>
References: <CAAeMkWtVcBvFtcBDajXAmcAB3N5qZOanc+rRbanJocAe-V4dyQ@mail.gmail.com>
Message-ID: <88ab8c95-d9c3-62b6-469a-460712e17b20@gmail.com>

On 26/10/2017 10:36 AM, Bruce Hoff wrote:
> Hi:
> 
>> I think this would make life harder for CRAN and for other developers,
>> so it's unlikely to happen.
>> For example, suppose both yourpackage 1.6.3 and 1.7.0 are active on
>> CRAN, and mypackage declares that it depends on yourpackage.  Then if I
>> upload an update to mypackage, which version of yourpackage does CRAN
>> install when testing my update?  It would have to test both.
> 
> Respectfully, I don't see why this would be a problem for the author of
> 'mypackage'.  The author of 'mypackage' is simply one of Shivaram's users
> (a consumer of 'yourpackage').  He/she decides whether to depend on v 1.6.3
> *or* v 1.7.0 then builds, tests and publishes the appropriate revision of
> 'mypackage'. 

You could do that, but it would be very unusual (and fragile) to have 
your package depend on a particular version of another package.  The 
more common thing is to say "Depends:  yourpackage" (or "Imports:", 
etc.), with no version dependency.  Users installing mypackage would 
need to have some version of yourpackage installed, but R would be happy 
with either one.

When there's only one active version of yourpackage, CRAN enforces 
quality by requiring that any update to yourpackage doesn't break 
mypackage (and the other reverse dependencies), and that any update to 
mypackage works with the latest yourpackage.  That's already a lot of 
work.  When I was testing for CRAN, a few packages required 10 or 20 
hours of testing when they submitted an update.

The problem arises if both versions of yourpackage are on CRAN with 
equal status.  Then CRAN shouldn't accept mypackage unless it works fine 
with both, but that's twice as much testing.  And in the extended 
version with n packages having m active versions, it's m^n times as much 
testing.

Duncan Murdoch

  The author of 'mypackage' is free to move up to 1.7.0 when
> he/she sees fit, e.g., based on what additional functionality is included
> in 1.7.0.
> 
> Also, it doesn't seem too bad for CRAN to only allow monotonic increases in
> version numbers.  I would hope that Shivaram's series of revisions are
> backwards compatible and that the 'patch' included in 1.6.3 is also
> included in 1.7.0.  So he should be able to publish 1.7.0 to CRAN and ask
> his users to update to that version to get the patch.   There should be no
> downside of having the other changes to 'yourpackage'.  If, on the other
> hand, 'yourpackage' has changed from 1.6 to 1.7 so much that it computes
> different results, then perhaps it should be published under a different
> package name ('yourpackage-2').  In that case CRAN should allow both
> packages to exist side-by-side in the repository.
> 
> Cheers,
> 
> Bruce
> 
> 
> Date: Wed, 25 Oct 2017 16:45:22 -0400
> From: Duncan Murdoch <murdoch.duncan at gmail.com>
> To: Shivaram Venkataraman <shivaram.venkataraman at gmail.com>, Ben
>          Bolker <bbolker at gmail.com>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] Semantic versioning and maintenance
>          releases
> Message-ID: <d090ebf0-8c42-99b5-58ca-355ebb25b832 at gmail.com>
> Content-Type: text/plain; charset=utf-8; format=flowed
> 
> On 25/10/2017 4:28 PM, Shivaram Venkataraman wrote:
>> Thanks for all the replies. I can see that the monotonic ordering is
>> in-built to support the latest / best version model that CRAN has. That
>> said it would be great if the policy could be relaxed to allow uploading
>> older versions which don't necessarily become the "best" version.
>> Then we could ask users to use versions[1] and run something like do
>> `install.versions('mypackage', '1.6.3')` if they really want to be in the
>> 1.6.x series.
> 
> I think this would make life harder for CRAN and for other developers,
> so it's unlikely to happen.
> 
> For example, suppose both yourpackage 1.6.3 and 1.7.0 are active on
> CRAN, and mypackage declares that it depends on yourpackage.  Then if I
> upload an update to mypackage, which version of yourpackage does CRAN
> install when testing my update?  It would have to test both.
> 
> And if mypackage depended on herpackage and hispackage that also had
> multiple active versions on CRAN, things would become unwieldy very quickly.
> 
> Duncan Murdoch
> 
> 
>>
>> Thanks
>> Shivaram
>>
>> [1] https://github.com/goldingn/versions
>>
>> On Wed, Oct 25, 2017 at 1:05 PM, Ben Bolker <bbolker at gmail.com> wrote:
>>
>>>
>>>
>>> On 17-10-25 03:47 PM, Duncan Murdoch wrote:
>>>> On 25/10/2017 2:23 PM, Shivaram Venkataraman wrote:
>>>>> Hello
>>>>>
>>>>> We have an R package that uses semantic versioning -- i.e. version
>>>>> numbers
>>>>> are of the form major_version.minor_version.patch_version
>>>>>
>>>>> One of the ways we use the patch_versions is to make maintenance
>>> releases
>>>>> or security fixes that users can apply without worrying about any
>>>>> functionality changes. For example if our users were on 1.6.2 it is
>>> often
>>>>> easier for them to upgrade to 1.6.3 which has a security fix rather
> than
>>>>> 1.7.0
>>>>>
>>>>> On the other hand our development continues towards the next minor
>>>>> version
>>>>> and we sometimes have cases where say 1.6.3 is released after 1.7.0.
>>>>>
>>>>> While running `R CMD check --as-cran` for version 1.6.3 we find that
>>> this
>>>>> leads to a warning which looks like 'Insufficient package version
>>>>> (submitted:
>>>>> 1.6.3, existing: 1.7.0)'.
>>>>>
>>>>> Our question is whether it is okay to upload these maintenance
>>>>> releases to
>>>>> CRAN and if there is some way we can mark that the version numbers
>>> follow
>>>>> semantic versioning.
>>>>
>>>> CRAN won't accept 1.6.3 after 1.7.0 has been published there.  It
>>>> requires version numbers to be increasing.  There's no provision for the
>>>> scheme you're following.
>>>>
>>>> Even if there were, it's not easy for a user to ask to install any
>>>> version but the latest one.  They'd need to work out the URL and
>>>> download the tarball and build it from source.  install.packages() has
>>>> no provision for handling this automatically.
>>>
>>>     If an older version *were* on CRAN (I understand why this isn't
>>> feasible), devtools::install_version() would take care of some of the
>>> fussy bits (although it still requires having the build tools installed).
>>>
>>>     You can use the 'ref' argument in devtools::install_github to point
>>> your users to a tag/release number ...
>>>
>>>> I'd suggest that you put the patch releases for older versions on Github
>>>> or some other repository, and explain how users can install directly
>>>> from there.
>>>>
>>>> Duncan Murdoch
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>>        [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From bruce.hoff at sagebase.org  Thu Oct 26 18:50:23 2017
From: bruce.hoff at sagebase.org (Bruce Hoff)
Date: Thu, 26 Oct 2017 09:50:23 -0700
Subject: [R-pkg-devel] Semantic versioning and maintenance releases
In-Reply-To: <88ab8c95-d9c3-62b6-469a-460712e17b20@gmail.com>
References: <CAAeMkWtVcBvFtcBDajXAmcAB3N5qZOanc+rRbanJocAe-V4dyQ@mail.gmail.com>
 <88ab8c95-d9c3-62b6-469a-460712e17b20@gmail.com>
Message-ID: <CAAeMkWtCecg+Fp5g+8wYZzBAVTcnUWW=4GiFZ1q8iMMRhXX3Lw@mail.gmail.com>

I respectfully disagree that it's "fragile" to depend on a particular
version of a package.  On the contrary I think it's the foundation of
making software stable.  Having said this, reading the rest of your
description of how CRAN works is enlightening and emphasizes an underlying
philosophy about backwards compatibility.  As you say:
> CRAN [requires] that any update to yourpackage doesn't break mypackage
So, returning to Shivaram's original question, the answer would be:  You
need to write v 1.7.0 so that it is acceptable to anyone who currently uses
1.6.2. The patch (1.6.3) would be included in 1.7.0 along with other
changes you've made in the course of developing the package.  Those other
changes should not negatively affect anyone currently depending on 1.6.2.
You then publish 1.7.0 to CRAN, for all (both those who want the 1.6.3
patch and those who want the 1.7.0 new features) to adopt.  If you cannot
make 1.7.0 acceptable to current 1.6.2 users, then it has to be published
as a different package ("yourpackage-2").
Thank you,
Bruce


On Thu, Oct 26, 2017 at 7:53 AM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 26/10/2017 10:36 AM, Bruce Hoff wrote:
>
>> Hi:
>>
>> I think this would make life harder for CRAN and for other developers,
>>> so it's unlikely to happen.
>>> For example, suppose both yourpackage 1.6.3 and 1.7.0 are active on
>>> CRAN, and mypackage declares that it depends on yourpackage.  Then if I
>>> upload an update to mypackage, which version of yourpackage does CRAN
>>> install when testing my update?  It would have to test both.
>>>
>>
>> Respectfully, I don't see why this would be a problem for the author of
>> 'mypackage'.  The author of 'mypackage' is simply one of Shivaram's users
>> (a consumer of 'yourpackage').  He/she decides whether to depend on v
>> 1.6.3
>> *or* v 1.7.0 then builds, tests and publishes the appropriate revision of
>> 'mypackage'.
>>
>
> You could do that, but it would be very unusual (and fragile) to have your
> package depend on a particular version of another package.  The more common
> thing is to say "Depends:  yourpackage" (or "Imports:", etc.), with no
> version dependency.  Users installing mypackage would need to have some
> version of yourpackage installed, but R would be happy with either one.
>
> When there's only one active version of yourpackage, CRAN enforces quality
> by requiring that any update to yourpackage doesn't break mypackage (and
> the other reverse dependencies), and that any update to mypackage works
> with the latest yourpackage.  That's already a lot of work.  When I was
> testing for CRAN, a few packages required 10 or 20 hours of testing when
> they submitted an update.
>
> The problem arises if both versions of yourpackage are on CRAN with equal
> status.  Then CRAN shouldn't accept mypackage unless it works fine with
> both, but that's twice as much testing.  And in the extended version with n
> packages having m active versions, it's m^n times as much testing.
>
> Duncan Murdoch
>
>
>  The author of 'mypackage' is free to move up to 1.7.0 when
>
>> he/she sees fit, e.g., based on what additional functionality is included
>> in 1.7.0.
>>
>> Also, it doesn't seem too bad for CRAN to only allow monotonic increases
>> in
>> version numbers.  I would hope that Shivaram's series of revisions are
>> backwards compatible and that the 'patch' included in 1.6.3 is also
>> included in 1.7.0.  So he should be able to publish 1.7.0 to CRAN and ask
>> his users to update to that version to get the patch.   There should be no
>> downside of having the other changes to 'yourpackage'.  If, on the other
>> hand, 'yourpackage' has changed from 1.6 to 1.7 so much that it computes
>> different results, then perhaps it should be published under a different
>> package name ('yourpackage-2').  In that case CRAN should allow both
>> packages to exist side-by-side in the repository.
>>
>> Cheers,
>>
>> Bruce
>>
>>
>> Date: Wed, 25 Oct 2017 16:45:22 -0400
>> From: Duncan Murdoch <murdoch.duncan at gmail.com>
>> To: Shivaram Venkataraman <shivaram.venkataraman at gmail.com>, Ben
>>          Bolker <bbolker at gmail.com>
>> Cc: r-package-devel at r-project.org
>> Subject: Re: [R-pkg-devel] Semantic versioning and maintenance
>>          releases
>> Message-ID: <d090ebf0-8c42-99b5-58ca-355ebb25b832 at gmail.com>
>> Content-Type: text/plain; charset=utf-8; format=flowed
>>
>> On 25/10/2017 4:28 PM, Shivaram Venkataraman wrote:
>>
>>> Thanks for all the replies. I can see that the monotonic ordering is
>>> in-built to support the latest / best version model that CRAN has. That
>>> said it would be great if the policy could be relaxed to allow uploading
>>> older versions which don't necessarily become the "best" version.
>>> Then we could ask users to use versions[1] and run something like do
>>> `install.versions('mypackage', '1.6.3')` if they really want to be in the
>>> 1.6.x series.
>>>
>>
>> I think this would make life harder for CRAN and for other developers,
>> so it's unlikely to happen.
>>
>> For example, suppose both yourpackage 1.6.3 and 1.7.0 are active on
>> CRAN, and mypackage declares that it depends on yourpackage.  Then if I
>> upload an update to mypackage, which version of yourpackage does CRAN
>> install when testing my update?  It would have to test both.
>>
>> And if mypackage depended on herpackage and hispackage that also had
>> multiple active versions on CRAN, things would become unwieldy very
>> quickly.
>>
>> Duncan Murdoch
>>
>>
>>
>>> Thanks
>>> Shivaram
>>>
>>> [1] https://github.com/goldingn/versions
>>>
>>> On Wed, Oct 25, 2017 at 1:05 PM, Ben Bolker <bbolker at gmail.com> wrote:
>>>
>>>
>>>>
>>>> On 17-10-25 03:47 PM, Duncan Murdoch wrote:
>>>>
>>>>> On 25/10/2017 2:23 PM, Shivaram Venkataraman wrote:
>>>>>
>>>>>> Hello
>>>>>>
>>>>>> We have an R package that uses semantic versioning -- i.e. version
>>>>>> numbers
>>>>>> are of the form major_version.minor_version.patch_version
>>>>>>
>>>>>> One of the ways we use the patch_versions is to make maintenance
>>>>>>
>>>>> releases
>>>>
>>>>> or security fixes that users can apply without worrying about any
>>>>>> functionality changes. For example if our users were on 1.6.2 it is
>>>>>>
>>>>> often
>>>>
>>>>> easier for them to upgrade to 1.6.3 which has a security fix rather
>>>>>>
>>>>> than
>>
>>> 1.7.0
>>>>>>
>>>>>> On the other hand our development continues towards the next minor
>>>>>> version
>>>>>> and we sometimes have cases where say 1.6.3 is released after 1.7.0.
>>>>>>
>>>>>> While running `R CMD check --as-cran` for version 1.6.3 we find that
>>>>>>
>>>>> this
>>>>
>>>>> leads to a warning which looks like 'Insufficient package version
>>>>>> (submitted:
>>>>>> 1.6.3, existing: 1.7.0)'.
>>>>>>
>>>>>> Our question is whether it is okay to upload these maintenance
>>>>>> releases to
>>>>>> CRAN and if there is some way we can mark that the version numbers
>>>>>>
>>>>> follow
>>>>
>>>>> semantic versioning.
>>>>>>
>>>>>
>>>>> CRAN won't accept 1.6.3 after 1.7.0 has been published there.  It
>>>>> requires version numbers to be increasing.  There's no provision for
>>>>> the
>>>>> scheme you're following.
>>>>>
>>>>> Even if there were, it's not easy for a user to ask to install any
>>>>> version but the latest one.  They'd need to work out the URL and
>>>>> download the tarball and build it from source.  install.packages() has
>>>>> no provision for handling this automatically.
>>>>>
>>>>
>>>>     If an older version *were* on CRAN (I understand why this isn't
>>>> feasible), devtools::install_version() would take care of some of the
>>>> fussy bits (although it still requires having the build tools
>>>> installed).
>>>>
>>>>     You can use the 'ref' argument in devtools::install_github to point
>>>> your users to a tag/release number ...
>>>>
>>>> I'd suggest that you put the patch releases for older versions on Github
>>>>> or some other repository, and explain how users can install directly
>>>>> from there.
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>>
>

	[[alternative HTML version deleted]]


From shivaram.venkataraman at gmail.com  Thu Oct 26 19:09:41 2017
From: shivaram.venkataraman at gmail.com (Shivaram Venkataraman)
Date: Thu, 26 Oct 2017 10:09:41 -0700
Subject: [R-pkg-devel] Semantic versioning and maintenance releases
In-Reply-To: <CAAeMkWtCecg+Fp5g+8wYZzBAVTcnUWW=4GiFZ1q8iMMRhXX3Lw@mail.gmail.com>
References: <CAAeMkWtVcBvFtcBDajXAmcAB3N5qZOanc+rRbanJocAe-V4dyQ@mail.gmail.com>
 <88ab8c95-d9c3-62b6-469a-460712e17b20@gmail.com>
 <CAAeMkWtCecg+Fp5g+8wYZzBAVTcnUWW=4GiFZ1q8iMMRhXX3Lw@mail.gmail.com>
Message-ID: <CAGiTW48rf8V_wDxN3atjhFyepCNfOydqim_F+81sDTG7Uk291w@mail.gmail.com>

FWIW the patches in 1.6.3 are always a part of 1.7.0 -- its just that 1.7.0
has a lot of other new stuff in it as well and enterprises are sometimes
more likely to upgrade to a patch release rather than the next minor
version.

Overall I think my understanding from this thread is that one should see
CRAN as the package dependency manager which has the latest stable version
of a package and not necessarily all the available versions for a package.
For hosting prior versions including patch releases its typically better to
use a separate repository (e.g., github) and give users instructions on how
to use this. Of course in this case the user is taking responsibility of
figuring out if this version is compatible with all their other packages.

Thanks
Shivaram

On Thu, Oct 26, 2017 at 9:50 AM, Bruce Hoff <bruce.hoff at sagebase.org> wrote:

> I respectfully disagree that it's "fragile" to depend on a particular
> version of a package.  On the contrary I think it's the foundation of
> making software stable.  Having said this, reading the rest of your
> description of how CRAN works is enlightening and emphasizes an underlying
> philosophy about backwards compatibility.  As you say:
> > CRAN [requires] that any update to yourpackage doesn't break mypackage
> So, returning to Shivaram's original question, the answer would be:  You
> need to write v 1.7.0 so that it is acceptable to anyone who currently uses
> 1.6.2. The patch (1.6.3) would be included in 1.7.0 along with other
> changes you've made in the course of developing the package.  Those other
> changes should not negatively affect anyone currently depending on 1.6.2.
> You then publish 1.7.0 to CRAN, for all (both those who want the 1.6.3
> patch and those who want the 1.7.0 new features) to adopt.  If you cannot
> make 1.7.0 acceptable to current 1.6.2 users, then it has to be published
> as a different package ("yourpackage-2").
> Thank you,
> Bruce
>
>
> On Thu, Oct 26, 2017 at 7:53 AM, Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
>
> > On 26/10/2017 10:36 AM, Bruce Hoff wrote:
> >
> >> Hi:
> >>
> >> I think this would make life harder for CRAN and for other developers,
> >>> so it's unlikely to happen.
> >>> For example, suppose both yourpackage 1.6.3 and 1.7.0 are active on
> >>> CRAN, and mypackage declares that it depends on yourpackage.  Then if I
> >>> upload an update to mypackage, which version of yourpackage does CRAN
> >>> install when testing my update?  It would have to test both.
> >>>
> >>
> >> Respectfully, I don't see why this would be a problem for the author of
> >> 'mypackage'.  The author of 'mypackage' is simply one of Shivaram's
> users
> >> (a consumer of 'yourpackage').  He/she decides whether to depend on v
> >> 1.6.3
> >> *or* v 1.7.0 then builds, tests and publishes the appropriate revision
> of
> >> 'mypackage'.
> >>
> >
> > You could do that, but it would be very unusual (and fragile) to have
> your
> > package depend on a particular version of another package.  The more
> common
> > thing is to say "Depends:  yourpackage" (or "Imports:", etc.), with no
> > version dependency.  Users installing mypackage would need to have some
> > version of yourpackage installed, but R would be happy with either one.
> >
> > When there's only one active version of yourpackage, CRAN enforces
> quality
> > by requiring that any update to yourpackage doesn't break mypackage (and
> > the other reverse dependencies), and that any update to mypackage works
> > with the latest yourpackage.  That's already a lot of work.  When I was
> > testing for CRAN, a few packages required 10 or 20 hours of testing when
> > they submitted an update.
> >
> > The problem arises if both versions of yourpackage are on CRAN with equal
> > status.  Then CRAN shouldn't accept mypackage unless it works fine with
> > both, but that's twice as much testing.  And in the extended version
> with n
> > packages having m active versions, it's m^n times as much testing.
> >
> > Duncan Murdoch
> >
> >
> >  The author of 'mypackage' is free to move up to 1.7.0 when
> >
> >> he/she sees fit, e.g., based on what additional functionality is
> included
> >> in 1.7.0.
> >>
> >> Also, it doesn't seem too bad for CRAN to only allow monotonic increases
> >> in
> >> version numbers.  I would hope that Shivaram's series of revisions are
> >> backwards compatible and that the 'patch' included in 1.6.3 is also
> >> included in 1.7.0.  So he should be able to publish 1.7.0 to CRAN and
> ask
> >> his users to update to that version to get the patch.   There should be
> no
> >> downside of having the other changes to 'yourpackage'.  If, on the other
> >> hand, 'yourpackage' has changed from 1.6 to 1.7 so much that it computes
> >> different results, then perhaps it should be published under a different
> >> package name ('yourpackage-2').  In that case CRAN should allow both
> >> packages to exist side-by-side in the repository.
> >>
> >> Cheers,
> >>
> >> Bruce
> >>
> >>
> >> Date: Wed, 25 Oct 2017 16:45:22 -0400
> >> From: Duncan Murdoch <murdoch.duncan at gmail.com>
> >> To: Shivaram Venkataraman <shivaram.venkataraman at gmail.com>, Ben
> >>          Bolker <bbolker at gmail.com>
> >> Cc: r-package-devel at r-project.org
> >> Subject: Re: [R-pkg-devel] Semantic versioning and maintenance
> >>          releases
> >> Message-ID: <d090ebf0-8c42-99b5-58ca-355ebb25b832 at gmail.com>
> >> Content-Type: text/plain; charset=utf-8; format=flowed
> >>
> >> On 25/10/2017 4:28 PM, Shivaram Venkataraman wrote:
> >>
> >>> Thanks for all the replies. I can see that the monotonic ordering is
> >>> in-built to support the latest / best version model that CRAN has. That
> >>> said it would be great if the policy could be relaxed to allow
> uploading
> >>> older versions which don't necessarily become the "best" version.
> >>> Then we could ask users to use versions[1] and run something like do
> >>> `install.versions('mypackage', '1.6.3')` if they really want to be in
> the
> >>> 1.6.x series.
> >>>
> >>
> >> I think this would make life harder for CRAN and for other developers,
> >> so it's unlikely to happen.
> >>
> >> For example, suppose both yourpackage 1.6.3 and 1.7.0 are active on
> >> CRAN, and mypackage declares that it depends on yourpackage.  Then if I
> >> upload an update to mypackage, which version of yourpackage does CRAN
> >> install when testing my update?  It would have to test both.
> >>
> >> And if mypackage depended on herpackage and hispackage that also had
> >> multiple active versions on CRAN, things would become unwieldy very
> >> quickly.
> >>
> >> Duncan Murdoch
> >>
> >>
> >>
> >>> Thanks
> >>> Shivaram
> >>>
> >>> [1] https://github.com/goldingn/versions
> >>>
> >>> On Wed, Oct 25, 2017 at 1:05 PM, Ben Bolker <bbolker at gmail.com> wrote:
> >>>
> >>>
> >>>>
> >>>> On 17-10-25 03:47 PM, Duncan Murdoch wrote:
> >>>>
> >>>>> On 25/10/2017 2:23 PM, Shivaram Venkataraman wrote:
> >>>>>
> >>>>>> Hello
> >>>>>>
> >>>>>> We have an R package that uses semantic versioning -- i.e. version
> >>>>>> numbers
> >>>>>> are of the form major_version.minor_version.patch_version
> >>>>>>
> >>>>>> One of the ways we use the patch_versions is to make maintenance
> >>>>>>
> >>>>> releases
> >>>>
> >>>>> or security fixes that users can apply without worrying about any
> >>>>>> functionality changes. For example if our users were on 1.6.2 it is
> >>>>>>
> >>>>> often
> >>>>
> >>>>> easier for them to upgrade to 1.6.3 which has a security fix rather
> >>>>>>
> >>>>> than
> >>
> >>> 1.7.0
> >>>>>>
> >>>>>> On the other hand our development continues towards the next minor
> >>>>>> version
> >>>>>> and we sometimes have cases where say 1.6.3 is released after 1.7.0.
> >>>>>>
> >>>>>> While running `R CMD check --as-cran` for version 1.6.3 we find that
> >>>>>>
> >>>>> this
> >>>>
> >>>>> leads to a warning which looks like 'Insufficient package version
> >>>>>> (submitted:
> >>>>>> 1.6.3, existing: 1.7.0)'.
> >>>>>>
> >>>>>> Our question is whether it is okay to upload these maintenance
> >>>>>> releases to
> >>>>>> CRAN and if there is some way we can mark that the version numbers
> >>>>>>
> >>>>> follow
> >>>>
> >>>>> semantic versioning.
> >>>>>>
> >>>>>
> >>>>> CRAN won't accept 1.6.3 after 1.7.0 has been published there.  It
> >>>>> requires version numbers to be increasing.  There's no provision for
> >>>>> the
> >>>>> scheme you're following.
> >>>>>
> >>>>> Even if there were, it's not easy for a user to ask to install any
> >>>>> version but the latest one.  They'd need to work out the URL and
> >>>>> download the tarball and build it from source.  install.packages()
> has
> >>>>> no provision for handling this automatically.
> >>>>>
> >>>>
> >>>>     If an older version *were* on CRAN (I understand why this isn't
> >>>> feasible), devtools::install_version() would take care of some of the
> >>>> fussy bits (although it still requires having the build tools
> >>>> installed).
> >>>>
> >>>>     You can use the 'ref' argument in devtools::install_github to
> point
> >>>> your users to a tag/release number ...
> >>>>
> >>>> I'd suggest that you put the patch releases for older versions on
> Github
> >>>>> or some other repository, and explain how users can install directly
> >>>>> from there.
> >>>>>
> >>>>> Duncan Murdoch
> >>>>>
> >>>>> ______________________________________________
> >>>>> R-package-devel at r-project.org mailing list
> >>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>>>
> >>>>
> >>>> ______________________________________________
> >>>> R-package-devel at r-project.org mailing list
> >>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>>
> >>>>
> >>>        [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-package-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>
> >>>
> >>         [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >>
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Thu Oct 26 19:35:54 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 26 Oct 2017 13:35:54 -0400
Subject: [R-pkg-devel] Semantic versioning and maintenance releases
In-Reply-To: <CAAeMkWtCecg+Fp5g+8wYZzBAVTcnUWW=4GiFZ1q8iMMRhXX3Lw@mail.gmail.com>
References: <CAAeMkWtVcBvFtcBDajXAmcAB3N5qZOanc+rRbanJocAe-V4dyQ@mail.gmail.com>
 <88ab8c95-d9c3-62b6-469a-460712e17b20@gmail.com>
 <CAAeMkWtCecg+Fp5g+8wYZzBAVTcnUWW=4GiFZ1q8iMMRhXX3Lw@mail.gmail.com>
Message-ID: <4740371f-d0e7-de56-6457-fd3b4ec2a035@gmail.com>

On 26/10/2017 12:50 PM, Bruce Hoff wrote:
> I respectfully disagree that it's "fragile" to depend on a particular 
> version of a package.? On the contrary I think it's the foundation of 
> making software stable.

In general that might be true, but for R it's not.  If mypackage 
requires version 1.7.0 of yourpackage, and you release 1.7.1, suddenly 
lots of people will have trouble installing mine, because although CRAN 
will keep 1.7.0 around indefinitely, it won't keep binary builds of it 
around.  Lots of Windows and Mac users depend on CRAN to do the building 
for them.

 ? Having said this, reading the rest of your
> description of how CRAN works is enlightening and emphasizes an 
> underlying philosophy about backwards compatibility.? As you say:
>  > CRAN [requires] that any update to yourpackage doesn't break mypackage
> So, returning to Shivaram's original question, the answer would be:? You 
> need to write v 1.7.0 so that it is acceptable to anyone who currently 
> uses 1.6.2. 

I oversimplified that a bit.  CRAN doesn't absolutely require backwards 
compatibility, they just discourage incompatibility by requiring you to 
help your reverse dependencies cope with changes.  If your update breaks 
a revdep, you need to explain what you did to help the revdep author 
cope with it, and it needs to be enough that CRAN agrees that package 
author is being negligent by not adapting.  Or something like that.

Duncan Murdoch

The patch (1.6.3) would be included in 1.7.0 along with
> other changes you've made in the course of developing the package.  
> Those other changes should not negatively affect anyone currently 
> depending on 1.6.2.? You then publish 1.7.0 to CRAN, for all (both those 
> who want the 1.6.3 patch and those who want the 1.7.0 new features) to 
> adopt.? If you cannot make 1.7.0 acceptable to current 1.6.2 users, then 
> it has to be published as a different package ("yourpackage-2").
> Thank you,
> Bruce
> 
> 
> On Thu, Oct 26, 2017 at 7:53 AM, Duncan Murdoch 
> <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>> wrote:
> 
>     On 26/10/2017 10:36 AM, Bruce Hoff wrote:
> 
>         Hi:
> 
>             I think this would make life harder for CRAN and for other
>             developers,
>             so it's unlikely to happen.
>             For example, suppose both yourpackage 1.6.3 and 1.7.0 are
>             active on
>             CRAN, and mypackage declares that it depends on
>             yourpackage.? Then if I
>             upload an update to mypackage, which version of yourpackage
>             does CRAN
>             install when testing my update?? It would have to test both.
> 
> 
>         Respectfully, I don't see why this would be a problem for the
>         author of
>         'mypackage'.? The author of 'mypackage' is simply one of
>         Shivaram's users
>         (a consumer of 'yourpackage').? He/she decides whether to depend
>         on v 1.6.3
>         *or* v 1.7.0 then builds, tests and publishes the appropriate
>         revision of
>         'mypackage'.
> 
> 
>     You could do that, but it would be very unusual (and fragile) to
>     have your package depend on a particular version of another
>     package.? The more common thing is to say "Depends:? yourpackage"
>     (or "Imports:", etc.), with no version dependency.? Users installing
>     mypackage would need to have some version of yourpackage installed,
>     but R would be happy with either one.
> 
>     When there's only one active version of yourpackage, CRAN enforces
>     quality by requiring that any update to yourpackage doesn't break
>     mypackage (and the other reverse dependencies), and that any update
>     to mypackage works with the latest yourpackage.? That's already a
>     lot of work.? When I was testing for CRAN, a few packages required
>     10 or 20 hours of testing when they submitted an update.
> 
>     The problem arises if both versions of yourpackage are on CRAN with
>     equal status.? Then CRAN shouldn't accept mypackage unless it works
>     fine with both, but that's twice as much testing.? And in the
>     extended version with n packages having m active versions, it's m^n
>     times as much testing.
> 
>     Duncan Murdoch
> 
> 
>      ?The author of 'mypackage' is free to move up to 1.7.0 when
> 
>         he/she sees fit, e.g., based on what additional functionality is
>         included
>         in 1.7.0.
> 
>         Also, it doesn't seem too bad for CRAN to only allow monotonic
>         increases in
>         version numbers.? I would hope that Shivaram's series of
>         revisions are
>         backwards compatible and that the 'patch' included in 1.6.3 is also
>         included in 1.7.0.? So he should be able to publish 1.7.0 to
>         CRAN and ask
>         his users to update to that version to get the patch.? ?There
>         should be no
>         downside of having the other changes to 'yourpackage'.? If, on
>         the other
>         hand, 'yourpackage' has changed from 1.6 to 1.7 so much that it
>         computes
>         different results, then perhaps it should be published under a
>         different
>         package name ('yourpackage-2').? In that case CRAN should allow both
>         packages to exist side-by-side in the repository.
> 
>         Cheers,
> 
>         Bruce
> 
> 
>         Date: Wed, 25 Oct 2017 16:45:22 -0400
>         From: Duncan Murdoch <murdoch.duncan at gmail.com
>         <mailto:murdoch.duncan at gmail.com>>
>         To: Shivaram Venkataraman <shivaram.venkataraman at gmail.com
>         <mailto:shivaram.venkataraman at gmail.com>>, Ben
>          ? ? ? ? ?Bolker <bbolker at gmail.com <mailto:bbolker at gmail.com>>
>         Cc: r-package-devel at r-project.org
>         <mailto:r-package-devel at r-project.org>
>         Subject: Re: [R-pkg-devel] Semantic versioning and maintenance
>          ? ? ? ? ?releases
>         Message-ID: <d090ebf0-8c42-99b5-58ca-355ebb25b832 at gmail.com
>         <mailto:d090ebf0-8c42-99b5-58ca-355ebb25b832 at gmail.com>>
>         Content-Type: text/plain; charset=utf-8; format=flowed
> 
>         On 25/10/2017 4:28 PM, Shivaram Venkataraman wrote:
> 
>             Thanks for all the replies. I can see that the monotonic
>             ordering is
>             in-built to support the latest / best version model that
>             CRAN has. That
>             said it would be great if the policy could be relaxed to
>             allow uploading
>             older versions which don't necessarily become the "best"
>             version.
>             Then we could ask users to use versions[1] and run something
>             like do
>             `install.versions('mypackage', '1.6.3')` if they really want
>             to be in the
>             1.6.x series.
> 
> 
>         I think this would make life harder for CRAN and for other
>         developers,
>         so it's unlikely to happen.
> 
>         For example, suppose both yourpackage 1.6.3 and 1.7.0 are active on
>         CRAN, and mypackage declares that it depends on yourpackage. 
>         Then if I
>         upload an update to mypackage, which version of yourpackage does
>         CRAN
>         install when testing my update?? It would have to test both.
> 
>         And if mypackage depended on herpackage and hispackage that also had
>         multiple active versions on CRAN, things would become unwieldy
>         very quickly.
> 
>         Duncan Murdoch
> 
> 
> 
>             Thanks
>             Shivaram
> 
>             [1] https://github.com/goldingn/versions
>             <https://github.com/goldingn/versions>
> 
>             On Wed, Oct 25, 2017 at 1:05 PM, Ben Bolker
>             <bbolker at gmail.com <mailto:bbolker at gmail.com>> wrote:
> 
> 
> 
>                 On 17-10-25 03:47 PM, Duncan Murdoch wrote:
> 
>                     On 25/10/2017 2:23 PM, Shivaram Venkataraman wrote:
> 
>                         Hello
> 
>                         We have an R package that uses semantic
>                         versioning -- i.e. version
>                         numbers
>                         are of the form major_version.minor_version.pa
>                         <http://major_version.minor_version.pa>tch_version
> 
>                         One of the ways we use the patch_versions is to
>                         make maintenance
> 
>                 releases
> 
>                         or security fixes that users can apply without
>                         worrying about any
>                         functionality changes. For example if our users
>                         were on 1.6.2 it is
> 
>                 often
> 
>                         easier for them to upgrade to 1.6.3 which has a
>                         security fix rather
> 
>         than
> 
>                         1.7.0
> 
>                         On the other hand our development continues
>                         towards the next minor
>                         version
>                         and we sometimes have cases where say 1.6.3 is
>                         released after 1.7.0.
> 
>                         While running `R CMD check --as-cran` for
>                         version 1.6.3 we find that
> 
>                 this
> 
>                         leads to a warning which looks like
>                         'Insufficient package version
>                         (submitted:
>                         1.6.3, existing: 1.7.0)'.
> 
>                         Our question is whether it is okay to upload
>                         these maintenance
>                         releases to
>                         CRAN and if there is some way we can mark that
>                         the version numbers
> 
>                 follow
> 
>                         semantic versioning.
> 
> 
>                     CRAN won't accept 1.6.3 after 1.7.0 has been
>                     published there.? It
>                     requires version numbers to be increasing.? There's
>                     no provision for the
>                     scheme you're following.
> 
>                     Even if there were, it's not easy for a user to ask
>                     to install any
>                     version but the latest one.? They'd need to work out
>                     the URL and
>                     download the tarball and build it from source. 
>                     install.packages() has
>                     no provision for handling this automatically.
> 
> 
>                  ? ? If an older version *were* on CRAN (I understand
>                 why this isn't
>                 feasible), devtools::install_version() would take care
>                 of some of the
>                 fussy bits (although it still requires having the build
>                 tools installed).
> 
>                  ? ? You can use the 'ref' argument in
>                 devtools::install_github to point
>                 your users to a tag/release number ...
> 
>                     I'd suggest that you put the patch releases for
>                     older versions on Github
>                     or some other repository, and explain how users can
>                     install directly
>                     from there.
> 
>                     Duncan Murdoch
> 
>                     ______________________________________________
>                     R-package-devel at r-project.org
>                     <mailto:R-package-devel at r-project.org> mailing list
>                     https://stat.ethz.ch/mailman/listinfo/r-package-devel <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> 
> 
>                 ______________________________________________
>                 R-package-devel at r-project.org
>                 <mailto:R-package-devel at r-project.org> mailing list
>                 https://stat.ethz.ch/mailman/listinfo/r-package-devel
>                 <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> 
> 
>              ? ? ? ?[[alternative HTML version deleted]]
> 
>             ______________________________________________
>             R-package-devel at r-project.org
>             <mailto:R-package-devel at r-project.org> mailing list
>             https://stat.ethz.ch/mailman/listinfo/r-package-devel
>             <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> 
> 
>          ? ? ? ? [[alternative HTML version deleted]]
> 
>         ______________________________________________
>         R-package-devel at r-project.org
>         <mailto:R-package-devel at r-project.org> mailing list
>         https://stat.ethz.ch/mailman/listinfo/r-package-devel
>         <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> 
> 
>


From tkeitt at utexas.edu  Sun Oct 29 19:25:54 2017
From: tkeitt at utexas.edu (Tim Keitt)
Date: Sun, 29 Oct 2017 13:25:54 -0500
Subject: [R-pkg-devel] -Wlong-long
Message-ID: <CANnL8gqcmmo5T-E2ByPriShSsFbgEgGrQeYTrYVRLbMtmKKOtQ@mail.gmail.com>

Anyone have a fix for:

Found the following significant warnings:
  ../windows/libpq-9.5.2/include/pg_config_ext.h:8:28: warning: ISO
C++ 1998 does not support 'long long' [-Wlong-long]


? I tried prepending __extension__ to the definition and adding CXX_STD =
CXX11 to Makevars. This is external code from postgres that is used to
build libpq.

THK


http://www.keittlab.org/

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Sun Oct 29 20:56:44 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 29 Oct 2017 20:56:44 +0100
Subject: [R-pkg-devel] -Wlong-long
In-Reply-To: <CANnL8gqcmmo5T-E2ByPriShSsFbgEgGrQeYTrYVRLbMtmKKOtQ@mail.gmail.com>
References: <CANnL8gqcmmo5T-E2ByPriShSsFbgEgGrQeYTrYVRLbMtmKKOtQ@mail.gmail.com>
Message-ID: <fad5b053-72d0-973c-0915-643cca5be32d@statistik.tu-dortmund.de>



On 29.10.2017 19:25, Tim Keitt wrote:
> Anyone have a fix for:
> 
> Found the following significant warnings:
>    ../windows/libpq-9.5.2/include/pg_config_ext.h:8:28: warning: ISO
> C++ 1998 does not support 'long long' [-Wlong-long]
> 
> 
> ? I tried prepending __extension__ to the definition and adding CXX_STD =
> CXX11 to Makevars. This is external code from postgres that is used to
> build libpq.


See Writing R Extesions on how to ask for C++11

Best,
Uwe Ligges


> 
> THK
> 
> 
> http://www.keittlab.org/
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From tkeitt at utexas.edu  Sun Oct 29 23:47:46 2017
From: tkeitt at utexas.edu (Tim Keitt)
Date: Sun, 29 Oct 2017 17:47:46 -0500
Subject: [R-pkg-devel] -Wlong-long
In-Reply-To: <fad5b053-72d0-973c-0915-643cca5be32d@statistik.tu-dortmund.de>
References: <CANnL8gqcmmo5T-E2ByPriShSsFbgEgGrQeYTrYVRLbMtmKKOtQ@mail.gmail.com>
 <fad5b053-72d0-973c-0915-643cca5be32d@statistik.tu-dortmund.de>
Message-ID: <CANnL8gowmLj3PN=niFA=XotTLZrvnu6ph3_zmTDLWJkoobBb6Q@mail.gmail.com>

http://www.keittlab.org/

On Sun, Oct 29, 2017 at 2:56 PM, Uwe Ligges <ligges at statistik.tu-dortmund.de
> wrote:

>
>
> On 29.10.2017 19:25, Tim Keitt wrote:
>
>> Anyone have a fix for:
>>
>> Found the following significant warnings:
>>    ../windows/libpq-9.5.2/include/pg_config_ext.h:8:28: warning: ISO
>> C++ 1998 does not support 'long long' [-Wlong-long]
>>
>>
>> ? I tried prepending __extension__ to the definition and adding CXX_STD =
>> CXX11 to Makevars. This is external code from postgres that is used to
>> build libpq.
>>
>
>
> See Writing R Extesions on how to ask for C++11
>

Thought I did that! I will re-read. Perhaps I got it wrong.

THK


>
> Best,
> Uwe Ligges
>
>
>
>> THK
>>
>>
>> http://www.keittlab.org/
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From PDunn2 at usc.edu.au  Mon Oct 30 00:54:54 2017
From: PDunn2 at usc.edu.au (Peter Dunn)
Date: Sun, 29 Oct 2017 23:54:54 +0000
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
In-Reply-To: <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>
References: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
 <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>
Message-ID: <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>

Thanks for this direction.

But I am still confused, as the problem persists after attending to any possible issue: That piece of identified code only has four variables, and I can account for them all.

The two variables  its  and  aimrerr  are now explicitly initialised.  So they cannot be the problem.

The variables  maxit  and relerr  are inputs to the subroutine... and both are explicitly initialised in the only subroutine which calls  smallp.  So I can?t see how that can be a problem. (Clearly they cannot be initialised in the subroutine  smallp  or their input values are overwritten.)

Any more idea for where I should be looking, or how I can progress this?  Using the flags below when  gfortran  is called, with  -O0 ?g included, produced no errors or warnings at all.

Thanks again.  I just don?t know how else to track down the error, and it?s driving me crazy.

P.



From: I?aki ?car <i.ucar86 at gmail.com>
Date: Thursday, 26 October 2017 at 7:38 pm
To: Peter Dunn <PDunn2 at usc.edu.au>
Cc: "r-package-devel at r-project.org" <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] Package valgrind problem I can't solve: Direction?

Hi,

2017-10-26 5:16 GMT+02:00 Peter Dunn <PDunn2 at usc.edu.au>:
> Hi all
>
> I am trying to compile (on my Mac) an R package (tweedie) which includes Fortran 77 code. I?m not much of a programmer, but can still manage to write and update F77 code. I?m new to valgrind.
>
> In checking my package (which passes the build-and-check with no errors), I use valgrind like this:
>
> R -d "valgrind --tool=memcheck --leak-check=full --track-origins=yes" --vanilla < tweedie-Ex.R
>
>
> ?on my package example, which gives me a series of messages like this:
>
> ==53843== Conditional jump or move depends on uninitialised value(s)
> ==53843== at 0x1118F61FB: smallp_ (in /Users/pdunn2/Library/R/3.4/library/tweedie/libs/tweedie.so)
> ==53843== by 0xBFA4FB88FFFFFFEB: ???
> ==53843== by 0x3FF91CB2DA3A50E7: ???
> ==53843== by 0x104888757: ???
> ==53843== by 0xFFFFFFEC03E375AF: ???
> ==53843== by 0x3FE18C2EE1BE47CB: ???
> ==53843== by 0x104885DEF: ???
> ==53843== by 0x104885DF7: ???
> ==53843== by 0x3FE518F314C67BE7: ???
> ==53843== by 0x11364CEAF: ???
> ==53843== by 0x104885DBF: ???
> ==53843== by 0x100000007: ??? (in /Library/Frameworks/R.framework/Resources/bin/exec/R)
> ==53843== Uninitialised value was created by a stack allocation
> ==53843== at 0x1118F59A6: smallp_ (in /Users/pdunn2/Library/R/3.4/library/tweedie/libs/tweedie.so)

CRAN shows a complete backtrace:
https://www.stats.ox.ac.uk/pub/bdr/memtests/valgrind/tweedie/tweedie-Ex.Rout

According to it, the offending conditional jump seems to be this one:

if ( ( its .LT. 3 )
& .OR.
& ( ( its .LT. maxit ) .AND.
& ( abs(relerr) .GT. aimrerr )
& )
& ) then

> I can see the piece of R code in the example from which this comes. The subroutine smallp is mentioned in the second line of the output.
>
> I simply cannot find the issue. (Spent days looking so far.) There are only a few conditional jumps, and everything not passed to the subroutine smallp is initialised. I have checked the calls to smallp as well. I have compiled the fortran code separately (after wrapping into a complete program), with all kinds of flags:
>
> gfortran -O2 -fimplicit-none -Wall -Wline-truncation -Wcharacter-truncation -Wsurprising -Waliasing -Wunused-parameter -fwhole-file -fcheck=all -std=f2008 -pedantic -fbacktrace),

Did you try "-O0 -g" instead of "-O2"?

Regards,
I?aki



USC, Locked Bag 4, Maroochydore DC, Queensland, 4558 Australia.
CRICOS Provider No: 01595D
Please consider the environment before printing this email.
This email is confidential. If received in error, please delete it from your system.

	[[alternative HTML version deleted]]


From i.ucar86 at gmail.com  Mon Oct 30 01:43:14 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Mon, 30 Oct 2017 01:43:14 +0100
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
In-Reply-To: <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>
References: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
 <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>
 <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>
Message-ID: <CALEXWq1+VV22gtVro3ihAUVoSt_YhkG2krcjQHQFw9j2FOqd6g@mail.gmail.com>

2017-10-30 0:54 GMT+01:00 Peter Dunn <PDunn2 at usc.edu.au>:
> Thanks for this direction.
>
> But I am still confused, as the problem persists after attending to any
> possible issue: That piece of identified code only has four variables, and I
> can account for them all.
>
> The two variables its and aimrerr are now explicitly initialised. So they
> cannot be the problem.
>
> The variables maxit and relerr are inputs to the subroutine... and both are
> explicitly initialised in the only subroutine which calls smallp. So I can?t
> see how that can be a problem. (Clearly they cannot be initialised in the
> subroutine smallp or their input values are overwritten.)

Maybe the location is wrong. What about the "result" variable in the
"smallp" subroutine? Shouldn't it be initialised?

> Any more idea for where I should be looking, or how I can progress this?
> Using the flags below when gfortran is called, with -O0 ?g included,
> produced no errors or warnings at all.

Given that the issue disappears depending on the optimisation level,
maybe it is a false error.

I?aki


From i.ucar86 at gmail.com  Mon Oct 30 12:06:20 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Mon, 30 Oct 2017 12:06:20 +0100
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
In-Reply-To: <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>
References: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
 <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>
 <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>
Message-ID: <CALEXWq1Tsip+NLic8Wn6sh42VZMgpLuP1_k4msOHkDPXH2yN-Q@mail.gmail.com>

2017-10-30 0:54 GMT+01:00 Peter Dunn <PDunn2 at usc.edu.au>:
> Thanks for this direction.
>
> But I am still confused, as the problem persists after attending to any
> possible issue: That piece of identified code only has four variables, and I
> can account for them all.
>
> The two variables its and aimrerr are now explicitly initialised. So they
> cannot be the problem.
>
> The variables maxit and relerr are inputs to the subroutine... and both are
> explicitly initialised in the only subroutine which calls smallp. So I can?t
> see how that can be a problem. (Clearly they cannot be initialised in the
> subroutine smallp or their input values are overwritten.)

Found it. "relerr" may be uninitialised because "w" is uninitialised
in smallp (tweedie 2.2.5, line 2169).

When you try to debug this kind of things, you must track not only
explicit initialisations, but also all the assignments with possibly
uninitialised variables.

BTW, I also see:

tweedie.f:335:0:

             if ( funvalue .LT. exp(-lambda) ) then

Warning: 'lambda' may be used uninitialized in this function
[-Wmaybe-uninitialized]

Regards,
I?aki


From rubak at math.aau.dk  Tue Oct 31 15:02:20 2017
From: rubak at math.aau.dk (Ege Rubak)
Date: Tue, 31 Oct 2017 15:02:20 +0100
Subject: [R-pkg-devel] Reducing installed package size with --strip-debug
Message-ID: <97b9ce2e-83d3-28c7-474e-d8d884e73309@math.aau.dk>

Hi,

Based on Dirk's blog post [1] about stripping debug information from the 
shared object of my package `s2` I reduced the shared object file size 
from 7 to 0.7 MB and get rid of a NOTE about the installed package size 
(on my local Linux machine).

Dirk suggests that one could conditionally do this in the Makevars file 
if the strip tool is available (typically the case on Linux). Does 
anybody know what CRAN's take is on this?

Cheers,
Ege

[1]: 
http://dirk.eddelbuettel.com/blog/2017/08/14/#009_compact_shared_libraries

-- 
Ege Rubak, Associate Professor,
Department of Mathematical Sciences, Aalborg University
Skjernvej 4A, 9220 Aalborg East, Denmark
Phone: (+45)99408861
Mobile: (+45)30230252
Email: rubak at math.aau.dk


From edd at debian.org  Tue Oct 31 15:24:39 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 31 Oct 2017 09:24:39 -0500
Subject: [R-pkg-devel] Reducing installed package size with --strip-debug
In-Reply-To: <97b9ce2e-83d3-28c7-474e-d8d884e73309@math.aau.dk>
References: <97b9ce2e-83d3-28c7-474e-d8d884e73309@math.aau.dk>
Message-ID: <23032.34727.649823.423111@bud.eddelbuettel.com>


On 31 October 2017 at 15:02, Ege Rubak wrote:
| Based on Dirk's blog post [1] about stripping debug information from the 
| shared object of my package `s2` I reduced the shared object file size 
| from 7 to 0.7 MB and get rid of a NOTE about the installed package size 
| (on my local Linux machine).
| 
| Dirk suggests that one could conditionally do this in the Makevars file 
| if the strip tool is available (typically the case on Linux). Does 
| anybody know what CRAN's take is on this?

The "BDR Doctrine" still stands: no non-portable code in src/Makevars.

So the best I found (as a "live test") was this in RcppClassic (and I indent
what is one long line)

     @if test -e "/usr/bin/strip" & \
         test -e "/bin/uname" & \
         [[ `uname` == "Linux" ]]; then \
         /usr/bin/strip --strip-unneeded $(USERLIB); \
     fi

But but but ... this is in a package which already has an expanded
src/Makevars.  For the simple default one ... I have found nothing better
than a _purely local_ settings in ~/.R/Makevars:

  SHLIB_CXXLDFLAGS = -Wl,-S -shared
  SHLIB_CXX11LDFLAGS = -Wl,-S -shared
  SHLIB_CXX14LDFLAGS = -Wl,-S -shared
  SHLIB_FCLDFLAGS = -Wl,-S -shared
  SHLIB_LDFLAGS = -Wl,-S -shared

as described in the first follow-up to the link you quoted:

   http://dirk.eddelbuettel.com/blog/2017/08/14#009_compact_shared_libraries

It is somewhat sad that we cannot portably set this for packages (at least
not as far as I know), and equally sad that we cannot augment the setting in
$(RHOME)/etc/Makeconf from inside a running R session.

Also see the second follow-up to the link you posted; the file size changes
are nothing short of staggering.

  http://dirk.eddelbuettel.com/blog/2017/08/20#010_stripping_shared_libraries

Dirk   

| 
| Cheers,
| Ege
| 
| [1]: 
| http://dirk.eddelbuettel.com/blog/2017/08/14/#009_compact_shared_libraries
| 
| -- 
| Ege Rubak, Associate Professor,
| Department of Mathematical Sciences, Aalborg University
| Skjernvej 4A, 9220 Aalborg East, Denmark
| Phone: (+45)99408861
| Mobile: (+45)30230252
| Email: rubak at math.aau.dk
| 
| ______________________________________________
| R-package-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From PDunn2 at usc.edu.au  Wed Nov  1 05:56:16 2017
From: PDunn2 at usc.edu.au (Peter Dunn)
Date: Wed, 1 Nov 2017 04:56:16 +0000
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
In-Reply-To: <CALEXWq1Tsip+NLic8Wn6sh42VZMgpLuP1_k4msOHkDPXH2yN-Q@mail.gmail.com>
References: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
 <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>
 <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>
 <CALEXWq1Tsip+NLic8Wn6sh42VZMgpLuP1_k4msOHkDPXH2yN-Q@mail.gmail.com>
Message-ID: <6BF62CF9-C617-48A3-BED1-04F3A8484F01@usc.edu.au>

Wow: Thanks again.  You are going above and beyond I?aki which I appreciate greatly.

But same error message appears, even after fixing (both the relerr, which I had already attended to, and the lambda issue).

I have since initialised *every* variable in the subroutine  smallp  (even the *input* variables to some arbitrary value to try to work out what is causing the issue) yet the error persists. There surely cannot be any uninitialized variables now *every* var in the subroutine is explicitly initialised.

That tells me that there is nothing I can do to remove the error. If everything is initialised?

Frustrated? And wasting so much time!

Thanks for any help from anyone.

P.

On 30/Oct/17, 9:06 pm, "I?aki ?car" <i.ucar86 at gmail.com> wrote:

    2017-10-30 0:54 GMT+01:00 Peter Dunn <PDunn2 at usc.edu.au>:
    > Thanks for this direction.
    >
    > But I am still confused, as the problem persists after attending to any
    > possible issue: That piece of identified code only has four variables, and I
    > can account for them all.
    >
    > The two variables its and aimrerr are now explicitly initialised. So they
    > cannot be the problem.
    >
    > The variables maxit and relerr are inputs to the subroutine... and both are
    > explicitly initialised in the only subroutine which calls smallp. So I can?t
    > see how that can be a problem. (Clearly they cannot be initialised in the
    > subroutine smallp or their input values are overwritten.)

    Found it. "relerr" may be uninitialised because "w" is uninitialised
    in smallp (tweedie 2.2.5, line 2169).

    When you try to debug this kind of things, you must track not only
    explicit initialisations, but also all the assignments with possibly
    uninitialised variables.

    BTW, I also see:

    tweedie.f:335:0:

                 if ( funvalue .LT. exp(-lambda) ) then

    Warning: 'lambda' may be used uninitialized in this function
    [-Wmaybe-uninitialized]

    Regards,
    I?aki



USC, Locked Bag 4, Maroochydore DC, Queensland, 4558 Australia.
CRICOS Provider No: 01595D
Please consider the environment before printing this email.
This email is confidential. If received in error, please delete it from your system.

	[[alternative HTML version deleted]]


From i.ucar86 at gmail.com  Wed Nov  1 13:28:18 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Wed, 1 Nov 2017 13:28:18 +0100
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
In-Reply-To: <6BF62CF9-C617-48A3-BED1-04F3A8484F01@usc.edu.au>
References: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
 <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>
 <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>
 <CALEXWq1Tsip+NLic8Wn6sh42VZMgpLuP1_k4msOHkDPXH2yN-Q@mail.gmail.com>
 <6BF62CF9-C617-48A3-BED1-04F3A8484F01@usc.edu.au>
Message-ID: <CALEXWq07Z8BNCrtUJOReEYeesJx9zXc5xgLuYAeGAdLbUtwkEQ@mail.gmail.com>

2017-11-01 5:56 GMT+01:00 Peter Dunn <PDunn2 at usc.edu.au>:
> Wow: Thanks again. You are going above and beyond I?aki which I appreciate
> greatly.
>
> But same error message appears, even after fixing (both the relerr, which I
> had already attended to, and the lambda issue).

All I can say is that initialising both lambda and w (from CRAN
version) solved the issue for me. As a matter of fact, I did see
another message about uninitialised values, but the back trace was
empty (no function names, I mean), which means that the problem is
somewhere else.

> I have since initialised *every* variable in the subroutine smallp (even the
> *input* variables to some arbitrary value to try to work out what is causing
> the issue) yet the error persists. There surely cannot be any uninitialized
> variables now *every* var in the subroutine is explicitly initialised.
>
> That tells me that there is nothing I can do to remove the error. If
> everything is initialised?
>
> Frustrated? And wasting so much time!

If you set up a public repo (GitHub or similar) where everyone can see
your current code base and changes made, it would be easier to help.
It would be even easier if you check your changes using a public build
system and share the results here. I don't know whether win-builder
uses valgrind, but you can use r-hub (https://github.com/r-hub/rhub)
by G?bor Cs?rdi. There is a function rhub::check_with_valgrind which
requires no further explanation.

I?aki


From PDunn2 at usc.edu.au  Fri Nov  3 06:01:00 2017
From: PDunn2 at usc.edu.au (Peter Dunn)
Date: Fri, 3 Nov 2017 05:01:00 +0000
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
In-Reply-To: <CALEXWq07Z8BNCrtUJOReEYeesJx9zXc5xgLuYAeGAdLbUtwkEQ@mail.gmail.com>
References: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
 <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>
 <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>
 <CALEXWq1Tsip+NLic8Wn6sh42VZMgpLuP1_k4msOHkDPXH2yN-Q@mail.gmail.com>
 <6BF62CF9-C617-48A3-BED1-04F3A8484F01@usc.edu.au>
 <CALEXWq07Z8BNCrtUJOReEYeesJx9zXc5xgLuYAeGAdLbUtwkEQ@mail.gmail.com>
Message-ID: <6A2AEDB4-127F-47F3-94A8-8C9C500A4E05@usc.edu.au>

I?aki  and all

Well, thanks for pointers to rhub.  Wonderful.  Moving things to github, but have to go home now?

So, when I download CRAN code, initialise w and lambda (which workled for I?aki), and run

rhub::check_with_valgrind()

on the code, I get no errors (https://builder.r-hub.io/status/tweedie_2.2.5.tar.gz-c8873979fcf84b4f8a0a4d5a47175f63).


But running

R -d "valgrind  --tool=memcheck --leak-check=full --track-origins=yes" --vanilla  < tweedie-Ex.R

from the command line *still* gives me errors about ?Conditional jump or move depends on uninitialised value(s)? in the subroutine smallp?.

I?aki found no errors when w and lambda were initialised.  I find similar using rhub (no errors)? but running valgrind from the command line still throws the same errors.

What does one make of that?

Thanks for any more help.


P.

PS: Really appreciate the help. This is driving me crazy.


From: I?aki ?car <i.ucar86 at gmail.com>
Date: Wednesday, 1 November 2017 at 10:28 pm
To: Peter Dunn <PDunn2 at usc.edu.au>
Cc: "r-package-devel at r-project.org" <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] Package valgrind problem I can't solve: Direction?

2017-11-01 5:56 GMT+01:00 Peter Dunn <PDunn2 at usc.edu.au>:
> Wow: Thanks again. You are going above and beyond I?aki which I appreciate
> greatly.
>
> But same error message appears, even after fixing (both the relerr, which I
> had already attended to, and the lambda issue).

All I can say is that initialising both lambda and w (from CRAN
version) solved the issue for me. As a matter of fact, I did see
another message about uninitialised values, but the back trace was
empty (no function names, I mean), which means that the problem is
somewhere else.

> I have since initialised *every* variable in the subroutine smallp (even the
> *input* variables to some arbitrary value to try to work out what is causing
> the issue) yet the error persists. There surely cannot be any uninitialized
> variables now *every* var in the subroutine is explicitly initialised.
>
> That tells me that there is nothing I can do to remove the error. If
> everything is initialised?
>
> Frustrated? And wasting so much time!

If you set up a public repo (GitHub or similar) where everyone can see
your current code base and changes made, it would be easier to help.
It would be even easier if you check your changes using a public build
system and share the results here. I don't know whether win-builder
uses valgrind, but you can use r-hub (https://github.com/r-hub/rhub)
by G?bor Cs?rdi. There is a function rhub::check_with_valgrind which
requires no further explanation.

I?aki



USC, Locked Bag 4, Maroochydore DC, Queensland, 4558 Australia.
CRICOS Provider No: 01595D
Please consider the environment before printing this email.
This email is confidential. If received in error, please delete it from your system.

	[[alternative HTML version deleted]]


From i.ucar86 at gmail.com  Fri Nov  3 10:45:45 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Fri, 3 Nov 2017 10:45:45 +0100
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
In-Reply-To: <6A2AEDB4-127F-47F3-94A8-8C9C500A4E05@usc.edu.au>
References: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
 <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>
 <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>
 <CALEXWq1Tsip+NLic8Wn6sh42VZMgpLuP1_k4msOHkDPXH2yN-Q@mail.gmail.com>
 <6BF62CF9-C617-48A3-BED1-04F3A8484F01@usc.edu.au>
 <CALEXWq07Z8BNCrtUJOReEYeesJx9zXc5xgLuYAeGAdLbUtwkEQ@mail.gmail.com>
 <6A2AEDB4-127F-47F3-94A8-8C9C500A4E05@usc.edu.au>
Message-ID: <CALEXWq20Jc47+GDwKdisxgJGUWSdsadp01F_rrhoV9dPjDUUpw@mail.gmail.com>

2017-11-03 6:01 GMT+01:00 Peter Dunn <PDunn2 at usc.edu.au>:
> I?aki and all
>
> Well, thanks for pointers to rhub. Wonderful. Moving things to github, but
> have to go home now?
>
> So, when I download CRAN code, initialise w and lambda (which workled for
> I?aki), and run
>
> rhub::check_with_valgrind()
>
> on the code, I get no errors
> (https://builder.r-hub.io/status/tweedie_2.2.5.tar.gz-c8873979fcf84b4f8a0a4d5a47175f63).
>
>
> But running
>
> R -d "valgrind --tool=memcheck --leak-check=full --track-origins=yes"
> --vanilla < tweedie-Ex.R
>
> from the command line *still* gives me errors about ?Conditional jump or
> move depends on uninitialised value(s)? in the subroutine smallp?.

That's impossible. Did you rebuild and reinstall the package after
making those changes?

I?aki


From PDunn2 at usc.edu.au  Mon Nov  6 00:09:32 2017
From: PDunn2 at usc.edu.au (Peter Dunn)
Date: Sun, 5 Nov 2017 23:09:32 +0000
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
In-Reply-To: <CALEXWq20Jc47+GDwKdisxgJGUWSdsadp01F_rrhoV9dPjDUUpw@mail.gmail.com>
References: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
 <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>
 <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>
 <CALEXWq1Tsip+NLic8Wn6sh42VZMgpLuP1_k4msOHkDPXH2yN-Q@mail.gmail.com>
 <6BF62CF9-C617-48A3-BED1-04F3A8484F01@usc.edu.au>
 <CALEXWq07Z8BNCrtUJOReEYeesJx9zXc5xgLuYAeGAdLbUtwkEQ@mail.gmail.com>
 <6A2AEDB4-127F-47F3-94A8-8C9C500A4E05@usc.edu.au>
 <CALEXWq20Jc47+GDwKdisxgJGUWSdsadp01F_rrhoV9dPjDUUpw@mail.gmail.com>
Message-ID: <982F2D94-A1C5-4E0B-B4DF-16B99AA9228E@usc.edu.au>

Impossible or not? it just happened (unless I am being really stupid, which is entirely possible, indeed probable).  I confirmed again this morning: After rebuilding (R CMD build) and checking (R CMD check) without any errors, I used rhub and the command line again:


Running valgrind at the command line, I get this error:

==5097== Conditional jump or move depends on uninitialised value(s)
==5097==    at 0x1118F61FB: smallp_ (in /Users/pdunn2/Library/R/3.4/library/tweedie/libs/tweedie.so)

?when I am here:

$ pwd
/Users/pdunn2/Documents/Research/Rpackages/tweedie/tweedie-debug/CRAN-update/tweedie.Rcheck



In rhub:

check_with_valgrind("tweedie")

gives:

?? 0 errors ? | 0 warnings ? | 0 notes ?
?  Done with R CMD check
?  Saving artifacts

?when I am here:

> getwd()
[1] "/Users/pdunn2/Documents/Research/Rpackages/tweedie/tweedie-debug/CRAN-update"




I will take this to mean that there really is no problem? and put this down to things I don?t understand and ?experience?.

Thanks for everyone?s help.

P.

From: I?aki ?car <i.ucar86 at gmail.com>
Date: Friday, 3 November 2017 at 7:45 pm
To: Peter Dunn <PDunn2 at usc.edu.au>
Cc: "r-package-devel at r-project.org" <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] Package valgrind problem I can't solve: Direction?

2017-11-03 6:01 GMT+01:00 Peter Dunn <PDunn2 at usc.edu.au>:
> I?aki and all
>
> Well, thanks for pointers to rhub. Wonderful. Moving things to github, but
> have to go home now?
>
> So, when I download CRAN code, initialise w and lambda (which workled for
> I?aki), and run
>
> rhub::check_with_valgrind()
>
> on the code, I get no errors
> (https://builder.r-hub.io/status/tweedie_2.2.5.tar.gz-c8873979fcf84b4f8a0a4d5a47175f63).
>
>
> But running
>
> R -d "valgrind --tool=memcheck --leak-check=full --track-origins=yes"
> --vanilla < tweedie-Ex.R
>
> from the command line *still* gives me errors about ?Conditional jump or
> move depends on uninitialised value(s)? in the subroutine smallp?.

That's impossible. Did you rebuild and reinstall the package after
making those changes?

I?aki



USC, Locked Bag 4, Maroochydore DC, Queensland, 4558 Australia.
CRICOS Provider No: 01595D
Please consider the environment before printing this email.
This email is confidential. If received in error, please delete it from your system.

	[[alternative HTML version deleted]]


From i.ucar86 at gmail.com  Mon Nov  6 00:51:47 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Mon, 6 Nov 2017 00:51:47 +0100
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
In-Reply-To: <982F2D94-A1C5-4E0B-B4DF-16B99AA9228E@usc.edu.au>
References: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
 <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>
 <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>
 <CALEXWq1Tsip+NLic8Wn6sh42VZMgpLuP1_k4msOHkDPXH2yN-Q@mail.gmail.com>
 <6BF62CF9-C617-48A3-BED1-04F3A8484F01@usc.edu.au>
 <CALEXWq07Z8BNCrtUJOReEYeesJx9zXc5xgLuYAeGAdLbUtwkEQ@mail.gmail.com>
 <6A2AEDB4-127F-47F3-94A8-8C9C500A4E05@usc.edu.au>
 <CALEXWq20Jc47+GDwKdisxgJGUWSdsadp01F_rrhoV9dPjDUUpw@mail.gmail.com>
 <982F2D94-A1C5-4E0B-B4DF-16B99AA9228E@usc.edu.au>
Message-ID: <CALEXWq2i9B_z4njw_p2h9bso+bFdWbWd=2sbP3gwPWVDPDkwsg@mail.gmail.com>

2017-11-06 0:09 GMT+01:00 Peter Dunn <PDunn2 at usc.edu.au>:
> Impossible or not? it just happened (unless I am being really stupid, which
> is entirely possible, indeed probable). I confirmed again this morning:
> After rebuilding (R CMD build) and checking (R CMD check) without any
> errors, I used rhub and the command line again:
>
>
> Running valgrind at the command line, I get this error:
>
> ==5097== Conditional jump or move depends on uninitialised value(s)
> ==5097== at 0x1118F61FB: smallp_ (in
> /Users/pdunn2/Library/R/3.4/library/tweedie/libs/tweedie.so)

What I meant is that, if you run the script in tweedie.Rcheck from the
command line, Rscript uses your *installed* version of tweedie, not
the tarball you built with R CMD build. So if you didn't run R CMD
INSTALL, Rscript is running an old version without any fix, hence the
disagreement with R CMD check.

I?aki


From PDunn2 at usc.edu.au  Mon Nov  6 01:05:10 2017
From: PDunn2 at usc.edu.au (Peter Dunn)
Date: Mon, 6 Nov 2017 00:05:10 +0000
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
In-Reply-To: <CALEXWq2i9B_z4njw_p2h9bso+bFdWbWd=2sbP3gwPWVDPDkwsg@mail.gmail.com>
References: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
 <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>
 <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>
 <CALEXWq1Tsip+NLic8Wn6sh42VZMgpLuP1_k4msOHkDPXH2yN-Q@mail.gmail.com>
 <6BF62CF9-C617-48A3-BED1-04F3A8484F01@usc.edu.au>
 <CALEXWq07Z8BNCrtUJOReEYeesJx9zXc5xgLuYAeGAdLbUtwkEQ@mail.gmail.com>
 <6A2AEDB4-127F-47F3-94A8-8C9C500A4E05@usc.edu.au>
 <CALEXWq20Jc47+GDwKdisxgJGUWSdsadp01F_rrhoV9dPjDUUpw@mail.gmail.com>
 <982F2D94-A1C5-4E0B-B4DF-16B99AA9228E@usc.edu.au>
 <CALEXWq2i9B_z4njw_p2h9bso+bFdWbWd=2sbP3gwPWVDPDkwsg@mail.gmail.com>
Message-ID: <A5AB0207-1247-47AB-9475-5DAB2DF7878E@usc.edu.au>

?unless I am being really stupid?

Lucky for that caveat. Feeling rather stupid for this late effort.

Thanks so much.  Help greatly appreciated.

P.



On 6/Nov/17, 9:51 am, "I?aki ?car" <i.ucar86 at gmail.com> wrote:

    2017-11-06 0:09 GMT+01:00 Peter Dunn <PDunn2 at usc.edu.au>:
    > Impossible or not? it just happened (unless I am being really stupid, which
    > is entirely possible, indeed probable). I confirmed again this morning:
    > After rebuilding (R CMD build) and checking (R CMD check) without any
    > errors, I used rhub and the command line again:
    >
    >
    > Running valgrind at the command line, I get this error:
    >
    > ==5097== Conditional jump or move depends on uninitialised value(s)
    > ==5097== at 0x1118F61FB: smallp_ (in
    > /Users/pdunn2/Library/R/3.4/library/tweedie/libs/tweedie.so)

    What I meant is that, if you run the script in tweedie.Rcheck from the
    command line, Rscript uses your *installed* version of tweedie, not
    the tarball you built with R CMD build. So if you didn't run R CMD
    INSTALL, Rscript is running an old version without any fix, hence the
    disagreement with R CMD check.

    I?aki



USC, Locked Bag 4, Maroochydore DC, Queensland, 4558 Australia.
CRICOS Provider No: 01595D
Please consider the environment before printing this email.
This email is confidential. If received in error, please delete it from your system.

	[[alternative HTML version deleted]]


From clyde at duke.edu  Mon Nov  6 03:19:05 2017
From: clyde at duke.edu (Merlise Clyde, Ph.D.)
Date: Mon, 6 Nov 2017 02:19:05 +0000
Subject: [R-pkg-devel] Package valgrind problem I can't solve: Direction?
In-Reply-To: <A5AB0207-1247-47AB-9475-5DAB2DF7878E@usc.edu.au>
References: <564C35E9-F980-43CE-8FF8-0357BCE5FE65@usc.edu.au>
 <CALEXWq15Q0-6WEdvg4Cjczw15zM93Py+YQHxXmiuHUbLBQBJUQ@mail.gmail.com>
 <726995EA-F66D-4D9A-A699-A045AA87D607@usc.edu.au>
 <CALEXWq1Tsip+NLic8Wn6sh42VZMgpLuP1_k4msOHkDPXH2yN-Q@mail.gmail.com>
 <6BF62CF9-C617-48A3-BED1-04F3A8484F01@usc.edu.au>
 <CALEXWq07Z8BNCrtUJOReEYeesJx9zXc5xgLuYAeGAdLbUtwkEQ@mail.gmail.com>
 <6A2AEDB4-127F-47F3-94A8-8C9C500A4E05@usc.edu.au>
 <CALEXWq20Jc47+GDwKdisxgJGUWSdsadp01F_rrhoV9dPjDUUpw@mail.gmail.com>
 <982F2D94-A1C5-4E0B-B4DF-16B99AA9228E@usc.edu.au>
 <CALEXWq2i9B_z4njw_p2h9bso+bFdWbWd=2sbP3gwPWVDPDkwsg@mail.gmail.com>
 <A5AB0207-1247-47AB-9475-5DAB2DF7878E@usc.edu.au>
Message-ID: <9A93B8B5-7719-463C-AE57-A4512BA11256@duke.edu>

Peter,

I ran into similar problems with using valgrind to check  my package  BAS

From my understanding using valgrind with rhub does not run the same checks as

R -d "valgrind --tool=memcheck --leak-check=full" --vanilla < mypkg-Ex.R


see https://github.com/r-hub/rhub/issues/23
which might explain why it will run without errors there but the CRAN check will flag errors/warnings.  (perhaps someone else can confirm)


best,
Merlise


Merlise A Clyde
Professor & Chair Department of Statistical Science
Duke University
http://stat.duke.edu/~clyde

clyde at duke.edu<mailto:clyde at duke.edu>
919 681 8440




On Nov 5, 2017, at 7:05 PM, Peter Dunn <PDunn2 at usc.edu.au<mailto:PDunn2 at usc.edu.au>> wrote:

?unless I am being really stupid?

Lucky for that caveat. Feeling rather stupid for this late effort.

Thanks so much.  Help greatly appreciated.

P.



On 6/Nov/17, 9:51 am, "I?aki ?car" <i.ucar86 at gmail.com<mailto:i.ucar86 at gmail.com>> wrote:

   2017-11-06 0:09 GMT+01:00 Peter Dunn <PDunn2 at usc.edu.au<mailto:PDunn2 at usc.edu.au>>:
Impossible or not? it just happened (unless I am being really stupid, which
is entirely possible, indeed probable). I confirmed again this morning:
After rebuilding (R CMD build) and checking (R CMD check) without any
errors, I used rhub and the command line again:


Running valgrind at the command line, I get this error:

==5097== Conditional jump or move depends on uninitialised value(s)
==5097== at 0x1118F61FB: smallp_ (in
/Users/pdunn2/Library/R/3.4/library/tweedie/libs/tweedie.so)

   What I meant is that, if you run the script in tweedie.Rcheck from the
   command line, Rscript uses your *installed* version of tweedie, not
   the tarball you built with R CMD build. So if you didn't run R CMD
   INSTALL, Rscript is running an old version without any fix, hence the
   disagreement with R CMD check.

   I?aki



USC, Locked Bag 4, Maroochydore DC, Queensland, 4558 Australia.
CRICOS Provider No: 01595D
Please consider the environment before printing this email.
This email is confidential. If received in error, please delete it from your system.

[[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dpackage-2Ddevel&d=DwIGaQ&c=imBPVzF25OnBgGmVOlcsiEgHoG1i6YHLR0Sj_gZ4adc&r=NOkxkvdFOOffXzeTY2kgZQ&m=wQM2pJJEon1zRq8pImHXAnjSO5MT728HIQf-oNWJfAo&s=VTJwkGdmvI9lNBVHxBc_38mQ16_pBYZ3dLnKdZBvBwg&e=


	[[alternative HTML version deleted]]


From anthonyebert at gmail.com  Mon Nov  6 07:51:21 2017
From: anthonyebert at gmail.com (Anthony Ebert)
Date: Mon, 6 Nov 2017 16:51:21 +1000
Subject: [R-pkg-devel] Error in globalVariables(".") : could not find
	function "globalVariables"
Message-ID: <CAOR1wahW=FSt7U0D4O4rVJq=a1OBgGs5Dd=MiXtn-C=G=wcCkA@mail.gmail.com>

Hello r-package-devel,

I have updated my R package queuecomputer from 0.8.1 to 0.8.2. The
source code is here https://github.com/AnthonyEbert/queuecomputer .

I have checked queuecomputer-0.8.2 with rhub and win-builder with
status OK for every platform.

After submission to CRAN I got an incoming check error.

https://github.com/AnthonyEbert/queuecomputer/blob/master/cran-comments.md

  ...
  Error in library.dynam(lib, package, package.lib) :
    DLL 'dplyr' not found: maybe not installed for this architecture?
  ...

I chose to ignore that and resubmit with exactly the same source code.
I now get a NOTE in a different place, further along in the check.

  ...
  * checking dependencies in R code ... NOTE
  Error in globalVariables(".") : could not find function "globalVariables"
  ...
  * checking PDF version of manual ... OK
  * DONE
  Status: 1 NOTE

See https://win-builder.r-project.org/incoming_pretest/171106_065442_queuecomputer_082/00check.log
for full output.

I don't use that function anywhere in queuecomputer. Is this something
I should worry about? Or should I try again?

Thanks for your help! Much appreciated.

Anthony Ebert


From cimentadaj at gmail.com  Mon Nov  6 14:25:22 2017
From: cimentadaj at gmail.com (Jorge Cimentada)
Date: Mon, 6 Nov 2017 14:25:22 +0100
Subject: [R-pkg-devel] How to include examples that run > 5 secs and contain
	personal info
Message-ID: <CALdB+JE=ZVLicLv+8VJ-0WBksqLOTD6EH+D6A4QDWf9z4PdFPA@mail.gmail.com>

Hi,

I'm in the process of submitting a package to CRAN and I've run into an
issue with the examples of some functions. The purpose of nearly all
functions of the package is to download data from a website. There is one
main problem I've received from CRAN.

1) If it's feasible, include examples which are executed in < 5 secs.

Downloading data usually take between 5-10 seconds in the best case. I've
included most examples as \dontrun{} specifically because of this. There is
no way of creating smaller toy examples that run in less time.

Every time the function is run the user must specify his/her email, which
is private information Because the examples are not being executed, I've
included fake emails such as your at email.com to show the user how it works.
The CRAN team suggested using something like:

-----

\examples{
       examples for users:
       executable in < 5 sec
       for checks
       \dontshow{
              examples for checks:
              executable in < 5 sec together with the examples above
              not shown to users
       }
       donttest{
              further examples for users (not used for checks)
       }
}

-----

To the best of my knowledge, there is not way to get examples always
running < 5 secs, so it's not feasible to include them in \dontshow{}.
Also, I'm not sure if users can have access to \dontshow{} in any way by
going to the specific docs of the function (either on Github or somewhere
on the CRAN repo). I wouldn't want to reveal personal emails in any way,
even if it's for the tests.

Any idea how to handle this situation?

Note: I do included extensive tests which are successfully tested through
Travis CI and this wasn't an issue in the CRAN submission.

-----------------------------------


Jorge Cimentada
*https://cimentadaj.github.io/ <https://cimentadaj.github.io/>*

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Mon Nov  6 14:34:16 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 6 Nov 2017 14:34:16 +0100
Subject: [R-pkg-devel] Error in globalVariables(".") : could not find
 function "globalVariables"
In-Reply-To: <CAOR1wahW=FSt7U0D4O4rVJq=a1OBgGs5Dd=MiXtn-C=G=wcCkA@mail.gmail.com>
References: <CAOR1wahW=FSt7U0D4O4rVJq=a1OBgGs5Dd=MiXtn-C=G=wcCkA@mail.gmail.com>
Message-ID: <4a076604-4323-aa57-1a69-6f4f6f6b5d6b@statistik.tu-dortmund.de>



On 06.11.2017 07:51, Anthony Ebert wrote:
> Hello r-package-devel,
> 
> I have updated my R package queuecomputer from 0.8.1 to 0.8.2. The
> source code is here https://github.com/AnthonyEbert/queuecomputer .
> 
> I have checked queuecomputer-0.8.2 with rhub and win-builder with
> status OK for every platform.
> 
> After submission to CRAN I got an incoming check error.
> 
> https://github.com/AnthonyEbert/queuecomputer/blob/master/cran-comments.md
> 
>    ...
>    Error in library.dynam(lib, package, package.lib) :
>      DLL 'dplyr' not found: maybe not installed for this architecture?
>    ...

Ignore this, a race condition on the check sytsem.


> 
> I chose to ignore that and resubmit with exactly the same source code.
> I now get a NOTE in a different place, further along in the check.
> 
>    ...
>    * checking dependencies in R code ... NOTE
>    Error in globalVariables(".") : could not find function "globalVariables"

Can you grep for globalVariables in your code?
THis is from package utils and hence you may have to declare it.

Best,
Uwe Ligges




>    ...
>    * checking PDF version of manual ... OK
>    * DONE
>    Status: 1 NOTE
> 
> See https://win-builder.r-project.org/incoming_pretest/171106_065442_queuecomputer_082/00check.log
> for full output.
> 
> I don't use that function anywhere in queuecomputer. Is this something
> I should worry about? Or should I try again?
> 
> Thanks for your help! Much appreciated.
> 
> Anthony Ebert
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From ligges at statistik.tu-dortmund.de  Mon Nov  6 14:37:06 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 6 Nov 2017 14:37:06 +0100
Subject: [R-pkg-devel] How to include examples that run > 5 secs and
 contain personal info
In-Reply-To: <CALdB+JE=ZVLicLv+8VJ-0WBksqLOTD6EH+D6A4QDWf9z4PdFPA@mail.gmail.com>
References: <CALdB+JE=ZVLicLv+8VJ-0WBksqLOTD6EH+D6A4QDWf9z4PdFPA@mail.gmail.com>
Message-ID: <a0eac40b-4f5d-0838-6673-68df40de0726@statistik.tu-dortmund.de>

Then simply explain this situation to the CRAN team and "they" will 
probably let the package pass.

Best,
Uwe Ligges


On 06.11.2017 14:25, Jorge Cimentada wrote:
> Hi,
> 
> I'm in the process of submitting a package to CRAN and I've run into an
> issue with the examples of some functions. The purpose of nearly all
> functions of the package is to download data from a website. There is one
> main problem I've received from CRAN.
> 
> 1) If it's feasible, include examples which are executed in < 5 secs.
> 
> Downloading data usually take between 5-10 seconds in the best case. I've
> included most examples as \dontrun{} specifically because of this. There is
> no way of creating smaller toy examples that run in less time.
> 
> Every time the function is run the user must specify his/her email, which
> is private information Because the examples are not being executed, I've
> included fake emails such as your at email.com to show the user how it works.
> The CRAN team suggested using something like:
> 
> -----
> 
> \examples{
>         examples for users:
>         executable in < 5 sec
>         for checks
>         \dontshow{
>                examples for checks:
>                executable in < 5 sec together with the examples above
>                not shown to users
>         }
>         donttest{
>                further examples for users (not used for checks)
>         }
> }
> 
> -----
> 
> To the best of my knowledge, there is not way to get examples always
> running < 5 secs, so it's not feasible to include them in \dontshow{}.
> Also, I'm not sure if users can have access to \dontshow{} in any way by
> going to the specific docs of the function (either on Github or somewhere
> on the CRAN repo). I wouldn't want to reveal personal emails in any way,
> even if it's for the tests.
> 
> Any idea how to handle this situation?
> 
> Note: I do included extensive tests which are successfully tested through
> Travis CI and this wasn't an issue in the CRAN submission.
> 
> -----------------------------------
> 
> 
> Jorge Cimentada
> *https://cimentadaj.github.io/ <https://cimentadaj.github.io/>*
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From maxime.turgeon at mail.mcgill.ca  Mon Nov  6 14:58:29 2017
From: maxime.turgeon at mail.mcgill.ca (Maxime Turgeon)
Date: Mon, 6 Nov 2017 13:58:29 +0000
Subject: [R-pkg-devel] How to include examples that run > 5 secs and
 contain	personal info
In-Reply-To: <CALdB+JE=ZVLicLv+8VJ-0WBksqLOTD6EH+D6A4QDWf9z4PdFPA@mail.gmail.com>
References: <CALdB+JE=ZVLicLv+8VJ-0WBksqLOTD6EH+D6A4QDWf9z4PdFPA@mail.gmail.com>
Message-ID: <YTOPR0101MB220194F21A51D5A858F6D171BA500@YTOPR0101MB2201.CANPRD01.PROD.OUTLOOK.COM>

Hi Jorge,


All the Rd files are available to users if they download the source code. They are also available through the CRAN mirror on Github (github.com/cran). In other words, you shouldn't put personal information in the help files, even if you use the 'dontshow' macro.


Max

________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Jorge Cimentada <cimentadaj at gmail.com>
Sent: November 6, 2017 8:25:22 AM
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] How to include examples that run > 5 secs and contain personal info

Hi,

I'm in the process of submitting a package to CRAN and I've run into an
issue with the examples of some functions. The purpose of nearly all
functions of the package is to download data from a website. There is one
main problem I've received from CRAN.

1) If it's feasible, include examples which are executed in < 5 secs.

Downloading data usually take between 5-10 seconds in the best case. I've
included most examples as \dontrun{} specifically because of this. There is
no way of creating smaller toy examples that run in less time.

Every time the function is run the user must specify his/her email, which
is private information Because the examples are not being executed, I've
included fake emails such as your at email.com to show the user how it works.
The CRAN team suggested using something like:

-----

\examples{
       examples for users:
       executable in < 5 sec
       for checks
       \dontshow{
              examples for checks:
              executable in < 5 sec together with the examples above
              not shown to users
       }
       donttest{
              further examples for users (not used for checks)
       }
}

-----

To the best of my knowledge, there is not way to get examples always
running < 5 secs, so it's not feasible to include them in \dontshow{}.
Also, I'm not sure if users can have access to \dontshow{} in any way by
going to the specific docs of the function (either on Github or somewhere
on the CRAN repo). I wouldn't want to reveal personal emails in any way,
even if it's for the tests.

Any idea how to handle this situation?

Note: I do included extensive tests which are successfully tested through
Travis CI and this wasn't an issue in the CRAN submission.

-----------------------------------


Jorge Cimentada
*https://cimentadaj.github.io/ <https://cimentadaj.github.io/>*

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From anthonyebert at gmail.com  Tue Nov  7 01:11:31 2017
From: anthonyebert at gmail.com (Anthony Ebert)
Date: Tue, 7 Nov 2017 10:11:31 +1000
Subject: [R-pkg-devel] Error in globalVariables(".") : could not find
 function "globalVariables"
In-Reply-To: <4a076604-4323-aa57-1a69-6f4f6f6b5d6b@statistik.tu-dortmund.de>
References: <CAOR1wahW=FSt7U0D4O4rVJq=a1OBgGs5Dd=MiXtn-C=G=wcCkA@mail.gmail.com>
 <4a076604-4323-aa57-1a69-6f4f6f6b5d6b@statistik.tu-dortmund.de>
Message-ID: <CAOR1wahXNL918dYx4Hw9vMDTTg=ZgDMqUOU5WJKSreX5_FcjnQ@mail.gmail.com>

Thank you Uwe Ligges!

I did a grep (including all sub-directories) for globalVariables in my
code. It is not in the code at all.

Could it be the generate_input function with it's "<<-" ?
https://github.com/AnthonyEbert/queuecomputer/blob/master/R/utils.R

It's not exported and it's not used internally by anything. I just use
it as a shortcut when debugging my code.

Best,
Anthony Ebert

On Mon, Nov 6, 2017 at 11:34 PM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
>
>
> On 06.11.2017 07:51, Anthony Ebert wrote:
>>
>> Hello r-package-devel,
>>
>> I have updated my R package queuecomputer from 0.8.1 to 0.8.2. The
>> source code is here https://github.com/AnthonyEbert/queuecomputer .
>>
>> I have checked queuecomputer-0.8.2 with rhub and win-builder with
>> status OK for every platform.
>>
>> After submission to CRAN I got an incoming check error.
>>
>> https://github.com/AnthonyEbert/queuecomputer/blob/master/cran-comments.md
>>
>>    ...
>>    Error in library.dynam(lib, package, package.lib) :
>>      DLL 'dplyr' not found: maybe not installed for this architecture?
>>    ...
>
>
> Ignore this, a race condition on the check sytsem.
>
>
>>
>> I chose to ignore that and resubmit with exactly the same source code.
>> I now get a NOTE in a different place, further along in the check.
>>
>>    ...
>>    * checking dependencies in R code ... NOTE
>>    Error in globalVariables(".") : could not find function
>> "globalVariables"
>
>
> Can you grep for globalVariables in your code?
> THis is from package utils and hence you may have to declare it.
>
> Best,
> Uwe Ligges
>
>
>
>
>>    ...
>>    * checking PDF version of manual ... OK
>>    * DONE
>>    Status: 1 NOTE
>>
>> See
>> https://win-builder.r-project.org/incoming_pretest/171106_065442_queuecomputer_082/00check.log
>> for full output.
>>
>> I don't use that function anywhere in queuecomputer. Is this something
>> I should worry about? Or should I try again?
>>
>> Thanks for your help! Much appreciated.
>>
>> Anthony Ebert
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>


From rflight79 at gmail.com  Tue Nov  7 15:41:32 2017
From: rflight79 at gmail.com (Robert M. Flight)
Date: Tue, 07 Nov 2017 14:41:32 +0000
Subject: [R-pkg-devel] How to include examples that run > 5 secs and
 contain personal info
In-Reply-To: <YTOPR0101MB220194F21A51D5A858F6D171BA500@YTOPR0101MB2201.CANPRD01.PROD.OUTLOOK.COM>
References: <CALdB+JE=ZVLicLv+8VJ-0WBksqLOTD6EH+D6A4QDWf9z4PdFPA@mail.gmail.com>
 <YTOPR0101MB220194F21A51D5A858F6D171BA500@YTOPR0101MB2201.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <CAJLyBTXOyPUM+gVq-NL1bkU6AZ2JOX-z3suiCnbDD-FzSxNUbA@mail.gmail.com>

There are also lots of ways to "mock" examples / tests. You might give
examples that are "not run" in your code, and then if you want to "test"
the functionality, use "testthat" with mocked tests, that don't involve
hitting the website, except for a single case to make sure that particular
function works.

These might be helpful:
https://www.mango-solutions.com/blog/testing-without-the-internet-using-mock-functions

Also, look at the use of this functionality in devtools:
https://github.com/hadley/devtools/search?utf8=%E2%9C%93&q=with_mock&type=

Hope that helps!

-Robert

Robert M Flight, PhD
Bioinformatics Research Associate
Puller of Rabbits from Hats
Research Parasite
Resource Center for Stable Isotope Resolved Metabolomics
Manager, Systems Biology and Omics Integration Journal Club
Markey Cancer Center
CC434 Roach Building
University of Kentucky
Lexington, KY

Twitter: @rmflight
Web: rmflight.github.io
ORCID: http://orcid.org/0000-0001-8141-7788
EM rflight79 at gmail.com
PH 502-509-1827 <(502)%20509-1827>

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. - Ronald Fisher

On Mon, Nov 6, 2017 at 8:58 AM Maxime Turgeon <maxime.turgeon at mail.mcgill.ca>
wrote:

> Hi Jorge,
>
>
> All the Rd files are available to users if they download the source code.
> They are also available through the CRAN mirror on Github (github.com/cran).
> In other words, you shouldn't put personal information in the help files,
> even if you use the 'dontshow' macro.
>
>
> Max
>
> ________________________________
> From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf
> of Jorge Cimentada <cimentadaj at gmail.com>
> Sent: November 6, 2017 8:25:22 AM
> To: r-package-devel at r-project.org
> Subject: [R-pkg-devel] How to include examples that run > 5 secs and
> contain personal info
>
> Hi,
>
> I'm in the process of submitting a package to CRAN and I've run into an
> issue with the examples of some functions. The purpose of nearly all
> functions of the package is to download data from a website. There is one
> main problem I've received from CRAN.
>
> 1) If it's feasible, include examples which are executed in < 5 secs.
>
> Downloading data usually take between 5-10 seconds in the best case. I've
> included most examples as \dontrun{} specifically because of this. There is
> no way of creating smaller toy examples that run in less time.
>
> Every time the function is run the user must specify his/her email, which
> is private information Because the examples are not being executed, I've
> included fake emails such as your at email.com to show the user how it works.
> The CRAN team suggested using something like:
>
> -----
>
> \examples{
>        examples for users:
>        executable in < 5 sec
>        for checks
>        \dontshow{
>               examples for checks:
>               executable in < 5 sec together with the examples above
>               not shown to users
>        }
>        donttest{
>               further examples for users (not used for checks)
>        }
> }
>
> -----
>
> To the best of my knowledge, there is not way to get examples always
> running < 5 secs, so it's not feasible to include them in \dontshow{}.
> Also, I'm not sure if users can have access to \dontshow{} in any way by
> going to the specific docs of the function (either on Github or somewhere
> on the CRAN repo). I wouldn't want to reveal personal emails in any way,
> even if it's for the tests.
>
> Any idea how to handle this situation?
>
> Note: I do included extensive tests which are successfully tested through
> Travis CI and this wasn't an issue in the CRAN submission.
>
> -----------------------------------
>
>
> Jorge Cimentada
> *https://cimentadaj.github.io/ <https://cimentadaj.github.io/>*
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From bruce.hoff at sagebase.org  Tue Nov  7 20:38:11 2017
From: bruce.hoff at sagebase.org (Bruce Hoff)
Date: Tue, 7 Nov 2017 11:38:11 -0800
Subject: [R-pkg-devel] building package binaries for various OSX versions
Message-ID: <CAAeMkWsCmOVOHNT8qyxSuZhLKyk_8Q5h_6hQaJb3JwrRpXQhDg@mail.gmail.com>

Hi:

A user of a binary package I provided reported that he could not load it
from R on Mac OSX version 10.11 (El Capitan).  The result of running
"require(<package name>)" is:

Error in dyn.load(file, DLLpath = DLLpath, ...) :
unable to load shared object ...:
dlopen(....so, 6): Symbol not found: _clock_getres
Referenced from: ....so (which was built for Mac OS X 10.12)
Expected in: /usr/lib/libSystem.B.dylib

I checked that the package was indeed built on OSX version 10.12 (Sierra)
which I believe is the cause of the problem.   This issue prompts me to
ask, *What is the standard in the R community for supporting multiple
versions of osx when providing a binary package?*

- Is it normal to support more than one osx version, or just the latest
version?
- If the former, do you build packages on the oldest supported version
(depending on "backwards compatibility" for newer OSX versions to run the
older package) or do you build on multiple versions?
- If you build packages on multiple osx versions, which ones?  (How far
back do you go?)
- If you build packages on just a single osx version, which one?
- Is it common to successfully write a package which is not dependent on a
specific version of osx (obviating all of the above questions)?

I didn't any definitive answers to these questions here
https://cran.r-project.org/doc/manuals/R-exts.html
or here
https://cran.r-project.org/

I appreciate any guidance you can provide.

Thank you,

Bruce Hoff
Sage Bionetworks

	[[alternative HTML version deleted]]


From bachlfab at googlemail.com  Wed Nov  8 14:25:30 2017
From: bachlfab at googlemail.com (Fabian Bachl)
Date: Wed, 08 Nov 2017 13:25:30 +0000
Subject: [R-pkg-devel] Outdated Winbuilder package "INLA"
Message-ID: <CAKrMbEXmVvo=gQRfWJf4wAEQD1r2NnaOn_w7hCmK4c1udrPGZQ@mail.gmail.com>

Hi everyone,

I am trying to submit a package to CRAN that depends on INLA, which itself
is not on CRAN. However, INLA is installed on the winbuilder machine but
the version is 0.0-1440400394 and extremely outdated (older than a year, I
think) and some essential functions that I use are not available. I tried
to adjust my DESCRIPTION file by stating "depends: INLA (>= 17.06.20)" but
winbuilder reports the error "Package required and
available but unsuitable version: 'INLA'". What's the best way to approach
this problem?

Kind regards,
Fabian Bachl

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Wed Nov  8 17:21:17 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 8 Nov 2017 17:21:17 +0100
Subject: [R-pkg-devel] Outdated Winbuilder package "INLA"
In-Reply-To: <CAKrMbEXmVvo=gQRfWJf4wAEQD1r2NnaOn_w7hCmK4c1udrPGZQ@mail.gmail.com>
References: <CAKrMbEXmVvo=gQRfWJf4wAEQD1r2NnaOn_w7hCmK4c1udrPGZQ@mail.gmail.com>
Message-ID: <fde39298-2a1b-b1dc-6be5-e701d0ca0f70@statistik.tu-dortmund.de>



On 08.11.2017 14:25, Fabian Bachl wrote:
> Hi everyone,
> 
> I am trying to submit a package to CRAN that depends on INLA, which itself
> is not on CRAN. However, INLA is installed on the winbuilder machine but
> the version is 0.0-1440400394 and extremely outdated (older than a year, I
> think) and some essential functions that I use are not available. I tried
> to adjust my DESCRIPTION file by stating "depends: INLA (>= 17.06.20)" but
> winbuilder reports the error "Package required and
> available but unsuitable version: 'INLA'". What's the best way to approach
> this problem?

Tell the CRAN team. For winbuilder: Tell me. ;-)
I will update shortly.

Best,
Uwe Ligges



> Kind regards,
> Fabian Bachl
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From luca.belmonte at unimore.it  Wed Nov  8 17:01:23 2017
From: luca.belmonte at unimore.it (LUCA BELMONTE)
Date: Wed, 8 Nov 2017 17:01:23 +0100
Subject: [R-pkg-devel] issues with SOfun - package upload
Message-ID: <CABswX-LGHe2XnAOiUOVQxc+n1tK1HpfdTfWtf+H5pvE-B8HmkA@mail.gmail.com>

Good evening,

I am trying to upload my package, called PdPDB 2.0.
When building and checking the package with R-studio with --as-cran option
selected, everything looks ok but, once I tried to upload the package to
CRAN I had the following reply:

*"Strong dependencies not in mainstream repositories:*
*  SOfun*
** checking package namespace information ... OK*
** checking package dependencies ... ERROR*
*Package required but not available: 'SOfun'"*

I understand the issue it with SOfun that is a package I downloaded and
installed from this github url: https://github.com/mrdwab/SOfun

I came back to CARN policies and I have read:


*"Packages on which a CRAN package depends should be available from a
mainstream repository: if any mentioned in ?Suggests? or ?Enhances? fields
are not from such a repository, where to obtain them at a repository should
be specified in an ?Additional_repositories? field of the DESCRIPTION file
(as a comma-separated list of repository URLs) or for other means of
access, described in the ?Description? field."*

So, I updated the DESCRIPTION file as follows:
Additional_repositories: http://news.mrdwab.com/install_github.R

Before to proceed to submission, I would like to know if this is the right
way to proceed or I misinterpreted the submission procedure.

Thank you for reading this email,
Best,

-- 
Luca Belmonte, PhD

Dept. Life Sciences,
University of Modena and Reggio Emilia

Mobile: +39 328 45 81 762

	[[alternative HTML version deleted]]


From brian at braverock.com  Wed Nov  8 17:59:43 2017
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 08 Nov 2017 10:59:43 -0600
Subject: [R-pkg-devel] issues with SOfun - package upload
In-Reply-To: <CABswX-LGHe2XnAOiUOVQxc+n1tK1HpfdTfWtf+H5pvE-B8HmkA@mail.gmail.com>
References: <CABswX-LGHe2XnAOiUOVQxc+n1tK1HpfdTfWtf+H5pvE-B8HmkA@mail.gmail.com>
Message-ID: <1510160383.27637.44.camel@braverock.com>

I think you should be using:

Additional_repositories: https://github.com/mrdwab/SOfun

since that is the actual repository.

Regards,

Brian

On Wed, 2017-11-08 at 17:01 +0100, LUCA BELMONTE wrote:
> Good evening,
> 
> I am trying to upload my package, called PdPDB 2.0.
> When building and checking the package with R-studio with --as-cran
> option
> selected, everything looks ok but, once I tried to upload the package
> to
> CRAN I had the following reply:
> 
> *"Strong dependencies not in mainstream repositories:*
> *??SOfun*
> ** checking package namespace information ... OK*
> ** checking package dependencies ... ERROR*
> *Package required but not available: 'SOfun'"*
> 
> I understand the issue it with SOfun that is a package I downloaded
> and
> installed from this github url: https://github.com/mrdwab/SOfun
> 
> I came back to CARN policies and I have read:
> 
> 
> *"Packages on which a CRAN package depends should be available from a
> mainstream repository: if any mentioned in ?Suggests? or ?Enhances?
> fields
> are not from such a repository, where to obtain them at a repository
> should
> be specified in an ?Additional_repositories? field of the DESCRIPTION
> file
> (as a comma-separated list of repository URLs) or for other means of
> access, described in the ?Description? field."*
> 
> So, I updated the DESCRIPTION file as follows:
> Additional_repositories: http://news.mrdwab.com/install_github.R
> 
> Before to proceed to submission, I would like to know if this is the
> right
> way to proceed or I misinterpreted the submission procedure.
> 
> Thank you for reading this email,
> Best,
>


From ligges at statistik.tu-dortmund.de  Wed Nov  8 18:03:15 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 8 Nov 2017 18:03:15 +0100
Subject: [R-pkg-devel] issues with SOfun - package upload
In-Reply-To: <1510160383.27637.44.camel@braverock.com>
References: <CABswX-LGHe2XnAOiUOVQxc+n1tK1HpfdTfWtf+H5pvE-B8HmkA@mail.gmail.com>
 <1510160383.27637.44.camel@braverock.com>
Message-ID: <bdd0d8bc-a845-1a3c-bd06-effd58ac7599@statistik.tu-dortmund.de>

And even this cannot work for strong dependencies, as sztrong 
deendencies must be available from mainstream repositoreis.

Best,
Uwe Ligges




On 08.11.2017 17:59, Brian G. Peterson wrote:
> I think you should be using:
> 
> Additional_repositories: https://github.com/mrdwab/SOfun
> 
> since that is the actual repository.
> 
> Regards,
> 
> Brian
> 
> On Wed, 2017-11-08 at 17:01 +0100, LUCA BELMONTE wrote:
>> Good evening,
>>
>> I am trying to upload my package, called PdPDB 2.0.
>> When building and checking the package with R-studio with --as-cran
>> option
>> selected, everything looks ok but, once I tried to upload the package
>> to
>> CRAN I had the following reply:
>>
>> *"Strong dependencies not in mainstream repositories:*
>> *??SOfun*
>> ** checking package namespace information ... OK*
>> ** checking package dependencies ... ERROR*
>> *Package required but not available: 'SOfun'"*
>>
>> I understand the issue it with SOfun that is a package I downloaded
>> and
>> installed from this github url: https://github.com/mrdwab/SOfun
>>
>> I came back to CARN policies and I have read:
>>
>>
>> *"Packages on which a CRAN package depends should be available from a
>> mainstream repository: if any mentioned in ?Suggests? or ?Enhances?
>> fields
>> are not from such a repository, where to obtain them at a repository
>> should
>> be specified in an ?Additional_repositories? field of the DESCRIPTION
>> file
>> (as a comma-separated list of repository URLs) or for other means of
>> access, described in the ?Description? field."*
>>
>> So, I updated the DESCRIPTION file as follows:
>> Additional_repositories: http://news.mrdwab.com/install_github.R
>>
>> Before to proceed to submission, I would like to know if this is the
>> right
>> way to proceed or I misinterpreted the submission procedure.
>>
>> Thank you for reading this email,
>> Best,
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From ligges at statistik.tu-dortmund.de  Wed Nov  8 18:03:26 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 8 Nov 2017 18:03:26 +0100
Subject: [R-pkg-devel] Outdated Winbuilder package "INLA"
In-Reply-To: <fde39298-2a1b-b1dc-6be5-e701d0ca0f70@statistik.tu-dortmund.de>
References: <CAKrMbEXmVvo=gQRfWJf4wAEQD1r2NnaOn_w7hCmK4c1udrPGZQ@mail.gmail.com>
 <fde39298-2a1b-b1dc-6be5-e701d0ca0f70@statistik.tu-dortmund.de>
Message-ID: <d4cd85bd-7fcf-f1a2-452c-f8b533efc353@statistik.tu-dortmund.de>

Now insalled, please resub,it the package now.
Best,
Uwe Ligges



On 08.11.2017 17:21, Uwe Ligges wrote:
> 
> 
> On 08.11.2017 14:25, Fabian Bachl wrote:
>> Hi everyone,
>>
>> I am trying to submit a package to CRAN that depends on INLA, which 
>> itself
>> is not on CRAN. However, INLA is installed on the winbuilder machine but
>> the version is 0.0-1440400394 and extremely outdated (older than a 
>> year, I
>> think) and some essential functions that I use are not available. I tried
>> to adjust my DESCRIPTION file by stating "depends: INLA (>= 17.06.20)" 
>> but
>> winbuilder reports the error "Package required and
>> available but unsuitable version: 'INLA'". What's the best way to 
>> approach
>> this problem?
> 
> Tell the CRAN team. For winbuilder: Tell me. ;-)
> I will update shortly.
> 
> Best,
> Uwe Ligges
> 
> 
> 
>> Kind regards,
>> Fabian Bachl
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From bachlfab at googlemail.com  Wed Nov  8 18:04:24 2017
From: bachlfab at googlemail.com (Fabian Bachl)
Date: Wed, 08 Nov 2017 17:04:24 +0000
Subject: [R-pkg-devel] Outdated Winbuilder package "INLA"
In-Reply-To: <fde39298-2a1b-b1dc-6be5-e701d0ca0f70@statistik.tu-dortmund.de>
References: <CAKrMbEXmVvo=gQRfWJf4wAEQD1r2NnaOn_w7hCmK4c1udrPGZQ@mail.gmail.com>
 <fde39298-2a1b-b1dc-6be5-e701d0ca0f70@statistik.tu-dortmund.de>
Message-ID: <CAKrMbEU=yO45R5hDK5HJNQi2A7L9ZO9H4Q+pR9fK4wLYPGP6PQ@mail.gmail.com>

Great, thank you so much!

On Wed, Nov 8, 2017 at 5:21 PM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

>
>
> On 08.11.2017 14:25, Fabian Bachl wrote:
> > Hi everyone,
> >
> > I am trying to submit a package to CRAN that depends on INLA, which
> itself
> > is not on CRAN. However, INLA is installed on the winbuilder machine but
> > the version is 0.0-1440400394 and extremely outdated (older than a year,
> I
> > think) and some essential functions that I use are not available. I tried
> > to adjust my DESCRIPTION file by stating "depends: INLA (>= 17.06.20)"
> but
> > winbuilder reports the error "Package required and
> > available but unsuitable version: 'INLA'". What's the best way to
> approach
> > this problem?
>
> Tell the CRAN team. For winbuilder: Tell me. ;-)
> I will update shortly.
>
> Best,
> Uwe Ligges
>
>
>
> > Kind regards,
> > Fabian Bachl
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>

	[[alternative HTML version deleted]]


From r.turner at auckland.ac.nz  Thu Nov  9 06:05:33 2017
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Thu, 9 Nov 2017 18:05:33 +1300
Subject: [R-pkg-devel] Macros in Rd files.
Message-ID: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>


I tried to define a macro to produce today's date (like unto the 
"\today" command in LaTeX):

\newcommand{\today}{format(Sys.date(),"%d/%m/%Y")}

I put this into my *.Rd file just before invoking it.  (Something like
"I don't think I will do any more work today (i.e. \today).")

When I did

     R CMD build ldEst

to my package I got the warning:

> Warning: /tmp/RtmpL6sNnQ/Rbuild7f3036693218/ldEst/man/sampleCiLength.Rd:95:
> unexpected END_OF_INPUT '\keyword{ datagen }

Clearly I'm stuffing something up.  Can some kind soul please provide me 
with guidance as to what I *should* be doing?

Ta.

cheers,

Rolf Turner

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From luca.belmonte at unimore.it  Thu Nov  9 09:53:43 2017
From: luca.belmonte at unimore.it (LUCA BELMONTE)
Date: Thu, 9 Nov 2017 09:53:43 +0100
Subject: [R-pkg-devel] issues with SOfun - package upload
In-Reply-To: <bdd0d8bc-a845-1a3c-bd06-effd58ac7599@statistik.tu-dortmund.de>
References: <CABswX-LGHe2XnAOiUOVQxc+n1tK1HpfdTfWtf+H5pvE-B8HmkA@mail.gmail.com>
 <1510160383.27637.44.camel@braverock.com>
 <bdd0d8bc-a845-1a3c-bd06-effd58ac7599@statistik.tu-dortmund.de>
Message-ID: <CABswX-Krf_jme-kqwNxOuTQJ6MqUtLBwWA_zZFc2BM=4w-Vu0A@mail.gmail.com>

Dear Brian,
Dear Uwe,

Thank you for your replies.

I wrote a function that does the same stuff that the suggested package
does.
Now there are no reference to suggested packages.

Best,
Luca

2017-11-08 18:03 GMT+01:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:

> And even this cannot work for strong dependencies, as sztrong deendencies
> must be available from mainstream repositoreis.
>
> Best,
> Uwe Ligges
>
>
>
>
>
> On 08.11.2017 17:59, Brian G. Peterson wrote:
>
>> I think you should be using:
>>
>> Additional_repositories: https://github.com/mrdwab/SOfun
>>
>> since that is the actual repository.
>>
>> Regards,
>>
>> Brian
>>
>> On Wed, 2017-11-08 at 17:01 +0100, LUCA BELMONTE wrote:
>>
>>> Good evening,
>>>
>>> I am trying to upload my package, called PdPDB 2.0.
>>> When building and checking the package with R-studio with --as-cran
>>> option
>>> selected, everything looks ok but, once I tried to upload the package
>>> to
>>> CRAN I had the following reply:
>>>
>>> *"Strong dependencies not in mainstream repositories:*
>>> *  SOfun*
>>> ** checking package namespace information ... OK*
>>> ** checking package dependencies ... ERROR*
>>> *Package required but not available: 'SOfun'"*
>>>
>>> I understand the issue it with SOfun that is a package I downloaded
>>> and
>>> installed from this github url: https://github.com/mrdwab/SOfun
>>>
>>> I came back to CARN policies and I have read:
>>>
>>>
>>> *"Packages on which a CRAN package depends should be available from a
>>> mainstream repository: if any mentioned in ?Suggests? or ?Enhances?
>>> fields
>>> are not from such a repository, where to obtain them at a repository
>>> should
>>> be specified in an ?Additional_repositories? field of the DESCRIPTION
>>> file
>>> (as a comma-separated list of repository URLs) or for other means of
>>> access, described in the ?Description? field."*
>>>
>>> So, I updated the DESCRIPTION file as follows:
>>> Additional_repositories: http://news.mrdwab.com/install_github.R
>>>
>>> Before to proceed to submission, I would like to know if this is the
>>> right
>>> way to proceed or I misinterpreted the submission procedure.
>>>
>>> Thank you for reading this email,
>>> Best,
>>>
>>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>>


-- 
Luca Belmonte, PhD

Dept. Life Sciences,
University of Modena and Reggio Emilia

Mobile: +39 328 45 81 762

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Thu Nov  9 11:06:34 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 9 Nov 2017 11:06:34 +0100
Subject: [R-pkg-devel] Macros in Rd files.
In-Reply-To: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
Message-ID: <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>

Note the % may be a comment?

Uwe


On 09.11.2017 06:05, Rolf Turner wrote:
> 
> I tried to define a macro to produce today's date (like unto the 
> "\today" command in LaTeX):
> 
> \newcommand{\today}{format(Sys.date(),"%d/%m/%Y")}
> 
> I put this into my *.Rd file just before invoking it.? (Something like
> "I don't think I will do any more work today (i.e. \today).")
> 
> When I did
> 
>  ??? R CMD build ldEst
> 
> to my package I got the warning:
> 
>> Warning: 
>> /tmp/RtmpL6sNnQ/Rbuild7f3036693218/ldEst/man/sampleCiLength.Rd:95:
>> unexpected END_OF_INPUT '\keyword{ datagen }
> 
> Clearly I'm stuffing something up.? Can some kind soul please provide me 
> with guidance as to what I *should* be doing?
> 
> Ta.
> 
> cheers,
> 
> Rolf Turner
>


From murdoch.duncan at gmail.com  Thu Nov  9 11:40:21 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 9 Nov 2017 05:40:21 -0500
Subject: [R-pkg-devel] Macros in Rd files.
In-Reply-To: <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
Message-ID: <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>

On 09/11/2017 5:06 AM, Uwe Ligges wrote:
> Note the % may be a comment?
> 

Yes, and the body should be written in Rd markup, not R.  Working out 
the appropriate number of escapes is painful; I recommend trial and error.

This worked for me:

  \newcommand{\today}{\Sexpr{format(Sys.Date(),"\\\%d/\\\%m/\\\%Y")}}

Duncan Murdoch

> Uwe
> 
> 
> On 09.11.2017 06:05, Rolf Turner wrote:
>>
>> I tried to define a macro to produce today's date (like unto the
>> "\today" command in LaTeX):
>>
>> \newcommand{\today}{format(Sys.date(),"%d/%m/%Y")}
>>
>> I put this into my *.Rd file just before invoking it.? (Something like
>> "I don't think I will do any more work today (i.e. \today).")
>>
>> When I did
>>
>>   ??? R CMD build ldEst
>>
>> to my package I got the warning:
>>
>>> Warning:
>>> /tmp/RtmpL6sNnQ/Rbuild7f3036693218/ldEst/man/sampleCiLength.Rd:95:
>>> unexpected END_OF_INPUT '\keyword{ datagen }
>>
>> Clearly I'm stuffing something up.? Can some kind soul please provide me
>> with guidance as to what I *should* be doing?
>>
>> Ta.
>>
>> cheers,
>>
>> Rolf Turner
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From dasonk at gmail.com  Thu Nov  9 17:17:49 2017
From: dasonk at gmail.com (Dason Kurkiewicz)
Date: Thu, 9 Nov 2017 11:17:49 -0500
Subject: [R-pkg-devel] issues with SOfun - package upload
In-Reply-To: <CABswX-Krf_jme-kqwNxOuTQJ6MqUtLBwWA_zZFc2BM=4w-Vu0A@mail.gmail.com>
References: <CABswX-LGHe2XnAOiUOVQxc+n1tK1HpfdTfWtf+H5pvE-B8HmkA@mail.gmail.com>
 <1510160383.27637.44.camel@braverock.com>
 <bdd0d8bc-a845-1a3c-bd06-effd58ac7599@statistik.tu-dortmund.de>
 <CABswX-Krf_jme-kqwNxOuTQJ6MqUtLBwWA_zZFc2BM=4w-Vu0A@mail.gmail.com>
Message-ID: <CAJZYZZ40mfqnWhAJ67HnhyZ2seweWkL-X=H0qPmPpPCM6AeA-w@mail.gmail.com>

Did you write it from scratch or modify the function from the package
you were referencing?  There may be some licensing issues you need to
consider either way.

-Dason

On Thu, Nov 9, 2017 at 3:53 AM, LUCA BELMONTE <luca.belmonte at unimore.it> wrote:
> Dear Brian,
> Dear Uwe,
>
> Thank you for your replies.
>
> I wrote a function that does the same stuff that the suggested package
> does.
> Now there are no reference to suggested packages.
>
> Best,
> Luca
>
> 2017-11-08 18:03 GMT+01:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>
>> And even this cannot work for strong dependencies, as sztrong deendencies
>> must be available from mainstream repositoreis.
>>
>> Best,
>> Uwe Ligges
>>
>>
>>
>>
>>
>> On 08.11.2017 17:59, Brian G. Peterson wrote:
>>
>>> I think you should be using:
>>>
>>> Additional_repositories: https://github.com/mrdwab/SOfun
>>>
>>> since that is the actual repository.
>>>
>>> Regards,
>>>
>>> Brian
>>>
>>> On Wed, 2017-11-08 at 17:01 +0100, LUCA BELMONTE wrote:
>>>
>>>> Good evening,
>>>>
>>>> I am trying to upload my package, called PdPDB 2.0.
>>>> When building and checking the package with R-studio with --as-cran
>>>> option
>>>> selected, everything looks ok but, once I tried to upload the package
>>>> to
>>>> CRAN I had the following reply:
>>>>
>>>> *"Strong dependencies not in mainstream repositories:*
>>>> *  SOfun*
>>>> ** checking package namespace information ... OK*
>>>> ** checking package dependencies ... ERROR*
>>>> *Package required but not available: 'SOfun'"*
>>>>
>>>> I understand the issue it with SOfun that is a package I downloaded
>>>> and
>>>> installed from this github url: https://github.com/mrdwab/SOfun
>>>>
>>>> I came back to CARN policies and I have read:
>>>>
>>>>
>>>> *"Packages on which a CRAN package depends should be available from a
>>>> mainstream repository: if any mentioned in ?Suggests? or ?Enhances?
>>>> fields
>>>> are not from such a repository, where to obtain them at a repository
>>>> should
>>>> be specified in an ?Additional_repositories? field of the DESCRIPTION
>>>> file
>>>> (as a comma-separated list of repository URLs) or for other means of
>>>> access, described in the ?Description? field."*
>>>>
>>>> So, I updated the DESCRIPTION file as follows:
>>>> Additional_repositories: http://news.mrdwab.com/install_github.R
>>>>
>>>> Before to proceed to submission, I would like to know if this is the
>>>> right
>>>> way to proceed or I misinterpreted the submission procedure.
>>>>
>>>> Thank you for reading this email,
>>>> Best,
>>>>
>>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>>
>
>
> --
> Luca Belmonte, PhD
>
> Dept. Life Sciences,
> University of Modena and Reggio Emilia
>
> Mobile: +39 328 45 81 762
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From Chris.Brien at unisa.edu.au  Thu Nov  9 13:38:04 2017
From: Chris.Brien at unisa.edu.au (Chris Brien)
Date: Thu, 9 Nov 2017 12:38:04 +0000
Subject: [R-pkg-devel] R CMD INSTALL crashes with recent builds of r-devel
Message-ID: <4badcc417bef4da281d4b4229971b45c@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>

Dear list members,

I have three packages on CRAN (asremlPlus, dae and imageData). 

The current versions of all three packages can be built and installed using build of 2017-06-27 r72859 development snapshot of R. I am doing this on a 64-bit laptop and a 64-bit desktop, both running Windows 10.

However, in order to upload a new version to imageData, I have been attempting since 23/10/2017 to build it with more recent builds of r-devel. For instance, I have used several builds between Windows 32/64 bit binary build of the 2017-10-29 r73635 development snapshot of R and the build 2017-11-06 r73681 development snapshot of R. In every case it has failed.

When I use 

devtools::check("imageData", manual=TRUE, check_dir="D:/Analyses/R", document=FALSE, 
                args="--as-cran", build_args="--compact-docs")

I get the following output

* installing *source* package 'imageData' ...
** R
** data
** inst
** preparing package for lazy loading
In R CMD INSTALL

Running R CMD INSTALL gives similar output:

D:\Analyses\R>R CMD INSTALL --build --debug imageData
In R CMD INSTALL
processing 'imageData'
a directory
* installing to library 'D:/Analyses/R library'
* build_help_types=
* DBG: 'R CMD INSTALL' now doing do_install()
* created lock directory 'D:/Analyses/R library/00LOCK-imageData'
* installing *source* package 'imageData' ...
** backing up earlier installation
** R
** data
** inst
** preparing package for lazy loading

In addition a dialog box with the following error message is obtained:

R for Window terminal front-end has stopped working.

I have used rhub to test the installation for all the platforms with the development version that are available on rhub with the same result.

I have reached a dead-end in that I do not know how I can get any further information that would help to identify the problem.

Any suggestions as to how I might proceed towards a solution to this problem?
 
Cheers, 

  Chris Brien

Adjunct Senior Lecturer in Statistics
-----
Phenomics and Bioinformatics Research Centre
University of South Australia
GPO Box 2471
ADELAIDE  5001  South Australia
Phone:? +61 8 8302 5535   Fax:? +61 8 8302 5785
Email:?? Chris.Brien at unisa.edu.au 
WEB page:? <http://people.unisa.edu.au/Chris.Brien> 
CRICOS No 00121B 


From r.turner at auckland.ac.nz  Thu Nov  9 20:58:26 2017
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 10 Nov 2017 08:58:26 +1300
Subject: [R-pkg-devel] Macros in Rd files.
In-Reply-To: <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
Message-ID: <abecea7a-893c-65ca-c3ff-018c6574d5ec@auckland.ac.nz>

On 09/11/17 23:06, Uwe Ligges wrote:
> Note the % may be a comment?

Ah, yes.  Of course!  Duh! (Slaps forehead vigorously!)

Thanks.

cheers,

Rolf


-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From r.turner at auckland.ac.nz  Thu Nov  9 21:05:29 2017
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 10 Nov 2017 09:05:29 +1300
Subject: [R-pkg-devel] Macros in Rd files.
In-Reply-To: <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
Message-ID: <a05701b6-718d-5ed6-e4a8-85e03486e129@auckland.ac.nz>

On 09/11/17 23:40, Duncan Murdoch wrote:
> On 09/11/2017 5:06 AM, Uwe Ligges wrote:
>> Note the % may be a comment?
>>
> 
> Yes, and the body should be written in Rd markup, not R.? Working out 
> the appropriate number of escapes is painful; I recommend trial and error.
> 
> This worked for me:
> 
>  ?\newcommand{\today}{\Sexpr{format(Sys.Date(),"\\\%d/\\\%m/\\\%Y")}}

Now that is a bit more subtle!  I don't understand what "written in Rd 
markup" really means, and I don't understand the "\Sexpr" construction.
I'd seen it when looking at the example macros in

    /usr/local/lib64/R/share/Rd/macros/system.Rd

but I figured if you know nothing about it, don't mess with it.

Is there anywhere that I could read up about writing "in Rd markup"?

Anyway, thanks for giving me the recipe, which is what I really need.

cheers,

Rolf

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From r.turner at auckland.ac.nz  Thu Nov  9 21:29:00 2017
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 10 Nov 2017 09:29:00 +1300
Subject: [R-pkg-devel] Macros in Rd files --- supplementary question ...
In-Reply-To: <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
Message-ID: <bc3311fb-cd5a-f057-c208-c87df5d18394@auckland.ac.nz>


... Mr. Speaker.

On 09/11/17 23:40, Duncan Murdoch wrote:
> On 09/11/2017 5:06 AM, Uwe Ligges wrote:
>> Note the % may be a comment?
>>
> 
> Yes, and the body should be written in Rd markup, not R.? Working out 
> the appropriate number of escapes is painful; I recommend trial and error.
> 
> This worked for me:
> 
>  ?\newcommand{\today}{\Sexpr{format(Sys.Date(),"\\\%d/\\\%m/\\\%Y")}}

Did that, and it worked like a charm.  However when I do the "R CMD 
build" thing, when it comes to the "* building the PDF package manual"
step it says "Hmm ... looks like a package" (no shit, Sherlock!) and 
emits a huge amount of verbose LaTeX diagnostics.

"Normally" one just gets the line "* building the PDF package manual"
and nothing else, and "R CMD build" just carries on cruising.

Evidently defining a macro in the *.Rd file triggers the extra elaboration.

It's no big deal of course, but I just thought I'd ask:

(a) Is there anything to worry about in this respect?

(b) Is there anything different that I should be doing?

(c) Is there anyway of suppressing the (ever-so-slightly annoying)
extra screen output?

I guess that's really three supplementary questions ....

Thanks for any pointers.

cheers,

Rolf

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From murdoch.duncan at gmail.com  Fri Nov 10 00:00:31 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 9 Nov 2017 18:00:31 -0500
Subject: [R-pkg-devel] Macros in Rd files --- supplementary question ...
In-Reply-To: <bc3311fb-cd5a-f057-c208-c87df5d18394@auckland.ac.nz>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
 <bc3311fb-cd5a-f057-c208-c87df5d18394@auckland.ac.nz>
Message-ID: <89d1eee7-3a6a-5ddd-f564-f61a1fce68e8@gmail.com>

On 09/11/2017 3:29 PM, Rolf Turner wrote:
> 
> ... Mr. Speaker.
> 
> On 09/11/17 23:40, Duncan Murdoch wrote:
>> On 09/11/2017 5:06 AM, Uwe Ligges wrote:
>>> Note the % may be a comment?
>>>
>>
>> Yes, and the body should be written in Rd markup, not R.? Working out
>> the appropriate number of escapes is painful; I recommend trial and error.
>>
>> This worked for me:
>>
>>   ?\newcommand{\today}{\Sexpr{format(Sys.Date(),"\\\%d/\\\%m/\\\%Y")}}
> 
> Did that, and it worked like a charm.  However when I do the "R CMD
> build" thing, when it comes to the "* building the PDF package manual"
> step it says "Hmm ... looks like a package" (no shit, Sherlock!) and
> emits a huge amount of verbose LaTeX diagnostics.
> 
> "Normally" one just gets the line "* building the PDF package manual"
> and nothing else, and "R CMD build" just carries on cruising.
> 
> Evidently defining a macro in the *.Rd file triggers the extra elaboration.
> 
> It's no big deal of course, but I just thought I'd ask:
> 
> (a) Is there anything to worry about in this respect?

Of course, never ignore diagnostics.  Worry about every line that was 
printed!

> 
> (b) Is there anything different that I should be doing?

Sounds like it...
> 
> (c) Is there anyway of suppressing the (ever-so-slightly annoying)
> extra screen output?

Oooh, that's such a bad idea.  Don't do that.  Fix the problem that led 
to the output.

Duncan

> 
> I guess that's really three supplementary questions ....
> 
> Thanks for any pointers.
> 
> cheers,
> 
> Rolf
>


From murdoch.duncan at gmail.com  Fri Nov 10 00:09:05 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 9 Nov 2017 18:09:05 -0500
Subject: [R-pkg-devel] Macros in Rd files.
In-Reply-To: <a05701b6-718d-5ed6-e4a8-85e03486e129@auckland.ac.nz>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
 <a05701b6-718d-5ed6-e4a8-85e03486e129@auckland.ac.nz>
Message-ID: <abb95442-ebf7-ea08-4047-f70ad374bd77@gmail.com>

On 09/11/2017 3:05 PM, Rolf Turner wrote:
> On 09/11/17 23:40, Duncan Murdoch wrote:
>> On 09/11/2017 5:06 AM, Uwe Ligges wrote:
>>> Note the % may be a comment?
>>>
>>
>> Yes, and the body should be written in Rd markup, not R.? Working out
>> the appropriate number of escapes is painful; I recommend trial and error.
>>
>> This worked for me:
>>
>>   ?\newcommand{\today}{\Sexpr{format(Sys.Date(),"\\\%d/\\\%m/\\\%Y")}}
> 
> Now that is a bit more subtle!  I don't understand what "written in Rd
> markup" really means, and I don't understand the "\Sexpr" construction.
> I'd seen it when looking at the example macros in
> 
>      /usr/local/lib64/R/share/Rd/macros/system.Rd
> 
> but I figured if you know nothing about it, don't mess with it.
> 
> Is there anywhere that I could read up about writing "in Rd markup"?

Not sure this would be helpful, but there's

http://developer.r-project.org/parseRd.pdf

The short summary is this:

Rd files are a mess.  There are several different modes of parsing that 
apply:  at the top level you have Rd code, and in different contexts you 
may have R code (or something close to it), or verbatim code (just 
kidding!  There are ways to signal you want out).  Table 1 in that 
document says what syntax is expected within what macro.  In 
\newcommand, it says it wants "verbatim" input, but really it's going to 
interpret that as Rd input, i.e. LaTeX-like.

Regret asking yet?

Duncan Murdoch

> 
> Anyway, thanks for giving me the recipe, which is what I really need.
> 
> cheers,
> 
> Rolf
>


From murdoch.duncan at gmail.com  Fri Nov 10 00:07:52 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 9 Nov 2017 18:07:52 -0500
Subject: [R-pkg-devel] Macros in Rd files.
In-Reply-To: <a05701b6-718d-5ed6-e4a8-85e03486e129@auckland.ac.nz>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
 <a05701b6-718d-5ed6-e4a8-85e03486e129@auckland.ac.nz>
Message-ID: <a8558779-66c6-54d0-1f73-56dad785e704@gmail.com>

On 09/11/2017 3:05 PM, Rolf Turner wrote:
> On 09/11/17 23:40, Duncan Murdoch wrote:
>> On 09/11/2017 5:06 AM, Uwe Ligges wrote:
>>> Note the % may be a comment?
>>>
>>
>> Yes, and the body should be written in Rd markup, not R.? Working out
>> the appropriate number of escapes is painful; I recommend trial and error.
>>
>> This worked for me:
>>
>>   ?\newcommand{\today}{\Sexpr{format(Sys.Date(),"\\\%d/\\\%m/\\\%Y")}}
> 
> Now that is a bit more subtle!  I don't understand what "written in Rd
> markup" really means, and I don't understand the "\Sexpr" construction.
> I'd seen it when looking at the example macros in
> 
>      /usr/local/lib64/R/share/Rd/macros/system.Rd
> 
> but I figured if you know nothing about it, don't mess with it.
> 
> Is there anywhere that I could read up about writing "in Rd markup"?

Not sure this would be helpful, but there's

http://developer.r-project.org/parseRd.pdf

The short summary is this:

Rd files are a mess.  There are several different modes of parsing that 
apply:  at the top level you have Rd code, and in different contexts you 
may have R code (or something close to it), or verbatim code (just 
kidding!  There are ways to signal you want out).  Table 1 in that 
document says what syntax is expected within what macro.  In 
\newcommand, it says it wants "verbatim" input, but really it's going to 
interpret that as Rd input, i.e. LaTeX-like.

Regret asking yet?

Duncan Murdoch

> 
> Anyway, thanks for giving me the recipe, which is what I really need.
> 
> cheers,
> 
> Rolf
>


From r.turner at auckland.ac.nz  Fri Nov 10 00:35:42 2017
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 10 Nov 2017 12:35:42 +1300
Subject: [R-pkg-devel] Macros in Rd files --- supplementary question ...
In-Reply-To: <89d1eee7-3a6a-5ddd-f564-f61a1fce68e8@gmail.com>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
 <bc3311fb-cd5a-f057-c208-c87df5d18394@auckland.ac.nz>
 <89d1eee7-3a6a-5ddd-f564-f61a1fce68e8@gmail.com>
Message-ID: <c2126c77-9910-a788-6034-06b53d52af37@auckland.ac.nz>


On 10/11/17 12:00, Duncan Murdoch wrote:

[Rolf Turner wrote:]
>  ...  when I do the "R CMD
>> build" thing, when it comes to the "* building the PDF package manual"
>> step it says "Hmm ... looks like a package" (no shit, Sherlock!) and
>> emits a huge amount of verbose LaTeX diagnostics.
>>
>> "Normally" one just gets the line "* building the PDF package manual"
>> and nothing else, and "R CMD build" just carries on cruising.
>>
>> Evidently defining a macro in the *.Rd file triggers the extra 
>> elaboration.
>>
>> It's no big deal of course, but I just thought I'd ask:
>>
>> (a) Is there anything to worry about in this respect?
> 
> Of course, never ignore diagnostics.? Worry about every line that was 
> printed!
> 
>>
>> (b) Is there anything different that I should be doing?
> 
> Sounds like it...
>>
>> (c) Is there anyway of suppressing the (ever-so-slightly annoying)
>> extra screen output?
> 
> Oooh, that's such a bad idea.? Don't do that.? Fix the problem that led 
> to the output.

Trouble is, I don't (a) know if this really *is* a problem, or (b) if it 
is, any idea of how to work out how to fix it.

I would like to know if it is "an expected phenomenon".  Does it happen 
to other people?  I.e. is there anyone out there who has defined their
own macro in a *.Rd file, and if so, do *they* get a plethora of LaTeX
messages when they do "R CMD build" to the package in question?

I'd love to hear from you! :-)

cheers,

Rolf

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From francois.michonneau at gmail.com  Fri Nov 10 01:10:33 2017
From: francois.michonneau at gmail.com (=?UTF-8?Q?Fran=C3=A7ois_Michonneau?=)
Date: Thu, 9 Nov 2017 19:10:33 -0500
Subject: [R-pkg-devel] Macros in Rd files --- supplementary question ...
In-Reply-To: <c2126c77-9910-a788-6034-06b53d52af37@auckland.ac.nz>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
 <bc3311fb-cd5a-f057-c208-c87df5d18394@auckland.ac.nz>
 <89d1eee7-3a6a-5ddd-f564-f61a1fce68e8@gmail.com>
 <c2126c77-9910-a788-6034-06b53d52af37@auckland.ac.nz>
Message-ID: <CAKL30wWmK+_d0a=cyZgmYpOL5kVGCo90iFCrbGbzjK_vByhogQ@mail.gmail.com>

A github search might be helpful to identify packages that define macros in
their Rd files:
https://github.com/search?utf8=%E2%9C%93&q=user%3Acran+extension%3Ard+newcommand&type=Code

On Thu, Nov 9, 2017 at 6:35 PM, Rolf Turner <r.turner at auckland.ac.nz> wrote:

>
> On 10/11/17 12:00, Duncan Murdoch wrote:
>
> [Rolf Turner wrote:]
>
>>  ...  when I do the "R CMD
>>
>>> build" thing, when it comes to the "* building the PDF package manual"
>>> step it says "Hmm ... looks like a package" (no shit, Sherlock!) and
>>> emits a huge amount of verbose LaTeX diagnostics.
>>>
>>> "Normally" one just gets the line "* building the PDF package manual"
>>> and nothing else, and "R CMD build" just carries on cruising.
>>>
>>> Evidently defining a macro in the *.Rd file triggers the extra
>>> elaboration.
>>>
>>> It's no big deal of course, but I just thought I'd ask:
>>>
>>> (a) Is there anything to worry about in this respect?
>>>
>>
>> Of course, never ignore diagnostics.  Worry about every line that was
>> printed!
>>
>>
>>> (b) Is there anything different that I should be doing?
>>>
>>
>> Sounds like it...
>>
>>>
>>> (c) Is there anyway of suppressing the (ever-so-slightly annoying)
>>> extra screen output?
>>>
>>
>> Oooh, that's such a bad idea.  Don't do that.  Fix the problem that led
>> to the output.
>>
>
> Trouble is, I don't (a) know if this really *is* a problem, or (b) if it
> is, any idea of how to work out how to fix it.
>
> I would like to know if it is "an expected phenomenon".  Does it happen to
> other people?  I.e. is there anyone out there who has defined their
> own macro in a *.Rd file, and if so, do *they* get a plethora of LaTeX
> messages when they do "R CMD build" to the package in question?
>
> I'd love to hear from you! :-)
>
> cheers,
>
> Rolf
>
> --
> Technical Editor ANZJS
> Department of Statistics
> University of Auckland
> Phone: +64-9-373-7599 ext. 88276
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From r.turner at auckland.ac.nz  Fri Nov 10 02:00:21 2017
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 10 Nov 2017 14:00:21 +1300
Subject: [R-pkg-devel] Macros in Rd files --- supplementary question ...
In-Reply-To: <CAKL30wWmK+_d0a=cyZgmYpOL5kVGCo90iFCrbGbzjK_vByhogQ@mail.gmail.com>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
 <bc3311fb-cd5a-f057-c208-c87df5d18394@auckland.ac.nz>
 <89d1eee7-3a6a-5ddd-f564-f61a1fce68e8@gmail.com>
 <c2126c77-9910-a788-6034-06b53d52af37@auckland.ac.nz>
 <CAKL30wWmK+_d0a=cyZgmYpOL5kVGCo90iFCrbGbzjK_vByhogQ@mail.gmail.com>
Message-ID: <c70e70f8-dfc6-9fd8-45bb-2763fcb8e3df@auckland.ac.nz>

On 10/11/17 13:10, Fran?ois Michonneau wrote:
> A github search might be helpful to identify packages that define macros 
> in their Rd files:
> https://github.com/search?utf8=%E2%9C%93&q=user%3Acran+extension%3Ard+newcommand&type=Code

Thanks.  Looking into it.

cheers,

Rolf

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From rubak at math.aau.dk  Fri Nov 10 09:26:54 2017
From: rubak at math.aau.dk (Ege Rubak)
Date: Fri, 10 Nov 2017 09:26:54 +0100
Subject: [R-pkg-devel] Macros in Rd files --- supplementary question ...
In-Reply-To: <c70e70f8-dfc6-9fd8-45bb-2763fcb8e3df@auckland.ac.nz>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
 <bc3311fb-cd5a-f057-c208-c87df5d18394@auckland.ac.nz>
 <89d1eee7-3a6a-5ddd-f564-f61a1fce68e8@gmail.com>
 <c2126c77-9910-a788-6034-06b53d52af37@auckland.ac.nz>
 <CAKL30wWmK+_d0a=cyZgmYpOL5kVGCo90iFCrbGbzjK_vByhogQ@mail.gmail.com>
 <c70e70f8-dfc6-9fd8-45bb-2763fcb8e3df@auckland.ac.nz>
Message-ID: <5a0ee515-f7c0-a3ce-f5b5-52974044d859@math.aau.dk>

Hi Rolf,
Another place to look for macros in Rd files would be in the spatstat 
package which I know you are quite familiary with ;-)
However, I think our macros are plain LaTeX without calls to \Sexpr so 
it may behave differently than the case at hand.
Cheers,
Ege

On 11/10/2017 02:00 AM, Rolf Turner wrote:
> On 10/11/17 13:10, Fran?ois Michonneau wrote:
>> A github search might be helpful to identify packages that define 
>> macros in their Rd files:
>> https://github.com/search?utf8=%E2%9C%93&q=user%3Acran+extension%3Ard+newcommand&type=Code 
>>
> 
> Thanks.? Looking into it.
> 
> cheers,
> 
> Rolf
>


From georgi.boshnakov at manchester.ac.uk  Fri Nov 10 10:57:47 2017
From: georgi.boshnakov at manchester.ac.uk (Georgi Boshnakov)
Date: Fri, 10 Nov 2017 09:57:47 +0000
Subject: [R-pkg-devel] Macros in Rd files.
In-Reply-To: <a8558779-66c6-54d0-1f73-56dad785e704@gmail.com>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
 <a05701b6-718d-5ed6-e4a8-85e03486e129@auckland.ac.nz>
 <a8558779-66c6-54d0-1f73-56dad785e704@gmail.com>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E018F623856@MBXP02.ds.man.ac.uk>

>http://developer.r-project.org/parseRd.pdf

I would add that it is best to think of "Rd markup" as a subset of TeX/LaTeX markup (with some extentions) defined in 
"Writing R Extensions" and Duncan's reference above. 

The "subset" is important - if a feature is not mentioned in these references, it is not available.
 I once inadvertently used a modifier in the tabular environment (maybe something like {l|l|l} which was fine for 'R CMD check', the pdf manual and CRAN but the package failed to install on a system setup for static installation of html documentation.

Georgi Boshnakov

-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Duncan Murdoch
Sent: 09 November 2017 23:08
To: Rolf Turner
Cc: r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Macros in Rd files.

On 09/11/2017 3:05 PM, Rolf Turner wrote:
> On 09/11/17 23:40, Duncan Murdoch wrote:
>> On 09/11/2017 5:06 AM, Uwe Ligges wrote:
>>> Note the % may be a comment?
>>>
>>
>> Yes, and the body should be written in Rd markup, not R.? Working out 
>> the appropriate number of escapes is painful; I recommend trial and error.
>>
>> This worked for me:
>>
>>   ?
>> \newcommand{\today}{\Sexpr{format(Sys.Date(),"\\\%d/\\\%m/\\\%Y")}}
> 
> Now that is a bit more subtle!  I don't understand what "written in Rd 
> markup" really means, and I don't understand the "\Sexpr" construction.
> I'd seen it when looking at the example macros in
> 
>      /usr/local/lib64/R/share/Rd/macros/system.Rd
> 
> but I figured if you know nothing about it, don't mess with it.
> 
> Is there anywhere that I could read up about writing "in Rd markup"?

Not sure this would be helpful, but there's

http://developer.r-project.org/parseRd.pdf

The short summary is this:

Rd files are a mess.  There are several different modes of parsing that
apply:  at the top level you have Rd code, and in different contexts you may have R code (or something close to it), or verbatim code (just kidding!  There are ways to signal you want out).  Table 1 in that document says what syntax is expected within what macro.  In \newcommand, it says it wants "verbatim" input, but really it's going to interpret that as Rd input, i.e. LaTeX-like.

Regret asking yet?

Duncan Murdoch

> 
> Anyway, thanks for giving me the recipe, which is what I really need.
> 
> cheers,
> 
> Rolf
>

______________________________________________
R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel

From stuart.lacy at york.ac.uk  Fri Nov 10 10:42:12 2017
From: stuart.lacy at york.ac.uk (Stuart Lacy)
Date: Fri, 10 Nov 2017 09:42:12 +0000
Subject: [R-pkg-devel] Using another package's method that isn't exported
Message-ID: <5bce58b4-f01d-e060-2425-1e7c3a480a7b@york.ac.uk>

Hi,

Yesterday I released the initial submission of my package 'epitab' to 
CRAN https://cran.r-project.org/web/packages/epitab/index.html. On my PC 
and on win_builder it passed CMD CHECK without any notes, warnings, or 
submissions. However,? the built version has a note on some 
architectures, that I have some namespaces in Imports in my DESCRIPTION 
that are not actually imported from. 
https://cran.r-project.org/web/checks/check_results_epitab.html

This is because my code uses the confint.glm method from MASS, so I add 
MASS to my Imports. However, the actual confint.glm method is not an 
exported function from MASS, and so in the code I never actually run 
MASS::confint.glm(mod), I just run the generic stats::confint(mod) on a 
glm object. I understand that to fix this note I need to explicitly use 
the imported MASS package, but I can't see how if I can't manually call 
the function that I'm using.

The other package that I've Imported without explicitly using is `xml2`, 
as win-builder threw up an error with "undefined exports" for various 
xml functions, that adding xml2 to the Imports fixed. 
https://win-builder.r-project.org/G6RKiYtBQqaH/00check.log I didn't have 
any issue with xml2 on Linux.

Thanks,
Stuart

-- 
Stuart Lacy
Research Fellow
Epidemiology and Cancer Statistics Group
University of York
01904 321118
Disclaimer: http://www.york.ac.uk/docs/disclaimer/email.htm


From georgi.boshnakov at manchester.ac.uk  Fri Nov 10 12:54:16 2017
From: georgi.boshnakov at manchester.ac.uk (Georgi Boshnakov)
Date: Fri, 10 Nov 2017 11:54:16 +0000
Subject: [R-pkg-devel] Using another package's method that isn't exported
In-Reply-To: <5bce58b4-f01d-e060-2425-1e7c3a480a7b@york.ac.uk>
References: <5bce58b4-f01d-e060-2425-1e7c3a480a7b@york.ac.uk>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E018F6238DA@MBXP02.ds.man.ac.uk>

Hi,

Presumably, you have imported 'confint' from 'stats'.
Just import something from MASS, e.g 'ginv':

importFrom(MASS,ginv)

or choose something else by studying the output of  ls(asNamespace("MASS")).

Similarly  import something from xml2.

Note that "IMPORTS" in DESCRIPTION ensures that the packages listed there are loaded.
Imports in NAMESPACE specify the functions and other objects that  the functions in your package
will 'see' without '::' qualifiers. For generics, your package needs only to 'see' the generics, so it is sufficient to import the relevant generics ('confint' in your case).  You don't need to import methods, unless you explicitly call them. It doesn't matter if the functions implementing them are exported or not. (Actually, there are further nuances in the terminology here - an S3 method is 'registered' if the generic knows about it. The function implementing it may or may not have been exported).

The message you got is a quality control message potentially letting you know that you don't need a package you have declared. 

Thanks,
Georgi

-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Stuart Lacy
Sent: 10 November 2017 09:42
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Using another package's method that isn't exported

Hi,

Yesterday I released the initial submission of my package 'epitab' to CRAN https://cran.r-project.org/web/packages/epitab/index.html. On my PC and on win_builder it passed CMD CHECK without any notes, warnings, or submissions. However,? the built version has a note on some architectures, that I have some namespaces in Imports in my DESCRIPTION that are not actually imported from. 
https://cran.r-project.org/web/checks/check_results_epitab.html

This is because my code uses the confint.glm method from MASS, so I add MASS to my Imports. However, the actual confint.glm method is not an exported function from MASS, and so in the code I never actually run MASS::confint.glm(mod), I just run the generic stats::confint(mod) on a glm object. I understand that to fix this note I need to explicitly use the imported MASS package, but I can't see how if I can't manually call the function that I'm using.

The other package that I've Imported without explicitly using is `xml2`, as win-builder threw up an error with "undefined exports" for various xml functions, that adding xml2 to the Imports fixed. 
https://win-builder.r-project.org/G6RKiYtBQqaH/00check.log I didn't have any issue with xml2 on Linux.

Thanks,
Stuart

--
Stuart Lacy
Research Fellow
Epidemiology and Cancer Statistics Group University of York
01904 321118
Disclaimer: http://www.york.ac.uk/docs/disclaimer/email.htm

______________________________________________
R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel

From luca.belmonte at unimore.it  Fri Nov 10 13:19:00 2017
From: luca.belmonte at unimore.it (LUCA BELMONTE)
Date: Fri, 10 Nov 2017 13:19:00 +0100
Subject: [R-pkg-devel] issues with SOfun - package upload
In-Reply-To: <CAJZYZZ40mfqnWhAJ67HnhyZ2seweWkL-X=H0qPmPpPCM6AeA-w@mail.gmail.com>
References: <CABswX-LGHe2XnAOiUOVQxc+n1tK1HpfdTfWtf+H5pvE-B8HmkA@mail.gmail.com>
 <1510160383.27637.44.camel@braverock.com>
 <bdd0d8bc-a845-1a3c-bd06-effd58ac7599@statistik.tu-dortmund.de>
 <CABswX-Krf_jme-kqwNxOuTQJ6MqUtLBwWA_zZFc2BM=4w-Vu0A@mail.gmail.com>
 <CAJZYZZ40mfqnWhAJ67HnhyZ2seweWkL-X=H0qPmPpPCM6AeA-w@mail.gmail.com>
Message-ID: <CABswX-LavqRxTcBnEmRZzzK76q=Gr2Des_BFTu31+CbXNZEnzQ@mail.gmail.com>

Hi Dason,

I wrote it from scratch.

Thank you for the suggestion though,

Luca

2017-11-09 17:17 GMT+01:00 Dason Kurkiewicz <dasonk at gmail.com>:

> Did you write it from scratch or modify the function from the package
> you were referencing?  There may be some licensing issues you need to
> consider either way.
>
> -Dason
>
> On Thu, Nov 9, 2017 at 3:53 AM, LUCA BELMONTE <luca.belmonte at unimore.it>
> wrote:
> > Dear Brian,
> > Dear Uwe,
> >
> > Thank you for your replies.
> >
> > I wrote a function that does the same stuff that the suggested package
> > does.
> > Now there are no reference to suggested packages.
> >
> > Best,
> > Luca
> >
> > 2017-11-08 18:03 GMT+01:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
> >
> >> And even this cannot work for strong dependencies, as sztrong
> deendencies
> >> must be available from mainstream repositoreis.
> >>
> >> Best,
> >> Uwe Ligges
> >>
> >>
> >>
> >>
> >>
> >> On 08.11.2017 17:59, Brian G. Peterson wrote:
> >>
> >>> I think you should be using:
> >>>
> >>> Additional_repositories: https://github.com/mrdwab/SOfun
> >>>
> >>> since that is the actual repository.
> >>>
> >>> Regards,
> >>>
> >>> Brian
> >>>
> >>> On Wed, 2017-11-08 at 17:01 +0100, LUCA BELMONTE wrote:
> >>>
> >>>> Good evening,
> >>>>
> >>>> I am trying to upload my package, called PdPDB 2.0.
> >>>> When building and checking the package with R-studio with --as-cran
> >>>> option
> >>>> selected, everything looks ok but, once I tried to upload the package
> >>>> to
> >>>> CRAN I had the following reply:
> >>>>
> >>>> *"Strong dependencies not in mainstream repositories:*
> >>>> *  SOfun*
> >>>> ** checking package namespace information ... OK*
> >>>> ** checking package dependencies ... ERROR*
> >>>> *Package required but not available: 'SOfun'"*
> >>>>
> >>>> I understand the issue it with SOfun that is a package I downloaded
> >>>> and
> >>>> installed from this github url: https://github.com/mrdwab/SOfun
> >>>>
> >>>> I came back to CARN policies and I have read:
> >>>>
> >>>>
> >>>> *"Packages on which a CRAN package depends should be available from a
> >>>> mainstream repository: if any mentioned in ?Suggests? or ?Enhances?
> >>>> fields
> >>>> are not from such a repository, where to obtain them at a repository
> >>>> should
> >>>> be specified in an ?Additional_repositories? field of the DESCRIPTION
> >>>> file
> >>>> (as a comma-separated list of repository URLs) or for other means of
> >>>> access, described in the ?Description? field."*
> >>>>
> >>>> So, I updated the DESCRIPTION file as follows:
> >>>> Additional_repositories: http://news.mrdwab.com/install_github.R
> >>>>
> >>>> Before to proceed to submission, I would like to know if this is the
> >>>> right
> >>>> way to proceed or I misinterpreted the submission procedure.
> >>>>
> >>>> Thank you for reading this email,
> >>>> Best,
> >>>>
> >>>>
> >>> ______________________________________________
> >>> R-package-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>
> >>>
> >
> >
> > --
> > Luca Belmonte, PhD
> >
> > Dept. Life Sciences,
> > University of Modena and Reggio Emilia
> >
> > Mobile: +39 328 45 81 762
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>



-- 
Luca Belmonte, PhD

Dept. Life Sciences,
University of Modena and Reggio Emilia

Mobile: +39 328 45 81 762

	[[alternative HTML version deleted]]


From icho at iastate.edu  Fri Nov 10 14:23:50 2017
From: icho at iastate.edu (Cho, In-Ho [CCE E])
Date: Fri, 10 Nov 2017 13:23:50 +0000
Subject: [R-pkg-devel] R package with Java issue, out of mem heap error
Message-ID: <DM5PR04MB37707177273CC106A3EF7DBBD2540@DM5PR04MB3770.namprd04.prod.outlook.com>

Dear R developers:

My group are facing a problem while using an R package of extream random trees. 

Using a slightly large data set (13000 rows?27 columns), the R package, specifically at the prediction task, aborts with error message like "Java outofmem .. heap...". I tested this on both Macpro and Window os. 

Any advice as to this issue will be really appreciated. 

Warm regards,

In Ho

___________________________________
In Ho Cho, Ph.D.
Assistant Professor
Dept. Civil, Construction and Environmental Engineering
Iowa State University
326 Town Engineering
Ames, Iowa 50011-3232, USA
office: 1-515-294-3241


From maxime.turgeon at mail.mcgill.ca  Fri Nov 10 14:29:05 2017
From: maxime.turgeon at mail.mcgill.ca (MTurgeon)
Date: Fri, 10 Nov 2017 07:29:05 -0600
Subject: [R-pkg-devel] R package with Java issue, out of mem heap error
In-Reply-To: <DM5PR04MB37707177273CC106A3EF7DBBD2540@DM5PR04MB3770.namprd04.prod.outlook.com>
References: <DM5PR04MB37707177273CC106A3EF7DBBD2540@DM5PR04MB3770.namprd04.prod.outlook.com>
Message-ID: <96e8d060-300c-b4ac-882b-0fab44b7e653@mail.mcgill.ca>

Hello,

This sounds like a problem you should discuss with/report to the 
maintainer of the particular package you are using, and you can get 
their email address from the DESCRIPTION file.

Cheers,

Max


On 2017-11-10 07:23 AM, Cho, In-Ho [CCE E] wrote:
> Dear R developers:
>
> My group are facing a problem while using an R package of extream random trees.
>
> Using a slightly large data set (13000 rows?27 columns), the R package, specifically at the prediction task, aborts with error message like "Java outofmem .. heap...". I tested this on both Macpro and Window os.
>
> Any advice as to this issue will be really appreciated.
>
> Warm regards,
>
> In Ho
>
> ___________________________________
> In Ho Cho, Ph.D.
> Assistant Professor
> Dept. Civil, Construction and Environmental Engineering
> Iowa State University
> 326 Town Engineering
> Ames, Iowa 50011-3232, USA
> office: 1-515-294-3241
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
-----------------------------------------------------------------

Maxime Turgeon, PhD candidate

Department of Epidemiology, Biostatistics and Occupational Health
McGill University


From r.turner at auckland.ac.nz  Fri Nov 10 21:01:27 2017
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 11 Nov 2017 09:01:27 +1300
Subject: [R-pkg-devel] Macros in Rd files --- supplementary question.
In-Reply-To: <bc3311fb-cd5a-f057-c208-c87df5d18394@auckland.ac.nz>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
 <bc3311fb-cd5a-f057-c208-c87df5d18394@auckland.ac.nz>
Message-ID: <afa22f29-9542-9992-fa2d-1caa45c99648@auckland.ac.nz>

On 10/11/17 09:29, Rolf Turner wrote:

> On 09/11/17 23:40, Duncan Murdoch wrote:
>> On 09/11/2017 5:06 AM, Uwe Ligges wrote:
>>> Note the % may be a comment?
>>>
>>
>> Yes, and the body should be written in Rd markup, not R.? Working out 
>> the appropriate number of escapes is painful; I recommend trial and 
>> error.
>>
>> This worked for me:
>>
>> ??\newcommand{\today}{\Sexpr{format(Sys.Date(),"\\\%d/\\\%m/\\\%Y")}}
> 
> Did that, and it worked like a charm.? However when I do the "R CMD 
> build" thing, when it comes to the "* building the PDF package manual"
> step it says "Hmm ... looks like a package" (no shit, Sherlock!) and 
> emits a huge amount of verbose LaTeX diagnostics.
> 
> "Normally" one just gets the line "* building the PDF package manual"
> and nothing else, and "R CMD build" just carries on cruising.
> 
> Evidently defining a macro in the *.Rd file triggers the extra elaboration.
> 
> It's no big deal of course, but I just thought I'd ask:
> 
> (a) Is there anything to worry about in this respect?
> 
> (b) Is there anything different that I should be doing?
> 
> (c) Is there anyway of suppressing the (ever-so-slightly annoying)
> extra screen output?
> 
> I guess that's really three supplementary questions ....

Following up a suggestion that I got from Adrian Baddeley I did

    R CMD build --help

(I guess this is a case of RTFM) and I got:


> Usage: R CMD build [options] pkgdirs
>
> Build R packages from package sources in the directories specified by
> ?pkgdirs?
>
> Options:
>   -h, --help        print short help message and exit
>   -v, --version        print version info and exit
>
>   --force               force removal of INDEX file
>   --keep-empty-dirs     do not remove empty dirs
>   --no-build-vignettes  do not (re)build package vignettes
>   --no-manual           do not build the PDF manual even if \Sexprs are present
> ...
> ...
> ... 


So:  What's triggering the building of the manual is the presence of 
\Sexpr in my macro, and I can suppress this and get rid of all the 
unwanted LaTeX bumff by using the --no-manual flag.

I must say that I don't see why the presence of a \Sexpr (WTF ever that 
is) should trigger the building of the manual.

May I humbly suggest to R Core that this behaviour be modified; perhaps 
there could be a --manual flag asking that the manual be built (whether 
or not there are \Sexpr expressions in the *.Rd files).

cheers,

Rolf

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From georgi.boshnakov at manchester.ac.uk  Sat Nov 11 20:08:29 2017
From: georgi.boshnakov at manchester.ac.uk (Georgi Boshnakov)
Date: Sat, 11 Nov 2017 19:08:29 +0000
Subject: [R-pkg-devel] Macros in Rd files --- supplementary question.
In-Reply-To: <afa22f29-9542-9992-fa2d-1caa45c99648@auckland.ac.nz>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
 <bc3311fb-cd5a-f057-c208-c87df5d18394@auckland.ac.nz>
 <afa22f29-9542-9992-fa2d-1caa45c99648@auckland.ac.nz>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E018F623A78@MBXP02.ds.man.ac.uk>

It is more subtle than that. 
\Sexpr triggers the creation of "partial Rd database" which becomes part of the built package (the tar.gz file), although what exactly happens may also depend on 'stage' options of the \Sexpr's. 

> ... However when I do the "R CMD  build" thing, when it comes to the 
> "* building the PDF package manual"
> step it says "Hmm ... looks like a package" (no shit, Sherlock!) and 
> emits a huge amount of verbose LaTeX diagnostics.

I have never seen  "* building the PDF package manual" from 'R CMD build', see below for a sample console output on Windows from a package which contains Rd macros and vignettes. The messages you show seem to come from 'Rd2pdf'. Is it possible that you have some custom script that builds the manual, as well? Also some environment variable may be the culprit.

Best regards,
Georgi Boshnakov

C:\Users\mcbssgb2\Az\Rdevel\bitbucket\countr_project>R CMD build XXX
* checking for file 'XXX/DESCRIPTION' ... OK
* preparing 'XXX':
* checking DESCRIPTION meta-information ... OK
* cleaning src
* installing the package to process help pages
* saving partial Rd database
* creating vignettes ... OK
* cleaning src
* checking for LF line-endings in source and make files and shell scripts
* checking for empty or unneeded directories
* looking to see if a 'data/datalist' file should be added
* building 'XXX_3.4.1.tar.gz'



-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Rolf Turner
Sent: 10 November 2017 20:01
To: Duncan Murdoch
Cc: r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Macros in Rd files --- supplementary question.

On 10/11/17 09:29, Rolf Turner wrote:

> On 09/11/17 23:40, Duncan Murdoch wrote:
>> On 09/11/2017 5:06 AM, Uwe Ligges wrote:
>>> Note the % may be a comment?
>>>
>>
>> Yes, and the body should be written in Rd markup, not R.? Working out 
>> the appropriate number of escapes is painful; I recommend trial and 
>> error.
>>
>> This worked for me:
>>
>> ??\newcommand{\today}{\Sexpr{format(Sys.Date(),"\\\%d/\\\%m/\\\%Y")}}
> 
> Did that, and it worked like a charm.? However when I do the "R CMD 
> build" thing, when it comes to the "* building the PDF package manual"
> step it says "Hmm ... looks like a package" (no shit, Sherlock!) and 
> emits a huge amount of verbose LaTeX diagnostics.
> 
> "Normally" one just gets the line "* building the PDF package manual"
> and nothing else, and "R CMD build" just carries on cruising.
> 
> Evidently defining a macro in the *.Rd file triggers the extra elaboration.
> 
> It's no big deal of course, but I just thought I'd ask:
> 
> (a) Is there anything to worry about in this respect?
> 
> (b) Is there anything different that I should be doing?
> 
> (c) Is there anyway of suppressing the (ever-so-slightly annoying) 
> extra screen output?
> 
> I guess that's really three supplementary questions ....

Following up a suggestion that I got from Adrian Baddeley I did

    R CMD build --help

(I guess this is a case of RTFM) and I got:


> Usage: R CMD build [options] pkgdirs
>
> Build R packages from package sources in the directories specified by 
> ?pkgdirs?
>
> Options:
>   -h, --help        print short help message and exit
>   -v, --version        print version info and exit
>
>   --force               force removal of INDEX file
>   --keep-empty-dirs     do not remove empty dirs
>   --no-build-vignettes  do not (re)build package vignettes
>   --no-manual           do not build the PDF manual even if \Sexprs are present
> ...
> ...
> ... 


So:  What's triggering the building of the manual is the presence of \Sexpr in my macro, and I can suppress this and get rid of all the unwanted LaTeX bumff by using the --no-manual flag.

I must say that I don't see why the presence of a \Sexpr (WTF ever that
is) should trigger the building of the manual.

May I humbly suggest to R Core that this behaviour be modified; perhaps there could be a --manual flag asking that the manual be built (whether or not there are \Sexpr expressions in the *.Rd files).

cheers,

Rolf

--
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276

______________________________________________
R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel

From r.turner at auckland.ac.nz  Sat Nov 11 21:26:51 2017
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sun, 12 Nov 2017 09:26:51 +1300
Subject: [R-pkg-devel] Macros in Rd files --- supplementary question.
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E018F623A78@MBXP02.ds.man.ac.uk>
References: <ae3b6b5a-7531-7ad9-7670-75a3725b1e05@auckland.ac.nz>
 <04e51dae-3c73-fcf6-be9a-96faf4dd4f25@statistik.tu-dortmund.de>
 <c5777152-f876-ad7d-ec3b-c9cb156ab574@gmail.com>
 <bc3311fb-cd5a-f057-c208-c87df5d18394@auckland.ac.nz>
 <afa22f29-9542-9992-fa2d-1caa45c99648@auckland.ac.nz>
 <438D2EC9EAFE5946B2D5864670EA468E018F623A78@MBXP02.ds.man.ac.uk>
Message-ID: <5f89076b-8f5b-3d14-3297-a0bafee6ec5c@auckland.ac.nz>

On 12/11/17 08:08, Georgi Boshnakov wrote:
> It is more subtle than that.
> \Sexpr triggers the creation of "partial Rd database" which becomes part of the built package (the tar.gz file), although what exactly happens may also depend on 'stage' options of the \Sexpr's.
> 
>> ... However when I do the "R CMD  build" thing, when it comes to the
>> "* building the PDF package manual"
>> step it says "Hmm ... looks like a package" (no shit, Sherlock!) and
>> emits a huge amount of verbose LaTeX diagnostics.
> 
> I have never seen  "* building the PDF package manual" from 'R CMD build', see below for a sample console output on Windows from a package which contains Rd macros and vignettes.

But did/do the macros have \Sexpr's in them?

> The messages you show seem to come from 'Rd2pdf'. Is it possible that you have some custom script that builds the manual, as well?

No.  I haven't.

Also some environment variable may be the culprit.

Don't think so.

Anyhow, the message from R CMD build --help very clearly says:

>>> Usage: R CMD build [options] pkgdirs
>>>
>>> Build R packages from package sources in the directories specified by
>>> ?pkgdirs?
>>>
>>> Options:
>>>    -h, --help        print short help message and exit
>>>    -v, --version        print version info and exit
>>>
>>>    --force               force removal of INDEX file
>>>    --keep-empty-dirs     do not remove empty dirs
>>>    --no-build-vignettes  do not (re)build package vignettes
>>>    --no-manual           do not build the PDF manual even if \Sexprs are present
>>> ...
>>> ...
>>> ...

I think that's pretty definitive.

cheers,

Rolf

-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From roy.mendelssohn at noaa.gov  Sun Nov 12 02:41:07 2017
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Sat, 11 Nov 2017 17:41:07 -0800
Subject: [R-pkg-devel] Compiling packages from source on Mac OS X that
 require "-f openmp" - A solution
Message-ID: <594E7A26-1E69-4411-B7C0-9C2E84A9CE05@noaa.gov>

Hi All:

I wasn't quite certain the appropriate list for this,  but hopefully this will be found as needed. I know I have seen for several packages where building from source has failed on the Mac because of an error from using "-f openmp" in the compile options,  because the clang on the Mac didn't have openmp.

Now there is an R compatible version of clang with  openmp,  see:

http://thecoatlessprofessor.com/programming/openmp-in-r-on-os-x/#after-3-4-0

I just ran into this in trying to compile the latest version of the package "bssm".  Installing that version of clang solved the compilation errors.

-Roy

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From nacnudus at gmail.com  Tue Nov 14 00:01:23 2017
From: nacnudus at gmail.com (Duncan Garmonsway)
Date: Mon, 13 Nov 2017 23:01:23 +0000
Subject: [R-pkg-devel] win-builder fails via CRAN, not otherwise
Message-ID: <CAARqVQNyACi6HqMQZ__GVjgFikUsLivm_dAq-qafuyzB93cHjg@mail.gmail.com>

Hi,

I submitted a package to CRAN, and it failed the automatic build on
win-builder.  But it passed when I uploaded it directly to
win-builder.

Here is the relevant part of each build.  First, the build done via
the CRAN submission.  It fails something to do with character
encoding.

```
* using log directory 'd:/RCompile/CRANincoming/R-devel/tidyxl.Rcheck'
* using R Under development (unstable) (2017-09-12 r73242)
* using platform: x86_64-w64-mingw32 (64-bit)
* using session charset: ISO8859-1
* checking for file 'tidyxl/DESCRIPTION' ... OK
* this is package 'tidyxl' version '1.0.0'
* package encoding: UTF-8
...
** running tests for arch 'i386' ... [7s] ERROR
  Running 'testthat.R' [6s]
Running the tests in 'tests/testthat.R' failed.
Last 13 lines of output:
  x[2]: "1~`!@#$%^&()_-+={}|;\"'<,>.??????????"
  y[2]: "1~`!@#$%^&()_-+={}|;\"'<,>.?????"
...
** running tests for arch 'x64' ... [8s] ERROR
  Running 'testthat.R' [8s]
Running the tests in 'tests/testthat.R' failed.
Last 13 lines of output:
  x[2]: "1~`!@#$%^&()_-+={}|;\"'<,>.??????????"
  y[2]: "1~`!@#$%^&()_-+={}|;\"'<,>.?????"
```

Second, the same build, but directly (not via a CRAN submission, see
the first two lines)

```
* using log directory 'd:/RCompile/CRANguest/R-devel/tidyxl.Rcheck'
* using R Under development (unstable) (2017-09-12 r73242)
* using platform: x86_64-w64-mingw32 (64-bit)
* using session charset: ISO8859-1
* checking for file 'tidyxl/DESCRIPTION' ... OK
* this is package 'tidyxl' version '1.0.0'
* package encoding: UTF-8
...
** running tests for arch 'i386' ... [6s] OK
  Running 'testthat.R' [6s]
** running tests for arch 'x64' ... [6s] OK
  Running 'testthat.R' [5s]
```

How could I investigate this further?

Thanks,
Duncan


From berryboessenkool at hotmail.com  Tue Nov 14 16:44:40 2017
From: berryboessenkool at hotmail.com (Berry Boessenkool)
Date: Tue, 14 Nov 2017 15:44:40 +0000
Subject: [R-pkg-devel] vignette leaflet Mac
Message-ID: <AM5PR0401MB245260EAFA2A0B71BFD1771BD5280@AM5PR0401MB2452.eurprd04.prod.outlook.com>


Hi,

I have a vignette (URL below) with

leaflet(geoIndex) %>% addTiles() %>%
        addCircles(~lon, ~lat) [...]

that produces the following warning on solaris and osx:


Error in re-building vignettes:

Warning in engine$weave(file, quiet = quiet, encoding = enc) :
Pandoc (>= 1.12.3) and/or pandoc-citeproc not available. Falling back to R Markdown v1.
Warning in normalizePath(f2) :
path[1]="./webshot339b5b6a34d4.png": No such file or directory


I have no access to Solaris and OSX. How can I go about fixing this?
The warning started to appear with the last package update, but the vignette was not changed...

Thanks ahead,
Berry

URLs to vignette source, CRAN html view, check results:
https://raw.githubusercontent.com/brry/rdwd/master/vignettes/mapDWD.Rmd
https://cran.r-project.org/web/packages/rdwd/vignettes/mapDWD.html

https://cran.r-project.org/web/checks/check_results_rdwd.html


	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Tue Nov 14 18:03:37 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 14 Nov 2017 12:03:37 -0500
Subject: [R-pkg-devel] vignette leaflet Mac
In-Reply-To: <AM5PR0401MB245260EAFA2A0B71BFD1771BD5280@AM5PR0401MB2452.eurprd04.prod.outlook.com>
References: <AM5PR0401MB245260EAFA2A0B71BFD1771BD5280@AM5PR0401MB2452.eurprd04.prod.outlook.com>
Message-ID: <40fdba09-719e-c067-1d13-2e8f0d37c5ef@gmail.com>

On 14/11/2017 10:44 AM, Berry Boessenkool wrote:
> 
> Hi,
> 
> I have a vignette (URL below) with
> 
> leaflet(geoIndex) %>% addTiles() %>%
>          addCircles(~lon, ~lat) [...]
> 
> that produces the following warning on solaris and osx:
> 
> 
> Error in re-building vignettes:
> 
> Warning in engine$weave(file, quiet = quiet, encoding = enc) :
> Pandoc (>= 1.12.3) and/or pandoc-citeproc not available. Falling back to R Markdown v1.
> Warning in normalizePath(f2) :
> path[1]="./webshot339b5b6a34d4.png": No such file or directory
> 
> 
> I have no access to Solaris and OSX. How can I go about fixing this?
> The warning started to appear with the last package update, but the vignette was not changed...

Do you list Pandoc (>= 1.12.3) and pandoc-citeproc in your 
SystemRequirements?  That's about all you can do.  I think that version 
of Pandoc is not available on Solaris (or at least on the Solaris 
machines that CRAN tests on).  It is available on MacOS.

When you submit an update, mention the issue as you discuss your 
response to existing errors in CRAN tests.

Duncan Murdoch

> 
> Thanks ahead,
> Berry
> 
> URLs to vignette source, CRAN html view, check results:
> https://raw.githubusercontent.com/brry/rdwd/master/vignettes/mapDWD.Rmd
> https://cran.r-project.org/web/packages/rdwd/vignettes/mapDWD.html
> 
> https://cran.r-project.org/web/checks/check_results_rdwd.html
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From ddalthorp at usgs.gov  Fri Nov 17 23:19:29 2017
From: ddalthorp at usgs.gov (Dalthorp, Daniel)
Date: Fri, 17 Nov 2017 14:19:29 -0800
Subject: [R-pkg-devel] Rtools not communicating?
Message-ID: <CAJeYpE-QKA1B00_pcC7jmGV5g6qM-JaZfir=-zfDWdLf+tFcaw@mail.gmail.com>

Dear all,
I have used devtools with success and pleasure to build packages in the
past, but everything has changed recently. No success using build(binary =
T) in Windows 7 (with rtools34 and R-3.4.2). MANY hours searching for
solutions. Can someone help me?

In particular, I use devtools::build(binary = T) to build a package (called
CPparms) and devtools::install(). Then ls('package:CPparms') returns
character(0), indicating that there is nothing in my package.

Is it mis-communication between R and Rtools?
build(binary = T) tells me it is "installing *source* package" but
shouldn't it be building a binary package first?

Sys.getenv('PATH') gives the following items that are related to R and
Rtools:
c:\Rtools\bin;c:\Rtools\mingw_32\bin;...c:\Rtools\bin;c:\Rtools\gcc-4.6.3\bin;c:\Program
Files\R\R-3.4.2\bin\x64;...c:\Rtools\bin;c:\Rtools\gcc-4.6.3\bin;c:\Progra~1\R\R-3.0.2\bin\x64;

The first two items seem to be OK, but I don't not see
c:\Rtools\gcc-4.6.3\bin in my Window Explorer. Also, the path names for my
R-3.4.2 and R-3.0.2 are formatted differently.

R seems to know how to find Rtools:

> system('g++ -v')

Using built-in specs.
COLLECT_GCC=c:\Rtools\mingw_32\bin\G__~1.EXE
COLLECT_LTO_WRAPPER=c:/Rtools/mingw_32/bin/../libexec/gcc/i686-w64-mingw32/4.9.3/lto-wrapper.exe
Target: i686-w64-mingw32
Configured with: ../../../src/gcc-4.9.3/configure --host=i686-w64-mingw32
--build=i686-w64-mingw32 --target=i686-w64-mingw32 --prefix=/mingw32
--with-sysroot=/home/Jeroen/mingw-gcc-4.9.3/i686-493-posix-dwarf-rt_v3-s/mingw32
--with-gxx-include-dir=/mingw32/i686-w64-mingw32/include/c++
--enable-static --disable-shared --disable-multilib
--enable-languages=c,c++,fortran,lto --enable-libstdcxx-time=yes
--enable-threads=posix --enable-libgomp --enable-libatomic --enable-lto
--enable-graphite --enable-checking=release --enable-fully-dynamic-string
--enable-version-specific-runtime-libs --disable-sjlj-exceptions
--with-dwarf2 --disable-isl-version-check --disable-cloog-version-check
--disable-libstdcxx-pch --disable-libstdcxx-debug --enable-bootstrap
--disable-rpath --disable-win32-registry --disable-nls --disable-werror
--disable-symvers --with-gnu-as --with-gnu-ld --with-arch=i686
--with-tune=generic --with-libiconv --with-system-zlib
--with-gmp=/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static
--with-mpfr=/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static
--with-mpc=/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static
--with-isl=/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static
--with-cloog=/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static
--enable-cloog-backend=isl --with-pkgversion='i686-posix-dwarf, Built by
MinGW-W64 project' --with-bugurl=http://sourceforge.net/projects/mingw-w64
CFLAGS='-O2 -pipe
-I/home/Jeroen/mingw-gcc-4.9.3/i686-493-posix-dwarf-rt_v3-s/mingw32/opt/include
-I/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-zlib-static/include
-I/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static/include'
CXXFLAGS='-O2 -pipe
-I/home/Jeroen/mingw-gcc-4.9.3/i686-493-posix-dwarf-rt_v3-s/mingw32/opt/include
-I/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-zlib-static/include
-I/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static/include'
CPPFLAGS= LDFLAGS='-pipe
-L/home/Jeroen/mingw-gcc-4.9.3/i686-493-posix-dwarf-rt_v3-s/mingw32/opt/lib
-L/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-zlib-static/lib
-L/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static/lib
-Wl,--large-address-aware'
Thread model: posix
gcc version 4.9.3 (i686-posix-dwarf, Built by MinGW-W64 project)

Any suggestions?

Thanks.


-- 
Dan Dalthorp, PhD
USGS Forest and Rangeland Ecosystem Science Center
Forest Sciences Lab, Rm 311
3200 SW Jefferson Way
Corvallis, OR 97331
ph: 541-750-0953
ddalthorp at usgs.gov

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Sat Nov 18 01:46:13 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 17 Nov 2017 19:46:13 -0500
Subject: [R-pkg-devel] Rtools not communicating?
In-Reply-To: <CAJeYpE-QKA1B00_pcC7jmGV5g6qM-JaZfir=-zfDWdLf+tFcaw@mail.gmail.com>
References: <CAJeYpE-QKA1B00_pcC7jmGV5g6qM-JaZfir=-zfDWdLf+tFcaw@mail.gmail.com>
Message-ID: <14ac1609-844a-6531-0875-5d1d12d36b2e@gmail.com>

On 17/11/2017 5:19 PM, Dalthorp, Daniel wrote:
> Dear all,
> I have used devtools with success and pleasure to build packages in the
> past, but everything has changed recently. No success using build(binary =
> T) in Windows 7 (with rtools34 and R-3.4.2). MANY hours searching for
> solutions. Can someone help me?
> 
> In particular, I use devtools::build(binary = T) to build a package (called
> CPparms) and devtools::install(). Then ls('package:CPparms') returns
> character(0), indicating that there is nothing in my package.

That says that your package is on the search list (or you would have got

Error in as.environment(pos) :
   no item called "package:CPparms" on the search list

like me), but it isn't exporting anything.  That's different than having 
nothing in your package.


> 
> Is it mis-communication between R and Rtools?
> build(binary = T) tells me it is "installing *source* package" but
> shouldn't it be building a binary package first?

No.  A binary package is essentially an copy of an installed package.

Looks like you didn't export anything.  If you were building packages in 
the regular way (as described in the manuals), I'd suggest looking in 
the NAMESPACE file to be sure that something is being exported.  But 
you're using devtools, so I don't know if that will be informative.

Duncan Murdoch



> 
> Sys.getenv('PATH') gives the following items that are related to R and
> Rtools:
> c:\Rtools\bin;c:\Rtools\mingw_32\bin;...c:\Rtools\bin;c:\Rtools\gcc-4.6.3\bin;c:\Program
> Files\R\R-3.4.2\bin\x64;...c:\Rtools\bin;c:\Rtools\gcc-4.6.3\bin;c:\Progra~1\R\R-3.0.2\bin\x64;
> 
> The first two items seem to be OK, but I don't not see
> c:\Rtools\gcc-4.6.3\bin in my Window Explorer. Also, the path names for my
> R-3.4.2 and R-3.0.2 are formatted differently.
> 
> R seems to know how to find Rtools:
> 
>> system('g++ -v')
> 
> Using built-in specs.
> COLLECT_GCC=c:\Rtools\mingw_32\bin\G__~1.EXE
> COLLECT_LTO_WRAPPER=c:/Rtools/mingw_32/bin/../libexec/gcc/i686-w64-mingw32/4.9.3/lto-wrapper.exe
> Target: i686-w64-mingw32
> Configured with: ../../../src/gcc-4.9.3/configure --host=i686-w64-mingw32
> --build=i686-w64-mingw32 --target=i686-w64-mingw32 --prefix=/mingw32
> --with-sysroot=/home/Jeroen/mingw-gcc-4.9.3/i686-493-posix-dwarf-rt_v3-s/mingw32
> --with-gxx-include-dir=/mingw32/i686-w64-mingw32/include/c++
> --enable-static --disable-shared --disable-multilib
> --enable-languages=c,c++,fortran,lto --enable-libstdcxx-time=yes
> --enable-threads=posix --enable-libgomp --enable-libatomic --enable-lto
> --enable-graphite --enable-checking=release --enable-fully-dynamic-string
> --enable-version-specific-runtime-libs --disable-sjlj-exceptions
> --with-dwarf2 --disable-isl-version-check --disable-cloog-version-check
> --disable-libstdcxx-pch --disable-libstdcxx-debug --enable-bootstrap
> --disable-rpath --disable-win32-registry --disable-nls --disable-werror
> --disable-symvers --with-gnu-as --with-gnu-ld --with-arch=i686
> --with-tune=generic --with-libiconv --with-system-zlib
> --with-gmp=/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static
> --with-mpfr=/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static
> --with-mpc=/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static
> --with-isl=/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static
> --with-cloog=/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static
> --enable-cloog-backend=isl --with-pkgversion='i686-posix-dwarf, Built by
> MinGW-W64 project' --with-bugurl=http://sourceforge.net/projects/mingw-w64
> CFLAGS='-O2 -pipe
> -I/home/Jeroen/mingw-gcc-4.9.3/i686-493-posix-dwarf-rt_v3-s/mingw32/opt/include
> -I/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-zlib-static/include
> -I/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static/include'
> CXXFLAGS='-O2 -pipe
> -I/home/Jeroen/mingw-gcc-4.9.3/i686-493-posix-dwarf-rt_v3-s/mingw32/opt/include
> -I/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-zlib-static/include
> -I/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static/include'
> CPPFLAGS= LDFLAGS='-pipe
> -L/home/Jeroen/mingw-gcc-4.9.3/i686-493-posix-dwarf-rt_v3-s/mingw32/opt/lib
> -L/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-zlib-static/lib
> -L/home/Jeroen/mingw-gcc-4.9.3/prerequisites/i686-w64-mingw32-static/lib
> -Wl,--large-address-aware'
> Thread model: posix
> gcc version 4.9.3 (i686-posix-dwarf, Built by MinGW-W64 project)
> 
> Any suggestions?
> 
> Thanks.
> 
>


From yawen19922 at sina.com  Sat Nov 18 07:18:46 2017
From: yawen19922 at sina.com (yawen19922 at sina.com)
Date: Sat, 18 Nov 2017 14:18:46 +0800
Subject: [R-pkg-devel] upioading r packages error
Message-ID: <20171118061846.5B8DFC800B3@webmail.sinamail.sina.com.cn>

 when I use R CMD check my R packages,there is no error
when I
Warning: Failed to load RGtk2 dynamic library, attempting to install it.Please install GTK+ from http://ftp.gnome.org/pub/gnome/binaries/win64/gtk+/2.22/gtk+-bundle_2.22.1-20101229_win64.zipIf the package still does not load, please ensure that GTK+ is installed and that it is on your PATH environment variableIN ANY CASE, RESTART R BEFORE TRYING TO LOAD THE PACKAGE AGAINError in inDL(x, as.logical(local), as.logical(now), ...) :   unable to load shared object 'd:/temp/RtmpWyIo3H/RLIBS_29ee8702465d/RGtk2/libs/x64/RGtk2.dll':  LoadLibrary failure:  Die angegebene Prozedur wurde nicht gefunden.
	[[alternative HTML version deleted]]


From pperry at stern.nyu.edu  Tue Nov 21 03:34:19 2017
From: pperry at stern.nyu.edu (Patrick Perry)
Date: Mon, 20 Nov 2017 21:34:19 -0500
Subject: [R-pkg-devel] spurious rchk warning
Message-ID: <5A1390AB.6080504@stern.nyu.edu>

One of my packages has what I believe to be spurious rchk warnings:

 From 
https://raw.githubusercontent.com/kalibera/cran-checks/master/rchk/results/utf8.out

Package utf8 version 1.1.0
Package built using 73757/R 3.5.0; x86_64-pc-linux-gnu; 2017-11-20 22:02:23 UTC; unix
Checked with rchk version 63f79d910f5835174fcaa5a0a7d2409348f7d2ac
More information at https://github.com/kalibera/cran-checks/blob/master/rchk/PROTECT.md

Function rutf8_as_utf8
   [UP] unprotected variable ans while calling allocating function R_CheckUserInterrupt utf8/src/as_utf8.c:68
   [UP] unprotected variable ans while calling allocating function rutf8_translate_utf8 utf8/src/as_utf8.c:83
   [UP] unprotected variable ans while calling allocating function Rf_mkCharLenCE utf8/src/as_utf8.c:117

The offending function is at https://github.com/patperry/r-utf8/blob/master/src/as_utf8.c#L46

I tried to fix the warning in line 64 with

PROTECT(ans = sx); nprot++;

This did not work. Any suggestions?

Thanks,


Patrick


From maechler at stat.math.ethz.ch  Tue Nov 21 10:15:39 2017
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 21 Nov 2017 10:15:39 +0100
Subject: [R-pkg-devel] [Rd] package check fail on Windows-release only?
In-Reply-To: <CAErODj_g2m95Nx1WD=YsApCrzEo_Q1cHxQSOuKYhO9-DAFFOfg@mail.gmail.com>
References: <CAErODj_g2m95Nx1WD=YsApCrzEo_Q1cHxQSOuKYhO9-DAFFOfg@mail.gmail.com>
Message-ID: <23059.61115.505878.79893@stat.math.ethz.ch>

>>>>> Paul Johnson <pauljohn32 at gmail.com>
>>>>>     on Mon, 20 Nov 2017 14:59:26 -0600 writes:

    > I mistakenly left a write in "/tmp" in the rockchalk package (version
    > 1.8.109) that I uploaded last Friday. Kurt H wrote and asked me to fix
    > today.

    > While uploading a new one, I became aware of a problem I had not seen.
    > The version I uploaded last Friday, 1.8.109, has OK status on all
    > platforms except r-release-windows-ix86+x86_64. I get OK on
    > oldrel-windows and also on devel-windows.

    > https://cran.r-project.org/web/checks/check_results_rockchalk.html

    > Can you please advise me on what to do? I don't understand, well,
    > anything about this :(

Dear Paul,

something like this really should have been posted to the R-package-devel
list, not to R-devel; as it is here now, I'm crossposting to there for one msg
Please remove R-devel at .. from CC  if/when replying and keep it there.

    > The error says:

    > * installing *source* package 'rockchalk' ...
    > ** package 'rockchalk' successfully unpacked and MD5 sums checked
    > ** R
    > ** data
    > ** inst
    > ** preparing package for lazy loading
    > Warning: S3 methods 'print.sparseSummary', 'print.diagSummary',
    > 'c.abIndex', 'c.sparseVector', 'as.array.Matrix',
    > 'as.array.sparseVector', 'as.matrix.Matrix', 'as.matrix.sparseVector',
    > 'as.vector.Matrix', 'as.vector.sparseVector' were declared in
    > NAMESPACE but not found
    > Error in namespaceExport(ns, exports) :
    > undefined exports: %&%, Cholesky, .SuiteSparse_version, Diagonal,
    > .symDiagonal, .sparseDiagonal, .trDiagonal, Hilbert, KhatriRao,
    > Matrix, MatrixClass, spMatrix, sparseMatrix, rsparsematrix, Schur,
    > abIseq, abIseq1, rep2abI, band, bandSparse, bdiag, .bdiag,
    > c.sparseVector, condest, onenormest, .asmatrix, .dsy2mat, .dsy2dsp,
    > .dxC2mat, .T2Cmat, ..2dge, .dense2sy, .C2nC, .nC2d, .nC2l, .diag.dsC,
    > .solve.dgC.chol, .solve.dgC.qr, .solve.dgC.lu, diagN2U, diagU2N,
    > .diagU2N, .diag2tT, .diag2sT, .diag2mat, drop0, expand, expm, facmul,
    > fac2sparse, fac2Sparse, forceSymmetric, T2graph, graph2T,
    > anyDuplicatedT, uniqTsparse, isTriangular, isDiagonal, isLDL,
    > is.null.DN, invPerm, lu, nearPD, nnzero, formatSpMatrix,
    > formatSparseM, .formatSparseSimple, printSpMatrix, printSpMatrix2,
    > qrR, rankMatrix, readHB, readMM, sparse.model.matrix, sparseVector,
    > symmpart, skewpart, tril, triu, updown, pack, unpack,
    > .updateCHMfactor, .validateCsparse, writeMM, cBind, rBind
    > ERROR: lazy loading failed for package 'rockchalk'
    > * removing 'd:/Rcompile/CRANpkg/lib/3.4/rockchalk'
    > * restoring previous 'd:/Rcompile/CRANpkg/lib/3.4/rockchalk'

all of these these are names of  Matrix-package objects..
and I know that yesterday Matrix package version changes (1.1-11
--> 1.1-12) happened on CRAN and hence in servers which update..

So it *could* be this is all just a temporary problem aka "race
situation" , where the check of your package very unhappily
happened exactly at a moment where the new Matrix package was
already there, but not quite ....
seems quite improbable, but then your problem seems "rare"..

Martin


From josh.m.ulrich at gmail.com  Tue Nov 21 13:13:46 2017
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 21 Nov 2017 06:13:46 -0600
Subject: [R-pkg-devel] spurious rchk warning
In-Reply-To: <5A1390AB.6080504@stern.nyu.edu>
References: <5A1390AB.6080504@stern.nyu.edu>
Message-ID: <CAPPM_gQx+hhBnvhDg2rcZOrfF4umzwWvtnq2LjmXp9OnivxdKw@mail.gmail.com>

On Mon, Nov 20, 2017 at 8:34 PM, Patrick Perry <pperry at stern.nyu.edu> wrote:
> One of my packages has what I believe to be spurious rchk warnings:
>
> From
> https://raw.githubusercontent.com/kalibera/cran-checks/master/rchk/results/utf8.out
>
> Package utf8 version 1.1.0
> Package built using 73757/R 3.5.0; x86_64-pc-linux-gnu; 2017-11-20 22:02:23
> UTC; unix
> Checked with rchk version 63f79d910f5835174fcaa5a0a7d2409348f7d2ac
> More information at
> https://github.com/kalibera/cran-checks/blob/master/rchk/PROTECT.md
>
> Function rutf8_as_utf8
>   [UP] unprotected variable ans while calling allocating function
> R_CheckUserInterrupt utf8/src/as_utf8.c:68
>   [UP] unprotected variable ans while calling allocating function
> rutf8_translate_utf8 utf8/src/as_utf8.c:83
>   [UP] unprotected variable ans while calling allocating function
> Rf_mkCharLenCE utf8/src/as_utf8.c:117
>
> The offending function is at
> https://github.com/patperry/r-utf8/blob/master/src/as_utf8.c#L46
>
> I tried to fix the warning in line 64 with
>
> PROTECT(ans = sx); nprot++;
>
> This did not work. Any suggestions?
>
My hypothesis is that your PROTECT and UNPROTECT calls inside the for
loop are leaving 'ans' unprotected at some point.  Consider using
PROTECT_WITH_INDEX() and REPROTECT() instead.

> Thanks,
>
>
> Patrick
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2017 | www.rinfinance.com


From marcelino.delacruz at urjc.es  Tue Nov 21 11:02:39 2017
From: marcelino.delacruz at urjc.es (Marcelino de la Cruz Rot)
Date: Tue, 21 Nov 2017 11:02:39 +0100
Subject: [R-pkg-devel] [Rd] package check fail on Windows-release only?
In-Reply-To: <23059.61115.505878.79893@stat.math.ethz.ch>
References: <CAErODj_g2m95Nx1WD=YsApCrzEo_Q1cHxQSOuKYhO9-DAFFOfg@mail.gmail.com>
 <23059.61115.505878.79893@stat.math.ethz.ch>
Message-ID: <d0e9b64a-41c0-913a-c6c0-69e26d39471a@urjc.es>

Hi,

Just in case it makes some sense, the same Matrix-related error occurs 
at least for these other packages:

matchMulti ??? 1.1.6
compound.Cox ??? 3.6
mpmcorrelogram ??? 0.1-4
epr ??? 3.0
icensBKL ??? 1.1


Marcelino



El 21/11/2017 a las 10:15, Martin Maechler escribi?:
>>>>>> Paul Johnson <pauljohn32 at gmail.com>
>>>>>>      on Mon, 20 Nov 2017 14:59:26 -0600 writes:
>      > I mistakenly left a write in "/tmp" in the rockchalk package (version
>      > 1.8.109) that I uploaded last Friday. Kurt H wrote and asked me to fix
>      > today.
>
>      > While uploading a new one, I became aware of a problem I had not seen.
>      > The version I uploaded last Friday, 1.8.109, has OK status on all
>      > platforms except r-release-windows-ix86+x86_64. I get OK on
>      > oldrel-windows and also on devel-windows.
>
>      > https://cran.r-project.org/web/checks/check_results_rockchalk.html
>
>      > Can you please advise me on what to do? I don't understand, well,
>      > anything about this :(
>
> Dear Paul,
>
> something like this really should have been posted to the R-package-devel
> list, not to R-devel; as it is here now, I'm crossposting to there for one msg
> Please remove R-devel at .. from CC  if/when replying and keep it there.
>
>      > The error says:
>
>      > * installing *source* package 'rockchalk' ...
>      > ** package 'rockchalk' successfully unpacked and MD5 sums checked
>      > ** R
>      > ** data
>      > ** inst
>      > ** preparing package for lazy loading
>      > Warning: S3 methods 'print.sparseSummary', 'print.diagSummary',
>      > 'c.abIndex', 'c.sparseVector', 'as.array.Matrix',
>      > 'as.array.sparseVector', 'as.matrix.Matrix', 'as.matrix.sparseVector',
>      > 'as.vector.Matrix', 'as.vector.sparseVector' were declared in
>      > NAMESPACE but not found
>      > Error in namespaceExport(ns, exports) :
>      > undefined exports: %&%, Cholesky, .SuiteSparse_version, Diagonal,
>      > .symDiagonal, .sparseDiagonal, .trDiagonal, Hilbert, KhatriRao,
>      > Matrix, MatrixClass, spMatrix, sparseMatrix, rsparsematrix, Schur,
>      > abIseq, abIseq1, rep2abI, band, bandSparse, bdiag, .bdiag,
>      > c.sparseVector, condest, onenormest, .asmatrix, .dsy2mat, .dsy2dsp,
>      > .dxC2mat, .T2Cmat, ..2dge, .dense2sy, .C2nC, .nC2d, .nC2l, .diag.dsC,
>      > .solve.dgC.chol, .solve.dgC.qr, .solve.dgC.lu, diagN2U, diagU2N,
>      > .diagU2N, .diag2tT, .diag2sT, .diag2mat, drop0, expand, expm, facmul,
>      > fac2sparse, fac2Sparse, forceSymmetric, T2graph, graph2T,
>      > anyDuplicatedT, uniqTsparse, isTriangular, isDiagonal, isLDL,
>      > is.null.DN, invPerm, lu, nearPD, nnzero, formatSpMatrix,
>      > formatSparseM, .formatSparseSimple, printSpMatrix, printSpMatrix2,
>      > qrR, rankMatrix, readHB, readMM, sparse.model.matrix, sparseVector,
>      > symmpart, skewpart, tril, triu, updown, pack, unpack,
>      > .updateCHMfactor, .validateCsparse, writeMM, cBind, rBind
>      > ERROR: lazy loading failed for package 'rockchalk'
>      > * removing 'd:/Rcompile/CRANpkg/lib/3.4/rockchalk'
>      > * restoring previous 'd:/Rcompile/CRANpkg/lib/3.4/rockchalk'
>
> all of these these are names of  Matrix-package objects..
> and I know that yesterday Matrix package version changes (1.1-11
> --> 1.1-12) happened on CRAN and hence in servers which update..
>
> So it *could* be this is all just a temporary problem aka "race
> situation" , where the check of your package very unhappily
> happened exactly at a moment where the new Matrix package was
> already there, but not quite ....
> seems quite improbable, but then your problem seems "rare"..
>
> Martin
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> .
>

-- 
Marcelino de la Cruz Rot
Depto. de Biolog?a Y Geolog?a
Universidad Rey Juan Carlos
M?stoles Espa?a


From ligges at statistik.tu-dortmund.de  Tue Nov 21 13:49:22 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 21 Nov 2017 13:49:22 +0100
Subject: [R-pkg-devel] [Rd] package check fail on Windows-release only?
In-Reply-To: <23059.61115.505878.79893@stat.math.ethz.ch>
References: <CAErODj_g2m95Nx1WD=YsApCrzEo_Q1cHxQSOuKYhO9-DAFFOfg@mail.gmail.com>
 <23059.61115.505878.79893@stat.math.ethz.ch>
Message-ID: <4ee45c6b-6a08-991b-01d9-056c43184ef0@statistik.tu-dortmund.de>



On 21.11.2017 10:15, Martin Maechler wrote:
>>>>>> Paul Johnson <pauljohn32 at gmail.com>
>>>>>>      on Mon, 20 Nov 2017 14:59:26 -0600 writes:
> 
>      > I mistakenly left a write in "/tmp" in the rockchalk package (version
>      > 1.8.109) that I uploaded last Friday. Kurt H wrote and asked me to fix
>      > today.
> 
>      > While uploading a new one, I became aware of a problem I had not seen.
>      > The version I uploaded last Friday, 1.8.109, has OK status on all
>      > platforms except r-release-windows-ix86+x86_64. I get OK on
>      > oldrel-windows and also on devel-windows.
> 
>      > https://cran.r-project.org/web/checks/check_results_rockchalk.html
> 
>      > Can you please advise me on what to do? I don't understand, well,
>      > anything about this :(
> 
> Dear Paul,
> 
> something like this really should have been posted to the R-package-devel
> list, not to R-devel; as it is here now, I'm crossposting to there for one msg
> Please remove R-devel at .. from CC  if/when replying and keep it there.
> 
>      > The error says:
> 
>      > * installing *source* package 'rockchalk' ...
>      > ** package 'rockchalk' successfully unpacked and MD5 sums checked
>      > ** R
>      > ** data
>      > ** inst
>      > ** preparing package for lazy loading
>      > Warning: S3 methods 'print.sparseSummary', 'print.diagSummary',
>      > 'c.abIndex', 'c.sparseVector', 'as.array.Matrix',
>      > 'as.array.sparseVector', 'as.matrix.Matrix', 'as.matrix.sparseVector',
>      > 'as.vector.Matrix', 'as.vector.sparseVector' were declared in
>      > NAMESPACE but not found
>      > Error in namespaceExport(ns, exports) :
>      > undefined exports: %&%, Cholesky, .SuiteSparse_version, Diagonal,
>      > .symDiagonal, .sparseDiagonal, .trDiagonal, Hilbert, KhatriRao,
>      > Matrix, MatrixClass, spMatrix, sparseMatrix, rsparsematrix, Schur,
>      > abIseq, abIseq1, rep2abI, band, bandSparse, bdiag, .bdiag,
>      > c.sparseVector, condest, onenormest, .asmatrix, .dsy2mat, .dsy2dsp,
>      > .dxC2mat, .T2Cmat, ..2dge, .dense2sy, .C2nC, .nC2d, .nC2l, .diag.dsC,
>      > .solve.dgC.chol, .solve.dgC.qr, .solve.dgC.lu, diagN2U, diagU2N,
>      > .diagU2N, .diag2tT, .diag2sT, .diag2mat, drop0, expand, expm, facmul,
>      > fac2sparse, fac2Sparse, forceSymmetric, T2graph, graph2T,
>      > anyDuplicatedT, uniqTsparse, isTriangular, isDiagonal, isLDL,
>      > is.null.DN, invPerm, lu, nearPD, nnzero, formatSpMatrix,
>      > formatSparseM, .formatSparseSimple, printSpMatrix, printSpMatrix2,
>      > qrR, rankMatrix, readHB, readMM, sparse.model.matrix, sparseVector,
>      > symmpart, skewpart, tril, triu, updown, pack, unpack,
>      > .updateCHMfactor, .validateCsparse, writeMM, cBind, rBind
>      > ERROR: lazy loading failed for package 'rockchalk'
>      > * removing 'd:/Rcompile/CRANpkg/lib/3.4/rockchalk'
>      > * restoring previous 'd:/Rcompile/CRANpkg/lib/3.4/rockchalk'
> 
> all of these these are names of  Matrix-package objects..
> and I know that yesterday Matrix package version changes (1.1-11
> --> 1.1-12) happened on CRAN and hence in servers which update..
> 
> So it *could* be this is all just a temporary problem aka "race
> situation" , where the check of your package very unhappily
> happened exactly at a moment where the new Matrix package was
> already there, but not quite ....
> seems quite improbable, but then your problem seems "rare"..

Perfect analysis: Race condition. Happens from time to time.
Can you simply resubmit it, please.

Best,
Uwe Ligges




> 
> Martin
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From pperry at stern.nyu.edu  Tue Nov 21 15:46:19 2017
From: pperry at stern.nyu.edu (Patrick Perry)
Date: Tue, 21 Nov 2017 09:46:19 -0500
Subject: [R-pkg-devel] spurious rchk warning
In-Reply-To: <CAPPM_gQx+hhBnvhDg2rcZOrfF4umzwWvtnq2LjmXp9OnivxdKw@mail.gmail.com>
References: <5A1390AB.6080504@stern.nyu.edu>
 <CAPPM_gQx+hhBnvhDg2rcZOrfF4umzwWvtnq2LjmXp9OnivxdKw@mail.gmail.com>
Message-ID: <5A143C3B.3010200@stern.nyu.edu>

I think you're right, and I think I've found the offending code 
(https://github.com/patperry/r-utf8/blob/master/src/as_utf8.c#L111):

     if (!raw || ce == CE_BYTES || ce == CE_NATIVE) {
         if (!duped) {
             PROTECT(ans = duplicate(ans)); nprot++;
             duped = 1;
         }
         SET_STRING_ELT(ans, i,
                        mkCharLenCE((const char *)str,
                                    size, CE_UTF8));
     }

UNPROTECT(1); nprot--;

Thanks for the suggestion.


Patrick

> Joshua Ulrich <mailto:josh.m.ulrich at gmail.com>
> November 21, 2017 at 7:13 AM
> On Mon, Nov 20, 2017 at 8:34 PM, Patrick Perry<pperry at stern.nyu.edu>  wrote:
>> One of my packages has what I believe to be spurious rchk warnings:
>>
>> From
>> https://raw.githubusercontent.com/kalibera/cran-checks/master/rchk/results/utf8.out
>>
>> Package utf8 version 1.1.0
>> Package built using 73757/R 3.5.0; x86_64-pc-linux-gnu; 2017-11-20 22:02:23
>> UTC; unix
>> Checked with rchk version 63f79d910f5835174fcaa5a0a7d2409348f7d2ac
>> More information at
>> https://github.com/kalibera/cran-checks/blob/master/rchk/PROTECT.md
>>
>> Function rutf8_as_utf8
>>    [UP] unprotected variable ans while calling allocating function
>> R_CheckUserInterrupt utf8/src/as_utf8.c:68
>>    [UP] unprotected variable ans while calling allocating function
>> rutf8_translate_utf8 utf8/src/as_utf8.c:83
>>    [UP] unprotected variable ans while calling allocating function
>> Rf_mkCharLenCE utf8/src/as_utf8.c:117
>>
>> The offending function is at
>> https://github.com/patperry/r-utf8/blob/master/src/as_utf8.c#L46
>>
>> I tried to fix the warning in line 64 with
>>
>> PROTECT(ans = sx); nprot++;
>>
>> This did not work. Any suggestions?
>>
> My hypothesis is that your PROTECT and UNPROTECT calls inside the for
> loop are leaving 'ans' unprotected at some point.  Consider using
> PROTECT_WITH_INDEX() and REPROTECT() instead.
>
>> Thanks,
>>
>>
>> Patrick
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>
>
> Patrick Perry <mailto:pperry at stern.nyu.edu>
> November 20, 2017 at 9:34 PM
> One of my packages has what I believe to be spurious rchk warnings:
>
> From 
> https://raw.githubusercontent.com/kalibera/cran-checks/master/rchk/results/utf8.out 
>
>
> Package utf8 version 1.1.0
> Package built using 73757/R 3.5.0; x86_64-pc-linux-gnu; 2017-11-20 
> 22:02:23 UTC; unix
> Checked with rchk version 63f79d910f5835174fcaa5a0a7d2409348f7d2ac
> More information at 
> https://github.com/kalibera/cran-checks/blob/master/rchk/PROTECT.md
>
> Function rutf8_as_utf8
>   [UP] unprotected variable ans while calling allocating function 
> R_CheckUserInterrupt utf8/src/as_utf8.c:68
>   [UP] unprotected variable ans while calling allocating function 
> rutf8_translate_utf8 utf8/src/as_utf8.c:83
>   [UP] unprotected variable ans while calling allocating function 
> Rf_mkCharLenCE utf8/src/as_utf8.c:117
>
> The offending function is at 
> https://github.com/patperry/r-utf8/blob/master/src/as_utf8.c#L46
>
> I tried to fix the warning in line 64 with
>
> PROTECT(ans = sx); nprot++;
>
> This did not work. Any suggestions?
>
> Thanks,
>
>
> Patrick
>
>


	[[alternative HTML version deleted]]


From edd at debian.org  Tue Nov 21 21:37:45 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 21 Nov 2017 14:37:45 -0600
Subject: [R-pkg-devel] Why would src/Makevars be ignored?
Message-ID: <23060.36505.340385.816969@bud.eddelbuettel.com>


Having a bit of a puzzle with a package at work (which I can't share).

In src/Makevars I override CC, CXX, CXX11, CXX14 to point to a specific
(version) of g++ on my system, say g++-x.y.  I also set CXX_STD=CXX14

Only it doesn't work. I need an extra dot.RMakevars and an invocation via

  R_MAKEVARS_USER=~/git/thatpackage/dot.RMakevars R CMD INSTALL .

or else the values from R's default Makeconf come through.

How could that be?  I have invoked R CMD INSTALL probably thousands of times,
and most got it to what I wanted but setting values in it.  What could be
wrong here?

R 3.4.2; Ubuntu 17.04.

Puzzled,  Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murdoch.duncan at gmail.com  Tue Nov 21 22:51:33 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 21 Nov 2017 16:51:33 -0500
Subject: [R-pkg-devel] Why would src/Makevars be ignored?
In-Reply-To: <23060.36505.340385.816969@bud.eddelbuettel.com>
References: <23060.36505.340385.816969@bud.eddelbuettel.com>
Message-ID: <c0366d8c-8f74-3c55-4894-fce9e1730dc5@gmail.com>

On 21/11/2017 3:37 PM, Dirk Eddelbuettel wrote:
> 
> Having a bit of a puzzle with a package at work (which I can't share).
> 
> In src/Makevars I override CC, CXX, CXX11, CXX14 to point to a specific
> (version) of g++ on my system, say g++-x.y.  I also set CXX_STD=CXX14
> 
> Only it doesn't work. I need an extra dot.RMakevars and an invocation via
> 
>    R_MAKEVARS_USER=~/git/thatpackage/dot.RMakevars R CMD INSTALL .
> 
> or else the values from R's default Makeconf come through.
> 
> How could that be?  I have invoked R CMD INSTALL probably thousands of times,
> and most got it to what I wanted but setting values in it.  What could be
> wrong here?
> 
> R 3.4.2; Ubuntu 17.04.
> 
> Puzzled,  Dirk
> 


According to section 1.2.1 "Using Makevars" in Writing R Extensions, 
R_HOME/etcR_ARCH/Makeconf is included after Makevars, so what you're 
seeing is by design.  I believe this is so that packages are built with 
tools compatible with those that built R.  (Remember, packages are 
designed for distribution to diverse systems.)

If you happen to know how to override some of these settings in a safe 
way on your own system, then do what you did (as recommended in the R 
Admin manual, section 6.3.3.)

Duncan Murdoch


From edd at debian.org  Tue Nov 21 23:12:33 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 21 Nov 2017 16:12:33 -0600
Subject: [R-pkg-devel] Why would src/Makevars be ignored?
In-Reply-To: <c0366d8c-8f74-3c55-4894-fce9e1730dc5@gmail.com>
References: <23060.36505.340385.816969@bud.eddelbuettel.com>
 <c0366d8c-8f74-3c55-4894-fce9e1730dc5@gmail.com>
Message-ID: <23060.42193.648732.779557@bud.eddelbuettel.com>


On 21 November 2017 at 16:51, Duncan Murdoch wrote:
| According to section 1.2.1 "Using Makevars" in Writing R Extensions, 
| R_HOME/etcR_ARCH/Makeconf is included after Makevars, so what you're 
| seeing is by design.  I believe this is so that packages are built with 
| tools compatible with those that built R.  (Remember, packages are 
| designed for distribution to diverse systems.)

Yes, now that you read it back to me slowly it makes some sense.  And that
order is also why we cannot, say, get rid of `-g` in there.
 
| If you happen to know how to override some of these settings in a safe 
| way on your own system, then do what you did (as recommended in the R 
| Admin manual, section 6.3.3.)

Yep.  My time-tested local rev.dep system does the same, I just lulled myself
into believing there was another way. But that was a mirage.

So thanks for pointing that out, freeing me to worry about other non-issues. ;-)

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From leegi001 at umn.edu  Wed Nov 22 01:54:16 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Tue, 21 Nov 2017 18:54:16 -0600
Subject: [R-pkg-devel] dependencies
Message-ID: <CAOeg=_9oDFefcqcPS4CJW17Wt=zzef+Ei12JfnD6uHB7txOqrw@mail.gmail.com>

Hi, I'm stuck.  I am using a function called col_concat from the package
{assertr}.  But when I list it as a dependency, either by

import(assertr)

or

importFrom("assertr", "col_concat")

-----------

I get this error message:

* checking package dependencies ... ERROR

Namespace dependency not required: ?assertr?

See section ?The DESCRIPTION file? in the ?Writing R Extensions?

manual.

* DONE

Status: 1 ERROR
?------------
And when I take it out, I get a complaint that col_concat has no global
definition.

What???

Thanks,
?
Cathy Lee Gierke

	[[alternative HTML version deleted]]


From hanson at depauw.edu  Wed Nov 22 02:19:16 2017
From: hanson at depauw.edu (Bryan Hanson)
Date: Tue, 21 Nov 2017 20:19:16 -0500
Subject: [R-pkg-devel] dependencies
In-Reply-To: <CAOeg=_9oDFefcqcPS4CJW17Wt=zzef+Ei12JfnD6uHB7txOqrw@mail.gmail.com>
References: <CAOeg=_9oDFefcqcPS4CJW17Wt=zzef+Ei12JfnD6uHB7txOqrw@mail.gmail.com>
Message-ID: <696D48BA-548F-4135-9F6A-DD64E44E3DE3@depauw.edu>

Edit your DESCRIPTION file to include

imports: assertr

That?s why you get the "not required" message.

Bryan

> On Nov 21, 2017, at 7:54 PM, Cathy Lee Gierke <leegi001 at umn.edu> wrote:
> 
> Hi, I'm stuck.  I am using a function called col_concat from the package
> {assertr}.  But when I list it as a dependency, either by
> 
> import(assertr)
> 
> or
> 
> importFrom("assertr", "col_concat")
> 
> -----------
> 
> I get this error message:
> 
> * checking package dependencies ... ERROR
> 
> Namespace dependency not required: ?assertr?
> 
> See section ?The DESCRIPTION file? in the ?Writing R Extensions?
> 
> manual.
> 
> * DONE
> 
> Status: 1 ERROR
> ?------------
> And when I take it out, I get a complaint that col_concat has no global
> definition.
> 
> What???
> 
> Thanks,
> ?
> Cathy Lee Gierke
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From leegi001 at umn.edu  Wed Nov 22 02:20:56 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Tue, 21 Nov 2017 19:20:56 -0600
Subject: [R-pkg-devel] dependencies
In-Reply-To: <696D48BA-548F-4135-9F6A-DD64E44E3DE3@depauw.edu>
References: <CAOeg=_9oDFefcqcPS4CJW17Wt=zzef+Ei12JfnD6uHB7txOqrw@mail.gmail.com>
 <696D48BA-548F-4135-9F6A-DD64E44E3DE3@depauw.edu>
Message-ID: <CAOeg=_8kqE6Ve_RCE5UQvc+DTarfAOiiR6P6LsbfWcVhXu_1jQ@mail.gmail.com>

Thanks Bryan.  All of my imports are in the namespace.  Can you tell me why
this one should be in the description file?

Cathy Lee Gierke


*?Darkness cannot drive out darkness: only light can do that. Hate cannot
drive out hate: only love can do that.? *
*?The arc of the moral universe is long, but it bends towards justice.?*
*?Nothing in the world is more dangerous than sincere ignorance and
conscientious stupidity.? *
*?Never forget that everything Hitler did in Germany was legal.?   *
*?Forgiveness is not an occasional act, it is a constant attitude.? *
*?Injustice anywhere is a threat to justice everywhere.?  *

? Martin Luther King Jr.

<http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>

On Tue, Nov 21, 2017 at 7:19 PM, Bryan Hanson <hanson at depauw.edu> wrote:

> Edit your DESCRIPTION file to include
>
> imports: assertr
>
> That?s why you get the "not required" message.
>
> Bryan
>
> > On Nov 21, 2017, at 7:54 PM, Cathy Lee Gierke <leegi001 at umn.edu> wrote:
> >
> > Hi, I'm stuck.  I am using a function called col_concat from the package
> > {assertr}.  But when I list it as a dependency, either by
> >
> > import(assertr)
> >
> > or
> >
> > importFrom("assertr", "col_concat")
> >
> > -----------
> >
> > I get this error message:
> >
> > * checking package dependencies ... ERROR
> >
> > Namespace dependency not required: ?assertr?
> >
> > See section ?The DESCRIPTION file? in the ?Writing R Extensions?
> >
> > manual.
> >
> > * DONE
> >
> > Status: 1 ERROR
> > ?------------
> > And when I take it out, I get a complaint that col_concat has no global
> > definition.
> >
> > What???
> >
> > Thanks,
> > ?
> > Cathy Lee Gierke
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>

	[[alternative HTML version deleted]]


From edd at debian.org  Wed Nov 22 02:51:31 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 21 Nov 2017 19:51:31 -0600
Subject: [R-pkg-devel] dependencies
In-Reply-To: <CAOeg=_8kqE6Ve_RCE5UQvc+DTarfAOiiR6P6LsbfWcVhXu_1jQ@mail.gmail.com>
References: <CAOeg=_9oDFefcqcPS4CJW17Wt=zzef+Ei12JfnD6uHB7txOqrw@mail.gmail.com>
 <696D48BA-548F-4135-9F6A-DD64E44E3DE3@depauw.edu>
 <CAOeg=_8kqE6Ve_RCE5UQvc+DTarfAOiiR6P6LsbfWcVhXu_1jQ@mail.gmail.com>
Message-ID: <23060.55331.415879.589038@bud.eddelbuettel.com>


On 21 November 2017 at 19:20, Cathy Lee Gierke wrote:
| Thanks Bryan.  All of my imports are in the namespace.  Can you tell me why
| this one should be in the description file?

Because you need an entry in the DESCRIPTION file _and_ an entry in NAMESPACE.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From hanson at depauw.edu  Wed Nov 22 02:57:13 2017
From: hanson at depauw.edu (Bryan Hanson)
Date: Tue, 21 Nov 2017 20:57:13 -0500
Subject: [R-pkg-devel] dependencies
In-Reply-To: <CAOeg=_-Tr-aPmP849HkAZfEM4rB7dm3a2W3Ne4Dsy0XChjaQ2w@mail.gmail.com>
References: <CAOeg=_9oDFefcqcPS4CJW17Wt=zzef+Ei12JfnD6uHB7txOqrw@mail.gmail.com>
 <696D48BA-548F-4135-9F6A-DD64E44E3DE3@depauw.edu>
 <CAOeg=_8kqE6Ve_RCE5UQvc+DTarfAOiiR6P6LsbfWcVhXu_1jQ@mail.gmail.com>
 <07B6C328-5710-4C5B-84FE-08C6336D8E4E@depauw.edu>
 <CAOeg=_-Tr-aPmP849HkAZfEM4rB7dm3a2W3Ne4Dsy0XChjaQ2w@mail.gmail.com>
Message-ID: <64EE81CA-1708-468B-9087-7003F57D6BE1@depauw.edu>

Cathy?

Regarding changes from last year, I wouldn?t worry too much about that.  The CRAN checking system is always moving toward greater stringency as the ecosystem evolves.  Requirements and messages change steadily.

I have ?chased my tail? along the lines of your original description before as well.  There are ways to import the entire namespace of a package which allows one to get a working package but there the current standard is to import only the particular functions you need, not the entire namespace.  And there are differences between writing

assertr::col_concat()

and 

col_concat()

in your functions too, depending upon what you import (I may be remembering a detail incorrectly here).

Bryan

> On Nov 21, 2017, at 8:42 PM, Cathy Lee Gierke <leegi001 at umn.edu> wrote:
> 
> I have read that over and over......it doesn't seem to say when a package or function, that is already in the Namespace file will also need to be in the Description file.  It says usually if an import is in Description it also needs to be in Namespace.....but the reverse is never mentioned....
> 
> A bit more info:  A year or more ago I had all of my imports in Description.  But then it started complaining and told me to move them all t Namespace.  So there are now no imports in Description.  They are all in Namespace.  But col_concat from the package {assertr} seems to be an exception?
> 
> Cathy Lee Gierke
>       
> ?Darkness cannot drive out darkness: only light can do that. Hate cannot drive out hate: only love can do that.? 
> ?The arc of the moral universe is long, but it bends towards justice.?
> ?Nothing in the world is more dangerous than sincere ignorance and conscientious stupidity.? 
> ?Never forget that everything Hitler did in Germany was legal.?   
> ?Forgiveness is not an occasional act, it is a constant attitude.? 
> ?Injustice anywhere is a threat to justice everywhere.?  
> 
> ? Martin Luther King Jr.
> 
>  <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
> On Tue, Nov 21, 2017 at 7:25 PM, Bryan Hanson <hanson at depauw.edu <mailto:hanson at depauw.edu>> wrote:
> Check out 
> 
> https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Package-Dependencies <https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Package-Dependencies> 
> 
> and see about the nuances of  Depends, Suggests and Imports
> 
> It is not sufficient for them to be listed in the NAMESPACE file only
> 
> Bryan
> 
> 
> 
>> On Nov 21, 2017, at 8:20 PM, Cathy Lee Gierke <leegi001 at umn.edu <mailto:leegi001 at umn.edu>> wrote:
>> 
>> Thanks Bryan.  All of my imports are in the namespace.  Can you tell me why this one should be in the description file?
>> 
>> Cathy Lee Gierke
>>       
>> ?Darkness cannot drive out darkness: only light can do that. Hate cannot drive out hate: only love can do that.? 
>> ?The arc of the moral universe is long, but it bends towards justice.?
>> ?Nothing in the world is more dangerous than sincere ignorance and conscientious stupidity.? 
>> ?Never forget that everything Hitler did in Germany was legal.?   
>> ?Forgiveness is not an occasional act, it is a constant attitude.? 
>> ?Injustice anywhere is a threat to justice everywhere.?  
>> 
>> ? Martin Luther King Jr.
>> 
>>  <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
>> On Tue, Nov 21, 2017 at 7:19 PM, Bryan Hanson <hanson at depauw.edu <mailto:hanson at depauw.edu>> wrote:
>> Edit your DESCRIPTION file to include
>> 
>> imports: assertr
>> 
>> That?s why you get the "not required" message.
>> 
>> Bryan
>> 
>> > On Nov 21, 2017, at 7:54 PM, Cathy Lee Gierke <leegi001 at umn.edu <mailto:leegi001 at umn.edu>> wrote:
>> >
>> > Hi, I'm stuck.  I am using a function called col_concat from the package
>> > {assertr}.  But when I list it as a dependency, either by
>> >
>> > import(assertr)
>> >
>> > or
>> >
>> > importFrom("assertr", "col_concat")
>> >
>> > -----------
>> >
>> > I get this error message:
>> >
>> > * checking package dependencies ... ERROR
>> >
>> > Namespace dependency not required: ?assertr?
>> >
>> > See section ?The DESCRIPTION file? in the ?Writing R Extensions?
>> >
>> > manual.
>> >
>> > * DONE
>> >
>> > Status: 1 ERROR
>> > ?------------
>> > And when I take it out, I get a complaint that col_concat has no global
>> > definition.
>> >
>> > What???
>> >
>> > Thanks,
>> > ?
>> > Cathy Lee Gierke
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-package-devel at r-project.org <mailto:R-package-devel at r-project.org> mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-package-devel <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>> 
>> 
> 
> 


	[[alternative HTML version deleted]]


From dstr7320 at uni.sydney.edu.au  Wed Nov 22 07:00:03 2017
From: dstr7320 at uni.sydney.edu.au (Dario Strbenac)
Date: Wed, 22 Nov 2017 06:00:03 +0000
Subject: [R-pkg-devel] Rd File Line Widths Not Suggested in Manual
Message-ID: <SY3PR01MB0747513B13EC21C6156F3277CD200@SY3PR01MB0747.ausprd01.prod.outlook.com>

Good day,

I often notice that some lines of code in many PDF manuals generated for CRAN packages run off the page. Perhaps the maximum number of characters per line should be stated in section 2.16 of Writing R Extensions. It would help package authors like me write better Rd files.

--------------------------------------
Dario Strbenac
University of Sydney
Camperdown NSW 2050
Australia


From ht at heatherturner.net  Wed Nov 22 11:21:52 2017
From: ht at heatherturner.net (Heather Turner)
Date: Wed, 22 Nov 2017 10:21:52 +0000
Subject: [R-pkg-devel] Rd File Line Widths Not Suggested in Manual
In-Reply-To: <SY3PR01MB0747513B13EC21C6156F3277CD200@SY3PR01MB0747.ausprd01.prod.outlook.com>
References: <SY3PR01MB0747513B13EC21C6156F3277CD200@SY3PR01MB0747.ausprd01.prod.outlook.com>
Message-ID: <1511346112.718073.1180846816.36FBB30A@webmail.messagingengine.com>

Dear Dario,

There is a note in the Guidelines for Rd files
(https://developer.r-project.org/Rds.html) which is linked to in Sec 2.1
of R-ext.

It could be useful for these guidelines could be incorporated in R-ext
itself so people don't have to look in two different places, but I think
some of the guidelines are more critical than others.  (Who puts two
spaces after a period these days??)

Best wishes,

Heather

On Wed, Nov 22, 2017, at 06:00 AM, Dario Strbenac wrote:
> Good day,
> 
> I often notice that some lines of code in many PDF manuals generated for
> CRAN packages run off the page. Perhaps the maximum number of characters
> per line should be stated in section 2.16 of Writing R Extensions. It
> would help package authors like me write better Rd files.
> 
> --------------------------------------
> Dario Strbenac
> University of Sydney
> Camperdown NSW 2050
> Australia
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch.duncan at gmail.com  Wed Nov 22 11:45:59 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 22 Nov 2017 05:45:59 -0500
Subject: [R-pkg-devel] Rd File Line Widths Not Suggested in Manual
In-Reply-To: <SY3PR01MB0747513B13EC21C6156F3277CD200@SY3PR01MB0747.ausprd01.prod.outlook.com>
References: <SY3PR01MB0747513B13EC21C6156F3277CD200@SY3PR01MB0747.ausprd01.prod.outlook.com>
Message-ID: <d772e114-63bb-8480-9dee-0cd91a8d00f8@gmail.com>

On 22/11/2017 1:00 AM, Dario Strbenac wrote:
> Good day,
> 
> I often notice that some lines of code in many PDF manuals generated for CRAN packages run off the page. Perhaps the maximum number of characters per line should be stated in section 2.16 of Writing R Extensions. It would help package authors like me write better Rd files.

If you run R CMD check on your package, you'll get warnings about lines 
being too long.  New submissions to CRAN will have to follow these 
limits, but CRAN doesn't force package authors to update to meet them.

Duncan Murdoch


From devin.incerti at gmail.com  Wed Nov 22 16:49:04 2017
From: devin.incerti at gmail.com (Devin Incerti)
Date: Wed, 22 Nov 2017 15:49:04 +0000
Subject: [R-pkg-devel] Can't reproduce re-building vignettes error in CRAN R
	CMD check
Message-ID: <CADzXBeiG_MqiW1362mD6MqpD8wj=x9FUTV7y7DpJ2iEOba34WQ@mail.gmail.com>

Hi,

I have successfully run R CMD check for my package hesim (source
<https://github.com/InnovationValueInitiative/hesim>) on OSX sierra,
CentOS, Ubuntu 14.04 (on travis-ci), and win-builder (devel and
release). However, when I submitted to CRAN I received the warning:

* checking re-building of vignette outputs ... [3s] WARNING
Error in re-building vignettes:
  ...
Error: processing vignette 'cea-vignette.Rmd' failed with diagnostics:
DLL 'stringi' not found: maybe not installed for this architecture?
Execution halted

I'm stumped by this and can't recreate it. Any ideas on how to
eliminate this warning?

Thanks

	[[alternative HTML version deleted]]


From bill at denney.ws  Wed Nov 22 23:21:15 2017
From: bill at denney.ws (Bill Denney)
Date: Wed, 22 Nov 2017 17:21:15 -0500
Subject: [R-pkg-devel] Installing Tests with R Build
Message-ID: <B8547215-E196-440C-8D28-E645C3741B39@denney.ws>

Hi,

I have a package that I'm trying to make a validation vignette for.  The validation vignette is intended to assist users with documentation that the tests work.

When running R BUILD now (via Travis CI), I get an error that the build failed trying to build the vignettes.  For R CMD install, I can add --install-tests.  Is there a way to control R BUILD so that the installation includes test installation?

Thanks,

Bill

From josh.m.ulrich at gmail.com  Thu Nov 23 15:07:55 2017
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 23 Nov 2017 08:07:55 -0600
Subject: [R-pkg-devel] Installing Tests with R Build
In-Reply-To: <B8547215-E196-440C-8D28-E645C3741B39@denney.ws>
References: <B8547215-E196-440C-8D28-E645C3741B39@denney.ws>
Message-ID: <CAPPM_gT+A-mw90kJf96pCrQE97pK-wn-Gb=gkL_LzSCk4VrLgQ@mail.gmail.com>

On Wed, Nov 22, 2017 at 4:21 PM, Bill Denney <bill at denney.ws> wrote:
> Hi,
>
> I have a package that I'm trying to make a validation vignette for.  The validation vignette is intended to assist users with documentation that the tests work.
>
> When running R BUILD now (via Travis CI), I get an error that the build failed trying to build the vignettes.  For R CMD install, I can add --install-tests.  Is there a way to control R BUILD so that the installation includes test installation?
>
Put the tests you want to install into a directory inside the inst/
directory (e.g. inst/tests/).  That directory will be copied to the
top-level of the installed package directory.

> Thanks,
>
> Bill
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2017 | www.rinfinance.com


From edd at debian.org  Thu Nov 23 16:17:25 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 23 Nov 2017 09:17:25 -0600
Subject: [R-pkg-devel] Installing Tests with R Build
In-Reply-To: <CAPPM_gT+A-mw90kJf96pCrQE97pK-wn-Gb=gkL_LzSCk4VrLgQ@mail.gmail.com>
References: <B8547215-E196-440C-8D28-E645C3741B39@denney.ws>
 <CAPPM_gT+A-mw90kJf96pCrQE97pK-wn-Gb=gkL_LzSCk4VrLgQ@mail.gmail.com>
Message-ID: <23062.59013.585871.667215@bud.eddelbuettel.com>


On 23 November 2017 at 08:07, Joshua Ulrich wrote:
| On Wed, Nov 22, 2017 at 4:21 PM, Bill Denney <bill at denney.ws> wrote:
| > I have a package that I'm trying to make a validation vignette for.  The validation vignette is intended to assist users with documentation that the tests work.
| >
| > When running R BUILD now (via Travis CI), I get an error that the build failed trying to build the vignettes.  For R CMD install, I can add --install-tests.  Is there a way to control R BUILD so that the installation includes test installation?
| >
| Put the tests you want to install into a directory inside the inst/
| directory (e.g. inst/tests/).  That directory will be copied to the
| top-level of the installed package directory.

Which happens to be the default mode of operations with RUnit.

And it is a feature that I happen to _like_ a great deal because it permits
testing of the _installed_ package which is something you need in real life
when eg some of you system libraries may have change.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From bill at denney.ws  Thu Nov 23 17:05:14 2017
From: bill at denney.ws (Bill Denney)
Date: Thu, 23 Nov 2017 11:05:14 -0500
Subject: [R-pkg-devel] Installing Tests with R Build
In-Reply-To: <23062.59013.585871.667215@bud.eddelbuettel.com>
References: <B8547215-E196-440C-8D28-E645C3741B39@denney.ws>
 <CAPPM_gT+A-mw90kJf96pCrQE97pK-wn-Gb=gkL_LzSCk4VrLgQ@mail.gmail.com>
 <23062.59013.585871.667215@bud.eddelbuettel.com>
Message-ID: <9F4F149B-B65E-4CD5-B1F2-625DFABD3815@denney.ws>

Hi Joshua and Dirk,

> On Nov 23, 2017, at 10:17, Dirk Eddelbuettel <edd at debian.org> wrote:
> 
> 
> On 23 November 2017 at 08:07, Joshua Ulrich wrote:
> | On Wed, Nov 22, 2017 at 4:21 PM, Bill Denney <bill at denney.ws> wrote:
> | > When running R BUILD now (via Travis CI), I get an error that the build failed trying to build the vignettes.  For R CMD install, I can add --install-tests.  Is there a way to control R BUILD so that the installation includes test installation?
> | >
> | Put the tests you want to install into a directory inside the inst/
> | directory (e.g. inst/tests/).
> 
> Which happens to be the default mode of operations with RUnit.
> 
> And it is a feature that I happen to _like_ a great deal because it permits
> testing of the _installed_ package which is something you need in real life
> when eg some of you system libraries may have change.

Putting the tests there seems like a very reasonable solution to the immediate issue.  It contravenes the options to install (or not install) tests ("R CMD INSTALL --install-tests" loses meaning).  I'm going to update the structure of my vignette so that it detects if the tests are there and builds the vignette based on the existence of the tests (making it say "Please install the tests following these instructions...").

I'm immediately ok with reworking the directory structure and tests, but I think it would be preferable long run to:
Have R CMD BUILD gain an --install-args option so that installation arguments can be controlled (for situations like this and I'm sure others).

Thank you (and Happy Thanksgiving to those celebrating it),

Bill

From zen90218 at zen.co.uk  Fri Nov 24 18:34:14 2017
From: zen90218 at zen.co.uk (Magnus Peterson)
Date: Fri, 24 Nov 2017 17:34:14 +0000
Subject: [R-pkg-devel] A problem with Sweave in developing a package vignette
Message-ID: <42dc4ce9-824e-a8c1-8270-26e95024ec75@zen.co.uk>

I am using Sweave to create a vignette for a package,
but when it appears in a code chunk of the .Rnw file
the following line causes an execution halt of Sweave:-

data("WingPoints",envir = environment(()))

This is surprising since this data call as a line
of a function within the package is accepted? by R
and is indeed part of the "Best practice" recommendations
in ?data called from R.

What Sweave apparently objects to is the first closing
inner bracket, indicating an empty inner argument for
the variable environment.

Is this a bug or what should I do?? The function runs perfectly
in R in its usual context, and in the .Rnw file it is in a? chunk
headed
<<eval=FALSE>=

Magnus Peterson


From murdoch.duncan at gmail.com  Sat Nov 25 02:29:38 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 24 Nov 2017 20:29:38 -0500
Subject: [R-pkg-devel] A problem with Sweave in developing a package
 vignette
In-Reply-To: <42dc4ce9-824e-a8c1-8270-26e95024ec75@zen.co.uk>
References: <42dc4ce9-824e-a8c1-8270-26e95024ec75@zen.co.uk>
Message-ID: <9e2ba2ed-cdf5-3a59-4e7a-13fb08ad4d4e@gmail.com>

On 24/11/2017 12:34 PM, Magnus Peterson wrote:
> I am using Sweave to create a vignette for a package,
> but when it appears in a code chunk of the .Rnw file
> the following line causes an execution halt of Sweave:-
> 
> data("WingPoints",envir = environment(()))
> 
> This is surprising since this data call as a line
> of a function within the package is accepted? by R
> and is indeed part of the "Best practice" recommendations
> in ?data called from R.

That's not legal syntax, so I'm not sure why you think it is accepted by 
R.  I see this when I try to run that:

 > data("WingPoints",envir = environment(()))
Error: unexpected ')' in "data("WingPoints",envir = environment(()"

> 
> What Sweave apparently objects to is the first closing
> inner bracket, indicating an empty inner argument for
> the variable environment.

No, since it is not legal syntax, it doesn't indicate anything at all.


> 
> Is this a bug or what should I do?? The function runs perfectly
> in R in its usual context, and in the .Rnw file it is in a? chunk
> headed

It's a bug in your code.  I don't know if this is what you are trying to 
do, but this would be legal syntax:

   data("WingPoints",envir = environment())

Duncan Murdoch


From josh.m.ulrich at gmail.com  Sat Nov 25 15:20:23 2017
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sat, 25 Nov 2017 08:20:23 -0600
Subject: [R-pkg-devel] Installing Tests with R Build
In-Reply-To: <9F4F149B-B65E-4CD5-B1F2-625DFABD3815@denney.ws>
References: <B8547215-E196-440C-8D28-E645C3741B39@denney.ws>
 <CAPPM_gT+A-mw90kJf96pCrQE97pK-wn-Gb=gkL_LzSCk4VrLgQ@mail.gmail.com>
 <23062.59013.585871.667215@bud.eddelbuettel.com>
 <9F4F149B-B65E-4CD5-B1F2-625DFABD3815@denney.ws>
Message-ID: <CAPPM_gQonAmxgqO7zSnnOhEaCgRFn8bMEQyWRg6ot567jzdf0w@mail.gmail.com>

On Thu, Nov 23, 2017 at 10:05 AM, Bill Denney <bill at denney.ws> wrote:
> Hi Joshua and Dirk,
>
>> On Nov 23, 2017, at 10:17, Dirk Eddelbuettel <edd at debian.org> wrote:
>>
>>
>> On 23 November 2017 at 08:07, Joshua Ulrich wrote:
>> | On Wed, Nov 22, 2017 at 4:21 PM, Bill Denney <bill at denney.ws> wrote:
>> | > When running R BUILD now (via Travis CI), I get an error that the build failed trying to build the vignettes.  For R CMD install, I can add --install-tests.  Is there a way to control R BUILD so that the installation includes test installation?
>> | >
>> | Put the tests you want to install into a directory inside the inst/
>> | directory (e.g. inst/tests/).
>>
>> Which happens to be the default mode of operations with RUnit.
>>
>> And it is a feature that I happen to _like_ a great deal because it permits
>> testing of the _installed_ package which is something you need in real life
>> when eg some of you system libraries may have change.
>
> Putting the tests there seems like a very reasonable solution to the immediate issue.  It contravenes the options to install (or not install) tests ("R CMD INSTALL --install-tests" loses meaning).  I'm going to update the structure of my vignette so that it detects if the tests are there and builds the vignette based on the existence of the tests (making it say "Please install the tests following these instructions...").
>
> I'm immediately ok with reworking the directory structure and tests, but I think it would be preferable long run to:
> Have R CMD BUILD gain an --install-args option so that installation arguments can be controlled (for situations like this and I'm sure others).
>
I just took a closer look at this, and I don't understand why any
change is necessary.  With a package created by package.skeleton():

josh at thinkpad: ~/git
> R CMD build anRpackage
* checking for file 'anRpackage/DESCRIPTION' ... OK
* preparing 'anRpackage':
* checking DESCRIPTION meta-information ... OK
* installing the package to process help pages
* saving partial Rd database
* creating vignettes ... OK
* checking for LF line-endings in source and make files and shell scripts
* checking for empty or unneeded directories
* building 'anRpackage_1.0.tar.gz'


josh at thinkpad: ~/git
> tar -ztf anRpackage_1.0.tar.gz
anRpackage/DESCRIPTION
anRpackage/NAMESPACE
anRpackage/R/
anRpackage/R/file.R
anRpackage/build/
anRpackage/build/partial.rdb
anRpackage/build/vignette.rds
anRpackage/inst/
anRpackage/inst/doc/
anRpackage/inst/doc/file.Rnw
anRpackage/inst/doc/file.pdf
anRpackage/man/
anRpackage/man/anRpackage-package.Rd
anRpackage/tests/
anRpackage/tests/unittests.R
anRpackage/vignettes/
anRpackage/vignettes/file.Rnw

The package builds successfully, and the tests are still in their
tests/ directory.  Now if I install without the --install-tests flag:

josh at thinkpad: ~/git
> R CMD INSTALL anRpackage_1.0.tar.gz 2>/dev/null

josh at thinkpad: ~/git
> ls -l ~/R/library/anRpackage/
total 32
-rw-r--r-- 1 josh josh  420 Nov 25 08:16 DESCRIPTION
drwxr-xr-x 2 josh josh 4096 Nov 25 08:16 doc
drwxr-xr-x 2 josh josh 4096 Nov 25 08:16 help
drwxr-xr-x 2 josh josh 4096 Nov 25 08:16 html
-rw-r--r-- 1 josh josh   59 Nov 25 08:16 INDEX
drwxr-xr-x 2 josh josh 4096 Nov 25 08:16 Meta
-rw-r--r-- 1 josh josh   72 Nov 25 08:16 NAMESPACE
drwxr-xr-x 2 josh josh 4096 Nov 25 08:16 R

You can see there's no tests/ directory.  Now with the --install-tests flag:

josh at thinkpad: ~/git
> R CMD INSTALL anRpackage_1.0.tar.gz --install-tests 2>/dev/null

josh at thinkpad: ~/git
> ls -l ~/R/library/anRpackage/
total 36
-rw-r--r-- 1 josh josh  420 Nov 25 08:17 DESCRIPTION
drwxr-xr-x 2 josh josh 4096 Nov 25 08:17 doc
drwxr-xr-x 2 josh josh 4096 Nov 25 08:17 help
drwxr-xr-x 2 josh josh 4096 Nov 25 08:17 html
-rw-r--r-- 1 josh josh   59 Nov 25 08:17 INDEX
drwxr-xr-x 2 josh josh 4096 Nov 25 08:17 Meta
-rw-r--r-- 1 josh josh   72 Nov 25 08:17 NAMESPACE
drwxr-xr-x 2 josh josh 4096 Nov 25 08:17 R
drwxr-xr-x 2 josh josh 4096 Nov 25 08:17 tests

The tests/ directory is present, and I can run the tests:

josh at thinkpad: ~/git
> Rscript -e 'tools::testInstalledPackage("anRpackage")'
Testing examples for package 'anRpackage'
Running specific tests for package 'anRpackage'
  Running 'unittests.R'
Running vignettes for package 'anRpackage'
  Running 'file.Rnw'

Someone could probably give you specific advice if you share a link to
the code and/or TravisCI log(s).

> Thank you (and Happy Thanksgiving to those celebrating it),
>
> Bill



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2017 | www.rinfinance.com


From bill at denney.ws  Sun Nov 26 01:20:34 2017
From: bill at denney.ws (Bill Denney)
Date: Sat, 25 Nov 2017 19:20:34 -0500
Subject: [R-pkg-devel] Installing Tests with R Build
In-Reply-To: <CAPPM_gQonAmxgqO7zSnnOhEaCgRFn8bMEQyWRg6ot567jzdf0w@mail.gmail.com>
References: <B8547215-E196-440C-8D28-E645C3741B39@denney.ws>
 <CAPPM_gT+A-mw90kJf96pCrQE97pK-wn-Gb=gkL_LzSCk4VrLgQ@mail.gmail.com>
 <23062.59013.585871.667215@bud.eddelbuettel.com>
 <9F4F149B-B65E-4CD5-B1F2-625DFABD3815@denney.ws>
 <CAPPM_gQonAmxgqO7zSnnOhEaCgRFn8bMEQyWRg6ot567jzdf0w@mail.gmail.com>
Message-ID: <032201d3664c$6550ad10$2ff20730$@denney.ws>

Hi Joshua,

The TravisCI link to the first failed build is: https://travis-ci.org/billdenney/pknca/builds/305997673
Along with the GitHub commit: https://github.com/billdenney/pknca/commit/97495044cb90076ba817e1c8b140c50d35b5a654

My eventual solution was to check for the existence of the tests directory and run the vignette if the tests were installed.

Thanks,

Bill

-----Original Message-----
From: Joshua Ulrich [mailto:josh.m.ulrich at gmail.com] 
Sent: Saturday, November 25, 2017 9:20 AM
To: Bill Denney <bill at denney.ws>
Cc: Dirk Eddelbuettel <edd at debian.org>; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Installing Tests with R Build

On Thu, Nov 23, 2017 at 10:05 AM, Bill Denney <bill at denney.ws> wrote:
> Hi Joshua and Dirk,
>
>> On Nov 23, 2017, at 10:17, Dirk Eddelbuettel <edd at debian.org> wrote:
>>
>>
>> On 23 November 2017 at 08:07, Joshua Ulrich wrote:
>> | On Wed, Nov 22, 2017 at 4:21 PM, Bill Denney <bill at denney.ws> wrote:
>> | > When running R BUILD now (via Travis CI), I get an error that the build failed trying to build the vignettes.  For R CMD install, I can add --install-tests.  Is there a way to control R BUILD so that the installation includes test installation?
>> | >
>> | Put the tests you want to install into a directory inside the inst/ 
>> | directory (e.g. inst/tests/).
>>
>> Which happens to be the default mode of operations with RUnit.
>>
>> And it is a feature that I happen to _like_ a great deal because it 
>> permits testing of the _installed_ package which is something you 
>> need in real life when eg some of you system libraries may have change.
>
> Putting the tests there seems like a very reasonable solution to the immediate issue.  It contravenes the options to install (or not install) tests ("R CMD INSTALL --install-tests" loses meaning).  I'm going to update the structure of my vignette so that it detects if the tests are there and builds the vignette based on the existence of the tests (making it say "Please install the tests following these instructions...").
>
> I'm immediately ok with reworking the directory structure and tests, but I think it would be preferable long run to:
> Have R CMD BUILD gain an --install-args option so that installation arguments can be controlled (for situations like this and I'm sure others).
>
I just took a closer look at this, and I don't understand why any change is necessary.  With a package created by package.skeleton():

josh at thinkpad: ~/git
> R CMD build anRpackage
* checking for file 'anRpackage/DESCRIPTION' ... OK
* preparing 'anRpackage':
* checking DESCRIPTION meta-information ... OK
* installing the package to process help pages
* saving partial Rd database
* creating vignettes ... OK
* checking for LF line-endings in source and make files and shell scripts
* checking for empty or unneeded directories
* building 'anRpackage_1.0.tar.gz'


josh at thinkpad: ~/git
> tar -ztf anRpackage_1.0.tar.gz
anRpackage/DESCRIPTION
anRpackage/NAMESPACE
anRpackage/R/
anRpackage/R/file.R
anRpackage/build/
anRpackage/build/partial.rdb
anRpackage/build/vignette.rds
anRpackage/inst/
anRpackage/inst/doc/
anRpackage/inst/doc/file.Rnw
anRpackage/inst/doc/file.pdf
anRpackage/man/
anRpackage/man/anRpackage-package.Rd
anRpackage/tests/
anRpackage/tests/unittests.R
anRpackage/vignettes/
anRpackage/vignettes/file.Rnw

The package builds successfully, and the tests are still in their tests/ directory.  Now if I install without the --install-tests flag:

josh at thinkpad: ~/git
> R CMD INSTALL anRpackage_1.0.tar.gz 2>/dev/null

josh at thinkpad: ~/git
> ls -l ~/R/library/anRpackage/
total 32
-rw-r--r-- 1 josh josh  420 Nov 25 08:16 DESCRIPTION drwxr-xr-x 2 josh josh 4096 Nov 25 08:16 doc drwxr-xr-x 2 josh josh 4096 Nov 25 08:16 help drwxr-xr-x 2 josh josh 4096 Nov 25 08:16 html
-rw-r--r-- 1 josh josh   59 Nov 25 08:16 INDEX
drwxr-xr-x 2 josh josh 4096 Nov 25 08:16 Meta
-rw-r--r-- 1 josh josh   72 Nov 25 08:16 NAMESPACE
drwxr-xr-x 2 josh josh 4096 Nov 25 08:16 R

You can see there's no tests/ directory.  Now with the --install-tests flag:

josh at thinkpad: ~/git
> R CMD INSTALL anRpackage_1.0.tar.gz --install-tests 2>/dev/null

josh at thinkpad: ~/git
> ls -l ~/R/library/anRpackage/
total 36
-rw-r--r-- 1 josh josh  420 Nov 25 08:17 DESCRIPTION drwxr-xr-x 2 josh josh 4096 Nov 25 08:17 doc drwxr-xr-x 2 josh josh 4096 Nov 25 08:17 help drwxr-xr-x 2 josh josh 4096 Nov 25 08:17 html
-rw-r--r-- 1 josh josh   59 Nov 25 08:17 INDEX
drwxr-xr-x 2 josh josh 4096 Nov 25 08:17 Meta
-rw-r--r-- 1 josh josh   72 Nov 25 08:17 NAMESPACE
drwxr-xr-x 2 josh josh 4096 Nov 25 08:17 R drwxr-xr-x 2 josh josh 4096 Nov 25 08:17 tests

The tests/ directory is present, and I can run the tests:

josh at thinkpad: ~/git
> Rscript -e 'tools::testInstalledPackage("anRpackage")'
Testing examples for package 'anRpackage'
Running specific tests for package 'anRpackage'
  Running 'unittests.R'
Running vignettes for package 'anRpackage'
  Running 'file.Rnw'

Someone could probably give you specific advice if you share a link to the code and/or TravisCI log(s).

> Thank you (and Happy Thanksgiving to those celebrating it),
>
> Bill



--
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2017 | www.rinfinance.com


From ligges at statistik.tu-dortmund.de  Mon Nov 27 14:21:58 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 27 Nov 2017 14:21:58 +0100
Subject: [R-pkg-devel] Can't reproduce re-building vignettes error in
 CRAN R CMD check
In-Reply-To: <CADzXBeiG_MqiW1362mD6MqpD8wj=x9FUTV7y7DpJ2iEOba34WQ@mail.gmail.com>
References: <CADzXBeiG_MqiW1362mD6MqpD8wj=x9FUTV7y7DpJ2iEOba34WQ@mail.gmail.com>
Message-ID: <c45072d3-7dfa-d682-3b9e-43cd42a0faf7@statistik.tu-dortmund.de>

This is probbaly a race condition, please resubmit.

Best,
Uwe Ligges

On 22.11.2017 16:49, Devin Incerti wrote:
> Hi,
> 
> I have successfully run R CMD check for my package hesim (source
> <https://github.com/InnovationValueInitiative/hesim>) on OSX sierra,
> CentOS, Ubuntu 14.04 (on travis-ci), and win-builder (devel and
> release). However, when I submitted to CRAN I received the warning:
> 
> * checking re-building of vignette outputs ... [3s] WARNING
> Error in re-building vignettes:
>    ...
> Error: processing vignette 'cea-vignette.Rmd' failed with diagnostics:
> DLL 'stringi' not found: maybe not installed for this architecture?
> Execution halted
> 
> I'm stumped by this and can't recreate it. Any ideas on how to
> eliminate this warning?
> 
> Thanks
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From Senren.Tan at cass.city.ac.uk  Mon Nov 27 22:24:39 2017
From: Senren.Tan at cass.city.ac.uk (Tan, Senren)
Date: Mon, 27 Nov 2017 21:24:39 +0000
Subject: [R-pkg-devel] Errors in the pre-test after submitting the R package
Message-ID: <AM4PR0301MB2193373F50EC52488C4CBA4699250@AM4PR0301MB2193.eurprd03.prod.outlook.com>

Dear all,



I have been developing an R package using Rcpp to call C++ functions that use the C subroutine library 'fftw3' that implements fast Fourier transform algorithm. Since I have the C library 'fftw3' installed on my laptop (running MacOS), when I checked my developed package using R CMD CHECK --as-cran, I could pass all the checks with no errors or warnings.



However, when I submitted the package to CRAN, during the pre-test, I encountered an error. I was wondering whether this error came from the absence of the 'fftw3' C library on the checking machine? Or maybe I have made some mistakes in the Makevars.win file?



I have done some search on how to use the external C library in R packages with Rcpp.

Here is what I have provided in the Makevars.win file:



PKG_CPPFLAGS = -I$(LIB_FFTW)/include

CXX = g++

PKG_CXXFLAGS = -std=c++11

PKG_LIBS = -L$(LIB_FFTW)/lib -lfftw3





Could you please advise me on what to do?



Here is the error message:



* installing *source* package 'KSgeneral' ...

** libs



*** arch - i386

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -pedantic -O2 -Wall  -mtune=core2 -c RcppExports.cpp -o RcppExports.o

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -pedantic -O2 -Wall  -mtune=core2 -c cont_ks_dist.cpp -o cont_ks_dist.o

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -pedantic -O2 -Wall  -mtune=core2 -c crossprob_new.cc -o crossprob_new.o

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -pedantic -O2 -Wall  -mtune=core2 -c fftw_wrappers.cc -o fftw_wrappers.o

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -pedantic -O2 -Wall  -mtune=core2 -c fftwconvolver.cc -o fftwconvolver.o

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -pedantic -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability.cc -o one_sided_noncrossing_probability.o

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -pedantic -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability_n2.cc -o one_sided_noncrossing_probability_n2.o

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -pedantic -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability_n2logn.cc -o one_sided_noncrossing_probability_n2logn.o

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -pedantic -O2 -Wall  -mtune=core2 -c poisson_pmf.cc -o poisson_pmf.o

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -pedantic -O2 -Wall  -mtune=core2 -c read_boundaries_file.cc -o read_boundaries_file.o

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -pedantic -O2 -Wall  -mtune=core2 -c string_utils.cc -o string_utils.o

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -pedantic -O2 -Wall  -mtune=core2 -c two_sided_noncrossing_probability.cc -o two_sided_noncrossing_probability.o

d:/Compiler/gcc-4.9.3/mingw_32/bin/g++ -shared -s -static-libgcc -o KSgeneral.dll tmp.def RcppExports.o cont_ks_dist.o crossprob_new.o fftw_wrappers.o fftwconvolver.o one_sided_noncrossing_probability.o one_sided_noncrossing_probability_n2.o one_sided_noncrossing_probability_n2logn.o poisson_pmf.o read_boundaries_file.o string_utils.o two_sided_noncrossing_probability.o -Ld:/Rcompile/CRANpkg/extralibs215/local215/lib -lfftw3 -Ld:/Compiler/gcc-4.9.3/local330/lib/i386 -Ld:/Compiler/gcc-4.9.3/local330/lib -LD:/RCompile/recent/R/bin/i386 -lR

fftw_wrappers.o:fftw_wrappers.cc:(.text+0x125): undefined reference to `_imp__fftw_plan_dft_r2c_1d'

fftw_wrappers.o:fftw_wrappers.cc:(.text+0x14f): undefined reference to `_imp__fftw_destroy_plan'

fftw_wrappers.o:fftw_wrappers.cc:(.text+0x29b): undefined reference to `_imp__fftw_execute'

fftw_wrappers.o:fftw_wrappers.cc:(.text+0x315): undefined reference to `_imp__fftw_plan_dft_c2r_1d'

fftw_wrappers.o:fftw_wrappers.cc:(.text+0x33f): undefined reference to `_imp__fftw_destroy_plan'

fftw_wrappers.o:fftw_wrappers.cc:(.text+0x3bb): undefined reference to `_imp__fftw_execute'

collect2.exe: error: ld returned 1 exit status

no DLL was created

ERROR: compilation failed for package 'KSgeneral'

* removing 'd:/RCompile/CRANincoming/R-devel/lib/KSgeneral'





Thank you very much.



Best regards,

Senren Tan







	[[alternative HTML version deleted]]


From edd at debian.org  Tue Nov 28 02:47:20 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 27 Nov 2017 19:47:20 -0600
Subject: [R-pkg-devel] Errors in the pre-test after submitting the R
	package
In-Reply-To: <AM4PR0301MB2193373F50EC52488C4CBA4699250@AM4PR0301MB2193.eurprd03.prod.outlook.com>
References: <AM4PR0301MB2193373F50EC52488C4CBA4699250@AM4PR0301MB2193.eurprd03.prod.outlook.com>
Message-ID: <23068.49192.355485.162972@bud.eddelbuettel.com>


On 27 November 2017 at 21:24, Tan, Senren wrote:
| I have been developing an R package using Rcpp to call C++ functions that use the C subroutine library 'fftw3' that implements fast Fourier transform algorithm. Since I have the C library 'fftw3' installed on my laptop (running MacOS), when I checked my developed package using R CMD CHECK --as-cran, I could pass all the checks with no errors or warnings.
| 
| However, when I submitted the package to CRAN, during the pre-test, I encountered an error. I was wondering whether this error came from the absence of the 'fftw3' C library on the checking machine? Or maybe I have made some mistakes in the Makevars.win file?
| 
| I have done some search on how to use the external C library in R packages with Rcpp.
| 
| Here is what I have provided in the Makevars.win file:
| 
| PKG_CPPFLAGS = -I$(LIB_FFTW)/include
| CXX = g++
| PKG_CXXFLAGS = -std=c++11
| PKG_LIBS = -L$(LIB_FFTW)/lib -lfftw3
| 
| Could you please advise me on what to do?

Look at what other packages do. _Many_ packages deploy Rcpp to connect to
other external packages. That is how Rcpp started: to connect to QuantLib. I
also have packages connecting to the GSL, helped with one connecting to
nlopt, was involved with one connecting to PostgreSQL and probably several
more I now forget.  Jeroen has probably a dozen more too (xml2, curl,
poppler, v8, rmariadb, ... come to mind).  Look around some more. I also
think CRAN already _has_ packages interfacing the FFTW.  Plus, you can of
course connec to external libraries without using Rcpp. Lots of other
packages do that too.

Also read Writing R Extensions more carefully as the case is covered.  The
"bad" news is that you may need to learn to work with autoconf to create
configure, or re-invent it in shell how Jeroen does it, or rely on pkg-config
as I often, or ... do whatever it takes to _detect_ when fttw3 is not present.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From rubak at math.aau.dk  Tue Nov 28 11:01:10 2017
From: rubak at math.aau.dk (Ege Rubak)
Date: Tue, 28 Nov 2017 11:01:10 +0100
Subject: [R-pkg-devel] Errors in the pre-test after submitting the R
 package
In-Reply-To: <23068.49192.355485.162972@bud.eddelbuettel.com>
References: <AM4PR0301MB2193373F50EC52488C4CBA4699250@AM4PR0301MB2193.eurprd03.prod.outlook.com>
 <23068.49192.355485.162972@bud.eddelbuettel.com>
Message-ID: <4f7c1865-141e-469a-7f19-863d56333bb5@math.aau.dk>

The obvious place to look for pointers of how to detect and link 
correctly to fftw would be in the current CRAN package `fftwtools` that 
does it without any Rcpp:
https://github.com/krahim/fftwtools

Cheers,
Ege


On 11/28/2017 02:47 AM, Dirk Eddelbuettel wrote:
> 
> On 27 November 2017 at 21:24, Tan, Senren wrote:
> | I have been developing an R package using Rcpp to call C++ functions that use the C subroutine library 'fftw3' that implements fast Fourier transform algorithm. Since I have the C library 'fftw3' installed on my laptop (running MacOS), when I checked my developed package using R CMD CHECK --as-cran, I could pass all the checks with no errors or warnings.
> |
> | However, when I submitted the package to CRAN, during the pre-test, I encountered an error. I was wondering whether this error came from the absence of the 'fftw3' C library on the checking machine? Or maybe I have made some mistakes in the Makevars.win file?
> |
> | I have done some search on how to use the external C library in R packages with Rcpp.
> |
> | Here is what I have provided in the Makevars.win file:
> |
> | PKG_CPPFLAGS = -I$(LIB_FFTW)/include
> | CXX = g++
> | PKG_CXXFLAGS = -std=c++11
> | PKG_LIBS = -L$(LIB_FFTW)/lib -lfftw3
> |
> | Could you please advise me on what to do?
> 
> Look at what other packages do. _Many_ packages deploy Rcpp to connect to
> other external packages. That is how Rcpp started: to connect to QuantLib. I
> also have packages connecting to the GSL, helped with one connecting to
> nlopt, was involved with one connecting to PostgreSQL and probably several
> more I now forget.  Jeroen has probably a dozen more too (xml2, curl,
> poppler, v8, rmariadb, ... come to mind).  Look around some more. I also
> think CRAN already _has_ packages interfacing the FFTW.  Plus, you can of
> course connec to external libraries without using Rcpp. Lots of other
> packages do that too.
> 
> Also read Writing R Extensions more carefully as the case is covered.  The
> "bad" news is that you may need to learn to work with autoconf to create
> configure, or re-invent it in shell how Jeroen does it, or rely on pkg-config
> as I often, or ... do whatever it takes to _detect_ when fttw3 is not present.
> 
> Dirk
>


From edd at debian.org  Tue Nov 28 14:21:33 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 28 Nov 2017 07:21:33 -0600
Subject: [R-pkg-devel] Errors in the pre-test after submitting the R
 package
In-Reply-To: <4f7c1865-141e-469a-7f19-863d56333bb5@math.aau.dk>
References: <AM4PR0301MB2193373F50EC52488C4CBA4699250@AM4PR0301MB2193.eurprd03.prod.outlook.com>
 <23068.49192.355485.162972@bud.eddelbuettel.com>
 <4f7c1865-141e-469a-7f19-863d56333bb5@math.aau.dk>
Message-ID: <23069.25309.205704.380969@bud.eddelbuettel.com>


On 28 November 2017 at 11:01, Ege Rubak wrote:
| The obvious place to look for pointers of how to detect and link 
| correctly to fftw would be in the current CRAN package `fftwtools` that 
| does it without any Rcpp:
| https://github.com/krahim/fftwtools

And there is also fftw by Olaf and Uwe (!!) which has a spurious fourth line
in its src/Makevars

  PKG_CPPFLAGS=@CPPFLAGS@ @FFTW_CFLAGS@
  PKG_LIBS=@LIBS@ @FFTW_LIBS@

  all: $(SHLIB)

The CRAN mirror repo does not have configure.ac, but the upstream repo does
  https://github.com/olafmersmann/fftw/blob/master/configure.ac

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From rampaletienne at gmail.com  Tue Nov 28 21:51:24 2017
From: rampaletienne at gmail.com (Rampal Etienne)
Date: Tue, 28 Nov 2017 21:51:24 +0100
Subject: [R-pkg-devel] Exited with status -1073741819.
Message-ID: <90474304-468c-11f1-64d5-a88965ca3cd3@gmail.com>

Dear all,

I updated RStudio, Rtools and R-devel, and then I tried to build a 
package in RStudio that I had been able to build before without any 
problems. But now I got the following error:

Updating SADISA documentatiob
Loading SADISA
Exited with status -1073741819.

That's all. What is this exit status? I can still build other packages, 
so it does not happen all the time. I can use "Load all" and all 
functions sseem to work fine.

Any suggestions?

Kind regards, Rampal Etienne


From dasonk at gmail.com  Wed Nov 29 00:36:21 2017
From: dasonk at gmail.com (Dason Kurkiewicz)
Date: Tue, 28 Nov 2017 18:36:21 -0500
Subject: [R-pkg-devel] Exited with status -1073741819.
In-Reply-To: <90474304-468c-11f1-64d5-a88965ca3cd3@gmail.com>
References: <90474304-468c-11f1-64d5-a88965ca3cd3@gmail.com>
Message-ID: <CAJZYZZ6LBEcaiC1y6j8wG1Of5_P0xpReEW8X5TNeC8Lsvem8ZA@mail.gmail.com>

Do you get the same error if you try to build on the command line outside
of RStudio?

On Nov 28, 2017 3:51 PM, "Rampal Etienne" <rampaletienne at gmail.com> wrote:

> Dear all,
>
> I updated RStudio, Rtools and R-devel, and then I tried to build a package
> in RStudio that I had been able to build before without any problems. But
> now I got the following error:
>
> Updating SADISA documentatiob
> Loading SADISA
> Exited with status -1073741819.
>
> That's all. What is this exit status? I can still build other packages, so
> it does not happen all the time. I can use "Load all" and all functions
> sseem to work fine.
>
> Any suggestions?
>
> Kind regards, Rampal Etienne
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From rampaletienne at gmail.com  Wed Nov 29 09:19:29 2017
From: rampaletienne at gmail.com (Rampal S. Etienne)
Date: Wed, 29 Nov 2017 09:19:29 +0100
Subject: [R-pkg-devel] Exited with status -1073741819.
In-Reply-To: <CAJZYZZ6LBEcaiC1y6j8wG1Of5_P0xpReEW8X5TNeC8Lsvem8ZA@mail.gmail.com>
References: <90474304-468c-11f1-64d5-a88965ca3cd3@gmail.com>
 <CAJZYZZ6LBEcaiC1y6j8wG1Of5_P0xpReEW8X5TNeC8Lsvem8ZA@mail.gmail.com>
Message-ID: <1f32f98d-86a7-dc87-f9fb-176e2864ab6f@gmail.com>

Dear Dason,

I don't get this error, but it crashes anyway. I've that if I use the
stable version of R (3.4.2) I do NOT get the error anymore, so I assume
there is something wrong with the current R-devel.

Regards,

Rampal Etienne


On 29-11-2017 0:36, Dason Kurkiewicz wrote:
> Do you get the same error if you try to build on the command line
> outside of RStudio?
>
> On Nov 28, 2017 3:51 PM, "Rampal Etienne" <rampaletienne at gmail.com
> <mailto:rampaletienne at gmail.com>> wrote:
>
>     Dear all,
>
>     I updated RStudio, Rtools and R-devel, and then I tried to build a
>     package in RStudio that I had been able to build before without
>     any problems. But now I got the following error:
>
>     Updating SADISA documentatiob
>     Loading SADISA
>     Exited with status -1073741819.
>
>     That's all. What is this exit status? I can still build other
>     packages, so it does not happen all the time. I can use "Load all"
>     and all functions sseem to work fine.
>
>     Any suggestions?
>
>     Kind regards, Rampal Etienne
>
>     ______________________________________________
>     R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>


	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Wed Nov 29 11:16:59 2017
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 29 Nov 2017 11:16:59 +0100
Subject: [R-pkg-devel] Exited with status -1073741819.
In-Reply-To: <1f32f98d-86a7-dc87-f9fb-176e2864ab6f@gmail.com>
References: <90474304-468c-11f1-64d5-a88965ca3cd3@gmail.com>
 <CAJZYZZ6LBEcaiC1y6j8wG1Of5_P0xpReEW8X5TNeC8Lsvem8ZA@mail.gmail.com>
 <1f32f98d-86a7-dc87-f9fb-176e2864ab6f@gmail.com>
Message-ID: <23070.35099.238826.107551@stat.math.ethz.ch>

>>>>> Rampal S Etienne <rampaletienne at gmail.com>
>>>>>     on Wed, 29 Nov 2017 09:19:29 +0100 writes:

    > Dear Dason,
    > I don't get this error, but it crashes anyway. 

and you don't show what "crashes" means here.
(and yes, Dason is right: The RStudio status number in the
'Subject' is not really useful)

    > I've that if I use the
    > stable version of R (3.4.2) I do NOT get the error anymore, so I assume
    > there is something wrong with the current R-devel.

    > Regards,
    > Rampal Etienne

OTOH, the CRAN checks of your package run without any problem
with all 5 versions of R-devel there :

  https://cran.r-project.org/web/checks/check_results_SADISA.html

so it may rather be something specific to your setup ??

Martin Maechler


    > On 29-11-2017 0:36, Dason Kurkiewicz wrote:
    >> Do you get the same error if you try to build on the command line
    >> outside of RStudio?
    >> 
    >> On Nov 28, 2017 3:51 PM, "Rampal Etienne" <rampaletienne at gmail.com
    >> <mailto:rampaletienne at gmail.com>> wrote:
    >> 
    >> Dear all,
    >> 
    >> I updated RStudio, Rtools and R-devel, and then I tried to build a
    >> package in RStudio that I had been able to build before without
    >> any problems. But now I got the following error:
    >> 
    >> Updating SADISA documentatiob
    >> Loading SADISA
    >> Exited with status -1073741819.
    >> 
    >> That's all. What is this exit status? I can still build other
    >> packages, so it does not happen all the time. I can use "Load all"
    >> and all functions sseem to work fine.
    >> 
    >> Any suggestions?
    >> 
    >> Kind regards, Rampal Etienne
    >> 
    >> ______________________________________________
    >> R-package-devel at r-project.org
    >> <mailto:R-package-devel at r-project.org> mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
    >> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
    >> 


    > [[alternative HTML version deleted]]

    > ______________________________________________
    > R-package-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-package-devel


From rampaletienne at gmail.com  Wed Nov 29 14:22:54 2017
From: rampaletienne at gmail.com (Rampal S. Etienne)
Date: Wed, 29 Nov 2017 14:22:54 +0100
Subject: [R-pkg-devel] Exited with status -1073741819.
In-Reply-To: <23070.35099.238826.107551@stat.math.ethz.ch>
References: <90474304-468c-11f1-64d5-a88965ca3cd3@gmail.com>
 <CAJZYZZ6LBEcaiC1y6j8wG1Of5_P0xpReEW8X5TNeC8Lsvem8ZA@mail.gmail.com>
 <1f32f98d-86a7-dc87-f9fb-176e2864ab6f@gmail.com>
 <23070.35099.238826.107551@stat.math.ethz.ch>
Message-ID: <8c0f3e5a-c242-ecad-4dde-5d8b3836f7c4@gmail.com>

Dear Marc, Martin, Dason,

I agree that the status number is not very informative, but neither is:
"Package does not build". The point is that I have no clue what is going
on, and was just hoping that someone might have seen the exit status
number before.

I have done a clean install as suggested but still it won't work with
R-devel, but it does with R-3.4.2.

I don't see how my setup is special in any way. It never caused me any
problems until installing the latest R-devel. What are the changes in
the latest R-devel that affect the building of packages?

Cheers, Rampal



On 29-11-2017 11:16, Martin Maechler wrote:
>>>>>> Rampal S Etienne <rampaletienne at gmail.com>
>>>>>>     on Wed, 29 Nov 2017 09:19:29 +0100 writes:
>     > Dear Dason,
>     > I don't get this error, but it crashes anyway. 
>
> and you don't show what "crashes" means here.
> (and yes, Dason is right: The RStudio status number in the
> 'Subject' is not really useful)
>
>     > I've that if I use the
>     > stable version of R (3.4.2) I do NOT get the error anymore, so I assume
>     > there is something wrong with the current R-devel.
>
>     > Regards,
>     > Rampal Etienne
>
> OTOH, the CRAN checks of your package run without any problem
> with all 5 versions of R-devel there :
>
>   https://cran.r-project.org/web/checks/check_results_SADISA.html
>
> so it may rather be something specific to your setup ??
>
> Martin Maechler
>
>
>     > On 29-11-2017 0:36, Dason Kurkiewicz wrote:
>     >> Do you get the same error if you try to build on the command line
>     >> outside of RStudio?
>     >> 
>     >> On Nov 28, 2017 3:51 PM, "Rampal Etienne" <rampaletienne at gmail.com
>     >> <mailto:rampaletienne at gmail.com>> wrote:
>     >> 
>     >> Dear all,
>     >> 
>     >> I updated RStudio, Rtools and R-devel, and then I tried to build a
>     >> package in RStudio that I had been able to build before without
>     >> any problems. But now I got the following error:
>     >> 
>     >> Updating SADISA documentatiob
>     >> Loading SADISA
>     >> Exited with status -1073741819.
>     >> 
>     >> That's all. What is this exit status? I can still build other
>     >> packages, so it does not happen all the time. I can use "Load all"
>     >> and all functions sseem to work fine.
>     >> 
>     >> Any suggestions?
>     >> 
>     >> Kind regards, Rampal Etienne
>     >> 
>     >> ______________________________________________
>     >> R-package-devel at r-project.org
>     >> <mailto:R-package-devel at r-project.org> mailing list
>     >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     >> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>     >> 
>
>
>     > [[alternative HTML version deleted]]
>
>     > ______________________________________________
>     > R-package-devel at r-project.org mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-package-devel


From maechler at stat.math.ethz.ch  Wed Nov 29 17:07:09 2017
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 29 Nov 2017 17:07:09 +0100
Subject: [R-pkg-devel] Exited with status -1073741819.
In-Reply-To: <8c0f3e5a-c242-ecad-4dde-5d8b3836f7c4@gmail.com>
References: <90474304-468c-11f1-64d5-a88965ca3cd3@gmail.com>
 <CAJZYZZ6LBEcaiC1y6j8wG1Of5_P0xpReEW8X5TNeC8Lsvem8ZA@mail.gmail.com>
 <1f32f98d-86a7-dc87-f9fb-176e2864ab6f@gmail.com>
 <23070.35099.238826.107551@stat.math.ethz.ch>
 <8c0f3e5a-c242-ecad-4dde-5d8b3836f7c4@gmail.com>
Message-ID: <23070.56109.20158.395892@stat.math.ethz.ch>

>>>>> Rampal S Etienne <rampaletienne at gmail.com>
>>>>>     on Wed, 29 Nov 2017 14:22:54 +0100 writes:

    > Dear Marc, Martin, Dason,
    > I agree that the status number is not very informative, but neither is:
    > "Package does not build". The point is that I have no clue what is going
    > on, and was just hoping that someone might have seen the exit status
    > number before.

    > I have done a clean install as suggested but still it won't work with
    > R-devel, but it does with R-3.4.2.

    > I don't see how my setup is special in any way. It never caused me any
    > problems until installing the latest R-devel. What are the changes in
    > the latest R-devel that affect the building of packages?

1000s of packages are built every day with R-devel, notably on
the machines that produce the CRAN checks, but also in several
if not many other places.

Consequently, it must be *your* problem, notably as your package
does build flawlessly on 5 different CRAN check machines running R-devel.

But of course, the purpose of *this* list (not of R-devel!) is
to help you with this problem,
hence back to what you wrote above:

"Package does not build"  is actually  more useful than a status
   number that looks random (and/or from a large integer overflow ..).

To me it would mean the package does not even build and
therefore *check*ing the package did not even properly start.

As next step (in solving the problem) you should probably learn
to either debug the devtools which you are probably using
[otherwise you would give us more information !],
or---even more useful in the long run---learn to build a package
in the shell (aka "terminal") instead of inside RStudio, because then,
using 'Rcmd build <pkg>' would almost surely give you more clues
than just "does not build".


    > On 29-11-2017 11:16, Martin Maechler wrote:
    >>>>>>> Rampal S Etienne <rampaletienne at gmail.com>
    >>>>>>> on Wed, 29 Nov 2017 09:19:29 +0100 writes:
    >> > Dear Dason,
    >> > I don't get this error, but it crashes anyway. 
    >> 
    >> and you don't show what "crashes" means here.
    >> (and yes, Dason is right: The RStudio status number in the
    >> 'Subject' is not really useful)
    >> 
    >> > I've that if I use the
    >> > stable version of R (3.4.2) I do NOT get the error anymore, so I assume
    >> > there is something wrong with the current R-devel.
    >> 
    >> > Regards,
    >> > Rampal Etienne
    >> 
    >> OTOH, the CRAN checks of your package run without any problem
    >> with all 5 versions of R-devel there :
    >> 
    >> https://cran.r-project.org/web/checks/check_results_SADISA.html
    >> 
    >> so it may rather be something specific to your setup ??
    >> 
    >> Martin Maechler
    >> 
    >> 
    >> > On 29-11-2017 0:36, Dason Kurkiewicz wrote:
    >> >> Do you get the same error if you try to build on the command line
    >> >> outside of RStudio?
    >> >> 
    >> >> On Nov 28, 2017 3:51 PM, "Rampal Etienne" <rampaletienne at gmail.com
    >> >> <mailto:rampaletienne at gmail.com>> wrote:
    >> >> 
    >> >> Dear all,
    >> >> 
    >> >> I updated RStudio, Rtools and R-devel, and then I tried to build a
    >> >> package in RStudio that I had been able to build before without
    >> >> any problems. But now I got the following error:
    >> >> 
    >> >> Updating SADISA documentatiob
    >> >> Loading SADISA
    >> >> Exited with status -1073741819.
    >> >> 
    >> >> That's all. What is this exit status? I can still build other
    >> >> packages, so it does not happen all the time. I can use "Load all"
    >> >> and all functions sseem to work fine.
    >> >> 
    >> >> Any suggestions?
    >> >> 
    >> >> Kind regards, Rampal Etienne


From wdunlap at tibco.com  Wed Nov 29 17:31:12 2017
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 29 Nov 2017 08:31:12 -0800
Subject: [R-pkg-devel] Exited with status -1073741819.
In-Reply-To: <90474304-468c-11f1-64d5-a88965ca3cd3@gmail.com>
References: <90474304-468c-11f1-64d5-a88965ca3cd3@gmail.com>
Message-ID: <CAF8bMcYEoMT+7Kbj=C7-Wo1K+t17QYPwaL25f4aqUSTP0hcCuA@mail.gmail.com>

You wrote
    Exited with status -1073741819.

The low byte of that status code is 5, which I think means a segmentation
fault - reading
or writing an address that you do not have permission of use.
  > as.hexmode(-1073741819)
  [1] "c0000005"
If your code uses memory that it has not allocated it is somewhat random
whether you
get a segmentation fault or not.  'valgrind' can detect such errors more
reliably.  Try that
on a platform where your package builds.


Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Tue, Nov 28, 2017 at 12:51 PM, Rampal Etienne <rampaletienne at gmail.com>
wrote:

> Dear all,
>
> I updated RStudio, Rtools and R-devel, and then I tried to build a package
> in RStudio that I had been able to build before without any problems. But
> now I got the following error:
>
> Updating SADISA documentatiob
> Loading SADISA
> Exited with status -1073741819.
>
> That's all. What is this exit status? I can still build other packages, so
> it does not happen all the time. I can use "Load all" and all functions
> sseem to work fine.
>
> Any suggestions?
>
> Kind regards, Rampal Etienne
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From marc_schwartz at me.com  Wed Nov 29 16:40:43 2017
From: marc_schwartz at me.com (Marc Schwartz)
Date: Wed, 29 Nov 2017 10:40:43 -0500
Subject: [R-pkg-devel] Exited with status -1073741819.
In-Reply-To: <8c0f3e5a-c242-ecad-4dde-5d8b3836f7c4@gmail.com>
References: <90474304-468c-11f1-64d5-a88965ca3cd3@gmail.com>
 <CAJZYZZ6LBEcaiC1y6j8wG1Of5_P0xpReEW8X5TNeC8Lsvem8ZA@mail.gmail.com>
 <1f32f98d-86a7-dc87-f9fb-176e2864ab6f@gmail.com>
 <23070.35099.238826.107551@stat.math.ethz.ch>
 <8c0f3e5a-c242-ecad-4dde-5d8b3836f7c4@gmail.com>
Message-ID: <942E0B3A-7CDC-42A8-AB3B-DA43F661971B@me.com>

Rampal,

One additional thought here.

Since you reference RTools in your initial post, I presume that this is occurring on Windows, though not sure which version.

Have you tried to build the package using the WinBuilder site provided by Uwe?

If not, go here:

  https://win-builder.r-project.org

and request a build of the package using R-Devel.

See if any warnings/errors are picked up there. If not, then that would seem to reinforce the notion that there is something going on locally on your system.

Also, unless I missed it, you did not indicate which version of R-Devel you are running or where you obtained it. Did you get it from:

  https://cran.r-project.org/bin/windows/base/rdevel.html

?

Regards,

Marc


> On Nov 29, 2017, at 8:22 AM, Rampal S. Etienne <rampaletienne at gmail.com> wrote:
> 
> Dear Marc, Martin, Dason,
> 
> I agree that the status number is not very informative, but neither is:
> "Package does not build". The point is that I have no clue what is going
> on, and was just hoping that someone might have seen the exit status
> number before.
> 
> I have done a clean install as suggested but still it won't work with
> R-devel, but it does with R-3.4.2.
> 
> I don't see how my setup is special in any way. It never caused me any
> problems until installing the latest R-devel. What are the changes in
> the latest R-devel that affect the building of packages?
> 
> Cheers, Rampal
> 
> 
> 
> On 29-11-2017 11:16, Martin Maechler wrote:
>>>>>>> Rampal S Etienne <rampaletienne at gmail.com>
>>>>>>>    on Wed, 29 Nov 2017 09:19:29 +0100 writes:
>>> Dear Dason,
>>> I don't get this error, but it crashes anyway. 
>> 
>> and you don't show what "crashes" means here.
>> (and yes, Dason is right: The RStudio status number in the
>> 'Subject' is not really useful)
>> 
>>> I've that if I use the
>>> stable version of R (3.4.2) I do NOT get the error anymore, so I assume
>>> there is something wrong with the current R-devel.
>> 
>>> Regards,
>>> Rampal Etienne
>> 
>> OTOH, the CRAN checks of your package run without any problem
>> with all 5 versions of R-devel there :
>> 
>>  https://cran.r-project.org/web/checks/check_results_SADISA.html
>> 
>> so it may rather be something specific to your setup ??
>> 
>> Martin Maechler
>> 
>> 
>>> On 29-11-2017 0:36, Dason Kurkiewicz wrote:
>>>> Do you get the same error if you try to build on the command line
>>>> outside of RStudio?
>>>> 
>>>> On Nov 28, 2017 3:51 PM, "Rampal Etienne" <rampaletienne at gmail.com
>>>> <mailto:rampaletienne at gmail.com>> wrote:
>>>> 
>>>> Dear all,
>>>> 
>>>> I updated RStudio, Rtools and R-devel, and then I tried to build a
>>>> package in RStudio that I had been able to build before without
>>>> any problems. But now I got the following error:
>>>> 
>>>> Updating SADISA documentatiob
>>>> Loading SADISA
>>>> Exited with status -1073741819.
>>>> 
>>>> That's all. What is this exit status? I can still build other
>>>> packages, so it does not happen all the time. I can use "Load all"
>>>> and all functions sseem to work fine.
>>>> 
>>>> Any suggestions?
>>>> 
>>>> Kind regards, Rampal Etienne


From carnivorescience at gmail.com  Wed Nov 29 23:19:41 2017
From: carnivorescience at gmail.com (Guillaume Chapron)
Date: Wed, 29 Nov 2017 23:19:41 +0100
Subject: [R-pkg-devel] R package with Swift code
Message-ID: <68AF4194-9123-4E48-BB55-90B2C9D4AECA@gmail.com>

Hello,

Does anyone know of an example of a R package that contains Swift code (https://swift.org), like many packages use C code?

Thanks

Guillaume

From anh25 at cam.ac.uk  Thu Nov 30 12:52:48 2017
From: anh25 at cam.ac.uk (Andrew Holding)
Date: Thu, 30 Nov 2017 11:52:48 +0000
Subject: [R-pkg-devel] CRAN Package error
Message-ID: <CAMkS--ZxkGWdZC_6Y32Se0_D6Zkh2iwkRv7iEpwhYSvHXFZqJQ@mail.gmail.com>

Hi all,

I?m trying to upload a new version of my package and it was automatically
bounced because of the following warnings:

Warning: namespace 'BiocFileCache' is not available and has been replaced

Warning: namespace 'AnnotationFilter' is not available and has been replaced

Warning: namespace 'Organism.dplyr' is not available and has been replaced


Theses all seem to be related to the bioconductor annotation in one of the
loaded packages. I know the new Bioconductor on devel is unstable but I
thought I should check before suggesting the pretest rejection was a false
positive to see if there was a resolution.

Cheers,

Andy
-- 
Dr Andrew Holding
Fellow of Biochemistry / Senior Research Associate
Downing College / Cancer Research UK Cambridge Institute
CRUK CI: 01223 769696
Mobile: 07595 666459

	[[alternative HTML version deleted]]


From Senren.Tan at cass.city.ac.uk  Thu Nov 30 17:49:24 2017
From: Senren.Tan at cass.city.ac.uk (Tan, Senren)
Date: Thu, 30 Nov 2017 16:49:24 +0000
Subject: [R-pkg-devel] Errors in the pre-test after submitting the R
 package
In-Reply-To: <23068.49192.355485.162972@bud.eddelbuettel.com>
References: <AM4PR0301MB2193373F50EC52488C4CBA4699250@AM4PR0301MB2193.eurprd03.prod.outlook.com>,
 <23068.49192.355485.162972@bud.eddelbuettel.com>
Message-ID: <AM4PR0301MB219369956195A7893E71C08799380@AM4PR0301MB2193.eurprd03.prod.outlook.com>

Dear Dirk,


Thank you very much for your reply.


I have been trying to look at the R package fftw developed by Olaf and Uwe over the last few days. And I have tried to make use of the configure.ac. file in their source package to generate the configure script. I tried R CMD Check on my Mac, as well as on some machines running Linux. It seems that I could pass all the R CMD Checks on these Unix / Linux machines.


Also, I have come across the following website https://cran.r-project.org/bin/windows/contrib/ThirdPartySoftware.html, on which it seems to suggest that the C library fftw3 (with the make variable LIB_FFTW) is installed on the CRAN build machine for Windows.


So, I tried the following Makevars.win.


PKG_CPPFLAGS = -I$(LIB_FFTW)/include  -I$(LIB_FFTW)
CXX11 = g++
PKG_CXXFLAGS = -std=c++11
PKG_LIBS = -L$(LIB_FFTW)/lib${R_ARCH} -lfftw3



However, when I tried to re-submit the package to CRAN, I still got the same error message on the pre-test as follows, suggesting that the machine had not detected the fftw3 library.




 **********************************************
   WARNING: this package has a configure script
         It probably needs manual configuration
   **********************************************


** libs

*** arch - i386
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c RcppExports.cpp -o RcppExports.o
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c cont_ks_dist.cpp -o cont_ks_dist.o
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c crossprob_new.cc -o crossprob_new.o
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c fftw_wrappers.cc -o fftw_wrappers.o
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c fftwconvolver.cc -o fftwconvolver.o
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability.cc -o one_sided_noncrossing_probability.o
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability_n2.cc -o one_sided_noncrossing_probability_n2.o
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability_n2logn.cc -o one_sided_noncrossing_probability_n2logn.o
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c poisson_pmf.cc -o poisson_pmf.o
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c read_boundaries_file.cc -o read_boundaries_file.o
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c string_utils.cc -o string_utils.o
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c two_sided_noncrossing_probability.cc -o two_sided_noncrossing_probability.o
d:/Compiler/gcc-4.9.3/mingw_32/bin/g++ -shared -s -static-libgcc -o KSgeneral.dll tmp.def RcppExports.o cont_ks_dist.o crossprob_new.o fftw_wrappers.o fftwconvolver.o one_sided_noncrossing_probability.o one_sided_noncrossing_probability_n2.o one_sided_noncrossing_probability_n2logn.o poisson_pmf.o read_boundaries_file.o string_utils.o two_sided_noncrossing_probability.o -Ld:/Rcompile/CRANpkg/extralibs215/local215/lib/i386 -lfftw3 -Ld:/Compiler/gcc-4.9.3/local330/lib/i386 -Ld:/Compiler/gcc-4.9.3/local330/lib -LD:/RCompile/recent/R/bin/i386 -lR
fftw_wrappers.o:fftw_wrappers.cc:(.text+0x125): undefined reference to `_imp__fftw_plan_dft_r2c_1d'
fftw_wrappers.o:fftw_wrappers.cc:(.text+0x14f): undefined reference to `_imp__fftw_destroy_plan'
fftw_wrappers.o:fftw_wrappers.cc:(.text+0x29b): undefined reference to `_imp__fftw_execute'
fftw_wrappers.o:fftw_wrappers.cc:(.text+0x315): undefined reference to `_imp__fftw_plan_dft_c2r_1d'
fftw_wrappers.o:fftw_wrappers.cc:(.text+0x33f): undefined reference to `_imp__fftw_destroy_plan'
fftw_wrappers.o:fftw_wrappers.cc:(.text+0x3bb): undefined reference to `_imp__fftw_execute'
collect2.exe: error: ld returned 1 exit status
no DLL was created


I was wondering whether I should include in the configure.ac file a few lines about downloading the library fftw3 when it is not available on the machine? Or have I made some mistakes in the Makevars.win file?

Thank you very much and I apologize for any inconvenience I may have caused you.

Best regards,
Senren



	[[alternative HTML version deleted]]


From walmutir at uoguelph.ca  Wed Nov 29 22:37:49 2017
From: walmutir at uoguelph.ca (Waleed Almutiry)
Date: Wed, 29 Nov 2017 21:37:49 +0000
Subject: [R-pkg-devel] New package submission error (ieee_arithmetic)
Message-ID: <7CEC257E-1DDB-4AA5-B22D-EB207D618775@uoguelph.ca>

Hi all,

I tried to upload my package to CRAN and did not pass the the incoming checks. This was because the use of ieee_arithmetic module in a fortran subroutine in the src folder. I built and checked the package using (R CMD build) and (R CMD check) under IOS system and it is working fine without errors. The gcc version in my system is (GNU Fortran (GCC) 5.2.0) while the gcc version in the CRAN system is 4.9.3. This is the message that I have got from the CRAN:


* installing *source* package 'EpiILMCT' ...
** libs

*** arch - i386
d:/Compiler/gcc-4.9.3/mingw_32/bin/gfortran    -pedantic -fbounds-check -O3  -mtune=core2 -c  datsim.f95 -o datsim.o
datsim.f95:21.4:

USE ieee_arithmetic
    1
Fatal Error: Can't open module file 'ieee_arithmetic.mod' for reading at (1): No such file or directory
make: *** [datsim.o] Error 1
ERROR: compilation failed for package 'EpiILMCT'
* removing 'd:/RCompile/CRANincoming/R-devel/lib/EpiILMCT'

I used the ieee_arithmetic in some subroutines to read and write results of Infinity values. I used it inside the subroutine as

IF (ieee_support_inf(Inf)) THEN Inf = ieee_value(Inf, ieee_positive_inf) END IF

So, any thought of how to overcome this issue, would be highly beneficial to me.


Many thanks,

Waleed


	[[alternative HTML version deleted]]


From avraham.adler at gmail.com  Thu Nov 30 18:37:38 2017
From: avraham.adler at gmail.com (Avraham Adler)
Date: Thu, 30 Nov 2017 12:37:38 -0500
Subject: [R-pkg-devel] New package submission error (ieee_arithmetic)
In-Reply-To: <7CEC257E-1DDB-4AA5-B22D-EB207D618775@uoguelph.ca>
References: <7CEC257E-1DDB-4AA5-B22D-EB207D618775@uoguelph.ca>
Message-ID: <CAL6gwn+sG3UUrG2SHCTkT7MZJU8S3Ej5aZjMcV+Me0=66bDPuw@mail.gmail.com>

On Wed, Nov 29, 2017 at 4:37 PM, Waleed Almutiry <walmutir at uoguelph.ca> wrote:
> I tried to upload my package to CRAN and did not pass the the incoming checks. This was because the use of ieee_arithmetic module in a fortran subroutine in the src folder. I built and checked the package using (R CMD build) and (R CMD check) under IOS system and it is working fine without errors. The gcc version in my system is (GNU Fortran (GCC) 5.2.0) while the gcc version in the CRAN system is 4.9.3. This is the message that I have got from the CRAN:

I ran into this problem with my Delaporte package. GCC 4.9.3 does not
support the IEEE modules, which were added in the GFortran tied to GCC
5.0. I believe you will have to re-write your code to comply with
4.9.3 until Jeroen et. al. release a new version of Rtolls built on a
newer version of GCC.

Avi


From avraham.adler at gmail.com  Thu Nov 30 18:46:28 2017
From: avraham.adler at gmail.com (Avraham Adler)
Date: Thu, 30 Nov 2017 12:46:28 -0500
Subject: [R-pkg-devel] New package submission error (ieee_arithmetic)
In-Reply-To: <7CEC257E-1DDB-4AA5-B22D-EB207D618775@uoguelph.ca>
References: <7CEC257E-1DDB-4AA5-B22D-EB207D618775@uoguelph.ca>
Message-ID: <CAL6gwnJBeZ2N1qUg7DVuHVEkC63GXma9k7UbcePXfaeyoZgaDQ@mail.gmail.com>

On Wed, Nov 29, 2017 at 4:37 PM, Waleed Almutiry <walmutir at uoguelph.ca> wrote:
> Hi all,
>
> I tried to upload my package to CRAN and did not pass the the incoming checks. This was because the use of ieee_arithmetic module in a fortran subroutine in the src folder. I built and checked the package using (R CMD build) and (R CMD check) under IOS system and it is working fine without errors. The gcc version in my system is (GNU Fortran (GCC) 5.2.0) while the gcc version in the CRAN system is 4.9.3. This is the message that I have got from the CRAN:
[snip]
>
> I used the ieee_arithmetic in some subroutines to read and write results of Infinity values. I used it inside the subroutine as
>
> IF (ieee_support_inf(Inf)) THEN Inf = ieee_value(Inf, ieee_positive_inf) END IF
>

Hello, Waleed.

I handled Inf and NaN by writing a C function that passes the magic
code words R_NaN and INFINITY and called them as external functions in
Fortran. See the source code of 'utils_and_wrappers.c' and
'delaporte.f95' at [1] for a working example of "set_nan" and
"set_inf"ideas. Originally, I used the actual bitpatterns to make the
functions pure, if not elemental, but Soldaris SPARC through a fit
since it was the opposite endian from the rest of the known universe.
Using the magic R words will ensure that the proper values will be
passed regardless of platform.

Hope that helps,

Avi

[1] https://bitbucket.org/aadler/delaporte


From edd at debian.org  Thu Nov 30 19:57:56 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 30 Nov 2017 12:57:56 -0600
Subject: [R-pkg-devel] Errors in the pre-test after submitting the R
 package
In-Reply-To: <AM4PR0301MB219369956195A7893E71C08799380@AM4PR0301MB2193.eurprd03.prod.outlook.com>
References: <AM4PR0301MB2193373F50EC52488C4CBA4699250@AM4PR0301MB2193.eurprd03.prod.outlook.com>
 <23068.49192.355485.162972@bud.eddelbuettel.com>
 <AM4PR0301MB219369956195A7893E71C08799380@AM4PR0301MB2193.eurprd03.prod.outlook.com>
Message-ID: <23072.21684.954850.340975@bud.eddelbuettel.com>


Hi Senren,

On 30 November 2017 at 16:49, Tan, Senren wrote:
| Thank you very much for your reply.

My pleasure. You did well here.
 
| I have been trying to look at the R package fftw developed by Olaf and Uwe over the last few days. And I have tried to make use of the configure.ac. file in their source package to generate the configure script. I tried R CMD Check on my Mac, as well as on some machines running Linux. It seems that I could pass all the R CMD Checks on these Unix / Linux machines.

Great!  [ Configure/autoconf are hated by many but it is really just a shell
scripting variant.  I don't mind it as much.  And great when it works. ]
 
| Also, I have come across the following website https://cran.r-project.org/bin/windows/contrib/ThirdPartySoftware.html, on which it seems to suggest that the C library fftw3 (with the make variable LIB_FFTW) is installed on the CRAN build machine for Windows.

Yes!
| 
| So, I tried the following Makevars.win.
| 
| PKG_CPPFLAGS = -I$(LIB_FFTW)/include  -I$(LIB_FFTW)
| CXX11 = g++
| PKG_CXXFLAGS = -std=c++11
| PKG_LIBS = -L$(LIB_FFTW)/lib${R_ARCH} -lfftw3

That looks correct to me (assuming LIB_FFTW is the chosen name). I do
something similar with my packages linking to the GNU GSL.
 
| However, when I tried to re-submit the package to CRAN, I still got the same error message on the pre-test as follows, suggesting that the machine had not detected the fftw3 library.
| 
|  **********************************************
|    WARNING: this package has a configure script
|          It probably needs manual configuration
|    **********************************************
| 
| ** libs
| 
| *** arch - i386
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c RcppExports.cpp -o RcppExports.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c cont_ks_dist.cpp -o cont_ks_dist.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c crossprob_new.cc -o crossprob_new.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c fftw_wrappers.cc -o fftw_wrappers.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c fftwconvolver.cc -o fftwconvolver.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability.cc -o one_sided_noncrossing_probability.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability_n2.cc -o one_sided_noncrossing_probability_n2.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability_n2logn.cc -o one_sided_noncrossing_probability_n2logn.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c poisson_pmf.cc -o poisson_pmf.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c read_boundaries_file.cc -o read_boundaries_file.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c string_utils.cc -o string_utils.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c two_sided_noncrossing_probability.cc -o two_sided_noncrossing_probability.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++ -shared -s -static-libgcc -o KSgeneral.dll tmp.def RcppExports.o cont_ks_dist.o crossprob_new.o fftw_wrappers.o fftwconvolver.o one_sided_noncrossing_probability.o one_sided_noncrossing_probability_n2.o one_sided_noncrossing_probability_n2logn.o poisson_pmf.o read_boundaries_file.o string_utils.o two_sided_noncrossing_probability.o -Ld:/Rcompile/CRANpkg/extralibs215/local215/lib/i386 -lfftw3 -Ld:/Compiler/gcc-4.9.3/local330/lib/i386 -Ld:/Compiler/gcc-4.9.3/local330/lib -LD:/RCompile/recent/R/bin/i386 -lR

That looks like it expanded right.

What I would do now is take one of the working packages, create a local
tarball _and put my name and email into Maintainer_ because that way the
win-builder test log will come back to me.  And then submit, and compare.

| fftw_wrappers.o:fftw_wrappers.cc:(.text+0x125): undefined reference to `_imp__fftw_plan_dft_r2c_1d'
| fftw_wrappers.o:fftw_wrappers.cc:(.text+0x14f): undefined reference to `_imp__fftw_destroy_plan'
| fftw_wrappers.o:fftw_wrappers.cc:(.text+0x29b): undefined reference to `_imp__fftw_execute'
| fftw_wrappers.o:fftw_wrappers.cc:(.text+0x315): undefined reference to `_imp__fftw_plan_dft_c2r_1d'
| fftw_wrappers.o:fftw_wrappers.cc:(.text+0x33f): undefined reference to `_imp__fftw_destroy_plan'
| fftw_wrappers.o:fftw_wrappers.cc:(.text+0x3bb): undefined reference to `_imp__fftw_execute'
| collect2.exe: error: ld returned 1 exit status
| no DLL was created

And I presume this works locally for you, ie these symbols are in fact in the
DLL you try to use?
 
| I was wondering whether I should include in the configure.ac file a few lines about downloading the library fftw3 when it is not available on the machine? Or have I made some mistakes in the Makevars.win file?

You could -- but if it works on *nix you can leave it alone.
 
| Thank you very much and I apologize for any inconvenience I may have caused you.

You are using the mailing list for the very purpose it was created for so no
apology needed or accepted!

Cheers, Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From ligges at statistik.tu-dortmund.de  Thu Nov 30 22:33:44 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 30 Nov 2017 22:33:44 +0100
Subject: [R-pkg-devel] Errors in the pre-test after submitting the R
 package
In-Reply-To: <23072.21684.954850.340975@bud.eddelbuettel.com>
References: <AM4PR0301MB2193373F50EC52488C4CBA4699250@AM4PR0301MB2193.eurprd03.prod.outlook.com>
 <23068.49192.355485.162972@bud.eddelbuettel.com>
 <AM4PR0301MB219369956195A7893E71C08799380@AM4PR0301MB2193.eurprd03.prod.outlook.com>
 <23072.21684.954850.340975@bud.eddelbuettel.com>
Message-ID: <3b6bee59-dbaf-ee37-fd14-1ee77f47996d@statistik.tu-dortmund.de>



On 30.11.2017 19:57, Dirk Eddelbuettel wrote:
> 
> Hi Senren,
> 
> On 30 November 2017 at 16:49, Tan, Senren wrote:
> | Thank you very much for your reply.
> 
> My pleasure. You did well here.
>   
> | I have been trying to look at the R package fftw developed by Olaf and Uwe over the last few days. And I have tried to make use of the configure.ac. file in their source package to generate the configure script. I tried R CMD Check on my Mac, as well as on some machines running Linux. It seems that I could pass all the R CMD Checks on these Unix / Linux machines.
> 
> Great!  [ Configure/autoconf are hated by many but it is really just a shell
> scripting variant.  I don't mind it as much.  And great when it works. ]
>   
> | Also, I have come across the following website https://cran.r-project.org/bin/windows/contrib/ThirdPartySoftware.html, on which it seems to suggest that the C library fftw3 (with the make variable LIB_FFTW) is installed on the CRAN build machine for Windows.
> 
> Yes!
> |
> | So, I tried the following Makevars.win.
> |
> | PKG_CPPFLAGS = -I$(LIB_FFTW)/include  -I$(LIB_FFTW)
> | CXX11 = g++
> | PKG_CXXFLAGS = -std=c++11
> | PKG_LIBS = -L$(LIB_FFTW)/lib${R_ARCH} -lfftw3
> 
> That looks correct to me (assuming LIB_FFTW is the chosen name). I do
> something similar with my packages linking to the GNU GSL.
>   
> | However, when I tried to re-submit the package to CRAN, I still got the same error message on the pre-test as follows, suggesting that the machine had not detected the fftw3 library.
> |
> |  **********************************************
> |    WARNING: this package has a configure script
> |          It probably needs manual configuration
> |    **********************************************
> |
> | ** libs
> |
> | *** arch - i386
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c RcppExports.cpp -o RcppExports.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c cont_ks_dist.cpp -o cont_ks_dist.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c crossprob_new.cc -o crossprob_new.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c fftw_wrappers.cc -o fftw_wrappers.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c fftwconvolver.cc -o fftwconvolver.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability.cc -o one_sided_noncrossing_probability.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability_n2.cc -o one_sided_noncrossing_probability_n2.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability_n2logn.cc -o one_sided_noncrossing_probability_n2logn.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c poisson_pmf.cc -o poisson_pmf.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c read_boundaries_file.cc -o read_boundaries_file.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c string_utils.cc -o string_utils.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c two_sided_noncrossing_probability.cc -o two_sided_noncrossing_probability.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++ -shared -s -static-libgcc -o KSgeneral.dll tmp.def RcppExports.o cont_ks_dist.o crossprob_new.o fftw_wrappers.o fftwconvolver.o one_sided_noncrossing_probability.o one_sided_noncrossing_probability_n2.o one_sided_noncrossing_probability_n2logn.o poisson_pmf.o read_boundaries_file.o string_utils.o two_sided_noncrossing_probability.o -Ld:/Rcompile/CRANpkg/extralibs215/local215/lib/i386 -lfftw3 -Ld:/Compiler/gcc-4.9.3/local330/lib/i386 -Ld:/Compiler/gcc-4.9.3/local330/lib -LD:/RCompile/recent/R/bin/i386 -lR
> 
> That looks like it expanded right.
> 
> What I would do now is take one of the working packages, create a local
> tarball _and put my name and email into Maintainer_ because that way the
> win-builder test log will come back to me.  And then submit, and compare.
> 
> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x125): undefined reference to `_imp__fftw_plan_dft_r2c_1d'
> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x14f): undefined reference to `_imp__fftw_destroy_plan'
> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x29b): undefined reference to `_imp__fftw_execute'
> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x315): undefined reference to `_imp__fftw_plan_dft_c2r_1d'
> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x33f): undefined reference to `_imp__fftw_destroy_plan'
> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x3bb): undefined reference to `_imp__fftw_execute'
> | collect2.exe: error: ld returned 1 exit status
> | no DLL was created
> 
> And I presume this works locally for you, ie these symbols are in fact in the
> DLL you try to use?

One more question: Which version of fftw do you need for these symbols?

Best,
Uwe Ligges



> | I was wondering whether I should include in the configure.ac file a few lines about downloading the library fftw3 when it is not available on the machine? Or have I made some mistakes in the Makevars.win file?
> 
> You could -- but if it works on *nix you can leave it alone.
>   
> | Thank you very much and I apologize for any inconvenience I may have caused you.
> 
> You are using the mailing list for the very purpose it was created for so no
> apology needed or accepted!
> 
> Cheers, Dirk
>


From Senren.Tan at cass.city.ac.uk  Thu Nov 30 22:40:51 2017
From: Senren.Tan at cass.city.ac.uk (Tan, Senren)
Date: Thu, 30 Nov 2017 21:40:51 +0000
Subject: [R-pkg-devel] Errors in the pre-test after submitting the R
 package
In-Reply-To: <23072.21684.954850.340975@bud.eddelbuettel.com>
References: <AM4PR0301MB2193373F50EC52488C4CBA4699250@AM4PR0301MB2193.eurprd03.prod.outlook.com>
 <23068.49192.355485.162972@bud.eddelbuettel.com>
 <AM4PR0301MB219369956195A7893E71C08799380@AM4PR0301MB2193.eurprd03.prod.outlook.com>,
 <23072.21684.954850.340975@bud.eddelbuettel.com>
Message-ID: <AM4PR0301MB219305CA276270687578323399380@AM4PR0301MB2193.eurprd03.prod.outlook.com>

Dear Dirk,


Thank you very much for your reply.


|That looks like it expanded right.

|What I would do now is take one of the working packages, create a local
|tarball _and put my name and email into Maintainer_ because that way the
|win-builder test log will come back to me.  And then submit, and compare.

I have put your name and email into the Maintainer of the package. I submitted the package to Win-Builder just now.

Best regards,
Senren




________________________________
From: Dirk Eddelbuettel <dirk.eddelbuettel at gmail.com> on behalf of Dirk Eddelbuettel <edd at debian.org>
Sent: 01 December 2017 02:57:56
To: Tan, Senren
Cc: Dirk Eddelbuettel; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Errors in the pre-test after submitting the R package


Hi Senren,

On 30 November 2017 at 16:49, Tan, Senren wrote:
| Thank you very much for your reply.

My pleasure. You did well here.

| I have been trying to look at the R package fftw developed by Olaf and Uwe over the last few days. And I have tried to make use of the configure.ac. file in their source package to generate the configure script. I tried R CMD Check on my Mac, as well as on some machines running Linux. It seems that I could pass all the R CMD Checks on these Unix / Linux machines.

Great!  [ Configure/autoconf are hated by many but it is really just a shell
scripting variant.  I don't mind it as much.  And great when it works. ]

| Also, I have come across the following website https://cran.r-project.org/bin/windows/contrib/ThirdPartySoftware.html, on which it seems to suggest that the C library fftw3 (with the make variable LIB_FFTW) is installed on the CRAN build machine for Windows.

Yes!
|
| So, I tried the following Makevars.win.
|
| PKG_CPPFLAGS = -I$(LIB_FFTW)/include  -I$(LIB_FFTW)
| CXX11 = g++
| PKG_CXXFLAGS = -std=c++11
| PKG_LIBS = -L$(LIB_FFTW)/lib${R_ARCH} -lfftw3

That looks correct to me (assuming LIB_FFTW is the chosen name). I do
something similar with my packages linking to the GNU GSL.

| However, when I tried to re-submit the package to CRAN, I still got the same error message on the pre-test as follows, suggesting that the machine had not detected the fftw3 library.
|
|  **********************************************
|    WARNING: this package has a configure script
|          It probably needs manual configuration
|    **********************************************
|
| ** libs
|
| *** arch - i386
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c RcppExports.cpp -o RcppExports.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c cont_ks_dist.cpp -o cont_ks_dist.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c crossprob_new.cc -o crossprob_new.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c fftw_wrappers.cc -o fftw_wrappers.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c fftwconvolver.cc -o fftwconvolver.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability.cc -o one_sided_noncrossing_probability.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability_n2.cc -o one_sided_noncrossing_probability_n2.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability_n2logn.cc -o one_sided_noncrossing_probability_n2logn.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c poisson_pmf.cc -o poisson_pmf.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c read_boundaries_file.cc -o read_boundaries_file.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c string_utils.cc -o string_utils.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c two_sided_noncrossing_probability.cc -o two_sided_noncrossing_probability.o
| d:/Compiler/gcc-4.9.3/mingw_32/bin/g++ -shared -s -static-libgcc -o KSgeneral.dll tmp.def RcppExports.o cont_ks_dist.o crossprob_new.o fftw_wrappers.o fftwconvolver.o one_sided_noncrossing_probability.o one_sided_noncrossing_probability_n2.o one_sided_noncrossing_probability_n2logn.o poisson_pmf.o read_boundaries_file.o string_utils.o two_sided_noncrossing_probability.o -Ld:/Rcompile/CRANpkg/extralibs215/local215/lib/i386 -lfftw3 -Ld:/Compiler/gcc-4.9.3/local330/lib/i386 -Ld:/Compiler/gcc-4.9.3/local330/lib -LD:/RCompile/recent/R/bin/i386 -lR

That looks like it expanded right.

What I would do now is take one of the working packages, create a local
tarball _and put my name and email into Maintainer_ because that way the
win-builder test log will come back to me.  And then submit, and compare.

| fftw_wrappers.o:fftw_wrappers.cc:(.text+0x125): undefined reference to `_imp__fftw_plan_dft_r2c_1d'
| fftw_wrappers.o:fftw_wrappers.cc:(.text+0x14f): undefined reference to `_imp__fftw_destroy_plan'
| fftw_wrappers.o:fftw_wrappers.cc:(.text+0x29b): undefined reference to `_imp__fftw_execute'
| fftw_wrappers.o:fftw_wrappers.cc:(.text+0x315): undefined reference to `_imp__fftw_plan_dft_c2r_1d'
| fftw_wrappers.o:fftw_wrappers.cc:(.text+0x33f): undefined reference to `_imp__fftw_destroy_plan'
| fftw_wrappers.o:fftw_wrappers.cc:(.text+0x3bb): undefined reference to `_imp__fftw_execute'
| collect2.exe: error: ld returned 1 exit status
| no DLL was created

And I presume this works locally for you, ie these symbols are in fact in the
DLL you try to use?

| I was wondering whether I should include in the configure.ac file a few lines about downloading the library fftw3 when it is not available on the machine? Or have I made some mistakes in the Makevars.win file?

You could -- but if it works on *nix you can leave it alone.

| Thank you very much and I apologize for any inconvenience I may have caused you.

You are using the mailing list for the very purpose it was created for so no
apology needed or accepted!

Cheers, Dirk

--
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org

	[[alternative HTML version deleted]]


From Senren.Tan at cass.city.ac.uk  Thu Nov 30 22:46:46 2017
From: Senren.Tan at cass.city.ac.uk (Tan, Senren)
Date: Thu, 30 Nov 2017 21:46:46 +0000
Subject: [R-pkg-devel] Errors in the pre-test after submitting the R
 package
In-Reply-To: <3b6bee59-dbaf-ee37-fd14-1ee77f47996d@statistik.tu-dortmund.de>
References: <AM4PR0301MB2193373F50EC52488C4CBA4699250@AM4PR0301MB2193.eurprd03.prod.outlook.com>
 <23068.49192.355485.162972@bud.eddelbuettel.com>
 <AM4PR0301MB219369956195A7893E71C08799380@AM4PR0301MB2193.eurprd03.prod.outlook.com>
 <23072.21684.954850.340975@bud.eddelbuettel.com>,
 <3b6bee59-dbaf-ee37-fd14-1ee77f47996d@statistik.tu-dortmund.de>
Message-ID: <AM4PR0301MB21932016E1ADF134B50CD80E99380@AM4PR0301MB2193.eurprd03.prod.outlook.com>

Dear Uwe,


|One more question: Which version of fftw do you need for these symbols?


The system requirement for fftw is fftw-3.3.4 or above. I have tried to build that on fftw-3.3.4, as well as on fftw-3.3.6.


Thank you very much.


Best regards,

Senren




________________________________
From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
Sent: 01 December 2017 05:33:44
To: Dirk Eddelbuettel; Tan, Senren
Cc: r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Errors in the pre-test after submitting the R package



On 30.11.2017 19:57, Dirk Eddelbuettel wrote:
>
> Hi Senren,
>
> On 30 November 2017 at 16:49, Tan, Senren wrote:
> | Thank you very much for your reply.
>
> My pleasure. You did well here.
>
> | I have been trying to look at the R package fftw developed by Olaf and Uwe over the last few days. And I have tried to make use of the configure.ac. file in their source package to generate the configure script. I tried R CMD Check on my Mac, as well as on some machines running Linux. It seems that I could pass all the R CMD Checks on these Unix / Linux machines.
>
> Great!  [ Configure/autoconf are hated by many but it is really just a shell
> scripting variant.  I don't mind it as much.  And great when it works. ]
>
> | Also, I have come across the following website https://cran.r-project.org/bin/windows/contrib/ThirdPartySoftware.html, on which it seems to suggest that the C library fftw3 (with the make variable LIB_FFTW) is installed on the CRAN build machine for Windows.
>
> Yes!
> |
> | So, I tried the following Makevars.win.
> |
> | PKG_CPPFLAGS = -I$(LIB_FFTW)/include  -I$(LIB_FFTW)
> | CXX11 = g++
> | PKG_CXXFLAGS = -std=c++11
> | PKG_LIBS = -L$(LIB_FFTW)/lib${R_ARCH} -lfftw3
>
> That looks correct to me (assuming LIB_FFTW is the chosen name). I do
> something similar with my packages linking to the GNU GSL.
>
> | However, when I tried to re-submit the package to CRAN, I still got the same error message on the pre-test as follows, suggesting that the machine had not detected the fftw3 library.
> |
> |  **********************************************
> |    WARNING: this package has a configure script
> |          It probably needs manual configuration
> |    **********************************************
> |
> | ** libs
> |
> | *** arch - i386
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c RcppExports.cpp -o RcppExports.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c cont_ks_dist.cpp -o cont_ks_dist.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c crossprob_new.cc -o crossprob_new.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c fftw_wrappers.cc -o fftw_wrappers.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c fftwconvolver.cc -o fftwconvolver.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability.cc -o one_sided_noncrossing_probability.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability_n2.cc -o one_sided_noncrossing_probability_n2.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c one_sided_noncrossing_probability_n2logn.cc -o one_sided_noncrossing_probability_n2logn.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c poisson_pmf.cc -o poisson_pmf.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c read_boundaries_file.cc -o read_boundaries_file.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c string_utils.cc -o string_utils.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include"  -std=c++11   -O2 -Wall  -mtune=core2 -c two_sided_noncrossing_probability.cc -o two_sided_noncrossing_probability.o
> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++ -shared -s -static-libgcc -o KSgeneral.dll tmp.def RcppExports.o cont_ks_dist.o crossprob_new.o fftw_wrappers.o fftwconvolver.o one_sided_noncrossing_probability.o one_sided_noncrossing_probability_n2.o one_sided_noncrossing_probability_n2logn.o poisson_pmf.o read_boundaries_file.o string_utils.o two_sided_noncrossing_probability.o -Ld:/Rcompile/CRANpkg/extralibs215/local215/lib/i386 -lfftw3 -Ld:/Compiler/gcc-4.9.3/local330/lib/i386 -Ld:/Compiler/gcc-4.9.3/local330/lib -LD:/RCompile/recent/R/bin/i386 -lR
>
> That looks like it expanded right.
>
> What I would do now is take one of the working packages, create a local
> tarball _and put my name and email into Maintainer_ because that way the
> win-builder test log will come back to me.  And then submit, and compare.
>
> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x125): undefined reference to `_imp__fftw_plan_dft_r2c_1d'
> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x14f): undefined reference to `_imp__fftw_destroy_plan'
> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x29b): undefined reference to `_imp__fftw_execute'
> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x315): undefined reference to `_imp__fftw_plan_dft_c2r_1d'
> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x33f): undefined reference to `_imp__fftw_destroy_plan'
> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x3bb): undefined reference to `_imp__fftw_execute'
> | collect2.exe: error: ld returned 1 exit status
> | no DLL was created
>
> And I presume this works locally for you, ie these symbols are in fact in the
> DLL you try to use?

One more question: Which version of fftw do you need for these symbols?

Best,
Uwe Ligges



> | I was wondering whether I should include in the configure.ac file a few lines about downloading the library fftw3 when it is not available on the machine? Or have I made some mistakes in the Makevars.win file?
>
> You could -- but if it works on *nix you can leave it alone.
>
> | Thank you very much and I apologize for any inconvenience I may have caused you.
>
> You are using the mailing list for the very purpose it was created for so no
> apology needed or accepted!
>
> Cheers, Dirk
>

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Thu Nov 30 22:51:35 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 30 Nov 2017 22:51:35 +0100
Subject: [R-pkg-devel] Errors in the pre-test after submitting the R
 package
In-Reply-To: <AM4PR0301MB21932016E1ADF134B50CD80E99380@AM4PR0301MB2193.eurprd03.prod.outlook.com>
References: <AM4PR0301MB2193373F50EC52488C4CBA4699250@AM4PR0301MB2193.eurprd03.prod.outlook.com>
 <23068.49192.355485.162972@bud.eddelbuettel.com>
 <AM4PR0301MB219369956195A7893E71C08799380@AM4PR0301MB2193.eurprd03.prod.outlook.com>
 <23072.21684.954850.340975@bud.eddelbuettel.com>
 <3b6bee59-dbaf-ee37-fd14-1ee77f47996d@statistik.tu-dortmund.de>
 <AM4PR0301MB21932016E1ADF134B50CD80E99380@AM4PR0301MB2193.eurprd03.prod.outlook.com>
Message-ID: <656a67b2-e904-233f-9876-2a3106dcf5da@statistik.tu-dortmund.de>



On 30.11.2017 22:46, Tan, Senren wrote:
> Dear Uwe,
> 
> 
> |One more question: Which version of fftw do you need for these symbols?
> 
> 
> The system requirement for fftw is fftw-3.3.4 or above. I have tried to 
> build that on fftw-3.3.4, as well as on fftw-3.3.6.
> 

The fftw on winbuilder is rather outdated.
I see what I can do to update it during the next days.

Best,
Uwe Ligges





> 
> Thank you very much.
> 
> 
> Best regards,
> 
> Senren
> 
> 
> 
> 
> ------------------------------------------------------------------------
> *From:* Uwe Ligges <ligges at statistik.tu-dortmund.de>
> *Sent:* 01 December 2017 05:33:44
> *To:* Dirk Eddelbuettel; Tan, Senren
> *Cc:* r-package-devel at r-project.org
> *Subject:* Re: [R-pkg-devel] Errors in the pre-test after submitting the 
> R package
> 
> 
> On 30.11.2017 19:57, Dirk Eddelbuettel wrote:
>> 
>> Hi Senren,
>> 
>> On 30 November 2017 at 16:49, Tan, Senren wrote:
>> | Thank you very much for your reply.
>> 
>> My pleasure. You did well here.
>>   
>> | I have been trying to look at the R package fftw developed by Olaf and Uwe over the last few days. And I have tried to make use of the configure.ac. file in their source package to generate the configure script. I tried R CMD Check on my Mac, as well as  on some machines running Linux. It seems that I could pass all the R 
> CMD Checks on these Unix / Linux machines.
>> 
>> Great!? [ Configure/autoconf are hated by many but it is really just a shell
>> scripting variant.? I don't mind it as much.? And great when it works. ]
>>   
>> | Also, I have come across the following website https://cran.r-project.org/bin/windows/contrib/ThirdPartySoftware.html, 
> on which it seems to suggest that the C library fftw3 (with the make 
> variable LIB_FFTW) is installed on the CRAN build machine for Windows.
>> 
>> Yes!
>> |
>> | So, I tried the following Makevars.win.
>> |
>> | PKG_CPPFLAGS = -I$(LIB_FFTW)/include? -I$(LIB_FFTW)
>> | CXX11 = g++
>> | PKG_CXXFLAGS = -std=c++11
>> | PKG_LIBS = -L$(LIB_FFTW)/lib${R_ARCH} -lfftw3
>> 
>> That looks correct to me (assuming LIB_FFTW is the chosen name). I do
>> something similar with my packages linking to the GNU GSL.
>>   
>> | However, when I tried to re-submit the package to CRAN, I still got the same error message on the pre-test as follows, suggesting that the machine had not detected the fftw3 library.
>> |
>> |? **********************************************
>> |??? WARNING: this package has a configure script
>> |????????? It probably needs manual configuration
>> |??? **********************************************
>> |
>> | ** libs
>> |
>> | *** arch - i386
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++? -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"?? -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11?? -O2 -Wall? -mtune=core2 -c RcppExports.cpp -o RcppExports.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++? -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"?? -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11?? -O2 -Wall? -mtune=core2 -c cont_ks_dist.cpp -o cont_ks_dist.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++? -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"?? -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11?? -O2 -Wall? -mtune=core2 -c crossprob_new.cc -o crossprob_new.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++? -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"?? -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11?? -O2 -Wall? -mtune=core2 -c fftw_wrappers.cc -o fftw_wrappers.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++? -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"?? -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11?? -O2 -Wall? -mtune=core2 -c fftwconvolver.cc -o fftwconvolver.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++? -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"?? -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11?? -O2 -Wall? -mtune=core2 -c 
> one_sided_noncrossing_probability.cc -o one_sided_noncrossing_probability.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++? -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"?? -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11?? -O2 -Wall? -mtune=core2 -c 
> one_sided_noncrossing_probability_n2.cc -o 
> one_sided_noncrossing_probability_n2.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++? -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"?? -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11?? -O2 -Wall? -mtune=core2 -c 
> one_sided_noncrossing_probability_n2logn.cc -o 
> one_sided_noncrossing_probability_n2logn.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++? -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"?? -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11?? -O2 -Wall? -mtune=core2 -c poisson_pmf.cc -o poisson_pmf.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++? -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"?? -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11?? -O2 -Wall? -mtune=core2 -c read_boundaries_file.cc -o 
> read_boundaries_file.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++? -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"?? -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11?? -O2 -Wall? -mtune=core2 -c string_utils.cc -o string_utils.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++? -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"?? -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11?? -O2 -Wall? -mtune=core2 -c 
> two_sided_noncrossing_probability.cc -o two_sided_noncrossing_probability.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++ -shared -s -static-libgcc -o KSgeneral.dll tmp.def RcppExports.o cont_ks_dist.o crossprob_new.o fftw_wrappers.o fftwconvolver.o one_sided_noncrossing_probability.o one_sided_noncrossing_probability_n2.o one_sided_noncrossing_probability_n2logn.o  poisson_pmf.o read_boundaries_file.o string_utils.o 
> two_sided_noncrossing_probability.o 
> -Ld:/Rcompile/CRANpkg/extralibs215/local215/lib/i386 -lfftw3 
> -Ld:/Compiler/gcc-4.9.3/local330/lib/i386 
> -Ld:/Compiler/gcc-4.9.3/local330/lib -LD:/RCompile/recent/R/bin/i386 -lR
>> 
>> That looks like it expanded right.
>> 
>> What I would do now is take one of the working packages, create a local
>> tarball _and put my name and email into Maintainer_ because that way the
>> win-builder test log will come back to me.? And then submit, and compare.
>> 
>> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x125): undefined reference to `_imp__fftw_plan_dft_r2c_1d'
>> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x14f): undefined reference to `_imp__fftw_destroy_plan'
>> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x29b): undefined reference to `_imp__fftw_execute'
>> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x315): undefined reference to `_imp__fftw_plan_dft_c2r_1d'
>> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x33f): undefined reference to `_imp__fftw_destroy_plan'
>> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x3bb): undefined reference to `_imp__fftw_execute'
>> | collect2.exe: error: ld returned 1 exit status
>> | no DLL was created
>> 
>> And I presume this works locally for you, ie these symbols are in fact in the
>> DLL you try to use?
> 
> One more question: Which version of fftw do you need for these symbols?
> 
> Best,
> Uwe Ligges
> 
> 
> 
>> | I was wondering whether I should include in the configure.ac file a few lines about downloading the library fftw3 when it is not available on the machine? Or have I made some mistakes in the Makevars.win file?
>> 
>> You could -- but if it works on *nix you can leave it alone.
>>   
>> | Thank you very much and I apologize for any inconvenience I may have caused you.
>> 
>> You are using the mailing list for the very purpose it was created for so no
>> apology needed or accepted!
>> 
>> Cheers, Dirk
>>


From Senren.Tan at cass.city.ac.uk  Thu Nov 30 22:56:59 2017
From: Senren.Tan at cass.city.ac.uk (Tan, Senren)
Date: Thu, 30 Nov 2017 21:56:59 +0000
Subject: [R-pkg-devel] Errors in the pre-test after submitting the R
 package
In-Reply-To: <656a67b2-e904-233f-9876-2a3106dcf5da@statistik.tu-dortmund.de>
References: <AM4PR0301MB2193373F50EC52488C4CBA4699250@AM4PR0301MB2193.eurprd03.prod.outlook.com>
 <23068.49192.355485.162972@bud.eddelbuettel.com>
 <AM4PR0301MB219369956195A7893E71C08799380@AM4PR0301MB2193.eurprd03.prod.outlook.com>
 <23072.21684.954850.340975@bud.eddelbuettel.com>
 <3b6bee59-dbaf-ee37-fd14-1ee77f47996d@statistik.tu-dortmund.de>
 <AM4PR0301MB21932016E1ADF134B50CD80E99380@AM4PR0301MB2193.eurprd03.prod.outlook.com>,
 <656a67b2-e904-233f-9876-2a3106dcf5da@statistik.tu-dortmund.de>
Message-ID: <AM4PR0301MB2193F281FD5DE53ED17CC0B099380@AM4PR0301MB2193.eurprd03.prod.outlook.com>

Dear Uwe,


Thank you very much for your help.


Sorry that I misread your email about the maintainer. @Dirk<mailto:edd at debian.org>

Thank you for pointing this out. at Ege<mailto:rubak at math.aau.dk>


Best regards,

Senren




________________________________
From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
Sent: 01 December 2017 05:51:35
To: Tan, Senren; Dirk Eddelbuettel
Cc: r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Errors in the pre-test after submitting the R package



On 30.11.2017 22:46, Tan, Senren wrote:
> Dear Uwe,
>
>
> |One more question: Which version of fftw do you need for these symbols?
>
>
> The system requirement for fftw is fftw-3.3.4 or above. I have tried to
> build that on fftw-3.3.4, as well as on fftw-3.3.6.
>

The fftw on winbuilder is rather outdated.
I see what I can do to update it during the next days.

Best,
Uwe Ligges





>
> Thank you very much.
>
>
> Best regards,
>
> Senren
>
>
>
>
> ------------------------------------------------------------------------
> *From:* Uwe Ligges <ligges at statistik.tu-dortmund.de>
> *Sent:* 01 December 2017 05:33:44
> *To:* Dirk Eddelbuettel; Tan, Senren
> *Cc:* r-package-devel at r-project.org
> *Subject:* Re: [R-pkg-devel] Errors in the pre-test after submitting the
> R package
>
>
> On 30.11.2017 19:57, Dirk Eddelbuettel wrote:
>>
>> Hi Senren,
>>
>> On 30 November 2017 at 16:49, Tan, Senren wrote:
>> | Thank you very much for your reply.
>>
>> My pleasure. You did well here.
>>
>> | I have been trying to look at the R package fftw developed by Olaf and Uwe over the last few days. And I have tried to make use of the configure.ac. file in their source package to generate the configure script. I tried R CMD Check on my Mac, as well as  on some machines running Linux. It seems that I could pass all the R
> CMD Checks on these Unix / Linux machines.
>>
>> Great!  [ Configure/autoconf are hated by many but it is really just a shell
>> scripting variant.  I don't mind it as much.  And great when it works. ]
>>
>> | Also, I have come across the following website https://cran.r-project.org/bin/windows/contrib/ThirdPartySoftware.html,
> on which it seems to suggest that the C library fftw3 (with the make
> variable LIB_FFTW) is installed on the CRAN build machine for Windows.
>>
>> Yes!
>> |
>> | So, I tried the following Makevars.win.
>> |
>> | PKG_CPPFLAGS = -I$(LIB_FFTW)/include  -I$(LIB_FFTW)
>> | CXX11 = g++
>> | PKG_CXXFLAGS = -std=c++11
>> | PKG_LIBS = -L$(LIB_FFTW)/lib${R_ARCH} -lfftw3
>>
>> That looks correct to me (assuming LIB_FFTW is the chosen name). I do
>> something similar with my packages linking to the GNU GSL.
>>
>> | However, when I tried to re-submit the package to CRAN, I still got the same error message on the pre-test as follows, suggesting that the machine had not detected the fftw3 library.
>> |
>> |  **********************************************
>> |    WARNING: this package has a configure script
>> |          It probably needs manual configuration
>> |    **********************************************
>> |
>> | ** libs
>> |
>> | *** arch - i386
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11   -O2 -Wall  -mtune=core2 -c RcppExports.cpp -o RcppExports.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11   -O2 -Wall  -mtune=core2 -c cont_ks_dist.cpp -o cont_ks_dist.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11   -O2 -Wall  -mtune=core2 -c crossprob_new.cc -o crossprob_new.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11   -O2 -Wall  -mtune=core2 -c fftw_wrappers.cc -o fftw_wrappers.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11   -O2 -Wall  -mtune=core2 -c fftwconvolver.cc -o fftwconvolver.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11   -O2 -Wall  -mtune=core2 -c
> one_sided_noncrossing_probability.cc -o one_sided_noncrossing_probability.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11   -O2 -Wall  -mtune=core2 -c
> one_sided_noncrossing_probability_n2.cc -o
> one_sided_noncrossing_probability_n2.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11   -O2 -Wall  -mtune=core2 -c
> one_sided_noncrossing_probability_n2logn.cc -o
> one_sided_noncrossing_probability_n2logn.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11   -O2 -Wall  -mtune=core2 -c poisson_pmf.cc -o poisson_pmf.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11   -O2 -Wall  -mtune=core2 -c read_boundaries_file.cc -o
> read_boundaries_file.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11   -O2 -Wall  -mtune=core2 -c string_utils.cc -o string_utils.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++  -std=gnu++11 -I"D:/RCompile/recent/R/include" -DNDEBUG -Id:/Rcompile/CRANpkg/extralibs215/local215/include -Id:/Rcompile/CRANpkg/extralibs215/local215 -I"d:/RCompile/CRANpkg/lib/3.5/Rcpp/include"   -I"d:/Compiler/gcc-4.9.3/local330/include" -std=c++11   -O2 -Wall  -mtune=core2 -c
> two_sided_noncrossing_probability.cc -o two_sided_noncrossing_probability.o
>> | d:/Compiler/gcc-4.9.3/mingw_32/bin/g++ -shared -s -static-libgcc -o KSgeneral.dll tmp.def RcppExports.o cont_ks_dist.o crossprob_new.o fftw_wrappers.o fftwconvolver.o one_sided_noncrossing_probability.o one_sided_noncrossing_probability_n2.o one_sided_noncrossing_probability_n2logn.o  poisson_pmf.o read_boundaries_file.o string_utils.o
> two_sided_noncrossing_probability.o
> -Ld:/Rcompile/CRANpkg/extralibs215/local215/lib/i386 -lfftw3
> -Ld:/Compiler/gcc-4.9.3/local330/lib/i386
> -Ld:/Compiler/gcc-4.9.3/local330/lib -LD:/RCompile/recent/R/bin/i386 -lR
>>
>> That looks like it expanded right.
>>
>> What I would do now is take one of the working packages, create a local
>> tarball _and put my name and email into Maintainer_ because that way the
>> win-builder test log will come back to me.  And then submit, and compare.
>>
>> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x125): undefined reference to `_imp__fftw_plan_dft_r2c_1d'
>> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x14f): undefined reference to `_imp__fftw_destroy_plan'
>> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x29b): undefined reference to `_imp__fftw_execute'
>> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x315): undefined reference to `_imp__fftw_plan_dft_c2r_1d'
>> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x33f): undefined reference to `_imp__fftw_destroy_plan'
>> | fftw_wrappers.o:fftw_wrappers.cc:(.text+0x3bb): undefined reference to `_imp__fftw_execute'
>> | collect2.exe: error: ld returned 1 exit status
>> | no DLL was created
>>
>> And I presume this works locally for you, ie these symbols are in fact in the
>> DLL you try to use?
>
> One more question: Which version of fftw do you need for these symbols?
>
> Best,
> Uwe Ligges
>
>
>
>> | I was wondering whether I should include in the configure.ac file a few lines about downloading the library fftw3 when it is not available on the machine? Or have I made some mistakes in the Makevars.win file?
>>
>> You could -- but if it works on *nix you can leave it alone.
>>
>> | Thank you very much and I apologize for any inconvenience I may have caused you.
>>
>> You are using the mailing list for the very purpose it was created for so no
>> apology needed or accepted!
>>
>> Cheers, Dirk
>>

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Thu Nov 30 23:18:32 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 30 Nov 2017 23:18:32 +0100
Subject: [R-pkg-devel] CRAN Package error
In-Reply-To: <CAMkS--ZxkGWdZC_6Y32Se0_D6Zkh2iwkRv7iEpwhYSvHXFZqJQ@mail.gmail.com>
References: <CAMkS--ZxkGWdZC_6Y32Se0_D6Zkh2iwkRv7iEpwhYSvHXFZqJQ@mail.gmail.com>
Message-ID: <09de0971-32a8-51c4-8f06-4616e51abd16@statistik.tu-dortmund.de>

Have you submitted a second time? Sounds like BioC wasa uodated on the 
build machine when you submitted.

Best,
Uwe Ligges



On 30.11.2017 12:52, Andrew Holding wrote:
> Hi all,
> 
> I?m trying to upload a new version of my package and it was automatically
> bounced because of the following warnings:
> 
> Warning: namespace 'BiocFileCache' is not available and has been replaced
> 
> Warning: namespace 'AnnotationFilter' is not available and has been replaced
> 
> Warning: namespace 'Organism.dplyr' is not available and has been replaced
> 
> 
> Theses all seem to be related to the bioconductor annotation in one of the
> loaded packages. I know the new Bioconductor on devel is unstable but I
> thought I should check before suggesting the pretest rejection was a false
> positive to see if there was a resolution.
> 
> Cheers,
> 
> Andy
>


From anh25 at cam.ac.uk  Thu Nov 30 23:54:26 2017
From: anh25 at cam.ac.uk (Andrew Holding)
Date: Thu, 30 Nov 2017 22:54:26 +0000
Subject: [R-pkg-devel] CRAN Package error
In-Reply-To: <09de0971-32a8-51c4-8f06-4616e51abd16@statistik.tu-dortmund.de>
References: <CAMkS--ZxkGWdZC_6Y32Se0_D6Zkh2iwkRv7iEpwhYSvHXFZqJQ@mail.gmail.com>
 <09de0971-32a8-51c4-8f06-4616e51abd16@statistik.tu-dortmund.de>
Message-ID: <CAMkS--ZynE=RM9sDT0JaqUfEP8nwyxT2U+aOL601sB4PDp7n5A@mail.gmail.com>

Dear Uwe,

Just submitted the package again and got the same error. I?ve copied it
below for reference.

Andy

 Found the following significant warnings:

  Warning: namespace 'BiocFileCache' is not available and has been replaced
  Warning: namespace 'AnnotationFilter' is not available and has been replaced
  Warning: namespace 'Organism.dplyr' is not available and has been replaced
See 'd:/RCompile/CRANincoming/R-devel/Brundle.Rcheck/00install.out' for details.


On Thu, 30 Nov 2017 at 22:18 Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

> Have you submitted a second time? Sounds like BioC wasa uodated on the
> build machine when you submitted.
>
> Best,
> Uwe Ligges
>
>
>
> On 30.11.2017 12:52, Andrew Holding wrote:
> > Hi all,
> >
> > I?m trying to upload a new version of my package and it was automatically
> > bounced because of the following warnings:
> >
> > Warning: namespace 'BiocFileCache' is not available and has been replaced
> >
> > Warning: namespace 'AnnotationFilter' is not available and has been
> replaced
> >
> > Warning: namespace 'Organism.dplyr' is not available and has been
> replaced
> >
> >
> > Theses all seem to be related to the bioconductor annotation in one of
> the
> > loaded packages. I know the new Bioconductor on devel is unstable but I
> > thought I should check before suggesting the pretest rejection was a
> false
> > positive to see if there was a resolution.
> >
> > Cheers,
> >
> > Andy
> >
>
-- 
Dr Andrew Holding
Fellow of Biochemistry / Senior Research Associate
Downing College / Cancer Research UK Cambridge Institute
CRUK CI: 01223 769696
Mobile: 07595 666459

	[[alternative HTML version deleted]]


From henrik.bengtsson at gmail.com  Fri Dec  1 00:26:03 2017
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Thu, 30 Nov 2017 15:26:03 -0800
Subject: [R-pkg-devel] CRAN Package error
In-Reply-To: <CAMkS--ZynE=RM9sDT0JaqUfEP8nwyxT2U+aOL601sB4PDp7n5A@mail.gmail.com>
References: <CAMkS--ZxkGWdZC_6Y32Se0_D6Zkh2iwkRv7iEpwhYSvHXFZqJQ@mail.gmail.com>
 <09de0971-32a8-51c4-8f06-4616e51abd16@statistik.tu-dortmund.de>
 <CAMkS--ZynE=RM9sDT0JaqUfEP8nwyxT2U+aOL601sB4PDp7n5A@mail.gmail.com>
Message-ID: <CAFDcVCS0-M1ofZek3cudxFQK=kZqQPd7XpPQ0PtLtr3KfLRCQQ@mail.gmail.com>

>> On 30.11.2017 12:52, Andrew Holding wrote:
>> [...] I know the new Bioconductor on devel is unstable [...]

Does CRAN support packages in the Bioconductor *devel* repository?

/Henrik

On Thu, Nov 30, 2017 at 2:54 PM, Andrew Holding <anh25 at cam.ac.uk> wrote:
> Dear Uwe,
>
> Just submitted the package again and got the same error. I?ve copied it
> below for reference.
>
> Andy
>
>  Found the following significant warnings:
>
>   Warning: namespace 'BiocFileCache' is not available and has been replaced
>   Warning: namespace 'AnnotationFilter' is not available and has been replaced
>   Warning: namespace 'Organism.dplyr' is not available and has been replaced
> See 'd:/RCompile/CRANincoming/R-devel/Brundle.Rcheck/00install.out' for details.
>
>
> On Thu, 30 Nov 2017 at 22:18 Uwe Ligges <ligges at statistik.tu-dortmund.de>
> wrote:
>
>> Have you submitted a second time? Sounds like BioC wasa uodated on the
>> build machine when you submitted.
>>
>> Best,
>> Uwe Ligges
>>
>>
>>
>> On 30.11.2017 12:52, Andrew Holding wrote:
>> > Hi all,
>> >
>> > I?m trying to upload a new version of my package and it was automatically
>> > bounced because of the following warnings:
>> >
>> > Warning: namespace 'BiocFileCache' is not available and has been replaced
>> >
>> > Warning: namespace 'AnnotationFilter' is not available and has been
>> replaced
>> >
>> > Warning: namespace 'Organism.dplyr' is not available and has been
>> replaced
>> >
>> >
>> > Theses all seem to be related to the bioconductor annotation in one of
>> the
>> > loaded packages. I know the new Bioconductor on devel is unstable but I
>> > thought I should check before suggesting the pretest rejection was a
>> false
>> > positive to see if there was a resolution.
>> >
>> > Cheers,
>> >
>> > Andy
>> >
>>
> --
> Dr Andrew Holding
> Fellow of Biochemistry / Senior Research Associate
> Downing College / Cancer Research UK Cambridge Institute
> CRUK CI: 01223 769696
> Mobile: 07595 666459
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From anh25 at cam.ac.uk  Fri Dec  1 11:02:24 2017
From: anh25 at cam.ac.uk (Andrew Holding)
Date: Fri, 01 Dec 2017 10:02:24 +0000
Subject: [R-pkg-devel] CRAN Package error
In-Reply-To: <CAFDcVCS0-M1ofZek3cudxFQK=kZqQPd7XpPQ0PtLtr3KfLRCQQ@mail.gmail.com>
References: <CAMkS--ZxkGWdZC_6Y32Se0_D6Zkh2iwkRv7iEpwhYSvHXFZqJQ@mail.gmail.com>
 <09de0971-32a8-51c4-8f06-4616e51abd16@statistik.tu-dortmund.de>
 <CAMkS--ZynE=RM9sDT0JaqUfEP8nwyxT2U+aOL601sB4PDp7n5A@mail.gmail.com>
 <CAFDcVCS0-M1ofZek3cudxFQK=kZqQPd7XpPQ0PtLtr3KfLRCQQ@mail.gmail.com>
Message-ID: <CAMkS--Yq2zXZxdtmGTupCxPM_DfOh19JEXUbcw3-twuCt5iHjA@mail.gmail.com>

Dear Henrik,

My undesranding is that rdevel testing servers using are ahead of the
current Bioconductor release. However; I?m not confident I am correct.

Andy

On Thu, 30 Nov 2017 at 23:26 Henrik Bengtsson <henrik.bengtsson at gmail.com>
wrote:

> >> On 30.11.2017 12:52, Andrew Holding wrote:
> >> [...] I know the new Bioconductor on devel is unstable [...]
>
> Does CRAN support packages in the Bioconductor *devel* repository?
>
> /Henrik
>
> On Thu, Nov 30, 2017 at 2:54 PM, Andrew Holding <anh25 at cam.ac.uk> wrote:
> > Dear Uwe,
> >
> > Just submitted the package again and got the same error. I?ve copied it
> > below for reference.
> >
> > Andy
> >
> >  Found the following significant warnings:
> >
> >   Warning: namespace 'BiocFileCache' is not available and has been
> replaced
> >   Warning: namespace 'AnnotationFilter' is not available and has been
> replaced
> >   Warning: namespace 'Organism.dplyr' is not available and has been
> replaced
> > See 'd:/RCompile/CRANincoming/R-devel/Brundle.Rcheck/00install.out' for
> details.
> >
> >
> > On Thu, 30 Nov 2017 at 22:18 Uwe Ligges <ligges at statistik.tu-dortmund.de
> >
> > wrote:
> >
> >> Have you submitted a second time? Sounds like BioC wasa uodated on the
> >> build machine when you submitted.
> >>
> >> Best,
> >> Uwe Ligges
> >>
> >>
> >>
> >> On 30.11.2017 12:52, Andrew Holding wrote:
> >> > Hi all,
> >> >
> >> > I?m trying to upload a new version of my package and it was
> automatically
> >> > bounced because of the following warnings:
> >> >
> >> > Warning: namespace 'BiocFileCache' is not available and has been
> replaced
> >> >
> >> > Warning: namespace 'AnnotationFilter' is not available and has been
> >> replaced
> >> >
> >> > Warning: namespace 'Organism.dplyr' is not available and has been
> >> replaced
> >> >
> >> >
> >> > Theses all seem to be related to the bioconductor annotation in one of
> >> the
> >> > loaded packages. I know the new Bioconductor on devel is unstable but
> I
> >> > thought I should check before suggesting the pretest rejection was a
> >> false
> >> > positive to see if there was a resolution.
> >> >
> >> > Cheers,
> >> >
> >> > Andy
> >> >
> >>
> > --
> > Dr Andrew Holding
> > Fellow of Biochemistry / Senior Research Associate
> > Downing College / Cancer Research UK Cambridge Institute
> > CRUK CI: 01223 769696
> > Mobile: 07595 666459
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
-- 
Dr Andrew Holding
Fellow of Biochemistry / Senior Research Associate
Downing College / Cancer Research UK Cambridge Institute
CRUK CI: 01223 769696
Mobile: 07595 666459

	[[alternative HTML version deleted]]


From lyubchich at umces.edu  Fri Dec  1 07:50:28 2017
From: lyubchich at umces.edu (Slava Lyubchich)
Date: Fri, 1 Dec 2017 01:50:28 -0500
Subject: [R-pkg-devel] adding rPython as a suggested package
Message-ID: <bbce3cfb-8102-bf69-59a2-0cc0829a5b42@umces.edu>

Hello,

I have a package on CRAN (funtimes) and I am trying to add a function 
that uses some Python code (only one function in the package needs 
Python, others do not). In order to do that, I
1) add in the DESCRIPTION
Suggests: rPython
2) in the R function, use
rPython::python.load("CRAD.py")
3) put CRAD.py? in the top folder of the package (together with 
DESCRIPTION and NAMESPACE).

The automatic CRAN check returns it with notes:
-- Package suggested but not available for checking: 'rPython'
-- Non-standard file/directory found at top level: ? 'CRAD.py'

Could you recommend how to fix that? Where should I move to the 
additional file with code?
https://cran.r-project.org/package=rPython 
<https://cran.r-project.org/package=rPython>

Best regards,
Slava

-- 
V. Lyubchich
Research Assistant Professor
Chesapeake Biological Laboratory
University of Maryland Center for Environmental Science


	[[alternative HTML version deleted]]


From i.ucar86 at gmail.com  Fri Dec  1 14:31:12 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Fri, 1 Dec 2017 14:31:12 +0100
Subject: [R-pkg-devel] adding rPython as a suggested package
In-Reply-To: <bbce3cfb-8102-bf69-59a2-0cc0829a5b42@umces.edu>
References: <bbce3cfb-8102-bf69-59a2-0cc0829a5b42@umces.edu>
Message-ID: <CALEXWq1umOB-2QCxg1UqB=yn8TWMyMBzGEZOMsCH-iaw5xCGig@mail.gmail.com>

2017-12-01 7:50 GMT+01:00 Slava Lyubchich <lyubchich at umces.edu>:
> Hello,
>
> I have a package on CRAN (funtimes) and I am trying to add a function
> that uses some Python code (only one function in the package needs
> Python, others do not). In order to do that, I
> 1) add in the DESCRIPTION
> Suggests: rPython
> 2) in the R function, use
> rPython::python.load("CRAD.py")
> 3) put CRAD.py  in the top folder of the package (together with
> DESCRIPTION and NAMESPACE).
>
> The automatic CRAN check returns it with notes:
> -- Package suggested but not available for checking: 'rPython'

rPython is not available for Windows. You can see "OS_type: unix" in
its DESCRIPTION. If you want to support Windows systems, take a look
at the reticulate package, which is another R interface to Python.

> -- Non-standard file/directory found at top level:   'CRAD.py'

Create an inst/ directory and put it there, as suggested in "1.1.7
Non-R scripts in packages" in the "Writing R Extensions" manual.

I?aki

>
> Could you recommend how to fix that? Where should I move to the
> additional file with code?
> https://cran.r-project.org/package=rPython
> <https://cran.r-project.org/package=rPython>
>
> Best regards,
> Slava
>
> --
> V. Lyubchich
> Research Assistant Professor
> Chesapeake Biological Laboratory
> University of Maryland Center for Environmental Science
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From walmutir at uoguelph.ca  Fri Dec  1 17:46:19 2017
From: walmutir at uoguelph.ca (Waleed Almutiry)
Date: Fri, 1 Dec 2017 16:46:19 +0000
Subject: [R-pkg-devel] New package submission error (ieee_arithmetic)
In-Reply-To: <D4CE3331-C6BF-462E-B31A-B41787A9118B@uoguelph.ca>
References: <7CEC257E-1DDB-4AA5-B22D-EB207D618775@uoguelph.ca>
 <CAL6gwnJBeZ2N1qUg7DVuHVEkC63GXma9k7UbcePXfaeyoZgaDQ@mail.gmail.com>
 <D4CE3331-C6BF-462E-B31A-B41787A9118B@uoguelph.ca>
Message-ID: <12A98629-70F0-4CCD-A83D-364DF18C114E@uoguelph.ca>

Hey Avi,

Thank you very much for your valuable suggestion. It works fine now.

Many thanks,

Waleed

> On Nov 30, 2017, at 11:02 AM, Waleed Almutiry <walmutir at uoguelph.ca> wrote:
> 
> Hey Avi,
> 
> Thank you for your valuable help and suggestion. That?s a great work to handle the infinity and NAN values. I will implement it in my code and see how it works.
> 
> Many thanks,
> 
> Waleed
> 
>> On Nov 30, 2017, at 10:46 AM, Avraham Adler <avraham.adler at gmail.com> wrote:
>> 
>> On Wed, Nov 29, 2017 at 4:37 PM, Waleed Almutiry <walmutir at uoguelph.ca> wrote:
>>> Hi all,
>>> 
>>> I tried to upload my package to CRAN and did not pass the the incoming checks. This was because the use of ieee_arithmetic module in a fortran subroutine in the src folder. I built and checked the package using (R CMD build) and (R CMD check) under IOS system and it is working fine without errors. The gcc version in my system is (GNU Fortran (GCC) 5.2.0) while the gcc version in the CRAN system is 4.9.3. This is the message that I have got from the CRAN:
>> [snip]
>>> 
>>> I used the ieee_arithmetic in some subroutines to read and write results of Infinity values. I used it inside the subroutine as
>>> 
>>> IF (ieee_support_inf(Inf)) THEN Inf = ieee_value(Inf, ieee_positive_inf) END IF
>>> 
>> 
>> Hello, Waleed.
>> 
>> I handled Inf and NaN by writing a C function that passes the magic
>> code words R_NaN and INFINITY and called them as external functions in
>> Fortran. See the source code of 'utils_and_wrappers.c' and
>> 'delaporte.f95' at [1] for a working example of "set_nan" and
>> "set_inf"ideas. Originally, I used the actual bitpatterns to make the
>> functions pure, if not elemental, but Soldaris SPARC through a fit
>> since it was the opposite endian from the rest of the known universe.
>> Using the magic R words will ensure that the proper values will be
>> passed regardless of platform.
>> 
>> Hope that helps,
>> 
>> Avi
>> 
>> [1] https://bitbucket.org/aadler/delaporte
> 


From murray.efford at otago.ac.nz  Sat Dec  2 00:06:25 2017
From: murray.efford at otago.ac.nz (Murray Efford)
Date: Fri, 1 Dec 2017 23:06:25 +0000
Subject: [R-pkg-devel] Simple URL error
Message-ID: <1512169579547.88889@otago.ac.nz>

Hi all
This is no doubt a trivial question but I haven't found a direct answer on searching. My package passes R CMD check locally and on winbuilder (R-release and R-devel) but stalled in CRAN submission with -

Found the following (possibly) invalid URLs:
   URL: http://www.phidot.org/forum/index.php
     From: man/secr-package.Rd
     Status: 503
     Message: Service Unavailable

The terminal '/index.php' is not needed. Should I expect removing it will fix the problem, or might this be a transient web access issue?
Murray

From ligges at statistik.tu-dortmund.de  Sat Dec  2 00:23:11 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 2 Dec 2017 00:23:11 +0100
Subject: [R-pkg-devel] Simple URL error
In-Reply-To: <1512169579547.88889@otago.ac.nz>
References: <1512169579547.88889@otago.ac.nz>
Message-ID: <db9ba512-6c5c-9ef1-c2c3-4c11bcceba00@statistik.tu-dortmund.de>



On 02.12.2017 00:06, Murray Efford wrote:
> Hi all
> This is no doubt a trivial question but I haven't found a direct answer on searching. My package passes R CMD check locally and on winbuilder (R-release and R-devel) but stalled in CRAN submission with -
> 
> Found the following (possibly) invalid URLs:
>     URL: http://www.phidot.org/forum/index.php
>       From: man/secr-package.Rd
>       Status: 503
>       Message: Service Unavailable
> 
> The terminal '/index.php' is not needed. Should I expect removing it will fix the problem, or might this be a transient web access issue?

Apparently the latter, our auto-check and a later manual check of the 
URL in a webbrowser showed that problem.

If the website is active again, simply resubmit.

Best,
Uwe Ligges




> Murray
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From murray.efford at otago.ac.nz  Sat Dec  2 09:28:03 2017
From: murray.efford at otago.ac.nz (Murray Efford)
Date: Sat, 2 Dec 2017 08:28:03 +0000
Subject: [R-pkg-devel] Simple URL error
In-Reply-To: <db9ba512-6c5c-9ef1-c2c3-4c11bcceba00@statistik.tu-dortmund.de>
References: <1512169579547.88889@otago.ac.nz>,
 <db9ba512-6c5c-9ef1-c2c3-4c11bcceba00@statistik.tu-dortmund.de>
Message-ID: <1512203275379.41534@otago.ac.nz>

Thanks. I have not seen any problem with that site (checking several times this afternoon) and I assume it is now OK. Package resubmitted.
Murray
________________________________________
From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
Sent: Saturday, 2 December 2017 12:23 p.m.
To: Murray Efford; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Simple URL error

On 02.12.2017 00:06, Murray Efford wrote:
> Hi all
> This is no doubt a trivial question but I haven't found a direct answer on searching. My package passes R CMD check locally and on winbuilder (R-release and R-devel) but stalled in CRAN submission with -
>
> Found the following (possibly) invalid URLs:
>     URL: http://www.phidot.org/forum/index.php
>       From: man/secr-package.Rd
>       Status: 503
>       Message: Service Unavailable
>
> The terminal '/index.php' is not needed. Should I expect removing it will fix the problem, or might this be a transient web access issue?

Apparently the latter, our auto-check and a later manual check of the
URL in a webbrowser showed that problem.

If the website is active again, simply resubmit.

Best,
Uwe Ligges




> Murray
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From bill at denney.ws  Sat Dec  2 14:38:19 2017
From: bill at denney.ws (Bill Denney)
Date: Sat, 2 Dec 2017 08:38:19 -0500
Subject: [R-pkg-devel] Testing for a Specific R Error
Message-ID: <167ADC58-3244-4A1D-9263-22F977478D99@denney.ws>

Hi,

I got a message last night that some of the tests in the PKNCA package do not follow best practices.  ("Do not test the exact format of R messages (from R itself or from other packages): They change, and they can be translated.")  Specifically, I test to ensure that an error is generated when a class cannot be coerced into a data.frame: https://cran.r-project.org/web/checks/check_results_PKNCA.html

I want to ensure that I'm getting an error that the variable cannot be coerced into a data.frame.

What is the best practice to ensure that I'm getting a specific R error (about coercion) without testing the formatting of the error text?

The only solution that immediately occurs to me is to wrap the coercion in a tryCatch and give my own error.  But, then were the R error translated, the users of my package would lose the benefit of translation.

Thanks,

Bill


From edd at debian.org  Sat Dec  2 15:23:22 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 2 Dec 2017 08:23:22 -0600
Subject: [R-pkg-devel] Testing for a Specific R Error
In-Reply-To: <167ADC58-3244-4A1D-9263-22F977478D99@denney.ws>
References: <167ADC58-3244-4A1D-9263-22F977478D99@denney.ws>
Message-ID: <23074.46938.794112.230263@bud.eddelbuettel.com>


On 2 December 2017 at 08:38, Bill Denney wrote:
| Hi,
| 
| I got a message last night that some of the tests in the PKNCA package do not follow best practices.  ("Do not test the exact format of R messages (from R itself or from other packages): They change, and they can be translated.")  Specifically, I test to ensure that an error is generated when a class cannot be coerced into a data.frame: https://cran.r-project.org/web/checks/check_results_PKNCA.html
| 
| I want to ensure that I'm getting an error that the variable cannot be coerced into a data.frame.
| 
| What is the best practice to ensure that I'm getting a specific R error (about coercion) without testing the formatting of the error text?

To me this suggest testing the _condition_ triggering the error message, as
opposed to testing for the displayed text of the error message.

Dirk
 
| The only solution that immediately occurs to me is to wrap the coercion in a tryCatch and give my own error.  But, then were the R error translated, the users of my package would lose the benefit of translation.
| 
| Thanks,
| 
| Bill
| 
| ______________________________________________
| R-package-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From henrik.bengtsson at gmail.com  Sat Dec  2 15:33:06 2017
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Sat, 2 Dec 2017 06:33:06 -0800
Subject: [R-pkg-devel] Testing for a Specific R Error
In-Reply-To: <167ADC58-3244-4A1D-9263-22F977478D99@denney.ws>
References: <167ADC58-3244-4A1D-9263-22F977478D99@denney.ws>
Message-ID: <CAFDcVCT_sZZ9cBEatZJdbrAnHchBmocJ2S=Rfr3seNC1xXDgXQ@mail.gmail.com>

For the translation part, you can test the received error message against
the translated message. You can get the translated version from the
original one using gettext("<non-translated error message exactly as the
original code does it>").

This should be agile to user's language settings but, of course, not to
changes that the developer does to the the error message.

Henrik

On Dec 2, 2017 05:38, "Bill Denney" <bill at denney.ws> wrote:

Hi,

I got a message last night that some of the tests in the PKNCA package do
not follow best practices.  ("Do not test the exact format of R messages
(from R itself or from other packages): They change, and they can be
translated.")  Specifically, I test to ensure that an error is generated
when a class cannot be coerced into a data.frame:
https://cran.r-project.org/web/checks/check_results_PKNCA.html

I want to ensure that I'm getting an error that the variable cannot be
coerced into a data.frame.

What is the best practice to ensure that I'm getting a specific R error
(about coercion) without testing the formatting of the error text?

The only solution that immediately occurs to me is to wrap the coercion in
a tryCatch and give my own error.  But, then were the R error translated,
the users of my package would lose the benefit of translation.

Thanks,

Bill

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Sat Dec  2 15:43:13 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 2 Dec 2017 09:43:13 -0500
Subject: [R-pkg-devel] Testing for a Specific R Error
In-Reply-To: <23074.46938.794112.230263@bud.eddelbuettel.com>
References: <167ADC58-3244-4A1D-9263-22F977478D99@denney.ws>
 <23074.46938.794112.230263@bud.eddelbuettel.com>
Message-ID: <4b20d858-9b94-c3e0-a624-380a01b1a2cd@gmail.com>

On 02/12/2017 9:23 AM, Dirk Eddelbuettel wrote:
> 
> On 2 December 2017 at 08:38, Bill Denney wrote:
> | Hi,
> |
> | I got a message last night that some of the tests in the PKNCA package do not follow best practices.  ("Do not test the exact format of R messages (from R itself or from other packages): They change, and they can be translated.")  Specifically, I test to ensure that an error is generated when a class cannot be coerced into a data.frame: https://cran.r-project.org/web/checks/check_results_PKNCA.html
> |
> | I want to ensure that I'm getting an error that the variable cannot be coerced into a data.frame.
> |
> | What is the best practice to ensure that I'm getting a specific R error (about coercion) without testing the formatting of the error text?
> 
> To me this suggest testing the _condition_ triggering the error message, as
> opposed to testing for the displayed text of the error message.

Isn't that what Bill suggested in the line below?

 > | The only solution that immediately occurs to me is to wrap the 
coercion in a tryCatch and give my own error.  But, then were the R 
error translated, the users of my package would lose the benefit of 
translation.

R does have a system for giving language-independent information about 
errors and warnings:  see the ?signalCondition help page. 
Unfortunately, support for this at the C level is missing, so base 
functions generally don't use it.  You only get something of class 
c("simpleError", "error", "condition").

I don't think there's anything better than Bill's solution, though I 
imagine it is possible to ask for translation of the message.  For 
example, sqrt(-1) currently gives a warning with English message "NaNs 
produced".

I can ask to translate that into the current session language using

gettext("NaNs produced", domain = "R")

Figuring out the right thing for "domain" is likely a little painful: 
it depends on which package produced the message, and how.

I don't know if CRAN tests would complain if you tested for equality 
between a warning message and the result of gettext():  it's still true 
that if the English warning changed, the test would fail.

Duncan Murdoch


From bruce.hoff at sagebase.org  Sat Dec  2 16:29:25 2017
From: bruce.hoff at sagebase.org (Bruce Hoff)
Date: Sat, 2 Dec 2017 07:29:25 -0800
Subject: [R-pkg-devel] adding rPython as a suggested package
Message-ID: <CAAeMkWu3aMs9jGiSog4fRYCU80R+cUEBszD-WexLy6BgrcAnLA@mail.gmail.com>

Hi:

Just a comment tangentially related to this topic:  There are a number of R
packages for calling Python from R, including the "rPython" and
"reticulate" packages mentioned in this thread.  Another is "PythonInR".  (
https://cran.r-project.org/web/packages/PythonInR/index.html).  These
packages address the problem of invoking a Python module or package which
is installed on the user's machine.  I.e., they answer the question, "How
can I access from R a suite of useful Python tools I have configured in my
workspace?"  There is a complementary question, "How can I expose in an R
package specific functionality written in Python?"  In the latter case the
Python function is written specifically for the R package and the R package
should be *isolated* from any installed Python environment.  The package
should not change any installed Python environment and anything you do in
Python should not affect how the R package executes.

We have addressed this second problem with a package PythonEmbedInR (
https://github.com/Sage-Bionetworks/PythonEmbedInR).  This is a
modification of PythonInR which *embeds* a hidden/private copy of Python 3
within the R package, totally isolated from any other Python runtime
concurrently installed on the machine.  Further it works *cross platform*
(Linux, Windows and MacOS).  We build the package binaries and host them
using Github pages, so to install you simply add to your list of CRAN
repo's, "https://sage-bionetworks.github.io/ran". You need not build from
source to use the package on Windows or Mac.  This is significant because
building the package also builds the Python runtime.

Any questions, please ask.

Bruce Hoff
Sage Bionetworks


2017-12-01 7:50 GMT+01:00 Slava Lyubchich <lyubchich at umces.edu>:
> Hello,
>
> I have a package on CRAN (funtimes) and I am trying to add a function
> that uses some Python code (only one function in the package needs
> Python, others do not). In order to do that, I
> 1) add in the DESCRIPTION
> Suggests: rPython
> 2) in the R function, use
> rPython::python.load("CRAD.py")
> 3) put CRAD.py  in the top folder of the package (together with
> DESCRIPTION and NAMESPACE).
>
> The automatic CRAN check returns it with notes:
> -- Package suggested but not available for checking: 'rPython'

rPython is not available for Windows. You can see "OS_type: unix" in
its DESCRIPTION. If you want to support Windows systems, take a look
at the reticulate package, which is another R interface to Python.

> -- Non-standard file/directory found at top level:   'CRAD.py'

Create an inst/ directory and put it there, as suggested in "1.1.7
Non-R scripts in packages" in the "Writing R Extensions" manual.

I?aki

>
> Could you recommend how to fix that? Where should I move to the
> additional file with code?
> https://cran.r-project.org/package=rPython
> <https://cran.r-project.org/package=rPython>
>
> Best regards,
> Slava
>
> --
> V. Lyubchich
> Research Assistant Professor
> Chesapeake Biological Laboratory
> University of Maryland Center for Environmental Science

	[[alternative HTML version deleted]]


From bill at denney.ws  Sat Dec  2 20:19:47 2017
From: bill at denney.ws (Bill Denney)
Date: Sat, 2 Dec 2017 14:19:47 -0500
Subject: [R-pkg-devel] Testing for a Specific R Error
In-Reply-To: <4b20d858-9b94-c3e0-a624-380a01b1a2cd@gmail.com>
References: <167ADC58-3244-4A1D-9263-22F977478D99@denney.ws>
 <23074.46938.794112.230263@bud.eddelbuettel.com>
 <4b20d858-9b94-c3e0-a624-380a01b1a2cd@gmail.com>
Message-ID: <274965D6-0C8C-4B63-85FD-EC62E3951546@denney.ws>


> On Dec 2, 2017, at 09:43, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> I don't think there's anything better than Bill's solution, though I imagine it is possible to ask for translation of the message.  For example, sqrt(-1) currently gives a warning with English message "NaNs produced".

Another idea just occurred to me.  Get the current error text as I'm expecting it from R by generating the error in a tryCatch and then test for equality to that string.  With that, changes in R (or other packages) would be automatically updated, and it would still be a precise test for the error I'm wanting to confirm in my test:

tryCatch(as.data.frame(structure(1, class="foo")), error=function(e) e$message)

Capture the output of that tryCatch and test for equality.

Then, it will be robust to language changes and to changes in R or other packages.

I'm going to implement that unless someone indicates something that I'm missing.

Thanks,

Bill

> 
> I can ask to translate that into the current session language using
> 
> gettext("NaNs produced", domain = "R")
> 
> Figuring out the right thing for "domain" is likely a little painful: it depends on which package produced the message, and how.
> 
> I don't know if CRAN tests would complain if you tested for equality between a warning message and the result of gettext():  it's still true that if the English warning changed, the test would fail.
> 
> Duncan Murdoch


From murdoch.duncan at gmail.com  Sat Dec  2 21:42:26 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 2 Dec 2017 15:42:26 -0500
Subject: [R-pkg-devel] Testing for a Specific R Error
In-Reply-To: <274965D6-0C8C-4B63-85FD-EC62E3951546@denney.ws>
References: <167ADC58-3244-4A1D-9263-22F977478D99@denney.ws>
 <23074.46938.794112.230263@bud.eddelbuettel.com>
 <4b20d858-9b94-c3e0-a624-380a01b1a2cd@gmail.com>
 <274965D6-0C8C-4B63-85FD-EC62E3951546@denney.ws>
Message-ID: <74693bd9-302b-4cbe-a53c-c516c81e1654@gmail.com>

On 02/12/2017 2:19 PM, Bill Denney wrote:
> 
>> On Dec 2, 2017, at 09:43, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> I don't think there's anything better than Bill's solution, though I imagine it is possible to ask for translation of the message.  For example, sqrt(-1) currently gives a warning with English message "NaNs produced".
> 
> Another idea just occurred to me.  Get the current error text as I'm expecting it from R by generating the error in a tryCatch and then test for equality to that string.  With that, changes in R (or other packages) would be automatically updated, and it would still be a precise test for the error I'm wanting to confirm in my test:
> 
> tryCatch(as.data.frame(structure(1, class="foo")), error=function(e) e$message)
> 
> Capture the output of that tryCatch and test for equality.
> 
> Then, it will be robust to language changes and to changes in R or other packages.
> 
> I'm going to implement that unless someone indicates something that I'm missing.

That sounds like a really good idea.  It should work in your use case, 
though in cases where the error message includes information about the 
arguments that led to the error (e.g. vignette("foobar") says "vignette 
?foobar? not found" in English and "vignette ?foobar? introuvable" in 
French) it might be harder.

Duncan Murdoch

> 
> Thanks,
> 
> Bill
> 
>>
>> I can ask to translate that into the current session language using
>>
>> gettext("NaNs produced", domain = "R")
>>
>> Figuring out the right thing for "domain" is likely a little painful: it depends on which package produced the message, and how.
>>
>> I don't know if CRAN tests would complain if you tested for equality between a warning message and the result of gettext():  it's still true that if the English warning changed, the test would fail.
>>
>> Duncan Murdoch


From vera.josemanuel at gmail.com  Tue Dec  5 10:04:33 2017
From: vera.josemanuel at gmail.com (Jose Manuel Vera)
Date: Tue, 5 Dec 2017 10:04:33 +0100
Subject: [R-pkg-devel] (no subject)
Message-ID: <CAAQEfzCPO3oBGzL0SeHdt88f0zOp6=nCeE-RkKeiwQN0rqH46w@mail.gmail.com>

Hi all

Submitted my package to CRAN but I got some notes I cannot understand.

First NOTE is regarding possibly mis-spelled words in DESCRIPTION. Taken
into account that these are not mispelled words (catastro is a spanish word
for "Property registry office") I leave it for now.

  catastro (18:64)
  kml (18:39)
  spanish (12:70, 17:37)


The rest of notes are the ones I cannot understand. All tests are ok.
Examples are running Ok. Tests raised no error, all seems ok but i get
this:


** running examples for arch 'i386' ... [36s] NOTE
Examples with CPU or elapsed time > 10s
                     user system elapsed
cadastral_references 0.58   0.16   17.75
geocode_cadastral    0.11   0.00   16.61

** running examples for arch 'x64' ... [37s] NOTE
Examples with CPU or elapsed time > 10s
                     user system elapsed
cadastral_references 0.69   0.15   17.24
geocode_cadastral    0.13   0.03   17.73


May I discard this notes and carry on the submission process arguing
is a false positive or do I need to change anything?


Regards

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Tue Dec  5 18:24:47 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 5 Dec 2017 18:24:47 +0100
Subject: [R-pkg-devel] (no subject)
In-Reply-To: <CAAQEfzCPO3oBGzL0SeHdt88f0zOp6=nCeE-RkKeiwQN0rqH46w@mail.gmail.com>
References: <CAAQEfzCPO3oBGzL0SeHdt88f0zOp6=nCeE-RkKeiwQN0rqH46w@mail.gmail.com>
Message-ID: <03deda9a-3442-097c-2231-71d38c651f10@statistik.tu-dortmund.de>



On 05.12.2017 10:04, Jose Manuel Vera wrote:
> Hi all
> 
> Submitted my package to CRAN but I got some notes I cannot understand.
> 
> First NOTE is regarding possibly mis-spelled words in DESCRIPTION. Taken
> into account that these are not mispelled words (catastro is a spanish word
> for "Property registry office") I leave it for now.
> 
>    catastro (18:64)
>    kml (18:39)
>    spanish (12:70, 17:37)

-> Spanish, I guess?


> 
> 
> The rest of notes are the ones I cannot understand. All tests are ok.
> Examples are running Ok. Tests raised no error, all seems ok but i get
> this:
> 
> 
> ** running examples for arch 'i386' ... [36s] NOTE
> Examples with CPU or elapsed time > 10s
>                       user system elapsed
> cadastral_references 0.58   0.16   17.75
> geocode_cadastral    0.11   0.00   16.61
> 
> ** running examples for arch 'x64' ... [37s] NOTE
> Examples with CPU or elapsed time > 10s
>                       user system elapsed
> cadastral_references 0.69   0.15   17.24
> geocode_cadastral    0.13   0.03   17.73
> 

-> Please reduce each example to less than 5 sec.

Best,
Uwe Ligges


> May I discard this notes and carry on the submission process arguing
> is a false positive or do I need to change anything?
> 
> 
> Regards
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From i.ucar86 at gmail.com  Tue Dec  5 18:35:07 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Tue, 5 Dec 2017 18:35:07 +0100
Subject: [R-pkg-devel] (no subject)
In-Reply-To: <CAAQEfzCPO3oBGzL0SeHdt88f0zOp6=nCeE-RkKeiwQN0rqH46w@mail.gmail.com>
References: <CAAQEfzCPO3oBGzL0SeHdt88f0zOp6=nCeE-RkKeiwQN0rqH46w@mail.gmail.com>
Message-ID: <CALEXWq1+0TmbC40BFk00nCZuzNTOv5YJUen2YyKGL9EbFOoG+w@mail.gmail.com>

2017-12-05 10:04 GMT+01:00 Jose Manuel Vera <vera.josemanuel at gmail.com>:
> Hi all
>
> Submitted my package to CRAN but I got some notes I cannot understand.
>
> First NOTE is regarding possibly mis-spelled words in DESCRIPTION. Taken
> into account that these are not mispelled words (catastro is a spanish word
> for "Property registry office") I leave it for now.
>
>   catastro (18:64)
>   kml (18:39)
>   spanish (12:70, 17:37)

You can ignore this if they are false positives. However, you may
consider using \emph{catastro}, with italics, given that it's a
Spanish word. Also "spanish" should be "Spanish", and I suppose "kml"
is KML, the markup language.

> The rest of notes are the ones I cannot understand. All tests are ok.
> Examples are running Ok. Tests raised no error, all seems ok but i get
> this:
>
>
> ** running examples for arch 'i386' ... [36s] NOTE
> Examples with CPU or elapsed time > 10s
>                      user system elapsed
> cadastral_references 0.58   0.16   17.75
> geocode_cadastral    0.11   0.00   16.61
>
> ** running examples for arch 'x64' ... [37s] NOTE
> Examples with CPU or elapsed time > 10s
>                      user system elapsed
> cadastral_references 0.69   0.15   17.24
> geocode_cadastral    0.13   0.03   17.73

This means that your examples are taking too much time to run. You
should explain this in your submission, or you may consider
simplifying your examples a little bit to get shorter run times. Also
you may use \dontrun{} to avoid running a specially heavy example.

I?aki


From ligges at statistik.tu-dortmund.de  Tue Dec  5 18:38:56 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 5 Dec 2017 18:38:56 +0100
Subject: [R-pkg-devel] (no subject)
In-Reply-To: <CALEXWq1+0TmbC40BFk00nCZuzNTOv5YJUen2YyKGL9EbFOoG+w@mail.gmail.com>
References: <CAAQEfzCPO3oBGzL0SeHdt88f0zOp6=nCeE-RkKeiwQN0rqH46w@mail.gmail.com>
 <CALEXWq1+0TmbC40BFk00nCZuzNTOv5YJUen2YyKGL9EbFOoG+w@mail.gmail.com>
Message-ID: <eed4a3e5-ad55-8f57-dde0-e9e4df10374f@statistik.tu-dortmund.de>



On 05.12.2017 18:35, I?aki ?car wrote:
> 2017-12-05 10:04 GMT+01:00 Jose Manuel Vera <vera.josemanuel at gmail.com>:
>> Hi all
>>
>> Submitted my package to CRAN but I got some notes I cannot understand.
>>
>> First NOTE is regarding possibly mis-spelled words in DESCRIPTION. Taken
>> into account that these are not mispelled words (catastro is a spanish word
>> for "Property registry office") I leave it for now.
>>
>>    catastro (18:64)
>>    kml (18:39)
>>    spanish (12:70, 17:37)
> 
> You can ignore this if they are false positives. However, you may
> consider using \emph{catastro}, 


No, not in Title nor Description fields.


> with italics, given that it's a
> Spanish word. Also "spanish" should be "Spanish", and I suppose "kml"
> is KML, the markup language.
> 
>> The rest of notes are the ones I cannot understand. All tests are ok.
>> Examples are running Ok. Tests raised no error, all seems ok but i get
>> this:
>>
>>
>> ** running examples for arch 'i386' ... [36s] NOTE
>> Examples with CPU or elapsed time > 10s
>>                       user system elapsed
>> cadastral_references 0.58   0.16   17.75
>> geocode_cadastral    0.11   0.00   16.61
>>
>> ** running examples for arch 'x64' ... [37s] NOTE
>> Examples with CPU or elapsed time > 10s
>>                       user system elapsed
>> cadastral_references 0.69   0.15   17.24
>> geocode_cadastral    0.13   0.03   17.73
> 
> This means that your examples are taking too much time to run. You
> should explain this in your submission, or you may consider
> simplifying your examples a little bit to get shorter run times. Also
> you may use \dontrun{} to avoid running a specially heavy example.


Ideally use toy examples so that they can be executed quickly. not only 
preferabble for CRAN but also for your users to be able to quickly see 
what is going on ...

Best,
Uwe Ligges


> I?aki
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From i.ucar86 at gmail.com  Tue Dec  5 18:47:52 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Tue, 5 Dec 2017 18:47:52 +0100
Subject: [R-pkg-devel] (no subject)
In-Reply-To: <eed4a3e5-ad55-8f57-dde0-e9e4df10374f@statistik.tu-dortmund.de>
References: <CAAQEfzCPO3oBGzL0SeHdt88f0zOp6=nCeE-RkKeiwQN0rqH46w@mail.gmail.com>
 <CALEXWq1+0TmbC40BFk00nCZuzNTOv5YJUen2YyKGL9EbFOoG+w@mail.gmail.com>
 <eed4a3e5-ad55-8f57-dde0-e9e4df10374f@statistik.tu-dortmund.de>
Message-ID: <CALEXWq0P8=XGcHWYmYOkknBmjHpQmKyEc4QHR=tmQECJKcpwgA@mail.gmail.com>

2017-12-05 18:38 GMT+01:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>
>
> On 05.12.2017 18:35, I?aki ?car wrote:
>>
>> 2017-12-05 10:04 GMT+01:00 Jose Manuel Vera <vera.josemanuel at gmail.com>:
>>>
>>> Hi all
>>>
>>> Submitted my package to CRAN but I got some notes I cannot understand.
>>>
>>> First NOTE is regarding possibly mis-spelled words in DESCRIPTION. Taken
>>> into account that these are not mispelled words (catastro is a spanish
>>> word
>>> for "Property registry office") I leave it for now.
>>>
>>>    catastro (18:64)
>>>    kml (18:39)
>>>    spanish (12:70, 17:37)
>>
>>
>> You can ignore this if they are false positives. However, you may
>> consider using \emph{catastro},
>
>
>
> No, not in Title nor Description fields.

Correct, I was thinking about Rd files. Sorry, I skimmed through and
didn't read DESCRIPTION, despite being quite big.

I?aki


From csardi.gabor at gmail.com  Tue Dec  5 20:58:17 2017
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Tue, 5 Dec 2017 19:58:17 +0000
Subject: [R-pkg-devel] R-devel windows binaries
Message-ID: <CABtg=Kk==0p6h+h8whNkEfibQ1E=KdGFzeYYWgeWAeo_suK3vQ@mail.gmail.com>

For those of you who use R-devel, it seems that (some of?) the binary
packages on CRAN were built using the wrong R version.

FYI.
Gabor

> library(testthat)
Error in library(testthat) : there is no package called ?testthat?
> R.Version()$version.string
[1] "R Under development (unstable) (2017-12-04 r73829)"
> install.packages("https://cran.r-project.org/bin/windows/contrib/3.5/testthat_1.0.2.zip", repos = NULL)
Installing package into ?C:/Users/Gabor/Documents/R?
(as ?lib? is unspecified)
trying URL 'https://cran.r-project.org/bin/windows/contrib/3.5/testthat_1.0.2.zip'
Content type 'application/zip' length 1057100 bytes (1.0 MB)
downloaded 1.0 MB

package ?testthat? successfully unpacked and MD5 sums checked
> library(testthat)
Error: package ?testthat? was installed by an R version with different
internals; it needs to be reinstalled for use with this R version
> packageDescription("testthat")
Package: testthat
Version: 1.0.2
Title: Unit Testing for R
Description: A unit testing system designed to be fun, flexible and
easy to set up.
Authors at R: c( person("Hadley", "Wickham", , "hadley at rstudio.com",
c("aut", "cre")), person("RStudio", role = "cph") )
URL: https://github.com/hadley/testthat
BugReports: https://github.com/hadley/testthat/issues
Depends: R (>= 3.1.0)
Imports: digest, crayon, praise, magrittr, R6, methods
Suggests: devtools, withr, covr
License: MIT + file LICENSE
Collate: 'auto-test.R' 'colour-text.R' 'compare.R'
'compare-character.R' 'compare-numeric.R' 'compare-time.R' 'context.R'
'describe.R'
               .....
RoxygenNote: 5.0.1
NeedsCompilation: yes
Packaged: 2016-04-22 20:14:31 UTC; hadley
Author: Hadley Wickham [aut, cre], RStudio [cph]
Maintainer: Hadley Wickham <hadley at rstudio.com>
Repository: CRAN
Date/Publication: 2016-04-23 08:37:40
Built: R 3.4.3; x86_64-w64-mingw32; 2017-12-04 00:39:18 UTC; windows

-- File: C:/Users/Gabor/Documents/R/testthat/Meta/package.rds


From goran.brostrom at umu.se  Tue Dec  5 21:51:54 2017
From: goran.brostrom at umu.se (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Tue, 5 Dec 2017 21:51:54 +0100
Subject: [R-pkg-devel] Error in re-building vignettes
Message-ID: <62ad5860-9572-cc2b-ec3d-4e783622108a@umu.se>

Hi,

I am checking my eha package with R-3.4.3:

goran at M6800:~/R$ R CMD check --as-cran eha_2.5.1.tar.gz

which results in

* DONE

Status: OK

Fine, but with R-devel (2017-12-04 r73829)

goran at M6800:~/R$ ~/src/R-devel/bin/R CMD check --as-cran eha_2.5.1.tar.gz

.........

* checking re-building of vignette outputs ... WARNING
Error in re-building vignettes:
   ...

  *** caught segfault ***
address 0x1, cause 'memory not mapped'

Traceback:
  1: .Call(C_stri_locate_all_regex, str, pattern, omit_no_match, opts_regex)
  2: stri_locate_all_regex(string, pattern, omit_no_match = TRUE, 
opts_regex = opts)
  3: stringr::str_locate_all(input, inline.code)
  4: parse_inline(g, patterns)
  5: FUN(X[[i]], ...)
  6: lapply(groups, function(g) {    block = grepl(chunk.begin, g[1]) 
if (!set.preamble && !parent_mode()) {        return(if (block) "" else 
g)    }    if (block) {        n = length(g)        if (n >= 2 && 
grepl(chunk.end, g[n]))             g = g[-n]        g = strip_block(g, 
patterns$chunk.code)        params.src = if (group_pattern(chunk.begin)) 
{            stringr::str_trim(gsub(chunk.begin, "\\1", g[1]))        } 
       else ""        parse_block(g[-1], g[1], params.src)    }    else 
parse_inline(g, patterns)})
  7: split_file(lines = text)
  8: process_file(text, output)
  9: knitr::knit(knit_input, knit_output, envir = envir, quiet = quiet, 
    encoding = encoding)
10: rmarkdown::render(file, encoding = encoding, quiet = quiet, envir = 
globalenv())
11: vweave_rmarkdown(...)
12: engine$weave(file, quiet = quiet, encoding = enc)
13: doTryCatch(return(expr), name, parentenv, handler)
14: tryCatchOne(expr, names, parentenv, handlers[[1L]])
15: tryCatchList(expr, classes, parentenv, handlers)
16: tryCatch({    engine$weave(file, quiet = quiet, encoding = enc) 
setwd(startdir)    find_vignette_product(name, by = "weave", engine = 
engine)}, error = function(e) {    stop(gettextf("processing vignette 
'%s' failed with diagnostics:\n%s",         file, conditionMessage(e)), 
domain = NA, call. = FALSE)})
17: buildVignettes(dir = "/home/goran/R/eha.Rcheck/vign_test/eha")
An irrecoverable exception occurred. R is aborting now ...
Segmentation fault (core dumped)

* checking PDF version of manual ... OK
* DONE

Status: 1 WARNING, 2 NOTEs

So, can I send this version of eha to CRAN?

G?ran Brostr?m


From anh25 at cam.ac.uk  Tue Dec  5 22:03:58 2017
From: anh25 at cam.ac.uk (Andrew Holding)
Date: Tue, 05 Dec 2017 21:03:58 +0000
Subject: [R-pkg-devel] CRAN Package error
In-Reply-To: <CAMkS--Yq2zXZxdtmGTupCxPM_DfOh19JEXUbcw3-twuCt5iHjA@mail.gmail.com>
References: <CAMkS--ZxkGWdZC_6Y32Se0_D6Zkh2iwkRv7iEpwhYSvHXFZqJQ@mail.gmail.com>
 <09de0971-32a8-51c4-8f06-4616e51abd16@statistik.tu-dortmund.de>
 <CAMkS--ZynE=RM9sDT0JaqUfEP8nwyxT2U+aOL601sB4PDp7n5A@mail.gmail.com>
 <CAFDcVCS0-M1ofZek3cudxFQK=kZqQPd7XpPQ0PtLtr3KfLRCQQ@mail.gmail.com>
 <CAMkS--Yq2zXZxdtmGTupCxPM_DfOh19JEXUbcw3-twuCt5iHjA@mail.gmail.com>
Message-ID: <CAMkS--bnTJ=WbJJ5K6J2_+3CRXiizG1weGEVs6O1R9v70foXvA@mail.gmail.com>

Dear Uwe,

I've tried again today and still get the same error Any suggestions of a
likely cause? I'm currently not even sure how to chase it up if it is a
fault at my end.

Thanks in advance,

Andy

On Fri, 1 Dec 2017 at 10:02 Andrew Holding <anh25 at cam.ac.uk> wrote:

> Dear Henrik,
>
> My undesranding is that rdevel testing servers using are ahead of the
> current Bioconductor release. However; I?m not confident I am correct.
>
> Andy
>
> On Thu, 30 Nov 2017 at 23:26 Henrik Bengtsson <henrik.bengtsson at gmail.com>
> wrote:
>
>> >> On 30.11.2017 12:52, Andrew Holding wrote:
>> >> [...] I know the new Bioconductor on devel is unstable [...]
>>
>> Does CRAN support packages in the Bioconductor *devel* repository?
>>
>> /Henrik
>>
>> On Thu, Nov 30, 2017 at 2:54 PM, Andrew Holding <anh25 at cam.ac.uk> wrote:
>> > Dear Uwe,
>> >
>> > Just submitted the package again and got the same error. I?ve copied it
>> > below for reference.
>> >
>> > Andy
>> >
>> >  Found the following significant warnings:
>> >
>> >   Warning: namespace 'BiocFileCache' is not available and has been
>> replaced
>> >   Warning: namespace 'AnnotationFilter' is not available and has been
>> replaced
>> >   Warning: namespace 'Organism.dplyr' is not available and has been
>> replaced
>> > See 'd:/RCompile/CRANincoming/R-devel/Brundle.Rcheck/00install.out' for
>> details.
>> >
>> >
>> > On Thu, 30 Nov 2017 at 22:18 Uwe Ligges <
>> ligges at statistik.tu-dortmund.de>
>> > wrote:
>> >
>> >> Have you submitted a second time? Sounds like BioC wasa uodated on the
>> >> build machine when you submitted.
>> >>
>> >> Best,
>> >> Uwe Ligges
>> >>
>> >>
>> >>
>> >> On 30.11.2017 12:52, Andrew Holding wrote:
>> >> > Hi all,
>> >> >
>> >> > I?m trying to upload a new version of my package and it was
>> automatically
>> >> > bounced because of the following warnings:
>> >> >
>> >> > Warning: namespace 'BiocFileCache' is not available and has been
>> replaced
>> >> >
>> >> > Warning: namespace 'AnnotationFilter' is not available and has been
>> >> replaced
>> >> >
>> >> > Warning: namespace 'Organism.dplyr' is not available and has been
>> >> replaced
>> >> >
>> >> >
>> >> > Theses all seem to be related to the bioconductor annotation in one
>> of
>> >> the
>> >> > loaded packages. I know the new Bioconductor on devel is unstable
>> but I
>> >> > thought I should check before suggesting the pretest rejection was a
>> >> false
>> >> > positive to see if there was a resolution.
>> >> >
>> >> > Cheers,
>> >> >
>> >> > Andy
>> >> >
>> >>
>> > --
>> > Dr Andrew Holding
>> > Fellow of Biochemistry / Senior Research Associate
>> > Downing College / Cancer Research UK Cambridge Institute
>> > CRUK CI: 01223 769696
>> > Mobile: 07595 666459
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-package-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> --
> Dr Andrew Holding
> Fellow of Biochemistry / Senior Research Associate
> Downing College / Cancer Research UK Cambridge Institute
> CRUK CI: 01223 769696
> Mobile: 07595 666459
>
-- 
Dr Andrew Holding
Fellow of Biochemistry / Senior Research Associate
Downing College / Cancer Research UK Cambridge Institute
CRUK CI: 01223 769696
Mobile: 07595 666459

	[[alternative HTML version deleted]]


From goran.brostrom at umu.se  Wed Dec  6 11:40:28 2017
From: goran.brostrom at umu.se (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Wed, 6 Dec 2017 11:40:28 +0100
Subject: [R-pkg-devel] Error in re-building vignettes (SOLVED)
In-Reply-To: <62ad5860-9572-cc2b-ec3d-4e783622108a@umu.se>
References: <62ad5860-9572-cc2b-ec3d-4e783622108a@umu.se>
Message-ID: <7dfae793-52ab-0402-23d0-12e9876d992e@umu.se>

Hi again,

today I INSTALLED R-devel (2017-12-05 r73849) and updated all packages

 > update.packages(checkBuilt = TRUE)

and rebuilt eha_2.5.1 and now all checks passed! Maybe the update of 
packages was necessary.

On its way to CRAN now.

G?ran

On 2017-12-05 21:51, G?ran Brostr?m wrote:
> Hi,
> 
> I am checking my eha package with R-3.4.3:
> 
> goran at M6800:~/R$ R CMD check --as-cran eha_2.5.1.tar.gz
> 
> which results in
> 
> * DONE
> 
> Status: OK
> 
> Fine, but with R-devel (2017-12-04 r73829)
> 
> goran at M6800:~/R$ ~/src/R-devel/bin/R CMD check --as-cran eha_2.5.1.tar.gz
> 
> .........
> 
> * checking re-building of vignette outputs ... WARNING
> Error in re-building vignettes:
>  ? ...
> 
>  ?*** caught segfault ***
> address 0x1, cause 'memory not mapped'
> 
> Traceback:
>  ?1: .Call(C_stri_locate_all_regex, str, pattern, omit_no_match, 
> opts_regex)
>  ?2: stri_locate_all_regex(string, pattern, omit_no_match = TRUE, 
> opts_regex = opts)
>  ?3: stringr::str_locate_all(input, inline.code)
>  ?4: parse_inline(g, patterns)
>  ?5: FUN(X[[i]], ...)
>  ?6: lapply(groups, function(g) {??? block = grepl(chunk.begin, g[1]) if 
> (!set.preamble && !parent_mode()) {??????? return(if (block) "" else 
> g)??? }??? if (block) {??????? n = length(g)??????? if (n >= 2 && 
> grepl(chunk.end, g[n]))???????????? g = g[-n]??????? g = strip_block(g, 
> patterns$chunk.code)??????? params.src = if (group_pattern(chunk.begin)) 
> {??????????? stringr::str_trim(gsub(chunk.begin, "\\1", g[1]))??????? } 
>  ????? else ""??????? parse_block(g[-1], g[1], params.src)??? }??? else 
> parse_inline(g, patterns)})
>  ?7: split_file(lines = text)
>  ?8: process_file(text, output)
>  ?9: knitr::knit(knit_input, knit_output, envir = envir, quiet = quiet, 
>  ?? encoding = encoding)
> 10: rmarkdown::render(file, encoding = encoding, quiet = quiet, envir = 
> globalenv())
> 11: vweave_rmarkdown(...)
> 12: engine$weave(file, quiet = quiet, encoding = enc)
> 13: doTryCatch(return(expr), name, parentenv, handler)
> 14: tryCatchOne(expr, names, parentenv, handlers[[1L]])
> 15: tryCatchList(expr, classes, parentenv, handlers)
> 16: tryCatch({??? engine$weave(file, quiet = quiet, encoding = enc) 
> setwd(startdir)??? find_vignette_product(name, by = "weave", engine = 
> engine)}, error = function(e) {??? stop(gettextf("processing vignette 
> '%s' failed with diagnostics:\n%s",???????? file, conditionMessage(e)), 
> domain = NA, call. = FALSE)})
> 17: buildVignettes(dir = "/home/goran/R/eha.Rcheck/vign_test/eha")
> An irrecoverable exception occurred. R is aborting now ...
> Segmentation fault (core dumped)
> 
> * checking PDF version of manual ... OK
> * DONE
> 
> Status: 1 WARNING, 2 NOTEs
> 
> So, can I send this version of eha to CRAN?
> 
> G?ran Brostr?m
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From vera.josemanuel at gmail.com  Wed Dec  6 12:14:09 2017
From: vera.josemanuel at gmail.com (Jose Manuel Vera)
Date: Wed, 6 Dec 2017 12:14:09 +0100
Subject: [R-pkg-devel] (no subject)
In-Reply-To: <CALEXWq0P8=XGcHWYmYOkknBmjHpQmKyEc4QHR=tmQECJKcpwgA@mail.gmail.com>
References: <CAAQEfzCPO3oBGzL0SeHdt88f0zOp6=nCeE-RkKeiwQN0rqH46w@mail.gmail.com>
 <CALEXWq1+0TmbC40BFk00nCZuzNTOv5YJUen2YyKGL9EbFOoG+w@mail.gmail.com>
 <eed4a3e5-ad55-8f57-dde0-e9e4df10374f@statistik.tu-dortmund.de>
 <CALEXWq0P8=XGcHWYmYOkknBmjHpQmKyEc4QHR=tmQECJKcpwgA@mail.gmail.com>
Message-ID: <CAAQEfzB5FKwE8t_1DTxVdicSXndPNGqg+uDr9TASeHeHqjTM8Q@mail.gmail.com>

That's the issue. My examples are inside a  \dontrun{}   block



2017-12-05 18:47 GMT+01:00 I?aki ?car <i.ucar86 at gmail.com>:

> 2017-12-05 18:38 GMT+01:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
> >
> >
> > On 05.12.2017 18:35, I?aki ?car wrote:
> >>
> >> 2017-12-05 10:04 GMT+01:00 Jose Manuel Vera <vera.josemanuel at gmail.com
> >:
> >>>
> >>> Hi all
> >>>
> >>> Submitted my package to CRAN but I got some notes I cannot understand.
> >>>
> >>> First NOTE is regarding possibly mis-spelled words in DESCRIPTION.
> Taken
> >>> into account that these are not mispelled words (catastro is a spanish
> >>> word
> >>> for "Property registry office") I leave it for now.
> >>>
> >>>    catastro (18:64)
> >>>    kml (18:39)
> >>>    spanish (12:70, 17:37)
> >>
> >>
> >> You can ignore this if they are false positives. However, you may
> >> consider using \emph{catastro},
> >
> >
> >
> > No, not in Title nor Description fields.
>
> Correct, I was thinking about Rd files. Sorry, I skimmed through and
> didn't read DESCRIPTION, despite being quite big.
>
> I?aki
>

	[[alternative HTML version deleted]]


From edd at debian.org  Wed Dec  6 13:33:18 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 6 Dec 2017 06:33:18 -0600
Subject: [R-pkg-devel] Error in re-building vignettes (SOLVED)
In-Reply-To: <7dfae793-52ab-0402-23d0-12e9876d992e@umu.se>
References: <62ad5860-9572-cc2b-ec3d-4e783622108a@umu.se>
 <7dfae793-52ab-0402-23d0-12e9876d992e@umu.se>
Message-ID: <23079.58254.774054.103217@bud.eddelbuettel.com>


On 6 December 2017 at 11:40, G?ran Brostr?m wrote:
| Hi again,
| 
| today I INSTALLED R-devel (2017-12-05 r73849) and updated all packages
| 
|  > update.packages(checkBuilt = TRUE)
| 
| and rebuilt eha_2.5.1 and now all checks passed! Maybe the update of 
| packages was necessary.

Very much so, and R Core told us about it some time ago when the 'big recent
changes' (ALTREP etc) landed in R-devel.
 
| On its way to CRAN now.

Glad you have it squared away.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From josh.m.ulrich at gmail.com  Wed Dec  6 13:45:29 2017
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 6 Dec 2017 06:45:29 -0600
Subject: [R-pkg-devel] Conditionally register method with generic in other
	package
Message-ID: <CAPPM_gSe+nGTxi2qZcM4DKW5=_SeO+z80vWb5fEkMp+iQMV5Tw@mail.gmail.com>

I have a feeling I know the answer to this question, but I'm asking
with the hope that I learn something new.

Package A defines a S3 generic function, "foo()".  Package B defines a
S3 class "bar", and a foo.bar() method.  This method is not strictly
necessary for the package to function, and package A has many
dependencies.

To avoid excessive dependencies, I would like to only register
foo.bar() if package A is installed at the time package B is
installed.  If package A is installed after package B, then warn the
user when package B is loaded and/or attached, so they can re-install
A and have foo.bar() registered correctly.

I could figure out a way to do this manually, but doubt it would be
CRAN-approved.  What is the recommended way to handle this situation?
I've received one suggestion to split B into 2 packages: one without
the method, and one with.  Are there other alternatives?

Thanks,
Josh

-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2018 | www.rinfinance.com


From bill at denney.ws  Wed Dec  6 14:44:51 2017
From: bill at denney.ws (Bill Denney)
Date: Wed, 6 Dec 2017 08:44:51 -0500
Subject: [R-pkg-devel] Conditionally register method with generic in
	other package
In-Reply-To: <CAPPM_gSe+nGTxi2qZcM4DKW5=_SeO+z80vWb5fEkMp+iQMV5Tw@mail.gmail.com>
References: <CAPPM_gSe+nGTxi2qZcM4DKW5=_SeO+z80vWb5fEkMp+iQMV5Tw@mail.gmail.com>
Message-ID: <D6A8DD57-F071-4D21-810D-45E88A9A07EB@denney.ws>


> On Dec 6, 2017, at 07:45, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
> 
> To avoid excessive dependencies, I would like to only register
> foo.bar() if package A is installed at the time package B is
> installed.  If package A is installed after package B, then warn the
> user when package B is loaded and/or attached, so they can re-install
> A and have foo.bar() registered correctly.

One simple solution would be to wrap the instantiation of foo.bar in a require test:

if (require(A)) {
  foo.bar <- function(...) {
    print("To be or not to be")
  }
} else {
  message("To use the foo.bar function, please install package A.")
}

Thanks,

Bill

From murdoch.duncan at gmail.com  Wed Dec  6 19:51:26 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 6 Dec 2017 13:51:26 -0500
Subject: [R-pkg-devel] Conditionally register method with generic in
 other package
In-Reply-To: <D6A8DD57-F071-4D21-810D-45E88A9A07EB@denney.ws>
References: <CAPPM_gSe+nGTxi2qZcM4DKW5=_SeO+z80vWb5fEkMp+iQMV5Tw@mail.gmail.com>
 <D6A8DD57-F071-4D21-810D-45E88A9A07EB@denney.ws>
Message-ID: <2476de02-2acf-b413-058f-9dd6981ff4a4@gmail.com>

On 06/12/2017 8:44 AM, Bill Denney wrote:
> 
>> On Dec 6, 2017, at 07:45, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
>>
>> To avoid excessive dependencies, I would like to only register
>> foo.bar() if package A is installed at the time package B is
>> installed.  If package A is installed after package B, then warn the
>> user when package B is loaded and/or attached, so they can re-install
>> A and have foo.bar() registered correctly.
> 
> One simple solution would be to wrap the instantiation of foo.bar in a require test:
> 
> if (require(A)) {
>    foo.bar <- function(...) {
>      print("To be or not to be")
>    }
> } else {
>    message("To use the foo.bar function, please install package A.")
> }
> 

It's usually better to use requireNamespace("A") instead of require("A") 
(and the quotes are needed in requireNamespace(), but optional in 
require()). That tries to load the package, but doesn't mess with the 
search list.

But that'll likely cause warnings, unless the same condition is used in 
the NAMESPACE file where there should be an entry

S3method(foo, bar)

The thing is, I'm not sure if

if (requireNamespace("A"))
   S3method(foo, bar)

is legal in a NAMESPACE file.

Duncan Murdoch


From josh.m.ulrich at gmail.com  Thu Dec  7 13:22:59 2017
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 7 Dec 2017 06:22:59 -0600
Subject: [R-pkg-devel] Conditionally register method with generic in
	other package
In-Reply-To: <2476de02-2acf-b413-058f-9dd6981ff4a4@gmail.com>
References: <CAPPM_gSe+nGTxi2qZcM4DKW5=_SeO+z80vWb5fEkMp+iQMV5Tw@mail.gmail.com>
 <D6A8DD57-F071-4D21-810D-45E88A9A07EB@denney.ws>
 <2476de02-2acf-b413-058f-9dd6981ff4a4@gmail.com>
Message-ID: <CAPPM_gQbR_gWZLuU76vkPm_p4+s5jCkoX4+0sN55ywiFbPNXzw@mail.gmail.com>

Bill, Duncan,

Thanks for the replies.

On Wed, Dec 6, 2017 at 12:51 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 06/12/2017 8:44 AM, Bill Denney wrote:
>>
>>
>>> On Dec 6, 2017, at 07:45, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
>>>
>>> To avoid excessive dependencies, I would like to only register
>>> foo.bar() if package A is installed at the time package B is
>>> installed.  If package A is installed after package B, then warn the
>>> user when package B is loaded and/or attached, so they can re-install
>>> A and have foo.bar() registered correctly.
>>
>>
>> One simple solution would be to wrap the instantiation of foo.bar in a
>> require test:
>>
>> if (require(A)) {
>>    foo.bar <- function(...) {
>>      print("To be or not to be")
>>    }
>> } else {
>>    message("To use the foo.bar function, please install package A.")
>> }
>>
>
> It's usually better to use requireNamespace("A") instead of require("A")
> (and the quotes are needed in requireNamespace(), but optional in
> require()). That tries to load the package, but doesn't mess with the search
> list.
>
> But that'll likely cause warnings, unless the same condition is used in the
> NAMESPACE file where there should be an entry
>
> S3method(foo, bar)
>
> The thing is, I'm not sure if
>
> if (requireNamespace("A"))
>   S3method(foo, bar)
>
> is legal in a NAMESPACE file.
>
While perhaps not technically illegal, that doesn't work because you need

if (requireNamespace("A", quietly = TRUE)) {
  importFrom(A, foo)
  S3method(foo, bar)
}

to prevent an error about being able to find object 'foo' when loading
B's namespace.  But the importFrom() causes R CMD check to expect a
hard dependency on package A (and all its dependencies), which is what
I'm trying to avoid...


> Duncan Murdoch



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2018 | www.rinfinance.com


From murdoch.duncan at gmail.com  Thu Dec  7 15:19:45 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 7 Dec 2017 09:19:45 -0500
Subject: [R-pkg-devel] [R] Please to remove the warning when trying to
	check a package.
In-Reply-To: <CAGa91zgxJp9k99UBuCsWRnF6yZ7fSCgyX7kE7eiAvziQFyFDHQ@mail.gmail.com>
References: <CAGa91zgxJp9k99UBuCsWRnF6yZ7fSCgyX7kE7eiAvziQFyFDHQ@mail.gmail.com>
Message-ID: <953c5373-4692-b36f-69f4-067f13890c40@gmail.com>

On 07/12/2017 4:43 AM, Pijush Das wrote:
> Hello Sir,
> 
> 
> 
> I have been trying to create a package in R.
> When I have put the check option in R studio to check everything is ok that
> time I have found
> two warnings and three notes. Those are given below.
> 
> warnings:
> 1) * checking dependencies in R code ... WARNING
> '::' or ':::' import not declared from: 'SparseM'
> 'loadNamespace' or 'requireNamespace' calls not declared from:
>    'Matrix' 'SparseM'

Your DESCRIPTION file should list every package from which you are 
importing functions.  The usual place is in an item called "Imports"; 
"Suggests" might also be appropriate if the functions are only 
occasionally used (and you test for the presence of the optional package).

> 
> 2) * checking files in 'vignettes' ... WARNING
> Files in the 'vignettes' directory but no files in 'inst/doc':
>    'vignettes.Rmd', 'vignettes.pdf'

You probably missed another declaration in DESCRIPTION, i.e.

VignetteBuilder: knitr

Without this, R won't know that vignettes.Rmd is a vignette.

> 
> Notes:
> 1) * checking foreign function calls ... NOTE
> Foreign function call to a different package:
>    .C("svmpredict", ..., PACKAGE = "e1071")
> See chapter 'System and foreign language interfaces' in the 'Writing R
> Extensions' manual.

It's usually a bad idea to call directly to C code in another package. 
You'll need to read the referenced manual if you really want to do that.
> 
> 2) * checking R code for possible problems ... NOTE
> predict.packageXXX: no visible global function definition for 'as'
> predict.packageXXX: no visible global function definition for 'new'
> Undefined global functions or variables:
>    as new
> Consider adding

You cut off the advice that followed "Consider adding".  You should 
follow that advice.

> 
> 3) * checking DESCRIPTION meta-information ... NOTE
> Packages listed in more than one of Depends, Imports, Suggests, Enhances:
>    'e1071' 'nlme' 'openxlsx' 'pheatmap' 'RColorBrewer' 'R.rsp'
> A package should be listed in only one of these fields.

Just figure out which of those fields you want, and put the package 
names in just one of them.

> 
> 
> 
> Can anybody help me to short out those problem please ?
> 
> 
> Thank you very much.
> 
> 
> regards
> Pijush
> 
> 	[[alternative HTML version deleted]]

Generally R mailing lists are plain text.  Your message was readable as 
you posted it, but if you had added code, it would likely be a mess. 
Please configure your mail program to post in plain text.

Duncan Murdoch


From h.wickham at gmail.com  Thu Dec  7 20:54:18 2017
From: h.wickham at gmail.com (Hadley Wickham)
Date: Fri, 8 Dec 2017 08:54:18 +1300
Subject: [R-pkg-devel] Conditionally register method with generic in
	other package
In-Reply-To: <D6A8DD57-F071-4D21-810D-45E88A9A07EB@denney.ws>
References: <CAPPM_gSe+nGTxi2qZcM4DKW5=_SeO+z80vWb5fEkMp+iQMV5Tw@mail.gmail.com>
 <D6A8DD57-F071-4D21-810D-45E88A9A07EB@denney.ws>
Message-ID: <CABdHhvF-ZZBYGXFP_+J8CCecNtxu161iOpttc2k9oq++tD05nw@mail.gmail.com>

On Thu, Dec 7, 2017 at 2:44 AM, Bill Denney <bill at denney.ws> wrote:
>
>> On Dec 6, 2017, at 07:45, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
>>
>> To avoid excessive dependencies, I would like to only register
>> foo.bar() if package A is installed at the time package B is
>> installed.  If package A is installed after package B, then warn the
>> user when package B is loaded and/or attached, so they can re-install
>> A and have foo.bar() registered correctly.
>
> One simple solution would be to wrap the instantiation of foo.bar in a require test:
>
> if (require(A)) {
>   foo.bar <- function(...) {
>     print("To be or not to be")
>   }
> } else {
>   message("To use the foo.bar function, please install package A.")
> }

I don't think that will work because the code will be executed at
build time, not package-load time.

Hadley

-- 
http://hadley.nz


From h.wickham at gmail.com  Thu Dec  7 20:57:19 2017
From: h.wickham at gmail.com (Hadley Wickham)
Date: Fri, 8 Dec 2017 08:57:19 +1300
Subject: [R-pkg-devel] Conditionally register method with generic in
	other package
In-Reply-To: <CAPPM_gSe+nGTxi2qZcM4DKW5=_SeO+z80vWb5fEkMp+iQMV5Tw@mail.gmail.com>
References: <CAPPM_gSe+nGTxi2qZcM4DKW5=_SeO+z80vWb5fEkMp+iQMV5Tw@mail.gmail.com>
Message-ID: <CABdHhvFqjWY2Xc4jOdVxHtCch8MXVNmtjMqMRw=sJQtx9P1SaQ@mail.gmail.com>

We use this technique in a couple of places:
https://github.com/tidyverse/dbplyr/blob/6be777d8b23d588f19c98de52f4e58f16c2ef67e/R/zzz.R

Basic idea is to call registerS3method() manually, when needed - it's
just a little tricky because the suggested package may be loaded
either before or after your package.

Hadley

On Thu, Dec 7, 2017 at 1:45 AM, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
> I have a feeling I know the answer to this question, but I'm asking
> with the hope that I learn something new.
>
> Package A defines a S3 generic function, "foo()".  Package B defines a
> S3 class "bar", and a foo.bar() method.  This method is not strictly
> necessary for the package to function, and package A has many
> dependencies.
>
> To avoid excessive dependencies, I would like to only register
> foo.bar() if package A is installed at the time package B is
> installed.  If package A is installed after package B, then warn the
> user when package B is loaded and/or attached, so they can re-install
> A and have foo.bar() registered correctly.
>
> I could figure out a way to do this manually, but doubt it would be
> CRAN-approved.  What is the recommended way to handle this situation?
> I've received one suggestion to split B into 2 packages: one without
> the method, and one with.  Are there other alternatives?
>
> Thanks,
> Josh
>
> --
> Joshua Ulrich  |  about.me/joshuaulrich
> FOSS Trading  |  www.fosstrading.com
> R/Finance 2018 | www.rinfinance.com
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
http://hadley.nz


From ligges at statistik.tu-dortmund.de  Sun Dec 10 15:57:32 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 10 Dec 2017 15:57:32 +0100
Subject: [R-pkg-devel] CRAN submission queue closes from Dec 22 to Jan 3
Message-ID: <16fb2afc-7554-8898-9d38-1f2d62bd6903@statistik.tu-dortmund.de>

Dear package developers,

the CRAN submission queue closes and will be offline from Dec 22 to Jan 
3 due to CRAN team vacations and maintainance work on the CRAN check farm.

Best,
Uwe Ligges


From rtobar at icrar.org  Mon Dec 11 23:56:23 2017
From: rtobar at icrar.org (Rodrigo Tobar)
Date: Tue, 12 Dec 2017 06:56:23 +0800
Subject: [R-pkg-devel] Dialect for shell scripts
Message-ID: <4576fdbc-5257-61f1-0841-7a4a3ffd24f9@icrar.org>

Dear all,

During a recent package submission, we were highlighted that some lines
in our configure script didn't follow the correct syntax. The lines
looked like this:

x=$(($y/10))

We were indicated at the time that this is because the statement does
not use Bourne shell syntax, which is absolutely true, and also that the
manual warns about this, which is true again. So far everything is clear.

However, what confuses me is that even when the manual says that "you
can include an executable (Bourne) shell script configure in your
package" [1], the associated footnote says something slightly different:
"The script should only assume a POSIX-compliant /bin/sh" [2]. The
footnote goes even further, and links to the POSIX specification of the
Shell Command Language [3] (as published by The Open Group), which
explicitly includes arithmetic expressions like the one above in its
syntax [4].

My question then is: what exact dialect should be considered? Given that
the statement above does not work in the Bourne shell, I conclude that
the Bourne shell is not POSIX-compliant. That in turn would make the
manual ambiguous as to the precise dialect that should be used by our
configure scripts, and either the shells used by R should be changed to
be POSIX-compliants, or the manual edited to be more precise regarding .

Many thanks.

Rodrigo

[1]
https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Configure-and-cleanup
[2] https://cran.r-project.org/doc/manuals/r-release/R-exts.html#FOOT25
[3] http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html
[4]
http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_04


From thierry.onkelinx at inbo.be  Tue Dec 12 13:24:31 2017
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Tue, 12 Dec 2017 13:24:31 +0100
Subject: [R-pkg-devel] creating indelible file during unit test
Message-ID: <CAJuCY5wTrLE5GRKFE-_LYgTE7Mx23tfoV_OPxk6cYn_6SXV=TQ@mail.gmail.com>

Dear all,

Some function I wrote deletes a bunch of files. It is crucial that all
files get deleted. Hence it should return an error when one or more
files couldn't be deleted.

I'm writing a unit test for this function. I fail to create a file
that can't be deleted by the function. I've tried Sys.chmod(file,
"000") which didn't work.

Any suggestions?

Best regards,

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE
AND FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Kliniekstraat 25, B-1070 Brussel
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no
more than asking him to perform a post-mortem examination: he may be
able to say what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does
not ensure that a reasonable answer can be extracted from a given body
of data. ~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////


Van 14 tot en met 19 december 2017 verhuizen we uit onze vestiging in
Brussel naar het Herman Teirlinckgebouw op de site Thurn & Taxis.
Vanaf dan ben je welkom op het nieuwe adres: Havenlaan 88 bus 73, 1000 Brussel.


From i.ucar86 at gmail.com  Tue Dec 12 14:17:23 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Tue, 12 Dec 2017 14:17:23 +0100
Subject: [R-pkg-devel] creating indelible file during unit test
In-Reply-To: <CAJuCY5wTrLE5GRKFE-_LYgTE7Mx23tfoV_OPxk6cYn_6SXV=TQ@mail.gmail.com>
References: <CAJuCY5wTrLE5GRKFE-_LYgTE7Mx23tfoV_OPxk6cYn_6SXV=TQ@mail.gmail.com>
Message-ID: <CALEXWq2mrzD=ZSY_MYAG+FgOMoPxAJ7HBFYvoQpbSbqFRaP_KQ@mail.gmail.com>

2017-12-12 13:24 GMT+01:00 Thierry Onkelinx <thierry.onkelinx at inbo.be>:
> Dear all,
>
> Some function I wrote deletes a bunch of files. It is crucial that all
> files get deleted. Hence it should return an error when one or more
> files couldn't be deleted.
>
> I'm writing a unit test for this function. I fail to create a file
> that can't be deleted by the function. I've tried Sys.chmod(file,
> "000") which didn't work.
>
> Any suggestions?

Supposing you call file.remove at some point, what about the following:

file.remove <- function(...) { invisible() }
# test your function here, should issue an error
rm("file.remove")

I?aki


From mmccurdy01 at qub.ac.uk  Tue Dec 12 14:40:29 2017
From: mmccurdy01 at qub.ac.uk (Meabh McCurdy)
Date: Tue, 12 Dec 2017 13:40:29 +0000
Subject: [R-pkg-devel] Rcpp Copyright Query
Message-ID: <DB6PR0701MB17529DE30AC2F3381292F3439B340@DB6PR0701MB1752.eurprd07.prod.outlook.com>

Dear All,

I am currently in the process of submitting a new R package to CRAN. This package uses the Rcpp package, as stated in the 'LinkingTo' section of the Description file.
I am currently missing two copyright holders relating to the Rcpp package:
- Copyright (C) 2010 - 2012 Dirk Eddelbuettel and Romain Francois

As far as I am aware, if the copyright holders are not authors of the package an optional 'Copyright' field can be used. Is there a licensing file or copyright file for the Rcpp package that is required and I can include in my package under the inst directory.
I'm not entirely sure this is the correct solution , other suggestions are welcome.

Thanks in advance,
Meabh McCurdy

	[[alternative HTML version deleted]]


From b.rowlingson at lancaster.ac.uk  Tue Dec 12 15:47:06 2017
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 12 Dec 2017 14:47:06 +0000
Subject: [R-pkg-devel] creating indelible file during unit test
In-Reply-To: <CAJuCY5wTrLE5GRKFE-_LYgTE7Mx23tfoV_OPxk6cYn_6SXV=TQ@mail.gmail.com>
References: <CAJuCY5wTrLE5GRKFE-_LYgTE7Mx23tfoV_OPxk6cYn_6SXV=TQ@mail.gmail.com>
Message-ID: <CANVKczN_7ap0KO--HHJr+UJZ98O4vosRtS2DQq46LrTgc=jdNg@mail.gmail.com>

On Tue, Dec 12, 2017 at 12:24 PM, Thierry Onkelinx <thierry.onkelinx at inbo.be
> wrote:

> Dear all,
>
> Some function I wrote deletes a bunch of files. It is crucial that all
> files get deleted. Hence it should return an error when one or more
> files couldn't be deleted.
>
> I'm writing a unit test for this function. I fail to create a file
> that can't be deleted by the function. I've tried Sys.chmod(file,
> "000") which didn't work.
>
>
On a linux system the ability to remove a file is controlled by the
permissions on the directory that the file is in, so setting a file to any
permission doesn't affect your process's ability to delete it:

$ mkdir foo
$ touch foo/1
$ touch foo/2
$ rm foo/1
$ chmod a-w foo # remove write permission on the folder
$ rm foo/2
rm: cannot remove ?foo/2?: Permission denied


It might cause `rm` on the command line to warn you though:

 $ touch 000 ; chmod 000 000
 $  rm 000
 rm: remove write-protected regular empty file ?000?? y

- and its gone.

Depending on how your code is trying to delete things, it might be very
hard to create a file owned by you that it can't delete, since it might try
and change the permissions on non-writable directories.

Even things *not owned by you* can be deleted if you have permission on the
containing directory:

$ touch foo
$ ls -l
total 0
-rw-r--r-- 1 rowlings rowlings 0 Dec 12 14:38 foo
$ sudo chown root.root foo
$ ls -l
total 0
-rw-r--r-- 1 root root 0 Dec 12 14:38 foo
$ rm foo
rm: remove write-protected regular empty file ?foo?? y
$ ls -l
total 0


I think unix makes it impossible for you to create something that even you
can't delete. You may need higher powers ("root") to change the ownership
of the thing you've created.

There may be some other possibilities involving mount points or pipes that
can't get deleted until their processes die...

	[[alternative HTML version deleted]]


From edd at debian.org  Tue Dec 12 16:06:47 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 12 Dec 2017 09:06:47 -0600
Subject: [R-pkg-devel] Rcpp Copyright Query
In-Reply-To: <DB6PR0701MB17529DE30AC2F3381292F3439B340@DB6PR0701MB1752.eurprd07.prod.outlook.com>
References: <DB6PR0701MB17529DE30AC2F3381292F3439B340@DB6PR0701MB1752.eurprd07.prod.outlook.com>
Message-ID: <23087.61575.415250.965444@bud.eddelbuettel.com>


On 12 December 2017 at 13:40, Meabh McCurdy wrote:
| I am currently in the process of submitting a new R package to CRAN. This package uses the Rcpp package, as stated in the 'LinkingTo' section of the Description file.

So far no problem.

| I am currently missing two copyright holders relating to the Rcpp package:
| - Copyright (C) 2010 - 2012 Dirk Eddelbuettel and Romain Francois

"Missing"? Sorry, but who is missing what?

Presumably you are not _including_ Rcpp in your package and as such you are
not _(re-)distributing_ the sources over which other people have a copyright.

And for who those people are, see DESCRIPTION included with the package, not
debian/copyright (which is only in the source repo as I also happen to build
the Debian package from there but otherwise irrelevant to CRAN and not
installed in the CRAN sources).

| As far as I am aware, if the copyright holders are not authors of the package an optional 'Copyright' field can be used. Is there a licensing file or copyright file for the Rcpp package that is required and I can include in my package under the inst directory.
| I'm not entirely sure this is the correct solution , other suggestions are welcome.

I can't follow the logic of your argument.  Can you explain what I would have
to do with your package---other than maybe some pride and ownership in seeing
yet another package use Rcpp?  

Your code is your code, and (typically) copyrighted by you (or maybe your
employer) and possibly coauthors. And what license you choose is also up to
you provided is compatiable and allowed on CRAN.

"Writing R Extensions" delivers the goods on all that.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From i.ucar86 at gmail.com  Tue Dec 12 18:36:07 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Tue, 12 Dec 2017 18:36:07 +0100
Subject: [R-pkg-devel] creating indelible file during unit test
In-Reply-To: <CANVKczN_7ap0KO--HHJr+UJZ98O4vosRtS2DQq46LrTgc=jdNg@mail.gmail.com>
References: <CAJuCY5wTrLE5GRKFE-_LYgTE7Mx23tfoV_OPxk6cYn_6SXV=TQ@mail.gmail.com>
 <CANVKczN_7ap0KO--HHJr+UJZ98O4vosRtS2DQq46LrTgc=jdNg@mail.gmail.com>
Message-ID: <CALEXWq0WoJ-0R=H1UjFnWAgwrpHp8hsOr441c3iG_sHCLuudtQ@mail.gmail.com>

2017-12-12 15:47 GMT+01:00 Barry Rowlingson <b.rowlingson at lancaster.ac.uk>:
> I think unix makes it impossible for you to create something that even you
> can't delete. You may need higher powers ("root") to change the ownership
> of the thing you've created.

In a Unix system with administrator rights, you can set the immutable flag:

$ touch foo
$ chmod a-w foo
$ sudo chattr +i foo
$ rm foo
Operation not permitted

Otherwise, you can always remove your own files. Moreover, Thierry may
want the test to be cross-platform... So I think the easiest way to go
is to bypass the R function used to remove the files (file.remove,
unlink, whatever), run the test and then restore it.

I?aki


From tcwainw at gmail.com  Tue Dec 12 18:42:41 2017
From: tcwainw at gmail.com (Tom Wainwright)
Date: Tue, 12 Dec 2017 09:42:41 -0800
Subject: [R-pkg-devel] creating indelible file during unit test
In-Reply-To: <CAJuCY5wTrLE5GRKFE-_LYgTE7Mx23tfoV_OPxk6cYn_6SXV=TQ@mail.gmail.com>
References: <CAJuCY5wTrLE5GRKFE-_LYgTE7Mx23tfoV_OPxk6cYn_6SXV=TQ@mail.gmail.com>
Message-ID: <CAHHCy8HKDOEZahUeSBCA499AYtUpvqNwpH5zRRMXE7U8eXK1Bw@mail.gmail.com>

In *nix systems, permission to delete is at the directory level, not the
file level, so you might try changing the mode of the parent directory,
rather than the file itself, as in:

> dir.create('test')
> > file.create(file.path("test",'file1'))
> [1] TRUE
> > Sys.chmod("test", mode="0000")
> > file.remove(file.path("test",'file1'))
> [1] FALSE
> Warning message:
> In file.remove(file.path("test", "file1")) :
>   cannot remove file 'test/file1', reason 'Permission denied'
> > Sys.chmod("test", mode="0777")
> > file.remove(file.path("test",'file1'))
> [1] TRUE
> >
>

Not sure if this will work in Windows, though.

Regards,
  Tom Wainwright

On Tue, Dec 12, 2017 at 4:24 AM, Thierry Onkelinx <thierry.onkelinx at inbo.be>
wrote:

> Dear all,
>
> Some function I wrote deletes a bunch of files. It is crucial that all
> files get deleted. Hence it should return an error when one or more
> files couldn't be deleted.
>
> I'm writing a unit test for this function. I fail to create a file
> that can't be deleted by the function. I've tried Sys.chmod(file,
> "000") which didn't work.
>
> Any suggestions?
>
> Best regards,
>
> ir. Thierry Onkelinx
> Statisticus / Statistician
>
> Vlaamse Overheid / Government of Flanders
> INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE
> AND FOREST
> Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
> thierry.onkelinx at inbo.be
> Kliniekstraat 25, B-1070 Brussel
> www.inbo.be
>
> ////////////////////////////////////////////////////////////
> ///////////////////////////////
> To call in the statistician after the experiment is done may be no
> more than asking him to perform a post-mortem examination: he may be
> able to say what the experiment died of. ~ Sir Ronald Aylmer Fisher
> The plural of anecdote is not data. ~ Roger Brinner
> The combination of some data and an aching desire for an answer does
> not ensure that a reasonable answer can be extracted from a given body
> of data. ~ John Tukey
> ////////////////////////////////////////////////////////////
> ///////////////////////////////
>
>
> Van 14 tot en met 19 december 2017 verhuizen we uit onze vestiging in
> Brussel naar het Herman Teirlinckgebouw op de site Thurn & Taxis.
> Vanaf dan ben je welkom op het nieuwe adres: Havenlaan 88 bus 73, 1000
> Brussel.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Wed Dec 13 17:38:07 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 13 Dec 2017 17:38:07 +0100
Subject: [R-pkg-devel] Rcpp Copyright Query
In-Reply-To: <23087.61575.415250.965444@bud.eddelbuettel.com>
References: <DB6PR0701MB17529DE30AC2F3381292F3439B340@DB6PR0701MB1752.eurprd07.prod.outlook.com>
 <23087.61575.415250.965444@bud.eddelbuettel.com>
Message-ID: <a93f4554-afa6-7ca4-83ce-83da16437fdf@statistik.tu-dortmund.de>

This confusion was caused by the CRAN team, who wrote you (Meabh 
McCurdy) a message about adding missing copyright holders that should 
have gone to the maintainer of anotehr submission.

Our apologies.

Best,
Uwe Ligges




On 12.12.2017 16:06, Dirk Eddelbuettel wrote:
> 
> On 12 December 2017 at 13:40, Meabh McCurdy wrote:
> | I am currently in the process of submitting a new R package to CRAN. This package uses the Rcpp package, as stated in the 'LinkingTo' section of the Description file.
> 
> So far no problem.
> 
> | I am currently missing two copyright holders relating to the Rcpp package:
> | - Copyright (C) 2010 - 2012 Dirk Eddelbuettel and Romain Francois
> 
> "Missing"? Sorry, but who is missing what?
> 
> Presumably you are not _including_ Rcpp in your package and as such you are
> not _(re-)distributing_ the sources over which other people have a copyright.
> 
> And for who those people are, see DESCRIPTION included with the package, not
> debian/copyright (which is only in the source repo as I also happen to build
> the Debian package from there but otherwise irrelevant to CRAN and not
> installed in the CRAN sources).
> 
> | As far as I am aware, if the copyright holders are not authors of the package an optional 'Copyright' field can be used. Is there a licensing file or copyright file for the Rcpp package that is required and I can include in my package under the inst directory.
> | I'm not entirely sure this is the correct solution , other suggestions are welcome.
> 
> I can't follow the logic of your argument.  Can you explain what I would have
> to do with your package---other than maybe some pride and ownership in seeing
> yet another package use Rcpp?
> 
> Your code is your code, and (typically) copyrighted by you (or maybe your
> employer) and possibly coauthors. And what license you choose is also up to
> you provided is compatiable and allowed on CRAN.
> 
> "Writing R Extensions" delivers the goods on all that.
> 
> Dirk
>


From i.ucar86 at gmail.com  Thu Dec 14 00:58:56 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Thu, 14 Dec 2017 00:58:56 +0100
Subject: [R-pkg-devel] CRAN check FAIL due to pragmas in headers and code
Message-ID: <CALEXWq1g3YQS03ETuj4L5XOufa7kVSq9UMyrFyQ2+QJ4mLH8+g@mail.gmail.com>

Hi all,

Three days ago, Patrick Perry posted the following on R-devel:

2017-12-11 16:32 GMT+01:00 Patrick Perry <pperry at stern.nyu.edu>:
> A recent change to r-devel causes an R CMD check warning when a C file
> includes a "#pragma GCC diagnostic ignored" pragma:
> https://github.com/wch/r-source/commit/b76c8fd355a0f5b23d42aaf44a879cac0fc31fa4
> . This causes the CRAN checks for the "corpus" package to emit a warning:
> https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-fedora-clang/corpus-00check.html

I didn't pay much attention, but today I received a couple of emails
warning about my package failing on r-devel-linux-x86_64-debian (gcc
and clang) with the following message:

Check: pragmas in C/C++ headers and code
Result: FAIL

My package has no pragmas, but Rcpp, on which it depends, does. So
basically Rcpp and all packages depending on Rcpp are failing on that
flavors. Is this a new requirement for new submissions? Or should I
ignore these FAILs?

Regards,
I?aki


From edd at debian.org  Thu Dec 14 01:13:31 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 13 Dec 2017 18:13:31 -0600
Subject: [R-pkg-devel] CRAN check FAIL due to pragmas in headers and code
In-Reply-To: <CALEXWq1g3YQS03ETuj4L5XOufa7kVSq9UMyrFyQ2+QJ4mLH8+g@mail.gmail.com>
References: <CALEXWq1g3YQS03ETuj4L5XOufa7kVSq9UMyrFyQ2+QJ4mLH8+g@mail.gmail.com>
Message-ID: <23089.49707.466838.297910@bud.eddelbuettel.com>


On 14 December 2017 at 00:58, I?aki ?car wrote:
| Hi all,
| 
| Three days ago, Patrick Perry posted the following on R-devel:
| 
| 2017-12-11 16:32 GMT+01:00 Patrick Perry <pperry at stern.nyu.edu>:
| > A recent change to r-devel causes an R CMD check warning when a C file
| > includes a "#pragma GCC diagnostic ignored" pragma:
| > https://github.com/wch/r-source/commit/b76c8fd355a0f5b23d42aaf44a879cac0fc31fa4
| > . This causes the CRAN checks for the "corpus" package to emit a warning:
| > https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-fedora-clang/corpus-00check.html
| 
| I didn't pay much attention, but today I received a couple of emails
| warning about my package failing on r-devel-linux-x86_64-debian (gcc
| and clang) with the following message:
| 
| Check: pragmas in C/C++ headers and code
| Result: FAIL
| 
| My package has no pragmas, but Rcpp, on which it depends, does. So

But for the record (and using ag(1) as a better grep):

  edd at bud:~/git/rcpp(master)$ ag pragma
  inst/include/Rcpp/r/headers.h
  35:# pragma push_macro("major")
  40:# pragma push_macro("minor")
  45:# pragma push_macro("makedev")
  73:# pragma pop_macro("major")
  77:# pragma pop_macro("minor")
  81:# pragma pop_macro("makedev")
  
  inst/include/Rcpp/utils/tinyformat.h
  191:#       pragma warning(push)
  192:#       pragma warning(disable:4244)
  193:#       pragma warning(disable:4267)
  202:#       pragma warning(pop)

  inst/examples/OpenMP/OpenMPandInline.r
  62:#pragma omp parallel for shared(x, n)

  inst/examples/OpenMP/piWithInterrupts.cpp
  88:#pragma omp parallel for \
  edd at bud:~/git/rcpp(master)$

The ones in headers.h are innocent, the ones in tinyformat are #ifdef'ed away
for another OS, and the remaining two are for OpenMP.

So your statement "Rcpp does [have #pragma]" is narrowly correct, but still
totally irrelevant as the CRAN Policy issue (and recent change) is enirely
about _#pragma use to turn compiler diagnostics off_.  Which we don't do here. 

Dirk

| basically Rcpp and all packages depending on Rcpp are failing on that
| flavors. Is this a new requirement for new submissions? Or should I
| ignore these FAILs?
| 
| Regards,
| I?aki
| 
| ______________________________________________
| R-package-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-package-devel
-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From brodie.gaslam at yahoo.com  Thu Dec 14 02:54:04 2017
From: brodie.gaslam at yahoo.com (brodie gaslam)
Date: Thu, 14 Dec 2017 01:54:04 +0000 (UTC)
Subject: CRAN check FAIL due to pragmas in headers and code
References: <1989875603.5133626.1513216444135.ref@mail.yahoo.com>
Message-ID: <1989875603.5133626.1513216444135@mail.yahoo.com>

I too am seeing the same failure in my package.? It does not contain any #pragma directives, and it doesn't have any dependencies to other compiled packages.
Poking around through the CRAN checks I've found other packages with C compiled code displaying the same error on the clang and gcc 64 bit debian checks:
* diffobj: (my package) https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-clang/diffobj-00check.html* xts: https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-clang/xts-00check.html* backports: https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-clang/backports-00check.html
I'm pretty sure (but not certain) that my package did not throw these errors as of quite recently (I uploaded to CRAN over the weekend).

This leads me to think that it is (maybe) possible that this is an issue with the latest version of the check tool?
Best,
Brodie.

	[[alternative HTML version deleted]]


From csardi.gabor at gmail.com  Thu Dec 14 03:13:15 2017
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 14 Dec 2017 02:13:15 +0000
Subject: [R-pkg-devel] CRAN check FAIL due to pragmas in headers and code
In-Reply-To: <mailman.10475.1513217072.1577.r-package-devel@r-project.org>
References: <1989875603.5133626.1513216444135.ref@mail.yahoo.com>
 <mailman.10475.1513217072.1577.r-package-devel@r-project.org>
Message-ID: <CABtg=KmA3MiooiCqRA0JFz5ZBDLp310DCVYqsh6qmogiC-uv=Q@mail.gmail.com>

These are not check errors, but indeed a bug in the check tool:
https://github.com/wch/r-source/commit/c063350799e2209afe1c5b23915ee7b9a1606652#diff-4882a8c8e173bda109ed98da485e1428R8640

It has been fixed, so next R-devel build should be fine.

Gabor

On Thu, Dec 14, 2017 at 2:04 AM, brodie gaslam via R-package-devel
<r-package-devel at r-project.org> wrote:
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ---------- Forwarded message ----------
> From: brodie gaslam <brodie.gaslam at yahoo.com>
> To: List R-package-devel <r-package-devel at r-project.org>
> Cc:
> Bcc:
> Date: Thu, 14 Dec 2017 01:54:04 +0000 (UTC)
> Subject: RE: CRAN check FAIL due to pragmas in headers and code
> I too am seeing the same failure in my package.  It does not contain any #pragma directives, and it doesn't have any dependencies to other compiled packages.
> Poking around through the CRAN checks I've found other packages with C compiled code displaying the same error on the clang and gcc 64 bit debian checks:
> * diffobj: (my package) https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-clang/diffobj-00check.html* xts: https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-clang/xts-00check.html* backports: https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-clang/backports-00check.html
> I'm pretty sure (but not certain) that my package did not throw these errors as of quite recently (I uploaded to CRAN over the weekend).
>
> This leads me to think that it is (maybe) possible that this is an issue with the latest version of the check tool?
> Best,
> Brodie.
>
>         [[alternative HTML version deleted]]
>
>


From edd at debian.org  Thu Dec 14 03:17:37 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 13 Dec 2017 20:17:37 -0600
Subject: [R-pkg-devel] CRAN check FAIL due to pragmas in headers and code
In-Reply-To: <mailman.10475.1513217072.1577.r-package-devel@r-project.org>
References: <1989875603.5133626.1513216444135.ref@mail.yahoo.com>
 <mailman.10475.1513217072.1577.r-package-devel@r-project.org>
Message-ID: <23089.57153.538391.857872@bud.eddelbuettel.com>


On 14 December 2017 at 03:04, brodie gaslam via R-package-devel wrote:
| This leads me to think that it is (maybe) possible that this is an issue with the latest version of the check tool?

Which is what I tried to explain to Inaki when he first filed on as an Rcpp
issue ticket: Sometimes you need to put the stress on "devel" when you say
R-devel.

So I suspect these failures are transient.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From ligges at statistik.tu-dortmund.de  Thu Dec 14 10:00:12 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 14 Dec 2017 10:00:12 +0100
Subject: [R-pkg-devel] CRAN check FAIL due to pragmas in headers and code
In-Reply-To: <CALEXWq1g3YQS03ETuj4L5XOufa7kVSq9UMyrFyQ2+QJ4mLH8+g@mail.gmail.com>
References: <CALEXWq1g3YQS03ETuj4L5XOufa7kVSq9UMyrFyQ2+QJ4mLH8+g@mail.gmail.com>
Message-ID: <83e7f231-1a9e-140d-0ea9-96594fd73567@statistik.tu-dortmund.de>



On 14.12.2017 00:58, I?aki ?car wrote:
> Hi all,
> 
> Three days ago, Patrick Perry posted the following on R-devel:
> 
> 2017-12-11 16:32 GMT+01:00 Patrick Perry <pperry at stern.nyu.edu>:
>> A recent change to r-devel causes an R CMD check warning when a C file
>> includes a "#pragma GCC diagnostic ignored" pragma:
>> https://github.com/wch/r-source/commit/b76c8fd355a0f5b23d42aaf44a879cac0fc31fa4
>> . This causes the CRAN checks for the "corpus" package to emit a warning:
>> https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-fedora-clang/corpus-00check.html
> 
> I didn't pay much attention, but today I received a couple of emails
> warning about my package failing on r-devel-linux-x86_64-debian (gcc
> and clang) with the following message:
> 
> Check: pragmas in C/C++ headers and code
> Result: FAIL

A temporary glitch in R-devel that has been fixed yesterday already.

Best,
Uwe Ligges


> 
> My package has no pragmas, but Rcpp, on which it depends, does. So
> basically Rcpp and all packages depending on Rcpp are failing on that
> flavors. Is this a new requirement for new submissions? Or should I
> ignore these FAILs?
> 
> Regards,
> I?aki
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From Rowan.Haigh at dfo-mpo.gc.ca  Thu Dec 14 18:58:58 2017
From: Rowan.Haigh at dfo-mpo.gc.ca (Haigh, Rowan)
Date: Thu, 14 Dec 2017 17:58:58 +0000
Subject: [R-pkg-devel] Trouble installing XML on Windows 7 (64-bit)
Message-ID: <15DBC0E2A2B8FA49A2369A499E7651360CA03D04@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>

I maintain a few packages on CRAN, one of which depends on the XML package.
Using the latest R-devel (2017-12-13 r73907), I can install the XML Windows binary from CRAN but I cannot load it:

> require(XML)
Loading required package: XML
Error: package or namespace load failed for 'XML':
package 'XML' was installed by an R version with different internals; it needs to be reinstalled for use with this R version

I tried installing XML from source, but the compilation requires the libxml library.
Following the suggestions of various online users, I've tried putting libxml header files from different sources (www.omegahat.net/RSXML/<http://www.omegahat.net/RSXML/>, https://git.gnome.org/browse/libxml2/) in the R-devel/include/libxml directory, but C compilation fails (not surprisingly).

I'm not a C programmer and would appreciate any help on how to install the R package XML from source on a Windows system.
Thank-you.

Rowan Haigh
--------------------------------------------------------------------------------------------------
Research Biologist, Pacific Biological Station, Nanaimo, BC V9T 6N7
Offshore Section, Aquatic Resources Research & Assessment Division, Fisheries and Oceans Canada
tel. +1 250-363-8718 (IOS Rm 2443), fac simile +1 250-756-7053 (PBS), email rowan.haigh at dfo-mpo.gc.ca<mailto:rowan.haigh at dfo-mpo.gc.ca>
--------------------------------------------------------------------------------------------------
Biologiste de recherche, Station biologique du Pacifique, Nanaimo, C.-B. V9T 6N7
Section extrac?tier, Division de la recherche sur les ressources aquatiques et de l'?valuation, P?ches et Oc?ans Canada
t?l. +1 250-363-8718 (ISM ch 2443), t?l?copie +1 250-756-7053 (SBP), courriel rowan.haigh at dfo-mpo.gc.ca<mailto:rowan.haigh at dfo-mpo.gc.ca>
--------------------------------------------------------------------------------------------------


	[[alternative HTML version deleted]]


From csardi.gabor at gmail.com  Thu Dec 14 19:19:03 2017
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 14 Dec 2017 18:19:03 +0000
Subject: [R-pkg-devel] Trouble installing XML on Windows 7 (64-bit)
In-Reply-To: <15DBC0E2A2B8FA49A2369A499E7651360CA03D04@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
References: <15DBC0E2A2B8FA49A2369A499E7651360CA03D04@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
Message-ID: <CABtg=Km6YcDXHiO2Tw6Xdkz_fw5-FH1_B4Wo+r+NL_bOw4Sx2Q@mail.gmail.com>

Those packages were built for R-release. There are no appropriate
windows binaries for R-devel on CRAN currently. You need to
compile/install the source package:

install.packages("XML", type = "source")

Gabor

On Thu, Dec 14, 2017 at 5:58 PM, Haigh, Rowan <Rowan.Haigh at dfo-mpo.gc.ca> wrote:
> I maintain a few packages on CRAN, one of which depends on the XML package.
> Using the latest R-devel (2017-12-13 r73907), I can install the XML Windows binary from CRAN but I cannot load it:
>
>> require(XML)
> Loading required package: XML
> Error: package or namespace load failed for 'XML':
> package 'XML' was installed by an R version with different internals; it needs to be reinstalled for use with this R version
>
> I tried installing XML from source, but the compilation requires the libxml library.
> Following the suggestions of various online users, I've tried putting libxml header files from different sources (www.omegahat.net/RSXML/<http://www.omegahat.net/RSXML/>, https://git.gnome.org/browse/libxml2/) in the R-devel/include/libxml directory, but C compilation fails (not surprisingly).
>
> I'm not a C programmer and would appreciate any help on how to install the R package XML from source on a Windows system.
> Thank-you.
>
> Rowan Haigh
> --------------------------------------------------------------------------------------------------
> Research Biologist, Pacific Biological Station, Nanaimo, BC V9T 6N7
> Offshore Section, Aquatic Resources Research & Assessment Division, Fisheries and Oceans Canada
> tel. +1 250-363-8718 (IOS Rm 2443), fac simile +1 250-756-7053 (PBS), email rowan.haigh at dfo-mpo.gc.ca<mailto:rowan.haigh at dfo-mpo.gc.ca>
> --------------------------------------------------------------------------------------------------
> Biologiste de recherche, Station biologique du Pacifique, Nanaimo, C.-B. V9T 6N7
> Section extrac?tier, Division de la recherche sur les ressources aquatiques et de l'?valuation, P?ches et Oc?ans Canada
> t?l. +1 250-363-8718 (ISM ch 2443), t?l?copie +1 250-756-7053 (SBP), courriel rowan.haigh at dfo-mpo.gc.ca<mailto:rowan.haigh at dfo-mpo.gc.ca>
> --------------------------------------------------------------------------------------------------
>
>
>         [[alternative HTML version deleted]]
>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch.duncan at gmail.com  Thu Dec 14 19:22:36 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 14 Dec 2017 13:22:36 -0500
Subject: [R-pkg-devel] Trouble installing XML on Windows 7 (64-bit)
In-Reply-To: <15DBC0E2A2B8FA49A2369A499E7651360CA03D04@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
References: <15DBC0E2A2B8FA49A2369A499E7651360CA03D04@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
Message-ID: <0648b54a-cb55-4641-096f-ce55fd60f02a@gmail.com>

On 14/12/2017 12:58 PM, Haigh, Rowan wrote:
> I maintain a few packages on CRAN, one of which depends on the XML package.
> Using the latest R-devel (2017-12-13 r73907), I can install the XML Windows binary from CRAN but I cannot load it:

How exactly did you install XML, and how did you install R-devel?  There 
are several different binary versions of XML on CRAN, and lots of ways 
to build or download R-devel.

I am currently building a copy of R-devel, and will try using

install.packages("XML")

to see if I can reproduce your problem.  I'm not certain my locally 
built copy will match the CRAN binary of R-devel, but we'll see.

Duncan Murdoch

> 
>> require(XML)
> Loading required package: XML
> Error: package or namespace load failed for 'XML':
> package 'XML' was installed by an R version with different internals; it needs to be reinstalled for use with this R version
> 
> I tried installing XML from source, but the compilation requires the libxml library.
> Following the suggestions of various online users, I've tried putting libxml header files from different sources (www.omegahat.net/RSXML/<http://www.omegahat.net/RSXML/>, https://git.gnome.org/browse/libxml2/) in the R-devel/include/libxml directory, but C compilation fails (not surprisingly).
> 
> I'm not a C programmer and would appreciate any help on how to install the R package XML from source on a Windows system.
> Thank-you.
> 
> Rowan Haigh
> --------------------------------------------------------------------------------------------------
> Research Biologist, Pacific Biological Station, Nanaimo, BC V9T 6N7
> Offshore Section, Aquatic Resources Research & Assessment Division, Fisheries and Oceans Canada
> tel. +1 250-363-8718 (IOS Rm 2443), fac simile +1 250-756-7053 (PBS), email rowan.haigh at dfo-mpo.gc.ca<mailto:rowan.haigh at dfo-mpo.gc.ca>
> --------------------------------------------------------------------------------------------------
> Biologiste de recherche, Station biologique du Pacifique, Nanaimo, C.-B. V9T 6N7
> Section extrac?tier, Division de la recherche sur les ressources aquatiques et de l'?valuation, P?ches et Oc?ans Canada
> t?l. +1 250-363-8718 (ISM ch 2443), t?l?copie +1 250-756-7053 (SBP), courriel rowan.haigh at dfo-mpo.gc.ca<mailto:rowan.haigh at dfo-mpo.gc.ca>
> --------------------------------------------------------------------------------------------------
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From thierry.onkelinx at inbo.be  Thu Dec 14 21:20:25 2017
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Thu, 14 Dec 2017 21:20:25 +0100
Subject: [R-pkg-devel] creating indelible file during unit test
In-Reply-To: <CAHHCy8HKDOEZahUeSBCA499AYtUpvqNwpH5zRRMXE7U8eXK1Bw@mail.gmail.com>
References: <CAJuCY5wTrLE5GRKFE-_LYgTE7Mx23tfoV_OPxk6cYn_6SXV=TQ@mail.gmail.com>
 <CAHHCy8HKDOEZahUeSBCA499AYtUpvqNwpH5zRRMXE7U8eXK1Bw@mail.gmail.com>
Message-ID: <CAJuCY5yus2mmpO+5h=VsFcQx8VMkt0t8MA337kP640hANFxaZg@mail.gmail.com>

Thanks for the replies to my question.

My function uses first list.files() to select the relevant files and
then file.remove() to delete them.

Redefining file.remove() doesn't work in case of a package due to
lexical scoping. Otherwise this would be a simple and portable
solution.

Having a Linux only solution is better than no solution at all. And it
should be sufficient. Note that I had to use Sys.chmod("test",
mode="0400") instead of Sys.chmod("test", mode="0000") because
list.files() needs at least read permission.

The Linux only unit test can be bypassed on other systems with
testthat::skip_on_os().

Best regards,

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE
AND FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Kliniekstraat 25, B-1070 Brussel
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no
more than asking him to perform a post-mortem examination: he may be
able to say what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does
not ensure that a reasonable answer can be extracted from a given body
of data. ~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////


Van 14 tot en met 19 december 2017 verhuizen we uit onze vestiging in
Brussel naar het Herman Teirlinckgebouw op de site Thurn & Taxis.
Vanaf dan ben je welkom op het nieuwe adres: Havenlaan 88 bus 73, 1000 Brussel.

///////////////////////////////////////////////////////////////////////////////////////////



2017-12-12 18:42 GMT+01:00 Tom Wainwright <tcwainw at gmail.com>:
> In *nix systems, permission to delete is at the directory level, not the
> file level, so you might try changing the mode of the parent directory,
> rather than the file itself, as in:
>
>> > dir.create('test')
>> > file.create(file.path("test",'file1'))
>> [1] TRUE
>> > Sys.chmod("test", mode="0000")
>> > file.remove(file.path("test",'file1'))
>> [1] FALSE
>> Warning message:
>> In file.remove(file.path("test", "file1")) :
>>   cannot remove file 'test/file1', reason 'Permission denied'
>> > Sys.chmod("test", mode="0777")
>> > file.remove(file.path("test",'file1'))
>> [1] TRUE
>> >
>
>
> Not sure if this will work in Windows, though.
>
> Regards,
>   Tom Wainwright
>
> On Tue, Dec 12, 2017 at 4:24 AM, Thierry Onkelinx <thierry.onkelinx at inbo.be>
> wrote:
>>
>> Dear all,
>>
>> Some function I wrote deletes a bunch of files. It is crucial that all
>> files get deleted. Hence it should return an error when one or more
>> files couldn't be deleted.
>>
>> I'm writing a unit test for this function. I fail to create a file
>> that can't be deleted by the function. I've tried Sys.chmod(file,
>> "000") which didn't work.
>>
>> Any suggestions?
>>
>> Best regards,
>>
>> ir. Thierry Onkelinx
>> Statisticus / Statistician
>>
>> Vlaamse Overheid / Government of Flanders
>> INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE
>> AND FOREST
>> Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
>> thierry.onkelinx at inbo.be
>> Kliniekstraat 25, B-1070 Brussel
>> www.inbo.be
>>
>>
>> ///////////////////////////////////////////////////////////////////////////////////////////
>> To call in the statistician after the experiment is done may be no
>> more than asking him to perform a post-mortem examination: he may be
>> able to say what the experiment died of. ~ Sir Ronald Aylmer Fisher
>> The plural of anecdote is not data. ~ Roger Brinner
>> The combination of some data and an aching desire for an answer does
>> not ensure that a reasonable answer can be extracted from a given body
>> of data. ~ John Tukey
>>
>> ///////////////////////////////////////////////////////////////////////////////////////////
>>
>>
>> Van 14 tot en met 19 december 2017 verhuizen we uit onze vestiging in
>> Brussel naar het Herman Teirlinckgebouw op de site Thurn & Taxis.
>> Vanaf dan ben je welkom op het nieuwe adres: Havenlaan 88 bus 73, 1000
>> Brussel.
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>


From rtobar at icrar.org  Fri Dec 15 09:20:21 2017
From: rtobar at icrar.org (Rodrigo Tobar)
Date: Fri, 15 Dec 2017 16:20:21 +0800
Subject: [R-pkg-devel] Dialect for shell scripts
In-Reply-To: <4576fdbc-5257-61f1-0841-7a4a3ffd24f9@icrar.org>
References: <4576fdbc-5257-61f1-0841-7a4a3ffd24f9@icrar.org>
Message-ID: <befad280-8910-e3e3-b92e-156413af659a@icrar.org>

Hi all,

I'm just bumping this up in case somebody can shed any light on it -- 
otherwise I will try again to submit this question to r-devel.

Regards,

Rodrigo

On 12/12/17 06:56, Rodrigo Tobar wrote:
> Dear all,
> 
> During a recent package submission, we were highlighted that some lines
> in our configure script didn't follow the correct syntax. The lines
> looked like this:
> 
> x=$(($y/10))
> 
> We were indicated at the time that this is because the statement does
> not use Bourne shell syntax, which is absolutely true, and also that the
> manual warns about this, which is true again. So far everything is clear.
> 
> However, what confuses me is that even when the manual says that "you
> can include an executable (Bourne) shell script configure in your
> package" [1], the associated footnote says something slightly different:
> "The script should only assume a POSIX-compliant /bin/sh" [2]. The
> footnote goes even further, and links to the POSIX specification of the
> Shell Command Language [3] (as published by The Open Group), which
> explicitly includes arithmetic expressions like the one above in its
> syntax [4].
> 
> My question then is: what exact dialect should be considered? Given that
> the statement above does not work in the Bourne shell, I conclude that
> the Bourne shell is not POSIX-compliant. That in turn would make the
> manual ambiguous as to the precise dialect that should be used by our
> configure scripts, and either the shells used by R should be changed to
> be POSIX-compliants, or the manual edited to be more precise regarding .
> 
> Many thanks.
> 
> Rodrigo
> 
> [1]
> https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Configure-and-cleanup
> [2] https://cran.r-project.org/doc/manuals/r-release/R-exts.html#FOOT25
> [3] http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html
> [4]
> http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_04
>


From Rowan.Haigh at dfo-mpo.gc.ca  Fri Dec 15 18:02:40 2017
From: Rowan.Haigh at dfo-mpo.gc.ca (Haigh, Rowan)
Date: Fri, 15 Dec 2017 17:02:40 +0000
Subject: [R-pkg-devel] Trouble installing XML on Windows 7 (64-bit)
In-Reply-To: <e803e47c-41e9-7b2e-f438-67cbfe9e1d1d@gmail.com>
References: <15DBC0E2A2B8FA49A2369A499E7651360CA03D04@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
 <0648b54a-cb55-4641-096f-ce55fd60f02a@gmail.com>
 <15DBC0E2A2B8FA49A2369A499E7651360CA03D65@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
 <e803e47c-41e9-7b2e-f438-67cbfe9e1d1d@gmail.com>
Message-ID: <15DBC0E2A2B8FA49A2369A499E7651360CA03E54@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>

Hi Duncan,

Well I finally managed to install XML from source in Windows under R-devel. Basically it was a clue provided by user wlandau-lilly (last message on https://github.com/igraph/igraph/issues/915), and discussions between G?bor and user stewid (https://github.com/krlmlr-archive/r-portable/issues/3#issuecomment-72928971) that lead to success.

1. Download local323.zip from http://www.stats.ox.ac.uk/pub/Rtools/libs.html ;
 
2. Copy the files in local323.zip/include/libxml2/libxml/ directory to R-devel/include/libxml/ ;

3. Copy entire contents of local323.zip (directories include/ and lib/) to new directory C:/Apps/R/Rtools/local323/ ;

4. Change line 31 of two files `Makeconf' (in C:/Apps/R/Rdev/etc/i386/ and C:/Apps/R/Rdev/etc/x64/),  from `#LOCAL_SOFT' to `LOCAL_SOFT = C:/Apps/R/Rtools/local323'  ;

5. In R-devel, issue command `install.packages("XML", type = "source")'.

Cheers, Rowan
Tel. (250) 363-8718

-----Original Message-----
From: Duncan Murdoch [mailto:murdoch.duncan at gmail.com] 
Sent: Thursday, December 14, 2017 3:29 PM
To: Haigh, Rowan
Subject: Re: [R-pkg-devel] Trouble installing XML on Windows 7 (64-bit)

On 14/12/2017 1:59 PM, Haigh, Rowan wrote:
> Hi Duncan,
> R-devel I downloaded via FTP to CRAN base. In Windows it's simply a right click on the executable and "Run as administrator".
> 
> For the XML package, I tried `install.packages("XML")', which succeeded, but the require(XML) command gave the message I reported below. This inability to load the package stops me Rchecking my package.
> 
> Gabor suggested (and I had already tried):
> 
> install.packages("XML", type = "source")
> 
> but this just gave me:
> 
> C:/Apps/R/Rtools/mingw_32/bin/gcc  -I"C:/Apps/R/Rdev/include" -DNDEBUG -I/include/libxml2 -I/include -D_R_=1 -DUSE_R=1 -DUSE_XML_VERSION_H=1 -DLIBXML -DUSE_EXTERNAL_SUBSET=1 -DROOT_HAS_DTD_NODE=1 -DUMP_WITH_ENCODING=1 -DXML_ELEMENT_ETYPE=1  -DXML_ATTRIBUTE_ATYPE=1 -DLIBXML2=1 -DHAVE_XML_HAS_FEATURE -DLIBXML_STATIC         -O3 -Wall  -std=gnu99 -mtune=generic -c DocParse.c -o DocParse.o
> In file included from DocParse.c:10:0:
> DocParse.h:18:27: fatal error: libxml/parser.h: No such file or directory
>   #include <libxml/parser.h>
> 
> which seems to call for something needed in the `include' directory.
> 
> My problem is that I don't know what source files to put in the include directory form libxml for building XML from source. If libxml needs to be installed first, I'm not sure how to let the R install process know about the installation of libxml (or even how it handles the dual architecture).

Yes, I saw his message.  I think it's a CRAN issue that they are 
distributing 3.4 binaries for R-devel, when they are known to be 
incompatible.

Re building from source on Windows:  I used to know how to do that, but 
I don't do it any more.  I don't know if anyone really knows how these 
days.  I'd like to suggest abandoning that horrible platform, but that's 
likely not an option.  You can complain to Microsoft (perhaps MRAN has 
binary builds that work), but that likely won't lead anywhere.

So I'm afraid I can't help you.

Duncan Murdoch

> 
> Cheers.
> 
> -----Original Message-----
> From: Duncan Murdoch [mailto:murdoch.duncan at gmail.com]
> Sent: Thursday, December 14, 2017 10:23 AM
> To: Haigh, Rowan; r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] Trouble installing XML on Windows 7 (64-bit)
> 
> On 14/12/2017 12:58 PM, Haigh, Rowan wrote:
>> I maintain a few packages on CRAN, one of which depends on the XML package.
>> Using the latest R-devel (2017-12-13 r73907), I can install the XML Windows binary from CRAN but I cannot load it:
> 
> How exactly did you install XML, and how did you install R-devel?  There
> are several different binary versions of XML on CRAN, and lots of ways
> to build or download R-devel.
> 
> I am currently building a copy of R-devel, and will try using
> 
> install.packages("XML")
> 
> to see if I can reproduce your problem.  I'm not certain my locally
> built copy will match the CRAN binary of R-devel, but we'll see.
> 
> Duncan Murdoch
> 
>>
>>> require(XML)
>> Loading required package: XML
>> Error: package or namespace load failed for 'XML':
>> package 'XML' was installed by an R version with different internals; it needs to be reinstalled for use with this R version
>>
>> I tried installing XML from source, but the compilation requires the libxml library.
>> Following the suggestions of various online users, I've tried putting libxml header files from different sources (www.omegahat.net/RSXML/<http://www.omegahat.net/RSXML/>, https://git.gnome.org/browse/libxml2/) in the R-devel/include/libxml directory, but C compilation fails (not surprisingly).
>>
>> I'm not a C programmer and would appreciate any help on how to install the R package XML from source on a Windows system.
>> Thank-you.
>>
>> Rowan Haigh
>> --------------------------------------------------------------------------------------------------
>> Research Biologist, Pacific Biological Station, Nanaimo, BC V9T 6N7
>> Offshore Section, Aquatic Resources Research & Assessment Division, Fisheries and Oceans Canada
>> tel. +1 250-363-8718 (IOS Rm 2443), fac simile +1 250-756-7053 (PBS), email rowan.haigh at dfo-mpo.gc.ca<mailto:rowan.haigh at dfo-mpo.gc.ca>
>> --------------------------------------------------------------------------------------------------
>> Biologiste de recherche, Station biologique du Pacifique, Nanaimo, C.-B. V9T 6N7
>> Section extrac?tier, Division de la recherche sur les ressources aquatiques et de l'?valuation, P?ches et Oc?ans Canada
>> t?l. +1 250-363-8718 (ISM ch 2443), t?l?copie +1 250-756-7053 (SBP), courriel rowan.haigh at dfo-mpo.gc.ca<mailto:rowan.haigh at dfo-mpo.gc.ca>
>> --------------------------------------------------------------------------------------------------
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 


From avraham.adler at gmail.com  Fri Dec 15 18:48:24 2017
From: avraham.adler at gmail.com (Avraham Adler)
Date: Fri, 15 Dec 2017 12:48:24 -0500
Subject: [R-pkg-devel] Trouble installing XML on Windows 7 (64-bit)
In-Reply-To: <15DBC0E2A2B8FA49A2369A499E7651360CA03E54@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
References: <15DBC0E2A2B8FA49A2369A499E7651360CA03D04@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
 <0648b54a-cb55-4641-096f-ce55fd60f02a@gmail.com>
 <15DBC0E2A2B8FA49A2369A499E7651360CA03D65@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
 <e803e47c-41e9-7b2e-f438-67cbfe9e1d1d@gmail.com>
 <15DBC0E2A2B8FA49A2369A499E7651360CA03E54@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
Message-ID: <CAL6gwnJEKHG38aywjXTJy8YJfD41W2kJuO+rXB2jVCHa=-0T4Q@mail.gmail.com>

On Fri, Dec 15, 2017 at 12:02 PM, Haigh, Rowan
<Rowan.Haigh at dfo-mpo.gc.ca> wrote:
> Hi Duncan,
>
> Well I finally managed to install XML from source in Windows under R-devel. Basically it was a clue provided by user wlandau-lilly (last message on https://github.com/igraph/igraph/issues/915), and discussions between G?bor and user stewid (https://github.com/krlmlr-archive/r-portable/issues/3#issuecomment-72928971) that lead to success.
>
> 1. Download local323.zip from http://www.stats.ox.ac.uk/pub/Rtools/libs.html ;
>
> 2. Copy the files in local323.zip/include/libxml2/libxml/ directory to R-devel/include/libxml/ ;
>
> 3. Copy entire contents of local323.zip (directories include/ and lib/) to new directory C:/Apps/R/Rtools/local323/ ;
>
> 4. Change line 31 of two files `Makeconf' (in C:/Apps/R/Rdev/etc/i386/ and C:/Apps/R/Rdev/etc/x64/),  from `#LOCAL_SOFT' to `LOCAL_SOFT = C:/Apps/R/Rtools/local323'  ;
>
> 5. In R-devel, issue command `install.packages("XML", type = "source")'.
>

Sorry I didn't see this earlier. I've been building R from source on
Windows for years, although XML is one of the three packages I usually
build from binary (the other two being stringi and BH).

As per the instructions (which also tell you where to get the extras)
[1], you don't need to change MakeConf. You need to copy Mkrules.dist
to Mkrules.local and set LOCAL_SOFT to the directory you need and then
ensure EXT_LIBS = $(LOCAL_SOFT) is active. And yes, you need to put
the extra goodies in RLocalSoft (EXCEPT for Tcl), and that includes
Curl and ICU if you want to include that support.

Thanks,

Avi

[1] https://cran.r-project.org/doc/manuals/R-admin.html#Building-from-source


From Rowan.Haigh at dfo-mpo.gc.ca  Fri Dec 15 23:47:18 2017
From: Rowan.Haigh at dfo-mpo.gc.ca (Haigh, Rowan)
Date: Fri, 15 Dec 2017 22:47:18 +0000
Subject: [R-pkg-devel] Trouble installing XML on Windows 7 (64-bit)
In-Reply-To: <CAL6gwnJWX92eBk2C16ze6qhcZU5gkXjP4zy9C39BmNxZXP7cqw@mail.gmail.com>
References: <15DBC0E2A2B8FA49A2369A499E7651360CA03D04@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
 <0648b54a-cb55-4641-096f-ce55fd60f02a@gmail.com>
 <15DBC0E2A2B8FA49A2369A499E7651360CA03D65@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
 <e803e47c-41e9-7b2e-f438-67cbfe9e1d1d@gmail.com>
 <15DBC0E2A2B8FA49A2369A499E7651360CA03E54@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
 <CAL6gwnJEKHG38aywjXTJy8YJfD41W2kJuO+rXB2jVCHa=-0T4Q@mail.gmail.com>
 <15DBC0E2A2B8FA49A2369A499E7651360CA03EC0@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>
 <CAL6gwnJWX92eBk2C16ze6qhcZU5gkXjP4zy9C39BmNxZXP7cqw@mail.gmail.com>
Message-ID: <15DBC0E2A2B8FA49A2369A499E7651360CA03FB5@DFBCV9TWPEXP001.ENT.dfo-mpo.ca>

Hi Avi,
Thank-you so much for your help. It took me a long time to figure it out but your suggestion was a great start. The trick in the end was to define the variable LIB_CURL in the Makeconf files to be the same as CURL_PATH. The package source build routine just did not recognise the latter variable,  but after inspecting the file `Makevars.win' in the RCurl/src/ directory, I guessed that this variable needed to be set to the location I had copied the curl goodies to.  (FMI: curl-7.40.0.zip obtained from http://www.stats.ox.ac.uk/pub/Rtools/goodies/multilib/).

You're a star Avi! Thanks again.

# set to use libcurl
USE_LIBCURL = YES
# path to parent of libcurl headers
CURL_PATH = C:/Apps/R/Rtools/curl7400
LIB_CURL  = C:/Apps/R/Rtools/curl7400
# libs: for 32-bit
# CURL_LIBS = -lcurl -lrtmp -lssl -lssh2 -lcrypto -lgdi32 -lcrypt32 -lz -lws2_32 -lgdi32 -lcrypt32 -lwldap32 -lwinmm -lidn
# libs: for 64-bit
CURL_LIBS = -lcurl -lrtmp -lssl -lssh2 -lcrypto -lgdi32 -lcrypt32 -lz -lws2_32 -lgdi32 -lcrypt32 -lwldap32 -lwinmm

Cheers, Rowan

From: Avraham Adler [mailto:avraham.adler at gmail.com]
Sent: Friday, December 15, 2017 12:11 PM
To: Haigh, Rowan
Subject: Re: [R-pkg-devel] Trouble installing XML on Windows 7 (64-bit)

I always build R from source, so that doesn?t affect me directly. I suggest you copy the lines relating to CURL out of Mkrules.dist, populate them (you?ll need 3 of the 4, 1 depends on 32/64) to your makeconf somewhere like you did for XML.

Good luck!

Avi

On Fri, Dec 15, 2017 at 1:22 PM Haigh, Rowan <Rowan.Haigh at dfo-mpo.gc.ca<mailto:Rowan.Haigh at dfo-mpo.gc.ca>> wrote:
Thanks Avi,
I wasn't rebuilding R, just getting the existing R-devel to install XML from source. I don't see any Mkrules in the compiled version of R-devel.

On a related issue, I now need to install RCurl from source but I have not yet found an obvious way to tell Makeconf how to find the files in `curl-7.40.0.zip' in addition to those in `local323.zip'.

These were never issues in previous builds of R-devel. The Windows binary packages from CRAN were usually compatible with R-devel.

Cheers, Rowan
Tel. (250) 363-8718


-----Original Message-----
From: Avraham Adler [mailto:avraham.adler at gmail.com<mailto:avraham.adler at gmail.com>]
Sent: Friday, December 15, 2017 9:48 AM
To: Haigh, Rowan; R Package Development
Subject: Re: [R-pkg-devel] Trouble installing XML on Windows 7 (64-bit)

On Fri, Dec 15, 2017 at 12:02 PM, Haigh, Rowan
<Rowan.Haigh at dfo-mpo.gc.ca<mailto:Rowan.Haigh at dfo-mpo.gc.ca>> wrote:
> Hi Duncan,
>
> Well I finally managed to install XML from source in Windows under R-devel. Basically it was a clue provided by user wlandau-lilly (last message on https://github.com/igraph/igraph/issues/915), and discussions between G?bor and user stewid (https://github.com/krlmlr-archive/r-portable/issues/3#issuecomment-72928971) that lead to success.
>
> 1. Download local323.zip from http://www.stats.ox.ac.uk/pub/Rtools/libs.html ;
>
> 2. Copy the files in local323.zip/include/libxml2/libxml/ directory to R-devel/include/libxml/ ;
>
> 3. Copy entire contents of local323.zip (directories include/ and lib/) to new directory C:/Apps/R/Rtools/local323/ ;
>
> 4. Change line 31 of two files `Makeconf' (in C:/Apps/R/Rdev/etc/i386/ and C:/Apps/R/Rdev/etc/x64/),  from `#LOCAL_SOFT' to `LOCAL_SOFT = C:/Apps/R/Rtools/local323'  ;
>
> 5. In R-devel, issue command `install.packages("XML", type = "source")'.
>

Sorry I didn't see this earlier. I've been building R from source on
Windows for years, although XML is one of the three packages I usually
build from binary (the other two being stringi and BH).

As per the instructions (which also tell you where to get the extras)
[1], you don't need to change MakeConf. You need to copy Mkrules.dist
to Mkrules.local and set LOCAL_SOFT to the directory you need and then
ensure EXT_LIBS = $(LOCAL_SOFT) is active. And yes, you need to put
the extra goodies in RLocalSoft (EXCEPT for Tcl), and that includes
Curl and ICU if you want to include that support.

Thanks,

Avi

[1] https://cran.r-project.org/doc/manuals/R-admin.html#Building-from-source
--
Sent from Gmail Mobile

	[[alternative HTML version deleted]]


From Chris.Brien at unisa.edu.au  Sat Dec 16 05:52:30 2017
From: Chris.Brien at unisa.edu.au (Chris Brien)
Date: Sat, 16 Dec 2017 04:52:30 +0000
Subject: [R-pkg-devel] Problem enhancing a package with a predict method not
 declared to be an S3 method
Message-ID: <b1279f33ba394ca09f953658470ea820@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>

Dear list members,

I am in a bind.

I have a package asremlPlus that "Enhances" the commercial package asreml (and asreml4), for which I am not a maintainer. It is not available in a public repository and because of this, when checking it for CRAN, it always gives the following NOTE, which is acceptable to CRAN:

Suggests or Enhances not in mainstream repositories:
  asreml, asreml4

Now asreml has three functions summary.asreml, fitted.asreml and predict.asreml that are (i) not exported and (ii) not declared to be S3 methods. In spite of this it is possible to call them using summary, fitted and predict.

However, if I do this in the code then the suite of unit tests that I have for asremlPlus fails when run with testthat::test_check with the following Error:

?[31m1. Error: predictPlus.asreml (@testPredictionsPresentation.r#17) ?[39m---------------
could not find function "ie"
1: predictPlus.asreml(classify = "Sources:Type", asreml.obj = current.asr, tables = "none",
wald.tab = current.asrt$wald.tab, present = c("Type", "Species", "Sources")) at testthat/testPredictionsPresentation.r:17
2: predict(asreml.obj, classify = classify, sed = pairwise, trace = trace, ...)
3: predict.asreml(asreml.obj, classify = classify, sed = pairwise, trace = trace, ...)

On the other hand, the test completes successfully if I manually execute it line-by-line, but this is not feasible in practice because there are 21 sets of tests.

The manifest problem is "ie", which is another unexported function in asreml, apparently called by predict.asreml. 
Has anyone on this list advice to offer on how this problem might be overcome?

Any help gratefully received,

Chris Brien, University of South Australia

PS I know that the problem can be avoided by calling the functions within asremlPlus using asreml:::, but this appears to be unacceptable to CRAN because it produces the NOTE 

Unavailable namespaces imported from by ':::' calls:
  'asreml' 'asreml4'
  See the note in ?`:::` about the use of this operator.

And the NOTE in ?':::' says

It is typically a design mistake to use ::: in your code since the corresponding object has probably been kept internal for a good reason. Consider contacting the package maintainer if you feel the need to access the object for anything but mere inspection.

From murdoch.duncan at gmail.com  Sat Dec 16 12:48:12 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 16 Dec 2017 06:48:12 -0500
Subject: [R-pkg-devel] Problem enhancing a package with a predict method
 not declared to be an S3 method
In-Reply-To: <b1279f33ba394ca09f953658470ea820@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>
References: <b1279f33ba394ca09f953658470ea820@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>
Message-ID: <010faef6-26cc-0d50-5394-bee32f70af10@gmail.com>

On 15/12/2017 11:52 PM, Chris Brien wrote:
> Dear list members,
> 
> I am in a bind.
> 
> I have a package asremlPlus that "Enhances" the commercial package asreml (and asreml4), for which I am not a maintainer. It is not available in a public repository and because of this, when checking it for CRAN, it always gives the following NOTE, which is acceptable to CRAN:
> 
> Suggests or Enhances not in mainstream repositories:
>    asreml, asreml4
> 
> Now asreml has three functions summary.asreml, fitted.asreml and predict.asreml that are (i) not exported and (ii) not declared to be S3 methods. In spite of this it is possible to call them using summary, fitted and predict.
> 
> However, if I do this in the code then the suite of unit tests that I have for asremlPlus fails when run with testthat::test_check with the following Error:
> 
> ?[31m1. Error: predictPlus.asreml (@testPredictionsPresentation.r#17) ?[39m---------------
> could not find function "ie"
> 1: predictPlus.asreml(classify = "Sources:Type", asreml.obj = current.asr, tables = "none",
> wald.tab = current.asrt$wald.tab, present = c("Type", "Species", "Sources")) at testthat/testPredictionsPresentation.r:17
> 2: predict(asreml.obj, classify = classify, sed = pairwise, trace = trace, ...)
> 3: predict.asreml(asreml.obj, classify = classify, sed = pairwise, trace = trace, ...)
> 
> On the other hand, the test completes successfully if I manually execute it line-by-line, but this is not feasible in practice because there are 21 sets of tests.
> 
> The manifest problem is "ie", which is another unexported function in asreml, apparently called by predict.asreml.
> Has anyone on this list advice to offer on how this problem might be overcome?
> 
> Any help gratefully received,
> 
> Chris Brien, University of South Australia
> 
> PS I know that the problem can be avoided by calling the functions within asremlPlus using asreml:::, but this appears to be unacceptable to CRAN because it produces the NOTE
> 
> Unavailable namespaces imported from by ':::' calls:
>    'asreml' 'asreml4'
>    See the note in ?`:::` about the use of this operator.
> 
> And the NOTE in ?':::' says
> 
> It is typically a design mistake to use ::: in your code since the corresponding object has probably been kept internal for a good reason. Consider contacting the package maintainer if you feel the need to access the object for anything but mere inspection.

I don't speak for CRAN, but I think it is consistent with their 
philosophy that a package doing what yours does should not be allowed there.

Your package depends on the internals of asreml.  There is nothing to 
stop that package from changing them, causing your package to generate 
errors or incorrect results.  CRAN does what it can to prevent this kind 
of error, and it can't do it with yours.

I'd suggest that you contact the maintainers of asreml, and ask them to 
export the functions you need.  If they are unwilling to do that, then 
you could ask them to distribute your package, or distribute it yourself 
(e.g. by making it available on Github).

One other possibility is that their license would allow you to copy 
enough of their package into yours that you wouldn't need the ::: 
import, but that seems unlikely.

Duncan Murdoch


From baptiste.auguie at gmail.com  Sun Dec 17 07:15:21 2017
From: baptiste.auguie at gmail.com (Baptiste Auguie)
Date: Sun, 17 Dec 2017 19:15:21 +1300
Subject: [R-pkg-devel] Lapack: undefined symbol: zgbsv_
Message-ID: <CANLFJPrTrtSGbOuiR1N9FmKu_UP1Faj=K2FhgLRAnduRTjZU+w@mail.gmail.com>

Hi,

The CRAN maintainers recently informed me that my cda package now fails on
CRAN. The root cause seems to be this error:

** testing if installed package can be loaded
Error: package or namespace load failed for ?cda? in dyn.load(file, DLLpath
= DLLpath, ...):
 unable to load shared object ?/home/hornik/tmp/R.check/r-
release-gcc/Work/build/Packages/cda/libs/cda.so?:
  /home/hornik/tmp/R.check/r-release-gcc/Work/build/Packages/cda/libs/cda.so:
undefined symbol: zgbsv_

Google informs me that zgbsv is part of Lapack (specifically, a function to
solve a complex system of linear equations with 'banded matrices'). I
should note that I have not updated the package for quite a while, so this
breakage is likely occurring because of upstream changes in R or Rcpp or
RcppArmadillo or Armadillo (my guess).

I've encountered this type of problem at least twice in the past 5-6 years:
my package relies on Armadillo's C++ solve() function to solve a complex
linear system (not "banded" though, as far as I know), and Armadillo tends
to assume that a full Lapack is available, whereas R includes a subset. In
the past the problem had occurred with zgels and zgesvx, and once before
that with zgetri. I was quite relieved when R Core added many Lapack
routines last year:

https://github.com/wch/r-source/commit/98acd96f22eb795a933879c0d3f740
e802855473

which solved (no pun intended) my problems. Dirk (Rcpp) and Conrad
(Armadillo) both agreed this was the best way forward. Unfortunately the
problem has resurfaced out of the blue with zgbsv, which is not on this
list. I'm left wondering:

- what recent change could have caused my package to need this new routine
(if it is needed)?

- what would be a good way forward? In the past I tried adding the required
file from Netlib directly into my package, but that brings other issues
(unnecessary code duplication, especially if the code isn't even needed,
but also authorship changes, etc.)

Thanks for any advice.

Best regards,

baptiste

	[[alternative HTML version deleted]]


From davidhughjones at gmail.com  Sun Dec 17 12:08:30 2017
From: davidhughjones at gmail.com (David Hugh-Jones)
Date: Sun, 17 Dec 2017 11:08:30 +0000
Subject: [R-pkg-devel] Problem enhancing a package with a predict method
 not declared to be an S3 method
In-Reply-To: <b1279f33ba394ca09f953658470ea820@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>
References: <b1279f33ba394ca09f953658470ea820@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>
Message-ID: <CAARY7kjnfZOaLL-KPDpaiM_kEvdRehq+oXuy8sRYcXsqbby_7w@mail.gmail.com>

Could you not just skip these particular tests using skip_on_cran()?

David

	[[alternative HTML version deleted]]


From edd at debian.org  Mon Dec 18 00:21:32 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 17 Dec 2017 17:21:32 -0600
Subject: [R-pkg-devel] Lapack: undefined symbol: zgbsv_
In-Reply-To: <CANLFJPrTrtSGbOuiR1N9FmKu_UP1Faj=K2FhgLRAnduRTjZU+w@mail.gmail.com>
References: <CANLFJPrTrtSGbOuiR1N9FmKu_UP1Faj=K2FhgLRAnduRTjZU+w@mail.gmail.com>
Message-ID: <23094.64508.266861.133759@bud.eddelbuettel.com>


On 17 December 2017 at 19:15, Baptiste Auguie wrote:
| Hi,
| 
| The CRAN maintainers recently informed me that my cda package now fails on
| CRAN. The root cause seems to be this error:
| 
| ** testing if installed package can be loaded
| Error: package or namespace load failed for ?cda? in dyn.load(file, DLLpath
| = DLLpath, ...):
|  unable to load shared object ?/home/hornik/tmp/R.check/r-
| release-gcc/Work/build/Packages/cda/libs/cda.so?:
|   /home/hornik/tmp/R.check/r-release-gcc/Work/build/Packages/cda/libs/cda.so:
| undefined symbol: zgbsv_
| 
| Google informs me that zgbsv is part of Lapack (specifically, a function to
| solve a complex system of linear equations with 'banded matrices'). I
| should note that I have not updated the package for quite a while, so this
| breakage is likely occurring because of upstream changes in R or Rcpp or
| RcppArmadillo or Armadillo (my guess).

All of the above only pass through to Lapack, and R is their only interface
(in the use case of R packages we consider here).

As you use complex variables (which is rare otherwise) this can bite _if_ the
internal-to-R and incomplete Lapack system uses the internal copy which may
not be complete.

| I've encountered this type of problem at least twice in the past 5-6 years:
| my package relies on Armadillo's C++ solve() function to solve a complex
| linear system (not "banded" though, as far as I know), and Armadillo tends
| to assume that a full Lapack is available, whereas R includes a subset. In

Only if R is compiled / set-up to use the internal Lapack. For example the
Debian and Ubuntu package generally are not.

| the past the problem had occurred with zgels and zgesvx, and once before
| that with zgetri. I was quite relieved when R Core added many Lapack
| routines last year:
| 
| https://github.com/wch/r-source/commit/98acd96f22eb795a933879c0d3f740
| e802855473
| 
| which solved (no pun intended) my problems. Dirk (Rcpp) and Conrad
| (Armadillo) both agreed this was the best way forward. Unfortunately the
| problem has resurfaced out of the blue with zgbsv, which is not on this
| list. I'm left wondering:
| 
| - what recent change could have caused my package to need this new routine
| (if it is needed)?

There was a recent NEWS item to this effect:

   CHANGES IN R 3.4.3 patched:

     NEW FEATURES:
 
       [...]

       ? The version of LAPACK included in the sources has been updated to
         3.8.0 (for the routines used by R a very minor bug-fix change).

so this may be related.

Dirk
 
| - what would be a good way forward? In the past I tried adding the required
| file from Netlib directly into my package, but that brings other issues
| (unnecessary code duplication, especially if the code isn't even needed,
| but also authorship changes, etc.)
| 
| Thanks for any advice.
| 
| Best regards,
| 
| baptiste
| 
| 	[[alternative HTML version deleted]]
| 
| ______________________________________________
| R-package-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-package-devel
-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd at debian.org  Mon Dec 18 00:50:25 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 17 Dec 2017 17:50:25 -0600
Subject: [R-pkg-devel] Lapack: undefined symbol: zgbsv_
In-Reply-To: <23094.64508.266861.133759@bud.eddelbuettel.com>
References: <CANLFJPrTrtSGbOuiR1N9FmKu_UP1Faj=K2FhgLRAnduRTjZU+w@mail.gmail.com>
 <23094.64508.266861.133759@bud.eddelbuettel.com>
Message-ID: <23095.705.569686.896207@bud.eddelbuettel.com>


On 17 December 2017 at 17:21, Dirk Eddelbuettel wrote:
| | ** testing if installed package can be loaded
| | Error: package or namespace load failed for ?cda? in dyn.load(file, DLLpath
| | = DLLpath, ...):
| |  unable to load shared object ?/home/hornik/tmp/R.check/r-
| | release-gcc/Work/build/Packages/cda/libs/cda.so?:
| |   /home/hornik/tmp/R.check/r-release-gcc/Work/build/Packages/cda/libs/cda.so:
| | undefined symbol: zgbsv_

I just had another poke at this.  You can easily search the R source at
Github via Winston's mirror -- no zgbsv there.  Ditto for the different
copies I still have here of the R versions I packaged for Debian, as well as
current r-devel.

So it is not R. But _current_ (Rcpp)Armadillo has it, and so I spot-checked
against the last version of 7.* series of Armadillo / 0.7.* package for
RcppArmadillo.  It didn't have it.

In short, but relying on (Rcpp)Armadillo, you are submit to it changing its
solver and it seems to have done so recently.  And as R is primarily
concerned with double precision, that version you now need was never
included.

In short, you seem to now have a requirement which R Core _may_ solve for you
in time for R 3.5.0.  Otherwise your users will have to rely on systems with
a full (external) Lapack/Blas and not the smaller embedded one.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd at debian.org  Mon Dec 18 01:13:03 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 17 Dec 2017 18:13:03 -0600
Subject: [R-pkg-devel] Lapack: undefined symbol: zgbsv_
In-Reply-To: <23095.705.569686.896207@bud.eddelbuettel.com>
References: <CANLFJPrTrtSGbOuiR1N9FmKu_UP1Faj=K2FhgLRAnduRTjZU+w@mail.gmail.com>
 <23094.64508.266861.133759@bud.eddelbuettel.com>
 <23095.705.569686.896207@bud.eddelbuettel.com>
Message-ID: <23095.2063.222182.538945@bud.eddelbuettel.com>


On 17 December 2017 at 17:50, Dirk Eddelbuettel wrote:
| In short, but relying on (Rcpp)Armadillo, you are submit to it changing its

That should have read: "... by relying on (Rcpp)Armadillo, you are subject to ..."

My bad.

| solver and it seems to have done so recently.  And as R is primarily
| concerned with double precision, that version you now need was never
| included.

Also, eg on the system where I do reverse-dependency checks, cda was never an
issue as we use the external libraries:

   edd at bud:~/git/rcpp-logs/logs/rcpparmadillo(master)$ grep ^cda log-RcppArmadillo-2017*
   log-RcppArmadillo-20170411-1403.txt:cda_2.0.0.tar.gz : success (42 of 344, [...]
   log-RcppArmadillo-20170503-1207.txt:cda_2.0.0.tar.gz : success (43 of 347, [...]
   log-RcppArmadillo-20170504-0609.txt:cda_2.0.0.tar.gz : success (43 of 347, [...]
   log-RcppArmadillo-20170516-1041.txt:cda_2.0.0.tar.gz : success (44 of 349, [...]
   log-RcppArmadillo-20170523-1147.txt:cda_2.0.0.tar.gz : success (43 of 349, [...]
   log-RcppArmadillo-20170524-1940.txt:cda_2.0.0.tar.gz : success (43 of 349, [...]
   log-RcppArmadillo-20170531-0642.txt:cda_2.0.0.tar.gz : success (43 of 350, [...]
   log-RcppArmadillo-20170619-0918.txt:cda_2.0.0.tar.gz : success (44 of 357, [...]
   log-RcppArmadillo-20170801-1435.txt:cda_2.0.0.tar.gz : success (48 of 375, [...]
   log-RcppArmadillo-20170803-1102.txt:cda_2.0.0.tar.gz : success (48 of 376, [...]
   log-RcppArmadillo-20170808-1000.txt:cda_2.0.0.tar.gz : success (48 of 377, [...]
   log-RcppArmadillo-20170810-0908.txt:cda_2.0.0.tar.gz : success (48 of 377, [...]
   log-RcppArmadillo-20170819-1325.txt:cda_2.0.0.tar.gz : success (49 of 381, [...]
   log-RcppArmadillo-20171002-1006.txt:cda_2.0.0.tar.gz : success (55 of 400, [...]
   log-RcppArmadillo-20171009-0935.txt:cda_2.0.0.tar.gz : success (55 of 405, [...]
   log-RcppArmadillo-20171021-0734.txt:cda_2.0.0.tar.gz : success (56 of 411, [...]
   log-RcppArmadillo-20171023-1227.txt:cda_2.0.0.tar.gz : success (56 of 412, [...]
   log-RcppArmadillo-20171108-2024.txt:cda_2.0.0.tar.gz : success (57 of 426, [...]
   log-RcppArmadillo-20171123-0845.txt:cda_2.0.0.tar.gz : success (58 of 434, [...]
   log-RcppArmadillo-20171123-1539.txt:cda_2.0.0.tar.gz : success (58 of 434, [...]
   log-RcppArmadillo-20171201-1053.txt:cda_2.0.0.tar.gz : success (56 of 430, [...]
   log-RcppArmadillo-20171204-0848.txt:cda_2.0.0.tar.gz : success (56 of 431, [...]
   log-RcppArmadillo-20171210-0828.txt:cda_2.0.0.tar.gz : success (57 of 435, [...]
   edd at bud:~/git/rcpp-logs/logs/rcpparmadillo(master)$ [...]

| In short, you seem to now have a requirement which R Core _may_ solve for you
| in time for R 3.5.0.  Otherwise your users will have to rely on systems with
| a full (external) Lapack/Blas and not the smaller embedded one.

That really seems to be the only way forward, short of embedding the routine
in cda.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From Chris.Brien at unisa.edu.au  Mon Dec 18 03:14:53 2017
From: Chris.Brien at unisa.edu.au (Chris Brien)
Date: Mon, 18 Dec 2017 02:14:53 +0000
Subject: [R-pkg-devel] Problem enhancing a package with a predict method
 not declared to be an S3 method
In-Reply-To: <010faef6-26cc-0d50-5394-bee32f70af10@gmail.com>
References: <b1279f33ba394ca09f953658470ea820@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>
 <010faef6-26cc-0d50-5394-bee32f70af10@gmail.com>
Message-ID: <c724e956162449fdb806be37d303c2c5@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>

Hi Duncan,

Thanks for your comments. I appreciate that you do not speak for CRAN. 

I had thought that, while I am accessing asreml internals, I do not believe that it is the intention of the maintainer that they be internal. Indeed, I am only calling functions documented in the manual and so it would appear that they are intended to be part of the API for the packages. I had hoped that this would be an allowed exception.

Nonetheless, I am attempting to contact the maintainer and I will see what that brings.

Regards,

  Chris


-----Original Message-----
From: Duncan Murdoch [mailto:murdoch.duncan at gmail.com] 
Sent: Saturday, 16 December 2017 10:18 PM
To: Chris Brien; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Problem enhancing a package with a predict method not declared to be an S3 method

On 15/12/2017 11:52 PM, Chris Brien wrote:
> Dear list members,
> 
> I am in a bind.
> 
> I have a package asremlPlus that "Enhances" the commercial package asreml (and asreml4), for which I am not a maintainer. It is not available in a public repository and because of this, when checking it for CRAN, it always gives the following NOTE, which is acceptable to CRAN:
> 
> Suggests or Enhances not in mainstream repositories:
>    asreml, asreml4
> 
> Now asreml has three functions summary.asreml, fitted.asreml and predict.asreml that are (i) not exported and (ii) not declared to be S3 methods. In spite of this it is possible to call them using summary, fitted and predict.
> 
> However, if I do this in the code then the suite of unit tests that I have for asremlPlus fails when run with testthat::test_check with the following Error:
> 
>  [31m1. Error: predictPlus.asreml (@testPredictionsPresentation.r#17) 
>  [39m--------------- could not find function "ie"
> 1: predictPlus.asreml(classify = "Sources:Type", asreml.obj = 
> current.asr, tables = "none", wald.tab = current.asrt$wald.tab, 
> present = c("Type", "Species", "Sources")) at 
> testthat/testPredictionsPresentation.r:17
> 2: predict(asreml.obj, classify = classify, sed = pairwise, trace = 
> trace, ...)
> 3: predict.asreml(asreml.obj, classify = classify, sed = pairwise, 
> trace = trace, ...)
> 
> On the other hand, the test completes successfully if I manually execute it line-by-line, but this is not feasible in practice because there are 21 sets of tests.
> 
> The manifest problem is "ie", which is another unexported function in asreml, apparently called by predict.asreml.
> Has anyone on this list advice to offer on how this problem might be overcome?
> 
> Any help gratefully received,
> 
> Chris Brien, University of South Australia
> 
> PS I know that the problem can be avoided by calling the functions 
> within asremlPlus using asreml:::, but this appears to be unacceptable 
> to CRAN because it produces the NOTE
> 
> Unavailable namespaces imported from by ':::' calls:
>    'asreml' 'asreml4'
>    See the note in ?`:::` about the use of this operator.
> 
> And the NOTE in ?':::' says
> 
> It is typically a design mistake to use ::: in your code since the corresponding object has probably been kept internal for a good reason. Consider contacting the package maintainer if you feel the need to access the object for anything but mere inspection.

I don't speak for CRAN, but I think it is consistent with their philosophy that a package doing what yours does should not be allowed there.

Your package depends on the internals of asreml.  There is nothing to stop that package from changing them, causing your package to generate errors or incorrect results.  CRAN does what it can to prevent this kind of error, and it can't do it with yours.

I'd suggest that you contact the maintainers of asreml, and ask them to export the functions you need.  If they are unwilling to do that, then you could ask them to distribute your package, or distribute it yourself (e.g. by making it available on Github).

One other possibility is that their license would allow you to copy enough of their package into yours that you wouldn't need the ::: 
import, but that seems unlikely.

Duncan Murdoch



From dstr7320 at uni.sydney.edu.au  Mon Dec 18 05:00:13 2017
From: dstr7320 at uni.sydney.edu.au (Dario Strbenac)
Date: Mon, 18 Dec 2017 04:00:13 +0000
Subject: [R-pkg-devel] Problem enhancing a package with a predict method
 not declared to be an S3 method
In-Reply-To: <c724e956162449fdb806be37d303c2c5@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>
References: <b1279f33ba394ca09f953658470ea820@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>
 <010faef6-26cc-0d50-5394-bee32f70af10@gmail.com>,
 <c724e956162449fdb806be37d303c2c5@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>
Message-ID: <SY3PR01MB074710A453B471FE71705759CD0E0@SY3PR01MB0747.ausprd01.prod.outlook.com>

Good day,

It seems that they are not internal functions if they are have user documentation written for them. Internal functions usually don't have a help page.

--------------------------------------
Dario Strbenac
University of Sydney
Camperdown NSW 2050
Australia

From baptiste.auguie at gmail.com  Mon Dec 18 08:37:35 2017
From: baptiste.auguie at gmail.com (Baptiste Auguie)
Date: Mon, 18 Dec 2017 20:37:35 +1300
Subject: [R-pkg-devel] Lapack: undefined symbol: zgbsv_
In-Reply-To: <23095.2063.222182.538945@bud.eddelbuettel.com>
References: <CANLFJPrTrtSGbOuiR1N9FmKu_UP1Faj=K2FhgLRAnduRTjZU+w@mail.gmail.com>
 <23094.64508.266861.133759@bud.eddelbuettel.com>
 <23095.705.569686.896207@bud.eddelbuettel.com>
 <23095.2063.222182.538945@bud.eddelbuettel.com>
Message-ID: <CANLFJPoGuOHpAfr47PHLP8iKKzZF90MQV8_Owpi5ReDLaedf-g@mail.gmail.com>

Thanks Dirk. I arrived at the same conclusions after tracking down the
recent changes in Armadillo and noticing their addition of a special
solve() case for banded matrices.
What I don't really understand (because of the templating system etc.) is
why this new routine in Armadillo would be needed at all, when cda does not
solve banded linear systems. I wonder if a practical workaround would be to
include a _dummy_ routine with the same name, ugly as that may sound.
Alternatively, define some compiler macro to tell Armadillo not to use this
special strategy. Does this sound doable?

The ideal solution would be to have a fuller Lapack embedded in R for
systems that need it, but there's no guarantee that R Core will consider it
in the near future, and I'm given until the 23rd of this month before my
package is removed from CRAN.

Thanks,

b.



On 18 December 2017 at 13:13, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 17 December 2017 at 17:50, Dirk Eddelbuettel wrote:
> | In short, but relying on (Rcpp)Armadillo, you are submit to it changing
> its
>
> That should have read: "... by relying on (Rcpp)Armadillo, you are subject
> to ..."
>
> My bad.
>
> | solver and it seems to have done so recently.  And as R is primarily
> | concerned with double precision, that version you now need was never
> | included.
>
> Also, eg on the system where I do reverse-dependency checks, cda was never
> an
> issue as we use the external libraries:
>
>    edd at bud:~/git/rcpp-logs/logs/rcpparmadillo(master)$ grep ^cda
> log-RcppArmadillo-2017*
>    log-RcppArmadillo-20170411-1403.txt:cda_2.0.0.tar.gz : success (42 of
> 344, [...]
>    log-RcppArmadillo-20170503-1207.txt:cda_2.0.0.tar.gz : success (43 of
> 347, [...]
>    log-RcppArmadillo-20170504-0609.txt:cda_2.0.0.tar.gz : success (43 of
> 347, [...]
>    log-RcppArmadillo-20170516-1041.txt:cda_2.0.0.tar.gz : success (44 of
> 349, [...]
>    log-RcppArmadillo-20170523-1147.txt:cda_2.0.0.tar.gz : success (43 of
> 349, [...]
>    log-RcppArmadillo-20170524-1940.txt:cda_2.0.0.tar.gz : success (43 of
> 349, [...]
>    log-RcppArmadillo-20170531-0642.txt:cda_2.0.0.tar.gz : success (43 of
> 350, [...]
>    log-RcppArmadillo-20170619-0918.txt:cda_2.0.0.tar.gz : success (44 of
> 357, [...]
>    log-RcppArmadillo-20170801-1435.txt:cda_2.0.0.tar.gz : success (48 of
> 375, [...]
>    log-RcppArmadillo-20170803-1102.txt:cda_2.0.0.tar.gz : success (48 of
> 376, [...]
>    log-RcppArmadillo-20170808-1000.txt:cda_2.0.0.tar.gz : success (48 of
> 377, [...]
>    log-RcppArmadillo-20170810-0908.txt:cda_2.0.0.tar.gz : success (48 of
> 377, [...]
>    log-RcppArmadillo-20170819-1325.txt:cda_2.0.0.tar.gz : success (49 of
> 381, [...]
>    log-RcppArmadillo-20171002-1006.txt:cda_2.0.0.tar.gz : success (55 of
> 400, [...]
>    log-RcppArmadillo-20171009-0935.txt:cda_2.0.0.tar.gz : success (55 of
> 405, [...]
>    log-RcppArmadillo-20171021-0734.txt:cda_2.0.0.tar.gz : success (56 of
> 411, [...]
>    log-RcppArmadillo-20171023-1227.txt:cda_2.0.0.tar.gz : success (56 of
> 412, [...]
>    log-RcppArmadillo-20171108-2024.txt:cda_2.0.0.tar.gz : success (57 of
> 426, [...]
>    log-RcppArmadillo-20171123-0845.txt:cda_2.0.0.tar.gz : success (58 of
> 434, [...]
>    log-RcppArmadillo-20171123-1539.txt:cda_2.0.0.tar.gz : success (58 of
> 434, [...]
>    log-RcppArmadillo-20171201-1053.txt:cda_2.0.0.tar.gz : success (56 of
> 430, [...]
>    log-RcppArmadillo-20171204-0848.txt:cda_2.0.0.tar.gz : success (56 of
> 431, [...]
>    log-RcppArmadillo-20171210-0828.txt:cda_2.0.0.tar.gz : success (57 of
> 435, [...]
>    edd at bud:~/git/rcpp-logs/logs/rcpparmadillo(master)$ [...]
>
> | In short, you seem to now have a requirement which R Core _may_ solve
> for you
> | in time for R 3.5.0.  Otherwise your users will have to rely on systems
> with
> | a full (external) Lapack/Blas and not the smaller embedded one.
>
> That really seems to be the only way forward, short of embedding the
> routine
> in cda.
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Mon Dec 18 09:01:45 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 18 Dec 2017 09:01:45 +0100
Subject: [R-pkg-devel] Problem enhancing a package with a predict method
 not declared to be an S3 method
In-Reply-To: <SY3PR01MB074710A453B471FE71705759CD0E0@SY3PR01MB0747.ausprd01.prod.outlook.com>
References: <b1279f33ba394ca09f953658470ea820@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>
 <010faef6-26cc-0d50-5394-bee32f70af10@gmail.com>
 <c724e956162449fdb806be37d303c2c5@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>
 <SY3PR01MB074710A453B471FE71705759CD0E0@SY3PR01MB0747.ausprd01.prod.outlook.com>
Message-ID: <71941519-95b7-c565-723c-89ddbe66ce19@statistik.tu-dortmund.de>



On 18.12.2017 05:00, Dario Strbenac wrote:
> Good day,
> 
> It seems that they are not internal functions if they are have user documentation written for them. Internal functions usually don't have a help page.

You can document internal functions, why not?
The definition whether they are internal or not is given in the 
NAMESPACE file.

Best,
Uwe Ligges


> --------------------------------------
> Dario Strbenac
> University of Sydney
> Camperdown NSW 2050
> Australia
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From ligges at statistik.tu-dortmund.de  Mon Dec 18 09:02:34 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 18 Dec 2017 09:02:34 +0100
Subject: [R-pkg-devel] Problem enhancing a package with a predict method
 not declared to be an S3 method
In-Reply-To: <71941519-95b7-c565-723c-89ddbe66ce19@statistik.tu-dortmund.de>
References: <b1279f33ba394ca09f953658470ea820@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>
 <010faef6-26cc-0d50-5394-bee32f70af10@gmail.com>
 <c724e956162449fdb806be37d303c2c5@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>
 <SY3PR01MB074710A453B471FE71705759CD0E0@SY3PR01MB0747.ausprd01.prod.outlook.com>
 <71941519-95b7-c565-723c-89ddbe66ce19@statistik.tu-dortmund.de>
Message-ID: <86bb9c6a-432b-3bd0-75ca-c4670c71e505@statistik.tu-dortmund.de>

And of course, you can even tell the Rd file that it documents an 
internal function.

Best,
Uwe Ligges

On 18.12.2017 09:01, Uwe Ligges wrote:
> 
> 
> On 18.12.2017 05:00, Dario Strbenac wrote:
>> Good day,
>>
>> It seems that they are not internal functions if they are have user 
>> documentation written for them. Internal functions usually don't have 
>> a help page.
> 
> You can document internal functions, why not?
> The definition whether they are internal or not is given in the 
> NAMESPACE file.
> 
> Best,
> Uwe Ligges
> 
> 
>> --------------------------------------
>> Dario Strbenac
>> University of Sydney
>> Camperdown NSW 2050
>> Australia
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>


From Chris.Brien at unisa.edu.au  Mon Dec 18 13:18:32 2017
From: Chris.Brien at unisa.edu.au (Chris Brien)
Date: Mon, 18 Dec 2017 12:18:32 +0000
Subject: [R-pkg-devel] Problem enhancing a package with a predict method
 not declared to be an S3 method
Message-ID: <f7b049dda17e4b64adec9d837d25d91f@ITUPW-EXMBOX3B.UniNet.unisa.edu.au>

Dear all,

I had realized that they were internal functions.

However, I was conjecturing that the maintainer intends for them to be employed by package users and that use of the ':::' operator might be acceptable in these circumstances. 

It appears not and I have modified my package to remove all occurrences of ':::'.

Thanks to all for your comments,

  Chris



-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Uwe Ligges
Sent: Monday, 18 December 2017 6:33 PM
To: Dario Strbenac; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Problem enhancing a package with a predict method not declared to be an S3 method

And of course, you can even tell the Rd file that it documents an internal function.

Best,
Uwe Ligges

On 18.12.2017 09:01, Uwe Ligges wrote:
> 
> 
> On 18.12.2017 05:00, Dario Strbenac wrote:
>> Good day,
>>
>> It seems that they are not internal functions if they are have user 
>> documentation written for them. Internal functions usually don't have 
>> a help page.
> 
> You can document internal functions, why not?
> The definition whether they are internal or not is given in the 
> NAMESPACE file.
> 
> Best,
> Uwe Ligges
> 
> 
>> --------------------------------------
>> Dario Strbenac
>> University of Sydney
>> Camperdown NSW 2050
>> Australia
>> ______________________________________________
>> R-package-devel at r-project.org mailing list 
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>

______________________________________________
R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ralf.stubner at r-institute.com  Mon Dec 18 13:12:33 2017
From: ralf.stubner at r-institute.com (Ralf Stubner)
Date: Mon, 18 Dec 2017 13:12:33 +0100
Subject: [R-pkg-devel] Lapack: undefined symbol: zgbsv_
In-Reply-To: <CANLFJPoGuOHpAfr47PHLP8iKKzZF90MQV8_Owpi5ReDLaedf-g@mail.gmail.com>
References: <CANLFJPrTrtSGbOuiR1N9FmKu_UP1Faj=K2FhgLRAnduRTjZU+w@mail.gmail.com>
 <23094.64508.266861.133759@bud.eddelbuettel.com>
 <23095.705.569686.896207@bud.eddelbuettel.com>
 <23095.2063.222182.538945@bud.eddelbuettel.com>
 <CANLFJPoGuOHpAfr47PHLP8iKKzZF90MQV8_Owpi5ReDLaedf-g@mail.gmail.com>
Message-ID: <235be197-52f3-51c1-cacd-c25f298c78f7@r-institute.com>

On 18.12.2017 08:37, Baptiste Auguie wrote:
> What I don't really understand (because of the templating system etc.) is
> why this new routine in Armadillo would be needed at all, when cda does not
> solve banded linear systems. I wonder if a practical workaround would be to
> include a _dummy_ routine with the same name, ugly as that may sound.
> Alternatively, define some compiler macro to tell Armadillo not to use this
> special strategy. Does this sound doable?

Looking at
https://github.com/RcppCore/RcppArmadillo/blob/f20cc71ad6b1c730a79f2e5609733f741172b399/inst/include/armadillo_bits/glue_solve_meat.hpp#L46
t seems to be possible to disable banded matrix strategy using

arma::solve(X, y, arma::solve_opts::no_band)

instead of

arma::solve(X, y)

Alternatively, there is also ARMA_CRIPPLED_LAPACK (c.f.
https://github.com/RcppCore/RcppArmadillo/blob/f20cc71ad6b1c730a79f2e5609733f741172b399/inst/include/armadillo_bits/auxlib_meat.hpp#L4599),
but I have not checked any side effects.

Greetings
Ralf

-- 
Ralf Stubner
Senior Software Engineer / Trainer

R Institute GmbH
Dortustra?e 48
14467 Potsdam

T: +49 331 23 70 81 66
F: +49 331 23 70 81 67
M: +49 162 20 91 196

Mail: ralf.stubner at r-institute.com

Sitz: Potsdam
Register: AG Potsdam HRB 27966 P
Ust.-IdNr.: DE300072622
Gesch?ftsf?hrer: Prof. Dr. Dr. Karl-Kuno Kunze


From edd at debian.org  Mon Dec 18 14:20:47 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 18 Dec 2017 07:20:47 -0600
Subject: [R-pkg-devel] Lapack: undefined symbol: zgbsv_
In-Reply-To: <235be197-52f3-51c1-cacd-c25f298c78f7@r-institute.com>
References: <CANLFJPrTrtSGbOuiR1N9FmKu_UP1Faj=K2FhgLRAnduRTjZU+w@mail.gmail.com>
 <23094.64508.266861.133759@bud.eddelbuettel.com>
 <23095.705.569686.896207@bud.eddelbuettel.com>
 <23095.2063.222182.538945@bud.eddelbuettel.com>
 <CANLFJPoGuOHpAfr47PHLP8iKKzZF90MQV8_Owpi5ReDLaedf-g@mail.gmail.com>
 <235be197-52f3-51c1-cacd-c25f298c78f7@r-institute.com>
Message-ID: <23095.49327.652350.981613@bud.eddelbuettel.com>


On 18 December 2017 at 13:12, Ralf Stubner wrote:
| On 18.12.2017 08:37, Baptiste Auguie wrote:
| > What I don't really understand (because of the templating system etc.) is
| > why this new routine in Armadillo would be needed at all, when cda does not
| > solve banded linear systems. I wonder if a practical workaround would be to
| > include a _dummy_ routine with the same name, ugly as that may sound.
| > Alternatively, define some compiler macro to tell Armadillo not to use this
| > special strategy. Does this sound doable?
| 
| Looking at
| https://github.com/RcppCore/RcppArmadillo/blob/f20cc71ad6b1c730a79f2e5609733f741172b399/inst/include/armadillo_bits/glue_solve_meat.hpp#L46
| t seems to be possible to disable banded matrix strategy using
| 
| arma::solve(X, y, arma::solve_opts::no_band)

Good catch!
 
| instead of
| 
| arma::solve(X, y)
| 
| Alternatively, there is also ARMA_CRIPPLED_LAPACK (c.f.
| https://github.com/RcppCore/RcppArmadillo/blob/f20cc71ad6b1c730a79f2e5609733f741172b399/inst/include/armadillo_bits/auxlib_meat.hpp#L4599),
| but I have not checked any side effects.

We used that in the past when some other routines were missing (which R
3.3.0, as I recall, added).

RcppArmadillo tests and sets this at package build / installation based on
what it is confronted with and flags a "limited" Lapack/Blas.

Baptiste could use that too -- this is what we have it for.

Thanks for the helpful follow-up.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From xhudik at gmail.com  Mon Dec 18 14:38:01 2017
From: xhudik at gmail.com (Tomas Hudik)
Date: Mon, 18 Dec 2017 14:38:01 +0100
Subject: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings
In-Reply-To: <mailman.10996.1513602895.1577.r-package-devel@r-project.org>
References: <mailman.10996.1513602895.1577.r-package-devel@r-project.org>
Message-ID: <CAEE6Ne13pf_-SZ1DE-zjq7-N=X6at-JwedqrknyxpGPEC7Fpig@mail.gmail.com>

Hi there,

If I write a function with documentation (notice `\dontrun` section)

#' Print a string.
#'
#' @examples
#' \dontrun{
#' str_length(letters)
#'}
print_str <- function(str) {
  print(string)
}

`roxygenize()` will create proper Rd file, however, `R CMD check .` will
generate:
```
...
## Not run:
str_length(letters)
## End(Not run)
```

If a person not familiar with Rd (majority of people) see such example, I
do think he will be confused.
Question - wouldnt be good to remove `## NOT run` strings by default (
https://github.com/wch/r-source/blob/af7f52f70101960861e5d995d3a4be
c010bc89e6/src/library/tools/R/Rd2latex.R#L238
)

E.g. see https://cran.r-project.org/web/packages/gmailr/gmailr.pdf - and go
through example sections. There is not many people who would know what
those cryptic `## Not Run` strings mean.


thanks, Tomas

	[[alternative HTML version deleted]]


From georgi.boshnakov at manchester.ac.uk  Mon Dec 18 20:07:59 2017
From: georgi.boshnakov at manchester.ac.uk (Georgi Boshnakov)
Date: Mon, 18 Dec 2017 19:07:59 +0000
Subject: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings
In-Reply-To: <CAEE6Ne13pf_-SZ1DE-zjq7-N=X6at-JwedqrknyxpGPEC7Fpig@mail.gmail.com>
References: <mailman.10996.1513602895.1577.r-package-devel@r-project.org>
 <CAEE6Ne13pf_-SZ1DE-zjq7-N=X6at-JwedqrknyxpGPEC7Fpig@mail.gmail.com>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E018F63991D@MBXP02.ds.man.ac.uk>

Hi,

This actually is not about Rd format. Indeed, you are using   'roxygen' syntax. 

Examples are not run when there is a good reason (long time, internet connection required, specific local resources). This often means that the user needs to be made aware that something is not as straightforward as usual. 

A better question would probably be "Is there a better way to alert the user that the example is somehow special?" Maybe, but it is difficult to beat "Not run" for brevity and native English speakers would probably have come forward with a better replacement.  

Also, adding a note (in a comment before the example)  as to way an example is not run can be of benefit to both the user and the package author. Even if it is obvious at the time of writing, it may not be so months or years later.

Kind regards,
Georgi Boshnakov

-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Tomas Hudik
Sent: 18 December 2017 13:38
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings

Hi there,

If I write a function with documentation (notice `\dontrun` section)

#' Print a string.
#'
#' @examples
#' \dontrun{
#' str_length(letters)
#'}
print_str <- function(str) {
  print(string)
}

`roxygenize()` will create proper Rd file, however, `R CMD check .` will
generate:
```
...
## Not run:
str_length(letters)
## End(Not run)
```

If a person not familiar with Rd (majority of people) see such example, I do think he will be confused.
Question - wouldnt be good to remove `## NOT run` strings by default ( https://github.com/wch/r-source/blob/af7f52f70101960861e5d995d3a4be
c010bc89e6/src/library/tools/R/Rd2latex.R#L238
)

E.g. see https://cran.r-project.org/web/packages/gmailr/gmailr.pdf - and go through example sections. There is not many people who would know what those cryptic `## Not Run` strings mean.


thanks, Tomas

	[[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel


From baptiste.auguie at gmail.com  Tue Dec 19 09:38:14 2017
From: baptiste.auguie at gmail.com (Baptiste Auguie)
Date: Tue, 19 Dec 2017 21:38:14 +1300
Subject: [R-pkg-devel] Lapack: undefined symbol: zgbsv_
In-Reply-To: <23095.49327.652350.981613@bud.eddelbuettel.com>
References: <CANLFJPrTrtSGbOuiR1N9FmKu_UP1Faj=K2FhgLRAnduRTjZU+w@mail.gmail.com>
 <23094.64508.266861.133759@bud.eddelbuettel.com>
 <23095.705.569686.896207@bud.eddelbuettel.com>
 <23095.2063.222182.538945@bud.eddelbuettel.com>
 <CANLFJPoGuOHpAfr47PHLP8iKKzZF90MQV8_Owpi5ReDLaedf-g@mail.gmail.com>
 <235be197-52f3-51c1-cacd-c25f298c78f7@r-institute.com>
 <23095.49327.652350.981613@bud.eddelbuettel.com>
Message-ID: <CANLFJPpqiqfH_SPcuAZOWVk9n2dvdtr+8+t2z-s8bZ8-Y3r8bQ@mail.gmail.com>

Hi,

Thanks for the pointer to `arma::solve_opts::no_band`, it sounds like a
good solution (assuming the compiler will then skip all the parts related
to banded inversion routines). I've been unable to test it so far; I
haven't managed to reproduce the error reported on CRAN on a mac.
The 'crippled Lapack' macro was useful as a workaround in the past but I'm
not sure of its exact mode of operation so I'm reluctant to set something
to "cripple" the code (does it target only those routines that are found
missing, or is it more of a blanket switch with no fine-tuning?).

Thanks,

baptiste








On 19 December 2017 at 02:20, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 18 December 2017 at 13:12, Ralf Stubner wrote:
> | On 18.12.2017 08:37, Baptiste Auguie wrote:
> | > What I don't really understand (because of the templating system etc.)
> is
> | > why this new routine in Armadillo would be needed at all, when cda
> does not
> | > solve banded linear systems. I wonder if a practical workaround would
> be to
> | > include a _dummy_ routine with the same name, ugly as that may sound.
> | > Alternatively, define some compiler macro to tell Armadillo not to use
> this
> | > special strategy. Does this sound doable?
> |
> | Looking at
> | https://github.com/RcppCore/RcppArmadillo/blob/
> f20cc71ad6b1c730a79f2e5609733f741172b399/inst/include/
> armadillo_bits/glue_solve_meat.hpp#L46
> | t seems to be possible to disable banded matrix strategy using
> |
> | arma::solve(X, y, arma::solve_opts::no_band)
>
> Good catch!
>
> | instead of
> |
> | arma::solve(X, y)
> |
> | Alternatively, there is also ARMA_CRIPPLED_LAPACK (c.f.
> | https://github.com/RcppCore/RcppArmadillo/blob/
> f20cc71ad6b1c730a79f2e5609733f741172b399/inst/include/
> armadillo_bits/auxlib_meat.hpp#L4599),
> | but I have not checked any side effects.
>
> We used that in the past when some other routines were missing (which R
> 3.3.0, as I recall, added).
>
> RcppArmadillo tests and sets this at package build / installation based on
> what it is confronted with and flags a "limited" Lapack/Blas.
>
> Baptiste could use that too -- this is what we have it for.
>
> Thanks for the helpful follow-up.
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From ralf.stubner at r-institute.com  Tue Dec 19 13:41:39 2017
From: ralf.stubner at r-institute.com (Ralf Stubner)
Date: Tue, 19 Dec 2017 13:41:39 +0100
Subject: [R-pkg-devel] Lapack: undefined symbol: zgbsv_
In-Reply-To: <CANLFJPpqiqfH_SPcuAZOWVk9n2dvdtr+8+t2z-s8bZ8-Y3r8bQ@mail.gmail.com>
References: <CANLFJPrTrtSGbOuiR1N9FmKu_UP1Faj=K2FhgLRAnduRTjZU+w@mail.gmail.com>
 <23094.64508.266861.133759@bud.eddelbuettel.com>
 <23095.705.569686.896207@bud.eddelbuettel.com>
 <23095.2063.222182.538945@bud.eddelbuettel.com>
 <CANLFJPoGuOHpAfr47PHLP8iKKzZF90MQV8_Owpi5ReDLaedf-g@mail.gmail.com>
 <235be197-52f3-51c1-cacd-c25f298c78f7@r-institute.com>
 <23095.49327.652350.981613@bud.eddelbuettel.com>
 <CANLFJPpqiqfH_SPcuAZOWVk9n2dvdtr+8+t2z-s8bZ8-Y3r8bQ@mail.gmail.com>
Message-ID: <650d5f59-a959-2f28-cec2-a37c790b6c78@r-institute.com>

On 19.12.2017 09:38, Baptiste Auguie wrote:
> Thanks for the pointer to `arma::solve_opts::no_band`, it sounds like a
> good solution (assuming the compiler will then skip all the parts
> related to banded inversion routines). I've been unable to test it so
> far; I haven't managed to reproduce the error reported on CRAN on a mac.

Reproducing this error is not easy. I was able to do so using docker
with
https://github.com/rocker-org/rocker-versioned/blob/master/r-ver/3.4.3/Dockerfile
as starting point. If you remove lines 30 and 97 (openblas-dev and
--with-blas), you can build a docker image with R included that uses the
BLAS and LAPACK supplied by R.

I have given this a try and installing 'cda' in such a image does indeed
reproduce the error. Unfortunately adding 'arma::solve_opts::no_band' to
the two places where arma::solve is used did not help in my tests :-(

> The 'crippled Lapack' macro was useful as a workaround in the past but
> I'm not sure of its exact mode of operation so I'm reluctant to set
> something to "cripple" the code (does it target only those routines that
> are found missing, or is it more of a blanket switch with no fine-tuning?).

I think it is a blanket switch that will affect also those methods that
where already added in the past. So this would be only a temporary
solution, but I think that's what you need right now.

BTW, setting ARMA_CRIPPLED_LAPACK is more difficult than I thought since
it is #undefed in the RcppArmadillo-Config. Short of editing that file,
you can add this to src/Makevars

PKG_CXXFLAGS=-DARMA_CRIPPLED_LAPACK
-DRcppArmadillo__RcppArmadilloConfigGenerated__h

I hope there is a better way ...

Greetings
Ralf

-- 
Ralf Stubner
Senior Software Engineer / Trainer

R Institute GmbH
Dortustra?e 48
14467 Potsdam

T: +49 331 23 70 81 66
F: +49 331 23 70 81 67
M: +49 162 20 91 196

Mail: ralf.stubner at r-institute.com

Sitz: Potsdam
Register: AG Potsdam HRB 27966 P
Ust.-IdNr.: DE300072622
Gesch?ftsf?hrer: Prof. Dr. Dr. Karl-Kuno Kunze


From edd at debian.org  Tue Dec 19 14:24:29 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 19 Dec 2017 07:24:29 -0600
Subject: [R-pkg-devel] Lapack: undefined symbol: zgbsv_
In-Reply-To: <650d5f59-a959-2f28-cec2-a37c790b6c78@r-institute.com>
References: <CANLFJPrTrtSGbOuiR1N9FmKu_UP1Faj=K2FhgLRAnduRTjZU+w@mail.gmail.com>
 <23094.64508.266861.133759@bud.eddelbuettel.com>
 <23095.705.569686.896207@bud.eddelbuettel.com>
 <23095.2063.222182.538945@bud.eddelbuettel.com>
 <CANLFJPoGuOHpAfr47PHLP8iKKzZF90MQV8_Owpi5ReDLaedf-g@mail.gmail.com>
 <235be197-52f3-51c1-cacd-c25f298c78f7@r-institute.com>
 <23095.49327.652350.981613@bud.eddelbuettel.com>
 <CANLFJPpqiqfH_SPcuAZOWVk9n2dvdtr+8+t2z-s8bZ8-Y3r8bQ@mail.gmail.com>
 <650d5f59-a959-2f28-cec2-a37c790b6c78@r-institute.com>
Message-ID: <23097.4877.497072.436426@bud.eddelbuettel.com>


On 19 December 2017 at 13:41, Ralf Stubner wrote:
| On 19.12.2017 09:38, Baptiste Auguie wrote:
| > Thanks for the pointer to `arma::solve_opts::no_band`, it sounds like a
| > good solution (assuming the compiler will then skip all the parts
| > related to banded inversion routines). I've been unable to test it so
| > far; I haven't managed to reproduce the error reported on CRAN on a mac.
| 
| Reproducing this error is not easy. I was able to do so using docker

Just work on Windows, or on any R built so that its internal BLAS are
used. You can force that via configure at build time.

| with
| https://github.com/rocker-org/rocker-versioned/blob/master/r-ver/3.4.3/Dockerfile
| as starting point. If you remove lines 30 and 97 (openblas-dev and
| --with-blas), you can build a docker image with R included that uses the
| BLAS and LAPACK supplied by R.
| 
| I have given this a try and installing 'cda' in such a image does indeed
| reproduce the error. Unfortunately adding 'arma::solve_opts::no_band' to
| the two places where arma::solve is used did not help in my tests :-(

:-(

Maybe Arma needs another patch.
 
| > The 'crippled Lapack' macro was useful as a workaround in the past but
| > I'm not sure of its exact mode of operation so I'm reluctant to set
| > something to "cripple" the code (does it target only those routines that
| > are found missing, or is it more of a blanket switch with no fine-tuning?).
| 
| I think it is a blanket switch that will affect also those methods that
| where already added in the past. So this would be only a temporary
| solution, but I think that's what you need right now.
| 
| BTW, setting ARMA_CRIPPLED_LAPACK is more difficult than I thought since
| it is #undefed in the RcppArmadillo-Config. Short of editing that file,
| you can add this to src/Makevars
| 
| PKG_CXXFLAGS=-DARMA_CRIPPLED_LAPACK
| -DRcppArmadillo__RcppArmadilloConfigGenerated__h
| 
| I hope there is a better way ...

Set the #define after the #include <RcppArmadillo.h> ?

RcppArmadillo is just the man in the middle.  This is between Baptiste
relying on something that is now always available, and Conrad assuming it is.

I think Baptiste will need to decompose all these pieces and rearrange then.
Or just build his own solve() method based on older Armadillo code?

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From lbusett at gmail.com  Tue Dec 19 14:45:02 2017
From: lbusett at gmail.com (Lorenzo Busetto)
Date: Tue, 19 Dec 2017 14:45:02 +0100
Subject: [R-pkg-devel] Finding/specifying Installation path of gdal in a
	travis-ci build
Message-ID: <CAM1G4SRKViLPcg-iq7Ajy0RcZvT0Dsf5_QQVd3TRng-p7ZXYxg@mail.gmail.com>

??
(crossposting from StackOverflow -
https://stackoverflow.com/q/47884874/6871135)

Dear all,

 in a package I am maintaining (https://github.com/lbusett/MODIStsp), I use
the `gdalUtils` package as a wrapper to
? ?
?call?

gdal processing ?
utilities. The problem is that I can not find a way to run my test suite
and examples on TRAVIS-CI. This appears
? ?
to
? ?
be related to the fact that the gdal installation folder is not found on
the path, so that I receive the following
? ?
error:

> Warning in gdalUtils::gdal_setInstallation(ignore.full_scan = TRUE)
> No GDAL installation found. Please install 'gdal' before continuing:
> - www.gdal.org (no HDF4 support!)
> - www.trac.osgeo.org/osgeo4w/ (with HDF4 support RECOMMENDED)
> - www.fwtools.maptools.org (with HDF4 support)

(see here for the full build log:
https://travis-ci.org/lbusett/MODIStsp/jobs/318037312)

`gdalUtils::gdal_setInstallation()` is supposed to search for a
? ?
valid gdal installation, by first using sys.which(), and (in
? ?
case it fails) looking on "typical" installation paths (see
https://www.rdocumentation.org/packages/gdalUtils/versions/2.0.1.7/topics/gdal_setInstallation
).

This happens besides gdal (apparently) being installed on travis in the
build, using the following travis.yml configuration:

language: r
cache: packages

warnings_are_errors: false

??
before_install:
  - sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable --yes
  - sudo add-apt-repository -y ppa:opencpu/jq --yes
  - sudo apt-get -qq update
  - sudo apt-get install -y libgdal-dev libproj-dev
  - PATH="/usr/local/gdal/bin:$PATH"
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start

matrix:
  include:
    - os: linux
      dist: trusty
      sudo: required
      env:
        global:
          - R_LIBS="http://cran.rstudio.com"
          - R_BUILD_ARGS="--no-build-vignettes --no-manual"
          - R_CHECK_ARGS="--no-build-vignettes --no-manual --as-cran"
          - R_CHECK_TIMINGS_="0"
          - BOOTSTRAP_LATEX="1"
      apt_packages:
            - libgdal-dev
            - libproj-dev
            - libcairo2-dev
            - libatk1.0-dev
            - libpango1.0-dev
            - libgtk2.0-dev
            - libglib2.0-dev
            - libcurl4-openssl-dev
      r_binary_packages:
        - cairoDevice
        - RGtk2

Do you have any suggestions to solve the issue? Do I need to somehow set
the PATH to gdal in the travis.yml script? If so, how could I find out
where gdal is being installed? (
I already
? ?
tried adding a line like
?
- PATH="/usr/local/gdal/bin:$PATH"
? ?
in
?
?
before_install
? within?
?
the yml but it did not work).

Thanks in advance for any help!

	[[alternative HTML version deleted]]


From sarah.friedrich at uni-ulm.de  Tue Dec 19 12:15:56 2017
From: sarah.friedrich at uni-ulm.de (Sarah Friedrich)
Date: Tue, 19 Dec 2017 12:15:56 +0100
Subject: [R-pkg-devel] "LoadLibrary failure" on Windows
Message-ID: <998db104-3c7b-245e-ec42-0c06fc30aa4e@uni-ulm.de>

Dear all,

the CRAN Package Check Results for my package GFD indicate an error on 
windows (https://cran.r-project.org/web/checks/check_results_GFD.html), 
which I am unable to fix. In my package, I'm using RGtk2 for creating a 
GUI. Since this produced errors before, I first check if RGtk2 is 
available via

requireNamespace("RGtk2", quietly = TRUE)
 ? if(!("package:RGtk2" %in% search())){attachNamespace("RGtk2")}

It all works fine on linux (x86_64-suse-linux-gnu (64-bit)) and on R 
version 3.2.5 on windows (x86_64-w64-mingw32/x64 (64-bit)), so I suspect 
that it's not actually an error in my package but something between 
RGtk2 and the new R version on windows. Anyway, a workaround would be 
greatly appreciated! Do you have any suggestions?

Thanks a lot in advance and best regards,
Sarah


From christine.blume at sbg.ac.at  Tue Dec 19 15:42:01 2017
From: christine.blume at sbg.ac.at (Blume Christine)
Date: Tue, 19 Dec 2017 14:42:01 +0000
Subject: [R-pkg-devel] nparACT package: "working directory was changed
	to...resetting"
In-Reply-To: <E20FE863CD1C294AA55E415F4C446424F24EB98E@xchmbx2.is.sbg.ac.at>
References: <E20FE863CD1C294AA55E415F4C446424F24EB98E@xchmbx2.is.sbg.ac.at>
Message-ID: <E20FE863CD1C294AA55E415F4C446424F24EB9B1@xchmbx2.is.sbg.ac.at>

Dear Community,



For Fedora my package now gives a warning message when running the example:



"Warning: working directory was changed to '/data/gannet/ripley/R/packages/tests-clang/nparACT.Rcheck/sleepstudy_example', resetting"



I do not really know how to approach/solve this, what has recently been changed in R devel so this error message started appearing?



The full message can be seen here: https://CRAN.R-project.org/web/checks/check_results_nparACT.html



Any help is appreciated and rewarded with gratitude.



Best,



Christine



	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Tue Dec 19 16:16:28 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 19 Dec 2017 10:16:28 -0500
Subject: [R-pkg-devel] "LoadLibrary failure" on Windows
In-Reply-To: <998db104-3c7b-245e-ec42-0c06fc30aa4e@uni-ulm.de>
References: <998db104-3c7b-245e-ec42-0c06fc30aa4e@uni-ulm.de>
Message-ID: <a1fa15bb-68f0-7532-9992-cd2c807e44e7@gmail.com>

On 19/12/2017 6:15 AM, Sarah Friedrich wrote:
> Dear all,
> 
> the CRAN Package Check Results for my package GFD indicate an error on
> windows (https://cran.r-project.org/web/checks/check_results_GFD.html),
> which I am unable to fix. In my package, I'm using RGtk2 for creating a
> GUI. Since this produced errors before, I first check if RGtk2 is
> available via
> 
> requireNamespace("RGtk2", quietly = TRUE)
>   ? if(!("package:RGtk2" %in% search())){attachNamespace("RGtk2")}

That code doesn't quite make sense.  Some background first:

A package can be "loaded" or "loaded and attached".  If your DESCRIPTION 
file has the package in the Imports list, it will be automatically 
loaded.  If it is in the Depends list, it will be automatically loaded 
and attached.  But if it is in the Suggests list, neither of these will 
happen automatically.

If a package is loaded but not attached, then it will not be on the 
search list.

You can load a package using requireNamespace().  Your first line of 
code does that.  If the package has already been loaded, nothing will 
happen.  You can load and attach it using require().  Both of these 
functions return a logical value to indicate success.

You almost never need to call attachNamespace.  If you really need to 
have the package on the search list (and this is rare), you should have 
called require().  Usually you just need code like this:

  if (!requireNamespace("RGtk2", quietly = TRUE))
    # Signal that RGtk2 is not available.

If the error didn't happen, then RGtk2 is now guaranteed to be loaded, 
and you can call functions from it using code like

RGtk2::foo()

If you don't want to always use the prefix RGtk2::, then you could have 
used require("RGtk2", quietly = TRUE) when you loaded it, but this is 
frowned upon, because the user might not want RGtk2 in their search 
list.  (It might have functions with the same names as functions from 
other packages, and that can mess up the user's code.)

Duncan Murdoch
> 
> It all works fine on linux (x86_64-suse-linux-gnu (64-bit)) and on R
> version 3.2.5 on windows (x86_64-w64-mingw32/x64 (64-bit)), so I suspect
> that it's not actually an error in my package but something between
> RGtk2 and the new R version on windows. Anyway, a workaround would be
> greatly appreciated! Do you have any suggestions?
> 
> Thanks a lot in advance and best regards,
> Sarah
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From murdoch.duncan at gmail.com  Tue Dec 19 16:19:15 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 19 Dec 2017 10:19:15 -0500
Subject: [R-pkg-devel] nparACT package: "working directory was changed
 to...resetting"
In-Reply-To: <E20FE863CD1C294AA55E415F4C446424F24EB9B1@xchmbx2.is.sbg.ac.at>
References: <E20FE863CD1C294AA55E415F4C446424F24EB98E@xchmbx2.is.sbg.ac.at>
 <E20FE863CD1C294AA55E415F4C446424F24EB9B1@xchmbx2.is.sbg.ac.at>
Message-ID: <864ef9b8-741d-aaae-f665-6e1089612613@gmail.com>

On 19/12/2017 9:42 AM, Blume Christine wrote:
> Dear Community,
> 
> 
> 
> For Fedora my package now gives a warning message when running the example:
> 
> 
> 
> "Warning: working directory was changed to '/data/gannet/ripley/R/packages/tests-clang/nparACT.Rcheck/sleepstudy_example', resetting"
> 
> 
> 
> I do not really know how to approach/solve this, what has recently been changed in R devel so this error message started appearing?

Previously you were allowed to change directory in an example.  Now 
you're not.  This makes sense:  the user might not want to change the 
working directory.

To fix this, just save the old directory, and restore it at the end of 
your example.  For example,

   olddir <- setwd(tempdir())
   # Run the rest of the example code here
   setwd(olddir)

Duncan Murdoch

> 
> 
> 
> The full message can be seen here: https://CRAN.R-project.org/web/checks/check_results_nparACT.html
> 
> 
> 
> Any help is appreciated and rewarded with gratitude.
> 
> 
> 
> Best,
> 
> 
> 
> Christine
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From christine.blume at sbg.ac.at  Tue Dec 19 16:27:04 2017
From: christine.blume at sbg.ac.at (Blume Christine)
Date: Tue, 19 Dec 2017 15:27:04 +0000
Subject: [R-pkg-devel] nparACT package: "working directory was changed
 to...resetting"
In-Reply-To: <864ef9b8-741d-aaae-f665-6e1089612613@gmail.com>
References: <E20FE863CD1C294AA55E415F4C446424F24EB98E@xchmbx2.is.sbg.ac.at>
 <E20FE863CD1C294AA55E415F4C446424F24EB9B1@xchmbx2.is.sbg.ac.at>
 <864ef9b8-741d-aaae-f665-6e1089612613@gmail.com>
Message-ID: <E20FE863CD1C294AA55E415F4C446424F24EBA04@xchmbx2.is.sbg.ac.at>

Hi Duncan,



Thanks a lot! Good to see that you had a similar idea, I did just that...in my example it looks like this, however, that does not help, i.e. that is the code that is associated with the warning?



data(sleepstudy)

wd <- getwd()

name <- "sleepstudy_example"

newdir <- paste(wd,name, sep="/")

if (dir.exists(newdir)){

setwd(newdir)

write.table(sleepstudy, file = "sleepstudy.txt", row.names=FALSE, col.names = FALSE)

r <- nparACT_flex_loop(newdir, SR = 4/60, minutes = 435)

} else {

dir.create(newdir)

setwd(newdir)

write.table(sleepstudy, file = "sleepstudy.txt", row.names=FALSE, col.names = FALSE)

r <- nparACT_flex_loop(newdir, SR = 4/60, minutes = 435)

}

setwd(wd)

}



Best,

Christine





-----Urspr?ngliche Nachricht-----
Von: Duncan Murdoch [mailto:murdoch.duncan at gmail.com]
Gesendet: Dienstag, 19. Dezember 2017 16:19
An: Blume Christine; r-package-devel at r-project.org
Betreff: Re: [R-pkg-devel] nparACT package: "working directory was changed to...resetting"



On 19/12/2017 9:42 AM, Blume Christine wrote:

> Dear Community,

>

>

>

> For Fedora my package now gives a warning message when running the example:

>

>

>

> "Warning: working directory was changed to '/data/gannet/ripley/R/packages/tests-clang/nparACT.Rcheck/sleepstudy_example', resetting"

>

>

>

> I do not really know how to approach/solve this, what has recently been changed in R devel so this error message started appearing?



Previously you were allowed to change directory in an example.  Now you're not.  This makes sense:  the user might not want to change the working directory.



To fix this, just save the old directory, and restore it at the end of your example.  For example,



   olddir <- setwd(tempdir())

   # Run the rest of the example code here

   setwd(olddir)



Duncan Murdoch



>

>

>

> The full message can be seen here:

> https://CRAN.R-project.org/web/checks/check_results_nparACT.html

>

>

>

> Any help is appreciated and rewarded with gratitude.

>

>

>

> Best,

>

>

>

> Christine

>

>

>

>             [[alternative HTML version deleted]]

>

> ______________________________________________

> R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list

> https://stat.ethz.ch/mailman/listinfo/r-package-devel

>



	[[alternative HTML version deleted]]


From i.ucar86 at gmail.com  Tue Dec 19 16:48:19 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Tue, 19 Dec 2017 16:48:19 +0100
Subject: [R-pkg-devel] nparACT package: "working directory was changed
	to...resetting"
In-Reply-To: <E20FE863CD1C294AA55E415F4C446424F24EBA04@xchmbx2.is.sbg.ac.at>
References: <E20FE863CD1C294AA55E415F4C446424F24EB98E@xchmbx2.is.sbg.ac.at>
 <E20FE863CD1C294AA55E415F4C446424F24EB9B1@xchmbx2.is.sbg.ac.at>
 <864ef9b8-741d-aaae-f665-6e1089612613@gmail.com>
 <E20FE863CD1C294AA55E415F4C446424F24EBA04@xchmbx2.is.sbg.ac.at>
Message-ID: <CALEXWq2twvee3KMyjYZCpzFQp5u5-wDzJC5TyfHEFN0pHQAYVQ@mail.gmail.com>

2017-12-19 16:27 GMT+01:00 Blume Christine <christine.blume at sbg.ac.at>:
> Hi Duncan,
>
> Thanks a lot! Good to see that you had a similar idea, I did just that...in my example it looks like this, however, that does not help, i.e. that is the code that is associated with the warning?
>
> data(sleepstudy)
>
> wd <- getwd()
>
> name <- "sleepstudy_example"
>
> newdir <- paste(wd,name, sep="/")
>
> if (dir.exists(newdir)){
>
> setwd(newdir)
>
> write.table(sleepstudy, file = "sleepstudy.txt", row.names=FALSE, col.names = FALSE)
>
> r <- nparACT_flex_loop(newdir, SR = 4/60, minutes = 435)
>
> } else {
>
> dir.create(newdir)
>
> setwd(newdir)
>
> write.table(sleepstudy, file = "sleepstudy.txt", row.names=FALSE, col.names = FALSE)
>
> r <- nparACT_flex_loop(newdir, SR = 4/60, minutes = 435)
>
> }
>
> setwd(wd)
>
> }

I see:

$ wget https://cran.r-project.org/src/contrib/nparACT_0.7.tar.gz
$ tar xf nparACT_0.7.tar.gz
$ grep -r setwd nparACT
nparACT/man/nparACT_flex_loop.Rd:setwd(newdir)
nparACT/man/nparACT_base_loop.Rd:setwd(newdir)

so two examples don't restore the wd as Duncan was pointing out.

I?aki

>
>
>
> Best,
>
> Christine
>
>


From xhudik at gmail.com  Tue Dec 19 17:01:48 2017
From: xhudik at gmail.com (Tomas Hudik)
Date: Tue, 19 Dec 2017 17:01:48 +0100
Subject: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E018F63991D@MBXP02.ds.man.ac.uk>
References: <mailman.10996.1513602895.1577.r-package-devel@r-project.org>
 <CAEE6Ne13pf_-SZ1DE-zjq7-N=X6at-JwedqrknyxpGPEC7Fpig@mail.gmail.com>
 <438D2EC9EAFE5946B2D5864670EA468E018F63991D@MBXP02.ds.man.ac.uk>
Message-ID: <CAEE6Ne3BALmZD9YZCAd1eRw0u7tQGpuJGJp555umb8zOqUDpFQ@mail.gmail.com>

Yes, I used oxygen. My point was that a majority of users is not familiar
Rd/oxygen and if somebody sees something like:

```
Examples

## Not run:
modify_message(12345, add_labels='label_1')
modify_message(12345, remove_labels='label_1')
#add and remove at the same time
modify_message(12345, add_labels='label_2', remove_labels='label_1')

## End(Not run)
```

he will be pretty much confused and will not get that it is because of a
special example that couldnt run for any reason.
Whether example run during package compilation might be important for
package creator but not so much for a regular user.

Therefore I think the question is whether a standard user needs to know
whether some code in help page run during the package compilation.


my 2c, Tomas


On Mon, Dec 18, 2017 at 8:07 PM, Georgi Boshnakov <
georgi.boshnakov at manchester.ac.uk> wrote:

> Hi,
>
> This actually is not about Rd format. Indeed, you are using   'roxygen'
> syntax.
>
> Examples are not run when there is a good reason (long time, internet
> connection required, specific local resources). This often means that the
> user needs to be made aware that something is not as straightforward as
> usual.
>
> A better question would probably be "Is there a better way to alert the
> user that the example is somehow special?" Maybe, but it is difficult to
> beat "Not run" for brevity and native English speakers would probably have
> come forward with a better replacement.
>
> Also, adding a note (in a comment before the example)  as to way an
> example is not run can be of benefit to both the user and the package
> author. Even if it is obvious at the time of writing, it may not be so
> months or years later.
>
> Kind regards,
> Georgi Boshnakov
>
> -----Original Message-----
> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On
> Behalf Of Tomas Hudik
> Sent: 18 December 2017 13:38
> To: r-package-devel at r-project.org
> Subject: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings
>
> Hi there,
>
> If I write a function with documentation (notice `\dontrun` section)
>
> #' Print a string.
> #'
> #' @examples
> #' \dontrun{
> #' str_length(letters)
> #'}
> print_str <- function(str) {
>   print(string)
> }
>
> `roxygenize()` will create proper Rd file, however, `R CMD check .` will
> generate:
> ```
> ...
> ## Not run:
> str_length(letters)
> ## End(Not run)
> ```
>
> If a person not familiar with Rd (majority of people) see such example, I
> do think he will be confused.
> Question - wouldnt be good to remove `## NOT run` strings by default (
> https://github.com/wch/r-source/blob/af7f52f70101960861e5d995d3a4be
> c010bc89e6/src/library/tools/R/Rd2latex.R#L238
> )
>
> E.g. see https://cran.r-project.org/web/packages/gmailr/gmailr.pdf - and
> go through example sections. There is not many people who would know what
> those cryptic `## Not Run` strings mean.
>
>
> thanks, Tomas
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/
> listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From christine.blume at sbg.ac.at  Tue Dec 19 17:17:53 2017
From: christine.blume at sbg.ac.at (Blume Christine)
Date: Tue, 19 Dec 2017 16:17:53 +0000
Subject: [R-pkg-devel] nparACT package: "working directory was changed
 to...resetting"
In-Reply-To: <CALEXWq2twvee3KMyjYZCpzFQp5u5-wDzJC5TyfHEFN0pHQAYVQ@mail.gmail.com>
References: <E20FE863CD1C294AA55E415F4C446424F24EB98E@xchmbx2.is.sbg.ac.at>
 <E20FE863CD1C294AA55E415F4C446424F24EB9B1@xchmbx2.is.sbg.ac.at>
 <864ef9b8-741d-aaae-f665-6e1089612613@gmail.com>
 <E20FE863CD1C294AA55E415F4C446424F24EBA04@xchmbx2.is.sbg.ac.at>
 <CALEXWq2twvee3KMyjYZCpzFQp5u5-wDzJC5TyfHEFN0pHQAYVQ@mail.gmail.com>
Message-ID: <E20FE863CD1C294AA55E415F4C446424F24EBAA8@xchmbx2.is.sbg.ac.at>

Actually, the report I received refers to the old 0.7 version?for whatever reason? The version I had submitted  was 0.8 in which I had corrected this. Well, let?s see?



Another issue seems to be that the text file the example is supposed to read in is not read (properly) using Debian:



Warning in is.na(data$activity) :

     is.na() applied to non-(list or vector) of type 'NULL'

    Error in 1:a : argument of length 0



I am reading in a text file with a numeric column (data$activity) and date or datetime (which is then converted using as.POSIXct. Subsequently, I check if there are NAs?



Any ideas what might be happening here?



Best,

Christine





-----Urspr?ngliche Nachricht-----
Von: I?aki ?car [mailto:i.ucar86 at gmail.com]
Gesendet: Dienstag, 19. Dezember 2017 16:48
An: Blume Christine
Cc: r-package-devel at r-project.org
Betreff: Re: [R-pkg-devel] nparACT package: "working directory was changed to...resetting"



2017-12-19 16:27 GMT+01:00 Blume Christine <christine.blume at sbg.ac.at<mailto:christine.blume at sbg.ac.at>>:

> Hi Duncan,

>

> Thanks a lot! Good to see that you had a similar idea, I did just that...in my example it looks like this, however, that does not help, i.e. that is the code that is associated with the warning?

>

> data(sleepstudy)

>

> wd <- getwd()

>

> name <- "sleepstudy_example"

>

> newdir <- paste(wd,name, sep="/")

>

> if (dir.exists(newdir)){

>

> setwd(newdir)

>

> write.table(sleepstudy, file = "sleepstudy.txt", row.names=FALSE, col.names = FALSE)

>

> r <- nparACT_flex_loop(newdir, SR = 4/60, minutes = 435)

>

> } else {

>

> dir.create(newdir)

>

> setwd(newdir)

>

> write.table(sleepstudy, file = "sleepstudy.txt", row.names=FALSE, col.names = FALSE)

>

> r <- nparACT_flex_loop(newdir, SR = 4/60, minutes = 435)

>

> }

>

> setwd(wd)

>

> }



I see:



$ wget https://cran.r-project.org/src/contrib/nparACT_0.7.tar.gz

$ tar xf nparACT_0.7.tar.gz

$ grep -r setwd nparACT

nparACT/man/nparACT_flex_loop.Rd:setwd(newdir)

nparACT/man/nparACT_base_loop.Rd:setwd(newdir)



so two examples don't restore the wd as Duncan was pointing out.



I?aki



>

>

>

> Best,

>

> Christine

>

>

	[[alternative HTML version deleted]]


From i.ucar86 at gmail.com  Tue Dec 19 17:40:58 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Tue, 19 Dec 2017 17:40:58 +0100
Subject: [R-pkg-devel] nparACT package: "working directory was changed
	to...resetting"
In-Reply-To: <E20FE863CD1C294AA55E415F4C446424F24EBAA8@xchmbx2.is.sbg.ac.at>
References: <E20FE863CD1C294AA55E415F4C446424F24EB98E@xchmbx2.is.sbg.ac.at>
 <E20FE863CD1C294AA55E415F4C446424F24EB9B1@xchmbx2.is.sbg.ac.at>
 <864ef9b8-741d-aaae-f665-6e1089612613@gmail.com>
 <E20FE863CD1C294AA55E415F4C446424F24EBA04@xchmbx2.is.sbg.ac.at>
 <CALEXWq2twvee3KMyjYZCpzFQp5u5-wDzJC5TyfHEFN0pHQAYVQ@mail.gmail.com>
 <E20FE863CD1C294AA55E415F4C446424F24EBAA8@xchmbx2.is.sbg.ac.at>
Message-ID: <CALEXWq0Zo0t+F5drcJUz_YykN95DcKnVx-QdP=SJDutVbtD5LQ@mail.gmail.com>

2017-12-19 17:17 GMT+01:00 Blume Christine <christine.blume at sbg.ac.at>:
> Actually, the report I received refers to the old 0.7 version?for whatever
> reason? The version I had submitted  was 0.8 in which I had corrected this.
> Well, let?s see?
>
>
>
> Another issue seems to be that the text file the example is supposed to read
> in is not read (properly) using Debian:
>
>
>
> Warning in is.na(data$activity) :
>
>      is.na() applied to non-(list or vector) of type 'NULL'
>
>     Error in 1:a : argument of length 0
>
>
>
> I am reading in a text file with a numeric column (data$activity) and date
> or datetime (which is then converted using as.POSIXct. Subsequently, I check
> if there are NAs?

It seems that data$activity is NULL (the column does not exist). That
would explain both the warning (is.na applied to non-(list or vector)
of type NULL) and the error (argument of length 0).

I?aki


From murdoch.duncan at gmail.com  Tue Dec 19 18:32:18 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 19 Dec 2017 12:32:18 -0500
Subject: [R-pkg-devel] nparACT package: "working directory was changed
 to...resetting"
In-Reply-To: <E20FE863CD1C294AA55E415F4C446424F24EBA04@xchmbx2.is.sbg.ac.at>
References: <E20FE863CD1C294AA55E415F4C446424F24EB98E@xchmbx2.is.sbg.ac.at>
 <E20FE863CD1C294AA55E415F4C446424F24EB9B1@xchmbx2.is.sbg.ac.at>
 <864ef9b8-741d-aaae-f665-6e1089612613@gmail.com>
 <E20FE863CD1C294AA55E415F4C446424F24EBA04@xchmbx2.is.sbg.ac.at>
Message-ID: <1f8cb1a5-a017-d265-ef03-99c526fe9a59@gmail.com>

On 19/12/2017 10:27 AM, Blume Christine wrote:
> Hi Duncan,
> 
> Thanks a lot! Good to see that you had a similar idea, I did just 
> that...in my example it looks like this, however, that does not help, 
> i.e. that is the code that is associated with the warning?
> 
> data(sleepstudy)
> 
> wd <- getwd()
> 
> name <- "sleepstudy_example"
> 
> newdir <- paste(wd,name, sep="/")
> 
> if (dir.exists(newdir)){
> 
> setwd(newdir)
> 
> write.table(sleepstudy, file = "sleepstudy.txt", row.names=FALSE, 
> col.names = FALSE)
> 
> r <- nparACT_flex_loop(newdir, SR = 4/60, minutes = 435)
> 
> } else {
> 
> dir.create(newdir)

This is probably a bad idea.  You're creating a subdirectory in the 
user's current working directory; you might not have file system 
permission to do that, and you probably don't have authorization from 
the user to do that.  I don't remember if CRAN checks for this, but I 
wouldn't be surprised if they do, or will in the future.

Since you need to write a file, you want to be sure that it's going to a 
place that is harmless and will succeed.  That's what tempdir() is for. 
At the end of your session it will be cleaned up, so you won't leave 
behind junk for the user.

So I would set newdir using

newdir <- file.path(tempdir(), name)

The other change I would make is to unconditionally use 
dir.create(newdir, showWarnings = FALSE).  You can be almost 100% sure 
that any error creating newdir will be just that it already exists, and 
since it's just somewhere in tempdir(), you don't really care about 
that.  This will simplify your example quite a bit.

Putting these two and my earlier suggestion together, your example becomes

data(sleepstudy)

name <- "sleepstudy_example"

newdir <- file.path(tempdir(),name)

dir.create(newdir, showWarnings = FALSE)

olddir <- setwd(newdir)

write.table(sleepstudy, file = "sleepstudy.txt", row.names=FALSE, 
col.names = FALSE)

r <- nparACT_flex_loop(newdir, SR = 4/60, minutes = 435)

setwd(olddir)

Duncan Murdoch



> 
> setwd(newdir)
> 
> write.table(sleepstudy, file = "sleepstudy.txt", row.names=FALSE, 
> col.names = FALSE)
> 
> r <- nparACT_flex_loop(newdir, SR = 4/60, minutes = 435)
> 
> }
> 
> setwd(wd)
> 
> }
> 
> Best,
> 
> Christine
> 
> -----Urspr?ngliche Nachricht-----
> Von: Duncan Murdoch [mailto:murdoch.duncan at gmail.com]
> Gesendet: Dienstag, 19. Dezember 2017 16:19
> An: Blume Christine; r-package-devel at r-project.org
> Betreff: Re: [R-pkg-devel] nparACT package: "working directory was 
> changed to...resetting"
> 
> On 19/12/2017 9:42 AM, Blume Christine wrote:
> 
>  > Dear Community,
> 
>  >
> 
>  >
> 
>  >
> 
>  > For Fedora my package now gives a warning message when running the 
> example:
> 
>  >
> 
>  >
> 
>  >
> 
>  > "Warning: working directory was changed to 
> '/data/gannet/ripley/R/packages/tests-clang/nparACT.Rcheck/sleepstudy_example', 
> resetting"
> 
>  >
> 
>  >
> 
>  >
> 
>  > I do not really know how to approach/solve this, what has recently 
> been changed in R devel so this error message started appearing?
> 
> Previously you were allowed to change directory in an example.? Now 
> you're not.? This makes sense:? the user might not want to change the 
> working directory.
> 
> To fix this, just save the old directory, and restore it at the end of 
> your example.? For example,
> 
>  ?? olddir <- setwd(tempdir())
> 
>  ?? # Run the rest of the example code here
> 
>  ?? setwd(olddir)
> 
> Duncan Murdoch
> 
>  >
> 
>  >
> 
>  >
> 
>  > The full message can be seen here:
> 
>  > https://CRAN.R-project.org/web/checks/check_results_nparACT.html
> 
>  >
> 
>  >
> 
>  >
> 
>  > Any help is appreciated and rewarded with gratitude.
> 
>  >
> 
>  >
> 
>  >
> 
>  > Best,
> 
>  >
> 
>  >
> 
>  >
> 
>  > Christine
> 
>  >
> 
>  >
> 
>  >
> 
>  > ??????????? [[alternative HTML version deleted]]
> 
>  >
> 
>  > ______________________________________________
> 
>> R-package-devel at r-project.org 
> <mailto:R-package-devel at r-project.org>mailing list
> 
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
>  >
>


From georgi.boshnakov at manchester.ac.uk  Tue Dec 19 18:35:44 2017
From: georgi.boshnakov at manchester.ac.uk (Georgi Boshnakov)
Date: Tue, 19 Dec 2017 17:35:44 +0000
Subject: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings
In-Reply-To: <CAEE6Ne3BALmZD9YZCAd1eRw0u7tQGpuJGJp555umb8zOqUDpFQ@mail.gmail.com>
References: <mailman.10996.1513602895.1577.r-package-devel@r-project.org>
 <CAEE6Ne13pf_-SZ1DE-zjq7-N=X6at-JwedqrknyxpGPEC7Fpig@mail.gmail.com>
 <438D2EC9EAFE5946B2D5864670EA468E018F63991D@MBXP02.ds.man.ac.uk>
 <CAEE6Ne3BALmZD9YZCAd1eRw0u7tQGpuJGJp555umb8zOqUDpFQ@mail.gmail.com>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E018F639AF8@MBXP02.ds.man.ac.uk>

? and my point was that it is not a matter of syntax, but that the user would better be alerted.

A user would be more confused and even irritated if they run an example and get surprises (such as having to wait a long time) or not getting any wiser.

The example you cite falls into the category of ?template examples?  - it is not really meant to be run as is.
You almost certainly will never encounter message 12345, for example.   In fact, it would probably give error.  This is a nice illustration of the usefulness of ?Not run? to give a sort of warning.
I bet that the package you have taken it from contains similar examples in other places, so a user will become aware of this.


Merry Christmas,
Georgi



From: Tomas Hudik [mailto:xhudik at gmail.com]
Sent: 19 December 2017 16:02
To: Georgi Boshnakov
Cc: r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings

Yes, I used oxygen. My point was that a majority of users is not familiar Rd/oxygen and if somebody sees something like:

```
Examples

## Not run:
modify_message(12345, add_labels='label_1')
modify_message(12345, remove_labels='label_1')
#add and remove at the same time
modify_message(12345, add_labels='label_2', remove_labels='label_1')

## End(Not run)
```
he will be pretty much confused and will not get that it is because of a special example that couldnt run for any reason.
Whether example run during package compilation might be important for package creator but not so much for a regular user.

Therefore I think the question is whether a standard user needs to know whether some code in help page run during the package compilation.

my 2c, Tomas


On Mon, Dec 18, 2017 at 8:07 PM, Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk<mailto:georgi.boshnakov at manchester.ac.uk>> wrote:
Hi,

This actually is not about Rd format. Indeed, you are using   'roxygen' syntax.

Examples are not run when there is a good reason (long time, internet connection required, specific local resources). This often means that the user needs to be made aware that something is not as straightforward as usual.

A better question would probably be "Is there a better way to alert the user that the example is somehow special?" Maybe, but it is difficult to beat "Not run" for brevity and native English speakers would probably have come forward with a better replacement.

Also, adding a note (in a comment before the example)  as to way an example is not run can be of benefit to both the user and the package author. Even if it is obvious at the time of writing, it may not be so months or years later.

Kind regards,
Georgi Boshnakov

-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org<mailto:r-package-devel-bounces at r-project.org>] On Behalf Of Tomas Hudik
Sent: 18 December 2017 13:38
To: r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>
Subject: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings

Hi there,

If I write a function with documentation (notice `\dontrun` section)

#' Print a string.
#'
#' @examples
#' \dontrun{
#' str_length(letters)
#'}
print_str <- function(str) {
  print(string)
}

`roxygenize()` will create proper Rd file, however, `R CMD check .` will
generate:
```
...
## Not run:
str_length(letters)
## End(Not run)
```

If a person not familiar with Rd (majority of people) see such example, I do think he will be confused.
Question - wouldnt be good to remove `## NOT run` strings by default ( https://github.com/wch/r-source/blob/af7f52f70101960861e5d995d3a4be
c010bc89e6/src/library/tools/R/Rd2latex.R#L238
)

E.g. see https://cran.r-project.org/web/packages/gmailr/gmailr.pdf - and go through example sections. There is not many people who would know what those cryptic `## Not Run` strings mean.


thanks, Tomas
        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From h.wickham at gmail.com  Tue Dec 19 20:22:16 2017
From: h.wickham at gmail.com (Hadley Wickham)
Date: Tue, 19 Dec 2017 13:22:16 -0600
Subject: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E018F63991D@MBXP02.ds.man.ac.uk>
References: <mailman.10996.1513602895.1577.r-package-devel@r-project.org>
 <CAEE6Ne13pf_-SZ1DE-zjq7-N=X6at-JwedqrknyxpGPEC7Fpig@mail.gmail.com>
 <438D2EC9EAFE5946B2D5864670EA468E018F63991D@MBXP02.ds.man.ac.uk>
Message-ID: <CABdHhvHbu6748C13--a5i=rs_g52RMJFdSO=bzQqZG+ToDsVuQ@mail.gmail.com>

> This actually is not about Rd format. Indeed, you are using   'roxygen' syntax.

This is unrelated to roxygen. \dontrun{} is Rd formatting.

Hadley

-- 
http://hadley.nz


From georgi.boshnakov at manchester.ac.uk  Tue Dec 19 23:20:28 2017
From: georgi.boshnakov at manchester.ac.uk (Georgi Boshnakov)
Date: Tue, 19 Dec 2017 22:20:28 +0000
Subject: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings
In-Reply-To: <CABdHhvHbu6748C13--a5i=rs_g52RMJFdSO=bzQqZG+ToDsVuQ@mail.gmail.com>
References: <mailman.10996.1513602895.1577.r-package-devel@r-project.org>
 <CAEE6Ne13pf_-SZ1DE-zjq7-N=X6at-JwedqrknyxpGPEC7Fpig@mail.gmail.com>
 <438D2EC9EAFE5946B2D5864670EA468E018F63991D@MBXP02.ds.man.ac.uk>
 <CABdHhvHbu6748C13--a5i=rs_g52RMJFdSO=bzQqZG+ToDsVuQ@mail.gmail.com>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E018F639B23@MBXP02.ds.man.ac.uk>

Sure, but \dontrun's function is to prevent the R tools from running the enclosed code.

How it is rendered is a completely separate matter.  The code in \dontrun is  not required to be executable (or even valid R code), so surely there should be some sort of visual clue in the rendered page. I don't argue whether it should be the one shown now or should be left entirely to the package author, although the current one seems reasonable to me.

Georgi


-----Original Message-----
From: Hadley Wickham [mailto:h.wickham at gmail.com] 
Sent: 19 December 2017 19:22
To: Georgi Boshnakov
Cc: Tomas Hudik; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings

> This actually is not about Rd format. Indeed, you are using   'roxygen' syntax.

This is unrelated to roxygen. \dontrun{} is Rd formatting.

Hadley

-- 
http://hadley.nz

From murdoch.duncan at gmail.com  Wed Dec 20 00:30:49 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 19 Dec 2017 18:30:49 -0500
Subject: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E018F639B23@MBXP02.ds.man.ac.uk>
References: <mailman.10996.1513602895.1577.r-package-devel@r-project.org>
 <CAEE6Ne13pf_-SZ1DE-zjq7-N=X6at-JwedqrknyxpGPEC7Fpig@mail.gmail.com>
 <438D2EC9EAFE5946B2D5864670EA468E018F63991D@MBXP02.ds.man.ac.uk>
 <CABdHhvHbu6748C13--a5i=rs_g52RMJFdSO=bzQqZG+ToDsVuQ@mail.gmail.com>
 <438D2EC9EAFE5946B2D5864670EA468E018F639B23@MBXP02.ds.man.ac.uk>
Message-ID: <52e49410-27c7-40c8-2a0f-1998a9c6d0e0@gmail.com>

On 19/12/2017 5:20 PM, Georgi Boshnakov wrote:
> Sure, but \dontrun's function is to prevent the R tools from running the enclosed code.
> 
> How it is rendered is a completely separate matter.  The code in \dontrun is  not required to be executable (or even valid R code), so surely there should be some sort of visual clue in the rendered page. I don't argue whether it should be the one shown now or should be left entirely to the package author, although the current one seems reasonable to me.

What you say in no way contradicts what Hadley said.  He's complaining 
about your earlier message blaming roxygen for this.  He's right, this 
isn't a roxygen issue, it's a general R help page issue.  However:

I'm finding it quite amazing that this thread has gone on as long as it 
has.  I think you suggested that package authors should add comments to 
their code explaining why they asked not to run some lines.  That's such 
a sensible suggestion that it should have ended the thread.

Duncan Murdoch

> Georgi
> 
> 
> -----Original Message-----
> From: Hadley Wickham [mailto:h.wickham at gmail.com]
> Sent: 19 December 2017 19:22
> To: Georgi Boshnakov
> Cc: Tomas Hudik; r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings
> 
>> This actually is not about Rd format. Indeed, you are using   'roxygen' syntax.
> 
> This is unrelated to roxygen. \dontrun{} is Rd formatting.
> 
> Hadley
>


From christine.blume at sbg.ac.at  Wed Dec 20 11:11:30 2017
From: christine.blume at sbg.ac.at (Blume Christine)
Date: Wed, 20 Dec 2017 10:11:30 +0000
Subject: [R-pkg-devel] Debian: example file is no longer read correctly
Message-ID: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>

Dear all,

I guess I need your help again. With debian my package (nparACT) gives an error message that seems to be related to loading the data:

 Warning in is.na(data$activity) :
     is.na() applied to non-(list or vector) of type 'NULL'
    Error in 1:a : argument of length 0

Although I have set up a virtual machine to test the package using the R devel version with Linux (Debian), it gives me a hard time to find out what is wrong since I do not manage to install packages using the devel version...

Does anyone know what has changed so this text file is not read in any longer? The code for reading in the text file is:

data <- read.table(paste(path,name, sep="/"), header = F)
    if (is.data.frame(data)==F){
      data = as.data.frame(data)
    }
    if(ncol(data) == 2){
      data[,1] <- as.POSIXct(data[,1])
      data[,2] <- as.numeric(as.character(data[,2]))
      names(data)[1] <- "time"
      names(data)[2] <- "activity"
   }
    if(ncol(data) == 3){
      names(data)[1] <- "date"
      names(data)[2] <- "time"
      names(data)[3] <- "activity"
      data$date <- NULL
      data$time <- as.POSIXct(data$time, format="%H:%M:%S")
      data$activity <- as.numeric(as.character(data$activity))
    }

Or can someone tell me how to install the package using R devel on Linux?

Thanks a lot!
Christine


	[[alternative HTML version deleted]]


From i.ucar86 at gmail.com  Wed Dec 20 11:47:33 2017
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Wed, 20 Dec 2017 11:47:33 +0100
Subject: [R-pkg-devel] Debian: example file is no longer read correctly
In-Reply-To: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>
References: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>
Message-ID: <CALEXWq223csXmenGRySRK-qQwB_vyn3h6EBmuxyDJq8KcLeLEA@mail.gmail.com>

2017-12-20 11:11 GMT+01:00 Blume Christine <christine.blume at sbg.ac.at>:
> Dear all,
>
> I guess I need your help again. With debian my package (nparACT) gives an error message that seems to be related to loading the data:
>
>  Warning in is.na(data$activity) :
>      is.na() applied to non-(list or vector) of type 'NULL'
>     Error in 1:a : argument of length 0
>
> Although I have set up a virtual machine to test the package using the R devel version with Linux (Debian), it gives me a hard time to find out what is wrong since I do not manage to install packages using the devel version...
>
> Does anyone know what has changed so this text file is not read in any longer? The code for reading in the text file is:
>
> data <- read.table(paste(path,name, sep="/"), header = F)
>     if (is.data.frame(data)==F){
>       data = as.data.frame(data)
>     }
>     if(ncol(data) == 2){
>       data[,1] <- as.POSIXct(data[,1])
>       data[,2] <- as.numeric(as.character(data[,2]))
>       names(data)[1] <- "time"
>       names(data)[2] <- "activity"
>    }
>     if(ncol(data) == 3){
>       names(data)[1] <- "date"
>       names(data)[2] <- "time"
>       names(data)[3] <- "activity"
>       data$date <- NULL
>       data$time <- as.POSIXct(data$time, format="%H:%M:%S")
>       data$activity <- as.numeric(as.character(data$activity))
>     }
>
> Or can someone tell me how to install the package using R devel on Linux?

You can try on rhub: https://github.com/r-hub/rhub

I?aki


From goran.brostrom at umu.se  Wed Dec 20 12:14:19 2017
From: goran.brostrom at umu.se (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Wed, 20 Dec 2017 12:14:19 +0100
Subject: [R-pkg-devel] Debian: example file is no longer read correctly
In-Reply-To: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>
References: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>
Message-ID: <b46dfbd0-dd36-5e7f-4bbf-1a0e7f7144fd@umu.se>

Christine,

the error message from CRAN/r-devel-linux suggests that the error comes 
from your function nparACT_flex_loop . There your code below is embedded
in a loop:

for (zz in 1:nofiles) ....

If nofiles == 0 (no found files), this loop is still executed (R is not 
Fortran). Maybe this is the cause of the failure?

You should anyway use seq_len(nofiles) or seq_along(files) instead of 
1:nofiles, or check the  number of files found.

G?ran

On 2017-12-20 11:11, Blume Christine wrote:
> Dear all,
> 
> I guess I need your help again. With debian my package (nparACT) gives an error message that seems to be related to loading the data:
> 
>   Warning in is.na(data$activity) :
>       is.na() applied to non-(list or vector) of type 'NULL'
>      Error in 1:a : argument of length 0
> 
> Although I have set up a virtual machine to test the package using the R devel version with Linux (Debian), it gives me a hard time to find out what is wrong since I do not manage to install packages using the devel version...
> 
> Does anyone know what has changed so this text file is not read in any longer? The code for reading in the text file is:
> 
> data <- read.table(paste(path,name, sep="/"), header = F)
>      if (is.data.frame(data)==F){
>        data = as.data.frame(data)
>      }
>      if(ncol(data) == 2){
>        data[,1] <- as.POSIXct(data[,1])
>        data[,2] <- as.numeric(as.character(data[,2]))
>        names(data)[1] <- "time"
>        names(data)[2] <- "activity"
>     }
>      if(ncol(data) == 3){
>        names(data)[1] <- "date"
>        names(data)[2] <- "time"
>        names(data)[3] <- "activity"
>        data$date <- NULL
>        data$time <- as.POSIXct(data$time, format="%H:%M:%S")
>        data$activity <- as.numeric(as.character(data$activity))
>      }
> 
> Or can someone tell me how to install the package using R devel on Linux?
> 
> Thanks a lot!
> Christine
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From benjamin.leutner at uni-wuerzburg.de  Wed Dec 20 13:47:51 2017
From: benjamin.leutner at uni-wuerzburg.de (Benjamin Leutner)
Date: Wed, 20 Dec 2017 13:47:51 +0100
Subject: [R-pkg-devel] Finding/specifying Installation path of gdal in a
 travis-ci build
In-Reply-To: <CAM1G4SRKViLPcg-iq7Ajy0RcZvT0Dsf5_QQVd3TRng-p7ZXYxg@mail.gmail.com>
References: <CAM1G4SRKViLPcg-iq7Ajy0RcZvT0Dsf5_QQVd3TRng-p7ZXYxg@mail.gmail.com>
Message-ID: <99b4ae64-e1a3-011e-fdab-078e09a07aba@uni-wuerzburg.de>

Hi,

I can't speak for gdalUtils, but my package uses rgdal and builds well 
on travis.
I'm also installing gdal-bin, which you are not. Maybe that helps.
Here's my (admittedly somewhat messy) travis file:
https://github.com/bleutner/RStoolbox/blob/master/.travis.yml

Cheers,
Benjamin

On 12/19/2017 02:45 PM, Lorenzo Busetto wrote:
> ??
> (crossposting from StackOverflow -
> https://stackoverflow.com/q/47884874/6871135)
>
> Dear all,
>
>   in a package I am maintaining (https://github.com/lbusett/MODIStsp), I use
> the `gdalUtils` package as a wrapper to
> ? ?
> ?call?
>
> gdal processing ?
> utilities. The problem is that I can not find a way to run my test suite
> and examples on TRAVIS-CI. This appears
> ? ?
> to
> ? ?
> be related to the fact that the gdal installation folder is not found on
> the path, so that I receive the following
> ? ?
> error:
>
>> Warning in gdalUtils::gdal_setInstallation(ignore.full_scan = TRUE)
>> No GDAL installation found. Please install 'gdal' before continuing:
>> - www.gdal.org (no HDF4 support!)
>> - www.trac.osgeo.org/osgeo4w/ (with HDF4 support RECOMMENDED)
>> - www.fwtools.maptools.org (with HDF4 support)
> (see here for the full build log:
> https://travis-ci.org/lbusett/MODIStsp/jobs/318037312)
>
> `gdalUtils::gdal_setInstallation()` is supposed to search for a
> ? ?
> valid gdal installation, by first using sys.which(), and (in
> ? ?
> case it fails) looking on "typical" installation paths (see
> https://www.rdocumentation.org/packages/gdalUtils/versions/2.0.1.7/topics/gdal_setInstallation
> ).
>
> This happens besides gdal (apparently) being installed on travis in the
> build, using the following travis.yml configuration:
>
> language: r
> cache: packages
>
> warnings_are_errors: false
>
> ??
> before_install:
>    - sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable --yes
>    - sudo add-apt-repository -y ppa:opencpu/jq --yes
>    - sudo apt-get -qq update
>    - sudo apt-get install -y libgdal-dev libproj-dev
>    - PATH="/usr/local/gdal/bin:$PATH"
>    - export DISPLAY=:99.0
>    - sh -e /etc/init.d/xvfb start
>
> matrix:
>    include:
>      - os: linux
>        dist: trusty
>        sudo: required
>        env:
>          global:
>            - R_LIBS="http://cran.rstudio.com"
>            - R_BUILD_ARGS="--no-build-vignettes --no-manual"
>            - R_CHECK_ARGS="--no-build-vignettes --no-manual --as-cran"
>            - R_CHECK_TIMINGS_="0"
>            - BOOTSTRAP_LATEX="1"
>        apt_packages:
>              - libgdal-dev
>              - libproj-dev
>              - libcairo2-dev
>              - libatk1.0-dev
>              - libpango1.0-dev
>              - libgtk2.0-dev
>              - libglib2.0-dev
>              - libcurl4-openssl-dev
>        r_binary_packages:
>          - cairoDevice
>          - RGtk2
>
> Do you have any suggestions to solve the issue? Do I need to somehow set
> the PATH to gdal in the travis.yml script? If so, how could I find out
> where gdal is being installed? (
> I already
> ? ?
> tried adding a line like
> ?
> - PATH="/usr/local/gdal/bin:$PATH"
> ? ?
> in
> ?
> ?
> before_install
> ? within?
> ?
> the yml but it did not work).
>
> Thanks in advance for any help!
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From goran.brostrom at umu.se  Wed Dec 20 14:02:59 2017
From: goran.brostrom at umu.se (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Wed, 20 Dec 2017 14:02:59 +0100
Subject: [R-pkg-devel] Debian: example file is no longer read correctly
In-Reply-To: <b46dfbd0-dd36-5e7f-4bbf-1a0e7f7144fd@umu.se>
References: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>
 <b46dfbd0-dd36-5e7f-4bbf-1a0e7f7144fd@umu.se>
Message-ID: <d7ead55f-69ba-6efb-af60-65d2f1bfdd13@umu.se>

On 2017-12-20 12:14, G?ran Brostr?m wrote:
> Christine,
> 
> the error message from CRAN/r-devel-linux suggests that the error comes 
> from your function nparACT_flex_loop . There your code below is embedded
> in a loop:
> 
> for (zz in 1:nofiles) ....
> 
> If nofiles == 0 (no found files), this loop is still executed (R is not 
> Fortran). Maybe this is the cause of the failure?

No, it is not. But when I ran R CMD check --as-cran ..., a file 
'nparACT-Ex.timings' was created in 
'nparACT.Rcheck/sleepstudy_example/', which your example reads, and 
disaster follows.

R CMD check (without --as-cran) avoids this problem, but CRAN will not 
accept it. Seems to be the writing to and reading from disc that is 
problematic and in need of some structure? Others may help with that.

G?ran

> 
> You should anyway use seq_len(nofiles) or seq_along(files) instead of 
> 1:nofiles, or check the? number of files found.
> 
> G?ran
> 
> On 2017-12-20 11:11, Blume Christine wrote:
>> Dear all,
>>
>> I guess I need your help again. With debian my package (nparACT) gives 
>> an error message that seems to be related to loading the data:
>>
>> ? Warning in is.na(data$activity) :
>> ????? is.na() applied to non-(list or vector) of type 'NULL'
>> ???? Error in 1:a : argument of length 0
>>
>> Although I have set up a virtual machine to test the package using the 
>> R devel version with Linux (Debian), it gives me a hard time to find 
>> out what is wrong since I do not manage to install packages using the 
>> devel version...
>>
>> Does anyone know what has changed so this text file is not read in any 
>> longer? The code for reading in the text file is:
>>
>> data <- read.table(paste(path,name, sep="/"), header = F)
>> ???? if (is.data.frame(data)==F){
>> ?????? data = as.data.frame(data)
>> ???? }
>> ???? if(ncol(data) == 2){
>> ?????? data[,1] <- as.POSIXct(data[,1])
>> ?????? data[,2] <- as.numeric(as.character(data[,2]))
>> ?????? names(data)[1] <- "time"
>> ?????? names(data)[2] <- "activity"
>> ??? }
>> ???? if(ncol(data) == 3){
>> ?????? names(data)[1] <- "date"
>> ?????? names(data)[2] <- "time"
>> ?????? names(data)[3] <- "activity"
>> ?????? data$date <- NULL
>> ?????? data$time <- as.POSIXct(data$time, format="%H:%M:%S")
>> ?????? data$activity <- as.numeric(as.character(data$activity))
>> ???? }
>>
>> Or can someone tell me how to install the package using R devel on Linux?
>>
>> Thanks a lot!
>> Christine
>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From georgi.boshnakov at manchester.ac.uk  Wed Dec 20 14:49:10 2017
From: georgi.boshnakov at manchester.ac.uk (Georgi Boshnakov)
Date: Wed, 20 Dec 2017 13:49:10 +0000
Subject: [R-pkg-devel] Debian: example file is no longer read correctly
In-Reply-To: <d7ead55f-69ba-6efb-af60-65d2f1bfdd13@umu.se>
References: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>
 <b46dfbd0-dd36-5e7f-4bbf-1a0e7f7144fd@umu.se>
 <d7ead55f-69ba-6efb-af60-65d2f1bfdd13@umu.se>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E018F63AC3A@MBXP02.ds.man.ac.uk>

The package on CRAN doesn't use tempdir()  to change directories. 
Given that the error occurs on some linux-es only, it may be worth a try to submit the package
and see if these errors will resurface. 

It is difficult to debug errors on systems you don't have but some cleanup of your code might help your users and you.
In particular, write more defensively. For example, in your function (see a copy further bbelow) you may consider if it is fine to convert each file to a data.frame. Even if this is successful,  the data frame may not be what you expect.
 One good idea is to write exhaustive checks.

The check for nofiles > 0 was already suggested, another suggestion is after the signature below. 

Kind regards,
Georgi Boshnakov

The chunk:

=========
        if (ncol(data) == 2) {
            ...
        }
        if (ncol(data) == 3) {
              ... 
        }
==========

can be made more robust by simply adding an 'else' (note also the else if) to cover for a condition that "cannot" happen.

=========
        if (ncol(data) == 2) {
            ...
        }  else if (ncol(data) == 3) {
              ... 
        } else {
             stop(""I thought that this can never happen!")
       }
==========


=================

nparACT_flex_loop()
function (path, SR, cutoff = 1, minutes, plot = T, fulldays = T) 
{
    files <- list.files(path)
    fileext <- file_ext(files[1])
    nofiles <- length(files)
    bin_hr <- 60
    nparACT_result <- matrix(NA, nofiles, 9)
    nparACT_result <- as.data.frame(nparACT_result)
    colnames(nparACT_result) <- c("IS", "IV", "RA", "L5", "L5_starttime", 
        "M10", "M10_starttime", "Lflex", "Lflex_starttime")
    matrix_hraverage <- matrix(NA, nofiles, 24)
    for (zz in 1:nofiles) {
        name <- files[zz]
        if (fileext == "txt") {
            data <- read.table(paste(path, name, sep = "/"), 
                header = F)
        }
        else {
            data <- read.csv(paste(path, name, sep = "/"), header = F)
        }
        if (is.data.frame(data) == F) {
            data = as.data.frame(data)
        }
        if (ncol(data) == 2) {
            data[, 1] <- as.POSIXct(data[, 1])
            data[, 2] <- as.numeric(as.character(data[, 2]))
            names(data)[1] <- "time"
            names(data)[2] <- "activity"
        }
        if (ncol(data) == 3) {
            names(data)[1] <- "date"
            names(data)[2] <- "time"
            names(data)[3] <- "activity"
            data$date <- NULL
            data$time <- as.POSIXct(data$time, format = "%H:%M:%S")
            data$activity <- as.numeric(as.character(data$activity))
        }
        if (any(is.na(data$activity)) == TRUE) 
            stop("Please check your data! It must not contain NAs")
        a <- nrow(data)
        e <- SR * 60
        m <- bin_hr * SR * 60
        full_days <- floor(a/(e * bin_hr * 24))
        if (fulldays == T) {
            data <- data[1:(e * bin_hr * 24 * full_days), ]
        }
        a <- nrow(data)
        b <- floor(a/(SR * 60))
        nparACT_auxfunctions1$nparACT_filt(data, a, cutoff)
        if (SR != 1/60) {
            data_min <- nparACT_auxfunctions1$nparACT_data_min(b, 
                SR, data)
        }
        else {
            data_min <- data$activity
        }
        data_hrs <- nparACT_auxfunctions1$nparACT_data_hrs(data, 
            a, m)
        result_ISIV <- nparACT_ISIVfunctions$nparACT_ISIV(data_hrs, 
            bin_hr)
        IS <- result_ISIV[1]
        IV <- result_ISIV[2]
        nparACT_result[zz, 1] <- IS
        nparACT_result[zz, 2] <- IV
        minaverage <- nparACT_auxfunctions1$nparACT_minaverage(a, 
            data_min)
        if (plot == T) {
            hraverage_sorted <- nparACT_auxfunctions1$nparACT_hraverage_GA_loop(minaverage, 
                data, a, SR)
            matrix_hraverage[zz, ] <- hraverage_sorted
        }
        result_RA <- nparACT_RAfunctions$nparACT_L5M10Lflex(data, 
            minaverage, a, SR, minutes)
        result_RA <- as.data.frame(result_RA)
        nparACT_result[zz, 3] <- result_RA$RA
        nparACT_result[zz, 4] <- result_RA$L5
        nparACT_result[zz, 5] <- as.character(result_RA$L5_starttime)
        nparACT_result[zz, 6] <- result_RA$M10
        nparACT_result[zz, 7] <- as.character(result_RA$M10_starttime)
        nparACT_result[zz, 8] <- result_RA$Lflex
        nparACT_result[zz, 9] <- as.character(result_RA$Lflex_starttime)
    }
    nparACT_result <- nparACT_result
    if (plot == T) {
        nparACT_auxfunctions2$nparACT_plot_hraverage_GA_loop(matrix_hraverage)
    }
    return(nparACT_result)
}
<environment: namespace:nparACT>

-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of G?ran Brostr?m
Sent: 20 December 2017 13:03
To: r-package-devel at r-project.org; Blume Christine
Subject: Re: [R-pkg-devel] Debian: example file is no longer read correctly

On 2017-12-20 12:14, G?ran Brostr?m wrote:
> Christine,
> 
> the error message from CRAN/r-devel-linux suggests that the error 
> comes from your function nparACT_flex_loop . There your code below is 
> embedded in a loop:
> 
> for (zz in 1:nofiles) ....
> 
> If nofiles == 0 (no found files), this loop is still executed (R is 
> not Fortran). Maybe this is the cause of the failure?

No, it is not. But when I ran R CMD check --as-cran ..., a file 'nparACT-Ex.timings' was created in 'nparACT.Rcheck/sleepstudy_example/', which your example reads, and disaster follows.

R CMD check (without --as-cran) avoids this problem, but CRAN will not accept it. Seems to be the writing to and reading from disc that is problematic and in need of some structure? Others may help with that.

G?ran

> 
> You should anyway use seq_len(nofiles) or seq_along(files) instead of 
> 1:nofiles, or check the? number of files found.
> 
> G?ran
> 
> On 2017-12-20 11:11, Blume Christine wrote:
>> Dear all,
>>
>> I guess I need your help again. With debian my package (nparACT) 
>> gives an error message that seems to be related to loading the data:
>>
>> ? Warning in is.na(data$activity) :
>> ????? is.na() applied to non-(list or vector) of type 'NULL'
>> ???? Error in 1:a : argument of length 0
>>
>> Although I have set up a virtual machine to test the package using 
>> the R devel version with Linux (Debian), it gives me a hard time to 
>> find out what is wrong since I do not manage to install packages 
>> using the devel version...
>>
>> Does anyone know what has changed so this text file is not read in 
>> any longer? The code for reading in the text file is:
>>
>> data <- read.table(paste(path,name, sep="/"), header = F)
>> ???? if (is.data.frame(data)==F){
>> ?????? data = as.data.frame(data)
>> ???? }
>> ???? if(ncol(data) == 2){
>> ?????? data[,1] <- as.POSIXct(data[,1])
>> ?????? data[,2] <- as.numeric(as.character(data[,2]))
>> ?????? names(data)[1] <- "time"
>> ?????? names(data)[2] <- "activity"
>> ??? }
>> ???? if(ncol(data) == 3){
>> ?????? names(data)[1] <- "date"
>> ?????? names(data)[2] <- "time"
>> ?????? names(data)[3] <- "activity"
>> ?????? data$date <- NULL
>> ?????? data$time <- as.POSIXct(data$time, format="%H:%M:%S")
>> ?????? data$activity <- as.numeric(as.character(data$activity))
>> ???? }
>>
>> Or can someone tell me how to install the package using R devel on Linux?
>>
>> Thanks a lot!
>> Christine
>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list 
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

______________________________________________
R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel

From goran.brostrom at umu.se  Wed Dec 20 15:32:53 2017
From: goran.brostrom at umu.se (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Wed, 20 Dec 2017 15:32:53 +0100
Subject: [R-pkg-devel] Debian: example file is no longer read correctly
In-Reply-To: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>
References: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>
Message-ID: <f5a277a6-c48c-61f7-5d22-f77a94929f6f@umu.se>



On 2017-12-20 11:11, Blume Christine wrote:
> Dear all,
> 

[...]

> 
> Or can someone tell me how to install the package using R devel on Linux?

Good question (which I missed). I do it like this:

(i) Download and unpack the tarball R-devel.... in ~/src/
(ii) ./configure and make
(iii) Start R-devel:  $ ~/src/R-devel/bin/R
(iv) > install.packages(...)

This seems to install packages in R-devel/library/, separate from your 
main R installation. Note that I do not install R-devel.

This is found by trial-and-error. I don't know if it is the recommended way.

G?ran

> 
> Thanks a lot!
> Christine
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From goran.brostrom at umu.se  Wed Dec 20 15:40:58 2017
From: goran.brostrom at umu.se (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Wed, 20 Dec 2017 15:40:58 +0100
Subject: [R-pkg-devel] Debian: example file is no longer read correctly
In-Reply-To: <f5a277a6-c48c-61f7-5d22-f77a94929f6f@umu.se>
References: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>
 <f5a277a6-c48c-61f7-5d22-f77a94929f6f@umu.se>
Message-ID: <a269e2f2-e729-11a6-0edc-a55ddcfdf91c@umu.se>



On 2017-12-20 15:32, G?ran Brostr?m wrote:
> 
> 
> On 2017-12-20 11:11, Blume Christine wrote:
>> Dear all,
>>
> 
> [...]
> 
>>
>> Or can someone tell me how to install the package using R devel on Linux?
> 
> Good question (which I missed). I do it like this:
> 
> (i) Download and unpack the tarball R-devel.... in ~/src/
> (ii) ./configure and make
> (iii) Start R-devel:? $ ~/src/R-devel/bin/R
> (iv) > install.packages(...)

Or

(iii) $ ~/src/R-devel/bin/R CMD INSTALL ....tar.gz

G?ran

> 
> This seems to install packages in R-devel/library/, separate from your 
> main R installation. Note that I do not install R-devel.
> 
> This is found by trial-and-error. I don't know if it is the recommended 
> way.
> 
> G?ran
> 
>>
>> Thanks a lot!
>> Christine
>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From xhudik at gmail.com  Wed Dec 20 15:53:21 2017
From: xhudik at gmail.com (Tomas Hudik)
Date: Wed, 20 Dec 2017 15:53:21 +0100
Subject: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E018F639B23@MBXP02.ds.man.ac.uk>
References: <mailman.10996.1513602895.1577.r-package-devel@r-project.org>
 <CAEE6Ne13pf_-SZ1DE-zjq7-N=X6at-JwedqrknyxpGPEC7Fpig@mail.gmail.com>
 <438D2EC9EAFE5946B2D5864670EA468E018F63991D@MBXP02.ds.man.ac.uk>
 <CABdHhvHbu6748C13--a5i=rs_g52RMJFdSO=bzQqZG+ToDsVuQ@mail.gmail.com>
 <438D2EC9EAFE5946B2D5864670EA468E018F639B23@MBXP02.ds.man.ac.uk>
Message-ID: <CAEE6Ne399PcSgkeCVnGRrwZGE32jUpcktGPipo4xKDj_XR62qw@mail.gmail.com>

Hi,
thank you guys for fast replies - good ideas and points! They completely
makes sense.

@Georgi - yes, the rendering is the issue. I personally find \dontrun{}
better understandable then rendered ## Not Run.
Maybe even better would be to have rendered "r-markdown kind" where you can
click on a small triangle icon(
http://rmarkdown.rstudio.com/r_notebooks.html#executing_code) and the
example would run for you. So user can:
1. run the code when he wants
2. wont have to think whether ## Not run is a comment or some kind of
escape or special command (my case 3 days before)

I understand "r-markdown kind" rendering would be possible in GUI apps only
(Rstudio). The question is how to do it on R core (command line) level.

what do you think?



best, Tomas




On Tue, Dec 19, 2017 at 11:20 PM, Georgi Boshnakov <
georgi.boshnakov at manchester.ac.uk> wrote:

> Sure, but \dontrun's function is to prevent the R tools from running the
> enclosed code.
>
> How it is rendered is a completely separate matter.  The code in \dontrun
> is  not required to be executable (or even valid R code), so surely there
> should be some sort of visual clue in the rendered page. I don't argue
> whether it should be the one shown now or should be left entirely to the
> package author, although the current one seems reasonable to me.
>
> Georgi
>
>
> -----Original Message-----
> From: Hadley Wickham [mailto:h.wickham at gmail.com]
> Sent: 19 December 2017 19:22
> To: Georgi Boshnakov
> Cc: Tomas Hudik; r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] Fwd: R CMD check and strange ## Not run strings
>
> > This actually is not about Rd format. Indeed, you are using   'roxygen'
> syntax.
>
> This is unrelated to roxygen. \dontrun{} is Rd formatting.
>
> Hadley
>
> --
> http://hadley.nz
>

	[[alternative HTML version deleted]]


From christine.blume at sbg.ac.at  Wed Dec 20 16:02:08 2017
From: christine.blume at sbg.ac.at (Blume Christine)
Date: Wed, 20 Dec 2017 15:02:08 +0000
Subject: [R-pkg-devel] Debian: example file is no longer read correctly
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E018F63AC3A@MBXP02.ds.man.ac.uk>
References: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>
 <b46dfbd0-dd36-5e7f-4bbf-1a0e7f7144fd@umu.se>
 <d7ead55f-69ba-6efb-af60-65d2f1bfdd13@umu.se>
 <438D2EC9EAFE5946B2D5864670EA468E018F63AC3A@MBXP02.ds.man.ac.uk>
Message-ID: <E20FE863CD1C294AA55E415F4C446424F24EC066@xchmbx2.is.sbg.ac.at>

Dear all,

Thanks a lot for all your suggestions, which I was happy to include. All my coding skills are self-taught so I am especially thankful for suggestions on how to improve the code regarding defensiveness etc..

I have also followed I?aki's excellent suggestion and checked the package with the latest changes to the example (to circumvent the path-setting problems) using rhub using different platforms. 

I have submitted the version with the corrections again earlier and it is on its way to CRAN now.

Thanks again,
Christine



-----Urspr?ngliche Nachricht-----
Von: Georgi Boshnakov [mailto:georgi.boshnakov at manchester.ac.uk] 
Gesendet: Mittwoch, 20. Dezember 2017 14:49
An: G?ran Brostr?m; r-package-devel at r-project.org; Blume Christine
Betreff: RE: [R-pkg-devel] Debian: example file is no longer read correctly

The package on CRAN doesn't use tempdir()  to change directories. 
Given that the error occurs on some linux-es only, it may be worth a try to submit the package and see if these errors will resurface. 

It is difficult to debug errors on systems you don't have but some cleanup of your code might help your users and you.
In particular, write more defensively. For example, in your function (see a copy further bbelow) you may consider if it is fine to convert each file to a data.frame. Even if this is successful,  the data frame may not be what you expect.
 One good idea is to write exhaustive checks.

The check for nofiles > 0 was already suggested, another suggestion is after the signature below. 

Kind regards,
Georgi Boshnakov

The chunk:

=========
        if (ncol(data) == 2) {
            ...
        }
        if (ncol(data) == 3) {
              ... 
        }
==========

can be made more robust by simply adding an 'else' (note also the else if) to cover for a condition that "cannot" happen.

=========
        if (ncol(data) == 2) {
            ...
        }  else if (ncol(data) == 3) {
              ... 
        } else {
             stop(""I thought that this can never happen!")
       }
==========


=================

nparACT_flex_loop()
function (path, SR, cutoff = 1, minutes, plot = T, fulldays = T) {
    files <- list.files(path)
    fileext <- file_ext(files[1])
    nofiles <- length(files)
    bin_hr <- 60
    nparACT_result <- matrix(NA, nofiles, 9)
    nparACT_result <- as.data.frame(nparACT_result)
    colnames(nparACT_result) <- c("IS", "IV", "RA", "L5", "L5_starttime", 
        "M10", "M10_starttime", "Lflex", "Lflex_starttime")
    matrix_hraverage <- matrix(NA, nofiles, 24)
    for (zz in 1:nofiles) {
        name <- files[zz]
        if (fileext == "txt") {
            data <- read.table(paste(path, name, sep = "/"), 
                header = F)
        }
        else {
            data <- read.csv(paste(path, name, sep = "/"), header = F)
        }
        if (is.data.frame(data) == F) {
            data = as.data.frame(data)
        }
        if (ncol(data) == 2) {
            data[, 1] <- as.POSIXct(data[, 1])
            data[, 2] <- as.numeric(as.character(data[, 2]))
            names(data)[1] <- "time"
            names(data)[2] <- "activity"
        }
        if (ncol(data) == 3) {
            names(data)[1] <- "date"
            names(data)[2] <- "time"
            names(data)[3] <- "activity"
            data$date <- NULL
            data$time <- as.POSIXct(data$time, format = "%H:%M:%S")
            data$activity <- as.numeric(as.character(data$activity))
        }
        if (any(is.na(data$activity)) == TRUE) 
            stop("Please check your data! It must not contain NAs")
        a <- nrow(data)
        e <- SR * 60
        m <- bin_hr * SR * 60
        full_days <- floor(a/(e * bin_hr * 24))
        if (fulldays == T) {
            data <- data[1:(e * bin_hr * 24 * full_days), ]
        }
        a <- nrow(data)
        b <- floor(a/(SR * 60))
        nparACT_auxfunctions1$nparACT_filt(data, a, cutoff)
        if (SR != 1/60) {
            data_min <- nparACT_auxfunctions1$nparACT_data_min(b, 
                SR, data)
        }
        else {
            data_min <- data$activity
        }
        data_hrs <- nparACT_auxfunctions1$nparACT_data_hrs(data, 
            a, m)
        result_ISIV <- nparACT_ISIVfunctions$nparACT_ISIV(data_hrs, 
            bin_hr)
        IS <- result_ISIV[1]
        IV <- result_ISIV[2]
        nparACT_result[zz, 1] <- IS
        nparACT_result[zz, 2] <- IV
        minaverage <- nparACT_auxfunctions1$nparACT_minaverage(a, 
            data_min)
        if (plot == T) {
            hraverage_sorted <- nparACT_auxfunctions1$nparACT_hraverage_GA_loop(minaverage, 
                data, a, SR)
            matrix_hraverage[zz, ] <- hraverage_sorted
        }
        result_RA <- nparACT_RAfunctions$nparACT_L5M10Lflex(data, 
            minaverage, a, SR, minutes)
        result_RA <- as.data.frame(result_RA)
        nparACT_result[zz, 3] <- result_RA$RA
        nparACT_result[zz, 4] <- result_RA$L5
        nparACT_result[zz, 5] <- as.character(result_RA$L5_starttime)
        nparACT_result[zz, 6] <- result_RA$M10
        nparACT_result[zz, 7] <- as.character(result_RA$M10_starttime)
        nparACT_result[zz, 8] <- result_RA$Lflex
        nparACT_result[zz, 9] <- as.character(result_RA$Lflex_starttime)
    }
    nparACT_result <- nparACT_result
    if (plot == T) {
        nparACT_auxfunctions2$nparACT_plot_hraverage_GA_loop(matrix_hraverage)
    }
    return(nparACT_result)
}
<environment: namespace:nparACT>

-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of G?ran Brostr?m
Sent: 20 December 2017 13:03
To: r-package-devel at r-project.org; Blume Christine
Subject: Re: [R-pkg-devel] Debian: example file is no longer read correctly

On 2017-12-20 12:14, G?ran Brostr?m wrote:
> Christine,
> 
> the error message from CRAN/r-devel-linux suggests that the error 
> comes from your function nparACT_flex_loop . There your code below is 
> embedded in a loop:
> 
> for (zz in 1:nofiles) ....
> 
> If nofiles == 0 (no found files), this loop is still executed (R is 
> not Fortran). Maybe this is the cause of the failure?

No, it is not. But when I ran R CMD check --as-cran ..., a file 'nparACT-Ex.timings' was created in 'nparACT.Rcheck/sleepstudy_example/', which your example reads, and disaster follows.

R CMD check (without --as-cran) avoids this problem, but CRAN will not accept it. Seems to be the writing to and reading from disc that is problematic and in need of some structure? Others may help with that.

G?ran

> 
> You should anyway use seq_len(nofiles) or seq_along(files) instead of 
> 1:nofiles, or check the? number of files found.
> 
> G?ran
> 
> On 2017-12-20 11:11, Blume Christine wrote:
>> Dear all,
>>
>> I guess I need your help again. With debian my package (nparACT) 
>> gives an error message that seems to be related to loading the data:
>>
>> ? Warning in is.na(data$activity) :
>> ????? is.na() applied to non-(list or vector) of type 'NULL'
>> ???? Error in 1:a : argument of length 0
>>
>> Although I have set up a virtual machine to test the package using 
>> the R devel version with Linux (Debian), it gives me a hard time to 
>> find out what is wrong since I do not manage to install packages 
>> using the devel version...
>>
>> Does anyone know what has changed so this text file is not read in 
>> any longer? The code for reading in the text file is:
>>
>> data <- read.table(paste(path,name, sep="/"), header = F)
>> ???? if (is.data.frame(data)==F){
>> ?????? data = as.data.frame(data)
>> ???? }
>> ???? if(ncol(data) == 2){
>> ?????? data[,1] <- as.POSIXct(data[,1])
>> ?????? data[,2] <- as.numeric(as.character(data[,2]))
>> ?????? names(data)[1] <- "time"
>> ?????? names(data)[2] <- "activity"
>> ??? }
>> ???? if(ncol(data) == 3){
>> ?????? names(data)[1] <- "date"
>> ?????? names(data)[2] <- "time"
>> ?????? names(data)[3] <- "activity"
>> ?????? data$date <- NULL
>> ?????? data$time <- as.POSIXct(data$time, format="%H:%M:%S")
>> ?????? data$activity <- as.numeric(as.character(data$activity))
>> ???? }
>>
>> Or can someone tell me how to install the package using R devel on Linux?
>>
>> Thanks a lot!
>> Christine
>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list 
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

______________________________________________
R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel

From lbusett at gmail.com  Wed Dec 20 18:36:35 2017
From: lbusett at gmail.com (Lorenzo Busetto)
Date: Wed, 20 Dec 2017 18:36:35 +0100
Subject: [R-pkg-devel] Finding/specifying Installation path of gdal in a
 travis-ci build
In-Reply-To: <99b4ae64-e1a3-011e-fdab-078e09a07aba@uni-wuerzburg.de>
References: <CAM1G4SRKViLPcg-iq7Ajy0RcZvT0Dsf5_QQVd3TRng-p7ZXYxg@mail.gmail.com>
 <99b4ae64-e1a3-011e-fdab-078e09a07aba@uni-wuerzburg.de>
Message-ID: <CAM1G4SQZzjFKnBQGR_mBFEgOGG19rzTzfhYucjDAeiQCWhT8NQ@mail.gmail.com>

Hi,

Adding gdal-bin in before-install appears indeed to solve the issue! Thank
you very much for the help!

Lorenzo

On 20 Dec 2017 13:47, "Benjamin Leutner" <benjamin.leutner at uni-wuerzburg.de>
wrote:

Hi,

I can't speak for gdalUtils, but my package uses rgdal and builds well on
travis.
I'm also installing gdal-bin, which you are not. Maybe that helps.
Here's my (admittedly somewhat messy) travis file:
https://github.com/bleutner/RStoolbox/blob/master/.travis.yml

Cheers,
Benjamin


On 12/19/2017 02:45 PM, Lorenzo Busetto wrote:

> ??
> (crossposting from StackOverflow -
> https://stackoverflow.com/q/47884874/6871135)
>
> Dear all,
>
>   in a package I am maintaining (https://github.com/lbusett/MODIStsp), I
> use
> the `gdalUtils` package as a wrapper to
> ? ?
> ?call?
>
> gdal processing ?
> utilities. The problem is that I can not find a way to run my test suite
> and examples on TRAVIS-CI. This appears
> ? ?
> to
> ? ?
> be related to the fact that the gdal installation folder is not found on
> the path, so that I receive the following
> ? ?
> error:
>
> Warning in gdalUtils::gdal_setInstallation(ignore.full_scan = TRUE)
>> No GDAL installation found. Please install 'gdal' before continuing:
>> - www.gdal.org (no HDF4 support!)
>> - www.trac.osgeo.org/osgeo4w/ (with HDF4 support RECOMMENDED)
>> - www.fwtools.maptools.org (with HDF4 support)
>>
> (see here for the full build log:
> https://travis-ci.org/lbusett/MODIStsp/jobs/318037312)
>
> `gdalUtils::gdal_setInstallation()` is supposed to search for a
> ? ?
> valid gdal installation, by first using sys.which(), and (in
> ? ?
> case it fails) looking on "typical" installation paths (see
> https://www.rdocumentation.org/packages/gdalUtils/versions/
> 2.0.1.7/topics/gdal_setInstallation
> ).
>
> This happens besides gdal (apparently) being installed on travis in the
> build, using the following travis.yml configuration:
>
> language: r
> cache: packages
>
> warnings_are_errors: false
>
> ??
> before_install:
>    - sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable --yes
>    - sudo add-apt-repository -y ppa:opencpu/jq --yes
>    - sudo apt-get -qq update
>    - sudo apt-get install -y libgdal-dev libproj-dev
>    - PATH="/usr/local/gdal/bin:$PATH"
>    - export DISPLAY=:99.0
>    - sh -e /etc/init.d/xvfb start
>
> matrix:
>    include:
>      - os: linux
>        dist: trusty
>        sudo: required
>        env:
>          global:
>            - R_LIBS="http://cran.rstudio.com"
>            - R_BUILD_ARGS="--no-build-vignettes --no-manual"
>            - R_CHECK_ARGS="--no-build-vignettes --no-manual --as-cran"
>            - R_CHECK_TIMINGS_="0"
>            - BOOTSTRAP_LATEX="1"
>        apt_packages:
>              - libgdal-dev
>              - libproj-dev
>              - libcairo2-dev
>              - libatk1.0-dev
>              - libpango1.0-dev
>              - libgtk2.0-dev
>              - libglib2.0-dev
>              - libcurl4-openssl-dev
>        r_binary_packages:
>          - cairoDevice
>          - RGtk2
>
> Do you have any suggestions to solve the issue? Do I need to somehow set
> the PATH to gdal in the travis.yml script? If so, how could I find out
> where gdal is being installed? (
> I already
> ? ?
> tried adding a line like
> ?
> - PATH="/usr/local/gdal/bin:$PATH"
> ? ?
> in
> ?
> ?
> before_install
> ? within?
> ?
> the yml but it did not work).
>
> Thanks in advance for any help!
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd at debian.org  Wed Dec 20 18:54:34 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 20 Dec 2017 11:54:34 -0600
Subject: [R-pkg-devel] Debian: example file is no longer read correctly
In-Reply-To: <f5a277a6-c48c-61f7-5d22-f77a94929f6f@umu.se>
References: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>
 <f5a277a6-c48c-61f7-5d22-f77a94929f6f@umu.se>
Message-ID: <23098.41946.482329.375719@bud.eddelbuettel.com>


On 20 December 2017 at 15:32, G?ran Brostr?m wrote:
| > Or can someone tell me how to install the package using R devel on Linux?
| 
| Good question (which I missed). I do it like this:
| 
| (i) Download and unpack the tarball R-devel.... in ~/src/
| (ii) ./configure and make
| (iii) Start R-devel:  $ ~/src/R-devel/bin/R
| (iv) > install.packages(...)
| 
| This seems to install packages in R-devel/library/, separate from your 
| main R installation. Note that I do not install R-devel.
| 
| This is found by trial-and-error. I don't know if it is the recommended way.

It is, but more work. (I still do it as it is set up.)

Another good way is to use the rocker/drd container (where "drd" is short for
"daily R-devel").  Requires a system that can run Docker, which is most these
days, and generally worth it.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From goran.brostrom at umu.se  Wed Dec 20 23:47:09 2017
From: goran.brostrom at umu.se (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Wed, 20 Dec 2017 23:47:09 +0100
Subject: [R-pkg-devel] Debian: example file is no longer read correctly
In-Reply-To: <23098.41946.482329.375719@bud.eddelbuettel.com>
References: <E20FE863CD1C294AA55E415F4C446424F24EBD74@xchmbx2.is.sbg.ac.at>
 <f5a277a6-c48c-61f7-5d22-f77a94929f6f@umu.se>
 <23098.41946.482329.375719@bud.eddelbuettel.com>
Message-ID: <350c4b77-6572-f68a-43e8-8910724d5a40@umu.se>



On 2017-12-20 18:54, Dirk Eddelbuettel wrote:
> 
> On 20 December 2017 at 15:32, G?ran Brostr?m wrote:
> | > Or can someone tell me how to install the package using R devel on Linux?
> |
> | Good question (which I missed). I do it like this:
> |
> | (i) Download and unpack the tarball R-devel.... in ~/src/
> | (ii) ./configure and make
> | (iii) Start R-devel:  $ ~/src/R-devel/bin/R
> | (iv) > install.packages(...)
> |
> | This seems to install packages in R-devel/library/, separate from your
> | main R installation. Note that I do not install R-devel.
> |
> | This is found by trial-and-error. I don't know if it is the recommended way.
> 
> It is, but more work. (I still do it as it is set up.)

Thanks Dirk, that's exactly what I wanted to hear!
> 
> Another good way is to use the rocker/drd container (where "drd" is short for
> "daily R-devel").  Requires a system that can run Docker, which is most these
> days, and generally worth it.

I'll spend the holidays to learn.

G?ran

> Dirk
>


From leegi001 at umn.edu  Thu Dec 21 07:15:11 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Thu, 21 Dec 2017 00:15:11 -0600
Subject: [R-pkg-devel] File name error
Message-ID: <CAOeg=__fUk1GqiZrNQNwJW2LC=oF1acqHNVfCsWpzv0=VWVFBA@mail.gmail.com>

I am getting the following error from the auto-checks when trying to submit
a package to CRAN:
r-devel-linux-x86_64-debian-gcc
<https://cran.r-project.org/web/checks/check_flavors.html#r-devel-linux-x86_64-debian-gcc>
3.0.0.2 3.63 56.71 60.34 ERROR
<https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-gcc/CATkit-00check.html>

Error in pdf(file = fileName4, width = 8, height = 10) :
  cannot open file
'/home/hornik/tmp/R.check/r-devel-gcc/Work/build/Packages/CATkit/extdata/activity-stress-c57-2-part.txt--20Dec2017--03-51-46CAToutput.pdf'

Since this works for ALL other flavors, I am assuming it may be some file
name restrictions unique to debian-gcc???  I can't think what else would
cause it to fail only in the OS.

debian doesn't like "--"?

Cathy Lee Gierke


*?Darkness cannot drive out darkness: only light can do that. Hate cannot
drive out hate: only love can do that.? *
*?The arc of the moral universe is long, but it bends towards justice.?*
*?Nothing in the world is more dangerous than sincere ignorance and
conscientious stupidity.? *
*?Never forget that everything Hitler did in Germany was legal.?   *
*?Forgiveness is not an occasional act, it is a constant attitude.? *
*?Injustice anywhere is a threat to justice everywhere.?  *

? Martin Luther King Jr.

<http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>

	[[alternative HTML version deleted]]


From christine.blume at sbg.ac.at  Thu Dec 21 09:21:19 2017
From: christine.blume at sbg.ac.at (Blume Christine)
Date: Thu, 21 Dec 2017 08:21:19 +0000
Subject: [R-pkg-devel] File name error
In-Reply-To: <CAOeg=__fUk1GqiZrNQNwJW2LC=oF1acqHNVfCsWpzv0=VWVFBA@mail.gmail.com>
References: <CAOeg=__fUk1GqiZrNQNwJW2LC=oF1acqHNVfCsWpzv0=VWVFBA@mail.gmail.com>
Message-ID: <E20FE863CD1C294AA55E415F4C446424F24EC2AF@xchmbx2.is.sbg.ac.at>

Hi Cathy,

I also had troubles with debian (Fedora only gave warnings) and no problems with other systems. Mine was related to me writing a file (or rather trying to write) in a working directory other than tempdir (can be retrieved by tempdir()). I now write it to tempdir and then set the old working directory again at the end of the example. Perhaps that is somehow helpful for your case too?

I can highly recommend to test your tar.gz file with the check() function of the rhub package. You can for example run check("pathtoyourpackage", platform = "debian-gcc-devel") or 
check_for_cran("pathtoyourpackage", platform = "debian-gcc-devel"), i.e. test your package on debian without troubles.

Best,
Christine


-----Urspr?ngliche Nachricht-----
Von: R-package-devel [mailto:r-package-devel-bounces at r-project.org] Im Auftrag von Cathy Lee Gierke
Gesendet: Donnerstag, 21. Dezember 2017 07:15
An: R Package Development
Betreff: [R-pkg-devel] File name error

I am getting the following error from the auto-checks when trying to submit a package to CRAN:
r-devel-linux-x86_64-debian-gcc
<https://cran.r-project.org/web/checks/check_flavors.html#r-devel-linux-x86_64-debian-gcc>
3.0.0.2 3.63 56.71 60.34 ERROR
<https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-gcc/CATkit-00check.html>

Error in pdf(file = fileName4, width = 8, height = 10) :
  cannot open file
'/home/hornik/tmp/R.check/r-devel-gcc/Work/build/Packages/CATkit/extdata/activity-stress-c57-2-part.txt--20Dec2017--03-51-46CAToutput.pdf'

Since this works for ALL other flavors, I am assuming it may be some file name restrictions unique to debian-gcc???  I can't think what else would cause it to fail only in the OS.

debian doesn't like "--"?

Cathy Lee Gierke


*?Darkness cannot drive out darkness: only light can do that. Hate cannot drive out hate: only love can do that.? * *?The arc of the moral universe is long, but it bends towards justice.?* *?Nothing in the world is more dangerous than sincere ignorance and conscientious stupidity.? *
*?Never forget that everything Hitler did in Germany was legal.?   *
*?Forgiveness is not an occasional act, it is a constant attitude.? * *?Injustice anywhere is a threat to justice everywhere.?  *

? Martin Luther King Jr.

<http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>

	[[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel

From ligges at statistik.tu-dortmund.de  Thu Dec 21 11:21:58 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 21 Dec 2017 11:21:58 +0100
Subject: [R-pkg-devel] File name error
In-Reply-To: <E20FE863CD1C294AA55E415F4C446424F24EC2AF@xchmbx2.is.sbg.ac.at>
References: <CAOeg=__fUk1GqiZrNQNwJW2LC=oF1acqHNVfCsWpzv0=VWVFBA@mail.gmail.com>
 <E20FE863CD1C294AA55E415F4C446424F24EC2AF@xchmbx2.is.sbg.ac.at>
Message-ID: <75954a82-39a6-2006-8a38-aa3f9017d7d3@statistik.tu-dortmund.de>

This is a new check:

You must not write into the user's filespace without explicit agreement 
by the user (by specifying path/name).

Note that some users won't even have permissions to write into the 
package's installation directory if that is set up site wide by an 
admin, for example.

So please use tempdir() in the examples.

Best,
Uwe Ligges




On 21.12.2017 09:21, Blume Christine wrote:
> Hi Cathy,
> 
> I also had troubles with debian (Fedora only gave warnings) and no problems with other systems. Mine was related to me writing a file (or rather trying to write) in a working directory other than tempdir (can be retrieved by tempdir()). I now write it to tempdir and then set the old working directory again at the end of the example. Perhaps that is somehow helpful for your case too?
> 
> I can highly recommend to test your tar.gz file with the check() function of the rhub package. You can for example run check("pathtoyourpackage", platform = "debian-gcc-devel") or
> check_for_cran("pathtoyourpackage", platform = "debian-gcc-devel"), i.e. test your package on debian without troubles.
> 
> Best,
> Christine
> 
> 
> -----Urspr?ngliche Nachricht-----
> Von: R-package-devel [mailto:r-package-devel-bounces at r-project.org] Im Auftrag von Cathy Lee Gierke
> Gesendet: Donnerstag, 21. Dezember 2017 07:15
> An: R Package Development
> Betreff: [R-pkg-devel] File name error
> 
> I am getting the following error from the auto-checks when trying to submit a package to CRAN:
> r-devel-linux-x86_64-debian-gcc
> <https://cran.r-project.org/web/checks/check_flavors.html#r-devel-linux-x86_64-debian-gcc>
> 3.0.0.2 3.63 56.71 60.34 ERROR
> <https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-gcc/CATkit-00check.html>
> 
> Error in pdf(file = fileName4, width = 8, height = 10) :
>    cannot open file
> '/home/hornik/tmp/R.check/r-devel-gcc/Work/build/Packages/CATkit/extdata/activity-stress-c57-2-part.txt--20Dec2017--03-51-46CAToutput.pdf'
> 
> Since this works for ALL other flavors, I am assuming it may be some file name restrictions unique to debian-gcc???  I can't think what else would cause it to fail only in the OS.
> 
> debian doesn't like "--"?
> 
> Cathy Lee Gierke
> 
> 
> *?Darkness cannot drive out darkness: only light can do that. Hate cannot drive out hate: only love can do that.? * *?The arc of the moral universe is long, but it bends towards justice.?* *?Nothing in the world is more dangerous than sincere ignorance and conscientious stupidity.? *
> *?Never forget that everything Hitler did in Germany was legal.?   *
> *?Forgiveness is not an occasional act, it is a constant attitude.? * *?Injustice anywhere is a threat to justice everywhere.?  *
> 
> ? Martin Luther King Jr.
> 
> <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From edd at debian.org  Thu Dec 21 13:03:06 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 21 Dec 2017 06:03:06 -0600
Subject: [R-pkg-devel] File name error
In-Reply-To: <E20FE863CD1C294AA55E415F4C446424F24EC2AF@xchmbx2.is.sbg.ac.at>
References: <CAOeg=__fUk1GqiZrNQNwJW2LC=oF1acqHNVfCsWpzv0=VWVFBA@mail.gmail.com>
 <E20FE863CD1C294AA55E415F4C446424F24EC2AF@xchmbx2.is.sbg.ac.at>
Message-ID: <23099.41722.54755.857398@bud.eddelbuettel.com>


Cristine,

On 21 December 2017 at 08:21, Blume Christine wrote:
| I also had troubles with debian (Fedora only gave warnings)

May I ask you to be a little more careful in your attribution?   Yes, it is
too that the instance labeleb 'r-devel-debian' gave you an error.  But that
was not because of Debian, but because _that r-devel instance_ carried a new
test.

So please don't leave sentences hanging (as you now have in several emails)
"failed on Debian" implying a particular flavour (as shipped by Debian)
failed.  It didn't. A [very recent] build of r-devel, instrumented with a new
test, failed for you. It happens to be running on a Debian platform. So
please refer to the failing test platform by its name. Preferably with the
compiler added because there are two each for Debian and Fedora. See eg
https://cloud.r-project.org/web/checks/check_results_digest.html

Thanks,  Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From henrik.bengtsson at gmail.com  Thu Dec 21 18:22:35 2017
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Thu, 21 Dec 2017 09:22:35 -0800
Subject: [R-pkg-devel] File name error
In-Reply-To: <75954a82-39a6-2006-8a38-aa3f9017d7d3@statistik.tu-dortmund.de>
References: <CAOeg=__fUk1GqiZrNQNwJW2LC=oF1acqHNVfCsWpzv0=VWVFBA@mail.gmail.com>
 <E20FE863CD1C294AA55E415F4C446424F24EC2AF@xchmbx2.is.sbg.ac.at>
 <75954a82-39a6-2006-8a38-aa3f9017d7d3@statistik.tu-dortmund.de>
Message-ID: <CAFDcVCQu=G4o5=M8Yf_MAtuXL5z-x-OcRyqsS3ySQM3GxmOPYA@mail.gmail.com>

Uwe/Kurt, is this controlled by R itself or by the host system?  I
suspect one of my R.filesets tests(*) fails (since a few days) because
of this, but it might actually be a false positive.  I fail to
reproduce it on Ubuntu 16.04 with:

* using R Under development (unstable) (2017-12-20 r73933)
* using platform: x86_64-pc-linux-gnu (64-bit)

My test tries to verify that it can write to tempdir() using its
*relative* path (if such is possible) - a test that effectively does:

> abs <- tempfile()
> setwd(dirname(abs))
> getwd()
[1] "/tmp/Rtmpa9riPQ"
> rel <- file.path("..", "..", abs)
> rel <- gsub("//", "/", rel, fixed = TRUE)
> rel
[1] "../../tmp/Rtmpa9riPQ/file3251441e380d
> cat("hello", file = res)

and fails in that last write on 'r-devel-linux-x86_64-debian-gcc'.  It
could, of course, be a bug in my code that is now being revealed, but
these tests been in place for many years, possibly more than a decade.

(*) https://cran.r-project.org/web/checks/check_results_R.filesets.html

Thxs,

Henrik

On Thu, Dec 21, 2017 at 2:21 AM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
> This is a new check:
>
> You must not write into the user's filespace without explicit agreement by
> the user (by specifying path/name).
>
> Note that some users won't even have permissions to write into the package's
> installation directory if that is set up site wide by an admin, for example.
>
> So please use tempdir() in the examples.
>
> Best,
> Uwe Ligges
>
>
>
>
>
> On 21.12.2017 09:21, Blume Christine wrote:
>>
>> Hi Cathy,
>>
>> I also had troubles with debian (Fedora only gave warnings) and no
>> problems with other systems. Mine was related to me writing a file (or
>> rather trying to write) in a working directory other than tempdir (can be
>> retrieved by tempdir()). I now write it to tempdir and then set the old
>> working directory again at the end of the example. Perhaps that is somehow
>> helpful for your case too?
>>
>> I can highly recommend to test your tar.gz file with the check() function
>> of the rhub package. You can for example run check("pathtoyourpackage",
>> platform = "debian-gcc-devel") or
>> check_for_cran("pathtoyourpackage", platform = "debian-gcc-devel"), i.e.
>> test your package on debian without troubles.
>>
>> Best,
>> Christine
>>
>>
>> -----Urspr?ngliche Nachricht-----
>> Von: R-package-devel [mailto:r-package-devel-bounces at r-project.org] Im
>> Auftrag von Cathy Lee Gierke
>> Gesendet: Donnerstag, 21. Dezember 2017 07:15
>> An: R Package Development
>> Betreff: [R-pkg-devel] File name error
>>
>> I am getting the following error from the auto-checks when trying to
>> submit a package to CRAN:
>> r-devel-linux-x86_64-debian-gcc
>>
>> <https://cran.r-project.org/web/checks/check_flavors.html#r-devel-linux-x86_64-debian-gcc>
>> 3.0.0.2 3.63 56.71 60.34 ERROR
>>
>> <https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-gcc/CATkit-00check.html>
>>
>> Error in pdf(file = fileName4, width = 8, height = 10) :
>>    cannot open file
>>
>> '/home/hornik/tmp/R.check/r-devel-gcc/Work/build/Packages/CATkit/extdata/activity-stress-c57-2-part.txt--20Dec2017--03-51-46CAToutput.pdf'
>>
>> Since this works for ALL other flavors, I am assuming it may be some file
>> name restrictions unique to debian-gcc???  I can't think what else would
>> cause it to fail only in the OS.
>>
>> debian doesn't like "--"?
>>
>> Cathy Lee Gierke
>>
>>
>> *?Darkness cannot drive out darkness: only light can do that. Hate cannot
>> drive out hate: only love can do that.? * *?The arc of the moral universe is
>> long, but it bends towards justice.?* *?Nothing in the world is more
>> dangerous than sincere ignorance and conscientious stupidity.? *
>> *?Never forget that everything Hitler did in Germany was legal.?   *
>> *?Forgiveness is not an occasional act, it is a constant attitude.? *
>> *?Injustice anywhere is a threat to justice everywhere.?  *
>>
>> ? Martin Luther King Jr.
>>
>> <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From leegi001 at umn.edu  Wed Dec 27 18:55:21 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Wed, 27 Dec 2017 11:55:21 -0600
Subject: [R-pkg-devel] File name error
In-Reply-To: <75954a82-39a6-2006-8a38-aa3f9017d7d3@statistik.tu-dortmund.de>
References: <CAOeg=__fUk1GqiZrNQNwJW2LC=oF1acqHNVfCsWpzv0=VWVFBA@mail.gmail.com>
 <E20FE863CD1C294AA55E415F4C446424F24EC2AF@xchmbx2.is.sbg.ac.at>
 <75954a82-39a6-2006-8a38-aa3f9017d7d3@statistik.tu-dortmund.de>
Message-ID: <CAOeg=_88tggcKwyxQ8H7T3p7iGw=vDARTL+hoJQ-Y23CV86-Zg@mail.gmail.com>

My program puts the output into the folder where it found the input.

Must I move the input files to tmpdir() or are they already there?

Cathy Lee Gierke


*?Darkness cannot drive out darkness: only light can do that. Hate cannot
drive out hate: only love can do that.? *
*?The arc of the moral universe is long, but it bends towards justice.?*
*?Nothing in the world is more dangerous than sincere ignorance and
conscientious stupidity.? *
*?Never forget that everything Hitler did in Germany was legal.?   *
*?Forgiveness is not an occasional act, it is a constant attitude.? *
*?Injustice anywhere is a threat to justice everywhere.?  *

? Martin Luther King Jr.

<http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>

On Thu, Dec 21, 2017 at 4:21 AM, Uwe Ligges <ligges at statistik.tu-dortmund.de
> wrote:

> This is a new check:
>
> You must not write into the user's filespace without explicit agreement by
> the user (by specifying path/name).
>
> Note that some users won't even have permissions to write into the
> package's installation directory if that is set up site wide by an admin,
> for example.
>
> So please use tempdir() in the examples.
>
> Best,
> Uwe Ligges
>
>
>
>
>
> On 21.12.2017 09:21, Blume Christine wrote:
>
>> Hi Cathy,
>>
>> I also had troubles with debian (Fedora only gave warnings) and no
>> problems with other systems. Mine was related to me writing a file (or
>> rather trying to write) in a working directory other than tempdir (can be
>> retrieved by tempdir()). I now write it to tempdir and then set the old
>> working directory again at the end of the example. Perhaps that is somehow
>> helpful for your case too?
>>
>> I can highly recommend to test your tar.gz file with the check() function
>> of the rhub package. You can for example run check("pathtoyourpackage",
>> platform = "debian-gcc-devel") or
>> check_for_cran("pathtoyourpackage", platform = "debian-gcc-devel"), i.e.
>> test your package on debian without troubles.
>>
>> Best,
>> Christine
>>
>>
>> -----Urspr?ngliche Nachricht-----
>> Von: R-package-devel [mailto:r-package-devel-bounces at r-project.org] Im
>> Auftrag von Cathy Lee Gierke
>> Gesendet: Donnerstag, 21. Dezember 2017 07:15
>> An: R Package Development
>> Betreff: [R-pkg-devel] File name error
>>
>> I am getting the following error from the auto-checks when trying to
>> submit a package to CRAN:
>> r-devel-linux-x86_64-debian-gcc
>> <https://cran.r-project.org/web/checks/check_flavors.html#r-
>> devel-linux-x86_64-debian-gcc>
>> 3.0.0.2 3.63 56.71 60.34 ERROR
>> <https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_
>> 64-debian-gcc/CATkit-00check.html>
>>
>> Error in pdf(file = fileName4, width = 8, height = 10) :
>>    cannot open file
>> '/home/hornik/tmp/R.check/r-devel-gcc/Work/build/Packages/CA
>> Tkit/extdata/activity-stress-c57-2-part.txt--20Dec2017--03-
>> 51-46CAToutput.pdf'
>>
>> Since this works for ALL other flavors, I am assuming it may be some file
>> name restrictions unique to debian-gcc???  I can't think what else would
>> cause it to fail only in the OS.
>>
>> debian doesn't like "--"?
>>
>> Cathy Lee Gierke
>>
>>
>> *?Darkness cannot drive out darkness: only light can do that. Hate cannot
>> drive out hate: only love can do that.? * *?The arc of the moral universe
>> is long, but it bends towards justice.?* *?Nothing in the world is more
>> dangerous than sincere ignorance and conscientious stupidity.? *
>> *?Never forget that everything Hitler did in Germany was legal.?   *
>> *?Forgiveness is not an occasional act, it is a constant attitude.? *
>> *?Injustice anywhere is a threat to justice everywhere.?  *
>>
>> ? Martin Luther King Jr.
>>
>> <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/l
>> istinfo/r-package-devel
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>>

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Fri Dec 29 16:50:04 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 29 Dec 2017 16:50:04 +0100
Subject: [R-pkg-devel] File name error
In-Reply-To: <CAOeg=_88tggcKwyxQ8H7T3p7iGw=vDARTL+hoJQ-Y23CV86-Zg@mail.gmail.com>
References: <CAOeg=__fUk1GqiZrNQNwJW2LC=oF1acqHNVfCsWpzv0=VWVFBA@mail.gmail.com>
 <E20FE863CD1C294AA55E415F4C446424F24EC2AF@xchmbx2.is.sbg.ac.at>
 <75954a82-39a6-2006-8a38-aa3f9017d7d3@statistik.tu-dortmund.de>
 <CAOeg=_88tggcKwyxQ8H7T3p7iGw=vDARTL+hoJQ-Y23CV86-Zg@mail.gmail.com>
Message-ID: <6e6f538a-31b9-7810-de82-b898a7da01ae@statistik.tu-dortmund.de>



On 27.12.2017 18:55, Cathy Lee Gierke wrote:
> My program puts the output into the folder where it found the input.

Please let the user specify the output dir. Otherwise there is the risk 
to overwrite files that the user want to keep.


> 
> Must I move the input files to tmpdir() or are they already there?

Why shoudl files be in tmpdir()? Only those you created there...

Best,
Uwe Ligges




> Cathy Lee Gierke
> 
> /?Darkness cannot drive out darkness: only light can do that. Hate 
> cannot drive out hate: only love can do that.?
> /
> /?The arc of the moral universe is long, but it bends towards justice.?/
> /?Nothing in the world is more dangerous than sincere ignorance and 
> conscientious stupidity.? /
> /?Never forget that everything Hitler did in Germany was legal.? /
> /?Forgiveness is not an occasional act, it is a constant attitude.? /
> /?Injustice anywhere is a threat to justice everywhere.? /
> 
> ? Martin Luther King Jr.
> 
> <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
> 
> On Thu, Dec 21, 2017 at 4:21 AM, Uwe Ligges 
> <ligges at statistik.tu-dortmund.de 
> <mailto:ligges at statistik.tu-dortmund.de>> wrote:
> 
>     This is a new check:
> 
>     You must not write into the user's filespace without explicit
>     agreement by the user (by specifying path/name).
> 
>     Note that some users won't even have permissions to write into the
>     package's installation directory if that is set up site wide by an
>     admin, for example.
> 
>     So please use tempdir() in the examples.
> 
>     Best,
>     Uwe Ligges
> 
> 
> 
> 
> 
>     On 21.12.2017 09:21, Blume Christine wrote:
> 
>         Hi Cathy,
> 
>         I also had troubles with debian (Fedora only gave warnings) and
>         no problems with other systems. Mine was related to me writing a
>         file (or rather trying to write) in a working directory other
>         than tempdir (can be retrieved by tempdir()). I now write it to
>         tempdir and then set the old working directory again at the end
>         of the example. Perhaps that is somehow helpful for your case too?
> 
>         I can highly recommend to test your tar.gz file with the check()
>         function of the rhub package. You can for example run
>         check("pathtoyourpackage", platform = "debian-gcc-devel") or
>         check_for_cran("pathtoyourpackage", platform =
>         "debian-gcc-devel"), i.e. test your package on debian without
>         troubles.
> 
>         Best,
>         Christine
> 
> 
>         -----Urspr?ngliche Nachricht-----
>         Von: R-package-devel
>         [mailto:r-package-devel-bounces at r-project.org
>         <mailto:r-package-devel-bounces at r-project.org>] Im Auftrag von
>         Cathy Lee Gierke
>         Gesendet: Donnerstag, 21. Dezember 2017 07:15
>         An: R Package Development
>         Betreff: [R-pkg-devel] File name error
> 
>         I am getting the following error from the auto-checks when
>         trying to submit a package to CRAN:
>         r-devel-linux-x86_64-debian-gcc
>         <https://cran.r-project.org/web/checks/check_flavors.html#r-devel-linux-x86_64-debian-gcc
>         <https://cran.r-project.org/web/checks/check_flavors.html#r-devel-linux-x86_64-debian-gcc>>
>         3.0.0.2 3.63 56.71 60.34 ERROR
>         <https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-gcc/CATkit-00check.html
>         <https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-gcc/CATkit-00check.html>>
> 
>         Error in pdf(file = fileName4, width = 8, height = 10) :
>          ? ?cannot open file
>         '/home/hornik/tmp/R.check/r-devel-gcc/Work/build/Packages/CATkit/extdata/activity-stress-c57-2-part.txt--20Dec2017--03-51-46CAToutput.pdf'
> 
>         Since this works for ALL other flavors, I am assuming it may be
>         some file name restrictions unique to debian-gcc???? I can't
>         think what else would cause it to fail only in the OS.
> 
>         debian doesn't like "--"?
> 
>         Cathy Lee Gierke
> 
> 
>         *?Darkness cannot drive out darkness: only light can do that.
>         Hate cannot drive out hate: only love can do that.? * *?The arc
>         of the moral universe is long, but it bends towards justice.?*
>         *?Nothing in the world is more dangerous than sincere ignorance
>         and conscientious stupidity.? *
>         *?Never forget that everything Hitler did in Germany was legal.?? ?*
>         *?Forgiveness is not an occasional act, it is a constant
>         attitude.? * *?Injustice anywhere is a threat to justice
>         everywhere.?? *
> 
>         ? Martin Luther King Jr.
> 
>         <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_
>         <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>>
> 
>          ? ? ? ? [[alternative HTML version deleted]]
> 
>         ______________________________________________
>         R-package-devel at r-project.org
>         <mailto:R-package-devel at r-project.org> mailing list
>         https://stat.ethz.ch/mailman/listinfo/r-package-devel
>         <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>         ______________________________________________
>         R-package-devel at r-project.org
>         <mailto:R-package-devel at r-project.org> mailing list
>         https://stat.ethz.ch/mailman/listinfo/r-package-devel
>         <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> 
>


From ligges at statistik.tu-dortmund.de  Fri Dec 29 16:59:30 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 29 Dec 2017 16:59:30 +0100
Subject: [R-pkg-devel] File name error
In-Reply-To: <CAFDcVCQu=G4o5=M8Yf_MAtuXL5z-x-OcRyqsS3ySQM3GxmOPYA@mail.gmail.com>
References: <CAOeg=__fUk1GqiZrNQNwJW2LC=oF1acqHNVfCsWpzv0=VWVFBA@mail.gmail.com>
 <E20FE863CD1C294AA55E415F4C446424F24EC2AF@xchmbx2.is.sbg.ac.at>
 <75954a82-39a6-2006-8a38-aa3f9017d7d3@statistik.tu-dortmund.de>
 <CAFDcVCQu=G4o5=M8Yf_MAtuXL5z-x-OcRyqsS3ySQM3GxmOPYA@mail.gmail.com>
Message-ID: <9eda6748-cd43-5680-c241-6ad9059dd636@statistik.tu-dortmund.de>



On 21.12.2017 18:22, Henrik Bengtsson wrote:
> Uwe/Kurt, is this 

You mean the new check? This is R.

> controlled by R itself or by the host system?  I
> suspect one of my R.filesets tests(*) fails (since a few days) because
> of this, but it might actually be a false positive.  I fail to
> reproduce it on Ubuntu 16.04 with:
> 
> * using R Under development (unstable) (2017-12-20 r73933)
> * using platform: x86_64-pc-linux-gnu (64-bit)
> 
> My test tries to verify that it can write to tempdir() using its
> *relative* path (if such is possible) - a test that effectively does:
> 
>> abs <- tempfile()
>> setwd(dirname(abs))
>> getwd()
> [1] "/tmp/Rtmpa9riPQ"
>> rel <- file.path("..", "..", abs)
>> rel <- gsub("//", "/", rel, fixed = TRUE)
>> rel
> [1] "../../tmp/Rtmpa9riPQ/file3251441e380d
>> cat("hello", file = res)

file = rel, I guess.


> 
> and fails in that last write on 'r-devel-linux-x86_64-debian-gcc'.  It
> could, of course, be a bug in my code that is now being revealed, but
> these tests been in place for many years, possibly more than a decade.
> 
> (*) https://cran.r-project.org/web/checks/check_results_R.filesets.html


Well, as this is also shown in R-release on Kurt's machines, I suspect 
this is either a problem where the directory you are working in is a 
link and the deriving the relative path fails or there is no space left 
in  tempdir() ...

In both cases, please ask Kurt who is on vacation, too.

Best,
Uwe






> Thxs,
> 
> Henrik
> 
> On Thu, Dec 21, 2017 at 2:21 AM, Uwe Ligges
> <ligges at statistik.tu-dortmund.de> wrote:
>> This is a new check:
>>
>> You must not write into the user's filespace without explicit agreement by
>> the user (by specifying path/name).
>>
>> Note that some users won't even have permissions to write into the package's
>> installation directory if that is set up site wide by an admin, for example.
>>
>> So please use tempdir() in the examples.
>>
>> Best,
>> Uwe Ligges
>>
>>
>>
>>
>>
>> On 21.12.2017 09:21, Blume Christine wrote:
>>>
>>> Hi Cathy,
>>>
>>> I also had troubles with debian (Fedora only gave warnings) and no
>>> problems with other systems. Mine was related to me writing a file (or
>>> rather trying to write) in a working directory other than tempdir (can be
>>> retrieved by tempdir()). I now write it to tempdir and then set the old
>>> working directory again at the end of the example. Perhaps that is somehow
>>> helpful for your case too?
>>>
>>> I can highly recommend to test your tar.gz file with the check() function
>>> of the rhub package. You can for example run check("pathtoyourpackage",
>>> platform = "debian-gcc-devel") or
>>> check_for_cran("pathtoyourpackage", platform = "debian-gcc-devel"), i.e.
>>> test your package on debian without troubles.
>>>
>>> Best,
>>> Christine
>>>
>>>
>>> -----Urspr?ngliche Nachricht-----
>>> Von: R-package-devel [mailto:r-package-devel-bounces at r-project.org] Im
>>> Auftrag von Cathy Lee Gierke
>>> Gesendet: Donnerstag, 21. Dezember 2017 07:15
>>> An: R Package Development
>>> Betreff: [R-pkg-devel] File name error
>>>
>>> I am getting the following error from the auto-checks when trying to
>>> submit a package to CRAN:
>>> r-devel-linux-x86_64-debian-gcc
>>>
>>> <https://cran.r-project.org/web/checks/check_flavors.html#r-devel-linux-x86_64-debian-gcc>
>>> 3.0.0.2 3.63 56.71 60.34 ERROR
>>>
>>> <https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-gcc/CATkit-00check.html>
>>>
>>> Error in pdf(file = fileName4, width = 8, height = 10) :
>>>     cannot open file
>>>
>>> '/home/hornik/tmp/R.check/r-devel-gcc/Work/build/Packages/CATkit/extdata/activity-stress-c57-2-part.txt--20Dec2017--03-51-46CAToutput.pdf'
>>>
>>> Since this works for ALL other flavors, I am assuming it may be some file
>>> name restrictions unique to debian-gcc???  I can't think what else would
>>> cause it to fail only in the OS.
>>>
>>> debian doesn't like "--"?
>>>
>>> Cathy Lee Gierke
>>>
>>>
>>> *?Darkness cannot drive out darkness: only light can do that. Hate cannot
>>> drive out hate: only love can do that.? * *?The arc of the moral universe is
>>> long, but it bends towards justice.?* *?Nothing in the world is more
>>> dangerous than sincere ignorance and conscientious stupidity.? *
>>> *?Never forget that everything Hitler did in Germany was legal.?   *
>>> *?Forgiveness is not an occasional act, it is a constant attitude.? *
>>> *?Injustice anywhere is a threat to justice everywhere.?  *
>>>
>>> ? Martin Luther King Jr.
>>>
>>> <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


