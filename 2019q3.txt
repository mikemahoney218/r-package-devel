From r@turner @end|ng |rom @uck|@nd@@c@nz  Tue Jul  2 04:00:11 2019
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Tue, 2 Jul 2019 14:00:11 +1200
Subject: [R-pkg-devel] "Progress reports" for examples in packages.
Message-ID: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>


I am currently working on a package such that when "R CMD check" is run 
the procedure seems to disappear into a black hole when it gets to
the "* checking examples ..." stage.

Strangely, when I run the examples individually, although they take a 
rather long time, they do not take an "endless" amount of time, so I am 
puzzled.  I would like to be able to isolate where the hang-up is 
occurring so that I can rectify the problem.

I guess I could, successively, wrap all but one of the examples in
\dontrun{} and see what happens in each case.  But this is rather 
tedious.  Is there any to get some diagnostic output as to, e.g. which 
example is being checked at the given moment?  Doing R CMD check --help 
does not reveal any useful looking options.

Thanks for any tips.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From henr|k@bengt@@on @end|ng |rom gm@||@com  Tue Jul  2 05:36:26 2019
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Mon, 1 Jul 2019 20:36:26 -0700
Subject: [R-pkg-devel] "Progress reports" for examples in packages.
In-Reply-To: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>
References: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>
Message-ID: <CAFDcVCSkRgkunpnKUm2j-gbbwH2LU_5T-+7Q8iAto9UvR9_DjA@mail.gmail.com>

FWIW, when running

R CMD check mypkg_1.0.tar.gz

the example output is captured to the file
'mypkg.Rcheck/mypkg-Ex.Rout', so you could monitor that one for what's
going on.

/Henrik

On Mon, Jul 1, 2019 at 7:00 PM Rolf Turner <r.turner at auckland.ac.nz> wrote:
>
>
> I am currently working on a package such that when "R CMD check" is run
> the procedure seems to disappear into a black hole when it gets to
> the "* checking examples ..." stage.
>
> Strangely, when I run the examples individually, although they take a
> rather long time, they do not take an "endless" amount of time, so I am
> puzzled.  I would like to be able to isolate where the hang-up is
> occurring so that I can rectify the problem.
>
> I guess I could, successively, wrap all but one of the examples in
> \dontrun{} and see what happens in each case.  But this is rather
> tedious.  Is there any to get some diagnostic output as to, e.g. which
> example is being checked at the given moment?  Doing R CMD check --help
> does not reveal any useful looking options.
>
> Thanks for any tips.
>
> cheers,
>
> Rolf Turner
>
> --
> Honorary Research Fellow
> Department of Statistics
> University of Auckland
> Phone: +64-9-373-7599 ext. 88276
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From m@r||n- @end|ng |rom gmx@cn  Tue Jul  2 07:03:07 2019
From: m@r||n- @end|ng |rom gmx@cn (Jialin Ma)
Date: Mon, 01 Jul 2019 22:03:07 -0700
Subject: [R-pkg-devel] The correct way to put additional DLLs on windows?
Message-ID: <4752430.6dM0feA5FX@plastic>

Hi everyone,

Currently my package has a script downloading additional DLLs
into "inst/libs" and being called in "Makevars.win". In this way these
DLLs get copied to libs when installing the package and I am able to
load them with "library.dynam".

However R CMD check gives the following warning.

  * checking package subdirectories ... WARNING
  Found the following non-empty subdirectories of 'inst' also used by R:
    inst/libs
  It is recommended not to interfere with package subdirectories used by
  R.

I was wondering what would be the best practice for my case, or I am safe
to ignore this warning (suppose I am planing for a CRAN submission).

I know many packages will download static library and link them at compile
time. But I haven't see any example with additional DLL files.

Thanks.
Jialin Ma


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Tue Jul  2 07:49:43 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Mon, 01 Jul 2019 22:49:43 -0700
Subject: [R-pkg-devel] 
 The correct way to put additional DLLs on windows?
In-Reply-To: <4752430.6dM0feA5FX@plastic>
References: <4752430.6dM0feA5FX@plastic>
Message-ID: <946D950C-9150-4D9A-9DA4-97EB64A7E8A1@dcn.davis.ca.us>

A) You cannot assume the package code will have write access to the library directories. The user/admin who installs the package may never load the package.

B) Downloading binary files for execution without the direct involvement of the user/admin is a security risk.

C) Open-source package license means the source code is part of the package. Downloading binaries later fails this requirement.

On July 1, 2019 10:03:07 PM PDT, Jialin Ma <marlin- at gmx.cn> wrote:
>Hi everyone,
>
>Currently my package has a script downloading additional DLLs
>into "inst/libs" and being called in "Makevars.win". In this way these
>DLLs get copied to libs when installing the package and I am able to
>load them with "library.dynam".
>
>However R CMD check gives the following warning.
>
>  * checking package subdirectories ... WARNING
> Found the following non-empty subdirectories of 'inst' also used by R:
>    inst/libs
> It is recommended not to interfere with package subdirectories used by
>  R.
>
>I was wondering what would be the best practice for my case, or I am
>safe
>to ignore this warning (suppose I am planing for a CRAN submission).
>
>I know many packages will download static library and link them at
>compile
>time. But I haven't see any example with additional DLL files.
>
>Thanks.
>Jialin Ma
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Tue Jul  2 09:19:19 2019
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Tue, 2 Jul 2019 09:19:19 +0200
Subject: [R-pkg-devel] "Progress reports" for examples in packages.
In-Reply-To: <CAFDcVCSkRgkunpnKUm2j-gbbwH2LU_5T-+7Q8iAto9UvR9_DjA@mail.gmail.com>
References: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>
 <CAFDcVCSkRgkunpnKUm2j-gbbwH2LU_5T-+7Q8iAto9UvR9_DjA@mail.gmail.com>
Message-ID: <23835.1399.955675.921469@stat.math.ethz.ch>

>>>>> Henrik Bengtsson 
>>>>>     on Mon, 1 Jul 2019 20:36:26 -0700 writes:

    > FWIW, when running R CMD check mypkg_1.0.tar.gz

    > the example output is captured to the file
    > 'mypkg.Rcheck/mypkg-Ex.Rout', so you could monitor that
    > one for what's going on.

    > /Henrik

Yes, indeed, that's what we have been doing "all the time";  e.g.,
on a unix-alike (or in a 'bash'-like (powershell?) on Windows);
you can   'tail -f ..../mypkg-Ex.Rout' in another shell/terminal

Martin

    > On Mon, Jul 1, 2019 at 7:00 PM Rolf Turner
    > <r.turner at auckland.ac.nz> wrote:
    >> 
    >> 
    >> I am currently working on a package such that when "R CMD
    >> check" is run the procedure seems to disappear into a
    >> black hole when it gets to the "* checking examples ..."
    >> stage.
    >> 
    >> Strangely, when I run the examples individually, although
    >> they take a rather long time, they do not take an
    >> "endless" amount of time, so I am puzzled.  I would like
    >> to be able to isolate where the hang-up is occurring so
    >> that I can rectify the problem.
    >> 
    >> I guess I could, successively, wrap all but one of the
    >> examples in \dontrun{} and see what happens in each case.
    >> But this is rather tedious.  Is there any to get some
    >> diagnostic output as to, e.g. which example is being
    >> checked at the given moment?  Doing R CMD check --help
    >> does not reveal any useful looking options.
    >> 
    >> Thanks for any tips.
    >> 
    >> cheers,
    >> 
    >> Rolf Turner
    >> 
    >> --
    >> Honorary Research Fellow Department of Statistics
    >> University of Auckland Phone: +64-9-373-7599 ext. 88276
    >> 
    >> ______________________________________________
    >> R-package-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-package-devel

    > ______________________________________________
    > R-package-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-package-devel


From m@r||n- @end|ng |rom gmx@cn  Tue Jul  2 09:20:27 2019
From: m@r||n- @end|ng |rom gmx@cn (Jialin Ma)
Date: Tue, 02 Jul 2019 00:20:27 -0700
Subject: [R-pkg-devel] 
 The correct way to put additional DLLs on windows?
In-Reply-To: <533C028C-384C-4403-96C7-FA0071545665@dcn.davis.ca.us>
References: <4752430.6dM0feA5FX@plastic>
 <946D950C-9150-4D9A-9DA4-97EB64A7E8A1@dcn.davis.ca.us>
 <2951839.UXQQHDsmIz@plastic>
 <533C028C-384C-4403-96C7-FA0071545665@dcn.davis.ca.us>
Message-ID: <5771525B-791B-4E66-A97C-CE795EFAE108@gmx.cn>

Sorry, it was a mistake. CC the list.

? 2019?7?2? GMT-07:00 ??12:17:01, Jeff Newmiller <jdnewmil at dcn.davis.ca.us> ??:
>I recommend that you "reply-all" to keep the mailing list included.
>
>
>On July 1, 2019 11:30:23 PM PDT, Jialin Ma <marlin- at gmx.cn> wrote:
>>Hi Jeff,
>>
>>Thanks for your reply. I would like to clarify a little bit:
>>
>>> A) You cannot assume the package code will have write access to the
>>library
>>> directories. The user/admin who installs the package may never load
>>the
>>> package.
>>
>>I am downloading the necessary binary dependencies at *compile time*,
>>i.e. the
>>script is being called inside "Makevars.win". I suppose the script
>>should have
>>write access to the current directory, i.e. "inst" directory, at this
>>stage?
>>But I am not sure about it.
>>
>>I am aware many packages will download static libraries on windows at
>>this
>>stage. For example the Cairo package (see
>>https://github.com/cran/Cairo/blob/
>>master/configure.win ) mentioned in Writing R Extensions will download
>>binary
>>to the source directory and link against them.
>>My question is about whether it is an accepted practice to put DLL
>file
>>in
>>"inst/libs".
>>
>>> B) Downloading binary files for execution without the direct
>>involvement of
>>> the user/admin is a security risk.
>>>
>>> C) Open-source package license means the source code is part of the
>>package.
>>> Downloading binaries later fails this requirement.
>>
>>This however is a workaround for the windows platform due to the
>>difficulties
>>compiling the external libraries. The toolchains needed (specifically,
>>cmake)
>>was missing in Rtools and there are several dependencies. I believe
>>there
>>should be some accepted practice for the license issue, however I am
>>not sure.
>>
>>Best regards,
>>Jialin
>>
>>
>>On Monday, July 1, 2019 10:49:43 PM PDT you wrote:
>>> A) You cannot assume the package code will have write access to the
>>library
>>> directories. The user/admin who installs the package may never load
>>the
>>> package.
>>>
>>> B) Downloading binary files for execution without the direct
>>involvement of
>>> the user/admin is a security risk.
>>>
>>> C) Open-source package license means the source code is part of the
>>package.
>>> Downloading binaries later fails this requirement.
>>> On July 1, 2019 10:03:07 PM PDT, Jialin Ma <marlin- at gmx.cn> wrote:
>>> >Hi everyone,
>>> >
>>> >Currently my package has a script downloading additional DLLs
>>> >into "inst/libs" and being called in "Makevars.win". In this way
>>these
>>> >DLLs get copied to libs when installing the package and I am able
>to
>>> >load them with "library.dynam".
>>> >
>>> >However R CMD check gives the following warning.
>>> >
>>> >  * checking package subdirectories ... WARNING
>>> >
>>> > Found the following non-empty subdirectories of 'inst' also used
>by
>>R:
>>> >    inst/libs
>>> >
>>> > It is recommended not to interfere with package subdirectories
>used
>>by
>>> >
>>> >  R.
>>> >
>>> >I was wondering what would be the best practice for my case, or I
>am
>>> >safe
>>> >to ignore this warning (suppose I am planing for a CRAN
>submission).
>>> >
>>> >I know many packages will download static library and link them at
>>> >compile
>>> >time. But I haven't see any example with additional DLL files.
>>> >
>>> >Thanks.
>>> >Jialin Ma
>>> >
>>> >______________________________________________
>>> >R-package-devel at r-project.org mailing list
>>> >https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>-- 
>Sent from my phone. Please excuse my brevity.

-- 
Sent from my Android device with K-9 Mail. Please excuse my brevity.
	[[alternative HTML version deleted]]


From r@turner @end|ng |rom @uck|@nd@@c@nz  Tue Jul  2 11:31:13 2019
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Tue, 2 Jul 2019 21:31:13 +1200
Subject: [R-pkg-devel] "Progress reports" for examples in packages.
In-Reply-To: <23835.1399.955675.921469@stat.math.ethz.ch>
References: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>
 <CAFDcVCSkRgkunpnKUm2j-gbbwH2LU_5T-+7Q8iAto9UvR9_DjA@mail.gmail.com>
 <23835.1399.955675.921469@stat.math.ethz.ch>
Message-ID: <9ec6c6b7-8f84-0017-7e12-579729c97605@auckland.ac.nz>


Many thanks to Henrik Bengtsson and Martin Maechler for pointing out 
that I can monitor progress by looking at the file

     "mypkg.Rcheck/mypkg-Ex.Rout"

e.g. by using "tail -f".  This strategy indeed revealed where the hangup 
was happening.  I wrapped a line of the examples in \dontrun{} and 
checked the package again.  Now the checking completes in finite time! :-)

However I remain puzzled as to *why* the line in question induces a 
hangup.  When I load the package and run that same  line from the 
command line, a result is returned within about 5 seconds of "wall time" 
(or less).

Another strangeness:  The line prior to that which I wrapped in 
\dontrun{} took a very long time to return a result, although the
command did eventually complete (after which everything ran swiftly).
But when I run this same line from the command line it completes 
*instantaneously*.

Why on earth would commands be slow, or not execute at all, when run 
under the aegis of "R CMD check", but execute swiftly from the command line?

I think it would be unwise of me to ignore the fact that something 
strange is going on here, but I'm damned if I can see how to go about 
tracking the strangeness down so as to be able to remedy it.

My usual practice when trying to get a handle on something that I don't 
understand is to insert browsers() into the code at strategic points. 
See fortunes::fortune(158).  That's of no help in the current context in 
which the problem only arises when R CMD check is being run.

Can anyone suggest a clever means by which I might determine the 
"magnitude and direction of my stupidity"?

cheers,

Rolf

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From |uc@r @end|ng |rom |edor@project@org  Tue Jul  2 11:45:58 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Tue, 2 Jul 2019 11:45:58 +0200
Subject: [R-pkg-devel] "Progress reports" for examples in packages.
In-Reply-To: <9ec6c6b7-8f84-0017-7e12-579729c97605@auckland.ac.nz>
References: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>
 <CAFDcVCSkRgkunpnKUm2j-gbbwH2LU_5T-+7Q8iAto9UvR9_DjA@mail.gmail.com>
 <23835.1399.955675.921469@stat.math.ethz.ch>
 <9ec6c6b7-8f84-0017-7e12-579729c97605@auckland.ac.nz>
Message-ID: <CALEXWq0Xb95LgYAs+Mf9h8d_CTLE=SwQCVqGw8q=sCTwz6u3-g@mail.gmail.com>

Which line of code is it?

I?aki

On Tue, 2 Jul 2019 at 11:32, Rolf Turner <r.turner at auckland.ac.nz> wrote:
>
>
> Many thanks to Henrik Bengtsson and Martin Maechler for pointing out
> that I can monitor progress by looking at the file
>
>      "mypkg.Rcheck/mypkg-Ex.Rout"
>
> e.g. by using "tail -f".  This strategy indeed revealed where the hangup
> was happening.  I wrapped a line of the examples in \dontrun{} and
> checked the package again.  Now the checking completes in finite time! :-)
>
> However I remain puzzled as to *why* the line in question induces a
> hangup.  When I load the package and run that same  line from the
> command line, a result is returned within about 5 seconds of "wall time"
> (or less).
>
> Another strangeness:  The line prior to that which I wrapped in
> \dontrun{} took a very long time to return a result, although the
> command did eventually complete (after which everything ran swiftly).
> But when I run this same line from the command line it completes
> *instantaneously*.
>
> Why on earth would commands be slow, or not execute at all, when run
> under the aegis of "R CMD check", but execute swiftly from the command line?
>
> I think it would be unwise of me to ignore the fact that something
> strange is going on here, but I'm damned if I can see how to go about
> tracking the strangeness down so as to be able to remedy it.
>
> My usual practice when trying to get a handle on something that I don't
> understand is to insert browsers() into the code at strategic points.
> See fortunes::fortune(158).  That's of no help in the current context in
> which the problem only arises when R CMD check is being run.
>
> Can anyone suggest a clever means by which I might determine the
> "magnitude and direction of my stupidity"?
>
> cheers,
>
> Rolf
>
> --
> Honorary Research Fellow
> Department of Statistics
> University of Auckland
> Phone: +64-9-373-7599 ext. 88276
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
I?aki ?car


From bbo|ker @end|ng |rom gm@||@com  Tue Jul  2 11:49:32 2019
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 2 Jul 2019 05:49:32 -0400
Subject: [R-pkg-devel] "Progress reports" for examples in packages.
In-Reply-To: <9ec6c6b7-8f84-0017-7e12-579729c97605@auckland.ac.nz>
References: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>
 <CAFDcVCSkRgkunpnKUm2j-gbbwH2LU_5T-+7Q8iAto9UvR9_DjA@mail.gmail.com>
 <23835.1399.955675.921469@stat.math.ethz.ch>
 <9ec6c6b7-8f84-0017-7e12-579729c97605@auckland.ac.nz>
Message-ID: <63eb9744-da03-17a4-1fd7-d6c3a5af0fe7@gmail.com>


  It's a pain in the neck, but even more basic than inserting browser()
calls all over the place (but possibly useful in this situation) would
be inserting appropriate cat() statements all over the place ... (and
maybe using cat() with proc.time() to report on elapsed time as you go?)

  (As for why the speed depends on the environment, I have no idea ...)

On 2019-07-02 5:31 a.m., Rolf Turner wrote:
> 
> Many thanks to Henrik Bengtsson and Martin Maechler for pointing out
> that I can monitor progress by looking at the file
> 
> ??? "mypkg.Rcheck/mypkg-Ex.Rout"
> 
> e.g. by using "tail -f".? This strategy indeed revealed where the hangup
> was happening.? I wrapped a line of the examples in \dontrun{} and
> checked the package again.? Now the checking completes in finite time! :-)
> 
> However I remain puzzled as to *why* the line in question induces a
> hangup.? When I load the package and run that same? line from the
> command line, a result is returned within about 5 seconds of "wall time"
> (or less).
> 
> Another strangeness:? The line prior to that which I wrapped in
> \dontrun{} took a very long time to return a result, although the
> command did eventually complete (after which everything ran swiftly).
> But when I run this same line from the command line it completes
> *instantaneously*.
> 
> Why on earth would commands be slow, or not execute at all, when run
> under the aegis of "R CMD check", but execute swiftly from the command
> line?
> 
> I think it would be unwise of me to ignore the fact that something
> strange is going on here, but I'm damned if I can see how to go about
> tracking the strangeness down so as to be able to remedy it.
> 
> My usual practice when trying to get a handle on something that I don't
> understand is to insert browsers() into the code at strategic points.
> See fortunes::fortune(158).? That's of no help in the current context in
> which the problem only arises when R CMD check is being run.
> 
> Can anyone suggest a clever means by which I might determine the
> "magnitude and direction of my stupidity"?
> 
> cheers,
> 
> Rolf
>


From r@turner @end|ng |rom @uck|@nd@@c@nz  Tue Jul  2 12:07:50 2019
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Tue, 2 Jul 2019 22:07:50 +1200
Subject: [R-pkg-devel] "Progress reports" for examples in packages.
In-Reply-To: <CALEXWq0Xb95LgYAs+Mf9h8d_CTLE=SwQCVqGw8q=sCTwz6u3-g@mail.gmail.com>
References: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>
 <CAFDcVCSkRgkunpnKUm2j-gbbwH2LU_5T-+7Q8iAto9UvR9_DjA@mail.gmail.com>
 <23835.1399.955675.921469@stat.math.ethz.ch>
 <9ec6c6b7-8f84-0017-7e12-579729c97605@auckland.ac.nz>
 <CALEXWq0Xb95LgYAs+Mf9h8d_CTLE=SwQCVqGw8q=sCTwz6u3-g@mail.gmail.com>
Message-ID: <8cec5632-3c2b-7fe0-0958-3592fe8372f4@auckland.ac.nz>


On 2/07/19 9:45 PM, I?aki Ucar wrote:

> Which line of code is it?

Dunno that it's very enlightening, without having access to the package, 
but the two lines involved are:

> fit <- ldFit(inLogs,predictor="logDose",link="logit")
> x3  <- cvCompare(fit,nrep=5)

The first line runs instantaneously from the command line, but takes a 
very long time under R CMD check.

The second causes R CMD check to disappear into a black hole, but runs 
in 5 seconds or less from the command line.

I'm sorry that I can't make the package public at this time.  It 
contains a number of data sets that my consulting client does not want 
released publicly.

I guess I could create a slightly cut down version of the package with 
the proprietary data sets removed ....  If anyone is actually interested.

cheers,

Rolf

P. S.  The package is about "lethal dose" estimation.  The ldFit() is 
for fitting models from which to estimate lethal doses.  The cvCompare() 
function is for using cross validation of log likelihood to assess 
goodness of fit and to compare models for goodness of fit.

The "nrep=5" is an unrealistically small value (small so as to reduce 
the amount of time needed for checking).  The default value is nrep=100.

R.

> 
> I?aki
> 
> On Tue, 2 Jul 2019 at 11:32, Rolf Turner <r.turner at auckland.ac.nz> wrote:
>>
>>
>> Many thanks to Henrik Bengtsson and Martin Maechler for pointing out
>> that I can monitor progress by looking at the file
>>
>>       "mypkg.Rcheck/mypkg-Ex.Rout"
>>
>> e.g. by using "tail -f".  This strategy indeed revealed where the hangup
>> was happening.  I wrapped a line of the examples in \dontrun{} and
>> checked the package again.  Now the checking completes in finite time! :-)
>>
>> However I remain puzzled as to *why* the line in question induces a
>> hangup.  When I load the package and run that same  line from the
>> command line, a result is returned within about 5 seconds of "wall time"
>> (or less).
>>
>> Another strangeness:  The line prior to that which I wrapped in
>> \dontrun{} took a very long time to return a result, although the
>> command did eventually complete (after which everything ran swiftly).
>> But when I run this same line from the command line it completes
>> *instantaneously*.
>>
>> Why on earth would commands be slow, or not execute at all, when run
>> under the aegis of "R CMD check", but execute swiftly from the command line?
>>
>> I think it would be unwise of me to ignore the fact that something
>> strange is going on here, but I'm damned if I can see how to go about
>> tracking the strangeness down so as to be able to remedy it.
>>
>> My usual practice when trying to get a handle on something that I don't
>> understand is to insert browsers() into the code at strategic points.
>> See fortunes::fortune(158).  That's of no help in the current context in
>> which the problem only arises when R CMD check is being run.
>>
>> Can anyone suggest a clever means by which I might determine the
>> "magnitude and direction of my stupidity"?


From kry|ov@r00t @end|ng |rom gm@||@com  Tue Jul  2 13:13:29 2019
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 2 Jul 2019 14:13:29 +0300
Subject: [R-pkg-devel] "Progress reports" for examples in packages.
In-Reply-To: <8cec5632-3c2b-7fe0-0958-3592fe8372f4@auckland.ac.nz>
References: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>
 <CAFDcVCSkRgkunpnKUm2j-gbbwH2LU_5T-+7Q8iAto9UvR9_DjA@mail.gmail.com>
 <23835.1399.955675.921469@stat.math.ethz.ch>
 <9ec6c6b7-8f84-0017-7e12-579729c97605@auckland.ac.nz>
 <CALEXWq0Xb95LgYAs+Mf9h8d_CTLE=SwQCVqGw8q=sCTwz6u3-g@mail.gmail.com>
 <8cec5632-3c2b-7fe0-0958-3592fe8372f4@auckland.ac.nz>
Message-ID: <20190702141329.09c40d9d@trisector>

Could R CMD check be using valgrind to run the examples? Valgrind has
to interpret CPU instructions manually to be able to warn about
results of code execution depending on memory values it considers
undefined, so it is much slower than execution on a real CPU.

One way to verify that on a GNU/Linux system would be to temporary
insert system('pstree -aps $$') into one of the examples and look at
the output produced.

-- 
Best regards,
Ivan


From @@ber|@ng@ @end|ng |rom |mper|@|@@c@uk  Tue Jul  2 14:13:17 2019
From: @@ber|@ng@ @end|ng |rom |mper|@|@@c@uk (Berlanga, Antonio J)
Date: Tue, 2 Jul 2019 12:13:17 +0000
Subject: [R-pkg-devel] CRAN pre-test failed on NOTE "no visible binding for
 global variable"
Message-ID: <0dd1f26d-d54b-1017-c3b7-fc8760dba2ec@imperial.ac.uk>

Hi r-package-devel,

I've submitted my first package but it failed the CRAN pre-tests on
NOTES. I got:

- my email

- an extra non-standard file (which I have now added to .Rbuildignore)

- NOTEs on "no visible global function definition"

The first two I assume are harmless. The third I do not know how to fix
(possible solutions below). Can it be ignored and suggest the fail was a
false-positive?

The third NOTE is:

#######

Flavor: r-devel-linux-x86_64-debian-gcc, r-devel-windows-ix86+x86_64
Check: R code for possible problems, Result: NOTE
  epi_clean_count_classes: no visible global function definition for
    '%>%'
  epi_clean_count_classes: no visible binding for global variable '.'
  epi_plot_heatmap: no visible binding for global variable 'Var1'
  epi_plot_heatmap: no visible binding for global variable 'Var2'
  epi_plot_heatmap: no visible binding for global variable 'value'
  epi_plot_heatmap_triangle: no visible binding for global variable
    'Var1'
  epi_plot_heatmap_triangle: no visible binding for global variable
    'Var2'
  epi_plot_heatmap_triangle: no visible binding for global variable
    'value'
  epi_plot_heatmap_triangle: no visible global function definition for
    'element_text'
  epi_plot_heatmap_triangle: no visible global function definition for
    'coord_fixed'
  epi_plot_heatmap_triangle: no visible global function definition for
    'element_blank'
  epi_plot_heatmap_triangle: no visible global function definition for
    'element_rect'
  epi_plot_heatmap_triangle: no visible global function definition for
    'guide_colorbar'
  epi_stats_summary: no visible global function definition for '%>%'
  epi_stats_tidy: no visible global function definition for '%>%'
  epi_stats_tidy: no visible binding for global variable '.'
  epi_stats_tidy: no visible binding for global variable 'x'
  epi_stats_tidy: no visible binding for global variable 'n'
  epi_stats_tidy: no visible binding for global variable 'id'
  Undefined global functions or variables:
    %>% . Var1 Var2 coord_fixed element_blank element_rect element_text
    guide_colorbar id n value x
#######


Solutions seem to cause errors elsewhere and there does not appear to be
an ideal one unfortunately. It seems to me that adding a file in the
directory 'R' containing eg:

#######

if(getRversion() >= "2.15.1") utils::globalVariables(c("."))

#######

is one of the preferred ways. This seems far from ideal though.

Another option is to import the package and function in the namespace
with eg @importFrom rlang .data

This also seems to cause errors in my case however as I then get
problems with R CMD check with conflicts when including or excluding
such packages from the DESCRIPTION file (I'm sure I'm missing something
though but can't see how to fix it).

See discussions in:

https://github.com/r-lib/devtools/issues/1714
feature request: R CMD check and no visible binding for global variable
? Issue #1714 ? r-lib/devtools

https://stackoverflow.com/questions/40251801/how-to-use-utilsglobalvariables
r - how to use utils::globalVariables - Stack Overflow

https://github.com/tidyverse/magrittr/issues/29
R CMD check and no visible binding for global variable '.' ? Issue #29 ?
tidyverse/magrittr

https://github.com/STAT545-UBC/Discussion/issues/451
Writing R Packages: no visible binding for global variable ? Issue #451
? STAT545-UBC/Discussion


My current thought is to keep the NOTEs as they are to remind me what
I've done and ignore them in the CRAN checks.

Help would be appreciated though (!).

Best wishes,
Antonio




From |uc@r @end|ng |rom |edor@project@org  Tue Jul  2 16:19:13 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Tue, 2 Jul 2019 16:19:13 +0200
Subject: [R-pkg-devel] 
 CRAN pre-test failed on NOTE "no visible binding for
 global variable"
In-Reply-To: <0dd1f26d-d54b-1017-c3b7-fc8760dba2ec@imperial.ac.uk>
References: <0dd1f26d-d54b-1017-c3b7-fc8760dba2ec@imperial.ac.uk>
Message-ID: <CALEXWq3ivnrGMKig6hz3jPUY21j-uXwqqa-vYyh=j+LJrvCw0Q@mail.gmail.com>

ra?l

On Tue, 2 Jul 2019 at 14:18, Berlanga, Antonio J
<a.berlanga at imperial.ac.uk> wrote:
>
> Hi r-package-devel,
>
> I've submitted my first package but it failed the CRAN pre-tests on
> NOTES. I got:
>
> - my email
>
> - an extra non-standard file (which I have now added to .Rbuildignore)
>
> - NOTEs on "no visible global function definition"
>
> The first two I assume are harmless. The third I do not know how to fix
> (possible solutions below). Can it be ignored and suggest the fail was a
> false-positive?
>
> The third NOTE is:
>
> #######
>
> Flavor: r-devel-linux-x86_64-debian-gcc, r-devel-windows-ix86+x86_64
> Check: R code for possible problems, Result: NOTE
>   epi_clean_count_classes: no visible global function definition for
>     '%>%'
>   epi_clean_count_classes: no visible binding for global variable '.'
>   epi_plot_heatmap: no visible binding for global variable 'Var1'
>   epi_plot_heatmap: no visible binding for global variable 'Var2'
>   epi_plot_heatmap: no visible binding for global variable 'value'
>   epi_plot_heatmap_triangle: no visible binding for global variable
>     'Var1'
>   epi_plot_heatmap_triangle: no visible binding for global variable
>     'Var2'
>   epi_plot_heatmap_triangle: no visible binding for global variable
>     'value'
>   epi_plot_heatmap_triangle: no visible global function definition for
>     'element_text'
>   epi_plot_heatmap_triangle: no visible global function definition for
>     'coord_fixed'
>   epi_plot_heatmap_triangle: no visible global function definition for
>     'element_blank'
>   epi_plot_heatmap_triangle: no visible global function definition for
>     'element_rect'
>   epi_plot_heatmap_triangle: no visible global function definition for
>     'guide_colorbar'
>   epi_stats_summary: no visible global function definition for '%>%'
>   epi_stats_tidy: no visible global function definition for '%>%'
>   epi_stats_tidy: no visible binding for global variable '.'
>   epi_stats_tidy: no visible binding for global variable 'x'
>   epi_stats_tidy: no visible binding for global variable 'n'
>   epi_stats_tidy: no visible binding for global variable 'id'
>   Undefined global functions or variables:
>     %>% . Var1 Var2 coord_fixed element_blank element_rect element_text
>     guide_colorbar id n value x
> #######
>
>
> Solutions seem to cause errors elsewhere and there does not appear to be
> an ideal one unfortunately. It seems to me that adding a file in the
> directory 'R' containing eg:
>
> #######
>
> if(getRversion() >= "2.15.1") utils::globalVariables(c("."))
>
> #######
>
> is one of the preferred ways. This seems far from ideal though.

If you use NSE in your package, this is the best solution. You may
also switch to SE.

I?aki


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Tue Jul  2 17:00:36 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Tue, 2 Jul 2019 15:00:36 +0000
Subject: [R-pkg-devel] 
 CRAN pre-test failed on NOTE "no visible binding for
 global variable"
In-Reply-To: <CALEXWq3ivnrGMKig6hz3jPUY21j-uXwqqa-vYyh=j+LJrvCw0Q@mail.gmail.com>
References: <0dd1f26d-d54b-1017-c3b7-fc8760dba2ec@imperial.ac.uk>
 <CALEXWq3ivnrGMKig6hz3jPUY21j-uXwqqa-vYyh=j+LJrvCw0Q@mail.gmail.com>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E018F720868@MBXP02.ds.man.ac.uk>

> ...
> if(getRversion() >= "2.15.1") utils::globalVariables(c("."))

Using such a general pattern eventually and  inevitably will prevent the check from reporting legitimate bugs. 
One alternative is to list explicitly the variables in question and make sure that they are not commonly used names like 'x'. 
If that is not practical and you use non-standard evaluation a lot,  consider '.data' from package 'lang' , see its documentation and/or Google it 
to find out how to use it. 

#' @importFrom rlang .data


Georgi Boshnakov

-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of I?aki Ucar
Sent: 02 July 2019 15:19
To: Berlanga, Antonio J
Cc: r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] CRAN pre-test failed on NOTE "no visible binding for global variable"

ra?l

On Tue, 2 Jul 2019 at 14:18, Berlanga, Antonio J
<a.berlanga at imperial.ac.uk> wrote:
>
> Hi r-package-devel,
>
> I've submitted my first package but it failed the CRAN pre-tests on
> NOTES. I got:
>
> - my email
>
> - an extra non-standard file (which I have now added to .Rbuildignore)
>
> - NOTEs on "no visible global function definition"
>
> The first two I assume are harmless. The third I do not know how to fix
> (possible solutions below). Can it be ignored and suggest the fail was a
> false-positive?
>
> The third NOTE is:
>
> #######
>
> Flavor: r-devel-linux-x86_64-debian-gcc, r-devel-windows-ix86+x86_64
> Check: R code for possible problems, Result: NOTE
>   epi_clean_count_classes: no visible global function definition for
>     '%>%'
>   epi_clean_count_classes: no visible binding for global variable '.'
>   epi_plot_heatmap: no visible binding for global variable 'Var1'
>   epi_plot_heatmap: no visible binding for global variable 'Var2'
>   epi_plot_heatmap: no visible binding for global variable 'value'
>   epi_plot_heatmap_triangle: no visible binding for global variable
>     'Var1'
>   epi_plot_heatmap_triangle: no visible binding for global variable
>     'Var2'
>   epi_plot_heatmap_triangle: no visible binding for global variable
>     'value'
>   epi_plot_heatmap_triangle: no visible global function definition for
>     'element_text'
>   epi_plot_heatmap_triangle: no visible global function definition for
>     'coord_fixed'
>   epi_plot_heatmap_triangle: no visible global function definition for
>     'element_blank'
>   epi_plot_heatmap_triangle: no visible global function definition for
>     'element_rect'
>   epi_plot_heatmap_triangle: no visible global function definition for
>     'guide_colorbar'
>   epi_stats_summary: no visible global function definition for '%>%'
>   epi_stats_tidy: no visible global function definition for '%>%'
>   epi_stats_tidy: no visible binding for global variable '.'
>   epi_stats_tidy: no visible binding for global variable 'x'
>   epi_stats_tidy: no visible binding for global variable 'n'
>   epi_stats_tidy: no visible binding for global variable 'id'
>   Undefined global functions or variables:
>     %>% . Var1 Var2 coord_fixed element_blank element_rect element_text
>     guide_colorbar id n value x
> #######
>
>
> Solutions seem to cause errors elsewhere and there does not appear to be
> an ideal one unfortunately. It seems to me that adding a file in the
> directory 'R' containing eg:
>
> #######
>
> if(getRversion() >= "2.15.1") utils::globalVariables(c("."))
>
> #######
>
> is one of the preferred ways. This seems far from ideal though.

If you use NSE in your package, this is the best solution. You may
also switch to SE.

I?aki

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Jul  2 22:25:35 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 2 Jul 2019 16:25:35 -0400
Subject: [R-pkg-devel] "Progress reports" for examples in packages.
In-Reply-To: <9ec6c6b7-8f84-0017-7e12-579729c97605@auckland.ac.nz>
References: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>
 <CAFDcVCSkRgkunpnKUm2j-gbbwH2LU_5T-+7Q8iAto9UvR9_DjA@mail.gmail.com>
 <23835.1399.955675.921469@stat.math.ethz.ch>
 <9ec6c6b7-8f84-0017-7e12-579729c97605@auckland.ac.nz>
Message-ID: <eb0ceeac-5e9a-2cba-16a3-9227e3dbdddc@gmail.com>

On 02/07/2019 5:31 a.m., Rolf Turner wrote:
> 
> Many thanks to Henrik Bengtsson and Martin Maechler for pointing out
> that I can monitor progress by looking at the file
> 
>       "mypkg.Rcheck/mypkg-Ex.Rout"
> 
> e.g. by using "tail -f".  This strategy indeed revealed where the hangup
> was happening.  I wrapped a line of the examples in \dontrun{} and
> checked the package again.  Now the checking completes in finite time! :-)
> 
> However I remain puzzled as to *why* the line in question induces a
> hangup.  When I load the package and run that same  line from the
> command line, a result is returned within about 5 seconds of "wall time"
> (or less).
> 
> Another strangeness:  The line prior to that which I wrapped in
> \dontrun{} took a very long time to return a result, although the
> command did eventually complete (after which everything ran swiftly).
> But when I run this same line from the command line it completes
> *instantaneously*.
> 
> Why on earth would commands be slow, or not execute at all, when run
> under the aegis of "R CMD check", but execute swiftly from the command line?
> 
> I think it would be unwise of me to ignore the fact that something
> strange is going on here, but I'm damned if I can see how to go about
> tracking the strangeness down so as to be able to remedy it.
> 
> My usual practice when trying to get a handle on something that I don't
> understand is to insert browsers() into the code at strategic points.
> See fortunes::fortune(158).  That's of no help in the current context in
> which the problem only arises when R CMD check is being run.
> 
> Can anyone suggest a clever means by which I might determine the
> "magnitude and direction of my stupidity"?

Normally "R CMD check pkg.tar.gz" isn't easily debugged, as you've 
found.  You can make it a bit easier by doing from the console what it 
does from the command line, using

  tools:::.check_packages("pkg.tar.gz")

Sometimes this helps.  I think it spawns separate R processes at a few 
points; if it's one of those that is hanging, you can at least see what 
the command line is, and run that part directly, possibly from the 
console.  Still not easy, but easier.

Duncan Murdoch


From r@turner @end|ng |rom @uck|@nd@@c@nz  Wed Jul  3 01:01:34 2019
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Wed, 3 Jul 2019 11:01:34 +1200
Subject: [R-pkg-devel] "Progress reports" for examples in packages.
In-Reply-To: <20190702141329.09c40d9d@trisector>
References: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>
 <CAFDcVCSkRgkunpnKUm2j-gbbwH2LU_5T-+7Q8iAto9UvR9_DjA@mail.gmail.com>
 <23835.1399.955675.921469@stat.math.ethz.ch>
 <9ec6c6b7-8f84-0017-7e12-579729c97605@auckland.ac.nz>
 <CALEXWq0Xb95LgYAs+Mf9h8d_CTLE=SwQCVqGw8q=sCTwz6u3-g@mail.gmail.com>
 <8cec5632-3c2b-7fe0-0958-3592fe8372f4@auckland.ac.nz>
 <20190702141329.09c40d9d@trisector>
Message-ID: <0ef93e94-5bf7-bc8e-b73e-d446602e5ef4@auckland.ac.nz>


On 2/07/19 11:13 PM, Ivan Krylov wrote:

> Could R CMD check be using valgrind to run the examples? Valgrind has
> to interpret CPU instructions manually to be able to warn about
> results of code execution depending on memory values it considers
> undefined, so it is much slower than execution on a real CPU.
> 
> One way to verify that on a GNU/Linux system would be to temporary
> insert system('pstree -aps $$') into one of the examples and look at
> the output produced.

Thanks for the suggestion.  I put the command that you advise in the 
first example that gets run and in the file

    ldEst.Rcheck/ldEst-Ex.Rout

I got the output:

>> system('pstree -aps $$')
> systemd,1 --system --deserialize 32
>   `-lightdm,1249
>       `-lightdm,1568 --session-child 13 20
>           `-mate-session,1595
>               `-mate-panel,1772
>                   `-mate-terminal,16032
>                       `-tcsh,18036
>                           `-sh,18204 /usr/lib/R/bin/check ldEst_2.0-15.tar.gz
>                               `-R,18208 --no-restore --slave --args nextArgldEst_2.0-15.tar.gz
>                                  `-sh,18572 -c ...
>                                      `-R,18573 --vanilla
>                                         `-sh,18579 -c pstree -aps $$
>                                             `-pstree,18580 -aps 18579

Nothing untoward leaps out at me.  Certainly no mention of valgrind.

Can anyone see anything in the foregoing output that I should 
investigate?  Ta.

cheers,

Rolf

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Jul  3 01:18:02 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 2 Jul 2019 19:18:02 -0400
Subject: [R-pkg-devel] 
 CRAN pre-test failed on NOTE "no visible binding for
 global variable"
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E018F720868@MBXP02.ds.man.ac.uk>
References: <0dd1f26d-d54b-1017-c3b7-fc8760dba2ec@imperial.ac.uk>
 <CALEXWq3ivnrGMKig6hz3jPUY21j-uXwqqa-vYyh=j+LJrvCw0Q@mail.gmail.com>
 <438D2EC9EAFE5946B2D5864670EA468E018F720868@MBXP02.ds.man.ac.uk>
Message-ID: <2b1ba52c-5e9a-6906-ab74-18c0a0984d15@gmail.com>

On 02/07/2019 11:00 a.m., Georgi Boshnakov wrote:
>> ...
>> if(getRversion() >= "2.15.1") utils::globalVariables(c("."))
> 
> Using such a general pattern eventually and  inevitably will prevent the check from reporting legitimate bugs.

I believe globalVariables() takes a vector of names, not a regular 
expression for names.  So that's not so general, it's just the name ".".

Duncan Murdoch

> One alternative is to list explicitly the variables in question and make sure that they are not commonly used names like 'x'.
> If that is not practical and you use non-standard evaluation a lot,  consider '.data' from package 'lang' , see its documentation and/or Google it
> to find out how to use it.
> 
> #' @importFrom rlang .data
> 
> 
> Georgi Boshnakov
> 
> -----Original Message-----
> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of I?aki Ucar
> Sent: 02 July 2019 15:19
> To: Berlanga, Antonio J
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] CRAN pre-test failed on NOTE "no visible binding for global variable"
> 
> ra?l
> 
> On Tue, 2 Jul 2019 at 14:18, Berlanga, Antonio J
> <a.berlanga at imperial.ac.uk> wrote:
>>
>> Hi r-package-devel,
>>
>> I've submitted my first package but it failed the CRAN pre-tests on
>> NOTES. I got:
>>
>> - my email
>>
>> - an extra non-standard file (which I have now added to .Rbuildignore)
>>
>> - NOTEs on "no visible global function definition"
>>
>> The first two I assume are harmless. The third I do not know how to fix
>> (possible solutions below). Can it be ignored and suggest the fail was a
>> false-positive?
>>
>> The third NOTE is:
>>
>> #######
>>
>> Flavor: r-devel-linux-x86_64-debian-gcc, r-devel-windows-ix86+x86_64
>> Check: R code for possible problems, Result: NOTE
>>    epi_clean_count_classes: no visible global function definition for
>>      '%>%'
>>    epi_clean_count_classes: no visible binding for global variable '.'
>>    epi_plot_heatmap: no visible binding for global variable 'Var1'
>>    epi_plot_heatmap: no visible binding for global variable 'Var2'
>>    epi_plot_heatmap: no visible binding for global variable 'value'
>>    epi_plot_heatmap_triangle: no visible binding for global variable
>>      'Var1'
>>    epi_plot_heatmap_triangle: no visible binding for global variable
>>      'Var2'
>>    epi_plot_heatmap_triangle: no visible binding for global variable
>>      'value'
>>    epi_plot_heatmap_triangle: no visible global function definition for
>>      'element_text'
>>    epi_plot_heatmap_triangle: no visible global function definition for
>>      'coord_fixed'
>>    epi_plot_heatmap_triangle: no visible global function definition for
>>      'element_blank'
>>    epi_plot_heatmap_triangle: no visible global function definition for
>>      'element_rect'
>>    epi_plot_heatmap_triangle: no visible global function definition for
>>      'guide_colorbar'
>>    epi_stats_summary: no visible global function definition for '%>%'
>>    epi_stats_tidy: no visible global function definition for '%>%'
>>    epi_stats_tidy: no visible binding for global variable '.'
>>    epi_stats_tidy: no visible binding for global variable 'x'
>>    epi_stats_tidy: no visible binding for global variable 'n'
>>    epi_stats_tidy: no visible binding for global variable 'id'
>>    Undefined global functions or variables:
>>      %>% . Var1 Var2 coord_fixed element_blank element_rect element_text
>>      guide_colorbar id n value x
>> #######
>>
>>
>> Solutions seem to cause errors elsewhere and there does not appear to be
>> an ideal one unfortunately. It seems to me that adding a file in the
>> directory 'R' containing eg:
>>
>> #######
>>
>> if(getRversion() >= "2.15.1") utils::globalVariables(c("."))
>>
>> #######
>>
>> is one of the preferred ways. This seems far from ideal though.
> 
> If you use NSE in your package, this is the best solution. You may
> also switch to SE.
> 
> I?aki
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From ch@r|th_k@run@r@thn@ @end|ng |rom @|u@c@  Wed Jul  3 01:41:04 2019
From: ch@r|th_k@run@r@thn@ @end|ng |rom @|u@c@ (Charith Karunarathna)
Date: Tue, 2 Jul 2019 23:41:04 +0000
Subject: [R-pkg-devel] Warning Message on Vignettes
In-Reply-To: <d6847d5368f34587abe6c2f4f93b4b6f@sfu.ca>
References: <d6847d5368f34587abe6c2f4f93b4b6f@sfu.ca>
Message-ID: <32bf964a3ee8413db42fc8b1800cc717@sfu.ca>

(Reposting..)

Hi everyone,

I am getting following two warnings when I submit my R package (perfectphyloR) to CRAN.

Warning 1: * checking files in 'vignettes' ... WARNING
             Files in the 'vignettes' directory but no files in 'inst/doc':
             'perfectphyloR.html', 'perfectphyloR.html.asis'

Warning 2: * checking package vignettes in 'inst/doc' ... WARNING
             dir.exists(dir) is not TRUE
             Package vignette without corresponding single PDF/HTML:
             'perfectphyloR.html.asis'

I want to make my vignette as a static html vignette (not the PDF). Therefore, I followed this documentation, https://cran.r-project.org/web/packages/R.rsp/vignettes/R_packages-Static_PDF_and_HTML_vignettes.pdf

After including my html vignette (perfectphyloR.html) into the directory 'vignette', I created a file called "perfectphyloR.html.asis" and that file includes following lines:

%\VignetteIndexEntry{R packages: perfectphyloR}
%\VignetteEngine{R.rsp::asis}
%\VignetteKeyword{HTML}
%\VignetteKeyword{vignette}
%\VignetteKeyword{package}

Also, I added 'R.rsp' to the DESCRIPTION file as follows:
....
Suggests:
    knitr,
    rmarkdown,
    R.rsp
VignetteBuilder: R.rsp

So, I am wondering something is wrong with my .asis file or I am doing any other mistake. Could you help me fix this issue?

Thank you in advance!

Regards,

Charith.




        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From @|ex@ndre@court|o| @end|ng |rom gm@||@com  Wed Jul  3 09:21:10 2019
From: @|ex@ndre@court|o| @end|ng |rom gm@||@com (Alexandre Courtiol)
Date: Wed, 3 Jul 2019 09:21:10 +0200
Subject: [R-pkg-devel] Warning Message on Vignettes
In-Reply-To: <32bf964a3ee8413db42fc8b1800cc717@sfu.ca>
References: <d6847d5368f34587abe6c2f4f93b4b6f@sfu.ca>
 <32bf964a3ee8413db42fc8b1800cc717@sfu.ca>
Message-ID: <CAERMt4d=wWfrK+O-19BFxE9GC6wA81H3DW=KsirM0kYzC77gxQ@mail.gmail.com>

Hi, how to you build your package?

I do:
mkdir -p inst/doc
mkdir vignettes
cp sources_vignettes/*.pdf* vignettes ## for linux add -u after cp
cp sources_vignettes/*.Rnw inst/doc ## for linux add -u after cp
(cd inst/doc/; for f in *.Rnw; do mv "$$f" "$${f%.Rnw}_source.txt"; done;)
Rscript -e "tools::compactPDF(paths = 'vignettes', gs_quality = 'printer')"
Rscript -e "devtools::build()"

Does that work for you?
Alex



On Wed, 3 Jul 2019 at 01:41, Charith Karunarathna <
charith_karunarathna at sfu.ca> wrote:

> (Reposting..)
>
> Hi everyone,
>
> I am getting following two warnings when I submit my R package
> (perfectphyloR) to CRAN.
>
> Warning 1: * checking files in 'vignettes' ... WARNING
>              Files in the 'vignettes' directory but no files in 'inst/doc':
>              'perfectphyloR.html', 'perfectphyloR.html.asis'
>
> Warning 2: * checking package vignettes in 'inst/doc' ... WARNING
>              dir.exists(dir) is not TRUE
>              Package vignette without corresponding single PDF/HTML:
>              'perfectphyloR.html.asis'
>
> I want to make my vignette as a static html vignette (not the PDF).
> Therefore, I followed this documentation,
> https://cran.r-project.org/web/packages/R.rsp/vignettes/R_packages-Static_PDF_and_HTML_vignettes.pdf
>
> After including my html vignette (perfectphyloR.html) into the directory
> 'vignette', I created a file called "perfectphyloR.html.asis" and that file
> includes following lines:
>
> %\VignetteIndexEntry{R packages: perfectphyloR}
> %\VignetteEngine{R.rsp::asis}
> %\VignetteKeyword{HTML}
> %\VignetteKeyword{vignette}
> %\VignetteKeyword{package}
>
> Also, I added 'R.rsp' to the DESCRIPTION file as follows:
> ....
> Suggests:
>     knitr,
>     rmarkdown,
>     R.rsp
> VignetteBuilder: R.rsp
>
> So, I am wondering something is wrong with my .asis file or I am doing any
> other mistake. Could you help me fix this issue?
>
> Thank you in advance!
>
> Regards,
>
> Charith.
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


-- 
Alexandre Courtiol

http://sites.google.com/site/alexandrecourtiol/home

*"Science is the belief in the ignorance of experts"*, R. Feynman

	[[alternative HTML version deleted]]


From m|@gruen@t@eud| @end|ng |rom gm@||@com  Wed Jul  3 19:43:52 2019
From: m|@gruen@t@eud| @end|ng |rom gm@||@com (Michael Gruenstaeudl)
Date: Wed, 3 Jul 2019 19:43:52 +0200
Subject: [R-pkg-devel] VignetteBuilder field
Message-ID: <fae23335-c8b6-43d5-e67c-567362d0aa4a@gmail.com>

Assume an R package `myPackage` that contains the folder `vignettes`, in 
which the TEX-file `PACViR_Vignette.tex` and two image files 
(`image1.pdf` and `image2.pdf`) are located. The TEX-file compiles 
nicely without the need to use Sweave or knitr.

Upon testing the package for submission to CRAN via `R CMD check PACViR 
--as-cran`, I receive the following NOTES, which appear to prevent CRAN 
from accepting my package:


Flavor: r-devel-windows-ix86+x86_64
Check: files in 'vignettes', Result: NOTE
   Package has no Sweave vignette sources and no VignetteBuilder field.

Flavor: r-devel-linux-x86_64-debian-gcc
Check: files in ???vignettes???, Result: NOTE
   Package has no Sweave vignette sources and no VignetteBuilder field.


What is needed to address this issue? Do I need to specify a 
`VignetteBuilder` somewhere?


From edd @end|ng |rom deb|@n@org  Wed Jul  3 20:07:13 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 3 Jul 2019 13:07:13 -0500
Subject: [R-pkg-devel] VignetteBuilder field
In-Reply-To: <fae23335-c8b6-43d5-e67c-567362d0aa4a@gmail.com>
References: <fae23335-c8b6-43d5-e67c-567362d0aa4a@gmail.com>
Message-ID: <23836.61137.89858.437339@rob.eddelbuettel.com>


On 3 July 2019 at 19:43, Michael Gruenstaeudl wrote:
| Assume an R package `myPackage` that contains the folder `vignettes`, in 
| which the TEX-file `PACViR_Vignette.tex` and two image files 
| (`image1.pdf` and `image2.pdf`) are located. The TEX-file compiles 
| nicely without the need to use Sweave or knitr.
| 
| Upon testing the package for submission to CRAN via `R CMD check PACViR 
| --as-cran`, I receive the following NOTES, which appear to prevent CRAN 
| from accepting my package:
| 
| 
| Flavor: r-devel-windows-ix86+x86_64
| Check: files in 'vignettes', Result: NOTE
|    Package has no Sweave vignette sources and no VignetteBuilder field.
| 
| Flavor: r-devel-linux-x86_64-debian-gcc
| Check: files in ???vignettes???, Result: NOTE
|    Package has no Sweave vignette sources and no VignetteBuilder field.
| 
| What is needed to address this issue? Do I need to specify a 
| `VignetteBuilder` somewhere?

Your mental model may be that any suitable latex or tex file will pass for a
vignette.  But that is not how it works.

Luckily it is both easy to turn your .tex into an .Rnw, and that should be
all you need.  Ie something like 

  \documentclass{article}
  %\VignetteIndexEntry{SOMETHING OR OTHER HERE}
  %\VignetteKeywords{HERE TOO}
  %\VignettePackage{HERE TOO}
  %\VignetteEncoding{UTF-8}

  \begin{document}

  % your latex code here

  \end{document}

save as vignette/my_package_vignette.Rnw is all it takes. You can add latex
commands to the header as usual, and can do just about anything the document
part.  Including weaving R code.  But you don't have too.  Fully static work.

You can also go a third way and pre-render your vignette and then have a
minimal file slurping it in. Mark described that here:

  http://www.markvanderloo.eu/yaRb/2019/01/11/add-a-static-pdf-vignette-to-an-r-package/

and I am doing that in a few packages as I was getting bored of having to see
builds or checks randomly fail if some semi-common tex files or styles were
missing.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From ec@c@rv@ @end|ng |rom gm@||@com  Thu Jul  4 13:21:21 2019
From: ec@c@rv@ @end|ng |rom gm@||@com (Elias Carvalho)
Date: Thu, 4 Jul 2019 08:21:21 -0300
Subject: [R-pkg-devel] Parallel processing
Message-ID: <CAH8E6Uv7P3zXXEaAYFO14jFDx0k6tLqNP7Ex-sv=0eWh1d-0+w@mail.gmail.com>

*I am building a package a package and one of its functions need parallel
procesing.*
*Then I created the function because my final use are not technical:*

create.cluster <-function()
{
  # Calculate the number of cores
  no_cores <-parallel::detectCores() - 1
  # Initiate cluster
  cl <- parallel::makeCluster(no_cores)
  return(cl)
} # create.cluster <-function()

*Then the final use need to execute:*

cl <- create.cluster()
Commands
parallel::stopCluster(cl);

*When preparing my package with "R CMD check --as-cran mypackage" the
following error occurs:*
*Error in .check_ncores(length(names)) : 3 simultaneous processes spawned*
*I know the limit of cores is 2 for package check and my laptop has 4, I
believe this is the error cause.*

*How I would fix this error?*

-- 


*In Jesu et Maria*

*Thank you*
*Prof. Elias Carvalho*

*"Felix, qui potuit rerum cognoscere causas" (Virgil 29 BC)"Blessed is he
who has been able to understand the cause of things"*

	[[alternative HTML version deleted]]


From m|@gruen@t@eud| @end|ng |rom gm@||@com  Fri Jul  5 00:25:25 2019
From: m|@gruen@t@eud| @end|ng |rom gm@||@com (Michael Gruenstaeudl)
Date: Fri, 5 Jul 2019 00:25:25 +0200
Subject: [R-pkg-devel] CRAN-compatible location for output of example code?
Message-ID: <827fe7e4-fec1-af84-e81b-2c4e70bc86a0@gmail.com>

Assume an R package that generates a figure ('output.pdf') as the result 
of executing the example code specified in one of the manual files (i.e. 
an .Rd file). The example code specifies the figure to be saved to the 
root directory of the package (i.e., where files DESCRIPTION and 
NAMESPACE are located).

\examples{
...
outFile <- paste(getwd(), "output.pdf", sep="")
...
}

Upon submitting the package to CRAN, I receive the NOTE that the 
following note:

Flavor: r-devel-linux-x86_64-debian-gcc
Check: for non-standard things in the check directory, Result: NOTE
   Found the following files/directories:
     'output.pdf'

To which folder should I have the example code save the output file in 
order for the code to be compatible with the CRAN submission guidelines?


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Jul  5 01:06:26 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 04 Jul 2019 16:06:26 -0700
Subject: [R-pkg-devel] 
 CRAN-compatible location for output of example code?
In-Reply-To: <827fe7e4-fec1-af84-e81b-2c4e70bc86a0@gmail.com>
References: <827fe7e4-fec1-af84-e81b-2c4e70bc86a0@gmail.com>
Message-ID: <03549477-A3C4-4C89-892C-3F50586A9E4A@dcn.davis.ca.us>

https://stat.ethz.ch/R-manual/R-devel/library/base/html/tempfile.html

?tempdir

On July 4, 2019 3:25:25 PM PDT, Michael Gruenstaeudl <mi.gruenstaeudl at gmail.com> wrote:
>Assume an R package that generates a figure ('output.pdf') as the
>result 
>of executing the example code specified in one of the manual files
>(i.e. 
>an .Rd file). The example code specifies the figure to be saved to the 
>root directory of the package (i.e., where files DESCRIPTION and 
>NAMESPACE are located).
>
>\examples{
>...
>outFile <- paste(getwd(), "output.pdf", sep="")
>...
>}
>
>Upon submitting the package to CRAN, I receive the NOTE that the 
>following note:
>
>Flavor: r-devel-linux-x86_64-debian-gcc
>Check: for non-standard things in the check directory, Result: NOTE
>   Found the following files/directories:
>     'output.pdf'
>
>To which folder should I have the example code save the output file in 
>order for the code to be compatible with the CRAN submission
>guidelines?
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Jul  5 01:43:53 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 04 Jul 2019 16:43:53 -0700
Subject: [R-pkg-devel] Block quote in an Rd file?
Message-ID: <7DB4636B-5D78-4FB7-9CBF-AF31590466D2@dcn.davis.ca.us>

Not seeing in "Writing R Extensions" a way to annotate a block quote in an Rd file. Any suggestions?
-- 
Sent from my phone. Please excuse my brevity.


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Jul  5 02:48:56 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 4 Jul 2019 20:48:56 -0400
Subject: [R-pkg-devel] Block quote in an Rd file?
In-Reply-To: <7DB4636B-5D78-4FB7-9CBF-AF31590466D2@dcn.davis.ca.us>
References: <7DB4636B-5D78-4FB7-9CBF-AF31590466D2@dcn.davis.ca.us>
Message-ID: <24f1442b-a86a-7720-c8e1-091423883baf@gmail.com>

On 04/07/2019 7:43 p.m., Jeff Newmiller wrote:
> Not seeing in "Writing R Extensions" a way to annotate a block quote in an Rd file. Any suggestions?

I don't think there is a built-in one.  If you are determined to have 
one, you could define your own user-defined macro to do it.  It'll be 
ugly, because you need to output different text depending on whether the 
help page is being displayed in plain text, HTML or LaTeX.  See sections 
2.11 and 2.13 of Writing R Extensions for the docs.

Duncan Murdoch


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Jul  5 04:11:05 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 04 Jul 2019 19:11:05 -0700
Subject: [R-pkg-devel] Block quote in an Rd file?
In-Reply-To: <24f1442b-a86a-7720-c8e1-091423883baf@gmail.com>
References: <7DB4636B-5D78-4FB7-9CBF-AF31590466D2@dcn.davis.ca.us>
 <24f1442b-a86a-7720-c8e1-091423883baf@gmail.com>
Message-ID: <C7BD2295-E3B3-4DFB-9752-EA2431717CD5@dcn.davis.ca.us>

Ehh... not that much. Will make do with a couple of quote marks. Thanks for the confirmation.

On July 4, 2019 5:48:56 PM PDT, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>On 04/07/2019 7:43 p.m., Jeff Newmiller wrote:
>> Not seeing in "Writing R Extensions" a way to annotate a block quote
>in an Rd file. Any suggestions?
>
>I don't think there is a built-in one.  If you are determined to have 
>one, you could define your own user-defined macro to do it.  It'll be 
>ugly, because you need to output different text depending on whether
>the 
>help page is being displayed in plain text, HTML or LaTeX.  See
>sections 
>2.11 and 2.13 of Writing R Extensions for the docs.
>
>Duncan Murdoch

-- 
Sent from my phone. Please excuse my brevity.


From @|exh@||@m6@28 @end|ng |rom gm@||@com  Sat Jul  6 15:27:04 2019
From: @|exh@||@m6@28 @end|ng |rom gm@||@com (Alex Hallam)
Date: Sat, 6 Jul 2019 09:27:04 -0400
Subject: [R-pkg-devel] Writing a data package with large files
Message-ID: <CALYo-F8xxwZ_3SF+j9hygQRz+0s+3+EM67F1WHHLxKDPnctuAg@mail.gmail.com>

I have been working on making a data package. The goal is to one day push
it to CRAN,
but I am having 2 problems (one warning and one note) from R CMD. I think
the problems
are due to having large files (a 453M csv.7z raw file and a 75M .rda file)

Below is my R CMD check.

?? R CMD check results ????????????????????????????????? cfsales 0.0.0.9000
????
Duration: 2m 0.9s

? checking data for ASCII and uncompressed saves ... WARNING
    Warning: package needs dependence on R (>= 2.10)

? checking installed package size ... NOTE
    installed size is 133.1Mb
    sub-directories of 1Mb or more:
      data  133.0Mb

0 errors ? | 1 warning ? | 1 note ?
Error: R CMD check found WARNINGs
Execution halted

Exited with status 1.

1. WARNING - Warning: package needs dependence on R (>= 2.10). I am not
sure where to start looking to fix this problem.

2. NOTE - I have two big files that I think are flagging this note.
train.rda and train.csv.7z. Is there any guidance on how
to deal with large files?

Additionally, train.rda is just a sample of the full data. The original
data has 52 stores and I only
take 13 stores. If I were to take the full set then R CMD check throws an
error as opposed the the current note I am getting now. If there is a way
to use the full data set without getting an error I would love to hear it.

The link to this package is here

https://github.com/alexhallam/cfsales

The location of the problem files are here

https://github.com/alexhallam/cfsales/tree/master/data-raw

-- 

Thanks!
-Alex

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Sat Jul  6 16:10:48 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sat, 6 Jul 2019 09:10:48 -0500
Subject: [R-pkg-devel] Writing a data package with large files
In-Reply-To: <CALYo-F8xxwZ_3SF+j9hygQRz+0s+3+EM67F1WHHLxKDPnctuAg@mail.gmail.com>
References: <CALYo-F8xxwZ_3SF+j9hygQRz+0s+3+EM67F1WHHLxKDPnctuAg@mail.gmail.com>
Message-ID: <23840.44008.496964.527808@rob.eddelbuettel.com>


On 6 July 2019 at 09:27, Alex Hallam wrote:
| I have been working on making a data package. The goal is to one day push
| it to CRAN, but I am having 2 problems (one warning and one note) from R
| CMD. I think the problems are due to having large files (a 453M csv.7z raw
| file and a 75M .rda file)

Well that is in excess of what the manual ("Writing R Extensions") and the
CRAN Repo Policy allow.

So I suggest you think about other ways for users to get your data. Brooke
and I once described a particular approach here:

  https://journal.r-project.org/archive/2017/RJ-2017-026/index.html

and I include the main gist / abstract:

  Hosting Data Packages via drat: A Case Study with Hurricane Exposure Data  
  G. Brooke Anderson and Dirk Eddelbuettel
  The R Journal (2017) 9:1, pages 486-497.

  Abstract Data-only packages offer a way to provide extended functionality
  for other R users. However, such packages can be large enough to exceed the
  package size limit (5 megabytes) for the Comprehen sive R Archive Network
  (CRAN). As an alternative, large data packages can be posted to additional
  repostiories beyond CRAN itself in a way that allows smaller code packages
  on CRAN to access and use the data. The drat package facilitates creation
  and use of such alternative repositories and makes it particularly simple
  to host them via GitHub. CRAN packages can draw on packages posted to drat
  repositories through the use of the ?Additonal_repositories? field in the
  DESCRIPTION file. This paper describes how R users can create a suite of
  coordinated packages, in which larger data packages are hosted in an
  alternative repository created with drat, while a smaller code package that
  interacts with this data is created that can be submitted to CRAN.

Hth, Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @|exh@||@m6@28 @end|ng |rom gm@||@com  Sat Jul  6 20:36:36 2019
From: @|exh@||@m6@28 @end|ng |rom gm@||@com (Alex Hallam)
Date: Sat, 6 Jul 2019 14:36:36 -0400
Subject: [R-pkg-devel] Writing a data package with large files
In-Reply-To: <23840.44008.496964.527808@rob.eddelbuettel.com>
References: <CALYo-F8xxwZ_3SF+j9hygQRz+0s+3+EM67F1WHHLxKDPnctuAg@mail.gmail.com>
 <23840.44008.496964.527808@rob.eddelbuettel.com>
Message-ID: <CALYo-F-n0qkOa+UN1gkwVrP2GbOUe1jVrvqS0GN3YtqzYgxFUg@mail.gmail.com>

Thanks. This is exactly what I needed.

Thanks
-Alex

On Sat, Jul 6, 2019 at 10:10 AM Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 6 July 2019 at 09:27, Alex Hallam wrote:
> | I have been working on making a data package. The goal is to one day push
> | it to CRAN, but I am having 2 problems (one warning and one note) from R
> | CMD. I think the problems are due to having large files (a 453M csv.7z
> raw
> | file and a 75M .rda file)
>
> Well that is in excess of what the manual ("Writing R Extensions") and the
> CRAN Repo Policy allow.
>
> So I suggest you think about other ways for users to get your data. Brooke
> and I once described a particular approach here:
>
>   https://journal.r-project.org/archive/2017/RJ-2017-026/index.html
>
> and I include the main gist / abstract:
>
>   Hosting Data Packages via drat: A Case Study with Hurricane Exposure
> Data
>   G. Brooke Anderson and Dirk Eddelbuettel
>   The R Journal (2017) 9:1, pages 486-497.
>
>   Abstract Data-only packages offer a way to provide extended functionality
>   for other R users. However, such packages can be large enough to exceed
> the
>   package size limit (5 megabytes) for the Comprehen sive R Archive Network
>   (CRAN). As an alternative, large data packages can be posted to
> additional
>   repostiories beyond CRAN itself in a way that allows smaller code
> packages
>   on CRAN to access and use the data. The drat package facilitates creation
>   and use of such alternative repositories and makes it particularly simple
>   to host them via GitHub. CRAN packages can draw on packages posted to
> drat
>   repositories through the use of the ?Additonal_repositories? field in the
>   DESCRIPTION file. This paper describes how R users can create a suite of
>   coordinated packages, in which larger data packages are hosted in an
>   alternative repository created with drat, while a smaller code package
> that
>   interacts with this data is created that can be submitted to CRAN.
>
> Hth, Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>


-- 

Thanks!
-Alex

	[[alternative HTML version deleted]]


From r@||@@tubner @end|ng |rom gm@||@com  Sat Jul  6 22:45:42 2019
From: r@||@@tubner @end|ng |rom gm@||@com (Ralf Stubner)
Date: Sat, 6 Jul 2019 22:45:42 +0200
Subject: [R-pkg-devel] Reproducing address sanitizer errors
Message-ID: <CAFQwRQxXMazDvXH32fVmNXW=1A_RhBnHxyHiFxV7D5=hxgj11Q@mail.gmail.com>

Dear List,

I have been informed that the most recent upload of our swephR package
triggers stack-buffer-overflow. See for example
https://www.stats.ox.ac.uk/pub/bdr/memtests/clang-ASAN/swephR. The
reason seems to be quite obvious (an array has been declared with 36
instead of 37 elements), but I would like to be sure about that.
However, I cannot reproduce the issue. I have tried
"rhub::check_with_sanitizers()" as well as running the problematic
code with RD from the docker image rocker/r-devel-ubsan-clang (with
--cap-add SYS_PTRACE), but to no avail. Does any of you have some
other possibility to reproduce ASAN errors?

Thanks
Ralf


From r@turner @end|ng |rom @uck|@nd@@c@nz  Sun Jul  7 05:19:27 2019
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Sun, 7 Jul 2019 15:19:27 +1200
Subject: [R-pkg-devel] "Progress reports" for examples in packages ---
 SOLVED.
In-Reply-To: <eb0ceeac-5e9a-2cba-16a3-9227e3dbdddc@gmail.com>
References: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>
 <CAFDcVCSkRgkunpnKUm2j-gbbwH2LU_5T-+7Q8iAto9UvR9_DjA@mail.gmail.com>
 <23835.1399.955675.921469@stat.math.ethz.ch>
 <9ec6c6b7-8f84-0017-7e12-579729c97605@auckland.ac.nz>
 <eb0ceeac-5e9a-2cba-16a3-9227e3dbdddc@gmail.com>
Message-ID: <b91db16a-640a-747b-16fe-6247470f770a@auckland.ac.nz>



Just thought it might be of interest were I to give a progress report
( :-) ) on this problem.

I managed to track down and fix what was going wrong.  It turns out that 
the issue was "stringsAsFactors".  I *hate* stringsAsFactors being TRUE 
so I have a call to options() setting it to FALSE in my .Rprofile.

But of course R CMD check sets it to TRUE.  In my code, I create at one 
point a one-row data frame.  I use a data frame so that the object is 
consistent with appears in other contexts in the code.  I extracting the 
entries of the data frame in question from other objects.  Some of these 
entries are strings ... uh-oh!  When they get changed to factors and 
then passed on to a function which passes them on to (e.g.) binomial() 
they wind up taking values like, e.g., 1, where "logit" was what was 
intended.

I had the function that calls binomial() wrapped up in a try() with 
silent=TRUE, since there are occasional circumstances in which there 
would be a "legitimate" fail (and I wanted to create a missing value if
there was such a fail).  However there was *always* a fail due to the
stringsAsFactors contretemps, so the overall result was useless and the 
repeat{ } loop repeated.  Endlessly.  When R CMD check was run.
(But everything was of course just ducky when I ran the example "as 
myself".)

The fix, once I found the problem, was simple; just stick in a
stringsAsFactors=FALSE in the relevant call to data.frame().

Finding the problem, obvious as it is in retrospect, was a nightmare. 
It required many many many attempts with cat() statements inserted at 
various places (in accordance with the advice given by Ben Bolker).  I 
had the devil's own time figuring out what to cat()!

I found, once I'd tracked down which example was the culprit (by doing
tail -f pkge-Ex.Rout), that I could use \dontrun{} on all of the *other* 
examples and get the same puzzling behaviour.  This speeded up the 
process considerably.

Don't know if there is any message to take away from all of the 
foregoing (other than that Rolf Turner is pretty stupid) but I thought 
that some list members might find the story to be of interest.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Jul  7 05:27:34 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 06 Jul 2019 20:27:34 -0700
Subject: [R-pkg-devel] "Progress reports" for examples in packages ---
 SOLVED.
In-Reply-To: <b91db16a-640a-747b-16fe-6247470f770a@auckland.ac.nz>
References: <7fdab0a8-6b2c-33a7-8b95-645df0b430ee@auckland.ac.nz>
 <CAFDcVCSkRgkunpnKUm2j-gbbwH2LU_5T-+7Q8iAto9UvR9_DjA@mail.gmail.com>
 <23835.1399.955675.921469@stat.math.ethz.ch>
 <9ec6c6b7-8f84-0017-7e12-579729c97605@auckland.ac.nz>
 <eb0ceeac-5e9a-2cba-16a3-9227e3dbdddc@gmail.com>
 <b91db16a-640a-747b-16fe-6247470f770a@auckland.ac.nz>
Message-ID: <1DB50F40-0359-4846-B4B2-A0348A296A93@dcn.davis.ca.us>

This is why I only put localization variables in .Rprofile and am always putting such options into my project-specific scripts.

This may sound like I am a masochist, but I hate sharing my scripts with someone else contaminated with compatibility bombs like that.

On July 6, 2019 8:19:27 PM PDT, Rolf Turner <r.turner at auckland.ac.nz> wrote:
>
>
>Just thought it might be of interest were I to give a progress report
>( :-) ) on this problem.
>
>I managed to track down and fix what was going wrong.  It turns out
>that 
>the issue was "stringsAsFactors".  I *hate* stringsAsFactors being TRUE
>
>so I have a call to options() setting it to FALSE in my .Rprofile.
>
>But of course R CMD check sets it to TRUE.  In my code, I create at one
>
>point a one-row data frame.  I use a data frame so that the object is 
>consistent with appears in other contexts in the code.  I extracting
>the 
>entries of the data frame in question from other objects.  Some of
>these 
>entries are strings ... uh-oh!  When they get changed to factors and 
>then passed on to a function which passes them on to (e.g.) binomial() 
>they wind up taking values like, e.g., 1, where "logit" was what was 
>intended.
>
>I had the function that calls binomial() wrapped up in a try() with 
>silent=TRUE, since there are occasional circumstances in which there 
>would be a "legitimate" fail (and I wanted to create a missing value if
>there was such a fail).  However there was *always* a fail due to the
>stringsAsFactors contretemps, so the overall result was useless and the
>
>repeat{ } loop repeated.  Endlessly.  When R CMD check was run.
>(But everything was of course just ducky when I ran the example "as 
>myself".)
>
>The fix, once I found the problem, was simple; just stick in a
>stringsAsFactors=FALSE in the relevant call to data.frame().
>
>Finding the problem, obvious as it is in retrospect, was a nightmare. 
>It required many many many attempts with cat() statements inserted at 
>various places (in accordance with the advice given by Ben Bolker).  I 
>had the devil's own time figuring out what to cat()!
>
>I found, once I'd tracked down which example was the culprit (by doing
>tail -f pkge-Ex.Rout), that I could use \dontrun{} on all of the
>*other* 
>examples and get the same puzzling behaviour.  This speeded up the 
>process considerably.
>
>Don't know if there is any message to take away from all of the 
>foregoing (other than that Rolf Turner is pretty stupid) but I thought 
>that some list members might find the story to be of interest.
>
>cheers,
>
>Rolf Turner

-- 
Sent from my phone. Please excuse my brevity.


From r@||@@tubner @end|ng |rom gm@||@com  Mon Jul  8 17:48:58 2019
From: r@||@@tubner @end|ng |rom gm@||@com (Ralf Stubner)
Date: Mon, 8 Jul 2019 17:48:58 +0200
Subject: [R-pkg-devel] Reproducing address sanitizer errors
In-Reply-To: <CAFQwRQxXMazDvXH32fVmNXW=1A_RhBnHxyHiFxV7D5=hxgj11Q@mail.gmail.com>
References: <CAFQwRQxXMazDvXH32fVmNXW=1A_RhBnHxyHiFxV7D5=hxgj11Q@mail.gmail.com>
Message-ID: <CAFQwRQz3j-PPFaRG_fVnHkH84761tz3hTFBxkQJ9gKLL0nCe8g@mail.gmail.com>

On Sat, Jul 6, 2019 at 10:45 PM Ralf Stubner <ralf.stubner at gmail.com> wrote:
> I have been informed that the most recent upload of our swephR package
> triggers stack-buffer-overflow. See for example
> https://www.stats.ox.ac.uk/pub/bdr/memtests/clang-ASAN/swephR. The
> reason seems to be quite obvious (an array has been declared with 36
> instead of 37 elements), but I would like to be sure about that.
> However, I cannot reproduce the issue. I have tried
> "rhub::check_with_sanitizers()" as well as running the problematic
> code with RD from the docker image rocker/r-devel-ubsan-clang (with
> --cap-add SYS_PTRACE), but to no avail. Does any of you have some
> other possibility to reproduce ASAN errors?

The linked page is gone since I uploaded a fixed version of swephR today. In the
I was able to reproduce the error and check the  fix using
rocker/r-devel-ubsan-clang together with

export ASAN_OPTIONS='detect_leaks=0:detect_odr_violation=0'

cheerio
ralf


From @|exh@||@m6@28 @end|ng |rom gm@||@com  Wed Jul 10 11:53:42 2019
From: @|exh@||@m6@28 @end|ng |rom gm@||@com (Alex Hallam)
Date: Wed, 10 Jul 2019 05:53:42 -0400
Subject: [R-pkg-devel] Difficulty installing my package from drat repository
Message-ID: <CALYo-F-qu+ysN3Cefmq-t5cYEWF11ZtmWEiiMerjwTf15HKHSw@mail.gmail.com>

I am working on a data package. Due to the size of the package I opted
to store the package as a drat repo.

I am able to install my package locally, but I can't seem to install the
package
from the drat repo. The error I get is:

```
Installing package into ?/usr/local/lib/R/site-library?
(as ?lib? is unspecified)
trying URL '
https://alexhallam.github.io/drat/src/contrib/cfsalesdata_0.0.1.1.tar.gz'
Content type 'application/gzip' length 134 bytes
==================================================
downloaded 134 bytes

Error in untar2(tarfile, files, list, exdir, restore_times) :
  incomplete block on file
Warning in install.packages :
  installation of package ?cfsalesdata? had non-zero exit status
```

These are the commands I used to install my data package. The local
install works, but my two attempts at installing from a remote repo failed.

# This works on my local computer
install.packages(file.choose(),repos = NULL, type = "source")

# Install from remote (fails)
install.packages("cfsalesdata",repos = "https://alexhallam.github.io/drat/",
type = "source")

# Install from remote with drat (fails)
library(drat)
addRepo("alexhallam")
install.packages("cfsalesdata")

My hunch is that this has to do with the tar ball being tracked with "git
large file storage". This is because the file size of my tar ball is 154.9
MB which exceeds github's 100 MB file size limit. What options can I try in
this situation?

-- 

Thanks!
-Alex

	[[alternative HTML version deleted]]


From r@||@@tubner @end|ng |rom gm@||@com  Wed Jul 10 12:11:59 2019
From: r@||@@tubner @end|ng |rom gm@||@com (Ralf Stubner)
Date: Wed, 10 Jul 2019 12:11:59 +0200
Subject: [R-pkg-devel] 
 Difficulty installing my package from drat repository
In-Reply-To: <CALYo-F-qu+ysN3Cefmq-t5cYEWF11ZtmWEiiMerjwTf15HKHSw@mail.gmail.com>
References: <CALYo-F-qu+ysN3Cefmq-t5cYEWF11ZtmWEiiMerjwTf15HKHSw@mail.gmail.com>
Message-ID: <CAFQwRQzDNNkHU6OWyttKDaF5YAfpJpxqkZ_NZeJpbfPj=01OLQ@mail.gmail.com>

On Wed, Jul 10, 2019 at 11:54 AM Alex Hallam <alexhallam6.28 at gmail.com> wrote:

> My hunch is that this has to do with the tar ball being tracked with "git
> large file storage". This is because the file size of my tar ball is 154.9
> MB which exceeds github's 100 MB file size limit. What options can I try in
> this situation?

Downloading the file in question gives

ralf at barra:~$ curl
https://alexhallam.github.io/drat/src/contrib/cfsalesdata_0.0.1.1.tar.gz
version https://git-lfs.github.com/spec/v1
oid sha256:91cd243e7e65ee315419e70c8104a159aae64a629d180b29d38ed44646215101
size 162397527

So your hunch seems to be correct. Can you distribute the data over
two (or more) packages?

cheerio
ralf


From edd @end|ng |rom deb|@n@org  Wed Jul 10 12:14:14 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 10 Jul 2019 05:14:14 -0500
Subject: [R-pkg-devel] 
 Difficulty installing my package from drat repository
In-Reply-To: <CALYo-F-qu+ysN3Cefmq-t5cYEWF11ZtmWEiiMerjwTf15HKHSw@mail.gmail.com>
References: <CALYo-F-qu+ysN3Cefmq-t5cYEWF11ZtmWEiiMerjwTf15HKHSw@mail.gmail.com>
Message-ID: <23845.47734.304167.328669@rob.eddelbuettel.com>


On 10 July 2019 at 05:53, Alex Hallam wrote:
| I am working on a data package. Due to the size of the package I opted
| to store the package as a drat repo.
| 
| I am able to install my package locally, but I can't seem to install the
| package
| from the drat repo. The error I get is:
| 
| ```
| Installing package into ?/usr/local/lib/R/site-library?
| (as ?lib? is unspecified)
| trying URL '
| https://alexhallam.github.io/drat/src/contrib/cfsalesdata_0.0.1.1.tar.gz'
| Content type 'application/gzip' length 134 bytes
| ==================================================
| downloaded 134 bytes
| 
| Error in untar2(tarfile, files, list, exdir, restore_times) :
|   incomplete block on file
| Warning in install.packages :
|   installation of package ?cfsalesdata? had non-zero exit status
| ```
| 
| These are the commands I used to install my data package. The local
| install works, but my two attempts at installing from a remote repo failed.
| 
| # This works on my local computer
| install.packages(file.choose(),repos = NULL, type = "source")
| 
| # Install from remote (fails)
| install.packages("cfsalesdata",repos = "https://alexhallam.github.io/drat/",
| type = "source")
| 
| # Install from remote with drat (fails)
| library(drat)
| addRepo("alexhallam")
| install.packages("cfsalesdata")
| 
| My hunch is that this has to do with the tar ball being tracked with "git
| large file storage". This is because the file size of my tar ball is 154.9
| MB which exceeds github's 100 MB file size limit. What options can I try in
| this situation?

Shucks. Should have realized the >100gb issue when I reocmmended drat. We
have GH LFS support as a feature request issue, but I cannot / will not work
on it as I do not have such files or repos ...

Easiest hack: split your data package into chunks < 100gb and use standard more.

Sorry about that,  Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @|exh@||@m6@28 @end|ng |rom gm@||@com  Wed Jul 10 15:26:58 2019
From: @|exh@||@m6@28 @end|ng |rom gm@||@com (Alex Hallam)
Date: Wed, 10 Jul 2019 09:26:58 -0400
Subject: [R-pkg-devel] Will use split option
In-Reply-To: <23845.47734.304167.328669@rob.eddelbuettel.com>
References: <CALYo-F-qu+ysN3Cefmq-t5cYEWF11ZtmWEiiMerjwTf15HKHSw@mail.gmail.com>
 <23845.47734.304167.328669@rob.eddelbuettel.com>
Message-ID: <CALYo-F9V1K90Twx0vS5S1GM-P3FL4cW53Pa4Ya8=ZrXCYJUo4A@mail.gmail.com>

On Wed, Jul 10, 2019 at 6:14 AM Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 10 July 2019 at 05:53, Alex Hallam wrote:
> | I am working on a data package. Due to the size of the package I opted
> | to store the package as a drat repo.
> |
> | I am able to install my package locally, but I can't seem to install the
> | package
> | from the drat repo. The error I get is:
> |
> | ```
> | Installing package into ?/usr/local/lib/R/site-library?
> | (as ?lib? is unspecified)
> | trying URL '
> | https://alexhallam.github.io/drat/src/contrib/cfsalesdata_0.0.1.1.tar.gz
> '
> | Content type 'application/gzip' length 134 bytes
> | ==================================================
> | downloaded 134 bytes
> |
> | Error in untar2(tarfile, files, list, exdir, restore_times) :
> |   incomplete block on file
> | Warning in install.packages :
> |   installation of package ?cfsalesdata? had non-zero exit status
> | ```
> |
> | These are the commands I used to install my data package. The local
> | install works, but my two attempts at installing from a remote repo
> failed.
> |
> | # This works on my local computer
> | install.packages(file.choose(),repos = NULL, type = "source")
> |
> | # Install from remote (fails)
> | install.packages("cfsalesdata",repos = "
> https://alexhallam.github.io/drat/",
> | type = "source")
> |
> | # Install from remote with drat (fails)
> | library(drat)
> | addRepo("alexhallam")
> | install.packages("cfsalesdata")
> |
> | My hunch is that this has to do with the tar ball being tracked with "git
> | large file storage". This is because the file size of my tar ball is
> 154.9
> | MB which exceeds github's 100 MB file size limit. What options can I try
> in
> | this situation?
>
> Shucks. Should have realized the >100gb issue when I reocmmended drat. We
> have GH LFS support as a feature request issue, but I cannot / will not
> work
> on it as I do not have such files or repos ...
>
> Easiest hack: split your data package into chunks < 100gb and use standard
> more.
>
> Sorry about that,  Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>


Thanks everyone. I will go ahead and split the repo into a couple pieces.

-- 

Thanks!
-Alex

	[[alternative HTML version deleted]]


From mu@che|||j2 @end|ng |rom gm@||@com  Wed Jul 10 20:49:33 2019
From: mu@che|||j2 @end|ng |rom gm@||@com (John Muschelli)
Date: Wed, 10 Jul 2019 14:49:33 -0400
Subject: [R-pkg-devel] Updates on Third Party Sfoware
Message-ID: <CAFsq6G_SnvLPU4ELpFKf44wAGvkAhfz1WRjbz8UeB=D72Aws=A@mail.gmail.com>

I'm submitting a package that uses ffmpeg, which I found out the CRAN
windows build has available (after submitting to win-builder and CRAN).   I
was unaware this was available (or which version).  Please see (
https://win-builder.r-project.org/V3WjxbzIOQQ2/00check.log) for example,
which gives

Warning in system(cmd, intern = TRUE, ignore.stderr = TRUE) :
  running command '"C:/Program Files/ImageMagick/ffmpeg.exe" -codecs' had
status 313

I see on
https://cran.r-project.org/bin/windows/contrib/ThirdPartySoftware.html that
there are a number of third party software suites available.  This seemed
to be last updated in May 2013.   Is there any possibility this can be
updated or enhanced?  Just trying to debug the Windows build to get a
passing R CMD check.

Best,
John

	[[alternative HTML version deleted]]


From hugopedder @end|ng |rom gm@||@com  Fri Jul 12 20:27:10 2019
From: hugopedder @end|ng |rom gm@||@com (Hugo Pedder)
Date: Fri, 12 Jul 2019 19:27:10 +0100
Subject: [R-pkg-devel] Non-standard `NUL` file/directory in check directory
Message-ID: <CAKcJ18Pv9XQM96vmjJhPW2G-+7mutZZ6mruJBOvK8OkEdUv=MQ@mail.gmail.com>

When I have submitted my package to CRAN the auto-check service is showing
a NOTE on the debian build during the "Check: for non-standard things in
the check directory":

Found the following files/directories:
`NUL`

This doesn't happen when I use rhub::check_on_debain(). I'm not sure how to
fix this - I can't find any files/directories in the package root directory
(or anywhere else in the package) that aren't either standard, or included
in .Rbuildignore.

Any suggestions would be massively appreciated!

Hugo

Email: hugopedder at gmail.com

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jul 13 00:04:19 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 12 Jul 2019 18:04:19 -0400
Subject: [R-pkg-devel] 
 Non-standard `NUL` file/directory in check directory
In-Reply-To: <CAKcJ18Pv9XQM96vmjJhPW2G-+7mutZZ6mruJBOvK8OkEdUv=MQ@mail.gmail.com>
References: <CAKcJ18Pv9XQM96vmjJhPW2G-+7mutZZ6mruJBOvK8OkEdUv=MQ@mail.gmail.com>
Message-ID: <807a4629-f156-59b1-810f-727ac843b60e@gmail.com>

On 12/07/2019 2:27 p.m., Hugo Pedder wrote:
> When I have submitted my package to CRAN the auto-check service is showing
> a NOTE on the debian build during the "Check: for non-standard things in
> the check directory":
> 
> Found the following files/directories:
> `NUL`
> 
> This doesn't happen when I use rhub::check_on_debain(). I'm not sure how to
> fix this - I can't find any files/directories in the package root directory
> (or anywhere else in the package) that aren't either standard, or included
> in .Rbuildignore.
> 
> Any suggestions would be massively appreciated!

Do you have one called NUL, or something close (e.g. NUL.txt)?  That's a 
special name on Windows, so it's not allowed on any R package, even 
though most OS's don't treat it specially.

Duncan Murdoch


From r@turner @end|ng |rom @uck|@nd@@c@nz  Sat Jul 13 03:43:04 2019
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Sat, 13 Jul 2019 13:43:04 +1200
Subject: [R-pkg-devel] Add space between columns in \tabular{} in Rd files.
Message-ID: <dc5e1d52-5fb7-e5f4-312b-2c4e62d7db38@auckland.ac.nz>


This is fussing over a very minor issue, but ... well, I have OCD, I guess.

I've tried adding extra "blank" columns between my real columns (extra 
\tab's with blank fields) but these have no effect.  The blanks are 
simply suppressed.  There does not seem to be (perhaps I'm overlooking 
something) any equivalent in the Rd syntax of \hspace{} in LaTeX.

Can anyone suggest any possibilities?

Thanks.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jul 13 11:38:26 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 13 Jul 2019 05:38:26 -0400
Subject: [R-pkg-devel] 
 Add space between columns in \tabular{} in Rd files.
In-Reply-To: <dc5e1d52-5fb7-e5f4-312b-2c4e62d7db38@auckland.ac.nz>
References: <dc5e1d52-5fb7-e5f4-312b-2c4e62d7db38@auckland.ac.nz>
Message-ID: <13393c89-69f3-ccf8-459b-19a98272aa42@gmail.com>

On 12/07/2019 9:43 p.m., Rolf Turner wrote:
> 
> This is fussing over a very minor issue, but ... well, I have OCD, I guess.
> 
> I've tried adding extra "blank" columns between my real columns (extra
> \tab's with blank fields) but these have no effect.  The blanks are
> simply suppressed.  There does not seem to be (perhaps I'm overlooking
> something) any equivalent in the Rd syntax of \hspace{} in LaTeX.
> 
> Can anyone suggest any possibilities?

You can include raw HTML or Latex in the Rd file using the \out{} macro. 
  See the example in section 2.11 of Writing R Extensions.

In HTML there are a lot of "entities" for different size spaces, e.g. 
"&nbsp;", "&emsp;", etc.  You can use "\hspace{}" in LaTeX.

Duncan Murdoch


From berryboe@@enkoo| @end|ng |rom hotm@||@com  Sat Jul 13 19:03:06 2019
From: berryboe@@enkoo| @end|ng |rom hotm@||@com (Berry Boessenkool)
Date: Sat, 13 Jul 2019 17:03:06 +0000
Subject: [R-pkg-devel] Rtools path space
Message-ID: <AM0PR06MB40685950C710B20C70FCEA09D5F30@AM0PR06MB4068.eurprd06.prod.outlook.com>


Hi,

I recently included native code to my package rdwd and have since been getting messages of Windows users not being able to install the source version.
As far as I can tell, the problem is that their Rtools is installed in a path with a space. i.e C:/Program Files.

* installing *source* package 'rdwd'
[...]
C:/Program Files/R/Rtools/mingw_32/bin/gfortran    -O3  -mtune=generic -c  binary_to_num.f90 -o binary_to_num.o
make: C:/Program: Command not found

Is my diagnosis correct?
If yes:
Should I just continue to tell users to install Rtools directly at C:/Rtools?
Would it help for install to use shQuote on the Rtools paths?
Should Rtools warn when being installed in "Program Files"?
Rhetorical question @Microsoft: what were you thinking?

Regards,
Berry


	[[alternative HTML version deleted]]


From m@rce||no@de|@cruz @end|ng |rom urjc@e@  Sat Jul 13 23:32:48 2019
From: m@rce||no@de|@cruz @end|ng |rom urjc@e@ (Marcelino De La Cruz Rot)
Date: Sat, 13 Jul 2019 21:32:48 +0000
Subject: [R-pkg-devel] Rtools path space
In-Reply-To: <AM0PR06MB40685950C710B20C70FCEA09D5F30@AM0PR06MB4068.eurprd06.prod.outlook.com>
References: <AM0PR06MB40685950C710B20C70FCEA09D5F30@AM0PR06MB4068.eurprd06.prod.outlook.com>
Message-ID: <88e85bdf-cf9f-ef61-2b58-cd2ca62bb512@urjc.es>

Hi,
I think your diagnosis is correct.

As suggested in 
https://cran.r-project.org/bin/windows/Rtools/Rtools.txt, a convenient 
place for R tools is

c:\Rtools

Regards,

Marcelino




El 13/07/2019 a las 19:03, Berry Boessenkool escribi?:
> Hi,
>
> I recently included native code to my package rdwd and have since been getting messages of Windows users not being able to install the source version.
> As far as I can tell, the problem is that their Rtools is installed in a path with a space. i.e C:/Program Files.
>
> * installing *source* package 'rdwd'
> [...]
> C:/Program Files/R/Rtools/mingw_32/bin/gfortran    -O3  -mtune=generic -c  binary_to_num.f90 -o binary_to_num.o
> make: C:/Program: Command not found
>
> Is my diagnosis correct?
> If yes:
> Should I just continue to tell users to install Rtools directly at C:/Rtools?
> Would it help for install to use shQuote on the Rtools paths?
> Should Rtools warn when being installed in "Program Files"?
> Rhetorical question @Microsoft: what were you thinking?
>
> Regards,
> Berry
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> .
>

-- 
Marcelino de la Cruz Rot
Depto. de Biolog?a y Geolog?a
F?sica y Qu?mica Inorg?nica
Universidad Rey Juan Carlos
M?stoles Espa?a


From r@turner @end|ng |rom @uck|@nd@@c@nz  Sun Jul 14 03:13:19 2019
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Sun, 14 Jul 2019 13:13:19 +1200
Subject: [R-pkg-devel] 
 Add space between columns in \tabular{} in Rd files.
In-Reply-To: <13393c89-69f3-ccf8-459b-19a98272aa42@gmail.com>
References: <dc5e1d52-5fb7-e5f4-312b-2c4e62d7db38@auckland.ac.nz>
 <13393c89-69f3-ccf8-459b-19a98272aa42@gmail.com>
Message-ID: <6958960e-952a-53b1-1a70-69d4b36b4160@auckland.ac.nz>


On 13/07/19 9:38 PM, Duncan Murdoch wrote:

> On 12/07/2019 9:43 p.m., Rolf Turner wrote:
>>
>> This is fussing over a very minor issue, but ... well, I have OCD, I 
>> guess.
>>
>> I've tried adding extra "blank" columns between my real columns (extra
>> \tab's with blank fields) but these have no effect.? The blanks are
>> simply suppressed.? There does not seem to be (perhaps I'm overlooking
>> something) any equivalent in the Rd syntax of \hspace{} in LaTeX.
>>
>> Can anyone suggest any possibilities?
> 
> You can include raw HTML or Latex in the Rd file using the \out{} macro. 
>  ?See the example in section 2.11 of Writing R Extensions.
> 
> In HTML there are a lot of "entities" for different size spaces, e.g. 
> "&nbsp;", "&emsp;", etc.? You can use "\hspace{}" in LaTeX.
Thank you Duncan!!!  Worked like a charm!

For the possible benefit (???) of others (Duncan knows all this I'm sure):

Since I had to put in a lot of such spaces I defined a macro "\ics" 
("inter column space") and used the syntax:

\tabular{lrllrllr}{
\code{nm1):  \tab \code{n1} \tab \ics \tab \code{nm2}: \tab \code{n2}
              \tab \ics \tab \code{nm3}: \tab \code{n3}\cr
\code{nm4}:  \tab \code{n4} \tab \ics \tab \code{nm5}: \tab \code{n5}
....................
....................
}

I defined the macro "\ics" in ..../man/macros/defns.Rd via:

\newcommand{\icsl}{\out{\hspace*{1em}}}
\newcommand{\icsh}{\out{<a>&emsp; &emsp;</a>}}
\newcommand{\ics}{\ifelse{latex}{\icsl}{\ifelse{html}{\icsh}{ }}}

Took me forever (I being a Bear of Very Little Brain) to get a workable 
syntax, but I finally managed it, and the end result looks fine in both
*.pdf and *.html.  (the pdf seems to need just one em-space whereas the
html needs two.)

Thanks again Duncan.

cheers,

Rolf

--
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From r@turner @end|ng |rom @uck|@nd@@c@nz  Mon Jul 15 01:52:24 2019
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Mon, 15 Jul 2019 11:52:24 +1200
Subject: [R-pkg-devel] Warning about "serialize/load".
Message-ID: <8abae91d-e714-d934-3df6-f29a51191364@auckland.ac.nz>


In a package (say "clyde") that I am building I save a number of 
datasets in clyde/data via something like:

save(melvin,file="~/<whatever>/clyde/data/melvin.rda")

When I build "clyde" I now get warnings like unto:

> WARNING: Added dependency on R >= 3.5.0 because serialized objects in
> serialize/load version 3 cannot be read in older versions of R.
> File(s) containing such objects: 'clyde/data/melvin.rda'

If I put the argument "version=2" into my save() call, the warnings go away.

What are the implications of this?

What are the consequences/what is the downside of setting version=2?

What are the consequences/what is the downside of adding the dependency 
on R >= 3.5.0 into my DESCRIPTION file?

Who gets shafted by each of these two possibilities?

Which is recommended?

Grateful for any pearls of wisdom.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From tr@ver@c @end|ng |rom gm@||@com  Mon Jul 15 02:06:58 2019
From: tr@ver@c @end|ng |rom gm@||@com (Travers Ching)
Date: Sun, 14 Jul 2019 17:06:58 -0700
Subject: [R-pkg-devel] Warning about "serialize/load".
In-Reply-To: <8abae91d-e714-d934-3df6-f29a51191364@auckland.ac.nz>
References: <8abae91d-e714-d934-3df6-f29a51191364@auckland.ac.nz>
Message-ID: <CAPLMX9FRQkE0qRjPKYqfmg_mgkA5kiO1Yks4DY3xVN-Jn5PAaA@mail.gmail.com>

I think the major change was saving of alt-rep objects efficiently.
Example save(1:1e8, file=...) is very efficient.

I'm not sure if that is all that changed it, but I couldn't find
documentation on the differences.

For maximum compatibility in a package, personally I would use version 2.


On Sun, Jul 14, 2019 at 4:52 PM Rolf Turner <r.turner at auckland.ac.nz> wrote:

>
> In a package (say "clyde") that I am building I save a number of
> datasets in clyde/data via something like:
>
> save(melvin,file="~/<whatever>/clyde/data/melvin.rda")
>
> When I build "clyde" I now get warnings like unto:
>
> > WARNING: Added dependency on R >= 3.5.0 because serialized objects in
> > serialize/load version 3 cannot be read in older versions of R.
> > File(s) containing such objects: 'clyde/data/melvin.rda'
>
> If I put the argument "version=2" into my save() call, the warnings go
> away.
>
> What are the implications of this?
>
> What are the consequences/what is the downside of setting version=2?
>
> What are the consequences/what is the downside of adding the dependency
> on R >= 3.5.0 into my DESCRIPTION file?
>
> Who gets shafted by each of these two possibilities?
>
> Which is recommended?
>
> Grateful for any pearls of wisdom.
>
> cheers,
>
> Rolf Turner
>
> --
> Honorary Research Fellow
> Department of Statistics
> University of Auckland
> Phone: +64-9-373-7599 ext. 88276
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Jul 15 02:19:48 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 14 Jul 2019 20:19:48 -0400
Subject: [R-pkg-devel] Warning about "serialize/load".
In-Reply-To: <8abae91d-e714-d934-3df6-f29a51191364@auckland.ac.nz>
References: <8abae91d-e714-d934-3df6-f29a51191364@auckland.ac.nz>
Message-ID: <21c0b6f4-969c-c226-0948-46bf2b104f1b@gmail.com>

On 14/07/2019 7:52 p.m., Rolf Turner wrote:
> 
> In a package (say "clyde") that I am building I save a number of
> datasets in clyde/data via something like:
> 
> save(melvin,file="~/<whatever>/clyde/data/melvin.rda")
> 
> When I build "clyde" I now get warnings like unto:
> 
>> WARNING: Added dependency on R >= 3.5.0 because serialized objects in
>> serialize/load version 3 cannot be read in older versions of R.
>> File(s) containing such objects: 'clyde/data/melvin.rda'
> 
> If I put the argument "version=2" into my save() call, the warnings go away.
> 
> What are the implications of this?
> 
> What are the consequences/what is the downside of setting version=2?
> 
> What are the consequences/what is the downside of adding the dependency
> on R >= 3.5.0 into my DESCRIPTION file?

The main consequence of setting the R version is that nobody using an 
older version could use your package.

I'd suggest this is a good thing, unless you plan to test your package 
with those old versions.  People should be nudged to upgrade. However, 
some people are stuck on old versions, and they really would miss out on 
clyde.

I think Travers pointed out the main consequence of forcing version=2: 
some things that are very compact in the next version might take a lot 
more space in version=2, e.g. x <- 1:1000000.

Duncan Murdoch

> 
> Who gets shafted by each of these two possibilities?
> 
> Which is recommended?
> 
> Grateful for any pearls of wisdom.
> 
> cheers,
> 
> Rolf Turner
>


From r@turner @end|ng |rom @uck|@nd@@c@nz  Mon Jul 15 02:16:12 2019
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Mon, 15 Jul 2019 12:16:12 +1200
Subject: [R-pkg-devel] Warning about "serialize/load".
In-Reply-To: <CAPLMX9FRQkE0qRjPKYqfmg_mgkA5kiO1Yks4DY3xVN-Jn5PAaA@mail.gmail.com>
References: <8abae91d-e714-d934-3df6-f29a51191364@auckland.ac.nz>
 <CAPLMX9FRQkE0qRjPKYqfmg_mgkA5kiO1Yks4DY3xVN-Jn5PAaA@mail.gmail.com>
Message-ID: <4dd1caac-bd62-a2fd-0c54-fe79bad38dfd@auckland.ac.nz>


On 15/07/19 12:06 PM, Travers Ching wrote:

> I think the major change was saving of alt-rep objects efficiently.  
> Example save(1:1e8, file=...) is very efficient.
> 
> I'm not sure if that is all that changed it, but I couldn't find 
> documentation on the differences.
> 
> For maximum compatibility in a package, personally I would use version 2.

That's my gut reaction as well.  Thanks for the advice.

cheers,

Rolf

> 
> 
> On Sun, Jul 14, 2019 at 4:52 PM Rolf Turner <r.turner at auckland.ac.nz 
> <mailto:r.turner at auckland.ac.nz>> wrote:
> 
> 
>     In a package (say "clyde") that I am building I save a number of
>     datasets in clyde/data via something like:
> 
>     save(melvin,file="~/<whatever>/clyde/data/melvin.rda")
> 
>     When I build "clyde" I now get warnings like unto:
> 
>      > WARNING: Added dependency on R >= 3.5.0 because serialized objects in
>      > serialize/load version 3 cannot be read in older versions of R.
>      > File(s) containing such objects: 'clyde/data/melvin.rda'
> 
>     If I put the argument "version=2" into my save() call, the warnings
>     go away.
> 
>     What are the implications of this?
> 
>     What are the consequences/what is the downside of setting version=2?
> 
>     What are the consequences/what is the downside of adding the dependency
>     on R >= 3.5.0 into my DESCRIPTION file?
> 
>     Who gets shafted by each of these two possibilities?
> 
>     Which is recommended?
> 
>     Grateful for any pearls of wisdom.
> 
>     cheers,
> 
>     Rolf Turner


From r@turner @end|ng |rom @uck|@nd@@c@nz  Mon Jul 15 02:40:38 2019
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Mon, 15 Jul 2019 12:40:38 +1200
Subject: [R-pkg-devel] Warning about "serialize/load".
In-Reply-To: <21c0b6f4-969c-c226-0948-46bf2b104f1b@gmail.com>
References: <8abae91d-e714-d934-3df6-f29a51191364@auckland.ac.nz>
 <21c0b6f4-969c-c226-0948-46bf2b104f1b@gmail.com>
Message-ID: <3cfdc485-3c05-45e8-93e1-1524189d6d7c@auckland.ac.nz>


On 15/07/19 12:19 PM, Duncan Murdoch wrote:

> On 14/07/2019 7:52 p.m., Rolf Turner wrote:
>>
>> In a package (say "clyde") that I am building I save a number of
>> datasets in clyde/data via something like:
>>
>> save(melvin,file="~/<whatever>/clyde/data/melvin.rda")
>>
>> When I build "clyde" I now get warnings like unto:
>>
>>> WARNING: Added dependency on R >= 3.5.0 because serialized objects in
>>> serialize/load version 3 cannot be read in older versions of R.
>>> File(s) containing such objects: 'clyde/data/melvin.rda'
>>
>> If I put the argument "version=2" into my save() call, the warnings go 
>> away.
>>
>> What are the implications of this?
>>
>> What are the consequences/what is the downside of setting version=2?
>>
>> What are the consequences/what is the downside of adding the dependency
>> on R >= 3.5.0 into my DESCRIPTION file?
> 
> The main consequence of setting the R version is that nobody using an 
> older version could use your package.
> 
> I'd suggest this is a good thing, unless you plan to test your package 
> with those old versions.? People should be nudged to upgrade. 

Indeed.  I agree.

> However, some people are stuck on old versions, and they really would miss
> out on clyde.

And I'd hate that!!! :-)

> I think Travers pointed out the main consequence of forcing version=2: 
> some things that are very compact in the next version might take a lot 
> more space in version=2, e.g. x <- 1:1000000.

I don't think that space is a major issue.  I managed to tot up the
total size of the data sets, using object.size() and I get 1219824 
bytes, i.e. about one and a quarter megabytes.  I don't think that's a 
worry, so I think I'll stick with version=2.

Thanks Duncan.

cheers,

Rolf

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From edd @end|ng |rom deb|@n@org  Mon Jul 15 02:43:37 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sun, 14 Jul 2019 19:43:37 -0500
Subject: [R-pkg-devel] Warning about "serialize/load".
In-Reply-To: <CAPLMX9FRQkE0qRjPKYqfmg_mgkA5kiO1Yks4DY3xVN-Jn5PAaA@mail.gmail.com>
References: <8abae91d-e714-d934-3df6-f29a51191364@auckland.ac.nz>
 <CAPLMX9FRQkE0qRjPKYqfmg_mgkA5kiO1Yks4DY3xVN-Jn5PAaA@mail.gmail.com>
Message-ID: <23851.52281.445774.746620@rob.eddelbuettel.com>


On 14 July 2019 at 17:06, Travers Ching wrote:
| For maximum compatibility in a package, personally I would use version 2.

Why are you against the futures and all the new shiny things?  ;-)

Duncan put it well in his follow-up message. We might as well use this as a
nudge towards upgrading to current versions.

But if one really felt that one had to, one could always branch and provide
both old and new rds versions.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From tr@ver@c @end|ng |rom gm@||@com  Mon Jul 15 04:33:38 2019
From: tr@ver@c @end|ng |rom gm@||@com (Travers Ching)
Date: Sun, 14 Jul 2019 19:33:38 -0700
Subject: [R-pkg-devel] Warning about "serialize/load".
In-Reply-To: <23851.52281.445774.746620@rob.eddelbuettel.com>
References: <8abae91d-e714-d934-3df6-f29a51191364@auckland.ac.nz>
 <CAPLMX9FRQkE0qRjPKYqfmg_mgkA5kiO1Yks4DY3xVN-Jn5PAaA@mail.gmail.com>
 <23851.52281.445774.746620@rob.eddelbuettel.com>
Message-ID: <CAPLMX9GkcXcH1raaOfQRhoA5SKFpt4e=U0-yxjN3tANn9Q-ghg@mail.gmail.com>

>  Why are you against the futures and all the new shiny things?  ;-)

Sometimes one does not have control over these things, still using R 3.2 on
some systems!  ;o

On Sun, Jul 14, 2019 at 5:43 PM Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 14 July 2019 at 17:06, Travers Ching wrote:
> | For maximum compatibility in a package, personally I would use version 2.
>
> Why are you against the futures and all the new shiny things?  ;-)
>
> Duncan put it well in his follow-up message. We might as well use this as a
> nudge towards upgrading to current versions.
>
> But if one really felt that one had to, one could always branch and provide
> both old and new rds versions.
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Mon Jul 15 09:23:46 2019
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Mon, 15 Jul 2019 09:23:46 +0200
Subject: [R-pkg-devel] Warning about "serialize/load".
In-Reply-To: <CAPLMX9FRQkE0qRjPKYqfmg_mgkA5kiO1Yks4DY3xVN-Jn5PAaA@mail.gmail.com>
References: <8abae91d-e714-d934-3df6-f29a51191364@auckland.ac.nz>
 <CAPLMX9FRQkE0qRjPKYqfmg_mgkA5kiO1Yks4DY3xVN-Jn5PAaA@mail.gmail.com>
Message-ID: <446831bc-0dc6-803f-ca14-f209cbb6cd09@gmail.com>

On 7/15/19 2:06 AM, Travers Ching wrote:
> I think the major change was saving of alt-rep objects efficiently.
> Example save(1:1e8, file=...) is very efficient.
>
> I'm not sure if that is all that changed it, but I couldn't find
> documentation on the differences.

Yes, format version 3 provides custom serialization for altrep objects, 
so that it can e.g. serialize efficiently integer sequences. In 
addition, it keeps record of the current native encoding when 
serializing strings, so that it can convert strings with unflagged 
encoding when de-serializing them with different native encoding. So for 
example if a string with current native encoding X (not being latin1, 
and indeed not UTF-8) on Windows gets serialized, and then de-serialized 
on Linux running UTF-8 as current native encoding, it would be converted 
to UTF-8. In previous versions, it would be misinterpreted.

Best
Tomas

>
> For maximum compatibility in a package, personally I would use version 2.
>
>
> On Sun, Jul 14, 2019 at 4:52 PM Rolf Turner <r.turner at auckland.ac.nz> wrote:
>
>> In a package (say "clyde") that I am building I save a number of
>> datasets in clyde/data via something like:
>>
>> save(melvin,file="~/<whatever>/clyde/data/melvin.rda")
>>
>> When I build "clyde" I now get warnings like unto:
>>
>>> uWARNING: Added dependency on R >= 3.5.0 because serialized objects in
>>> serialize/load version 3 cannot be read in older versions of R.
>>> File(s) containing such objects: 'clyde/data/melvin.rda'
>> If I put the argument "version=2" into my save() call, the warnings go
>> away.
>>
>> What are the implications of this?
>>
>> What are the consequences/what is the downside of setting version=2?
>>
>> What are the consequences/what is the downside of adding the dependency
>> on R >= 3.5.0 into my DESCRIPTION file?
>>
>> Who gets shafted by each of these two possibilities?
>>
>> Which is recommended?
>>
>> Grateful for any pearls of wisdom.
>>
>> cheers,
>>
>> Rolf Turner
>>
>> --
>> Honorary Research Fellow
>> Department of Statistics
>> University of Auckland
>> Phone: +64-9-373-7599 ext. 88276
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ron@n@gr|ot @end|ng |rom gm@||@com  Mon Jul 15 09:39:46 2019
From: ron@n@gr|ot @end|ng |rom gm@||@com (Ronan GRIOT)
Date: Mon, 15 Jul 2019 09:39:46 +0200
Subject: [R-pkg-devel] Fwd: package submission: parallel problem
In-Reply-To: <CAE1CRYJ3TG6eskKZND-w2Vc0UrF-8itf1JNt1sQeck5Z8N0JzQ@mail.gmail.com>
References: <CAE1CRYJ3TG6eskKZND-w2Vc0UrF-8itf1JNt1sQeck5Z8N0JzQ@mail.gmail.com>
Message-ID: <CAE1CRYJBB+5iMwmm91nMoQc7WiXzD_enttOHBG=5+2=M4YthvA@mail.gmail.com>

Dear R developpers,
I submitted a package involving some parallel functions.

I received this error message:

Error in .check_ncores(length(names)) : 30 simultaneous processes spawned

I read that CRAN only pass the test if 2 cores are used.
However, in my function, I use this command line:

parallel::makeCluster(parallel::detectCores() - 2)

I try to fit the power of each computer by allowing all the cores except 2
(to keep other software running).

My question is: What I have to do? Limiting the number of cores at 2 to
pass the CRAN requirements? Or let "detectCores() - 2" to allow for more
cores for multi-cores computer but add a restriction to pass the tests?

Best regards.

	[[alternative HTML version deleted]]


From |uc@r @end|ng |rom |edor@project@org  Mon Jul 15 12:47:04 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Mon, 15 Jul 2019 12:47:04 +0200
Subject: [R-pkg-devel] Fwd: package submission: parallel problem
In-Reply-To: <CAE1CRYJBB+5iMwmm91nMoQc7WiXzD_enttOHBG=5+2=M4YthvA@mail.gmail.com>
References: <CAE1CRYJ3TG6eskKZND-w2Vc0UrF-8itf1JNt1sQeck5Z8N0JzQ@mail.gmail.com>
 <CAE1CRYJBB+5iMwmm91nMoQc7WiXzD_enttOHBG=5+2=M4YthvA@mail.gmail.com>
Message-ID: <CALEXWq30M978bxJceTx4pPfJ497k9pTxRpjWwkntUXNQMF7MpQ@mail.gmail.com>

On Mon, 15 Jul 2019 at 12:24, Ronan GRIOT <ronan.griot at gmail.com> wrote:
>
> Dear R developpers,
> I submitted a package involving some parallel functions.
>
> I received this error message:
>
> Error in .check_ncores(length(names)) : 30 simultaneous processes spawned
>
> I read that CRAN only pass the test if 2 cores are used.
> However, in my function, I use this command line:
>
> parallel::makeCluster(parallel::detectCores() - 2)
>
> I try to fit the power of each computer by allowing all the cores except 2
> (to keep other software running).
>
> My question is: What I have to do? Limiting the number of cores at 2 to
> pass the CRAN requirements? Or let "detectCores() - 2" to allow for more
> cores for multi-cores computer but add a restriction to pass the tests?

By *default*, the number of cores should be 2 at most, as you said.
But this doesn't mean that you cannot allow the user to change that
option to increase them.

See, e.g., what parallel::makeForkCluster does:

function (nnodes = getOption("mc.cores", 2L), ...)

I?aki


From ron@n@gr|ot @end|ng |rom gm@||@com  Fri Jul 19 13:33:10 2019
From: ron@n@gr|ot @end|ng |rom gm@||@com (Ronan GRIOT)
Date: Fri, 19 Jul 2019 13:33:10 +0200
Subject: [R-pkg-devel] Uses the superseded package: 'doSNOW'
Message-ID: <CAE1CRYJozXR6VbjanDKPru3Rj6eO4ZzHdkjEazGFCOEFanTSXw@mail.gmail.com>

Dear R-developpers,

I submitted my package and received this NOTE :

*Uses the superseded package: 'doSNOW'*

I found that this package is now "replaced" by the doParallel package.
However, I use the foreach option *.option.snow *to see the progress of my
parallel loop.

here is the code :









*doSNOW::registerDoSNOW(cl)  pb.recodeOff <- txtProgressBar(min = 0, max =
iterations, char = '><> ', style = 3)  progress <- function(n)
{setTxtProgressBar(pb.recodeOff, n)}  opts <- list(progress = progress)
recode.off <- foreach(i = 1:iterations, .combine = rbind, .options.snow =
opts) %dopar% {    tmp <- as.numeric(as.vector(sapply(offspring[i,, drop =
F], recodeFortran, list.mrk = variant.corres)))  }*

I tried several ways to modify my function but nothing worked...

I wonder if I have to completley remove the progress bars I made to pass
the checks or if there is a option I do no know.

best regards,
Ronan GRIOT, phD student

	[[alternative HTML version deleted]]


From roy@mende|@@ohn @end|ng |rom no@@@gov  Wed Jul 24 02:26:55 2019
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Tue, 23 Jul 2019 17:26:55 -0700
Subject: [R-pkg-devel] Note on winbuilder-develop
Message-ID: <DA2BDABB-8789-4746-87BE-99BBB207A024@noaa.gov>

Hi All:

I am in the process of testing in order to submit a new version of a package to CRAN,  and I am getting clean results on everything but winbuilder_develop.  There I am getting 1 Note:

> Found the following \keyword or \concept entries with Rd markup:
>   File 'checkBounds.Rd':
>     \keyword{\code{checkBounds}}
>   File 'getfileCoords.Rd':
>     \keyword{\code{getFileCoords}}
>   File 'make180.Rd':
>     \keyword{\code{make180}}
>   File 'make360.Rd':
>     \keyword{\code{make360}}
> Found the following \keyword or \concept entries
> which likely give several index terms:
>   File 'checkBounds.Rd':
>     \keyword{latitude,}
>     \keyword{longitude,}
>   File 'make180.Rd':
>     \keyword{(-180,180)}
>     \keyword{(0,360)}
>   File 'make360.Rd':
>     \keyword{(-180,180)}
>     \keyword{(0,360)}
> 

I am not clear what this is calling for me to do, particularly since I doubt (-180, 180) or (0, 360) are keywords.  

Guidance appreciated.

-Roy


**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Jul 24 03:02:44 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 23 Jul 2019 21:02:44 -0400
Subject: [R-pkg-devel] Note on winbuilder-develop
In-Reply-To: <DA2BDABB-8789-4746-87BE-99BBB207A024@noaa.gov>
References: <DA2BDABB-8789-4746-87BE-99BBB207A024@noaa.gov>
Message-ID: <01cb2544-6217-9ab4-b882-5d37742a93ef@gmail.com>

On 23/07/2019 8:26 p.m., Roy Mendelssohn - NOAA Federal via 
R-package-devel wrote:
> Hi All:
> 
> I am in the process of testing in order to submit a new version of a package to CRAN,  and I am getting clean results on everything but winbuilder_develop.  There I am getting 1 Note:
> 
>> Found the following \keyword or \concept entries with Rd markup:
>>    File 'checkBounds.Rd':
>>      \keyword{\code{checkBounds}}
>>    File 'getfileCoords.Rd':
>>      \keyword{\code{getFileCoords}}
>>    File 'make180.Rd':
>>      \keyword{\code{make180}}
>>    File 'make360.Rd':
>>      \keyword{\code{make360}}
>> Found the following \keyword or \concept entries
>> which likely give several index terms:
>>    File 'checkBounds.Rd':
>>      \keyword{latitude,}
>>      \keyword{longitude,}
>>    File 'make180.Rd':
>>      \keyword{(-180,180)}
>>      \keyword{(0,360)}
>>    File 'make360.Rd':
>>      \keyword{(-180,180)}
>>      \keyword{(0,360)}
>>
> 
> I am not clear what this is calling for me to do, particularly since I doubt (-180, 180) or (0, 360) are keywords.
> 
> Guidance appreciated.

Can't you just look at those files (i.e. .../man/checkBounds.Rd, etc.) 
to see whether or not those declarations are contained in them?  If not, 
then there's clearly something weird happening at winbuilder_develop.

Duncan Murdoch


From roy@mende|@@ohn @end|ng |rom no@@@gov  Wed Jul 24 03:44:24 2019
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Tue, 23 Jul 2019 18:44:24 -0700
Subject: [R-pkg-devel] Note on winbuilder-develop
In-Reply-To: <01cb2544-6217-9ab4-b882-5d37742a93ef@gmail.com>
References: <DA2BDABB-8789-4746-87BE-99BBB207A024@noaa.gov>
 <01cb2544-6217-9ab4-b882-5d37742a93ef@gmail.com>
Message-ID: <F2065F18-7452-42EF-B5F3-04A72E4D39A3@noaa.gov>

Thanks,  I was looking at the raw files,  not the .Rd files.  There are \keyword arguments in those file,  will have to search to see why they are getting generated.

-Roy


> On Jul 23, 2019, at 6:02 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 23/07/2019 8:26 p.m., Roy Mendelssohn - NOAA Federal via R-package-devel wrote:
>> Hi All:
>> I am in the process of testing in order to submit a new version of a package to CRAN,  and I am getting clean results on everything but winbuilder_develop.  There I am getting 1 Note:
>>> Found the following \keyword or \concept entries with Rd markup:
>>>   File 'checkBounds.Rd':
>>>     \keyword{\code{checkBounds}}
>>>   File 'getfileCoords.Rd':
>>>     \keyword{\code{getFileCoords}}
>>>   File 'make180.Rd':
>>>     \keyword{\code{make180}}
>>>   File 'make360.Rd':
>>>     \keyword{\code{make360}}
>>> Found the following \keyword or \concept entries
>>> which likely give several index terms:
>>>   File 'checkBounds.Rd':
>>>     \keyword{latitude,}
>>>     \keyword{longitude,}
>>>   File 'make180.Rd':
>>>     \keyword{(-180,180)}
>>>     \keyword{(0,360)}
>>>   File 'make360.Rd':
>>>     \keyword{(-180,180)}
>>>     \keyword{(0,360)}
>>> 
>> I am not clear what this is calling for me to do, particularly since I doubt (-180, 180) or (0, 360) are keywords.
>> Guidance appreciated.
> 
> Can't you just look at those files (i.e. .../man/checkBounds.Rd, etc.) to see whether or not those declarations are contained in them?  If not, then there's clearly something weird happening at winbuilder_develop.
> 
> Duncan Murdoch

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Wed Jul 24 09:08:46 2019
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Wed, 24 Jul 2019 09:08:46 +0200
Subject: [R-pkg-devel] Note on winbuilder-develop
In-Reply-To: <F2065F18-7452-42EF-B5F3-04A72E4D39A3@noaa.gov>
References: <DA2BDABB-8789-4746-87BE-99BBB207A024@noaa.gov>
 <01cb2544-6217-9ab4-b882-5d37742a93ef@gmail.com>
 <F2065F18-7452-42EF-B5F3-04A72E4D39A3@noaa.gov>
Message-ID: <23864.1022.975481.596420@stat.math.ethz.ch>

>>>>> Roy Mendelssohn 
>>>>>     on Tue, 23 Jul 2019 18:44:24 -0700 writes:

    > Thanks, I was looking at the raw files, not the .Rd files.
    > There are \keyword arguments in those file, will have to
    > search to see why they are getting generated.  -Roy

just to rub the obvious into everybody's face ;-) :-D
{ apology for any offence ! } :

If you'd use roxygen only initially and not anymore from then
on, but rather then would keep hand-editing nicely humanly
formatted  man/*.Rd  files, 
you would never see this (and quite a few "similar") problems.

Martin Maechler
ETH Zurich and  R Core


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Jul 24 12:12:35 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 24 Jul 2019 06:12:35 -0400
Subject: [R-pkg-devel] Note on winbuilder-develop
In-Reply-To: <23864.1022.975481.596420@stat.math.ethz.ch>
References: <DA2BDABB-8789-4746-87BE-99BBB207A024@noaa.gov>
 <01cb2544-6217-9ab4-b882-5d37742a93ef@gmail.com>
 <F2065F18-7452-42EF-B5F3-04A72E4D39A3@noaa.gov>
 <23864.1022.975481.596420@stat.math.ethz.ch>
Message-ID: <e7d352ad-4fa4-12f0-df1a-51a478920f0d@gmail.com>

On 24/07/2019 3:08 a.m., Martin Maechler wrote:
>>>>>> Roy Mendelssohn
>>>>>>      on Tue, 23 Jul 2019 18:44:24 -0700 writes:
> 
>      > Thanks, I was looking at the raw files, not the .Rd files.
>      > There are \keyword arguments in those file, will have to
>      > search to see why they are getting generated.  -Roy
> 
> just to rub the obvious into everybody's face ;-) :-D
> { apology for any offence ! } :
> 
> If you'd use roxygen only initially and not anymore from then
> on, but rather then would keep hand-editing nicely humanly
> formatted  man/*.Rd  files,
> you would never see this (and quite a few "similar") problems.

I don't think that's a great idea, unless the initial use is basically 
no more than using prompt().  If you have comments in your source that 
look like help text, and different help text in your Rd file, it's going 
to lead to confusion.  I don't think Roxygen is capable of updating your 
source file comments when you edit your Rd file.

Duncan Murdoch


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Wed Jul 24 12:54:25 2019
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Wed, 24 Jul 2019 12:54:25 +0200
Subject: [R-pkg-devel] Note on winbuilder-develop
In-Reply-To: <e7d352ad-4fa4-12f0-df1a-51a478920f0d@gmail.com>
References: <DA2BDABB-8789-4746-87BE-99BBB207A024@noaa.gov>
 <01cb2544-6217-9ab4-b882-5d37742a93ef@gmail.com>
 <F2065F18-7452-42EF-B5F3-04A72E4D39A3@noaa.gov>
 <23864.1022.975481.596420@stat.math.ethz.ch>
 <e7d352ad-4fa4-12f0-df1a-51a478920f0d@gmail.com>
Message-ID: <23864.14561.411634.568251@stat.math.ethz.ch>

>>>>> Duncan Murdoch 
>>>>>     on Wed, 24 Jul 2019 06:12:35 -0400 writes:

    > On 24/07/2019 3:08 a.m., Martin Maechler wrote:
    >>>>>>> Roy Mendelssohn
    >>>>>>> on Tue, 23 Jul 2019 18:44:24 -0700 writes:
    >> 
    >> > Thanks, I was looking at the raw files, not the .Rd files.
    >> > There are \keyword arguments in those file, will have to
    >> > search to see why they are getting generated.  -Roy
    >> 
    >> just to rub the obvious into everybody's face ;-) :-D
    >> { apology for any offence ! } :
    >> 
    >> If you'd use roxygen only initially and not anymore from then
    >> on, but rather then would keep hand-editing nicely humanly
    >> formatted  man/*.Rd  files,
    >> you would never see this (and quite a few "similar") problems.

    > I don't think that's a great idea, unless the initial use is basically 
    > no more than using prompt().  If you have comments in your source that 
    > look like help text, and different help text in your Rd file, it's going 
    > to lead to confusion.  I don't think Roxygen is capable of updating your 
    > source file comments when you edit your Rd file.

    > Duncan Murdoch

Ok,  now you're triggering me  ... probably I should have
refrained from that first e-mail  ...

What I *meant* and failed to say more explicitly:

I would use roxygen comments for functions I write
"somewhere", possibly outside a package and I do *not* export (yet?)
when inside a package.  Once I decide it should become an
exported function I use the roxygen stuff to create the very
first version of my help page *AND THEN* delete most of the
roxygen text comments (maybe leave 2 lines or so) and from then
on only use *.Rd files, which I keep nicely indented, and even *commented*
(is that possible at all inside roxygen?), add math
formula, add examples, enumeration lists, \describe{..} lists
etc in much more nicely readable form than wrapped inside the
"roxygen language"  and never go back to using Roxygen there.
The same with the nicely human-annotated and sorted  NAMESPACE
file.

As you know, R works from the NAMESPACE and man/*.Rd files
anyway, and so I don't add an extra translation layer .. and keep
*.Rd and NAMESPACE files that are both much nicer readable than
as part of roxygen comments blowing up the size of the *.R
source files.
By taking the *.Rd out of the source, I'm much less tempted to
keep the documentation minimal and almost unuseful, as I see it
in many packages built using Roxygen..

[... end of trigger]

Martin


From @|gbert @end|ng |rom w|w|@hu-ber||n@de  Wed Jul 24 11:30:07 2019
From: @|gbert @end|ng |rom w|w|@hu-ber||n@de (Sigbert Klinke)
Date: Wed, 24 Jul 2019 11:30:07 +0200
Subject: [R-pkg-devel] devtools::check() shows a warning at the beginning,
 but not at the end
Message-ID: <aa13fc05-21a5-7c01-d12c-4314f5344917@wiwi.hu-berlin.de>

Hi,

when I called check() on my package I got a warning at the beginning

Updating plot.matrix documentation
Warnung: roxygen2 requires Encoding: UTF-8
Warnung: @examples 
[/home/sigbert/syncthing/projekte/R/plot.matrix/R/as.cor.R#12]: 
mismatched braces or quotes

but at the end it says

?? R CMD check results ??? plot.matrix 1.3 ????
Duration: 10.8s

0 errors ? | 0 warnings ? | 0 notes ?

Is that okay? The warning actually was correct.

Thanks

Sigbert

-- 
https://hu.berlin/sk
https://hu.berlin/mmstat3


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Jul 24 13:56:12 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 24 Jul 2019 07:56:12 -0400
Subject: [R-pkg-devel] 
 devtools::check() shows a warning at the beginning,
 but not at the end
In-Reply-To: <aa13fc05-21a5-7c01-d12c-4314f5344917@wiwi.hu-berlin.de>
References: <aa13fc05-21a5-7c01-d12c-4314f5344917@wiwi.hu-berlin.de>
Message-ID: <2735a70d-461d-44dd-c597-a87f1eda924f@gmail.com>

On 24/07/2019 5:30 a.m., Sigbert Klinke wrote:
> Hi,
> 
> when I called check() on my package I got a warning at the beginning
> 
> Updating plot.matrix documentation
> Warnung: roxygen2 requires Encoding: UTF-8
> Warnung: @examples
> [/home/sigbert/syncthing/projekte/R/plot.matrix/R/as.cor.R#12]:
> mismatched braces or quotes
> 
> but at the end it says
> 
> ?? R CMD check results ??? plot.matrix 1.3 ????
> Duration: 10.8s
> 
> 0 errors ? | 0 warnings ? | 0 notes ?
> 
> Is that okay? The warning actually was correct.
> 

Looks like a bug in devtools.  It's probably looking for "Warning", and 
not recognizing the German translation.

Duncan Murdoch


From c@@rd|@g@bor @end|ng |rom gm@||@com  Wed Jul 24 14:00:12 2019
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Wed, 24 Jul 2019 13:00:12 +0100
Subject: [R-pkg-devel] 
 devtools::check() shows a warning at the beginning,
 but not at the end
In-Reply-To: <2735a70d-461d-44dd-c597-a87f1eda924f@gmail.com>
References: <aa13fc05-21a5-7c01-d12c-4314f5344917@wiwi.hu-berlin.de>
 <2735a70d-461d-44dd-c597-a87f1eda924f@gmail.com>
Message-ID: <CABtg=Kn9v-VxOC6Nq9AY9k27guWkA18tk-wjdjC7DtA6HgfLXg@mail.gmail.com>

Strictly speaking this is not a devtools bug, because the warning is
not coming from `R CMD check`, but from `devtools::document()`, which
rebuilds the documentation via roxygen2, before actually running `R
CMD check`.

Maybe `devtools::check()` should stop if `devtools::document()` throws
a warning.

Gabor

On Wed, Jul 24, 2019 at 12:56 PM Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
>
> On 24/07/2019 5:30 a.m., Sigbert Klinke wrote:
> > Hi,
> >
> > when I called check() on my package I got a warning at the beginning
> >
> > Updating plot.matrix documentation
> > Warnung: roxygen2 requires Encoding: UTF-8
> > Warnung: @examples
> > [/home/sigbert/syncthing/projekte/R/plot.matrix/R/as.cor.R#12]:
> > mismatched braces or quotes
> >
> > but at the end it says
> >
> > ?? R CMD check results ??? plot.matrix 1.3 ????
> > Duration: 10.8s
> >
> > 0 errors ? | 0 warnings ? | 0 notes ?
> >
> > Is that okay? The warning actually was correct.
> >
>
> Looks like a bug in devtools.  It's probably looking for "Warning", and
> not recognizing the German translation.
>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Jul 24 14:12:40 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 24 Jul 2019 08:12:40 -0400
Subject: [R-pkg-devel] Note on winbuilder-develop
In-Reply-To: <23864.14561.411634.568251@stat.math.ethz.ch>
References: <DA2BDABB-8789-4746-87BE-99BBB207A024@noaa.gov>
 <01cb2544-6217-9ab4-b882-5d37742a93ef@gmail.com>
 <F2065F18-7452-42EF-B5F3-04A72E4D39A3@noaa.gov>
 <23864.1022.975481.596420@stat.math.ethz.ch>
 <e7d352ad-4fa4-12f0-df1a-51a478920f0d@gmail.com>
 <23864.14561.411634.568251@stat.math.ethz.ch>
Message-ID: <4cb1d5b5-9986-6132-6591-a817123db742@gmail.com>

On 24/07/2019 6:54 a.m., Martin Maechler wrote:
>>>>>> Duncan Murdoch
>>>>>>      on Wed, 24 Jul 2019 06:12:35 -0400 writes:
> 
>      > On 24/07/2019 3:08 a.m., Martin Maechler wrote:
>      >>>>>>> Roy Mendelssohn
>      >>>>>>> on Tue, 23 Jul 2019 18:44:24 -0700 writes:
>      >>
>      >> > Thanks, I was looking at the raw files, not the .Rd files.
>      >> > There are \keyword arguments in those file, will have to
>      >> > search to see why they are getting generated.  -Roy
>      >>
>      >> just to rub the obvious into everybody's face ;-) :-D
>      >> { apology for any offence ! } :
>      >>
>      >> If you'd use roxygen only initially and not anymore from then
>      >> on, but rather then would keep hand-editing nicely humanly
>      >> formatted  man/*.Rd  files,
>      >> you would never see this (and quite a few "similar") problems.
> 
>      > I don't think that's a great idea, unless the initial use is basically
>      > no more than using prompt().  If you have comments in your source that
>      > look like help text, and different help text in your Rd file, it's going
>      > to lead to confusion.  I don't think Roxygen is capable of updating your
>      > source file comments when you edit your Rd file.
> 
>      > Duncan Murdoch
> 
> Ok,  now you're triggering me  ... probably I should have
> refrained from that first e-mail  ...
> 
> What I *meant* and failed to say more explicitly:
> 
> I would use roxygen comments for functions I write
> "somewhere", possibly outside a package and I do *not* export (yet?)
> when inside a package.  Once I decide it should become an
> exported function I use the roxygen stuff to create the very
> first version of my help page *AND THEN* delete most of the
> roxygen text comments (maybe leave 2 lines or so) and from then
> on only use *.Rd files, which I keep nicely indented, and even *commented*
> (is that possible at all inside roxygen?), add math
> formula, add examples, enumeration lists, \describe{..} lists
> etc in much more nicely readable form than wrapped inside the
> "roxygen language"  and never go back to using Roxygen there.
> The same with the nicely human-annotated and sorted  NAMESPACE
> file.
To me that seems like too much work.  If I'm writing something that 
needs user comments, I would probably put it in a package, and use 
prompt() to immediately start putting user documentation into an Rd 
file.  (There can also be programmer documentation that belongs in the 
.R file.)

The disadvantage of my approach is that it's a little clunky to handle 
changes to the function signatures.  There's a function Rdpack::reprompt 
that is supposed to update Rd files when the sources change; I should 
probably adopt it as part of my workflow, but I haven't done so.

> 
> As you know, R works from the NAMESPACE and man/*.Rd files
> anyway, and so I don't add an extra translation layer .. and keep
> *.Rd and NAMESPACE files that are both much nicer readable than
> as part of roxygen comments blowing up the size of the *.R
> source files.
> By taking the *.Rd out of the source, I'm much less tempted to
> keep the documentation minimal and almost unuseful, as I see it
> in many packages built using Roxygen..
> 

I agree with you about the value of writing Rd files, and the cost (e.g. 
incorrect Rd files with confusing error messages like Roy found) of 
relying on Roxygen.  But there are lots of people who disagree with us.

Duncan


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Jul 24 14:15:16 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 24 Jul 2019 08:15:16 -0400
Subject: [R-pkg-devel] 
 devtools::check() shows a warning at the beginning,
 but not at the end
In-Reply-To: <CABtg=Kn9v-VxOC6Nq9AY9k27guWkA18tk-wjdjC7DtA6HgfLXg@mail.gmail.com>
References: <aa13fc05-21a5-7c01-d12c-4314f5344917@wiwi.hu-berlin.de>
 <2735a70d-461d-44dd-c597-a87f1eda924f@gmail.com>
 <CABtg=Kn9v-VxOC6Nq9AY9k27guWkA18tk-wjdjC7DtA6HgfLXg@mail.gmail.com>
Message-ID: <9894dcd4-5059-da5e-1940-736b42edc5bf@gmail.com>

On 24/07/2019 8:00 a.m., G?bor Cs?rdi wrote:
> Strictly speaking this is not a devtools bug, because the warning is
> not coming from `R CMD check`, but from `devtools::document()`, which
> rebuilds the documentation via roxygen2, before actually running `R
> CMD check`.
> 
> Maybe `devtools::check()` should stop if `devtools::document()` throws
> a warning.

Or collect Roxygen issues and report on them at the end along with the R 
CMD check issues.

Duncan Murdoch

> 
> Gabor
> 
> On Wed, Jul 24, 2019 at 12:56 PM Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
>>
>> On 24/07/2019 5:30 a.m., Sigbert Klinke wrote:
>>> Hi,
>>>
>>> when I called check() on my package I got a warning at the beginning
>>>
>>> Updating plot.matrix documentation
>>> Warnung: roxygen2 requires Encoding: UTF-8
>>> Warnung: @examples
>>> [/home/sigbert/syncthing/projekte/R/plot.matrix/R/as.cor.R#12]:
>>> mismatched braces or quotes
>>>
>>> but at the end it says
>>>
>>> ?? R CMD check results ??? plot.matrix 1.3 ????
>>> Duration: 10.8s
>>>
>>> 0 errors ? | 0 warnings ? | 0 notes ?
>>>
>>> Is that okay? The warning actually was correct.
>>>
>>
>> Looks like a bug in devtools.  It's probably looking for "Warning", and
>> not recognizing the German translation.
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From d@v|dhughjone@ @end|ng |rom gm@||@com  Wed Jul 24 15:02:58 2019
From: d@v|dhughjone@ @end|ng |rom gm@||@com (David Hugh-Jones)
Date: Wed, 24 Jul 2019 14:02:58 +0100
Subject: [R-pkg-devel] 
 devtools::check() shows a warning at the beginning,
 but not at the end
In-Reply-To: <aa13fc05-21a5-7c01-d12c-4314f5344917@wiwi.hu-berlin.de>
References: <aa13fc05-21a5-7c01-d12c-4314f5344917@wiwi.hu-berlin.de>
Message-ID: <CAARY7kiWDYyQQpbMxwM8xQm0bymBkPqLyjhF=xwFr8PUkqSgAg@mail.gmail.com>

The warning is from devtools::document()  rather than R CMD check itself.
You should still fix it though!


On Wed, 24 Jul 2019 at 12:05, Sigbert Klinke <sigbert at wiwi.hu-berlin.de>
wrote:

> Hi,
>
> when I called check() on my package I got a warning at the beginning
>
> Updating plot.matrix documentation
> Warnung: roxygen2 requires Encoding: UTF-8
> Warnung: @examples
> [/home/sigbert/syncthing/projekte/R/plot.matrix/R/as.cor.R#12]:
> mismatched braces or quotes
>
> but at the end it says
>
> ?? R CMD check results ??? plot.matrix 1.3 ????
> Duration: 10.8s
>
> 0 errors ? | 0 warnings ? | 0 notes ?
>
> Is that okay? The warning actually was correct.
>
> Thanks
>
> Sigbert
>
> --
> https://hu.berlin/sk
> https://hu.berlin/mmstat3
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
-- 
Sent from Gmail Mobile

	[[alternative HTML version deleted]]


From d@v|dhughjone@ @end|ng |rom gm@||@com  Wed Jul 24 15:03:38 2019
From: d@v|dhughjone@ @end|ng |rom gm@||@com (David Hugh-Jones)
Date: Wed, 24 Jul 2019 14:03:38 +0100
Subject: [R-pkg-devel] 
 devtools::check() shows a warning at the beginning,
 but not at the end
In-Reply-To: <CAARY7kiWDYyQQpbMxwM8xQm0bymBkPqLyjhF=xwFr8PUkqSgAg@mail.gmail.com>
References: <aa13fc05-21a5-7c01-d12c-4314f5344917@wiwi.hu-berlin.de>
 <CAARY7kiWDYyQQpbMxwM8xQm0bymBkPqLyjhF=xwFr8PUkqSgAg@mail.gmail.com>
Message-ID: <CAARY7kiG9yC349vVdDLg9Q5oeZWEic7mS8biwyCdJn2RB7RLYw@mail.gmail.com>

Oops! Sorry for the spam.

On Wed, 24 Jul 2019 at 14:02, David Hugh-Jones <davidhughjones at gmail.com>
wrote:

> The warning is from devtools::document()  rather than R CMD check itself.
> You should still fix it though!
>
>
> On Wed, 24 Jul 2019 at 12:05, Sigbert Klinke <sigbert at wiwi.hu-berlin.de>
> wrote:
>
>> Hi,
>>
>> when I called check() on my package I got a warning at the beginning
>>
>> Updating plot.matrix documentation
>> Warnung: roxygen2 requires Encoding: UTF-8
>> Warnung: @examples
>> [/home/sigbert/syncthing/projekte/R/plot.matrix/R/as.cor.R#12]:
>> mismatched braces or quotes
>>
>> but at the end it says
>>
>> ?? R CMD check results ??? plot.matrix 1.3 ????
>> Duration: 10.8s
>>
>> 0 errors ? | 0 warnings ? | 0 notes ?
>>
>> Is that okay? The warning actually was correct.
>>
>> Thanks
>>
>> Sigbert
>>
>> --
>> https://hu.berlin/sk
>> https://hu.berlin/mmstat3
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> --
> Sent from Gmail Mobile
>
-- 
Sent from Gmail Mobile

	[[alternative HTML version deleted]]


From he|mut@@chuetz @end|ng |rom beb@c@@t  Thu Jul 25 19:45:42 2019
From: he|mut@@chuetz @end|ng |rom beb@c@@t (=?UTF-8?Q?Helmut_Sch=c3=bctz?=)
Date: Thu, 25 Jul 2019 19:45:42 +0200
Subject: [R-pkg-devel] Package manual built by CRAN (Xposted from R-help)
Message-ID: <3ef14e6d-3d4c-63f6-21cc-a6ed4bf057e0@bebac.at>

Dear all,

recently I noticed an unexpected effect. The PDF-manual built from the 
package?s .Rd-files looked different to what I was used to beforeand to 
the one rendered locally. Specifically: If the reference-section looks 
like this

\references{
 ? foo \href{bar}{baz}
 ? ...
}

previously "foo" was intended (like a normal paragraph), "bar" formatted 
in red and "baz" the URL.

Example of what I got instead: 
https://cran.r-project.org/web/packages/replicateBE/replicateBE.pdf 
(first occurrence at page 5).

In the references there are no direct links but a numbered footnotes in 
a mono-spaced font running beyond the right margin of the page. The two 
links of page 5:

In ABE.Rd
https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf 

https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-pharmacokinetic-clinical-evaluation-modified-release-dosage-forms_en.pdf 


ABE.Rd is correctly rendered into ABE.html

In the two footnotes of the PDF links are truncated
https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_ 

https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-pharmacokinetic-clinical-evaluation-modified-release-dosage-forms_ 

Of course, both are punished with a HTTP 404.

Cheers,
Helmut

PS: I?m aware that
\references{
 ? \enumerate{
 ? ? \item foo \href{bar}{baz}
 ? }
}
produces *exactly* this effect. Didn't use it.

-- 
Ing. Helmut Sch?tz
BEBAC?? Consultancy Services for
Bioequivalence and Bioavailability Studies
Neubaugasse 36/11
1070 Vienna, Austria
T +43 1 2311746
M +43 699 10792458
E helmut.schuetz at bebac.at
W https://bebac.at/
C https://bebac.at/Contact.htm
F https://forum.bebac.at/


From roy@mende|@@ohn @end|ng |rom no@@@gov  Thu Jul 25 21:21:17 2019
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Thu, 25 Jul 2019 12:21:17 -0700
Subject: [R-pkg-devel] Needing rgeos from sf
Message-ID: <016B78F5-EFED-4DC9-BED2-031D55C8656C@noaa.gov>

I have been testing a package for resubmission with bug fixes.  On the present CRAN builds I get:

> Result: NOTE 
>     Namespaces in Imports field not imported from:
>      ?mapdata? ?maptools? ?plot3D? ?rgdal? ?rgeos?
>      All declared Imports should be used. 

However,  if I remove rgeos from the imports I get from win builder:

> Error in st_as_sfc.SpatialPolygons(sp::geometry(x), ...) : 
>      package rgeos required for finding out which hole belongs to which exterior ring

Note that I am not calling 'rgeos',  either 'sf' or 'sp' is,  but does not appear to be properly importing all the need namespaces.  

Best way  to proceed?  Include rgeos in Import and get the Note,  or ????

Thanks,

-Roy


**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Jul 25 21:33:15 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 25 Jul 2019 15:33:15 -0400
Subject: [R-pkg-devel] 
 Package manual built by CRAN (Xposted from R-help)
In-Reply-To: <3ef14e6d-3d4c-63f6-21cc-a6ed4bf057e0@bebac.at>
References: <3ef14e6d-3d4c-63f6-21cc-a6ed4bf057e0@bebac.at>
Message-ID: <94fe72e1-80ff-724b-7477-c10696e05b17@gmail.com>

This sounds like a LaTeX bug in whatever system CRAN is using to produce 
the PDF.  Like you, I don't see footnotes, I see the link inline with a 
complete URL.  I think you'd get the footnotes if the LaTeX hyperref.sty 
file is not found, but there may be other ways to trigger that option.

Duncan Murdoch

On 25/07/2019 1:45 p.m., Helmut Sch?tz wrote:
> Dear all,
> 
> recently I noticed an unexpected effect. The PDF-manual built from the
> package?s .Rd-files looked different to what I was used to beforeand to
> the one rendered locally. Specifically: If the reference-section looks
> like this
> 
> \references{
>   ? foo \href{bar}{baz}
>   ? ...
> }
> 
> previously "foo" was intended (like a normal paragraph), "bar" formatted
> in red and "baz" the URL.
> 
> Example of what I got instead:
> https://cran.r-project.org/web/packages/replicateBE/replicateBE.pdf
> (first occurrence at page 5).
> 
> In the references there are no direct links but a numbered footnotes in
> a mono-spaced font running beyond the right margin of the page. The two
> links of page 5:
> 
> In ABE.Rd
> https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf
> 
> https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-pharmacokinetic-clinical-evaluation-modified-release-dosage-forms_en.pdf
> 
> 
> ABE.Rd is correctly rendered into ABE.html
> 
> In the two footnotes of the PDF links are truncated
> https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_
> 
> https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-pharmacokinetic-clinical-evaluation-modified-release-dosage-forms_
> 
> Of course, both are punished with a HTTP 404.
> 
> Cheers,
> Helmut
> 
> PS: I?m aware that
> \references{
>   ? \enumerate{
>   ? ? \item foo \href{bar}{baz}
>   ? }
> }
> produces *exactly* this effect. Didn't use it.
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Jul 25 21:38:31 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 25 Jul 2019 15:38:31 -0400
Subject: [R-pkg-devel] Needing rgeos from sf
In-Reply-To: <016B78F5-EFED-4DC9-BED2-031D55C8656C@noaa.gov>
References: <016B78F5-EFED-4DC9-BED2-031D55C8656C@noaa.gov>
Message-ID: <d7af87bb-569d-bf71-42bc-3afec1693ab5@gmail.com>

On 25/07/2019 3:21 p.m., Roy Mendelssohn - NOAA Federal via 
R-package-devel wrote:
> I have been testing a package for resubmission with bug fixes.  On the present CRAN builds I get:
> 
>> Result: NOTE
>>      Namespaces in Imports field not imported from:
>>       ?mapdata? ?maptools? ?plot3D? ?rgdal? ?rgeos?
>>       All declared Imports should be used.
> 
> However,  if I remove rgeos from the imports I get from win builder:
> 
>> Error in st_as_sfc.SpatialPolygons(sp::geometry(x), ...) :
>>       package rgeos required for finding out which hole belongs to which exterior ring
> 
> Note that I am not calling 'rgeos',  either 'sf' or 'sp' is,  but does not appear to be properly importing all the need namespaces.
> 
> Best way  to proceed?  Include rgeos in Import and get the Note,  or ????

A simple workaround would be to add a function that calls something from 
rgeos just to satisfy the check, e.g.

# Just to satisfy the checks...
dummy <- function() rgeos::getScale()

I don't think there are warnings if dummy is never used or exported, but 
if there are, I think that's a pretty harmless call to make.

Duncan Murdoch


From roy@mende|@@ohn @end|ng |rom no@@@gov  Thu Jul 25 21:47:58 2019
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Thu, 25 Jul 2019 12:47:58 -0700
Subject: [R-pkg-devel] Needing rgeos from sf
In-Reply-To: <d7af87bb-569d-bf71-42bc-3afec1693ab5@gmail.com>
References: <016B78F5-EFED-4DC9-BED2-031D55C8656C@noaa.gov>
 <d7af87bb-569d-bf71-42bc-3afec1693ab5@gmail.com>
Message-ID: <8FC316AA-0229-48A2-AC54-7CAAE39331F8@noaa.gov>

Okay I added rgeos but now it can't find rgdal.  as in:

> Error: processing vignette 'using_plotdap.Rmd' failed with diagnostics:
> package 'rgdal' is not available
> --- failed re-building 'using_plotdap.Rmd'
> 

A question I asked before is if there is anyway to check that 'rgdal' and 'rgeos' are properly installed on the winbuider servers, as well as 'sf' and 'sp'?  'devtools::check()' on my mac produces no errors,  same with  'rhub' using Fedora,  but I get the same errors on 'rhub' using Windows.    So it appears to be a problem with Windows,  and again I am not calling these packages directly so I should not need to Import them.

Thanks,

-Roy


> On Jul 25, 2019, at 12:38 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 25/07/2019 3:21 p.m., Roy Mendelssohn - NOAA Federal via R-package-devel wrote:
>> I have been testing a package for resubmission with bug fixes.  On the present CRAN builds I get:
>>> Result: NOTE
>>>     Namespaces in Imports field not imported from:
>>>      ?mapdata? ?maptools? ?plot3D? ?rgdal? ?rgeos?
>>>      All declared Imports should be used.
>> However,  if I remove rgeos from the imports I get from win builder:
>>> Error in st_as_sfc.SpatialPolygons(sp::geometry(x), ...) :
>>>      package rgeos required for finding out which hole belongs to which exterior ring
>> Note that I am not calling 'rgeos',  either 'sf' or 'sp' is,  but does not appear to be properly importing all the need namespaces.
>> Best way  to proceed?  Include rgeos in Import and get the Note,  or ????
> 
> A simple workaround would be to add a function that calls something from rgeos just to satisfy the check, e.g.
> 
> # Just to satisfy the checks...
> dummy <- function() rgeos::getScale()
> 
> I don't think there are warnings if dummy is never used or exported, but if there are, I think that's a pretty harmless call to make.
> 
> Duncan Murdoch

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Jul 25 21:56:27 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 25 Jul 2019 15:56:27 -0400
Subject: [R-pkg-devel] Needing rgeos from sf
In-Reply-To: <8FC316AA-0229-48A2-AC54-7CAAE39331F8@noaa.gov>
References: <016B78F5-EFED-4DC9-BED2-031D55C8656C@noaa.gov>
 <d7af87bb-569d-bf71-42bc-3afec1693ab5@gmail.com>
 <8FC316AA-0229-48A2-AC54-7CAAE39331F8@noaa.gov>
Message-ID: <fe17c627-61a5-c2d5-3f17-fd81b707688f@gmail.com>

On 25/07/2019 3:47 p.m., Roy Mendelssohn - NOAA Federal wrote:
> Okay I added rgeos but now it can't find rgdal.  as in:
> 
>> Error: processing vignette 'using_plotdap.Rmd' failed with diagnostics:
>> package 'rgdal' is not available
>> --- failed re-building 'using_plotdap.Rmd'
>>
> 
> A question I asked before is if there is anyway to check that 'rgdal' and 'rgeos' are properly installed on the winbuider servers, as well as 'sf' and 'sp'?  'devtools::check()' on my mac produces no errors,  same with  'rhub' using Fedora,  but I get the same errors on 'rhub' using Windows.    So it appears to be a problem with Windows,  and again I am not calling these packages directly so I should not need to Import them.

You're right, you shouldn't need to import them if you don't call them 
directly.  However, if some package that you do need requires them, then 
your build or checks will fail without them.

It's probably getting tedious, but you could work around this as well, 
by figuring out what part of using_plotdap.Rmd needs rgdal, and wrapping 
that code in something like

if (requireNamespace("rgdal")) {
   # code that needs it
}

I think this will mean you need to add rgdal to the Suggests list for 
your package to avoid other warnings.

Duncan Murdoch

> 
> Thanks,
> 
> -Roy
> 
> 
>> On Jul 25, 2019, at 12:38 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> On 25/07/2019 3:21 p.m., Roy Mendelssohn - NOAA Federal via R-package-devel wrote:
>>> I have been testing a package for resubmission with bug fixes.  On the present CRAN builds I get:
>>>> Result: NOTE
>>>>      Namespaces in Imports field not imported from:
>>>>       ?mapdata? ?maptools? ?plot3D? ?rgdal? ?rgeos?
>>>>       All declared Imports should be used.
>>> However,  if I remove rgeos from the imports I get from win builder:
>>>> Error in st_as_sfc.SpatialPolygons(sp::geometry(x), ...) :
>>>>       package rgeos required for finding out which hole belongs to which exterior ring
>>> Note that I am not calling 'rgeos',  either 'sf' or 'sp' is,  but does not appear to be properly importing all the need namespaces.
>>> Best way  to proceed?  Include rgeos in Import and get the Note,  or ????
>>
>> A simple workaround would be to add a function that calls something from rgeos just to satisfy the check, e.g.
>>
>> # Just to satisfy the checks...
>> dummy <- function() rgeos::getScale()
>>
>> I don't think there are warnings if dummy is never used or exported, but if there are, I think that's a pretty harmless call to make.
>>
>> Duncan Murdoch
> 
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
> 
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>


From roy@mende|@@ohn @end|ng |rom no@@@gov  Thu Jul 25 22:49:03 2019
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Thu, 25 Jul 2019 13:49:03 -0700
Subject: [R-pkg-devel] Needing rgeos from sf
In-Reply-To: <fe17c627-61a5-c2d5-3f17-fd81b707688f@gmail.com>
References: <016B78F5-EFED-4DC9-BED2-031D55C8656C@noaa.gov>
 <d7af87bb-569d-bf71-42bc-3afec1693ab5@gmail.com>
 <8FC316AA-0229-48A2-AC54-7CAAE39331F8@noaa.gov>
 <fe17c627-61a5-c2d5-3f17-fd81b707688f@gmail.com>
Message-ID: <9C847A71-8074-4F69-8F90-BB40B09FE26F@noaa.gov>

Thanks,  actually have similar code for some other packages that must have been causing similar problems  (that part was from the original author,  I am now the maintainer).  Now I understand why he had something similar in the code.  There is a comment about Namespaces not being handled properly in those packages.

Will try that.  I actually have rgdal and rgeos in Imports,  they were getting flagged in the CRAN nightly builds.  If I have them in that one statement,  that should take care of both issues I believe.

But it would be nice to figure out why this is happening,  and only on Windows.  Sort of frustrating when you follow the guidelines but get failures,  but what also what is good about things like CRAN,  for whatever reason this will insure I work across platforms.

-Roy


> On Jul 25, 2019, at 12:56 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 25/07/2019 3:47 p.m., Roy Mendelssohn - NOAA Federal wrote:
>> Okay I added rgeos but now it can't find rgdal.  as in:
>>> Error: processing vignette 'using_plotdap.Rmd' failed with diagnostics:
>>> package 'rgdal' is not available
>>> --- failed re-building 'using_plotdap.Rmd'
>>> 
>> A question I asked before is if there is anyway to check that 'rgdal' and 'rgeos' are properly installed on the winbuider servers, as well as 'sf' and 'sp'?  'devtools::check()' on my mac produces no errors,  same with  'rhub' using Fedora,  but I get the same errors on 'rhub' using Windows.    So it appears to be a problem with Windows,  and again I am not calling these packages directly so I should not need to Import them.
> 
> You're right, you shouldn't need to import them if you don't call them directly.  However, if some package that you do need requires them, then your build or checks will fail without them.
> 
> It's probably getting tedious, but you could work around this as well, by figuring out what part of using_plotdap.Rmd needs rgdal, and wrapping that code in something like
> 
> if (requireNamespace("rgdal")) {
>  # code that needs it
> }
> 
> I think this will mean you need to add rgdal to the Suggests list for your package to avoid other warnings.
> 
> Duncan Murdoch
> 
>> Thanks,
>> -Roy
>>> On Jul 25, 2019, at 12:38 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>> 
>>> On 25/07/2019 3:21 p.m., Roy Mendelssohn - NOAA Federal via R-package-devel wrote:
>>>> I have been testing a package for resubmission with bug fixes.  On the present CRAN builds I get:
>>>>> Result: NOTE
>>>>>     Namespaces in Imports field not imported from:
>>>>>      ?mapdata? ?maptools? ?plot3D? ?rgdal? ?rgeos?
>>>>>      All declared Imports should be used.
>>>> However,  if I remove rgeos from the imports I get from win builder:
>>>>> Error in st_as_sfc.SpatialPolygons(sp::geometry(x), ...) :
>>>>>      package rgeos required for finding out which hole belongs to which exterior ring
>>>> Note that I am not calling 'rgeos',  either 'sf' or 'sp' is,  but does not appear to be properly importing all the need namespaces.
>>>> Best way  to proceed?  Include rgeos in Import and get the Note,  or ????
>>> 
>>> A simple workaround would be to add a function that calls something from rgeos just to satisfy the check, e.g.
>>> 
>>> # Just to satisfy the checks...
>>> dummy <- function() rgeos::getScale()
>>> 
>>> I don't think there are warnings if dummy is never used or exported, but if there are, I think that's a pretty harmless call to make.
>>> 
>>> Duncan Murdoch
>> **********************
>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>> **********************
>> Roy Mendelssohn
>> Supervisory Operations Research Analyst
>> NOAA/NMFS
>> Environmental Research Division
>> Southwest Fisheries Science Center
>> ***Note new street address***
>> 110 McAllister Way
>> Santa Cruz, CA 95060
>> Phone: (831)-420-3666
>> Fax: (831) 420-3980
>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>> "Old age and treachery will overcome youth and skill."
>> "From those who have been given much, much will be expected"
>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> 

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From ne@|@p@r|ch@rd@on @end|ng |rom gm@||@com  Thu Jul 25 23:01:54 2019
From: ne@|@p@r|ch@rd@on @end|ng |rom gm@||@com (Neal Richardson)
Date: Thu, 25 Jul 2019 14:01:54 -0700
Subject: [R-pkg-devel] Needing rgeos from sf
In-Reply-To: <9C847A71-8074-4F69-8F90-BB40B09FE26F@noaa.gov>
References: <016B78F5-EFED-4DC9-BED2-031D55C8656C@noaa.gov>
 <d7af87bb-569d-bf71-42bc-3afec1693ab5@gmail.com>
 <8FC316AA-0229-48A2-AC54-7CAAE39331F8@noaa.gov>
 <fe17c627-61a5-c2d5-3f17-fd81b707688f@gmail.com>
 <9C847A71-8074-4F69-8F90-BB40B09FE26F@noaa.gov>
Message-ID: <CAOCv4hjRMZJ3zOtM4ZdrAPHUXvsXmf1vi9EmxRSQp=936DZDNA@mail.gmail.com>

A couple of ideas:

1. Both `sf` and `sp` packages Suggest rgdal and rgeos. If your
package were to Suggest them, the dependencies will be available for
CRAN checks, but they won't be available if they're only Suggested by
a package you Import.
2. Except sometimes when they are available. I've experienced
variability in this before, depending on which CRAN server you run on
and which other packages have recently been checked on it (I think
that's the reason). In your case, it could have something to do with
rgdal/rgeos availability on Windows, but the operating system might be
a red herring. Regardless, it looks like you've found a solution.

Neal


On Thu, Jul 25, 2019 at 1:49 PM Roy Mendelssohn - NOAA Federal via
R-package-devel <r-package-devel at r-project.org> wrote:
>
> Thanks,  actually have similar code for some other packages that must have been causing similar problems  (that part was from the original author,  I am now the maintainer).  Now I understand why he had something similar in the code.  There is a comment about Namespaces not being handled properly in those packages.
>
> Will try that.  I actually have rgdal and rgeos in Imports,  they were getting flagged in the CRAN nightly builds.  If I have them in that one statement,  that should take care of both issues I believe.
>
> But it would be nice to figure out why this is happening,  and only on Windows.  Sort of frustrating when you follow the guidelines but get failures,  but what also what is good about things like CRAN,  for whatever reason this will insure I work across platforms.
>
> -Roy
>
>
> > On Jul 25, 2019, at 12:56 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> >
> > On 25/07/2019 3:47 p.m., Roy Mendelssohn - NOAA Federal wrote:
> >> Okay I added rgeos but now it can't find rgdal.  as in:
> >>> Error: processing vignette 'using_plotdap.Rmd' failed with diagnostics:
> >>> package 'rgdal' is not available
> >>> --- failed re-building 'using_plotdap.Rmd'
> >>>
> >> A question I asked before is if there is anyway to check that 'rgdal' and 'rgeos' are properly installed on the winbuider servers, as well as 'sf' and 'sp'?  'devtools::check()' on my mac produces no errors,  same with  'rhub' using Fedora,  but I get the same errors on 'rhub' using Windows.    So it appears to be a problem with Windows,  and again I am not calling these packages directly so I should not need to Import them.
> >
> > You're right, you shouldn't need to import them if you don't call them directly.  However, if some package that you do need requires them, then your build or checks will fail without them.
> >
> > It's probably getting tedious, but you could work around this as well, by figuring out what part of using_plotdap.Rmd needs rgdal, and wrapping that code in something like
> >
> > if (requireNamespace("rgdal")) {
> >  # code that needs it
> > }
> >
> > I think this will mean you need to add rgdal to the Suggests list for your package to avoid other warnings.
> >
> > Duncan Murdoch
> >
> >> Thanks,
> >> -Roy
> >>> On Jul 25, 2019, at 12:38 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> >>>
> >>> On 25/07/2019 3:21 p.m., Roy Mendelssohn - NOAA Federal via R-package-devel wrote:
> >>>> I have been testing a package for resubmission with bug fixes.  On the present CRAN builds I get:
> >>>>> Result: NOTE
> >>>>>     Namespaces in Imports field not imported from:
> >>>>>      ?mapdata? ?maptools? ?plot3D? ?rgdal? ?rgeos?
> >>>>>      All declared Imports should be used.
> >>>> However,  if I remove rgeos from the imports I get from win builder:
> >>>>> Error in st_as_sfc.SpatialPolygons(sp::geometry(x), ...) :
> >>>>>      package rgeos required for finding out which hole belongs to which exterior ring
> >>>> Note that I am not calling 'rgeos',  either 'sf' or 'sp' is,  but does not appear to be properly importing all the need namespaces.
> >>>> Best way  to proceed?  Include rgeos in Import and get the Note,  or ????
> >>>
> >>> A simple workaround would be to add a function that calls something from rgeos just to satisfy the check, e.g.
> >>>
> >>> # Just to satisfy the checks...
> >>> dummy <- function() rgeos::getScale()
> >>>
> >>> I don't think there are warnings if dummy is never used or exported, but if there are, I think that's a pretty harmless call to make.
> >>>
> >>> Duncan Murdoch
> >> **********************
> >> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> >> **********************
> >> Roy Mendelssohn
> >> Supervisory Operations Research Analyst
> >> NOAA/NMFS
> >> Environmental Research Division
> >> Southwest Fisheries Science Center
> >> ***Note new street address***
> >> 110 McAllister Way
> >> Santa Cruz, CA 95060
> >> Phone: (831)-420-3666
> >> Fax: (831) 420-3980
> >> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
> >> "Old age and treachery will overcome youth and skill."
> >> "From those who have been given much, much will be expected"
> >> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> >
>
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From he|mut@@chuetz @end|ng |rom beb@c@@t  Fri Jul 26 00:09:43 2019
From: he|mut@@chuetz @end|ng |rom beb@c@@t (=?UTF-8?Q?Helmut_Sch=c3=bctz?=)
Date: Fri, 26 Jul 2019 00:09:43 +0200
Subject: [R-pkg-devel] 
 Package manual built by CRAN (Xposted from R-help)
In-Reply-To: <94fe72e1-80ff-724b-7477-c10696e05b17@gmail.com>
References: <3ef14e6d-3d4c-63f6-21cc-a6ed4bf057e0@bebac.at>
 <94fe72e1-80ff-724b-7477-c10696e05b17@gmail.com>
Message-ID: <4af99903-7f3b-4d31-935f-8742c7174274@bebac.at>

Hi Duncan,

Duncan Murdoch wrote on 2019-07-25 21:33:
> This sounds like a LaTeX bug in whatever system CRAN is using to 
> produce the PDF.? Like you, I don't see footnotes, I see the link 
> inline with a complete URL.? I think you'd get the footnotes if the 
> LaTeX hyperref.sty file is not found, [?]

Perfect guess! When I removed hyperref.sty from my installation I got 
also the footnotes (without any errors or warnings).
So what is the best way to proceed? Ask Uwe Ligges?

Helmut

-- 
Ing. Helmut Sch?tz
BEBAC?? Consultancy Services for
Bioequivalence and Bioavailability Studies
Neubaugasse 36/11
1070 Vienna, Austria
T +43 1 2311746
M +43 699 10792458
E helmut.schuetz at bebac.at
W https://bebac.at/
C https://bebac.at/Contact.htm
F https://forum.bebac.at/
GIS 24799386, VAT?ATU61115625, DUNS?300370568, EORI?ATEOS1000096209
GDPR https://bebac.at/Data-Protection.htm
This e-mail is confidential and may also be legally privileged. If you
are not the intended recipient please reply to sender, do not disclose
its contents to any person and delete the e-mail. Any unauthorized
review, use, disclosure, copying or distribution is strictly prohibited.


From @|gbert @end|ng |rom w|w|@hu-ber||n@de  Fri Jul 26 08:37:15 2019
From: @|gbert @end|ng |rom w|w|@hu-ber||n@de (Sigbert Klinke)
Date: Fri, 26 Jul 2019 08:37:15 +0200
Subject: [R-pkg-devel] Example fails in check
Message-ID: <dc1771de-945d-456f-a487-1c03cc3b004e@wiwi.hu-berlin.de>

Hi,

im my package development I get the following error when checking an 
example:

 > m <- findMatch('test', x[[1]], FUN='leven(code)') %>% addWave(x[[2]])

   Error in findMatch("test", x[[1]], FUN = "leven(code)") %>% 
addWave(x[[2]]) :
     could not find function "%>%"
   Execution halted

In my DESCRIPTION file I wrote

Imports:
   rio,
   stringi,
   magrittr

So, I expected that magrittr is loaded when the example is executed.

If I add an "library(magrittr)" at the beginning of the example then the 
example is okay.

Any ideas what goes wrong?

Sigbert

-- 
https://hu.berlin/sk
https://hu.berlin/mmstat3


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Fri Jul 26 09:13:17 2019
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Fri, 26 Jul 2019 09:13:17 +0200
Subject: [R-pkg-devel] Example fails in check
In-Reply-To: <dc1771de-945d-456f-a487-1c03cc3b004e@wiwi.hu-berlin.de>
References: <dc1771de-945d-456f-a487-1c03cc3b004e@wiwi.hu-berlin.de>
Message-ID: <deb4fb55-90bb-d0b1-454d-746b4b48f305@statistik.tu-dortmund.de>

I'd suggest not to use pipes in package code, as the parser does not 
know about them and hence debugging, error messages .... are more 
obfuscated.

Why not use he functional way of R?


For the question: I guess you do not have a corresponding entry in the 
NAMESPACE file?

Best,
Uwe



On 26.07.2019 08:37, Sigbert Klinke wrote:
> Hi,
> 
> im my package development I get the following error when checking an 
> example:
> 
>  > m <- findMatch('test', x[[1]], FUN='leven(code)') %>% addWave(x[[2]])
> 
>  ? Error in findMatch("test", x[[1]], FUN = "leven(code)") %>% 
> addWave(x[[2]]) :
>  ??? could not find function "%>%"
>  ? Execution halted
> 
> In my DESCRIPTION file I wrote
> 
> Imports:
>  ? rio,
>  ? stringi,
>  ? magrittr
> 
> So, I expected that magrittr is loaded when the example is executed.
> 
> If I add an "library(magrittr)" at the beginning of the example then the 
> example is okay.
> 
> Any ideas what goes wrong?
> 
> Sigbert
>


From j|@hu@nye431 @end|ng |rom gm@||@com  Fri Jul 26 08:50:36 2019
From: j|@hu@nye431 @end|ng |rom gm@||@com (Jiahuan ye)
Date: Fri, 26 Jul 2019 01:50:36 -0500
Subject: [R-pkg-devel] "Additional issues" show WRITE outside an array
Message-ID: <CAPY5Euo9GZfb_6BZDhU0pGDxFYhGQoLELVsQQTrbowRrSYwu-A@mail.gmail.com>

Hi,

Recently, my first r package offlineChange
<https://cran.r-project.org/web/packages/offlineChange/index.html>
was uploaded to CRAN, and there are three errors. I already figured out
that two of the three errors are that the depend and import are
inconsistent:

Depends:    R (? 3.5.0)
Imports:        graphics (? 3.6.0), utils (? 3.6.0), stats (? 3.5.1), Rcpp
(? 1.0.1)

But for the last ERROR, which only appears under r-patched-linux-x86_64
<https://cran.r-project.org/web/checks/check_flavors.html#r-patched-linux-x86_64>,
I still can't figure it out.
<https://cran.r-project.org/web/checks/check_results_offlineChange.html>
And there is also an additional issue that I think is related with the
above ERROR:
gcc-ASAN <https://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-ASAN/offlineChange
>
I am very confused what causes the ERROR. When I tested under windows, the
package works well. And there is error in my codes, why does the ERROR only
appear under linux with certain R version?

Thank you for your help.

Best,
Jiahuan

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Fri Jul 26 13:09:28 2019
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Fri, 26 Jul 2019 13:09:28 +0200
Subject: [R-pkg-devel] "Additional issues" show WRITE outside an array
In-Reply-To: <CAPY5Euo9GZfb_6BZDhU0pGDxFYhGQoLELVsQQTrbowRrSYwu-A@mail.gmail.com>
References: <CAPY5Euo9GZfb_6BZDhU0pGDxFYhGQoLELVsQQTrbowRrSYwu-A@mail.gmail.com>
Message-ID: <40aaa040-d397-12ba-5596-2a88e8fb325a@statistik.tu-dortmund.de>

Checks with address sanitizers have to be done with instrumnted R 
versions and take a long time, hence we run these checks less frequently 
and only under one platform (here Linux for simplicity).

Best,
Uwe Ligges




On 26.07.2019 08:50, Jiahuan ye wrote:
> Hi,
> 
> Recently, my first r package offlineChange
> <https://cran.r-project.org/web/packages/offlineChange/index.html>
> was uploaded to CRAN, and there are three errors. I already figured out
> that two of the three errors are that the depend and import are
> inconsistent:
> 
> Depends:    R (? 3.5.0)
> Imports:        graphics (? 3.6.0), utils (? 3.6.0), stats (? 3.5.1), Rcpp
> (? 1.0.1)
> 
> But for the last ERROR, which only appears under r-patched-linux-x86_64
> <https://cran.r-project.org/web/checks/check_flavors.html#r-patched-linux-x86_64>,
> I still can't figure it out.
> <https://cran.r-project.org/web/checks/check_results_offlineChange.html>
> And there is also an additional issue that I think is related with the
> above ERROR:
> gcc-ASAN <https://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-ASAN/offlineChange
>>
> I am very confused what causes the ERROR. When I tested under windows, the
> package works well. And there is error in my codes, why does the ERROR only
> appear under linux with certain R version?
> 
> Thank you for your help.
> 
> Best,
> Jiahuan
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jul 26 13:44:39 2019
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 26 Jul 2019 14:44:39 +0300
Subject: [R-pkg-devel] "Additional issues" show WRITE outside an array
In-Reply-To: <CAPY5Euo9GZfb_6BZDhU0pGDxFYhGQoLELVsQQTrbowRrSYwu-A@mail.gmail.com>
References: <CAPY5Euo9GZfb_6BZDhU0pGDxFYhGQoLELVsQQTrbowRrSYwu-A@mail.gmail.com>
Message-ID: <20190726144439.5f38cdaa@trisector>

On Fri, 26 Jul 2019 01:50:36 -0500
Jiahuan ye <jiahuanye431 at gmail.com> wrote:

> I am very confused what causes the ERROR.

Your code on line 197 of src/min_wgss.cpp causes memory access outside
the block that had been allocated for the best_change_point vector.

I have not read the code in depth, but it looks like the length of
best_change_point should be M at this point. Array indices on the C++
side start with 0 and end at (length-1), so erasing the element at
position M in a NumericVector of length M in Rcpp code results in
undefined behaviour.

-- 
Best regards,
Ivan


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Jul 26 14:32:44 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 26 Jul 2019 05:32:44 -0700
Subject: [R-pkg-devel] Example fails in check
In-Reply-To: <deb4fb55-90bb-d0b1-454d-746b4b48f305@statistik.tu-dortmund.de>
References: <dc1771de-945d-456f-a487-1c03cc3b004e@wiwi.hu-berlin.de>
 <deb4fb55-90bb-d0b1-454d-746b4b48f305@statistik.tu-dortmund.de>
Message-ID: <DE47C731-FB91-4792-8B54-B7926D1667F6@dcn.davis.ca.us>

Pipes are very functional, unlike data.table. However, their extensive use of non-standard evaluation a la `subset` or `with` does complicate the package check process.

As to the actual question, Imports announces that the magrittr package is a private dependency for your package. Users would have to load that package  if they wanted to use it also. Since examples are run as if they were the user, they are subject to that same constraint. The advantage of having Imports rather than Depends is that you have more flexibility to change which dependencies you use to achieve your goals as a package without affecting the functions that the user has to be prepared to use our avoid, and the user is on their own as to which packages they use.

On July 26, 2019 12:13:17 AM PDT, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
>I'd suggest not to use pipes in package code, as the parser does not 
>know about them and hence debugging, error messages .... are more 
>obfuscated.
>
>Why not use he functional way of R?
>
>
>For the question: I guess you do not have a corresponding entry in the 
>NAMESPACE file?
>
>Best,
>Uwe
>
>
>
>On 26.07.2019 08:37, Sigbert Klinke wrote:
>> Hi,
>> 
>> im my package development I get the following error when checking an 
>> example:
>> 
>>  > m <- findMatch('test', x[[1]], FUN='leven(code)') %>%
>addWave(x[[2]])
>> 
>>  ? Error in findMatch("test", x[[1]], FUN = "leven(code)") %>% 
>> addWave(x[[2]]) :
>>  ??? could not find function "%>%"
>>  ? Execution halted
>> 
>> In my DESCRIPTION file I wrote
>> 
>> Imports:
>>  ? rio,
>>  ? stringi,
>>  ? magrittr
>> 
>> So, I expected that magrittr is loaded when the example is executed.
>> 
>> If I add an "library(magrittr)" at the beginning of the example then
>the 
>> example is okay.
>> 
>> Any ideas what goes wrong?
>> 
>> Sigbert
>>
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Jul 26 14:34:55 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 26 Jul 2019 08:34:55 -0400
Subject: [R-pkg-devel] Example fails in check
In-Reply-To: <dc1771de-945d-456f-a487-1c03cc3b004e@wiwi.hu-berlin.de>
References: <dc1771de-945d-456f-a487-1c03cc3b004e@wiwi.hu-berlin.de>
Message-ID: <b3bbe79c-3455-a6fe-2acc-f943098f6cda@gmail.com>

On 26/07/2019 2:37 a.m., Sigbert Klinke wrote:
> Hi,
> 
> im my package development I get the following error when checking an
> example:
> 
>   > m <- findMatch('test', x[[1]], FUN='leven(code)') %>% addWave(x[[2]])
> 
>     Error in findMatch("test", x[[1]], FUN = "leven(code)") %>%
> addWave(x[[2]]) :
>       could not find function "%>%"
>     Execution halted
> 
> In my DESCRIPTION file I wrote
> 
> Imports:
>     rio,
>     stringi,
>     magrittr
> 
> So, I expected that magrittr is loaded when the example is executed.

Loaded doesn't mean it is on the search list.  To get that you need 
library(magrittr), or require(magrittr).

Examples can't see things that are internal to the package.  Importing a 
package only makes it available internally.   If you want it visible 
externally (as it needs to be in an example), you need to export it.

So if you want users of your package to have access to magrittr pipes, 
you should put something like this in your NAMESPACE file, as well as 
the declaration in your DESCRIPTION file:

importFrom(magrittr, "%>%")
export("%>%")

Duncan Murdoch




> 
> If I add an "library(magrittr)" at the beginning of the example then the
> example is okay.
> 
> Any ideas what goes wrong?
> 
> Sigbert
>


From ph||||p@j@rrett1 @end|ng |rom gm@||@com  Fri Jul 26 16:09:27 2019
From: ph||||p@j@rrett1 @end|ng |rom gm@||@com (Jarrett Phillips)
Date: Fri, 26 Jul 2019 10:09:27 -0400
Subject: [R-pkg-devel] (Not) Reporting minimum R version in DESCRIPTION
 Depends Field
Message-ID: <CAMVrHdA=2guY83SgiNSodxPQK6G6OkEnP8t0RANMng28Bn=vnw@mail.gmail.com>

Hello,

Numerous CRAN packages report minimum R versions within the Depends field
of the DESCRIPTION file.

Is this reporting always necessary?

Hadley Wickham's book "R Packages" states:

"You can also use Depends to require a specific version of R, e.g. Depends: R
(>= 3.0.1) . As with packages, it?s a good idea to play it safe and require
a version greater than or equal to the version you?re currently using.
devtools::create()  will do this for you."

devtools::check() doesn't warn about not specifying R version, so I am just
curious.


Thanks.

Cheers,

Jarrett

	[[alternative HTML version deleted]]


From h@w|ckh@m @end|ng |rom gm@||@com  Fri Jul 26 16:20:14 2019
From: h@w|ckh@m @end|ng |rom gm@||@com (Hadley Wickham)
Date: Fri, 26 Jul 2019 09:20:14 -0500
Subject: [R-pkg-devel] (Not) Reporting minimum R version in DESCRIPTION
 Depends Field
In-Reply-To: <CAMVrHdA=2guY83SgiNSodxPQK6G6OkEnP8t0RANMng28Bn=vnw@mail.gmail.com>
References: <CAMVrHdA=2guY83SgiNSodxPQK6G6OkEnP8t0RANMng28Bn=vnw@mail.gmail.com>
Message-ID: <CABdHhvHuRbSOg4MquQaBGK1E4xwVy2PYuqm2ggEusLheQSwBUQ@mail.gmail.com>

I no longer believe this to be good advice - I think you should only
declare a specific dependency if you want to strongly assert that your
package works with those versions. For example, all tidyverse versions
depend on R 3.2 and later, because we test on all those versions.

Hadley

On Friday, July 26, 2019, Jarrett Phillips <phillipsjarrett1 at gmail.com>
wrote:

> Hello,
>
> Numerous CRAN packages report minimum R versions within the Depends field
> of the DESCRIPTION file.
>
> Is this reporting always necessary?
>
> Hadley Wickham's book "R Packages" states:
>
> "You can also use Depends to require a specific version of R, e.g.
> Depends: R
> (>= 3.0.1) . As with packages, it?s a good idea to play it safe and require
> a version greater than or equal to the version you?re currently using.
> devtools::create()  will do this for you."
>
> devtools::check() doesn't warn about not specifying R version, so I am just
> curious.
>
>
> Thanks.
>
> Cheers,
>
> Jarrett
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


-- 
http://hadley.nz

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Fri Jul 26 16:28:57 2019
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Fri, 26 Jul 2019 10:28:57 -0400
Subject: [R-pkg-devel] (Not) Reporting minimum R version in DESCRIPTION
 Depends Field
In-Reply-To: <CABdHhvHuRbSOg4MquQaBGK1E4xwVy2PYuqm2ggEusLheQSwBUQ@mail.gmail.com>
References: <CAMVrHdA=2guY83SgiNSodxPQK6G6OkEnP8t0RANMng28Bn=vnw@mail.gmail.com>
 <CABdHhvHuRbSOg4MquQaBGK1E4xwVy2PYuqm2ggEusLheQSwBUQ@mail.gmail.com>
Message-ID: <3d114888-f00f-cb20-53b5-31eeced495ac@gmail.com>

   I'd add: as far as I know CRAN policy would only require you to
report the minimum version if your package would fail on one of the
older R versions that CRAN still tests (at present I think this goes
back to 3.5.2).  For regular package developers (i.e.  without the
resources of RStudio) it's a nuisance to install lots of old versions of
R just to find out how far back your package actually works.  IMO it's a
little bit obnoxious (albeit maybe unintentionally so) to prevent users
who are stuck with earlier versions from using your package without a
good reason.
  (For this reason I try to save RData files that are included in my
packages with version=2 so that users with R <3.5.0 aren't left out ...)

  Unless you know that your package depends on features introduced in a
particular version of R, I'd leave it out.  If you find out later from
users that it breaks on earlier versions, and you can't find a way to
enable its use on earlier versions, you can add the dependency in a
later release.

 Ben Bolker

On 2019-07-26 10:20 a.m., Hadley Wickham wrote:
> I no longer believe this to be good advice - I think you should only
> declare a specific dependency if you want to strongly assert that your
> package works with those versions. For example, all tidyverse versions
> depend on R 3.2 and later, because we test on all those versions.
> 
> Hadley
> 
> On Friday, July 26, 2019, Jarrett Phillips <phillipsjarrett1 at gmail.com>
> wrote:
> 
>> Hello,
>>
>> Numerous CRAN packages report minimum R versions within the Depends field
>> of the DESCRIPTION file.
>>
>> Is this reporting always necessary?
>>
>> Hadley Wickham's book "R Packages" states:
>>
>> "You can also use Depends to require a specific version of R, e.g.
>> Depends: R
>> (>= 3.0.1) . As with packages, it?s a good idea to play it safe and require
>> a version greater than or equal to the version you?re currently using.
>> devtools::create()  will do this for you."
>>
>> devtools::check() doesn't warn about not specifying R version, so I am just
>> curious.
>>
>>
>> Thanks.
>>
>> Cheers,
>>
>> Jarrett
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
>


From h@w|ckh@m @end|ng |rom gm@||@com  Tue Jul 30 15:17:54 2019
From: h@w|ckh@m @end|ng |rom gm@||@com (Hadley Wickham)
Date: Tue, 30 Jul 2019 07:17:54 -0600
Subject: [R-pkg-devel] (Not) Reporting minimum R version in DESCRIPTION
 Depends Field
In-Reply-To: <3d114888-f00f-cb20-53b5-31eeced495ac@gmail.com>
References: <CAMVrHdA=2guY83SgiNSodxPQK6G6OkEnP8t0RANMng28Bn=vnw@mail.gmail.com>
 <CABdHhvHuRbSOg4MquQaBGK1E4xwVy2PYuqm2ggEusLheQSwBUQ@mail.gmail.com>
 <3d114888-f00f-cb20-53b5-31eeced495ac@gmail.com>
Message-ID: <CABdHhvEEvqcXEf217ysu1zFbpMvDzjLn0GET+ctDZo1jeorXfA@mail.gmail.com>

On Fri, Jul 26, 2019 at 8:46 AM Ben Bolker <bbolker at gmail.com> wrote:
>
>    I'd add: as far as I know CRAN policy would only require you to
> report the minimum version if your package would fail on one of the
> older R versions that CRAN still tests (at present I think this goes
> back to 3.5.2).  For regular package developers (i.e.  without the
> resources of RStudio) it's a nuisance to install lots of old versions of
> R just to find out how far back your package actually works.

If you already use travis, this is pretty easy. All you need is something like:

matrix:
  include:
  - r: release
  - r: devel
  - r: oldrel
  - r: 3.4
  - r: 3.3
  - r: 3.2
  - r: 3.1

Obviously the challenge is making things work on older versions of R ?
in our experience this is either really easy (i.e. you just
accidentally used a function that was added to R recently) or really
rather hard (your code on works in recent R because of bug that R core
fixed)

Hadley

> IMO it's a
> little bit obnoxious (albeit maybe unintentionally so) to prevent users
> who are stuck with earlier versions from using your package without a
> good reason.
>   (For this reason I try to save RData files that are included in my
> packages with version=2 so that users with R <3.5.0 aren't left out ...)
>
>   Unless you know that your package depends on features introduced in a
> particular version of R, I'd leave it out.  If you find out later from
> users that it breaks on earlier versions, and you can't find a way to
> enable its use on earlier versions, you can add the dependency in a
> later release.
>
>  Ben Bolker
>
> On 2019-07-26 10:20 a.m., Hadley Wickham wrote:
> > I no longer believe this to be good advice - I think you should only
> > declare a specific dependency if you want to strongly assert that your
> > package works with those versions. For example, all tidyverse versions
> > depend on R 3.2 and later, because we test on all those versions.
> >
> > Hadley
> >
> > On Friday, July 26, 2019, Jarrett Phillips <phillipsjarrett1 at gmail.com>
> > wrote:
> >
> >> Hello,
> >>
> >> Numerous CRAN packages report minimum R versions within the Depends field
> >> of the DESCRIPTION file.
> >>
> >> Is this reporting always necessary?
> >>
> >> Hadley Wickham's book "R Packages" states:
> >>
> >> "You can also use Depends to require a specific version of R, e.g.
> >> Depends: R
> >> (>= 3.0.1) . As with packages, it?s a good idea to play it safe and require
> >> a version greater than or equal to the version you?re currently using.
> >> devtools::create()  will do this for you."
> >>
> >> devtools::check() doesn't warn about not specifying R version, so I am just
> >> curious.
> >>
> >>
> >> Thanks.
> >>
> >> Cheers,
> >>
> >> Jarrett
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
http://hadley.nz


From bbo|ker @end|ng |rom gm@||@com  Sun Aug  4 23:26:17 2019
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 4 Aug 2019 17:26:17 -0400
Subject: [R-pkg-devel] help troubleshooting travis-ci issues?
Message-ID: <5377b497-fd20-4269-adc4-0f5498faa758@gmail.com>


  I'm having some trouble with travis builds of a package (local checks
work fine) and hoping if I can get suggestions for diagnosis &
troubleshooting ...

The package is 'broom.mixed'; I hadn't changed it in a while, but
recently got a minor pull request which seemed reasonable. I believe the
problems I'm having now are dependency and/or caching problems, not
actually related to the changes in the package.

The failing build is here

https://travis-ci.org/bbolker/broom.mixed/builds/567597217

The initial tests of the PR failed, I think because rstan took too long
to compile.  So I added some code to install rstan binaries from a PPA
instead of compiling it on the spot:

https://github.com/bbolker/broom.mixed/blob/master/.travis.yml#L32-L34

(thanks to various resources Dirk Eddelbuettel has written).  I got more
errors (described below) that I thought were caused by package caching,
but clearing the Travis cache
<https://docs.travis-ci.com/user/caching/#clearing-caches> doesn't seem
to have helped; now I'm afraid that they're due to a mismatch between
the R configuration in Michael Rutter's cd24u repo and the configuration
on Travis ... ?

  Any suggestions for what to look at?

  My travis skills are definitely cargo-culty, so please be gentle if
you look at my .travis.yml file (feel free to suggest/explain improvements!)

   Ben Bolker

---

---
[installing ggstance, ggridges, lmerTest]
Error: package "scales" was installed by an R version with different
internals; it needs to be reinstalled for use with this R version
Execution halted

[installing htmlwidgets]
Failed with error: "there is no package called "shiny"

[running examples]
Error: package "fansi" was installed by an R version with different
internals; it needs to be reinstalled for use with this R version
Execution halted


From |uc@r @end|ng |rom |edor@project@org  Sun Aug  4 23:43:45 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Sun, 4 Aug 2019 23:43:45 +0200
Subject: [R-pkg-devel] help troubleshooting travis-ci issues?
In-Reply-To: <5377b497-fd20-4269-adc4-0f5498faa758@gmail.com>
References: <5377b497-fd20-4269-adc4-0f5498faa758@gmail.com>
Message-ID: <CALEXWq27kWKrSz=mdRXZf021ZLu4_3nhyPnDssSAq3Ud=8vMug@mail.gmail.com>

On Sun, 4 Aug 2019 at 23:26, Ben Bolker <bbolker at gmail.com> wrote:
>
>
>   I'm having some trouble with travis builds of a package (local checks
> work fine) and hoping if I can get suggestions for diagnosis &
> troubleshooting ...
>
> The package is 'broom.mixed'; I hadn't changed it in a while, but
> recently got a minor pull request which seemed reasonable. I believe the
> problems I'm having now are dependency and/or caching problems, not
> actually related to the changes in the package.
>
> The failing build is here
>
> https://travis-ci.org/bbolker/broom.mixed/builds/567597217

I see various "package x was installed by an R version with different
internals; it needs to be reinstalled for use with this R version".

Top of the page, right side, you should see More options > Caches. Try
removing them and restart the build.

I?aki


From bbo|ker @end|ng |rom gm@||@com  Sun Aug  4 23:45:37 2019
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 4 Aug 2019 17:45:37 -0400
Subject: [R-pkg-devel] help troubleshooting travis-ci issues?
In-Reply-To: <CALEXWq27kWKrSz=mdRXZf021ZLu4_3nhyPnDssSAq3Ud=8vMug@mail.gmail.com>
References: <5377b497-fd20-4269-adc4-0f5498faa758@gmail.com>
 <CALEXWq27kWKrSz=mdRXZf021ZLu4_3nhyPnDssSAq3Ud=8vMug@mail.gmail.com>
Message-ID: <da712bfc-ef8f-925d-7b07-ca1287012472@gmail.com>



On 2019-08-04 5:43 p.m., I?aki Ucar wrote:
> On Sun, 4 Aug 2019 at 23:26, Ben Bolker <bbolker at gmail.com> wrote:
>>
>>
>>   I'm having some trouble with travis builds of a package (local checks
>> work fine) and hoping if I can get suggestions for diagnosis &
>> troubleshooting ...
>>
>> The package is 'broom.mixed'; I hadn't changed it in a while, but
>> recently got a minor pull request which seemed reasonable. I believe the
>> problems I'm having now are dependency and/or caching problems, not
>> actually related to the changes in the package.
>>
>> The failing build is here
>>
>> https://travis-ci.org/bbolker/broom.mixed/builds/567597217
> 
> I see various "package x was installed by an R version with different
> internals; it needs to be reinstalled for use with this R version".
> 
> Top of the page, right side, you should see More options > Caches. Try
> removing them and restart the build.
> 
> I?aki

  I tried that already, thanks.  That's why I'm now suspecting it's some
kind of mismatch between the Rutter PPAs and the default (?) repos that
Travis uses.  It would be a little painful, but I could edit out the
rstan dependency and try the builds with and without Rutter's PPA to
test that hypothesis ...

  cheers
    Ben Bolker



>


From |uc@r @end|ng |rom |edor@project@org  Mon Aug  5 00:05:45 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Mon, 5 Aug 2019 00:05:45 +0200
Subject: [R-pkg-devel] help troubleshooting travis-ci issues?
In-Reply-To: <da712bfc-ef8f-925d-7b07-ca1287012472@gmail.com>
References: <5377b497-fd20-4269-adc4-0f5498faa758@gmail.com>
 <CALEXWq27kWKrSz=mdRXZf021ZLu4_3nhyPnDssSAq3Ud=8vMug@mail.gmail.com>
 <da712bfc-ef8f-925d-7b07-ca1287012472@gmail.com>
Message-ID: <CALEXWq3d-Gy72Ghpt1v2furdTbCO62ms=ErS64z0LBJKOunWCg@mail.gmail.com>

On Sun, 4 Aug 2019 at 23:45, Ben Bolker <bbolker at gmail.com> wrote:
>
>   I tried that already, thanks.

Sorry, I should have read til the end of the email before posting.

> That's why I'm now suspecting it's some
> kind of mismatch between the Rutter PPAs and the default (?) repos that
> Travis uses.  It would be a little painful, but I could edit out the
> rstan dependency and try the builds with and without Rutter's PPA to
> test that hypothesis ...

Yes, it seems that Rutter's repo is causing the trouble. You could try
to install those erroring packages from CRAN, i.e., by adding:

r_packages:
  - scales
  - ps
  - fansi

to your travis file.

I?aki


From bbo|ker @end|ng |rom gm@||@com  Mon Aug  5 00:08:13 2019
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 4 Aug 2019 18:08:13 -0400
Subject: [R-pkg-devel] help troubleshooting travis-ci issues?
In-Reply-To: <CALEXWq3d-Gy72Ghpt1v2furdTbCO62ms=ErS64z0LBJKOunWCg@mail.gmail.com>
References: <5377b497-fd20-4269-adc4-0f5498faa758@gmail.com>
 <CALEXWq27kWKrSz=mdRXZf021ZLu4_3nhyPnDssSAq3Ud=8vMug@mail.gmail.com>
 <da712bfc-ef8f-925d-7b07-ca1287012472@gmail.com>
 <CALEXWq3d-Gy72Ghpt1v2furdTbCO62ms=ErS64z0LBJKOunWCg@mail.gmail.com>
Message-ID: <0b217f5a-70a2-a957-fc50-5686d4d55680@gmail.com>


  Yeah, I might try that, or I might try installing the downstream
packages that are causing problems from Rutter's repo.  (Right now I'm
checking whether I can get it to build on travis without Rutter's repo,
and with rstan/rstanarm removed from the Suggests: list ...

  thanks,
    Ben Bolker


On 2019-08-04 6:05 p.m., I?aki Ucar wrote:
> On Sun, 4 Aug 2019 at 23:45, Ben Bolker <bbolker at gmail.com> wrote:
>>
>>   I tried that already, thanks.
> 
> Sorry, I should have read til the end of the email before posting.
> 
>> That's why I'm now suspecting it's some
>> kind of mismatch between the Rutter PPAs and the default (?) repos that
>> Travis uses.  It would be a little painful, but I could edit out the
>> rstan dependency and try the builds with and without Rutter's PPA to
>> test that hypothesis ...
> 
> Yes, it seems that Rutter's repo is causing the trouble. You could try
> to install those erroring packages from CRAN, i.e., by adding:
> 
> r_packages:
>   - scales
>   - ps
>   - fansi
> 
> to your travis file.
> 
> I?aki
>


From jo@h@m@u|r|ch @end|ng |rom gm@||@com  Mon Aug  5 00:08:24 2019
From: jo@h@m@u|r|ch @end|ng |rom gm@||@com (Joshua Ulrich)
Date: Sun, 4 Aug 2019 17:08:24 -0500
Subject: [R-pkg-devel] help troubleshooting travis-ci issues?
In-Reply-To: <da712bfc-ef8f-925d-7b07-ca1287012472@gmail.com>
References: <5377b497-fd20-4269-adc4-0f5498faa758@gmail.com>
 <CALEXWq27kWKrSz=mdRXZf021ZLu4_3nhyPnDssSAq3Ud=8vMug@mail.gmail.com>
 <da712bfc-ef8f-925d-7b07-ca1287012472@gmail.com>
Message-ID: <CAPPM_gSvYB+LS54KtMVzPqgMwpj42YRKv=_=Yjd=M943wJnHFQ@mail.gmail.com>

On Sun, Aug 4, 2019 at 4:54 PM Ben Bolker <bbolker at gmail.com> wrote:
>
> On 2019-08-04 5:43 p.m., I?aki Ucar wrote:
> > On Sun, 4 Aug 2019 at 23:26, Ben Bolker <bbolker at gmail.com> wrote:
> >>
> >>
> >>   I'm having some trouble with travis builds of a package (local checks
> >> work fine) and hoping if I can get suggestions for diagnosis &
> >> troubleshooting ...
> >>
> >> The package is 'broom.mixed'; I hadn't changed it in a while, but
> >> recently got a minor pull request which seemed reasonable. I believe the
> >> problems I'm having now are dependency and/or caching problems, not
> >> actually related to the changes in the package.
> >>
> >> The failing build is here
> >>
> >> https://travis-ci.org/bbolker/broom.mixed/builds/567597217
> >
> > I see various "package x was installed by an R version with different
> > internals; it needs to be reinstalled for use with this R version".
> >
> > Top of the page, right side, you should see More options > Caches. Try
> > removing them and restart the build.
> >
> > I?aki
>
>   I tried that already, thanks.  That's why I'm now suspecting it's some
> kind of mismatch between the Rutter PPAs and the default (?) repos that
> Travis uses.  It would be a little painful, but I could edit out the
> rstan dependency and try the builds with and without Rutter's PPA to
> test that hypothesis ...
>
Try changing:
sudo add-apt-repository -y "ppa:marutter/rrutter"
sudo add-apt-repository -y "ppa:marutter/c2d4u"
to:
sudo add-apt-repository -y "ppa:marutter/rrutter3.5"
sudo add-apt-repository -y "ppa:marutter/c2d4u3.5"

The R C API changed between R-3.4.x and R-3.5.x, which created
incompatibility in packages installed using different versions.  Any R
> 3.6.x should use the "ppa:*3.5" PPAs.


>   cheers
>     Ben Bolker
>
>
>
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


From bbo|ker @end|ng |rom gm@||@com  Mon Aug  5 00:12:01 2019
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 4 Aug 2019 18:12:01 -0400
Subject: [R-pkg-devel] help troubleshooting travis-ci issues?
In-Reply-To: <CAPPM_gSvYB+LS54KtMVzPqgMwpj42YRKv=_=Yjd=M943wJnHFQ@mail.gmail.com>
References: <5377b497-fd20-4269-adc4-0f5498faa758@gmail.com>
 <CALEXWq27kWKrSz=mdRXZf021ZLu4_3nhyPnDssSAq3Ud=8vMug@mail.gmail.com>
 <da712bfc-ef8f-925d-7b07-ca1287012472@gmail.com>
 <CAPPM_gSvYB+LS54KtMVzPqgMwpj42YRKv=_=Yjd=M943wJnHFQ@mail.gmail.com>
Message-ID: <a8d5546b-6c1b-1f0d-45ff-1dff2f030688@gmail.com>



On 2019-08-04 6:08 p.m., Joshua Ulrich wrote:
> On Sun, Aug 4, 2019 at 4:54 PM Ben Bolker <bbolker at gmail.com> wrote:
>>
>> On 2019-08-04 5:43 p.m., I?aki Ucar wrote:
>>> On Sun, 4 Aug 2019 at 23:26, Ben Bolker <bbolker at gmail.com> wrote:
>>>>
>>>>
>>>>   I'm having some trouble with travis builds of a package (local checks
>>>> work fine) and hoping if I can get suggestions for diagnosis &
>>>> troubleshooting ...
>>>>
>>>> The package is 'broom.mixed'; I hadn't changed it in a while, but
>>>> recently got a minor pull request which seemed reasonable. I believe the
>>>> problems I'm having now are dependency and/or caching problems, not
>>>> actually related to the changes in the package.
>>>>
>>>> The failing build is here
>>>>
>>>> https://travis-ci.org/bbolker/broom.mixed/builds/567597217
>>>
>>> I see various "package x was installed by an R version with different
>>> internals; it needs to be reinstalled for use with this R version".
>>>
>>> Top of the page, right side, you should see More options > Caches. Try
>>> removing them and restart the build.
>>>
>>> I?aki
>>
>>   I tried that already, thanks.  That's why I'm now suspecting it's some
>> kind of mismatch between the Rutter PPAs and the default (?) repos that
>> Travis uses.  It would be a little painful, but I could edit out the
>> rstan dependency and try the builds with and without Rutter's PPA to
>> test that hypothesis ...
>>
> Try changing:
> sudo add-apt-repository -y "ppa:marutter/rrutter"
> sudo add-apt-repository -y "ppa:marutter/c2d4u"
> to:
> sudo add-apt-repository -y "ppa:marutter/rrutter3.5"
> sudo add-apt-repository -y "ppa:marutter/c2d4u3.5"
> 
> The R C API changed between R-3.4.x and R-3.5.x, which created
> incompatibility in packages installed using different versions.  Any R
>> 3.6.x should use the "ppa:*3.5" PPAs.
> 
> 
>>   cheers
>>     Ben Bolker
>>
>>

  Aha! That sounds like it might be the right answer.  I almost tried
it, but I thought that the non-specifically tagged PPA
(ppa:marutter/c2d4u) was *post*-3.5 instead of *pre*-3.5 (and that
therefore it wouldn't help since I'm building on r-release (3.6) and
r-devel (3.x) ...)

  cheers
    Ben Bolker



>>
>>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> 
>


From |uc@r @end|ng |rom |edor@project@org  Mon Aug  5 00:13:46 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Mon, 5 Aug 2019 00:13:46 +0200
Subject: [R-pkg-devel] help troubleshooting travis-ci issues?
In-Reply-To: <0b217f5a-70a2-a957-fc50-5686d4d55680@gmail.com>
References: <5377b497-fd20-4269-adc4-0f5498faa758@gmail.com>
 <CALEXWq27kWKrSz=mdRXZf021ZLu4_3nhyPnDssSAq3Ud=8vMug@mail.gmail.com>
 <da712bfc-ef8f-925d-7b07-ca1287012472@gmail.com>
 <CALEXWq3d-Gy72Ghpt1v2furdTbCO62ms=ErS64z0LBJKOunWCg@mail.gmail.com>
 <0b217f5a-70a2-a957-fc50-5686d4d55680@gmail.com>
Message-ID: <CALEXWq09N2cT+cvZAJiPAPj8y3vM2vZMnqhcryWLEftUNx2n9Q@mail.gmail.com>

On Mon, 5 Aug 2019 at 00:08, Ben Bolker <bbolker at gmail.com> wrote:
>
>
>   Yeah, I might try that, or I might try installing the downstream
> packages that are causing problems from Rutter's repo.

AFAICT from the build log, the packages that are causing problems are
being installed precisely from Rutter's repo:

Get:7 http://ppa.launchpad.net/marutter/c2d4u/ubuntu xenial/main amd64
r-cran-ps amd64 1.3.0-1cran1ppa0 [149 kB]
Get:20 http://ppa.launchpad.net/marutter/c2d4u/ubuntu xenial/main
amd64 r-cran-fansi amd64 0.4.0-1cran1ppa0 [133 kB]
Get:42 http://ppa.launchpad.net/marutter/c2d4u/ubuntu xenial/main
amd64 r-cran-scales amd64 1.0.0-1cran1ppa0 [422 kB]

but not from c2d4u3.5.

I?aki


From edd @end|ng |rom deb|@n@org  Mon Aug  5 01:05:01 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sun, 4 Aug 2019 18:05:01 -0500
Subject: [R-pkg-devel] help troubleshooting travis-ci issues?
In-Reply-To: <CALEXWq09N2cT+cvZAJiPAPj8y3vM2vZMnqhcryWLEftUNx2n9Q@mail.gmail.com>
References: <5377b497-fd20-4269-adc4-0f5498faa758@gmail.com>
 <CALEXWq27kWKrSz=mdRXZf021ZLu4_3nhyPnDssSAq3Ud=8vMug@mail.gmail.com>
 <da712bfc-ef8f-925d-7b07-ca1287012472@gmail.com>
 <CALEXWq3d-Gy72Ghpt1v2furdTbCO62ms=ErS64z0LBJKOunWCg@mail.gmail.com>
 <0b217f5a-70a2-a957-fc50-5686d4d55680@gmail.com>
 <CALEXWq09N2cT+cvZAJiPAPj8y3vM2vZMnqhcryWLEftUNx2n9Q@mail.gmail.com>
Message-ID: <23879.25757.9311.287528@rob.eddelbuettel.com>


On 5 August 2019 at 00:13, I?aki Ucar wrote:
| On Mon, 5 Aug 2019 at 00:08, Ben Bolker <bbolker at gmail.com> wrote:
| >
| >
| >   Yeah, I might try that, or I might try installing the downstream
| > packages that are causing problems from Rutter's repo.
| 
| AFAICT from the build log, the packages that are causing problems are
| being installed precisely from Rutter's repo:
| 
| Get:7 http://ppa.launchpad.net/marutter/c2d4u/ubuntu xenial/main amd64
| r-cran-ps amd64 1.3.0-1cran1ppa0 [149 kB]
| Get:20 http://ppa.launchpad.net/marutter/c2d4u/ubuntu xenial/main
| amd64 r-cran-fansi amd64 0.4.0-1cran1ppa0 [133 kB]
| Get:42 http://ppa.launchpad.net/marutter/c2d4u/ubuntu xenial/main
| amd64 r-cran-scales amd64 1.0.0-1cran1ppa0 [422 kB]
| 
| but not from c2d4u3.5.

Yes, and that is the problem just like Josh said. We want '3.5' (or greater),
not '3.4'.  Ie in r-travis (which is what use for my packages) I have

BootstrapLinux() {
    # Set up our CRAN mirror.
    if [[ "${R_VERSION}" == "3.5" ]]; then
        sudo add-apt-repository "deb ${CRAN}/bin/linux/ubuntu $(lsb_release -cs)-cran35/"
    elif [[ "${R_VERSION}" == "3.4" ]]; then
        sudo add-apt-repository "deb ${CRAN}/bin/linux/ubuntu $(lsb_release -cs)/"
    fi
    sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9

    # Add marutter's c2d4u repository.
    if [[ "${R_VERSION}" == "3.5" ]]; then
        sudo add-apt-repository -y "ppa:marutter/rrutter3.5"
        sudo add-apt-repository -y "ppa:marutter/c2d4u3.5"
    elif [[ "${R_VERSION}" == "3.4" ]]; then
        sudo add-apt-repository -y "ppa:marutter/rrutter"
        sudo add-apt-repository -y "ppa:marutter/c2d4u"
    fi


Cf https://github.com/eddelbuettel/r-travis/blob/master/run.sh#L96-L112 

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From bbo|ker @end|ng |rom gm@||@com  Mon Aug  5 01:09:33 2019
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 4 Aug 2019 19:09:33 -0400
Subject: [R-pkg-devel] help troubleshooting travis-ci issues?
In-Reply-To: <23879.25757.9311.287528@rob.eddelbuettel.com>
References: <5377b497-fd20-4269-adc4-0f5498faa758@gmail.com>
 <CALEXWq27kWKrSz=mdRXZf021ZLu4_3nhyPnDssSAq3Ud=8vMug@mail.gmail.com>
 <da712bfc-ef8f-925d-7b07-ca1287012472@gmail.com>
 <CALEXWq3d-Gy72Ghpt1v2furdTbCO62ms=ErS64z0LBJKOunWCg@mail.gmail.com>
 <0b217f5a-70a2-a957-fc50-5686d4d55680@gmail.com>
 <CALEXWq09N2cT+cvZAJiPAPj8y3vM2vZMnqhcryWLEftUNx2n9Q@mail.gmail.com>
 <23879.25757.9311.287528@rob.eddelbuettel.com>
Message-ID: <c763a6c8-140d-d529-566f-1abec9cb7be6@gmail.com>

  Thanks everyone!  Passes now.

On 2019-08-04 7:05 p.m., Dirk Eddelbuettel wrote:
> 
> On 5 August 2019 at 00:13, I?aki Ucar wrote:
> | On Mon, 5 Aug 2019 at 00:08, Ben Bolker <bbolker at gmail.com> wrote:
> | >
> | >
> | >   Yeah, I might try that, or I might try installing the downstream
> | > packages that are causing problems from Rutter's repo.
> | 
> | AFAICT from the build log, the packages that are causing problems are
> | being installed precisely from Rutter's repo:
> | 
> | Get:7 http://ppa.launchpad.net/marutter/c2d4u/ubuntu xenial/main amd64
> | r-cran-ps amd64 1.3.0-1cran1ppa0 [149 kB]
> | Get:20 http://ppa.launchpad.net/marutter/c2d4u/ubuntu xenial/main
> | amd64 r-cran-fansi amd64 0.4.0-1cran1ppa0 [133 kB]
> | Get:42 http://ppa.launchpad.net/marutter/c2d4u/ubuntu xenial/main
> | amd64 r-cran-scales amd64 1.0.0-1cran1ppa0 [422 kB]
> | 
> | but not from c2d4u3.5.
> 
> Yes, and that is the problem just like Josh said. We want '3.5' (or greater),
> not '3.4'.  Ie in r-travis (which is what use for my packages) I have
> 
> BootstrapLinux() {
>     # Set up our CRAN mirror.
>     if [[ "${R_VERSION}" == "3.5" ]]; then
>         sudo add-apt-repository "deb ${CRAN}/bin/linux/ubuntu $(lsb_release -cs)-cran35/"
>     elif [[ "${R_VERSION}" == "3.4" ]]; then
>         sudo add-apt-repository "deb ${CRAN}/bin/linux/ubuntu $(lsb_release -cs)/"
>     fi
>     sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9
> 
>     # Add marutter's c2d4u repository.
>     if [[ "${R_VERSION}" == "3.5" ]]; then
>         sudo add-apt-repository -y "ppa:marutter/rrutter3.5"
>         sudo add-apt-repository -y "ppa:marutter/c2d4u3.5"
>     elif [[ "${R_VERSION}" == "3.4" ]]; then
>         sudo add-apt-repository -y "ppa:marutter/rrutter"
>         sudo add-apt-repository -y "ppa:marutter/c2d4u"
>     fi
> 
> 
> Cf https://github.com/eddelbuettel/r-travis/blob/master/run.sh#L96-L112 
> 
> Dirk


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon Aug  5 16:31:40 2019
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 5 Aug 2019 16:31:40 +0200
Subject: [R-pkg-devel] CRAN incoming queue closed from Aug 09 to Aug 18
Message-ID: <31ce6309-53e3-94b6-041e-4fb95a971683@statistik.tu-dortmund.de>

Dear package developers,

the CRAN incoming queue will be closed from Aug 09, 2019 to Aug 18, 
2019. Hence package submissions are only possible before and after that
period.

CRAN maintainance work and some work on a possibly forthcoming Windows 
toolchain will be pushed forward.

Best,
Uwe Ligges
(for the CRAN team)


From roy@mende|@@ohn @end|ng |rom no@@@gov  Mon Aug  5 16:51:07 2019
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Mon, 5 Aug 2019 07:51:07 -0700
Subject: [R-pkg-devel] Finding UTF character in  .RData file
Message-ID: <B2DDC8E6-0373-466D-BADA-EA50DED4448B@noaa.gov>

Hi All:

The recent nighty CRAN checks on one of my packages reports:

Check: data for non-ASCII characters 
Result: NOTE 
     Note: found 1 marked UTF-8 string 

When  originally submitted this was not the case.  All my data files are .RData files,  and even more so most are binary data.  If they were text files I could readily scan for UTF,  is there a way once I read the data into R to do a similar scan from within R.  I just ran the most recent  (Github) version of devtools::check() and it doesn't report an error.  Or is there a way I can get more specific information from the CRAN nightly build or Rhub or the like?

Thanks,

-ROy

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Aug  5 17:50:22 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 5 Aug 2019 11:50:22 -0400
Subject: [R-pkg-devel] Finding UTF character in .RData file
In-Reply-To: <B2DDC8E6-0373-466D-BADA-EA50DED4448B@noaa.gov>
References: <B2DDC8E6-0373-466D-BADA-EA50DED4448B@noaa.gov>
Message-ID: <4b01d47c-32c1-28d8-e167-aae35224d630@gmail.com>

On 05/08/2019 10:51 a.m., Roy Mendelssohn - NOAA Federal via 
R-package-devel wrote:
> Hi All:
> 
> The recent nighty CRAN checks on one of my packages reports:
> 
> Check: data for non-ASCII characters
> Result: NOTE
>       Note: found 1 marked UTF-8 string
> 
> When  originally submitted this was not the case.  All my data files are .RData files,  and even more so most are binary data.  If they were text files I could readily scan for UTF,  is there a way once I read the data into R to do a similar scan from within R.  I just ran the most recent  (Github) version of devtools::check() and it doesn't report an error.  Or is there a way I can get more specific information from the CRAN nightly build or Rhub or the like?

That message comes when the tools:::.check_package_datasets function 
detects a string containing a UTF-8 encoding.  You can run it directly 
and you might get a more informative message.  If not, I suppose you 
could fix() it and add some extra debugging messages....

It's argument is "pkgDir"; I think that is the directory holding the 
files after untarring the .tar.gz file.

Duncan Murdoch


From roy@mende|@@ohn @end|ng |rom no@@@gov  Mon Aug  5 17:57:15 2019
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Mon, 5 Aug 2019 08:57:15 -0700
Subject: [R-pkg-devel] Finding UTF character in .RData file
In-Reply-To: <4b01d47c-32c1-28d8-e167-aae35224d630@gmail.com>
References: <B2DDC8E6-0373-466D-BADA-EA50DED4448B@noaa.gov>
 <4b01d47c-32c1-28d8-e167-aae35224d630@gmail.com>
Message-ID: <3757D26A-61EE-4312-8E48-F495E2B354C0@noaa.gov>

Thanks.  What is surprising me is I can't reproduce the error either directly on my Mac or on rhub::windows and I am waiting for the result of win-builder  (I can't check most rhub::linux  because it fails to correctly build a number of required packages,  something I have reported but still persists - like rgdal,  rerddap, crul,  ncdf4).

-Roy
 - 
> On Aug 5, 2019, at 8:50 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 05/08/2019 10:51 a.m., Roy Mendelssohn - NOAA Federal via R-package-devel wrote:
>> Hi All:
>> The recent nighty CRAN checks on one of my packages reports:
>> Check: data for non-ASCII characters
>> Result: NOTE
>>      Note: found 1 marked UTF-8 string
>> When  originally submitted this was not the case.  All my data files are .RData files,  and even more so most are binary data.  If they were text files I could readily scan for UTF,  is there a way once I read the data into R to do a similar scan from within R.  I just ran the most recent  (Github) version of devtools::check() and it doesn't report an error.  Or is there a way I can get more specific information from the CRAN nightly build or Rhub or the like?
> 
> That message comes when the tools:::.check_package_datasets function detects a string containing a UTF-8 encoding.  You can run it directly and you might get a more informative message.  If not, I suppose you could fix() it and add some extra debugging messages....
> 
> It's argument is "pkgDir"; I think that is the directory holding the files after untarring the .tar.gz file.
> 
> Duncan Murdoch

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From roy@mende|@@ohn @end|ng |rom no@@@gov  Mon Aug  5 19:48:01 2019
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Mon, 5 Aug 2019 10:48:01 -0700
Subject: [R-pkg-devel] Finding UTF character in .RData file
In-Reply-To: <3757D26A-61EE-4312-8E48-F495E2B354C0@noaa.gov>
References: <B2DDC8E6-0373-466D-BADA-EA50DED4448B@noaa.gov>
 <4b01d47c-32c1-28d8-e167-aae35224d630@gmail.com>
 <3757D26A-61EE-4312-8E48-F495E2B354C0@noaa.gov>
Message-ID: <EBE9A772-1437-46EC-8457-B910CB5C409E@noaa.gov>

Using tools:::.check_package_datasets() produces the error,  but doesn't give out any more information.  I don't know enough about some fo the write() function.  If I write to csv of some sort,  will this information be preserved?

Thanks,

-Roy


> On Aug 5, 2019, at 8:57 AM, Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
> 
> Thanks.  What is surprising me is I can't reproduce the error either directly on my Mac or on rhub::windows and I am waiting for the result of win-builder  (I can't check most rhub::linux  because it fails to correctly build a number of required packages,  something I have reported but still persists - like rgdal,  rerddap, crul,  ncdf4).
> 
> -Roy
> - 
>> On Aug 5, 2019, at 8:50 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>> 
>> On 05/08/2019 10:51 a.m., Roy Mendelssohn - NOAA Federal via R-package-devel wrote:
>>> Hi All:
>>> The recent nighty CRAN checks on one of my packages reports:
>>> Check: data for non-ASCII characters
>>> Result: NOTE
>>>     Note: found 1 marked UTF-8 string
>>> When  originally submitted this was not the case.  All my data files are .RData files,  and even more so most are binary data.  If they were text files I could readily scan for UTF,  is there a way once I read the data into R to do a similar scan from within R.  I just ran the most recent  (Github) version of devtools::check() and it doesn't report an error.  Or is there a way I can get more specific information from the CRAN nightly build or Rhub or the like?
>> 
>> That message comes when the tools:::.check_package_datasets function detects a string containing a UTF-8 encoding.  You can run it directly and you might get a more informative message.  If not, I suppose you could fix() it and add some extra debugging messages....
>> 
>> It's argument is "pkgDir"; I think that is the directory holding the files after untarring the .tar.gz file.
>> 
>> Duncan Murdoch
> 
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
> 
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected" 
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> 

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From roy@mende|@@ohn @end|ng |rom no@@@gov  Mon Aug  5 20:13:30 2019
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Mon, 5 Aug 2019 11:13:30 -0700
Subject: [R-pkg-devel] Finding UTF character in .RData file
In-Reply-To: <EBE9A772-1437-46EC-8457-B910CB5C409E@noaa.gov>
References: <B2DDC8E6-0373-466D-BADA-EA50DED4448B@noaa.gov>
 <4b01d47c-32c1-28d8-e167-aae35224d630@gmail.com>
 <3757D26A-61EE-4312-8E48-F495E2B354C0@noaa.gov>
 <EBE9A772-1437-46EC-8457-B910CB5C409E@noaa.gov>
Message-ID: <149F75C2-DD42-44B3-BF65-AD2A1E557EF8@noaa.gov>

Okay I found it.  I looked at the code for  tools:::.check_package_datasets(),  took out the core part,  ran every string  I had in every dataset,  it came out.  A degree symbol.

Thanks for telling me about the function.  Still surprised that the test machines don't flag it.  Or is this a new test on CRAN?

-Roy


> On Aug 5, 2019, at 10:48 AM, Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
> 
> Using tools:::.check_package_datasets() produces the error,  but doesn't give out any more information.  I don't know enough about some fo the write() function.  If I write to csv of some sort,  will this information be preserved?
> 
> Thanks,
> 
> -Roy
> 
> 
>> On Aug 5, 2019, at 8:57 AM, Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
>> 
>> Thanks.  What is surprising me is I can't reproduce the error either directly on my Mac or on rhub::windows and I am waiting for the result of win-builder  (I can't check most rhub::linux  because it fails to correctly build a number of required packages,  something I have reported but still persists - like rgdal,  rerddap, crul,  ncdf4).
>> 
>> -Roy
>> - 
>>> On Aug 5, 2019, at 8:50 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>> 
>>> On 05/08/2019 10:51 a.m., Roy Mendelssohn - NOAA Federal via R-package-devel wrote:
>>>> Hi All:
>>>> The recent nighty CRAN checks on one of my packages reports:
>>>> Check: data for non-ASCII characters
>>>> Result: NOTE
>>>>    Note: found 1 marked UTF-8 string
>>>> When  originally submitted this was not the case.  All my data files are .RData files,  and even more so most are binary data.  If they were text files I could readily scan for UTF,  is there a way once I read the data into R to do a similar scan from within R.  I just ran the most recent  (Github) version of devtools::check() and it doesn't report an error.  Or is there a way I can get more specific information from the CRAN nightly build or Rhub or the like?
>>> 
>>> That message comes when the tools:::.check_package_datasets function detects a string containing a UTF-8 encoding.  You can run it directly and you might get a more informative message.  If not, I suppose you could fix() it and add some extra debugging messages....
>>> 
>>> It's argument is "pkgDir"; I think that is the directory holding the files after untarring the .tar.gz file.
>>> 
>>> Duncan Murdoch
>> 
>> **********************
>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>> **********************
>> Roy Mendelssohn
>> Supervisory Operations Research Analyst
>> NOAA/NMFS
>> Environmental Research Division
>> Southwest Fisheries Science Center
>> ***Note new street address***
>> 110 McAllister Way
>> Santa Cruz, CA 95060
>> Phone: (831)-420-3666
>> Fax: (831) 420-3980
>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>> 
>> "Old age and treachery will overcome youth and skill."
>> "From those who have been given much, much will be expected" 
>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>> 
> 
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
> 
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected" 
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> 

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Aug  5 20:52:21 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 5 Aug 2019 14:52:21 -0400
Subject: [R-pkg-devel] Finding UTF character in .RData file
In-Reply-To: <149F75C2-DD42-44B3-BF65-AD2A1E557EF8@noaa.gov>
References: <B2DDC8E6-0373-466D-BADA-EA50DED4448B@noaa.gov>
 <4b01d47c-32c1-28d8-e167-aae35224d630@gmail.com>
 <3757D26A-61EE-4312-8E48-F495E2B354C0@noaa.gov>
 <EBE9A772-1437-46EC-8457-B910CB5C409E@noaa.gov>
 <149F75C2-DD42-44B3-BF65-AD2A1E557EF8@noaa.gov>
Message-ID: <279f7932-6b18-a3ba-8e70-ac13c3ab1ee0@gmail.com>

On 05/08/2019 2:13 p.m., Roy Mendelssohn - NOAA Federal wrote:
> Okay I found it.  I looked at the code for  tools:::.check_package_datasets(),  took out the core part,  ran every string  I had in every dataset,  it came out.  A degree symbol.
> 
> Thanks for telling me about the function.  Still surprised that the test machines don't flag it.  Or is this a new test on CRAN?

I don't think the function is new.  Maybe this part of the testing is new.

Duncan Murdoch


From @ndy@@te|n @end|ng |rom gm@||@com  Tue Aug  6 14:28:24 2019
From: @ndy@@te|n @end|ng |rom gm@||@com (Andy Stein)
Date: Tue, 6 Aug 2019 08:28:24 -0400
Subject: [R-pkg-devel] help understanding two NOTES during the automatic
 package checking
Message-ID: <CAJcj_3U9n_Un8skHY_=dqyuKRAJ4XxV+O+es9C8voadkOYUwvQ@mail.gmail.com>

Hi,

I am submitting my first ever R package to CRAN!  It's almost ready, but I
have two notes below and I do not understand the best way to fix them and I
was looking to get some feedback if anyone had time to help.  I paste the
notes at the end of this email.

   1. The first note seems to be some problem with the description file.
   But I can't understand from the note what the problem even is, can you
help
   me?
   2. The second note at the end is about the existence of some files.
   These files are all created by the example code in the documentation.  I
   suppose I could just mark all these examples as "do not run" and this
will
   fix the note, but from a code development perspective, I thought it would
   be preferable to run these examples during package building as an
   additional test of the package.  Is there any other solution that is
   preferred?  Briefly, the functions creating these examples are functions
   who have the job of producing graphical or tabular output files.  If you
   want to dig into the details, the example code is in the functions
   xgx_annotate_status_png()
   <https://github.com/Novartis/xgxr/blob/master/R/xgx_annotate_status_png.R
>
and
   xgx_save_table()
   <https://github.com/Novartis/xgxr/blob/master/R/xgx_save_table.R>
in the xgxr
   package <https://github.com/Novartis/xgxr>.

Best regards,
Andy

---------- Forwarded message ---------
From: <ligges at statistik.tu-dortmund.de>
Date: Mon, Aug 5, 2019 at 3:41 PM
Subject: [CRAN-pretest-archived] CRAN submission xgxr 1.0.0
To: <andy.stein at gmail.com>
Cc: <CRAN-submissions at r-project.org>


Dear maintainer,

package xgxr_1.0.0.tar.gz does not pass the incoming checks automatically,
please see the following pre-tests:
Windows: <
https://win-builder.r-project.org/incoming_pretest/xgxr_1.0.0_20190805_212431/Windows/00check.log
>
Status: 1 NOTE
Debian: <
https://win-builder.r-project.org/incoming_pretest/xgxr_1.0.0_20190805_212431/Debian/00check.log
>
Status: 2 NOTEs



Please fix all problems and resubmit a fixed version via the webform.
If you are not sure how to fix the problems shown, please ask for help on
the R-package-devel mailing list:
<https://stat.ethz.ch/mailman/listinfo/r-package-devel>
If you are fairly certain the rejection is a false positive, please
reply-all to this message and explain.

More details are given in the directory:
<
https://win-builder.r-project.org/incoming_pretest/xgxr_1.0.0_20190805_212431/
>
The files will be removed after roughly 7 days.

No strong reverse dependencies to be checked.

Best regards,
CRAN teams' auto-check service
Flavor: r-devel-linux-x86_64-debian-gcc, r-devel-windows-ix86+x86_64
Check: CRAN incoming feasibility, Result: NOTE
  Maintainer: 'Andrew Stein <andy.stein at gmail.com>'

  New submission

  License components with restrictions and base license permitting such:
    MIT + file LICENSE
  File 'LICENSE':
    MIT License

    Copyright (c) 2019

    Permission is hereby granted, free of charge, to any person obtaining a
copy
    of this software and associated documentation files (the "Software"),
to deal
    in the Software without restriction, including without limitation the
rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included
in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE
    SOFTWARE.

  Possibly mis-spelled words in DESCRIPTION:
    PKPD (27:19, 35:25)
    Pharmacometrics (2:33)
    xgx (26:18, 31:54)

Flavor: r-devel-linux-x86_64-debian-gcc
Check: for non-standard things in the check directory, Result: NOTE
  Found the following files/directories:
    'Task01_Example.png' 'Unnamed_Table.csv' 'png-example.png'
    'png-example2.png' 'png-example3.png'

	[[alternative HTML version deleted]]


From |uc@r @end|ng |rom |edor@project@org  Tue Aug  6 14:52:56 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Tue, 6 Aug 2019 14:52:56 +0200
Subject: [R-pkg-devel] help understanding two NOTES during the automatic
 package checking
In-Reply-To: <CAJcj_3U9n_Un8skHY_=dqyuKRAJ4XxV+O+es9C8voadkOYUwvQ@mail.gmail.com>
References: <CAJcj_3U9n_Un8skHY_=dqyuKRAJ4XxV+O+es9C8voadkOYUwvQ@mail.gmail.com>
Message-ID: <CALEXWq3XHaNPBrf4D2kpBRNNOWOK3eZy9VA20QuweasKD3j+=Q@mail.gmail.com>

On Tue, 6 Aug 2019 at 14:40, Andy Stein <andy.stein at gmail.com> wrote:
>
> Hi,
>
> I am submitting my first ever R package to CRAN!  It's almost ready, but I
> have two notes below and I do not understand the best way to fix them and I
> was looking to get some feedback if anyone had time to help.  I paste the
> notes at the end of this email.
>
>    1. The first note seems to be some problem with the description file.
>    But I can't understand from the note what the problem even is, can you
> help
>    me?

The MIT license file should contain only the following:

YEAR: <the year(s)>
COPYRIGHT HOLDER: <name(s) of the authors>

as specified in https://www.r-project.org/Licenses/MIT.

>    2. The second note at the end is about the existence of some files.
>    These files are all created by the example code in the documentation.  I
>    suppose I could just mark all these examples as "do not run" and this
> will
>    fix the note, but from a code development perspective, I thought it would
>    be preferable to run these examples during package building as an
>    additional test of the package.  Is there any other solution that is
>    preferred?

Your code is allowed to write files automatically only in the
temporary directory associated with the R session. To fix this, create
temporary files on top of your examples using tempfile() and write
there instead.

I?aki


From ru@@e||-|enth @end|ng |rom u|ow@@edu  Sat Aug 10 19:21:38 2019
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Sat, 10 Aug 2019 17:21:38 +0000
Subject: [R-pkg-devel] Farming out methods to other packages
Message-ID: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>

Dear developers,

I maintain a package, emmeans, that provides post-hoc analyses for a variety of models. These models are supported by writing S3 methods for recover_data and emm_grid. Quite a few models are supported internally in emmeans, but it would really be better if the packages that create model objects would have their own implementations of these methods. 

For example, a hypothetical package, foopkg may be used to fit a model, thereby producing an object of class foo. Currently, emmeans has internal functions recover_data.foo and emm_basis.foo (typically not exported). It would be better if the developer of foopkg would incorporate and export her own recover_data.foo and emm_basis.foo methods, so that those methods can be modified as needed as foopkg is further developed. Once those methods are incorporated in foopkg, then I would remove them from my next update of emmeans. But while they are available in both places, the ones in foopkg should be used.

The problem is that in the short term, recover_data.foo and emm_basis.foo are still present in the namespace of emmeans. And I have found in testing with a fake package that if the user codes, say, emmeans::emmeans(model.foo, "treatment"), the methods internal to emmeans's namespace are always used even when foopkg is attached and its recover_data and emm_basis methods are registered. So the developer of foopkg can't even test her own methods (except by changing the class name of the model object). 

What can be done to facilitate having another developer's methods to override your own? 

Thanks for any advice

Russ

Russell V. Lenth? -? Professor Emeritus
Department of Statistics and Actuarial Science?? 
The University of Iowa ?-? Iowa City, IA 52242? USA?? 
Voice (319)335-0712 (Dept. office)? -? FAX (319)335-3017


From |uc@r @end|ng |rom |edor@project@org  Sat Aug 10 20:09:09 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Sat, 10 Aug 2019 20:09:09 +0200
Subject: [R-pkg-devel] Farming out methods to other packages
In-Reply-To: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
References: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
Message-ID: <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>

On Sat, 10 Aug 2019 at 19:21, Lenth, Russell V <russell-lenth at uiowa.edu> wrote:
>
> Dear developers,
>
> I maintain a package, emmeans, that provides post-hoc analyses for a variety of models. These models are supported by writing S3 methods for recover_data and emm_grid. Quite a few models are supported internally in emmeans, but it would really be better if the packages that create model objects would have their own implementations of these methods.
>
> For example, a hypothetical package, foopkg may be used to fit a model, thereby producing an object of class foo. Currently, emmeans has internal functions recover_data.foo and emm_basis.foo (typically not exported). It would be better if the developer of foopkg would incorporate and export her own recover_data.foo and emm_basis.foo methods, so that those methods can be modified as needed as foopkg is further developed. Once those methods are incorporated in foopkg, then I would remove them from my next update of emmeans. But while they are available in both places, the ones in foopkg should be used.
>
> The problem is that in the short term, recover_data.foo and emm_basis.foo are still present in the namespace of emmeans. And I have found in testing with a fake package that if the user codes, say, emmeans::emmeans(model.foo, "treatment"), the methods internal to emmeans's namespace are always used even when foopkg is attached and its recover_data and emm_basis methods are registered. So the developer of foopkg can't even test her own methods (except by changing the class name of the model object).
>
> What can be done to facilitate having another developer's methods to override your own?

The order of dispatch is meant to ensure that your package can't be
broken by a clash with another one. In other words, if recover_data is
called inside emmeans, emmeans:::recover_data.foo is called, but then
if it's called inside foopkg, then foopkg:::recover_data.foo is called
instead.

This feature, however, plays against your intended use case here, and
I think that the best way to circumvent it is by 1) renaming those
methods (e.g., recover_data_foo, because as soon as there is a
something.foo in your namespace, it will be dispatched regardless of
whether you register it or not), and 2) register them dynamically on
load time if foopkg is not available. There is an implementation for
this available here:
https://github.com/r-lib/vctrs/blob/master/R/register-s3.R

I?aki


From ru@@e||-|enth @end|ng |rom u|ow@@edu  Sat Aug 10 21:11:14 2019
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Sat, 10 Aug 2019 19:11:14 +0000
Subject: [R-pkg-devel] 
 [External] Re: Farming out methods to other packages
In-Reply-To: <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
References: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
Message-ID: <DM6PR04MB4380D9033D754173EF2E157EF1D10@DM6PR04MB4380.namprd04.prod.outlook.com>

Thanks I?aki, 

However...

    > 1) renaming those methods (e.g., recover_data_foo, because as soon as there is a something.foo 
    > in your namespace, it will be dispatched regardless of whether you register it or not)

If I do that, then emmeans won't support foo objects until foopkg offers the methods. My goal is to encourage package developers to replace my existing methods but to support them until that is done.

    > 2) register them dynamically on load time if foopkg is not available. 

Not necessary, as you already stated in (1). (But I do export a '.emm_register()' function that makes it really easy for other package developers to register their methods. It's based on similar code to what you point to.)

Russ

-----Original Message-----
From: I?aki Ucar <iucar at fedoraproject.org> 
Sent: Saturday, August 10, 2019 1:09 PM
To: Lenth, Russell V <russell-lenth at uiowa.edu>
Cc: r-package-devel at r-project.org
Subject: [External] Re: [R-pkg-devel] Farming out methods to other packages

On Sat, 10 Aug 2019 at 19:21, Lenth, Russell V <russell-lenth at uiowa.edu> wrote:
>
> Dear developers,
>
> I maintain a package, emmeans, that provides post-hoc analyses for a variety of models. These models are supported by writing S3 methods for recover_data and emm_grid. Quite a few models are supported internally in emmeans, but it would really be better if the packages that create model objects would have their own implementations of these methods.
>
> For example, a hypothetical package, foopkg may be used to fit a model, thereby producing an object of class foo. Currently, emmeans has internal functions recover_data.foo and emm_basis.foo (typically not exported). It would be better if the developer of foopkg would incorporate and export her own recover_data.foo and emm_basis.foo methods, so that those methods can be modified as needed as foopkg is further developed. Once those methods are incorporated in foopkg, then I would remove them from my next update of emmeans. But while they are available in both places, the ones in foopkg should be used.
>
> The problem is that in the short term, recover_data.foo and emm_basis.foo are still present in the namespace of emmeans. And I have found in testing with a fake package that if the user codes, say, emmeans::emmeans(model.foo, "treatment"), the methods internal to emmeans's namespace are always used even when foopkg is attached and its recover_data and emm_basis methods are registered. So the developer of foopkg can't even test her own methods (except by changing the class name of the model object).
>
> What can be done to facilitate having another developer's methods to override your own?

The order of dispatch is meant to ensure that your package can't be broken by a clash with another one. In other words, if recover_data is called inside emmeans, emmeans:::recover_data.foo is called, but then if it's called inside foopkg, then foopkg:::recover_data.foo is called instead.

This feature, however, plays against your intended use case here, and I think that the best way to circumvent it is by 1) renaming those methods (e.g., recover_data_foo, because as soon as there is a something.foo in your namespace, it will be dispatched regardless of whether you register it or not), and 2) register them dynamically on load time if foopkg is not available. There is an implementation for this available here:
https://github.com/r-lib/vctrs/blob/master/R/register-s3.R

I?aki

From ru@@e||-|enth @end|ng |rom u|ow@@edu  Sat Aug 10 21:27:17 2019
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Sat, 10 Aug 2019 19:27:17 +0000
Subject: [R-pkg-devel] 
 [External] Re: Farming out methods to other packages
In-Reply-To: <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
References: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
Message-ID: <DM6PR04MB438001A49FD769AAC54982A1F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>

Hmmmm, I thought of an approach -- a kind of manual dispatch technique. My generic is

recover_data <- function(object, ...) {
    rd <- try(getS3method("recover_data", class(object)[1], envir = .GlobalEnv, silent = TRUE))
    if (!inherits(rd, "try-error"))
        rd(object, ...)
    else
        UseMethod("recover_data")
}

and similar for emm_basis. The idea is it tries to find the method among globally registered ones, and if so, it uses it; otherwise, the internal one is used.

Comments? This does seem to add some overhead, but maybe not too unreasonably much.

Russ


From ru@@e||-|enth @end|ng |rom u|ow@@edu  Sat Aug 10 21:30:30 2019
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Sat, 10 Aug 2019 19:30:30 +0000
Subject: [R-pkg-devel] 
 [External] Re: Farming out methods to other packages
In-Reply-To: <CAN--Dz13S0NOEqO_=2Lh2-qa6xsQ88qLrhZW=NprnvD=k2bMMg@mail.gmail.com>
References: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
 <DM6PR04MB4380D9033D754173EF2E157EF1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <CAN--Dz13S0NOEqO_=2Lh2-qa6xsQ88qLrhZW=NprnvD=k2bMMg@mail.gmail.com>
Message-ID: <DM6PR04MB438051882522F96164CB8D36F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>

Thanks, Neonira. Always something new to learn!

Russ

From: neonira Arinoem <neonira at gmail.com>
Sent: Saturday, August 10, 2019 2:22 PM
To: Lenth, Russell V <russell-lenth at uiowa.edu>
Cc: I?aki Ucar <iucar at fedoraproject.org>; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] [External] Re: Farming out methods to other packages

What about turning your S3 class into a R6 class. That way, the methods you provide can be overridden easily by other developers by creating a class that inherits from yours.

This is standard oop, as opposed to special R S3 oop.
Neonira


	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Aug 10 21:42:32 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 10 Aug 2019 15:42:32 -0400
Subject: [R-pkg-devel] 
 [External] Re: Farming out methods to other packages
In-Reply-To: <DM6PR04MB438001A49FD769AAC54982A1F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
References: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
 <DM6PR04MB438001A49FD769AAC54982A1F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
Message-ID: <caf10487-1881-9a46-8492-6b27962f8bc3@gmail.com>

On 10/08/2019 3:27 p.m., Lenth, Russell V wrote:
> Hmmmm, I thought of an approach -- a kind of manual dispatch technique. My generic is
> 
> recover_data <- function(object, ...) {
>      rd <- try(getS3method("recover_data", class(object)[1], envir = .GlobalEnv, silent = TRUE))
>      if (!inherits(rd, "try-error"))
>          rd(object, ...)
>      else
>          UseMethod("recover_data")
> }
> 
> and similar for emm_basis. The idea is it tries to find the method among globally registered ones, and if so, it uses it; otherwise, the internal one is used.

That's a bad test:  class(object) might be a vector c("nomethod", 
"hasmethod").  You're only looking for recover_data.nomethod, and maybe 
only recover_data.hasmethod exists.

The getS3method() function won't automatically iterate through the 
class, you'll need to do that yourself, for example

S3methodOrDefault <- function(object, generic, default) {
   for (c in class(object)) {
     rd <- try(getS3method(generic, c, envir = .GlobalEnv, silent = TRUE))
     if (!inherits(rd, "try-error"))
       return(rd)
   }
   return(default)
}

used as

   S3methodOrDefault(object, "recover_data", internal_recover_data)

Duncan Murdoch


From ru@@e||-|enth @end|ng |rom u|ow@@edu  Sat Aug 10 22:00:01 2019
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Sat, 10 Aug 2019 20:00:01 +0000
Subject: [R-pkg-devel] 
 [External] Re: Farming out methods to other packages
In-Reply-To: <caf10487-1881-9a46-8492-6b27962f8bc3@gmail.com>
References: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
 <DM6PR04MB438001A49FD769AAC54982A1F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <caf10487-1881-9a46-8492-6b27962f8bc3@gmail.com>
Message-ID: <DM6PR04MB43803C0A9E890DF00F464A3AF1D10@DM6PR04MB4380.namprd04.prod.outlook.com>

Thanks, Duncan. That's helpful.

In addition, I confess I had a closing parenthesis in the wrong place.
    Should be:    . . .   .GlobalEnv), silent = TRUE)

Cheers,

Russ

-----Original Message-----
From: Duncan Murdoch <murdoch.duncan at gmail.com> 
Sent: Saturday, August 10, 2019 2:43 PM
To: Lenth, Russell V <russell-lenth at uiowa.edu>; I?aki Ucar <iucar at fedoraproject.org>
Cc: r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] [External] Re: Farming out methods to other packages

On 10/08/2019 3:27 p.m., Lenth, Russell V wrote:
> Hmmmm, I thought of an approach -- a kind of manual dispatch 
> technique. My generic is
> 
> recover_data <- function(object, ...) {
>      rd <- try(getS3method("recover_data", class(object)[1], envir = .GlobalEnv, silent = TRUE))
>      if (!inherits(rd, "try-error"))
>          rd(object, ...)
>      else
>          UseMethod("recover_data")
> }
> 
> and similar for emm_basis. The idea is it tries to find the method among globally registered ones, and if so, it uses it; otherwise, the internal one is used.

That's a bad test:  class(object) might be a vector c("nomethod", "hasmethod").  You're only looking for recover_data.nomethod, and maybe only recover_data.hasmethod exists.

The getS3method() function won't automatically iterate through the class, you'll need to do that yourself, for example

S3methodOrDefault <- function(object, generic, default) {
   for (c in class(object)) {
     rd <- try(getS3method(generic, c, envir = .GlobalEnv, silent = TRUE))
     if (!inherits(rd, "try-error"))
       return(rd)
   }
   return(default)
}

used as

   S3methodOrDefault(object, "recover_data", internal_recover_data)

Duncan Murdoch


From |uke-t|erney @end|ng |rom u|ow@@edu  Sat Aug 10 22:14:50 2019
From: |uke-t|erney @end|ng |rom u|ow@@edu (Tierney, Luke)
Date: Sat, 10 Aug 2019 20:14:50 +0000
Subject: [R-pkg-devel] 
 [External] Re: Farming out methods to other packages
In-Reply-To: <DM6PR04MB43803C0A9E890DF00F464A3AF1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
References: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
 <DM6PR04MB438001A49FD769AAC54982A1F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <caf10487-1881-9a46-8492-6b27962f8bc3@gmail.com>
 <DM6PR04MB43803C0A9E890DF00F464A3AF1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
Message-ID: <alpine.DEB.2.21.1908101510140.4160@luke-Latitude-7480>

You could have your default method handle the cases you can handle; if
you want that to dispatch you can use something like

recover_data.default <- function(object, ...)
     default_recover_data(object, ...)
default_recover_data <- function(object, ...)
     UseMethod("default_recover_data")

Best,

luke

On Sat, 10 Aug 2019, Lenth, Russell V wrote:

> Thanks, Duncan. That's helpful.
>
> In addition, I confess I had a closing parenthesis in the wrong place.
>    Should be:    . . .   .GlobalEnv), silent = TRUE)
>
> Cheers,
>
> Russ
>
> -----Original Message-----
> From: Duncan Murdoch <murdoch.duncan at gmail.com>
> Sent: Saturday, August 10, 2019 2:43 PM
> To: Lenth, Russell V <russell-lenth at uiowa.edu>; I?aki Ucar <iucar at fedoraproject.org>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] [External] Re: Farming out methods to other packages
>
> On 10/08/2019 3:27 p.m., Lenth, Russell V wrote:
>> Hmmmm, I thought of an approach -- a kind of manual dispatch
>> technique. My generic is
>>
>> recover_data <- function(object, ...) {
>>      rd <- try(getS3method("recover_data", class(object)[1], envir = .GlobalEnv, silent = TRUE))
>>      if (!inherits(rd, "try-error"))
>>          rd(object, ...)
>>      else
>>          UseMethod("recover_data")
>> }
>>
>> and similar for emm_basis. The idea is it tries to find the method among globally registered ones, and if so, it uses it; otherwise, the internal one is used.
>
> That's a bad test:  class(object) might be a vector c("nomethod", "hasmethod").  You're only looking for recover_data.nomethod, and maybe only recover_data.hasmethod exists.
>
> The getS3method() function won't automatically iterate through the class, you'll need to do that yourself, for example
>
> S3methodOrDefault <- function(object, generic, default) {
>   for (c in class(object)) {
>     rd <- try(getS3method(generic, c, envir = .GlobalEnv, silent = TRUE))
>     if (!inherits(rd, "try-error"))
>       return(rd)
>   }
>   return(default)
> }
>
> used as
>
>   S3methodOrDefault(object, "recover_data", internal_recover_data)
>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Luke Tierney
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:   luke-tierney at uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From ru@@e||-|enth @end|ng |rom u|ow@@edu  Sat Aug 10 22:26:46 2019
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Sat, 10 Aug 2019 20:26:46 +0000
Subject: [R-pkg-devel] 
 [External] Re: Farming out methods to other packages
In-Reply-To: <alpine.DEB.2.21.1908101510140.4160@luke-Latitude-7480>
References: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
 <DM6PR04MB438001A49FD769AAC54982A1F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <caf10487-1881-9a46-8492-6b27962f8bc3@gmail.com>
 <DM6PR04MB43803C0A9E890DF00F464A3AF1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <alpine.DEB.2.21.1908101510140.4160@luke-Latitude-7480>
Message-ID: <DM6PR04MB4380095D97FF1782BE0EAAD3F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>

Thanks, Luke. 

That's more efficient for sure. I'd just have to rename about a zillion existing internal methods -- but only once!

Additional advantage I see is ability to control WHICH methods I'd allow to be overridden.

Russ

-----Original Message-----
From: Tierney, Luke <luke-tierney at uiowa.edu> 
Sent: Saturday, August 10, 2019 3:15 PM
To: Lenth, Russell V <russell-lenth at uiowa.edu>
Cc: Duncan Murdoch <murdoch.duncan at gmail.com>; I?aki Ucar <iucar at fedoraproject.org>; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] [External] Re: Farming out methods to other packages

You could have your default method handle the cases you can handle; if you want that to dispatch you can use something like

recover_data.default <- function(object, ...)
     default_recover_data(object, ...)
default_recover_data <- function(object, ...)
     UseMethod("default_recover_data")

Best,

luke

On Sat, 10 Aug 2019, Lenth, Russell V wrote:

> Thanks, Duncan. That's helpful.
>
> In addition, I confess I had a closing parenthesis in the wrong place.
>    Should be:    . . .   .GlobalEnv), silent = TRUE)
>
> Cheers,
>
> Russ
>
> -----Original Message-----
> From: Duncan Murdoch <murdoch.duncan at gmail.com>
> Sent: Saturday, August 10, 2019 2:43 PM
> To: Lenth, Russell V <russell-lenth at uiowa.edu>; I?aki Ucar 
> <iucar at fedoraproject.org>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] [External] Re: Farming out methods to other 
> packages
>
> On 10/08/2019 3:27 p.m., Lenth, Russell V wrote:
>> Hmmmm, I thought of an approach -- a kind of manual dispatch 
>> technique. My generic is
>>
>> recover_data <- function(object, ...) {
>>      rd <- try(getS3method("recover_data", class(object)[1], envir = .GlobalEnv, silent = TRUE))
>>      if (!inherits(rd, "try-error"))
>>          rd(object, ...)
>>      else
>>          UseMethod("recover_data")
>> }
>>
>> and similar for emm_basis. The idea is it tries to find the method among globally registered ones, and if so, it uses it; otherwise, the internal one is used.
>
> That's a bad test:  class(object) might be a vector c("nomethod", "hasmethod").  You're only looking for recover_data.nomethod, and maybe only recover_data.hasmethod exists.
>
> The getS3method() function won't automatically iterate through the 
> class, you'll need to do that yourself, for example
>
> S3methodOrDefault <- function(object, generic, default) {
>   for (c in class(object)) {
>     rd <- try(getS3method(generic, c, envir = .GlobalEnv, silent = TRUE))
>     if (!inherits(rd, "try-error"))
>       return(rd)
>   }
>   return(default)
> }
>
> used as
>
>   S3methodOrDefault(object, "recover_data", internal_recover_data)
>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

--
Luke Tierney
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:   luke-tierney at uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From |uc@r @end|ng |rom |edor@project@org  Sun Aug 11 01:05:11 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Sun, 11 Aug 2019 01:05:11 +0200
Subject: [R-pkg-devel] 
 [External] Re: Farming out methods to other packages
In-Reply-To: <DM6PR04MB4380D9033D754173EF2E157EF1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
References: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
 <DM6PR04MB4380D9033D754173EF2E157EF1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
Message-ID: <CALEXWq2juik1EvWapyYjcnp=Dyw-w9hLh+Q8TV9ifZAFudM+iw@mail.gmail.com>

On Sat, 10 Aug 2019 at 21:11, Lenth, Russell V <russell-lenth at uiowa.edu> wrote:
>
> Thanks I?aki,
>
> However...
>
>     > 1) renaming those methods (e.g., recover_data_foo, because as soon as there is a something.foo
>     > in your namespace, it will be dispatched regardless of whether you register it or not)
>
> If I do that, then emmeans won't support foo objects until foopkg offers the methods. My goal is to encourage package developers to replace my existing methods but to support them until that is done.

A method doesn't need to be named something.foo to register it for foo
objects. You can register any function name as a method for any class
and any generic, thus avoiding the automatic dispatch on these special
names *.foo.

What I'm suggesting is that, in .onLoad, if getS3method returns
something for recover_data and class foo, then that's fine. If not,
you can register you recover_data_foo.

I?aki


From |uc@r @end|ng |rom |edor@project@org  Sun Aug 11 01:14:56 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Sun, 11 Aug 2019 01:14:56 +0200
Subject: [R-pkg-devel] 
 [External] Re: Farming out methods to other packages
In-Reply-To: <alpine.DEB.2.21.1908101510140.4160@luke-Latitude-7480>
References: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
 <DM6PR04MB438001A49FD769AAC54982A1F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <caf10487-1881-9a46-8492-6b27962f8bc3@gmail.com>
 <DM6PR04MB43803C0A9E890DF00F464A3AF1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <alpine.DEB.2.21.1908101510140.4160@luke-Latitude-7480>
Message-ID: <CALEXWq0Od+R25E8HiNgmugGw7yhd1BRfTYOQT9VRDj991Phx+Q@mail.gmail.com>

On Sat, 10 Aug 2019 at 22:14, Tierney, Luke <luke-tierney at uiowa.edu> wrote:
>
> You could have your default method handle the cases you can handle; if
> you want that to dispatch you can use something like
>
> recover_data.default <- function(object, ...)
>      default_recover_data(object, ...)
> default_recover_data <- function(object, ...)
>      UseMethod("default_recover_data")

Indeed, this is probably the cleanest solution. And static. If you are
already using a default method, you can just rename it as
default_recover_data.default.

I?aki


From ru@@e||-|enth @end|ng |rom u|ow@@edu  Sun Aug 11 05:00:50 2019
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Sun, 11 Aug 2019 03:00:50 +0000
Subject: [R-pkg-devel] 
 [External] Re: Farming out methods to other packages
In-Reply-To: <alpine.DEB.2.21.1908101510140.4160@luke-Latitude-7480>
References: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
 <DM6PR04MB438001A49FD769AAC54982A1F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <caf10487-1881-9a46-8492-6b27962f8bc3@gmail.com>
 <DM6PR04MB43803C0A9E890DF00F464A3AF1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <alpine.DEB.2.21.1908101510140.4160@luke-Latitude-7480>
Message-ID: <DM6PR04MB43804DE41B07130AF259768CF1D00@DM6PR04MB4380.namprd04.prod.outlook.com>

All,

I'm going with the previous approach, as modified by Duncan, primarily because I want to keep recover_data.lm and a few others. 
So if I fit a model 'm3' using stanreg::rstanarm:
 
    class(m3)
    [1] "stanreg" "glm"     "lm"      "lmerMod"

Using the setup that Luke suggests, I have a default_recover_data.stanreg() method, but it is not used because it finds the lm method instead of going to recover_data.default. 

Russ

-----Original Message-----
From: Tierney, Luke <luke-tierney at uiowa.edu> 
Sent: Saturday, August 10, 2019 3:15 PM
To: Lenth, Russell V <russell-lenth at uiowa.edu>
Cc: Duncan Murdoch <murdoch.duncan at gmail.com>; I?aki Ucar <iucar at fedoraproject.org>; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] [External] Re: Farming out methods to other packages

You could have your default method handle the cases you can handle; if you want that to dispatch you can use something like

recover_data.default <- function(object, ...)
     default_recover_data(object, ...)
default_recover_data <- function(object, ...)
     UseMethod("default_recover_data")

Best,

luke

    . . .

> -----Original Message-----
> From: Duncan Murdoch <murdoch.duncan at gmail.com>
> Sent: Saturday, August 10, 2019 2:43 PM
> To: Lenth, Russell V <russell-lenth at uiowa.edu>; I?aki Ucar 
> <iucar at fedoraproject.org>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] [External] Re: Farming out methods to other 
> packages
>
> On 10/08/2019 3:27 p.m., Lenth, Russell V wrote:
>> Hmmmm, I thought of an approach -- a kind of manual dispatch 
>> technique. My generic is
>>
>> recover_data <- function(object, ...) {
>>      rd <- try(getS3method("recover_data", class(object)[1], envir = .GlobalEnv), silent = TRUE)
>>      if (!inherits(rd, "try-error"))
>>          rd(object, ...)
>>      else
>>          UseMethod("recover_data")
>> }
>>
>> and similar for emm_basis. The idea is it tries to find the method among globally registered ones, and if so, it uses it; otherwise, the internal one is used.
>
> That's a bad test:  class(object) might be a vector c("nomethod", "hasmethod").  You're only looking for recover_data.nomethod, and maybe only recover_data.hasmethod exists.
>
> The getS3method() function won't automatically iterate through the 
> class, you'll need to do that yourself, for example
>
> S3methodOrDefault <- function(object, generic, default) {
>   for (c in class(object)) {
>     rd <- try(getS3method(generic, c, envir = .GlobalEnv), silent = TRUE)
>     if (!inherits(rd, "try-error"))
>       return(rd)
>   }
>   return(default)
> }
>
> used as
>
>   S3methodOrDefault(object, "recover_data", internal_recover_data)
>
> Duncan Murdoch


From neon|r@ @end|ng |rom gm@||@com  Sat Aug 10 21:22:20 2019
From: neon|r@ @end|ng |rom gm@||@com (neonira Arinoem)
Date: Sat, 10 Aug 2019 21:22:20 +0200
Subject: [R-pkg-devel] 
 [External] Re: Farming out methods to other packages
In-Reply-To: <DM6PR04MB4380D9033D754173EF2E157EF1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
References: <DM6PR04MB4380C0F1C69B4B99804A7341F1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
 <CALEXWq0urMLWJc+tD9pp=wRPFF2GPphfXSOfTBRjo_dy7jsd9g@mail.gmail.com>
 <DM6PR04MB4380D9033D754173EF2E157EF1D10@DM6PR04MB4380.namprd04.prod.outlook.com>
Message-ID: <CAN--Dz13S0NOEqO_=2Lh2-qa6xsQ88qLrhZW=NprnvD=k2bMMg@mail.gmail.com>

What about turning your S3 class into a R6 class. That way, the methods you
provide can be overridden easily by other developers by creating a class
that inherits from yours.

This is standard oop, as opposed to special R S3 oop.
Neonira


Le sam. 10 ao?t 2019 ? 21:11, Lenth, Russell V <russell-lenth at uiowa.edu> a
?crit :

> Thanks I?aki,
>
> However...
>
>     > 1) renaming those methods (e.g., recover_data_foo, because as soon
> as there is a something.foo
>     > in your namespace, it will be dispatched regardless of whether you
> register it or not)
>
> If I do that, then emmeans won't support foo objects until foopkg offers
> the methods. My goal is to encourage package developers to replace my
> existing methods but to support them until that is done.
>
>     > 2) register them dynamically on load time if foopkg is not
> available.
>
> Not necessary, as you already stated in (1). (But I do export a
> '.emm_register()' function that makes it really easy for other package
> developers to register their methods. It's based on similar code to what
> you point to.)
>
> Russ
>
> -----Original Message-----
> From: I?aki Ucar <iucar at fedoraproject.org>
> Sent: Saturday, August 10, 2019 1:09 PM
> To: Lenth, Russell V <russell-lenth at uiowa.edu>
> Cc: r-package-devel at r-project.org
> Subject: [External] Re: [R-pkg-devel] Farming out methods to other packages
>
> On Sat, 10 Aug 2019 at 19:21, Lenth, Russell V <russell-lenth at uiowa.edu>
> wrote:
> >
> > Dear developers,
> >
> > I maintain a package, emmeans, that provides post-hoc analyses for a
> variety of models. These models are supported by writing S3 methods for
> recover_data and emm_grid. Quite a few models are supported internally in
> emmeans, but it would really be better if the packages that create model
> objects would have their own implementations of these methods.
> >
> > For example, a hypothetical package, foopkg may be used to fit a model,
> thereby producing an object of class foo. Currently, emmeans has internal
> functions recover_data.foo and emm_basis.foo (typically not exported). It
> would be better if the developer of foopkg would incorporate and export her
> own recover_data.foo and emm_basis.foo methods, so that those methods can
> be modified as needed as foopkg is further developed. Once those methods
> are incorporated in foopkg, then I would remove them from my next update of
> emmeans. But while they are available in both places, the ones in foopkg
> should be used.
> >
> > The problem is that in the short term, recover_data.foo and
> emm_basis.foo are still present in the namespace of emmeans. And I have
> found in testing with a fake package that if the user codes, say,
> emmeans::emmeans(model.foo, "treatment"), the methods internal to emmeans's
> namespace are always used even when foopkg is attached and its recover_data
> and emm_basis methods are registered. So the developer of foopkg can't even
> test her own methods (except by changing the class name of the model
> object).
> >
> > What can be done to facilitate having another developer's methods to
> override your own?
>
> The order of dispatch is meant to ensure that your package can't be broken
> by a clash with another one. In other words, if recover_data is called
> inside emmeans, emmeans:::recover_data.foo is called, but then if it's
> called inside foopkg, then foopkg:::recover_data.foo is called instead.
>
> This feature, however, plays against your intended use case here, and I
> think that the best way to circumvent it is by 1) renaming those methods
> (e.g., recover_data_foo, because as soon as there is a something.foo in
> your namespace, it will be dispatched regardless of whether you register it
> or not), and 2) register them dynamically on load time if foopkg is not
> available. There is an implementation for this available here:
> https://github.com/r-lib/vctrs/blob/master/R/register-s3.R
>
> I?aki
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From r@turner @end|ng |rom @uck|@nd@@c@nz  Wed Aug 14 07:44:09 2019
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Wed, 14 Aug 2019 17:44:09 +1200
Subject: [R-pkg-devel] Error ... could not find function ...
Message-ID: <93ba857c-8d04-5632-afe4-286b3dfd2799@auckland.ac.nz>


I am encountering an error that I cannot understand in a package that I 
have built (currently just for personal use; not uploaded to CRAN).

In this package ("ldEst") I have a function ldFit() which calls the 
function brm() from the brms package.  The function brm() makes heavy 
use of the Rcpp package.

When I invoke ldFit() (in the appropriate manner) it duly calls brm() 
and issues messages

> Compiling the C++ model

(this takes a while) and then

> Start sampling

immediately after which it issues the error message:

> Error in cpp_object_initializer(.self, .refClassDef, ...) : 
>   could not find function "cpp_object_initializer"

The function cpp_object_initializer() is to be found in the Rcpp 
package.  I have import("Rcpp") in the NAMESPACE file for "ldEst"
which I thought would make everything from Rcpp available --- but 
apparently not.

If I put a browser() into ldFit(), just before the call to brm(), I
can access cpp_object_initializer() from the browser() prompt.  So why 
cannot brm() access this function?

An irksome aspect to all this is that "*it used to work*".  I haven't 
invoked ldFit() in such a way that brm() gets called upon, for quite 
some time.  But the *last* time (some months ago) that I did so, it 
worked just fine.  Something has changed in the intervening months!

Can anyone suggest how I might solve this conundrum[1] ?  Do I need to
say something other than import("Rcpp") in my NAMESPACE file?  What else
can I try?

Thanks for any insights.

[1] Not to be confused with a birth control device.

cheers,

Rolf Turner

P.S.  I could probably, with a bit of effort, put together a toy package 
that would yield a reprex, if this is deemed necessary.

R. T.

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From edd @end|ng |rom deb|@n@org  Wed Aug 14 10:30:20 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 14 Aug 2019 03:30:20 -0500
Subject: [R-pkg-devel] Error ... could not find function ...
In-Reply-To: <93ba857c-8d04-5632-afe4-286b3dfd2799@auckland.ac.nz>
References: <93ba857c-8d04-5632-afe4-286b3dfd2799@auckland.ac.nz>
Message-ID: <23891.50844.475776.291305@rob.eddelbuettel.com>


On 14 August 2019 at 17:44, Rolf Turner wrote:
| > Error in cpp_object_initializer(.self, .refClassDef, ...) : 
| >   could not find function "cpp_object_initializer"

This can happen when a package using Rcpp Modules is not fully loaded. While
I am not familiar with eiher package here, try `import(brms)` and / or
`importFrom(...)` for a particular routine.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From r@turner @end|ng |rom @uck|@nd@@c@nz  Wed Aug 14 10:44:37 2019
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Wed, 14 Aug 2019 20:44:37 +1200
Subject: [R-pkg-devel] Error ... could not find function ...
In-Reply-To: <23891.50844.475776.291305@rob.eddelbuettel.com>
References: <93ba857c-8d04-5632-afe4-286b3dfd2799@auckland.ac.nz>
 <23891.50844.475776.291305@rob.eddelbuettel.com>
Message-ID: <65baad6a-5c50-28ce-901e-27c9ef637402@auckland.ac.nz>

On 14/08/19 8:30 PM, Dirk Eddelbuettel wrote:
> 
> On 14 August 2019 at 17:44, Rolf Turner wrote:
> | > Error in cpp_object_initializer(.self, .refClassDef, ...) :
> | >   could not find function "cpp_object_initializer"
> 
> This can happen when a package using Rcpp Modules is not fully loaded. While
> I am not familiar with eiher package here, try `import(brms)` and / or
> `importFrom(...)` for a particular routine.

Thanks.  I'll experiment with those ideas.

cheers,

Rolf


-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From john@m@h@rro|d @end|ng |rom gm@||@com  Tue Aug 20 00:13:00 2019
From: john@m@h@rro|d @end|ng |rom gm@||@com (John Harrold)
Date: Mon, 19 Aug 2019 15:13:00 -0700
Subject: [R-pkg-devel] Misspelled words in DESCRIPTION
Message-ID: <CANAiAiXvg-1XCtXKncBDAFtgHL9i66JcN3i_zgo3v5mJU9WoSA@mail.gmail.com>

Hello,

I am attempting to submit my first package to CRAN. I believe I've
successfully gotten rid of all the notes, but there is one that I'm unable
to eliminate. In the DESCRIPTION file in both the Title and Description
fields I use the term PKPD. This stands for Pharmacokinetics and
Pharmacodynamics. It seems that none of these are recognized as words that
are spelled correctly. They are kind of important in the context of the
package and there are no other better or more accurate descriptors that I
can use.

Is there a way to get around this?

-- 
Thanks,
John
:wq

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Tue Aug 20 00:18:54 2019
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Tue, 20 Aug 2019 00:18:54 +0200
Subject: [R-pkg-devel] Misspelled words in DESCRIPTION
In-Reply-To: <CANAiAiXvg-1XCtXKncBDAFtgHL9i66JcN3i_zgo3v5mJU9WoSA@mail.gmail.com>
References: <CANAiAiXvg-1XCtXKncBDAFtgHL9i66JcN3i_zgo3v5mJU9WoSA@mail.gmail.com>
Message-ID: <e86f05eb-ca08-5267-fedc-f49375420898@statistik.tu-dortmund.de>

Simply submit as it is, false positives in spell checks will be 
confirmed in the submission process by a CRAN team member when they 
appear the first time in the package.

Best,
Uwe Ligges



On 20.08.2019 00:13, John Harrold wrote:
> Hello,
> 
> I am attempting to submit my first package to CRAN. I believe I've
> successfully gotten rid of all the notes, but there is one that I'm unable
> to eliminate. In the DESCRIPTION file in both the Title and Description
> fields I use the term PKPD. This stands for Pharmacokinetics and
> Pharmacodynamics. It seems that none of these are recognized as words that
> are spelled correctly. They are kind of important in the context of the
> package and there are no other better or more accurate descriptors that I
> can use.
> 
> Is there a way to get around this?
>


From bbo|ker @end|ng |rom gm@||@com  Tue Aug 20 00:20:28 2019
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Mon, 19 Aug 2019 18:20:28 -0400
Subject: [R-pkg-devel] Misspelled words in DESCRIPTION
In-Reply-To: <CANAiAiXvg-1XCtXKncBDAFtgHL9i66JcN3i_zgo3v5mJU9WoSA@mail.gmail.com>
References: <CANAiAiXvg-1XCtXKncBDAFtgHL9i66JcN3i_zgo3v5mJU9WoSA@mail.gmail.com>
Message-ID: <3e94067b-cb0a-4c09-f93c-74449db2287e@gmail.com>


  I suspect the NOTE said something about "*possibly* misspelled words"
(emphasis added). This should be OK; just put the explanation below in
your notes to CRAN about the submission, clarifying that this is indeed
a false positive.

  cheers
    Ben Bolker

On 2019-08-19 6:13 p.m., John Harrold wrote:
> Hello,
> 
> I am attempting to submit my first package to CRAN. I believe I've
> successfully gotten rid of all the notes, but there is one that I'm unable
> to eliminate. In the DESCRIPTION file in both the Title and Description
> fields I use the term PKPD. This stands for Pharmacokinetics and
> Pharmacodynamics. It seems that none of these are recognized as words that
> are spelled correctly. They are kind of important in the context of the
> package and there are no other better or more accurate descriptors that I
> can use.
> 
> Is there a way to get around this?
>


From john@m@h@rro|d @end|ng |rom gm@||@com  Tue Aug 20 00:42:21 2019
From: john@m@h@rro|d @end|ng |rom gm@||@com (John Harrold)
Date: Mon, 19 Aug 2019 15:42:21 -0700
Subject: [R-pkg-devel] Misspelled words in DESCRIPTION
In-Reply-To: <3e94067b-cb0a-4c09-f93c-74449db2287e@gmail.com>
References: <CANAiAiXvg-1XCtXKncBDAFtgHL9i66JcN3i_zgo3v5mJU9WoSA@mail.gmail.com>
 <3e94067b-cb0a-4c09-f93c-74449db2287e@gmail.com>
Message-ID: <CANAiAiV0Fny6DcJ2f9WFahMLcMvJE1+KpJzZFWEBGrMiooVW4g@mail.gmail.com>

Yeah that's it. Thanks Uwe and Ben.

On Mon, Aug 19, 2019 at 3:21 PM Ben Bolker <bbolker at gmail.com> wrote:

>
>   I suspect the NOTE said something about "*possibly* misspelled words"
> (emphasis added). This should be OK; just put the explanation below in
> your notes to CRAN about the submission, clarifying that this is indeed
> a false positive.
>
>   cheers
>     Ben Bolker
>
> On 2019-08-19 6:13 p.m., John Harrold wrote:
> > Hello,
> >
> > I am attempting to submit my first package to CRAN. I believe I've
> > successfully gotten rid of all the notes, but there is one that I'm
> unable
> > to eliminate. In the DESCRIPTION file in both the Title and Description
> > fields I use the term PKPD. This stands for Pharmacokinetics and
> > Pharmacodynamics. It seems that none of these are recognized as words
> that
> > are spelled correctly. They are kind of important in the context of the
> > package and there are no other better or more accurate descriptors that I
> > can use.
> >
> > Is there a way to get around this?
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


-- 
John
:wq

	[[alternative HTML version deleted]]


From john@m@h@rro|d @end|ng |rom gm@||@com  Tue Aug 20 04:08:11 2019
From: john@m@h@rro|d @end|ng |rom gm@||@com (John Harrold)
Date: Mon, 19 Aug 2019 19:08:11 -0700
Subject: [R-pkg-devel] replacing previous import
Message-ID: <CANAiAiWh1hGLjSPPK=2uOXrfLqV8z7EjzT+UnE8mRdFp4GPPXg@mail.gmail.com>

Howdy Folks,

I'm getting the following warning:

Found the following significant warnings:
  Warning: replacing previous import ?gdata::combine? by
?gridExtra::combine? when loading

In the R scripts I'm using
#'@importFrom gridExtra grid.arrange

To only import the function I want, but I'm not sure how to do that in the
DESCRIPTION file. Is there anything I can do to eliminate this warning or
is this OK?

-- 
Thanks,
John
:wq

	[[alternative HTML version deleted]]


From he|mut@@chuetz @end|ng |rom beb@c@@t  Tue Aug 20 13:16:44 2019
From: he|mut@@chuetz @end|ng |rom beb@c@@t (=?UTF-8?Q?Helmut_Sch=c3=bctz?=)
Date: Tue, 20 Aug 2019 13:16:44 +0200
Subject: [R-pkg-devel] Misspelled words in DESCRIPTION
In-Reply-To: <CANAiAiXvg-1XCtXKncBDAFtgHL9i66JcN3i_zgo3v5mJU9WoSA@mail.gmail.com>
References: <CANAiAiXvg-1XCtXKncBDAFtgHL9i66JcN3i_zgo3v5mJU9WoSA@mail.gmail.com>
Message-ID: <d2aa0b0f-67c7-25e1-38b7-4cdb8ece641b@bebac.at>

Hi John,

we had the same issue with abbreviations BA (bioavailability), BE 
(bioequivalence), and NTID (narrow therapeutic index drug) in our 
packages (PowerTOST, replicateBE).

Don?t worry.This note will appear only if you submit the package for the 
first time to CRAN.

Helmut

-- 
Ing. Helmut Sch?tz
BEBAC?? Consultancy Services for
Bioequivalence and Bioavailability Studies
W https://bebac.at/
C https://bebac.at/Contact.htm
F https://forum.bebac.at/


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Aug 20 13:42:27 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 20 Aug 2019 07:42:27 -0400
Subject: [R-pkg-devel] replacing previous import
In-Reply-To: <CANAiAiWh1hGLjSPPK=2uOXrfLqV8z7EjzT+UnE8mRdFp4GPPXg@mail.gmail.com>
References: <CANAiAiWh1hGLjSPPK=2uOXrfLqV8z7EjzT+UnE8mRdFp4GPPXg@mail.gmail.com>
Message-ID: <04723c7a-4214-a69e-83df-7346e5ae2813@gmail.com>

On 19/08/2019 10:08 p.m., John Harrold wrote:
> Howdy Folks,
> 
> I'm getting the following warning:
> 
> Found the following significant warnings:
>    Warning: replacing previous import ?gdata::combine? by
> ?gridExtra::combine? when loading
> 
> In the R scripts I'm using
> #'@importFrom gridExtra grid.arrange
> 
> To only import the function I want, but I'm not sure how to do that in the
> DESCRIPTION file. Is there anything I can do to eliminate this warning or
> is this OK?



You need to look at your NAMESPACE file, not the DESCRIPTION file.  It's 
likely that Roxygen has included both imports of combine in that file, 
and that *is* a problem:  only one will be valid.  (You can't have two 
objects with the same name, but you can import one of them using a 
different name.)

If you can't spot the problem, please post either the NAMESPACE file, or 
even better, a location of the whole package so we can take a look.

Duncan Murdoch


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Aug 20 13:45:51 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 20 Aug 2019 07:45:51 -0400
Subject: [R-pkg-devel] Misspelled words in DESCRIPTION
In-Reply-To: <CANAiAiXvg-1XCtXKncBDAFtgHL9i66JcN3i_zgo3v5mJU9WoSA@mail.gmail.com>
References: <CANAiAiXvg-1XCtXKncBDAFtgHL9i66JcN3i_zgo3v5mJU9WoSA@mail.gmail.com>
Message-ID: <ff19b751-e24f-91d3-ebd1-0a14e79cdafd@gmail.com>

On 19/08/2019 6:13 p.m., John Harrold wrote:
> Hello,
> 
> I am attempting to submit my first package to CRAN. I believe I've
> successfully gotten rid of all the notes, but there is one that I'm unable
> to eliminate. In the DESCRIPTION file in both the Title and Description
> fields I use the term PKPD. This stands for Pharmacokinetics and
> Pharmacodynamics. 

As others have said, you just need to give a note explaining that it is 
a false positive.  But please do give the full version once in the 
Description:  it won't only be PKPD experts who read about your package. 
  (You could give it in the title, but that is likely to make your title 
too long.)

Duncan Murdoch


It seems that none of these are recognized as words that
> are spelled correctly. They are kind of important in the context of the
> package and there are no other better or more accurate descriptors that I
> can use.
> 
> Is there a way to get around this?
>


From pd@|gd @end|ng |rom gm@||@com  Tue Aug 20 14:49:09 2019
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Tue, 20 Aug 2019 14:49:09 +0200
Subject: [R-pkg-devel] Misspelled words in DESCRIPTION
In-Reply-To: <CANAiAiV0Fny6DcJ2f9WFahMLcMvJE1+KpJzZFWEBGrMiooVW4g@mail.gmail.com>
References: <CANAiAiXvg-1XCtXKncBDAFtgHL9i66JcN3i_zgo3v5mJU9WoSA@mail.gmail.com>
 <3e94067b-cb0a-4c09-f93c-74449db2287e@gmail.com>
 <CANAiAiV0Fny6DcJ2f9WFahMLcMvJE1+KpJzZFWEBGrMiooVW4g@mail.gmail.com>
Message-ID: <B78C9477-8D03-49E4-99A0-3F1891960F02@gmail.com>

I'd write "PK/PD" though. Or did the world change while I was looking the other way?

-pd

> On 20 Aug 2019, at 00:42 , John Harrold <john.m.harrold at gmail.com> wrote:
> 
> Yeah that's it. Thanks Uwe and Ben.
> 
> On Mon, Aug 19, 2019 at 3:21 PM Ben Bolker <bbolker at gmail.com> wrote:
> 
>> 
>>  I suspect the NOTE said something about "*possibly* misspelled words"
>> (emphasis added). This should be OK; just put the explanation below in
>> your notes to CRAN about the submission, clarifying that this is indeed
>> a false positive.
>> 
>>  cheers
>>    Ben Bolker
>> 
>> On 2019-08-19 6:13 p.m., John Harrold wrote:
>>> Hello,
>>> 
>>> I am attempting to submit my first package to CRAN. I believe I've
>>> successfully gotten rid of all the notes, but there is one that I'm
>> unable
>>> to eliminate. In the DESCRIPTION file in both the Title and Description
>>> fields I use the term PKPD. This stands for Pharmacokinetics and
>>> Pharmacodynamics. It seems that none of these are recognized as words
>> that
>>> are spelled correctly. They are kind of important in the context of the
>>> package and there are no other better or more accurate descriptors that I
>>> can use.
>>> 
>>> Is there a way to get around this?
>>> 
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> 
> 
> 
> -- 
> John
> :wq
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From biii m@iii@g oii de@@ey@ws  Fri Aug 23 05:15:08 2019
From: biii m@iii@g oii de@@ey@ws (biii m@iii@g oii de@@ey@ws)
Date: Thu, 22 Aug 2019 23:15:08 -0400
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
Message-ID: <010201d55960$f855e950$e901bbf0$@denney.ws>

Hello,

 

Does anyone know how to include verbatim \ldots (and maybe other LaTeX) in
an .Rd file correctly? 

 

When LaTeX is in the default arguments for a function, the code is
interpreted which makes the documentation not match the default formal
arguments.

 

An example is:

https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
7db5ef30368dc33/R/topic_long_table_header_footer.R#L20

 

Which yields:

https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
7db5ef30368dc33/man/topic_long_table_header.Rd#L10

 

Which gives the following warning with `devtools::check()`:

```

checking for code/documentation mismatches ... WARNING

Codoc mismatches from documentation object 'topic_long_table_header':

topic_long_table_header

  Code: function(x, col_names = NULL, above_col_names = "\\hline
<file://hline> ",

                 below_col_names = "\\hline <file://hline> ",

                 subsequent_page_notification = "\\ldots continued
<file://ldots%20continued> ",

                 latex_header = NULL)

  Docs: function(x, col_names = NULL, above_col_names = "\\hline
<file://hline> ",

                 below_col_names = "\\hline <file://hline> ",

                 subsequent_page_notification = "\... continued",

                 latex_header = NULL)

```

 

I'm not sure, but I think that the solution is to add more protection to the
\s when generating the roxygen or perhaps wrapping the arguments in some
form of verbatim block (if it's available).

 

Thanks,

 

Bill

 

P.S. This is also discussed in https://github.com/r-lib/roxygen2/issues/837
where it appears to be related to the conversion of .Rd to help files not
the roxygen step.

 


	[[alternative HTML version deleted]]


From mthrun @end|ng |rom M@them@t|k@Un|-M@rburg@de  Fri Aug 23 09:18:07 2019
From: mthrun @end|ng |rom M@them@t|k@Un|-M@rburg@de (Dr. rer. nat. Michael Thrun)
Date: Fri, 23 Aug 2019 09:18:07 +0200
Subject: [R-pkg-devel] No protocol specified
Message-ID: <273DCE84-721A-42D4-ADAF-8E1D1074F2AC@mathematik.uni-marburg.de>

Dear All,
I updated my package DataVisualizations and get a note, only for "r-release-osx-x86_64? and ?r-oldrel-osx-x86_64?

Checking dependencies in R code ... NOTE
No protocol specified

Can anyone translate this note to me in a way that I know what the issue is?

Best Regards
Michael


Michael Thrun
Postdoctoral Scholar
Databionics AG,
Mathematics and Computer Science

Philipps-Universit?t Marburg
Hans-Meerwein-Stra?e 6, 04A28
D-35032 Marburg

Phone +49 6421/ 28 23922
www.uni-marburg.de/fb12/datenbionik/


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Fri Aug 23 15:51:39 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Fri, 23 Aug 2019 13:51:39 +0000
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
In-Reply-To: <010201d55960$f855e950$e901bbf0$@denney.ws>
References: <010201d55960$f855e950$e901bbf0$@denney.ws>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E01CC777EB3@MBXP01.ds.man.ac.uk>

Rd is not LaTeX, although it resembles it.  You should use only markup described in WRE.
For example, \dots is for the use case you mention. 

Georgi Boshnakov





-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of bill at denney.ws
Sent: 23 August 2019 04:15
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hello,

 

Does anyone know how to include verbatim \ldots (and maybe other LaTeX) in
an .Rd file correctly? 

 

When LaTeX is in the default arguments for a function, the code is
interpreted which makes the documentation not match the default formal
arguments.

 

An example is:

https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
7db5ef30368dc33/R/topic_long_table_header_footer.R#L20

 

Which yields:

https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
7db5ef30368dc33/man/topic_long_table_header.Rd#L10

 

Which gives the following warning with `devtools::check()`:

```

checking for code/documentation mismatches ... WARNING

Codoc mismatches from documentation object 'topic_long_table_header':

topic_long_table_header

  Code: function(x, col_names = NULL, above_col_names = "\\hline
<file://hline> ",

                 below_col_names = "\\hline <file://hline> ",

                 subsequent_page_notification = "\\ldots continued
<file://ldots%20continued> ",

                 latex_header = NULL)

  Docs: function(x, col_names = NULL, above_col_names = "\\hline
<file://hline> ",

                 below_col_names = "\\hline <file://hline> ",

                 subsequent_page_notification = "\... continued",

                 latex_header = NULL)

```

 

I'm not sure, but I think that the solution is to add more protection to the
\s when generating the roxygen or perhaps wrapping the arguments in some
form of verbatim block (if it's available).

 

Thanks,

 

Bill

 

P.S. This is also discussed in https://github.com/r-lib/roxygen2/issues/837
where it appears to be related to the conversion of .Rd to help files not
the roxygen step.

 


	[[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


From biii m@iii@g oii de@@ey@ws  Fri Aug 23 16:26:57 2019
From: biii m@iii@g oii de@@ey@ws (biii m@iii@g oii de@@ey@ws)
Date: Fri, 23 Aug 2019 10:26:57 -0400
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E01CC777EB3@MBXP01.ds.man.ac.uk>
References: <010201d55960$f855e950$e901bbf0$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EB3@MBXP01.ds.man.ac.uk>
Message-ID: <015601d559be$d2d39e80$787adb80$@denney.ws>

Hi Georgi,

I'm not trying to use it as part of my documentation, it is one of my
function arguments.  I want the function argument to be displayed correctly
in the help, but it is not.  I'm curious how I should document the
"subsequent_page_notification" function argument in Rd.

Specifically, the actual function definition (R code) looks like:

R code:
--------------
topic_long_table_header <- function(x,
                                    col_names=NULL,
                                    above_col_names="\\hline",
below_col_names="\\hline",
                                    subsequent_page_notification="\\ldots
continued",
                                    latex_header=NULL) {
  # The function body
}
--------------

So, I'm not trying to use LaTeX in the .Rd file; I'm trying to use it in R,
and I'm then copying it into the .Rd with extra escaping for the backslashes
(well, roxygen2 is doing the extra escaping).

Rd text
--------------
topic_long_table_header(x, col_names = NULL,
  above_col_names = "\\\\hline", below_col_names = "\\\\hline",
  subsequent_page_notification = "\\\\ldots continued",
  latex_header = NULL)
--------------

Thanks,

Bill

-----Original Message-----
From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk> 
Sent: Friday, August 23, 2019 9:52 AM
To: bill at denney.ws; r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Rd is not LaTeX, although it resembles it.  You should use only markup
described in WRE.
For example, \dots is for the use case you mention. 

Georgi Boshnakov





-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On
Behalf Of bill at denney.ws
Sent: 23 August 2019 04:15
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hello,

 

Does anyone know how to include verbatim \ldots (and maybe other LaTeX) in
an .Rd file correctly? 

 

When LaTeX is in the default arguments for a function, the code is
interpreted which makes the documentation not match the default formal
arguments.

 

An example is:

https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
7db5ef30368dc33/R/topic_long_table_header_footer.R#L20

 

Which yields:

https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
7db5ef30368dc33/man/topic_long_table_header.Rd#L10

 

Which gives the following warning with `devtools::check()`:

```

checking for code/documentation mismatches ... WARNING

Codoc mismatches from documentation object 'topic_long_table_header':

topic_long_table_header

  Code: function(x, col_names = NULL, above_col_names = "\\hline
<file://hline> ",

                 below_col_names = "\\hline <file://hline> ",

                 subsequent_page_notification = "\\ldots continued
<file://ldots%20continued> ",

                 latex_header = NULL)

  Docs: function(x, col_names = NULL, above_col_names = "\\hline
<file://hline> ",

                 below_col_names = "\\hline <file://hline> ",

                 subsequent_page_notification = "\... continued",

                 latex_header = NULL)

```

 

I'm not sure, but I think that the solution is to add more protection to the
\s when generating the roxygen or perhaps wrapping the arguments in some
form of verbatim block (if it's available).

 

Thanks,

 

Bill

 

P.S. This is also discussed in https://github.com/r-lib/roxygen2/issues/837
where it appears to be related to the conversion of .Rd to help files not
the roxygen step.

 


	[[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @te|@no@renzett|88 @end|ng |rom gm@||@com  Fri Aug 23 16:59:39 2019
From: @te|@no@renzett|88 @end|ng |rom gm@||@com (Stefano Renzetti)
Date: Fri, 23 Aug 2019 16:59:39 +0200
Subject: [R-pkg-devel] Compact pdf warning
In-Reply-To: <972bb1b4-ddff-41df-bdbc-545df61e36d2@Spark>
References: <972bb1b4-ddff-41df-bdbc-545df61e36d2@Spark>
Message-ID: <ff72199b-bfd0-44ec-b051-83226355cf40@Spark>

Hi,

I receive the following warning when I check my package:

checking sizes of PDF files under ?inst/doc? ... WARNING
? ?gs+qpdf? made some significant size reductions:
?? ? compacted ?gwqs-vignette.pdf? from 458Kb to 162Kb
? consider running tools::compactPDF(gs_quality = "ebook") on these files

For this warning I tried to add the option "--compact-vignettes=both" in the build source package R CMD build additional options but it did not work. When I use the tools::compactPDF(gs_quality = "ebook") command it is able to create the compacted pdf but then when I build the package then it rebuilds the vignette and the size is still the before one. Do you have any suggestion?

Thanks in advance,
Stefano

	[[alternative HTML version deleted]]


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Fri Aug 23 17:26:30 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Fri, 23 Aug 2019 15:26:30 +0000
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
In-Reply-To: <015601d559be$d2d39e80$787adb80$@denney.ws>
References: <010201d55960$f855e950$e901bbf0$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EB3@MBXP01.ds.man.ac.uk>
 <015601d559be$d2d39e80$787adb80$@denney.ws>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E01CC777EE2@MBXP01.ds.man.ac.uk>

Hi Bill,

Sorry, I misunderstood the question.

To check if the problem is with R's tools, run 'utils::prompt(topic_long_table_header)" and see the usage section of the generated file. Presumably, this should be the 'canonical way' to write the usage entry for the function.
You can copy and paste it in the Rd file generated by roxygen2, then run 'R CMD build' and 'R CMD check' (outside devtools). 

Georgi


-----Original Message-----
From: bill at denney.ws [mailto:bill at denney.ws] 
Sent: 23 August 2019 15:27
To: Georgi Boshnakov; r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hi Georgi,

I'm not trying to use it as part of my documentation, it is one of my
function arguments.  I want the function argument to be displayed correctly
in the help, but it is not.  I'm curious how I should document the
"subsequent_page_notification" function argument in Rd.

Specifically, the actual function definition (R code) looks like:

R code:
--------------
topic_long_table_header <- function(x,
                                    col_names=NULL,
                                    above_col_names="\\hline",
below_col_names="\\hline",
                                    subsequent_page_notification="\\ldots
continued",
                                    latex_header=NULL) {
  # The function body
}
--------------

So, I'm not trying to use LaTeX in the .Rd file; I'm trying to use it in R,
and I'm then copying it into the .Rd with extra escaping for the backslashes
(well, roxygen2 is doing the extra escaping).

Rd text
--------------
topic_long_table_header(x, col_names = NULL,
  above_col_names = "\\\\hline", below_col_names = "\\\\hline",
  subsequent_page_notification = "\\\\ldots continued",
  latex_header = NULL)
--------------

Thanks,

Bill

-----Original Message-----
From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk> 
Sent: Friday, August 23, 2019 9:52 AM
To: bill at denney.ws; r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Rd is not LaTeX, although it resembles it.  You should use only markup
described in WRE.
For example, \dots is for the use case you mention. 

Georgi Boshnakov





-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On
Behalf Of bill at denney.ws
Sent: 23 August 2019 04:15
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hello,

 

Does anyone know how to include verbatim \ldots (and maybe other LaTeX) in
an .Rd file correctly? 

 

When LaTeX is in the default arguments for a function, the code is
interpreted which makes the documentation not match the default formal
arguments.

 

An example is:

https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
7db5ef30368dc33/R/topic_long_table_header_footer.R#L20

 

Which yields:

https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
7db5ef30368dc33/man/topic_long_table_header.Rd#L10

 

Which gives the following warning with `devtools::check()`:

```

checking for code/documentation mismatches ... WARNING

Codoc mismatches from documentation object 'topic_long_table_header':

topic_long_table_header

  Code: function(x, col_names = NULL, above_col_names = "\\hline
<file://hline> ",

                 below_col_names = "\\hline <file://hline> ",

                 subsequent_page_notification = "\\ldots continued
<file://ldots%20continued> ",

                 latex_header = NULL)

  Docs: function(x, col_names = NULL, above_col_names = "\\hline
<file://hline> ",

                 below_col_names = "\\hline <file://hline> ",

                 subsequent_page_notification = "\... continued",

                 latex_header = NULL)

```

 

I'm not sure, but I think that the solution is to add more protection to the
\s when generating the roxygen or perhaps wrapping the arguments in some
form of verbatim block (if it's available).

 

Thanks,

 

Bill

 

P.S. This is also discussed in https://github.com/r-lib/roxygen2/issues/837
where it appears to be related to the conversion of .Rd to help files not
the roxygen step.

 


	[[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


From biii m@iii@g oii de@@ey@ws  Fri Aug 23 19:33:57 2019
From: biii m@iii@g oii de@@ey@ws (biii m@iii@g oii de@@ey@ws)
Date: Fri, 23 Aug 2019 13:33:57 -0400
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E01CC777EE2@MBXP01.ds.man.ac.uk>
References: <010201d55960$f855e950$e901bbf0$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EB3@MBXP01.ds.man.ac.uk>
 <015601d559be$d2d39e80$787adb80$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EE2@MBXP01.ds.man.ac.uk>
Message-ID: <019a01d559d8$f26e71b0$d74b5510$@denney.ws>

Hi Georgi,

Thanks for this pointer.  My guess at this point is that I've found a bug
(or maybe a couple of bugs with 'utils::prompt()' and with the Rd to help
conversion), but let me know if you think otherwise.

I just did that way, and the usage lines that were generated by
'utils::prompt()' and copied into the docs are:

topic_long_table_header(x, col_names = NULL,
  above_col_names = "\\hline", below_col_names = "\\hline",
  subsequent_page_notification = "\\ldots continued",
  latex_header = NULL, verbatim = NULL)

topic_long_table_footer(x, bottom_border = "\\hline",
  bottom_all_pages = NULL, bottom_last_page = NULL,
  subsequent_page_notification = "continued \\ldots",
  verbatim = NULL)

It is giving a very similar error with 'R CMD check' (outside devtools).
The escape of the backslashes appears to be needed, but "\\ldots" continues
to be translated into "...":

Codoc mismatches from documentation object 'topic_long_table_header':
topic_long_table_header
  Code: function(x, col_names = NULL, above_col_names = "\\hline",
                 below_col_names = "\\hline",
                 subsequent_page_notification = "\\ldots continued",
                 latex_header = NULL, verbatim = NULL)
  Docs: function(x, col_names = NULL, above_col_names = "\hline",
                 below_col_names = "\hline",
                 subsequent_page_notification = "... continued",
                 latex_header = NULL, verbatim = NULL)
  Mismatches in argument default values:
    Name: 'above_col_names' Code: "\\hline" Docs: "\hline"
    Name: 'below_col_names' Code: "\\hline" Docs: "\hline"
    Name: 'subsequent_page_notification' Code: "\\ldots continued" Docs:
"... continued"
topic_long_table_footer
  Code: function(x, bottom_border = "\\hline", bottom_all_pages = NULL,
                 bottom_last_page = NULL, subsequent_page_notification
                 = "continued \\ldots", verbatim = NULL)
  Docs: function(x, bottom_border = "\hline", bottom_all_pages = NULL,
                 bottom_last_page = NULL, subsequent_page_notification
                 = "continued ...", verbatim = NULL)
  Mismatches in argument default values:
    Name: 'bottom_border' Code: "\\hline" Docs: "\hline"
    Name: 'subsequent_page_notification' Code: "continued \\ldots" Docs:
"continued ..."

Thanks,

Bill

-----Original Message-----
From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk> 
Sent: Friday, August 23, 2019 11:27 AM
To: bill at denney.ws; r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hi Bill,

Sorry, I misunderstood the question.

To check if the problem is with R's tools, run
'utils::prompt(topic_long_table_header)" and see the usage section of the
generated file. Presumably, this should be the 'canonical way' to write the
usage entry for the function.
You can copy and paste it in the Rd file generated by roxygen2, then run 'R
CMD build' and 'R CMD check' (outside devtools). 

Georgi


-----Original Message-----
From: bill at denney.ws [mailto:bill at denney.ws]
Sent: 23 August 2019 15:27
To: Georgi Boshnakov; r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hi Georgi,

I'm not trying to use it as part of my documentation, it is one of my
function arguments.  I want the function argument to be displayed correctly
in the help, but it is not.  I'm curious how I should document the
"subsequent_page_notification" function argument in Rd.

Specifically, the actual function definition (R code) looks like:

R code:
--------------
topic_long_table_header <- function(x,
                                    col_names=NULL,
                                    above_col_names="\\hline",
below_col_names="\\hline",
                                    subsequent_page_notification="\\ldots
continued",
                                    latex_header=NULL) {
  # The function body
}
--------------

So, I'm not trying to use LaTeX in the .Rd file; I'm trying to use it in R,
and I'm then copying it into the .Rd with extra escaping for the backslashes
(well, roxygen2 is doing the extra escaping).

Rd text
--------------
topic_long_table_header(x, col_names = NULL,
  above_col_names = "\\\\hline", below_col_names = "\\\\hline",
  subsequent_page_notification = "\\\\ldots continued",
  latex_header = NULL)
--------------

Thanks,

Bill

-----Original Message-----
From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
Sent: Friday, August 23, 2019 9:52 AM
To: bill at denney.ws; r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Rd is not LaTeX, although it resembles it.  You should use only markup
described in WRE.
For example, \dots is for the use case you mention. 

Georgi Boshnakov





-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On
Behalf Of bill at denney.ws
Sent: 23 August 2019 04:15
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hello,

 

Does anyone know how to include verbatim \ldots (and maybe other LaTeX) in
an .Rd file correctly? 

 

When LaTeX is in the default arguments for a function, the code is
interpreted which makes the documentation not match the default formal
arguments.

 

An example is:

https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
7db5ef30368dc33/R/topic_long_table_header_footer.R#L20

 

Which yields:

https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
7db5ef30368dc33/man/topic_long_table_header.Rd#L10

 

Which gives the following warning with `devtools::check()`:

```

checking for code/documentation mismatches ... WARNING

Codoc mismatches from documentation object 'topic_long_table_header':

topic_long_table_header

  Code: function(x, col_names = NULL, above_col_names = "\\hline
<file://hline> ",

                 below_col_names = "\\hline <file://hline> ",

                 subsequent_page_notification = "\\ldots continued
<file://ldots%20continued> ",

                 latex_header = NULL)

  Docs: function(x, col_names = NULL, above_col_names = "\\hline
<file://hline> ",

                 below_col_names = "\\hline <file://hline> ",

                 subsequent_page_notification = "\... continued",

                 latex_header = NULL)

```

 

I'm not sure, but I think that the solution is to add more protection to the
\s when generating the roxygen or perhaps wrapping the arguments in some
form of verbatim block (if it's available).

 

Thanks,

 

Bill

 

P.S. This is also discussed in https://github.com/r-lib/roxygen2/issues/837
where it appears to be related to the conversion of .Rd to help files not
the roxygen step.

 


	[[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Sat Aug 24 12:30:29 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Sat, 24 Aug 2019 10:30:29 +0000
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
In-Reply-To: <019a01d559d8$f26e71b0$d74b5510$@denney.ws>
References: <010201d55960$f855e950$e901bbf0$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EB3@MBXP01.ds.man.ac.uk>
 <015601d559be$d2d39e80$787adb80$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EE2@MBXP01.ds.man.ac.uk>,
 <019a01d559d8$f26e71b0$d74b5510$@denney.ws>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E01CC777F5A@MBXP01.ds.man.ac.uk>

HI Bill, 

I checked this as well, using the package you put on github for this purpose (note that the link you gave didn't work for me).
I tried a few variants but the bottom line is that "\ldots" and "\dots" are expanded even if the backslash is escaped. 

It is a feature rather than a bug, see towards the bottom of p. 8 in parseRd (https://developer.r-project.org/parseRd.pdf). 
In R strings, macros starting with "\l" are expanded (this is how \code{\link{sss}} works). 

But '\dots' is also expanded and this seems undocumented. I now recall that I have seen similar behaviour for "\dots" in R strings in the Examples section. 

I tried some hacks, such as redefining the '\ldots' but they don't work, since the Rd parser works recursively.
 


Georgi Boshnakov       


________________________________________
From: bill at denney.ws [bill at denney.ws]
Sent: 23 August 2019 18:33
To: Georgi Boshnakov; r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hi Georgi,

Thanks for this pointer.  My guess at this point is that I've found a bug
(or maybe a couple of bugs with 'utils::prompt()' and with the Rd to help
conversion), but let me know if you think otherwise.

I just did that way, and the usage lines that were generated by
'utils::prompt()' and copied into the docs are:

topic_long_table_header(x, col_names = NULL,
  above_col_names = "\\hline", below_col_names = "\\hline",
  subsequent_page_notification = "\\ldots continued",
  latex_header = NULL, verbatim = NULL)

topic_long_table_footer(x, bottom_border = "\\hline",
  bottom_all_pages = NULL, bottom_last_page = NULL,
  subsequent_page_notification = "continued \\ldots",
  verbatim = NULL)

It is giving a very similar error with 'R CMD check' (outside devtools).
The escape of the backslashes appears to be needed, but "\\ldots" continues
to be translated into "...":

Codoc mismatches from documentation object 'topic_long_table_header':
topic_long_table_header
  Code: function(x, col_names = NULL, above_col_names = "\\hline",
                 below_col_names = "\\hline",
                 subsequent_page_notification = "\\ldots continued",
                 latex_header = NULL, verbatim = NULL)
  Docs: function(x, col_names = NULL, above_col_names = "\hline",
                 below_col_names = "\hline",
                 subsequent_page_notification = "... continued",
                 latex_header = NULL, verbatim = NULL)
  Mismatches in argument default values:
    Name: 'above_col_names' Code: "\\hline" Docs: "\hline"
    Name: 'below_col_names' Code: "\\hline" Docs: "\hline"
    Name: 'subsequent_page_notification' Code: "\\ldots continued" Docs:
"... continued"
topic_long_table_footer
  Code: function(x, bottom_border = "\\hline", bottom_all_pages = NULL,
                 bottom_last_page = NULL, subsequent_page_notification
                 = "continued \\ldots", verbatim = NULL)
  Docs: function(x, bottom_border = "\hline", bottom_all_pages = NULL,
                 bottom_last_page = NULL, subsequent_page_notification
                 = "continued ...", verbatim = NULL)
  Mismatches in argument default values:
    Name: 'bottom_border' Code: "\\hline" Docs: "\hline"
    Name: 'subsequent_page_notification' Code: "continued \\ldots" Docs:
"continued ..."

Thanks,

Bill

-----Original Message-----
From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
Sent: Friday, August 23, 2019 11:27 AM
To: bill at denney.ws; r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hi Bill,

Sorry, I misunderstood the question.

To check if the problem is with R's tools, run
'utils::prompt(topic_long_table_header)" and see the usage section of the
generated file. Presumably, this should be the 'canonical way' to write the
usage entry for the function.
You can copy and paste it in the Rd file generated by roxygen2, then run 'R
CMD build' and 'R CMD check' (outside devtools).

Georgi


-----Original Message-----
From: bill at denney.ws [mailto:bill at denney.ws]
Sent: 23 August 2019 15:27
To: Georgi Boshnakov; r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hi Georgi,

I'm not trying to use it as part of my documentation, it is one of my
function arguments.  I want the function argument to be displayed correctly
in the help, but it is not.  I'm curious how I should document the
"subsequent_page_notification" function argument in Rd.

Specifically, the actual function definition (R code) looks like:

R code:
--------------
topic_long_table_header <- function(x,
                                    col_names=NULL,
                                    above_col_names="\\hline",
below_col_names="\\hline",
                                    subsequent_page_notification="\\ldots
continued",
                                    latex_header=NULL) {
  # The function body
}
--------------

So, I'm not trying to use LaTeX in the .Rd file; I'm trying to use it in R,
and I'm then copying it into the .Rd with extra escaping for the backslashes
(well, roxygen2 is doing the extra escaping).

Rd text
--------------
topic_long_table_header(x, col_names = NULL,
  above_col_names = "\\\\hline", below_col_names = "\\\\hline",
  subsequent_page_notification = "\\\\ldots continued",
  latex_header = NULL)
--------------

Thanks,

Bill

-----Original Message-----
From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
Sent: Friday, August 23, 2019 9:52 AM
To: bill at denney.ws; r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Rd is not LaTeX, although it resembles it.  You should use only markup
described in WRE.
For example, \dots is for the use case you mention.

Georgi Boshnakov





-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On
Behalf Of bill at denney.ws
Sent: 23 August 2019 04:15
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hello,



Does anyone know how to include verbatim \ldots (and maybe other LaTeX) in
an .Rd file correctly?



When LaTeX is in the default arguments for a function, the code is
interpreted which makes the documentation not match the default formal
arguments.



An example is:

https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
7db5ef30368dc33/R/topic_long_table_header_footer.R#L20



Which yields:

https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
7db5ef30368dc33/man/topic_long_table_header.Rd#L10



Which gives the following warning with `devtools::check()`:

```

checking for code/documentation mismatches ... WARNING

Codoc mismatches from documentation object 'topic_long_table_header':

topic_long_table_header

  Code: function(x, col_names = NULL, above_col_names = "\\hline
<file://hline> ",

                 below_col_names = "\\hline <file://hline> ",

                 subsequent_page_notification = "\\ldots continued
<file://ldots%20continued> ",

                 latex_header = NULL)

  Docs: function(x, col_names = NULL, above_col_names = "\\hline
<file://hline> ",

                 below_col_names = "\\hline <file://hline> ",

                 subsequent_page_notification = "\... continued",

                 latex_header = NULL)

```



I'm not sure, but I think that the solution is to add more protection to the
\s when generating the roxygen or perhaps wrapping the arguments in some
form of verbatim block (if it's available).



Thanks,



Bill



P.S. This is also discussed in https://github.com/r-lib/roxygen2/issues/837
where it appears to be related to the conversion of .Rd to help files not
the roxygen step.




        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Aug 24 13:35:32 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 24 Aug 2019 07:35:32 -0400
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
In-Reply-To: <019a01d559d8$f26e71b0$d74b5510$@denney.ws>
References: <010201d55960$f855e950$e901bbf0$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EB3@MBXP01.ds.man.ac.uk>
 <015601d559be$d2d39e80$787adb80$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EE2@MBXP01.ds.man.ac.uk>
 <019a01d559d8$f26e71b0$d74b5510$@denney.ws>
Message-ID: <f967365d-7dd4-d109-1396-14dc8d51c223@gmail.com>

On 23/08/2019 1:33 p.m., bill at denney.ws wrote:
> Hi Georgi,
> 
> Thanks for this pointer.  My guess at this point is that I've found a bug
> (or maybe a couple of bugs with 'utils::prompt()' and with the Rd to help
> conversion), but let me know if you think otherwise.

It's certainly not a bug in utils:prompt:  that's never called except by 
the user.

It might be a bug in the .Rd parsing, but I don't think so, because I'm 
not seeing it when I write the .Rd file manually and view it in HTML.

It's most likely a bug in the check code, because I am seeing the same 
"Codoc mismatches" error as you are.  I'm also seeing it in the pdf 
display of the help page, but not in the HTML or text displays.

Duncan Murdoch

> 
> I just did that way, and the usage lines that were generated by
> 'utils::prompt()' and copied into the docs are:
> 
> topic_long_table_header(x, col_names = NULL,
>    above_col_names = "\\hline", below_col_names = "\\hline",
>    subsequent_page_notification = "\\ldots continued",
>    latex_header = NULL, verbatim = NULL)
> 
> topic_long_table_footer(x, bottom_border = "\\hline",
>    bottom_all_pages = NULL, bottom_last_page = NULL,
>    subsequent_page_notification = "continued \\ldots",
>    verbatim = NULL)
> 
> It is giving a very similar error with 'R CMD check' (outside devtools).
> The escape of the backslashes appears to be needed, but "\\ldots" continues
> to be translated into "...":
> 
> Codoc mismatches from documentation object 'topic_long_table_header':
> topic_long_table_header
>    Code: function(x, col_names = NULL, above_col_names = "\\hline",
>                   below_col_names = "\\hline",
>                   subsequent_page_notification = "\\ldots continued",
>                   latex_header = NULL, verbatim = NULL)
>    Docs: function(x, col_names = NULL, above_col_names = "\hline",
>                   below_col_names = "\hline",
>                   subsequent_page_notification = "... continued",
>                   latex_header = NULL, verbatim = NULL)
>    Mismatches in argument default values:
>      Name: 'above_col_names' Code: "\\hline" Docs: "\hline"
>      Name: 'below_col_names' Code: "\\hline" Docs: "\hline"
>      Name: 'subsequent_page_notification' Code: "\\ldots continued" Docs:
> "... continued"
> topic_long_table_footer
>    Code: function(x, bottom_border = "\\hline", bottom_all_pages = NULL,
>                   bottom_last_page = NULL, subsequent_page_notification
>                   = "continued \\ldots", verbatim = NULL)
>    Docs: function(x, bottom_border = "\hline", bottom_all_pages = NULL,
>                   bottom_last_page = NULL, subsequent_page_notification
>                   = "continued ...", verbatim = NULL)
>    Mismatches in argument default values:
>      Name: 'bottom_border' Code: "\\hline" Docs: "\hline"
>      Name: 'subsequent_page_notification' Code: "continued \\ldots" Docs:
> "continued ..."
> 
> Thanks,
> 
> Bill
> 
> -----Original Message-----
> From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
> Sent: Friday, August 23, 2019 11:27 AM
> To: bill at denney.ws; r-package-devel at r-project.org
> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
> 
> Hi Bill,
> 
> Sorry, I misunderstood the question.
> 
> To check if the problem is with R's tools, run
> 'utils::prompt(topic_long_table_header)" and see the usage section of the
> generated file. Presumably, this should be the 'canonical way' to write the
> usage entry for the function.
> You can copy and paste it in the Rd file generated by roxygen2, then run 'R
> CMD build' and 'R CMD check' (outside devtools).
> 
> Georgi
> 
> 
> -----Original Message-----
> From: bill at denney.ws [mailto:bill at denney.ws]
> Sent: 23 August 2019 15:27
> To: Georgi Boshnakov; r-package-devel at r-project.org
> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
> 
> Hi Georgi,
> 
> I'm not trying to use it as part of my documentation, it is one of my
> function arguments.  I want the function argument to be displayed correctly
> in the help, but it is not.  I'm curious how I should document the
> "subsequent_page_notification" function argument in Rd.
> 
> Specifically, the actual function definition (R code) looks like:
> 
> R code:
> --------------
> topic_long_table_header <- function(x,
>                                      col_names=NULL,
>                                      above_col_names="\\hline",
> below_col_names="\\hline",
>                                      subsequent_page_notification="\\ldots
> continued",
>                                      latex_header=NULL) {
>    # The function body
> }
> --------------
> 
> So, I'm not trying to use LaTeX in the .Rd file; I'm trying to use it in R,
> and I'm then copying it into the .Rd with extra escaping for the backslashes
> (well, roxygen2 is doing the extra escaping).
> 
> Rd text
> --------------
> topic_long_table_header(x, col_names = NULL,
>    above_col_names = "\\\\hline", below_col_names = "\\\\hline",
>    subsequent_page_notification = "\\\\ldots continued",
>    latex_header = NULL)
> --------------
> 
> Thanks,
> 
> Bill
> 
> -----Original Message-----
> From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
> Sent: Friday, August 23, 2019 9:52 AM
> To: bill at denney.ws; r-package-devel at r-project.org
> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
> 
> Rd is not LaTeX, although it resembles it.  You should use only markup
> described in WRE.
> For example, \dots is for the use case you mention.
> 
> Georgi Boshnakov
> 
> 
> 
> 
> 
> -----Original Message-----
> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On
> Behalf Of bill at denney.ws
> Sent: 23 August 2019 04:15
> To: r-package-devel at r-project.org
> Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
> 
> Hello,
> 
>   
> 
> Does anyone know how to include verbatim \ldots (and maybe other LaTeX) in
> an .Rd file correctly?
> 
>   
> 
> When LaTeX is in the default arguments for a function, the code is
> interpreted which makes the documentation not match the default formal
> arguments.
> 
>   
> 
> An example is:
> 
> https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
> 7db5ef30368dc33/R/topic_long_table_header_footer.R#L20
> 
>   
> 
> Which yields:
> 
> https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
> 7db5ef30368dc33/man/topic_long_table_header.Rd#L10
> 
>   
> 
> Which gives the following warning with `devtools::check()`:
> 
> ```
> 
> checking for code/documentation mismatches ... WARNING
> 
> Codoc mismatches from documentation object 'topic_long_table_header':
> 
> topic_long_table_header
> 
>    Code: function(x, col_names = NULL, above_col_names = "\\hline
> <file://hline> ",
> 
>                   below_col_names = "\\hline <file://hline> ",
> 
>                   subsequent_page_notification = "\\ldots continued
> <file://ldots%20continued> ",
> 
>                   latex_header = NULL)
> 
>    Docs: function(x, col_names = NULL, above_col_names = "\\hline
> <file://hline> ",
> 
>                   below_col_names = "\\hline <file://hline> ",
> 
>                   subsequent_page_notification = "\... continued",
> 
>                   latex_header = NULL)
> 
> ```
> 
>   
> 
> I'm not sure, but I think that the solution is to add more protection to the
> \s when generating the roxygen or perhaps wrapping the arguments in some
> form of verbatim block (if it's available).
> 
>   
> 
> Thanks,
> 
>   
> 
> Bill
> 
>   
> 
> P.S. This is also discussed in https://github.com/r-lib/roxygen2/issues/837
> where it appears to be related to the conversion of .Rd to help files not
> the roxygen step.
> 
>   
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Aug 24 14:36:42 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 24 Aug 2019 08:36:42 -0400
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
In-Reply-To: <f967365d-7dd4-d109-1396-14dc8d51c223@gmail.com>
References: <010201d55960$f855e950$e901bbf0$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EB3@MBXP01.ds.man.ac.uk>
 <015601d559be$d2d39e80$787adb80$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EE2@MBXP01.ds.man.ac.uk>
 <019a01d559d8$f26e71b0$d74b5510$@denney.ws>
 <f967365d-7dd4-d109-1396-14dc8d51c223@gmail.com>
Message-ID: <e756ba80-9828-a110-5598-6e744d16cc9b@gmail.com>

On 24/08/2019 7:35 a.m., Duncan Murdoch wrote:
> On 23/08/2019 1:33 p.m., bill at denney.ws wrote:
>> Hi Georgi,
>>
>> Thanks for this pointer.  My guess at this point is that I've found a bug
>> (or maybe a couple of bugs with 'utils::prompt()' and with the Rd to help
>> conversion), but let me know if you think otherwise.
> 
> It's certainly not a bug in utils:prompt:  that's never called except by
> the user.

Actually, that's wrong.  utils::prompt() is generating bad code:  you 
need to have 4 backslashes in order to display 2.  It is just showing 
the string as it would be deparsed for display, it isn't modifying it so 
that it is appropriate as Rd source.

Duncan Murdoch


> 
> It might be a bug in the .Rd parsing, but I don't think so, because I'm
> not seeing it when I write the .Rd file manually and view it in HTML.
> 
> It's most likely a bug in the check code, because I am seeing the same
> "Codoc mismatches" error as you are.  I'm also seeing it in the pdf
> display of the help page, but not in the HTML or text displays.
> 
> Duncan Murdoch
> 
>>
>> I just did that way, and the usage lines that were generated by
>> 'utils::prompt()' and copied into the docs are:
>>
>> topic_long_table_header(x, col_names = NULL,
>>     above_col_names = "\\hline", below_col_names = "\\hline",
>>     subsequent_page_notification = "\\ldots continued",
>>     latex_header = NULL, verbatim = NULL)
>>
>> topic_long_table_footer(x, bottom_border = "\\hline",
>>     bottom_all_pages = NULL, bottom_last_page = NULL,
>>     subsequent_page_notification = "continued \\ldots",
>>     verbatim = NULL)
>>
>> It is giving a very similar error with 'R CMD check' (outside devtools).
>> The escape of the backslashes appears to be needed, but "\\ldots" continues
>> to be translated into "...":
>>
>> Codoc mismatches from documentation object 'topic_long_table_header':
>> topic_long_table_header
>>     Code: function(x, col_names = NULL, above_col_names = "\\hline",
>>                    below_col_names = "\\hline",
>>                    subsequent_page_notification = "\\ldots continued",
>>                    latex_header = NULL, verbatim = NULL)
>>     Docs: function(x, col_names = NULL, above_col_names = "\hline",
>>                    below_col_names = "\hline",
>>                    subsequent_page_notification = "... continued",
>>                    latex_header = NULL, verbatim = NULL)
>>     Mismatches in argument default values:
>>       Name: 'above_col_names' Code: "\\hline" Docs: "\hline"
>>       Name: 'below_col_names' Code: "\\hline" Docs: "\hline"
>>       Name: 'subsequent_page_notification' Code: "\\ldots continued" Docs:
>> "... continued"
>> topic_long_table_footer
>>     Code: function(x, bottom_border = "\\hline", bottom_all_pages = NULL,
>>                    bottom_last_page = NULL, subsequent_page_notification
>>                    = "continued \\ldots", verbatim = NULL)
>>     Docs: function(x, bottom_border = "\hline", bottom_all_pages = NULL,
>>                    bottom_last_page = NULL, subsequent_page_notification
>>                    = "continued ...", verbatim = NULL)
>>     Mismatches in argument default values:
>>       Name: 'bottom_border' Code: "\\hline" Docs: "\hline"
>>       Name: 'subsequent_page_notification' Code: "continued \\ldots" Docs:
>> "continued ..."
>>
>> Thanks,
>>
>> Bill
>>
>> -----Original Message-----
>> From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
>> Sent: Friday, August 23, 2019 11:27 AM
>> To: bill at denney.ws; r-package-devel at r-project.org
>> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Hi Bill,
>>
>> Sorry, I misunderstood the question.
>>
>> To check if the problem is with R's tools, run
>> 'utils::prompt(topic_long_table_header)" and see the usage section of the
>> generated file. Presumably, this should be the 'canonical way' to write the
>> usage entry for the function.
>> You can copy and paste it in the Rd file generated by roxygen2, then run 'R
>> CMD build' and 'R CMD check' (outside devtools).
>>
>> Georgi
>>
>>
>> -----Original Message-----
>> From: bill at denney.ws [mailto:bill at denney.ws]
>> Sent: 23 August 2019 15:27
>> To: Georgi Boshnakov; r-package-devel at r-project.org
>> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Hi Georgi,
>>
>> I'm not trying to use it as part of my documentation, it is one of my
>> function arguments.  I want the function argument to be displayed correctly
>> in the help, but it is not.  I'm curious how I should document the
>> "subsequent_page_notification" function argument in Rd.
>>
>> Specifically, the actual function definition (R code) looks like:
>>
>> R code:
>> --------------
>> topic_long_table_header <- function(x,
>>                                       col_names=NULL,
>>                                       above_col_names="\\hline",
>> below_col_names="\\hline",
>>                                       subsequent_page_notification="\\ldots
>> continued",
>>                                       latex_header=NULL) {
>>     # The function body
>> }
>> --------------
>>
>> So, I'm not trying to use LaTeX in the .Rd file; I'm trying to use it in R,
>> and I'm then copying it into the .Rd with extra escaping for the backslashes
>> (well, roxygen2 is doing the extra escaping).
>>
>> Rd text
>> --------------
>> topic_long_table_header(x, col_names = NULL,
>>     above_col_names = "\\\\hline", below_col_names = "\\\\hline",
>>     subsequent_page_notification = "\\\\ldots continued",
>>     latex_header = NULL)
>> --------------
>>
>> Thanks,
>>
>> Bill
>>
>> -----Original Message-----
>> From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
>> Sent: Friday, August 23, 2019 9:52 AM
>> To: bill at denney.ws; r-package-devel at r-project.org
>> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Rd is not LaTeX, although it resembles it.  You should use only markup
>> described in WRE.
>> For example, \dots is for the use case you mention.
>>
>> Georgi Boshnakov
>>
>>
>>
>>
>>
>> -----Original Message-----
>> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On
>> Behalf Of bill at denney.ws
>> Sent: 23 August 2019 04:15
>> To: r-package-devel at r-project.org
>> Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Hello,
>>
>>    
>>
>> Does anyone know how to include verbatim \ldots (and maybe other LaTeX) in
>> an .Rd file correctly?
>>
>>    
>>
>> When LaTeX is in the default arguments for a function, the code is
>> interpreted which makes the documentation not match the default formal
>> arguments.
>>
>>    
>>
>> An example is:
>>
>> https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
>> 7db5ef30368dc33/R/topic_long_table_header_footer.R#L20
>>
>>    
>>
>> Which yields:
>>
>> https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211533cb6e
>> 7db5ef30368dc33/man/topic_long_table_header.Rd#L10
>>
>>    
>>
>> Which gives the following warning with `devtools::check()`:
>>
>> ```
>>
>> checking for code/documentation mismatches ... WARNING
>>
>> Codoc mismatches from documentation object 'topic_long_table_header':
>>
>> topic_long_table_header
>>
>>     Code: function(x, col_names = NULL, above_col_names = "\\hline
>> <file://hline> ",
>>
>>                    below_col_names = "\\hline <file://hline> ",
>>
>>                    subsequent_page_notification = "\\ldots continued
>> <file://ldots%20continued> ",
>>
>>                    latex_header = NULL)
>>
>>     Docs: function(x, col_names = NULL, above_col_names = "\\hline
>> <file://hline> ",
>>
>>                    below_col_names = "\\hline <file://hline> ",
>>
>>                    subsequent_page_notification = "\... continued",
>>
>>                    latex_header = NULL)
>>
>> ```
>>
>>    
>>
>> I'm not sure, but I think that the solution is to add more protection to the
>> \s when generating the roxygen or perhaps wrapping the arguments in some
>> form of verbatim block (if it's available).
>>
>>    
>>
>> Thanks,
>>
>>    
>>
>> Bill
>>
>>    
>>
>> P.S. This is also discussed in https://github.com/r-lib/roxygen2/issues/837
>> where it appears to be related to the conversion of .Rd to help files not
>> the roxygen step.
>>
>>    
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>


From biii m@iii@g oii de@@ey@ws  Sat Aug 24 15:46:58 2019
From: biii m@iii@g oii de@@ey@ws (biii m@iii@g oii de@@ey@ws)
Date: Sat, 24 Aug 2019 09:46:58 -0400
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
In-Reply-To: <e756ba80-9828-a110-5598-6e744d16cc9b@gmail.com>
References: <010201d55960$f855e950$e901bbf0$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EB3@MBXP01.ds.man.ac.uk>
 <015601d559be$d2d39e80$787adb80$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EE2@MBXP01.ds.man.ac.uk>
 <019a01d559d8$f26e71b0$d74b5510$@denney.ws>
 <f967365d-7dd4-d109-1396-14dc8d51c223@gmail.com>
 <e756ba80-9828-a110-5598-6e744d16cc9b@gmail.com>
Message-ID: <026701d55a82$66e771f0$34b655d0$@denney.ws>

Hi Duncan,

The original Rd generated by roxygen2 had 4 backslashes:

https://github.com/billdenney/TopicLongTableR/blob/master/man/topic_long_table_header.Rd#L9

That generated a similar issue but check showed "\..." (backslash then 3 dots) instead of what is shown in the 2 backslashes case when check showed just "...".

So, while I agree that 4 backslashes would make the most sense for the .Rd file, there is still an issue somewhere with that 4 backslashes case.

Thanks,

Bill

-----Original Message-----
From: Duncan Murdoch <murdoch.duncan at gmail.com> 
Sent: Saturday, August 24, 2019 8:37 AM
To: bill at denney.ws; 'Georgi Boshnakov' <georgi.boshnakov at manchester.ac.uk>; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Literal LaTeX Text in Function Arguments

On 24/08/2019 7:35 a.m., Duncan Murdoch wrote:
> On 23/08/2019 1:33 p.m., bill at denney.ws wrote:
>> Hi Georgi,
>>
>> Thanks for this pointer.  My guess at this point is that I've found a 
>> bug (or maybe a couple of bugs with 'utils::prompt()' and with the Rd 
>> to help conversion), but let me know if you think otherwise.
> 
> It's certainly not a bug in utils:prompt:  that's never called except 
> by the user.

Actually, that's wrong.  utils::prompt() is generating bad code:  you need to have 4 backslashes in order to display 2.  It is just showing the string as it would be deparsed for display, it isn't modifying it so that it is appropriate as Rd source.

Duncan Murdoch


> 
> It might be a bug in the .Rd parsing, but I don't think so, because 
> I'm not seeing it when I write the .Rd file manually and view it in HTML.
> 
> It's most likely a bug in the check code, because I am seeing the same 
> "Codoc mismatches" error as you are.  I'm also seeing it in the pdf 
> display of the help page, but not in the HTML or text displays.
> 
> Duncan Murdoch
> 
>>
>> I just did that way, and the usage lines that were generated by 
>> 'utils::prompt()' and copied into the docs are:
>>
>> topic_long_table_header(x, col_names = NULL,
>>     above_col_names = "\\hline", below_col_names = "\\hline",
>>     subsequent_page_notification = "\\ldots continued",
>>     latex_header = NULL, verbatim = NULL)
>>
>> topic_long_table_footer(x, bottom_border = "\\hline",
>>     bottom_all_pages = NULL, bottom_last_page = NULL,
>>     subsequent_page_notification = "continued \\ldots",
>>     verbatim = NULL)
>>
>> It is giving a very similar error with 'R CMD check' (outside devtools).
>> The escape of the backslashes appears to be needed, but "\\ldots" 
>> continues to be translated into "...":
>>
>> Codoc mismatches from documentation object 'topic_long_table_header':
>> topic_long_table_header
>>     Code: function(x, col_names = NULL, above_col_names = "\\hline",
>>                    below_col_names = "\\hline",
>>                    subsequent_page_notification = "\\ldots continued",
>>                    latex_header = NULL, verbatim = NULL)
>>     Docs: function(x, col_names = NULL, above_col_names = "\hline",
>>                    below_col_names = "\hline",
>>                    subsequent_page_notification = "... continued",
>>                    latex_header = NULL, verbatim = NULL)
>>     Mismatches in argument default values:
>>       Name: 'above_col_names' Code: "\\hline" Docs: "\hline"
>>       Name: 'below_col_names' Code: "\\hline" Docs: "\hline"
>>       Name: 'subsequent_page_notification' Code: "\\ldots continued" Docs:
>> "... continued"
>> topic_long_table_footer
>>     Code: function(x, bottom_border = "\\hline", bottom_all_pages = NULL,
>>                    bottom_last_page = NULL, subsequent_page_notification
>>                    = "continued \\ldots", verbatim = NULL)
>>     Docs: function(x, bottom_border = "\hline", bottom_all_pages = NULL,
>>                    bottom_last_page = NULL, subsequent_page_notification
>>                    = "continued ...", verbatim = NULL)
>>     Mismatches in argument default values:
>>       Name: 'bottom_border' Code: "\\hline" Docs: "\hline"
>>       Name: 'subsequent_page_notification' Code: "continued \\ldots" Docs:
>> "continued ..."
>>
>> Thanks,
>>
>> Bill
>>
>> -----Original Message-----
>> From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
>> Sent: Friday, August 23, 2019 11:27 AM
>> To: bill at denney.ws; r-package-devel at r-project.org
>> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Hi Bill,
>>
>> Sorry, I misunderstood the question.
>>
>> To check if the problem is with R's tools, run 
>> 'utils::prompt(topic_long_table_header)" and see the usage section of 
>> the generated file. Presumably, this should be the 'canonical way' to 
>> write the usage entry for the function.
>> You can copy and paste it in the Rd file generated by roxygen2, then 
>> run 'R CMD build' and 'R CMD check' (outside devtools).
>>
>> Georgi
>>
>>
>> -----Original Message-----
>> From: bill at denney.ws [mailto:bill at denney.ws]
>> Sent: 23 August 2019 15:27
>> To: Georgi Boshnakov; r-package-devel at r-project.org
>> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Hi Georgi,
>>
>> I'm not trying to use it as part of my documentation, it is one of my 
>> function arguments.  I want the function argument to be displayed 
>> correctly in the help, but it is not.  I'm curious how I should 
>> document the "subsequent_page_notification" function argument in Rd.
>>
>> Specifically, the actual function definition (R code) looks like:
>>
>> R code:
>> --------------
>> topic_long_table_header <- function(x,
>>                                       col_names=NULL,
>>                                       above_col_names="\\hline", 
>> below_col_names="\\hline",
>>                                       
>> subsequent_page_notification="\\ldots
>> continued",
>>                                       latex_header=NULL) {
>>     # The function body
>> }
>> --------------
>>
>> So, I'm not trying to use LaTeX in the .Rd file; I'm trying to use it 
>> in R, and I'm then copying it into the .Rd with extra escaping for 
>> the backslashes (well, roxygen2 is doing the extra escaping).
>>
>> Rd text
>> --------------
>> topic_long_table_header(x, col_names = NULL,
>>     above_col_names = "\\\\hline", below_col_names = "\\\\hline",
>>     subsequent_page_notification = "\\\\ldots continued",
>>     latex_header = NULL)
>> --------------
>>
>> Thanks,
>>
>> Bill
>>
>> -----Original Message-----
>> From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
>> Sent: Friday, August 23, 2019 9:52 AM
>> To: bill at denney.ws; r-package-devel at r-project.org
>> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Rd is not LaTeX, although it resembles it.  You should use only 
>> markup described in WRE.
>> For example, \dots is for the use case you mention.
>>
>> Georgi Boshnakov
>>
>>
>>
>>
>>
>> -----Original Message-----
>> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] 
>> On Behalf Of bill at denney.ws
>> Sent: 23 August 2019 04:15
>> To: r-package-devel at r-project.org
>> Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Hello,
>>
>>    
>>
>> Does anyone know how to include verbatim \ldots (and maybe other 
>> LaTeX) in an .Rd file correctly?
>>
>>    
>>
>> When LaTeX is in the default arguments for a function, the code is 
>> interpreted which makes the documentation not match the default 
>> formal arguments.
>>
>>    
>>
>> An example is:
>>
>> https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211
>> 533cb6e
>> 7db5ef30368dc33/R/topic_long_table_header_footer.R#L20
>>
>>    
>>
>> Which yields:
>>
>> https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211
>> 533cb6e
>> 7db5ef30368dc33/man/topic_long_table_header.Rd#L10
>>
>>    
>>
>> Which gives the following warning with `devtools::check()`:
>>
>> ```
>>
>> checking for code/documentation mismatches ... WARNING
>>
>> Codoc mismatches from documentation object 'topic_long_table_header':
>>
>> topic_long_table_header
>>
>>     Code: function(x, col_names = NULL, above_col_names = "\\hline 
>> <file://hline> ",
>>
>>                    below_col_names = "\\hline <file://hline> ",
>>
>>                    subsequent_page_notification = "\\ldots continued 
>> <file://ldots%20continued> ",
>>
>>                    latex_header = NULL)
>>
>>     Docs: function(x, col_names = NULL, above_col_names = "\\hline 
>> <file://hline> ",
>>
>>                    below_col_names = "\\hline <file://hline> ",
>>
>>                    subsequent_page_notification = "\... continued",
>>
>>                    latex_header = NULL)
>>
>> ```
>>
>>    
>>
>> I'm not sure, but I think that the solution is to add more protection 
>> to the \s when generating the roxygen or perhaps wrapping the 
>> arguments in some form of verbatim block (if it's available).
>>
>>    
>>
>> Thanks,
>>
>>    
>>
>> Bill
>>
>>    
>>
>> P.S. This is also discussed in 
>> https://github.com/r-lib/roxygen2/issues/837
>> where it appears to be related to the conversion of .Rd to help files 
>> not the roxygen step.
>>
>>    
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list 
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list 
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sat Aug 24 16:36:44 2019
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin Coombes)
Date: Sat, 24 Aug 2019 10:36:44 -0400
Subject: [R-pkg-devel] NAMESPACE issue and grDevices
Message-ID: <55a3a9f1-f779-2554-02ea-64ca8f1b6aa6@gmail.com>

Hi,

I've been building a package and hit a NAMESPACE issue that took a while 
to resolve.

My package implements a (new) generic function, and the method for a 
package in the class calls the "smoothScatter" function from the 
"graphics" package. I could build and install the package successfully, 
and when I used the generic function, it worked just fine.

However, when I ran "R CMD check --as-cran", it threw an error from both 
the examples in man pages and a test script. Specifically, the error was 
"package KernSmooth not available". I eventually worked around this 
problem by changing the DESCRIPTION file to "IMPORT KernSmooth" (even 
though I didn't have to actually import anything in "NAMESPACE").

The underlying issue appears to be that
 ??? graphics::smoothScatter
calls a non-exported function from "grDevices"
 ???? grDevices:::.smoothScatterCalcDensity
which in turn calls an explicitly qualified function from "KernSmooth"
 ??? KernSmooth::bkde2D

To complicate matters
 ??? graphics IMPORTs grDevices
but
 ??? grDevices only SUGGESTs KernSmooth.

Since my package already IMPORTed the graphics package and had
 ??? importFrom("graphics", "smoothScatter")
in the NAMESPACE, I was surprised that I had to track back through the 
code to find this dependency and had to make it explicitly known within 
the interface to my package.

Is there something else my package should do? Or should "grDevices" 
actually IMPORT "KernSmooth"?

Best,
 ? Kevin


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Sat Aug 24 18:28:20 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Sat, 24 Aug 2019 16:28:20 +0000
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
In-Reply-To: <026701d55a82$66e771f0$34b655d0$@denney.ws>
References: <010201d55960$f855e950$e901bbf0$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EB3@MBXP01.ds.man.ac.uk>
 <015601d559be$d2d39e80$787adb80$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EE2@MBXP01.ds.man.ac.uk>
 <019a01d559d8$f26e71b0$d74b5510$@denney.ws>
 <f967365d-7dd4-d109-1396-14dc8d51c223@gmail.com>
 <e756ba80-9828-a110-5598-6e744d16cc9b@gmail.com>,
 <026701d55a82$66e771f0$34b655d0$@denney.ws>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E01CC777FE7@MBXP01.ds.man.ac.uk>

It seems that expansion of \ldots occurs in two different circumstances. 

1) The Rd2XXX converters treat specially \ldots and \dots but in different ways. tools::Rd2latex() defines in its body texify(), which, when called with a piece of R code, starts by replacing \ldots and \dots with        

     x <- psub("\\\\[l]{0,1}dots", "...", as.character(x))

Similarly, Rd2ex(), defines a function remap() which does a similar thing. The 'html' and 'txt' renderers also treat specially \dots and \ldots but only in more restricted cases. I didn't find what 'R CMD check' does. 

This might explain the differences between 'html'  and 'text' on the one hand, and 'pdf' output on the other hand. 
(as Duncan pointed out, he didn't see this in html).

But macros starting with '\l'  seem to be expanded in R code in all formats, if the backslash is not escaped, example a) below illustrates this. I redefined '\ldots' to demonstrate that this is  not due to the special treatment that literally replaces \ldots with '...' as above. I think this follows from the specification of Rd format p. 8 of the 'parseRd' document  referenced in my previous email. 


For illiustration, I added the following lines before the Usage section in Bill's file topic_long_table_header.Rd.

\renewcommand{\ldots}{Aaaargh }
\renewcommand{\lmydots}{Uuugh }
\renewcommand{\mydots}{this is mydots }

Here the Usage entry for the shown argument  only is modified (with 3 backslashes)

topic_long_table_header(x, col_names = NULL,
  (not changed)
  subsequent_page_notification = "\\\ldots continued \\\lmydots \\\mydots",
  (not changed)
   )

In the pdf file we see 

    subsequent_page_notification = "\Aaaargh continued \Uuugh \\mydots"

\ldots and \lmydots are expanded but \mydots is not. I believe that \lmydots is expanded since it starts with 'l', see my previous email. In this case, 'R CMD check' gives an additional warning about the unescaped backslash: 

    ...
    subsequent_page_notification = "<unescaped bksl>Aaaargh  continued \Uuugh  \\mydots"

This seems to happen since an attempt is made later to parse \Aaaargh and \Uuugh. If the Rd entry in the Usage section contaiin only one backslash, as in  
     subsequent_page_notification = "\ldots continued \lmydots \\\mydots",

then we get in all renderings: 

    subsequent_page_notification = "Aaaargh continued Uuugh \\mydots"

'R CMD check' also shows this text (and complains, since it obviously is not as in the function deifnition,



b) With proper escaping (using 4, instead of 3 backslashes above) we get (in the pdf rendering):

subsequent_page_notification = "\... continued \\lmydots \\mydots"

\ldots is expanded but the other macros are not. Note that the expansion of \ldots here is due is due to the specific rendering for LaTeX, which replaces \\ldots by three dots (...), and doesn't use my Rd definition for \ldots, suggesting that  this occurs at a different place.


Georgi Boshnakov
________________________________________
From: bill at denney.ws [bill at denney.ws]
Sent: 24 August 2019 14:46
To: 'Duncan Murdoch'; Georgi Boshnakov; r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hi Duncan,

The original Rd generated by roxygen2 had 4 backslashes:

https://github.com/billdenney/TopicLongTableR/blob/master/man/topic_long_table_header.Rd#L9

That generated a similar issue but check showed "\..." (backslash then 3 dots) instead of what is shown in the 2 backslashes case when check showed just "...".

So, while I agree that 4 backslashes would make the most sense for the .Rd file, there is still an issue somewhere with that 4 backslashes case.

Thanks,

Bill

-----Original Message-----
From: Duncan Murdoch <murdoch.duncan at gmail.com>
Sent: Saturday, August 24, 2019 8:37 AM
To: bill at denney.ws; 'Georgi Boshnakov' <georgi.boshnakov at manchester.ac.uk>; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Literal LaTeX Text in Function Arguments

On 24/08/2019 7:35 a.m., Duncan Murdoch wrote:
> On 23/08/2019 1:33 p.m., bill at denney.ws wrote:
>> Hi Georgi,
>>
>> Thanks for this pointer.  My guess at this point is that I've found a
>> bug (or maybe a couple of bugs with 'utils::prompt()' and with the Rd
>> to help conversion), but let me know if you think otherwise.
>
> It's certainly not a bug in utils:prompt:  that's never called except
> by the user.

Actually, that's wrong.  utils::prompt() is generating bad code:  you need to have 4 backslashes in order to display 2.  It is just showing the string as it would be deparsed for display, it isn't modifying it so that it is appropriate as Rd source.

Duncan Murdoch


>
> It might be a bug in the .Rd parsing, but I don't think so, because
> I'm not seeing it when I write the .Rd file manually and view it in HTML.
>
> It's most likely a bug in the check code, because I am seeing the same
> "Codoc mismatches" error as you are.  I'm also seeing it in the pdf
> display of the help page, but not in the HTML or text displays.
>
> Duncan Murdoch
>
>>
>> I just did that way, and the usage lines that were generated by
>> 'utils::prompt()' and copied into the docs are:
>>
>> topic_long_table_header(x, col_names = NULL,
>>     above_col_names = "\\hline", below_col_names = "\\hline",
>>     subsequent_page_notification = "\\ldots continued",
>>     latex_header = NULL, verbatim = NULL)
>>
>> topic_long_table_footer(x, bottom_border = "\\hline",
>>     bottom_all_pages = NULL, bottom_last_page = NULL,
>>     subsequent_page_notification = "continued \\ldots",
>>     verbatim = NULL)
>>
>> It is giving a very similar error with 'R CMD check' (outside devtools).
>> The escape of the backslashes appears to be needed, but "\\ldots"
>> continues to be translated into "...":
>>
>> Codoc mismatches from documentation object 'topic_long_table_header':
>> topic_long_table_header
>>     Code: function(x, col_names = NULL, above_col_names = "\\hline",
>>                    below_col_names = "\\hline",
>>                    subsequent_page_notification = "\\ldots continued",
>>                    latex_header = NULL, verbatim = NULL)
>>     Docs: function(x, col_names = NULL, above_col_names = "\hline",
>>                    below_col_names = "\hline",
>>                    subsequent_page_notification = "... continued",
>>                    latex_header = NULL, verbatim = NULL)
>>     Mismatches in argument default values:
>>       Name: 'above_col_names' Code: "\\hline" Docs: "\hline"
>>       Name: 'below_col_names' Code: "\\hline" Docs: "\hline"
>>       Name: 'subsequent_page_notification' Code: "\\ldots continued" Docs:
>> "... continued"
>> topic_long_table_footer
>>     Code: function(x, bottom_border = "\\hline", bottom_all_pages = NULL,
>>                    bottom_last_page = NULL, subsequent_page_notification
>>                    = "continued \\ldots", verbatim = NULL)
>>     Docs: function(x, bottom_border = "\hline", bottom_all_pages = NULL,
>>                    bottom_last_page = NULL, subsequent_page_notification
>>                    = "continued ...", verbatim = NULL)
>>     Mismatches in argument default values:
>>       Name: 'bottom_border' Code: "\\hline" Docs: "\hline"
>>       Name: 'subsequent_page_notification' Code: "continued \\ldots" Docs:
>> "continued ..."
>>
>> Thanks,
>>
>> Bill
>>
>> -----Original Message-----
>> From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
>> Sent: Friday, August 23, 2019 11:27 AM
>> To: bill at denney.ws; r-package-devel at r-project.org
>> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Hi Bill,
>>
>> Sorry, I misunderstood the question.
>>
>> To check if the problem is with R's tools, run
>> 'utils::prompt(topic_long_table_header)" and see the usage section of
>> the generated file. Presumably, this should be the 'canonical way' to
>> write the usage entry for the function.
>> You can copy and paste it in the Rd file generated by roxygen2, then
>> run 'R CMD build' and 'R CMD check' (outside devtools).
>>
>> Georgi
>>
>>
>> -----Original Message-----
>> From: bill at denney.ws [mailto:bill at denney.ws]
>> Sent: 23 August 2019 15:27
>> To: Georgi Boshnakov; r-package-devel at r-project.org
>> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Hi Georgi,
>>
>> I'm not trying to use it as part of my documentation, it is one of my
>> function arguments.  I want the function argument to be displayed
>> correctly in the help, but it is not.  I'm curious how I should
>> document the "subsequent_page_notification" function argument in Rd.
>>
>> Specifically, the actual function definition (R code) looks like:
>>
>> R code:
>> --------------
>> topic_long_table_header <- function(x,
>>                                       col_names=NULL,
>>                                       above_col_names="\\hline",
>> below_col_names="\\hline",
>>
>> subsequent_page_notification="\\ldots
>> continued",
>>                                       latex_header=NULL) {
>>     # The function body
>> }
>> --------------
>>
>> So, I'm not trying to use LaTeX in the .Rd file; I'm trying to use it
>> in R, and I'm then copying it into the .Rd with extra escaping for
>> the backslashes (well, roxygen2 is doing the extra escaping).
>>
>> Rd text
>> --------------
>> topic_long_table_header(x, col_names = NULL,
>>     above_col_names = "\\\\hline", below_col_names = "\\\\hline",
>>     subsequent_page_notification = "\\\\ldots continued",
>>     latex_header = NULL)
>> --------------
>>
>> Thanks,
>>
>> Bill
>>
>> -----Original Message-----
>> From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
>> Sent: Friday, August 23, 2019 9:52 AM
>> To: bill at denney.ws; r-package-devel at r-project.org
>> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Rd is not LaTeX, although it resembles it.  You should use only
>> markup described in WRE.
>> For example, \dots is for the use case you mention.
>>
>> Georgi Boshnakov
>>
>>
>>
>>
>>
>> -----Original Message-----
>> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org]
>> On Behalf Of bill at denney.ws
>> Sent: 23 August 2019 04:15
>> To: r-package-devel at r-project.org
>> Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Hello,
>>
>>
>>
>> Does anyone know how to include verbatim \ldots (and maybe other
>> LaTeX) in an .Rd file correctly?
>>
>>
>>
>> When LaTeX is in the default arguments for a function, the code is
>> interpreted which makes the documentation not match the default
>> formal arguments.
>>
>>
>>
>> An example is:
>>
>> https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211
>> 533cb6e
>> 7db5ef30368dc33/R/topic_long_table_header_footer.R#L20
>>
>>
>>
>> Which yields:
>>
>> https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211
>> 533cb6e
>> 7db5ef30368dc33/man/topic_long_table_header.Rd#L10
>>
>>
>>
>> Which gives the following warning with `devtools::check()`:
>>
>> ```
>>
>> checking for code/documentation mismatches ... WARNING
>>
>> Codoc mismatches from documentation object 'topic_long_table_header':
>>
>> topic_long_table_header
>>
>>     Code: function(x, col_names = NULL, above_col_names = "\\hline
>> <file://hline> ",
>>
>>                    below_col_names = "\\hline <file://hline> ",
>>
>>                    subsequent_page_notification = "\\ldots continued
>> <file://ldots%20continued> ",
>>
>>                    latex_header = NULL)
>>
>>     Docs: function(x, col_names = NULL, above_col_names = "\\hline
>> <file://hline> ",
>>
>>                    below_col_names = "\\hline <file://hline> ",
>>
>>                    subsequent_page_notification = "\... continued",
>>
>>                    latex_header = NULL)
>>
>> ```
>>
>>
>>
>> I'm not sure, but I think that the solution is to add more protection
>> to the \s when generating the roxygen or perhaps wrapping the
>> arguments in some form of verbatim block (if it's available).
>>
>>
>>
>> Thanks,
>>
>>
>>
>> Bill
>>
>>
>>
>> P.S. This is also discussed in
>> https://github.com/r-lib/roxygen2/issues/837
>> where it appears to be related to the conversion of .Rd to help files
>> not the roxygen step.
>>
>>
>>
>>
>>      [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>




From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Aug 24 19:03:40 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 24 Aug 2019 10:03:40 -0700
Subject: [R-pkg-devel] NAMESPACE issue and grDevices
In-Reply-To: <55a3a9f1-f779-2554-02ea-64ca8f1b6aa6@gmail.com>
References: <55a3a9f1-f779-2554-02ea-64ca8f1b6aa6@gmail.com>
Message-ID: <8C23F947-5DD6-4317-B697-09898FB36806@dcn.davis.ca.us>

I think yes. If a direct user of graphics opted not to call smoothScatter then they would have no need to even install KernSmooth. However, since generics automatically trigger loading of class-specific methods, one of which in your case includes that dependency, your package cannot avoid at least importing KernSmooth.

On August 24, 2019 7:36:44 AM PDT, Kevin Coombes <kevin.r.coombes at gmail.com> wrote:
>Hi,
>
>I've been building a package and hit a NAMESPACE issue that took a
>while 
>to resolve.
>
>My package implements a (new) generic function, and the method for a 
>package in the class calls the "smoothScatter" function from the 
>"graphics" package. I could build and install the package successfully,
>
>and when I used the generic function, it worked just fine.
>
>However, when I ran "R CMD check --as-cran", it threw an error from
>both 
>the examples in man pages and a test script. Specifically, the error
>was 
>"package KernSmooth not available". I eventually worked around this 
>problem by changing the DESCRIPTION file to "IMPORT KernSmooth" (even 
>though I didn't have to actually import anything in "NAMESPACE").
>
>The underlying issue appears to be that
> ??? graphics::smoothScatter
>calls a non-exported function from "grDevices"
> ???? grDevices:::.smoothScatterCalcDensity
>which in turn calls an explicitly qualified function from "KernSmooth"
> ??? KernSmooth::bkde2D
>
>To complicate matters
> ??? graphics IMPORTs grDevices
>but
> ??? grDevices only SUGGESTs KernSmooth.
>
>Since my package already IMPORTed the graphics package and had
> ??? importFrom("graphics", "smoothScatter")
>in the NAMESPACE, I was surprised that I had to track back through the 
>code to find this dependency and had to make it explicitly known within
>
>the interface to my package.
>
>Is there something else my package should do? Or should "grDevices" 
>actually IMPORT "KernSmooth"?
>
>Best,
> ? Kevin
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From biii m@iii@g oii de@@ey@ws  Sat Aug 24 20:07:44 2019
From: biii m@iii@g oii de@@ey@ws (biii m@iii@g oii de@@ey@ws)
Date: Sat, 24 Aug 2019 14:07:44 -0400
Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E01CC777FE7@MBXP01.ds.man.ac.uk>
References: <010201d55960$f855e950$e901bbf0$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EB3@MBXP01.ds.man.ac.uk>
 <015601d559be$d2d39e80$787adb80$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777EE2@MBXP01.ds.man.ac.uk>
 <019a01d559d8$f26e71b0$d74b5510$@denney.ws>
 <f967365d-7dd4-d109-1396-14dc8d51c223@gmail.com>
 <e756ba80-9828-a110-5598-6e744d16cc9b@gmail.com>,
 <026701d55a82$66e771f0$34b655d0$@denney.ws>
 <438D2EC9EAFE5946B2D5864670EA468E01CC777FE7@MBXP01.ds.man.ac.uk>
Message-ID: <02ab01d55aa6$d4912290$7db367b0$@denney.ws>

Hi Georgi,

Thank you for the detailed investigation!  It looks like you've found the
issue with the psub() call below.

It looks like a more complex regexp, "(?<!\\\\)(\\\\l?dots)", could help the
problem (note that perl is required).  Though it would leave open a bug that
if there were supposed to be a backslash before that were properly escaped
(\\\\\\ldots), it would leave the \ldots unmodified:

> gsub(pattern="(?<!\\\\)(\\\\l?dots)",
+      replacement="...",
+      x='\\ldots ab \\ldots cd \\\\ldots ef \\ldots gh \\\\dots ij \\dots
kl',
+      perl=TRUE)
[1] "... ab ... cd \\\\ldots ef ... gh \\\\dots ij ... kl"

Thanks,

Bill

-----Original Message-----
From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk> 
Sent: Saturday, August 24, 2019 12:28 PM
To: bill at denney.ws; 'Duncan Murdoch' <murdoch.duncan at gmail.com>;
r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

It seems that expansion of \ldots occurs in two different circumstances. 

1) The Rd2XXX converters treat specially \ldots and \dots but in different
ways. tools::Rd2latex() defines in its body texify(), which, when called
with a piece of R code, starts by replacing \ldots and \dots with        

     x <- psub("\\\\[l]{0,1}dots", "...", as.character(x))

Similarly, Rd2ex(), defines a function remap() which does a similar thing.
The 'html' and 'txt' renderers also treat specially \dots and \ldots but
only in more restricted cases. I didn't find what 'R CMD check' does. 

This might explain the differences between 'html'  and 'text' on the one
hand, and 'pdf' output on the other hand. 
(as Duncan pointed out, he didn't see this in html).

But macros starting with '\l'  seem to be expanded in R code in all formats,
if the backslash is not escaped, example a) below illustrates this. I
redefined '\ldots' to demonstrate that this is  not due to the special
treatment that literally replaces \ldots with '...' as above. I think this
follows from the specification of Rd format p. 8 of the 'parseRd' document
referenced in my previous email. 


For illiustration, I added the following lines before the Usage section in
Bill's file topic_long_table_header.Rd.

\renewcommand{\ldots}{Aaaargh }
\renewcommand{\lmydots}{Uuugh }
\renewcommand{\mydots}{this is mydots }

Here the Usage entry for the shown argument  only is modified (with 3
backslashes)

topic_long_table_header(x, col_names = NULL,
  (not changed)
  subsequent_page_notification = "\\\ldots continued \\\lmydots \\\mydots",
  (not changed)
   )

In the pdf file we see 

    subsequent_page_notification = "\Aaaargh continued \Uuugh \\mydots"

\ldots and \lmydots are expanded but \mydots is not. I believe that \lmydots
is expanded since it starts with 'l', see my previous email. In this case,
'R CMD check' gives an additional warning about the unescaped backslash: 

    ...
    subsequent_page_notification = "<unescaped bksl>Aaaargh  continued
\Uuugh  \\mydots"

This seems to happen since an attempt is made later to parse \Aaaargh and
\Uuugh. If the Rd entry in the Usage section contaiin only one backslash, as
in  
     subsequent_page_notification = "\ldots continued \lmydots \\\mydots",

then we get in all renderings: 

    subsequent_page_notification = "Aaaargh continued Uuugh \\mydots"

'R CMD check' also shows this text (and complains, since it obviously is not
as in the function deifnition,



b) With proper escaping (using 4, instead of 3 backslashes above) we get (in
the pdf rendering):

subsequent_page_notification = "\... continued \\lmydots \\mydots"

\ldots is expanded but the other macros are not. Note that the expansion of
\ldots here is due is due to the specific rendering for LaTeX, which
replaces \\ldots by three dots (...), and doesn't use my Rd definition for
\ldots, suggesting that  this occurs at a different place.


Georgi Boshnakov
________________________________________
From: bill at denney.ws [bill at denney.ws]
Sent: 24 August 2019 14:46
To: 'Duncan Murdoch'; Georgi Boshnakov; r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments

Hi Duncan,

The original Rd generated by roxygen2 had 4 backslashes:

https://github.com/billdenney/TopicLongTableR/blob/master/man/topic_long_tab
le_header.Rd#L9

That generated a similar issue but check showed "\..." (backslash then 3
dots) instead of what is shown in the 2 backslashes case when check showed
just "...".

So, while I agree that 4 backslashes would make the most sense for the .Rd
file, there is still an issue somewhere with that 4 backslashes case.

Thanks,

Bill

-----Original Message-----
From: Duncan Murdoch <murdoch.duncan at gmail.com>
Sent: Saturday, August 24, 2019 8:37 AM
To: bill at denney.ws; 'Georgi Boshnakov' <georgi.boshnakov at manchester.ac.uk>;
r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Literal LaTeX Text in Function Arguments

On 24/08/2019 7:35 a.m., Duncan Murdoch wrote:
> On 23/08/2019 1:33 p.m., bill at denney.ws wrote:
>> Hi Georgi,
>>
>> Thanks for this pointer.  My guess at this point is that I've found a 
>> bug (or maybe a couple of bugs with 'utils::prompt()' and with the Rd 
>> to help conversion), but let me know if you think otherwise.
>
> It's certainly not a bug in utils:prompt:  that's never called except 
> by the user.

Actually, that's wrong.  utils::prompt() is generating bad code:  you need
to have 4 backslashes in order to display 2.  It is just showing the string
as it would be deparsed for display, it isn't modifying it so that it is
appropriate as Rd source.

Duncan Murdoch


>
> It might be a bug in the .Rd parsing, but I don't think so, because 
> I'm not seeing it when I write the .Rd file manually and view it in HTML.
>
> It's most likely a bug in the check code, because I am seeing the same 
> "Codoc mismatches" error as you are.  I'm also seeing it in the pdf 
> display of the help page, but not in the HTML or text displays.
>
> Duncan Murdoch
>
>>
>> I just did that way, and the usage lines that were generated by 
>> 'utils::prompt()' and copied into the docs are:
>>
>> topic_long_table_header(x, col_names = NULL,
>>     above_col_names = "\\hline", below_col_names = "\\hline",
>>     subsequent_page_notification = "\\ldots continued",
>>     latex_header = NULL, verbatim = NULL)
>>
>> topic_long_table_footer(x, bottom_border = "\\hline",
>>     bottom_all_pages = NULL, bottom_last_page = NULL,
>>     subsequent_page_notification = "continued \\ldots",
>>     verbatim = NULL)
>>
>> It is giving a very similar error with 'R CMD check' (outside devtools).
>> The escape of the backslashes appears to be needed, but "\\ldots"
>> continues to be translated into "...":
>>
>> Codoc mismatches from documentation object 'topic_long_table_header':
>> topic_long_table_header
>>     Code: function(x, col_names = NULL, above_col_names = "\\hline",
>>                    below_col_names = "\\hline",
>>                    subsequent_page_notification = "\\ldots continued",
>>                    latex_header = NULL, verbatim = NULL)
>>     Docs: function(x, col_names = NULL, above_col_names = "\hline",
>>                    below_col_names = "\hline",
>>                    subsequent_page_notification = "... continued",
>>                    latex_header = NULL, verbatim = NULL)
>>     Mismatches in argument default values:
>>       Name: 'above_col_names' Code: "\\hline" Docs: "\hline"
>>       Name: 'below_col_names' Code: "\\hline" Docs: "\hline"
>>       Name: 'subsequent_page_notification' Code: "\\ldots continued"
Docs:
>> "... continued"
>> topic_long_table_footer
>>     Code: function(x, bottom_border = "\\hline", bottom_all_pages = NULL,
>>                    bottom_last_page = NULL, subsequent_page_notification
>>                    = "continued \\ldots", verbatim = NULL)
>>     Docs: function(x, bottom_border = "\hline", bottom_all_pages = NULL,
>>                    bottom_last_page = NULL, subsequent_page_notification
>>                    = "continued ...", verbatim = NULL)
>>     Mismatches in argument default values:
>>       Name: 'bottom_border' Code: "\\hline" Docs: "\hline"
>>       Name: 'subsequent_page_notification' Code: "continued \\ldots"
Docs:
>> "continued ..."
>>
>> Thanks,
>>
>> Bill
>>
>> -----Original Message-----
>> From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
>> Sent: Friday, August 23, 2019 11:27 AM
>> To: bill at denney.ws; r-package-devel at r-project.org
>> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Hi Bill,
>>
>> Sorry, I misunderstood the question.
>>
>> To check if the problem is with R's tools, run 
>> 'utils::prompt(topic_long_table_header)" and see the usage section of 
>> the generated file. Presumably, this should be the 'canonical way' to 
>> write the usage entry for the function.
>> You can copy and paste it in the Rd file generated by roxygen2, then 
>> run 'R CMD build' and 'R CMD check' (outside devtools).
>>
>> Georgi
>>
>>
>> -----Original Message-----
>> From: bill at denney.ws [mailto:bill at denney.ws]
>> Sent: 23 August 2019 15:27
>> To: Georgi Boshnakov; r-package-devel at r-project.org
>> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Hi Georgi,
>>
>> I'm not trying to use it as part of my documentation, it is one of my 
>> function arguments.  I want the function argument to be displayed 
>> correctly in the help, but it is not.  I'm curious how I should 
>> document the "subsequent_page_notification" function argument in Rd.
>>
>> Specifically, the actual function definition (R code) looks like:
>>
>> R code:
>> --------------
>> topic_long_table_header <- function(x,
>>                                       col_names=NULL,
>>                                       above_col_names="\\hline", 
>> below_col_names="\\hline",
>>
>> subsequent_page_notification="\\ldots
>> continued",
>>                                       latex_header=NULL) {
>>     # The function body
>> }
>> --------------
>>
>> So, I'm not trying to use LaTeX in the .Rd file; I'm trying to use it 
>> in R, and I'm then copying it into the .Rd with extra escaping for 
>> the backslashes (well, roxygen2 is doing the extra escaping).
>>
>> Rd text
>> --------------
>> topic_long_table_header(x, col_names = NULL,
>>     above_col_names = "\\\\hline", below_col_names = "\\\\hline",
>>     subsequent_page_notification = "\\\\ldots continued",
>>     latex_header = NULL)
>> --------------
>>
>> Thanks,
>>
>> Bill
>>
>> -----Original Message-----
>> From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
>> Sent: Friday, August 23, 2019 9:52 AM
>> To: bill at denney.ws; r-package-devel at r-project.org
>> Subject: RE: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Rd is not LaTeX, although it resembles it.  You should use only 
>> markup described in WRE.
>> For example, \dots is for the use case you mention.
>>
>> Georgi Boshnakov
>>
>>
>>
>>
>>
>> -----Original Message-----
>> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org]
>> On Behalf Of bill at denney.ws
>> Sent: 23 August 2019 04:15
>> To: r-package-devel at r-project.org
>> Subject: [R-pkg-devel] Literal LaTeX Text in Function Arguments
>>
>> Hello,
>>
>>
>>
>> Does anyone know how to include verbatim \ldots (and maybe other
>> LaTeX) in an .Rd file correctly?
>>
>>
>>
>> When LaTeX is in the default arguments for a function, the code is 
>> interpreted which makes the documentation not match the default 
>> formal arguments.
>>
>>
>>
>> An example is:
>>
>> https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211
>> 533cb6e
>> 7db5ef30368dc33/R/topic_long_table_header_footer.R#L20
>>
>>
>>
>> Which yields:
>>
>> https://github.com/billdenney/TopicLongTableR/blob/1338116767d90e8211
>> 533cb6e
>> 7db5ef30368dc33/man/topic_long_table_header.Rd#L10
>>
>>
>>
>> Which gives the following warning with `devtools::check()`:
>>
>> ```
>>
>> checking for code/documentation mismatches ... WARNING
>>
>> Codoc mismatches from documentation object 'topic_long_table_header':
>>
>> topic_long_table_header
>>
>>     Code: function(x, col_names = NULL, above_col_names = "\\hline 
>> <file://hline> ",
>>
>>                    below_col_names = "\\hline <file://hline> ",
>>
>>                    subsequent_page_notification = "\\ldots continued 
>> <file://ldots%20continued> ",
>>
>>                    latex_header = NULL)
>>
>>     Docs: function(x, col_names = NULL, above_col_names = "\\hline 
>> <file://hline> ",
>>
>>                    below_col_names = "\\hline <file://hline> ",
>>
>>                    subsequent_page_notification = "\... continued",
>>
>>                    latex_header = NULL)
>>
>> ```
>>
>>
>>
>> I'm not sure, but I think that the solution is to add more protection 
>> to the \s when generating the roxygen or perhaps wrapping the 
>> arguments in some form of verbatim block (if it's available).
>>
>>
>>
>> Thanks,
>>
>>
>>
>> Bill
>>
>>
>>
>> P.S. This is also discussed in
>> https://github.com/r-lib/roxygen2/issues/837
>> where it appears to be related to the conversion of .Rd to help files 
>> not the roxygen step.
>>
>>
>>
>>
>>      [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list 
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list 
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>


From @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@  Sat Aug 24 20:16:45 2019
From: @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@ (Sameh M. Abdulah)
Date: Sat, 24 Aug 2019 18:16:45 +0000
Subject: [R-pkg-devel] Linking with software dependencies
Message-ID: <35CFF3BA962CA3B8.92AEAF66-B6F3-4EFB-B0CC-6D60899D4EA4@mail.outlook.com>

Hi,

First, I am inviting all of you to try our recent package at https://github.com/ecrc/exageostatR. This package involves MLE estimation in large scale using leading-edge hardware architectures.

I have multiple questions:

(1) My package requires a pre-installation of Intel MKL. Is there any way to include the MKL installation with the package.

(2) The package depends on several c-based software which I automatically install through the package installation. Linking with these dependencies is a necessity. Thus, I did a simple trick for that as follows,
- I am installing all the software dependencies inside the default installation directory of the r-package then I am adding this path to the (PKG_CONFIG_PATH env) using this statement,
Sys.setenv(PKG_CONFIG_PATH=paste(Sys.getenv("PKG_CONFIG_PATH"),paste(.libPaths(),"exageostat/lib/pkgconfig",sep='/',collapse=':'),sep=':'))
By this way, I will be sure that all libraries are accessible by the package.
- Then, the installation can be done using install_git(url=" https://github.com/ecrc/exageostatR") for the GitHub repo.
The problem that I need to avoid the manual setting of the (PKG_CONFIG_PATH) so that I can, for example, upload my package to CRAN and simplify the installation process. I am doing the dependencies installation using the package configure file which can be accessed through https://github.com/ecrc/exageostatR/blob/master/configure.

(3) My package is only compatible with Linux and macOS. How to avoid CRAN windows checks.



Thanks,


--Sameh Abdulah

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Sat Aug 24 20:48:22 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sat, 24 Aug 2019 13:48:22 -0500
Subject: [R-pkg-devel] Linking with software dependencies
In-Reply-To: <35CFF3BA962CA3B8.92AEAF66-B6F3-4EFB-B0CC-6D60899D4EA4@mail.outlook.com>
References: <35CFF3BA962CA3B8.92AEAF66-B6F3-4EFB-B0CC-6D60899D4EA4@mail.outlook.com>
Message-ID: <23905.34422.414953.706828@rob.eddelbuettel.com>


On 24 August 2019 at 18:16, Sameh M. Abdulah wrote:
| (1) My package requires a pre-installation of Intel MKL. Is there any way to include the MKL installation with the package.

This (or a related) question was discussed here (or on a related list ?)
very recently. The recommendation, that I concur with, was NOT to do
that. BLAS and LAPACK are standard interfaces. Strive to support these
standards, and if and only if you find a more performant alternative
installed, use that.  In short you need to write `configure` code to sort out
the environment into which your package tries to install.  Somewhat
moderately difficult but doable, and there are examples in other packages.
 
| (2) The package depends on several c-based software which I automatically install through the package installation. Linking with these dependencies is a necessity. Thus, I did a simple trick for that as follows,
| - I am installing all the software dependencies inside the default installation directory of the r-package then I am adding this path to the (PKG_CONFIG_PATH env) using this statement,
| Sys.setenv(PKG_CONFIG_PATH=paste(Sys.getenv("PKG_CONFIG_PATH"),paste(.libPaths(),"exageostat/lib/pkgconfig",sep='/',collapse=':'),sep=':'))
| By this way, I will be sure that all libraries are accessible by the package.
| - Then, the installation can be done using install_git(url=" https://github.com/ecrc/exageostatR") for the GitHub repo.
| The problem that I need to avoid the manual setting of the (PKG_CONFIG_PATH) so that I can, for example, upload my package to CRAN and simplify the installation process. I am doing the dependencies installation using the package configure file which can be accessed through https://github.com/ecrc/exageostatR/blob/master/configure.

In short, this is a somewhat common but still difficult problem. We are
crossing over from R applications and packages to OS-level library provision.

A recent entry to this debate is an attempt in one CRAN package which (on
some platforms) discovers a YES or NO at installation time and then pivots
between a full and a rather limited installation.  To me this follows at best
the letter of the law, but not so much the spirit. Oh well.  It's on CRAN so
must be good enough.

Then again, the problem is difficult. I too have two candidate packages based
on solid work with other collaborators which I cannot get onto CRAN for lack
of library support, in particular on one somewhat non-maintained platform.
This is, to put it plainly, somewhat frustrating.

There is another approach which I have used with some packages.  Prebuild
libraries (or binaries) and fetch them at installation time.  Better than
nothing and results in working package but arguably still not ideal.

| (3) My package is only compatible with Linux and macOS. How to avoid CRAN windows checks.

That's easier.  Look at the documentation for the "OS_type:" field in the
DESCRIPTION file in the _Writing R Extensions_ manual that is your reference
for all these topics.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Aug 25 00:45:00 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 24 Aug 2019 18:45:00 -0400
Subject: [R-pkg-devel] NAMESPACE issue and grDevices
In-Reply-To: <55a3a9f1-f779-2554-02ea-64ca8f1b6aa6@gmail.com>
References: <55a3a9f1-f779-2554-02ea-64ca8f1b6aa6@gmail.com>
Message-ID: <ad7b4737-f9f4-1a87-31a0-5d68be20d17a@gmail.com>

On 24/08/2019 10:36 a.m., Kevin Coombes wrote:
> Hi,
> 
> I've been building a package and hit a NAMESPACE issue that took a while
> to resolve.
> 
> My package implements a (new) generic function, and the method for a
> package in the class calls the "smoothScatter" function from the
> "graphics" package. I could build and install the package successfully,
> and when I used the generic function, it worked just fine.
> 
> However, when I ran "R CMD check --as-cran", it threw an error from both
> the examples in man pages and a test script. Specifically, the error was
> "package KernSmooth not available". I eventually worked around this
> problem by changing the DESCRIPTION file to "IMPORT KernSmooth" (even
> though I didn't have to actually import anything in "NAMESPACE").
> 
> The underlying issue appears to be that
>   ??? graphics::smoothScatter
> calls a non-exported function from "grDevices"
>   ???? grDevices:::.smoothScatterCalcDensity
> which in turn calls an explicitly qualified function from "KernSmooth"
>   ??? KernSmooth::bkde2D

That looks like a bug in grDevices.  If it suggests KernSmooth, it 
should explicitly check whether it is installed before calling a 
function from it.

> 
> To complicate matters
>   ??? graphics IMPORTs grDevices
> but
>   ??? grDevices only SUGGESTs KernSmooth.
> 
> Since my package already IMPORTed the graphics package and had
>   ??? importFrom("graphics", "smoothScatter")
> in the NAMESPACE, I was surprised that I had to track back through the
> code to find this dependency and had to make it explicitly known within
> the interface to my package.
> 
> Is there something else my package should do? Or should "grDevices"
> actually IMPORT "KernSmooth"?

It could import it, or it could put in a check and a workaround if it is 
not found.

Now that you know about this bug, you could work around it by suggesting 
KernSmooth, and not calling graphics::smoothScatter unless KernSmooth is 
available.

Duncan Murdoch
> 
> Best,
>   ? Kevin
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@  Sun Aug 25 00:55:38 2019
From: @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@ (Sameh M. Abdulah)
Date: Sat, 24 Aug 2019 22:55:38 +0000
Subject: [R-pkg-devel] Linking with software dependencies
In-Reply-To: <23905.34422.414953.706828@rob.eddelbuettel.com>
References: <35CFF3BA962CA3B8.92AEAF66-B6F3-4EFB-B0CC-6D60899D4EA4@mail.outlook.com>,
 <23905.34422.414953.706828@rob.eddelbuettel.com>
Message-ID: <35CFF3BA962CA3B8.9338698E-0003-4605-9682-DB5CE241F0F6@mail.outlook.com>

Thanks Dirk for your answers. However, I am still confuse about the linking problem in question (2).  Is there anyway to set the pkg_config_path  instead of using the set_env function?

?Sameh


Get Outlook for iOS<https://aka.ms/o0ukef>
________________________________
From: Dirk Eddelbuettel <edd at debian.org>
Sent: Saturday, August 24, 2019 9:48 PM
To: Sameh M. Abdulah
Cc: r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Linking with software dependencies


On 24 August 2019 at 18:16, Sameh M. Abdulah wrote:
| (1) My package requires a pre-installation of Intel MKL. Is there any way to include the MKL installation with the package.

This (or a related) question was discussed here (or on a related list ?)
very recently. The recommendation, that I concur with, was NOT to do
that. BLAS and LAPACK are standard interfaces. Strive to support these
standards, and if and only if you find a more performant alternative
installed, use that. In short you need to write `configure` code to sort out
the environment into which your package tries to install. Somewhat
moderately difficult but doable, and there are examples in other packages.

| (2) The package depends on several c-based software which I automatically install through the package installation. Linking with these dependencies is a necessity. Thus, I did a simple trick for that as follows,
| - I am installing all the software dependencies inside the default installation directory of the r-package then I am adding this path to the (PKG_CONFIG_PATH env) using this statement,
| Sys.setenv(PKG_CONFIG_PATH=paste(Sys.getenv("PKG_CONFIG_PATH"),paste(.libPaths(),"exageostat/lib/pkgconfig",sep='/',collapse=':'),sep=':'))
| By this way, I will be sure that all libraries are accessible by the package.
| - Then, the installation can be done using install_git(url=" https://github.com/ecrc/exageostatR") for the GitHub repo.
| The problem that I need to avoid the manual setting of the (PKG_CONFIG_PATH) so that I can, for example, upload my package to CRAN and simplify the installation process. I am doing the dependencies installation using the package configure file which can be accessed through https://github.com/ecrc/exageostatR/blob/master/configure.

In short, this is a somewhat common but still difficult problem. We are
crossing over from R applications and packages to OS-level library provision.

A recent entry to this debate is an attempt in one CRAN package which (on
some platforms) discovers a YES or NO at installation time and then pivots
between a full and a rather limited installation. To me this follows at best
the letter of the law, but not so much the spirit. Oh well. It's on CRAN so
must be good enough.

Then again, the problem is difficult. I too have two candidate packages based
on solid work with other collaborators which I cannot get onto CRAN for lack
of library support, in particular on one somewhat non-maintained platform.
This is, to put it plainly, somewhat frustrating.

There is another approach which I have used with some packages. Prebuild
libraries (or binaries) and fetch them at installation time. Better than
nothing and results in working package but arguably still not ideal.

| (3) My package is only compatible with Linux and macOS. How to avoid CRAN windows checks.

That's easier. Look at the documentation for the "OS_type:" field in the
DESCRIPTION file in the _Writing R Extensions_ manual that is your reference
for all these topics.

Dirk

--
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Sun Aug 25 11:56:37 2019
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sun, 25 Aug 2019 12:56:37 +0300
Subject: [R-pkg-devel] No protocol specified
In-Reply-To: <273DCE84-721A-42D4-ADAF-8E1D1074F2AC@mathematik.uni-marburg.de>
References: <273DCE84-721A-42D4-ADAF-8E1D1074F2AC@mathematik.uni-marburg.de>
Message-ID: <20190825125637.0e01ad9c@Tarkus>

On Fri, 23 Aug 2019 09:18:07 +0200
"Dr. rer. nat. Michael Thrun" <mthrun at Mathematik.Uni-Marburg.de> wrote:

>> No protocol specified
> 
> Can anyone translate this note to me in a way that I know what the
> issue is?

I might be mistaken, but "No protocol specified" is an error frequently
returned by an X server [*] when a connection to the display can be
established, but the client fails to authenticate and is denied access.

If my diagnosis is true, the error message indicates a setup problem on
the machine running R CMD check, not a package problem. At the
very least, this error message does not seem to appear anywhere in the R
source code.

-- 
Best regards,
Ivan

[*] https://duckduckgo.com/html/?q=X%20%22No%20protocol%20specified%22


From cht@n|gut| @end|ng |rom u@p@br  Mon Aug 26 14:32:08 2019
From: cht@n|gut| @end|ng |rom u@p@br (Cristiane Hayumi Taniguti)
Date: Mon, 26 Aug 2019 09:32:08 -0300
Subject: [R-pkg-devel] Last released version FAIL
Message-ID: <CAGnmNJxkkJNybMay225my1Ea2-pTJNasE8ru0J7_7hYFkt1ciw@mail.gmail.com>

Dear list members,

My name is Cristiane, I am mantainer of onemap package. The current version
of the package in CRAN is having problems passing to cran check
<https://cran.r-project.org/web/checks/check_results_onemap.html>. I
already fixed all the problems and made other updates in a new version. I
submit this new version and the automatically CRAN check also pointed the
errors, warnings and notes of the last version. The question is: Do I need
to fix the errors of the last version and submit this version again or can
I just submit the new version?

The new version that I want to submit have only 2 NOTES
<https://win-builder.r-project.org/incoming_pretest/onemap_2.1.1008_20190822_212246/Debian/00check.log>

Thank you in advance,

Cristiane

	[[alternative HTML version deleted]]


From @eb@@t|@n@@nk@rgren @end|ng |rom @t@t|@t|k@uu@@e  Mon Aug 26 15:47:02 2019
From: @eb@@t|@n@@nk@rgren @end|ng |rom @t@t|@t|k@uu@@e (Sebastian Ankargren)
Date: Mon, 26 Aug 2019 13:47:02 +0000
Subject: [R-pkg-devel] 'configure' exists but is not executable
In-Reply-To: <160CFC4A-8D08-4CC2-B025-0FD723A33EC6@statistik.uu.se>
References: <160CFC4A-8D08-4CC2-B025-0FD723A33EC6@statistik.uu.se>
Message-ID: <847836A7-2894-4B4B-B4E7-84589043D57A@statistik.uu.se>

Dear package developers,

I have a package that is dependent upon Rcpp and RcppArmadillo and for this reason I use a configure file. On my local machine with:
R version 3.6.0 (2019-04-26)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Mojave 10.14.3

?my package passes R CMD check. However, on Travis CI I get

* installing *source* package ?mfbvar? ...
** using staged installation
ERROR: 'configure' exists but is not executable -- see the 'R Installation and Administration Manual'

This despite the configure file being executable locally. Some of my attempts at fixing this include:
- chmod +x configure
- removing configure, committing/pushing, putting configure back and chmod +x configure before committing/pushing again to ensure the executable version is pushed
- creating a new configure from configure.ac using autoconf

All of my attempts have been unsuccessful and I?m a little bit puzzled why it doesn?t work on Travis. Does anyone have any suggestions? The failure is present both on Linux and OS X. I am not sure whether the issue is specific to Travis, but I have no other ways of testing it before submitting to CRAN.

Travis link: https://travis-ci.org/ankargren/mfbvar
Github link: https://github.com/ankargren/mfbvar

Appreciate any input you might have!

Best,

Sebastian








N?r du har kontakt med oss p? Uppsala universitet med e-post s? inneb?r det att vi behandlar dina personuppgifter. F?r att l?sa mer om hur vi g?r det kan du l?sa h?r: http://www.uu.se/om-uu/dataskydd-personuppgifter/

E-mailing Uppsala University means that we will process your personal data. For more information on how this is performed, please read here: http://www.uu.se/en/about-uu/data-protection-policy

	[[alternative HTML version deleted]]


From M@x@Turgeon @end|ng |rom um@n|tob@@c@  Mon Aug 26 16:09:36 2019
From: M@x@Turgeon @end|ng |rom um@n|tob@@c@ (Max Turgeon)
Date: Mon, 26 Aug 2019 14:09:36 +0000
Subject: [R-pkg-devel] 'configure' exists but is not executable
In-Reply-To: <847836A7-2894-4B4B-B4E7-84589043D57A@statistik.uu.se>
References: <160CFC4A-8D08-4CC2-B025-0FD723A33EC6@statistik.uu.se>,
 <847836A7-2894-4B4B-B4E7-84589043D57A@statistik.uu.se>
Message-ID: <5dedcded86a94c2ab6596be531df6c12@umanitoba.ca>

Hi Sebastian,


Have you tried adding a line in your `.travis.yml` file that changes the permissions for `configure`? Something like this:


before_install:
  - chmod +x configure


Max Turgeon
Assistant Professor
Department of Statistics
Department of Computer Science
University of Manitoba
maxturgeon.ca<http://maxturgeon.ca>


________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Sebastian Ankargren <sebastian.ankargren at statistik.uu.se>
Sent: August 26, 2019 8:47:02 AM
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] 'configure' exists but is not executable

Dear package developers,

I have a package that is dependent upon Rcpp and RcppArmadillo and for this reason I use a configure file. On my local machine with:
R version 3.6.0 (2019-04-26)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Mojave 10.14.3

?my package passes R CMD check. However, on Travis CI I get

* installing *source* package ?mfbvar? ...
** using staged installation
ERROR: 'configure' exists but is not executable -- see the 'R Installation and Administration Manual'

This despite the configure file being executable locally. Some of my attempts at fixing this include:
- chmod +x configure
- removing configure, committing/pushing, putting configure back and chmod +x configure before committing/pushing again to ensure the executable version is pushed
- creating a new configure from configure.ac using autoconf

All of my attempts have been unsuccessful and I?m a little bit puzzled why it doesn?t work on Travis. Does anyone have any suggestions? The failure is present both on Linux and OS X. I am not sure whether the issue is specific to Travis, but I have no other ways of testing it before submitting to CRAN.

Travis link: https://travis-ci.org/ankargren/mfbvar
Github link: https://github.com/ankargren/mfbvar

Appreciate any input you might have!

Best,

Sebastian








N?r du har kontakt med oss p? Uppsala universitet med e-post s? inneb?r det att vi behandlar dina personuppgifter. F?r att l?sa mer om hur vi g?r det kan du l?sa h?r: http://www.uu.se/om-uu/dataskydd-personuppgifter/

E-mailing Uppsala University means that we will process your personal data. For more information on how this is performed, please read here: http://www.uu.se/en/about-uu/data-protection-policy

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Mon Aug 26 16:20:04 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 26 Aug 2019 09:20:04 -0500
Subject: [R-pkg-devel] Last released version FAIL
In-Reply-To: <CAGnmNJxkkJNybMay225my1Ea2-pTJNasE8ru0J7_7hYFkt1ciw@mail.gmail.com>
References: <CAGnmNJxkkJNybMay225my1Ea2-pTJNasE8ru0J7_7hYFkt1ciw@mail.gmail.com>
Message-ID: <23907.60052.629961.85346@rob.eddelbuettel.com>


Hi Christiane,

On 26 August 2019 at 09:32, Cristiane Hayumi Taniguti wrote:
| My name is Cristiane, I am mantainer of onemap package. The current version
| of the package in CRAN is having problems passing to cran check
| <https://cran.r-project.org/web/checks/check_results_onemap.html>. I
| already fixed all the problems and made other updates in a new version. I
| submit this new version and the automatically CRAN check also pointed the
| errors, warnings and notes of the last version. The question is: Do I need
| to fix the errors of the last version and submit this version again or can
| I just submit the new version?

The general idea is that the new version addresses the issues shown at CRAN
for the current (and to-be-replaced) version.
 
| The new version that I want to submit have only 2 NOTES
| <https://win-builder.r-project.org/incoming_pretest/onemap_2.1.1008_20190822_212246/Debian/00check.log>

The general idea is that you look at the NOTE, WARNING and ERROR results
_while preparing your package_ so that your upload has (ideally) none. I
think you should be able to fix both

  Found the following (possibly) invalid file URI:
    URI: www.r-project.org
      From: inst/doc/Overview.html

and

  * checking for non-standard things in the check directory ... NOTE
  Found the following files/directories:
    ?SegregationTests.jpg?
  * DONE

and it would be fair to the CRAN team if you did so before uploading.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From berryboe@@enkoo| @end|ng |rom hotm@||@com  Mon Aug 26 16:22:18 2019
From: berryboe@@enkoo| @end|ng |rom hotm@||@com (Berry Boessenkool)
Date: Mon, 26 Aug 2019 14:22:18 +0000
Subject: [R-pkg-devel] Last released version FAIL
In-Reply-To: <CAGnmNJxkkJNybMay225my1Ea2-pTJNasE8ru0J7_7hYFkt1ciw@mail.gmail.com>
References: <CAGnmNJxkkJNybMay225my1Ea2-pTJNasE8ru0J7_7hYFkt1ciw@mail.gmail.com>
Message-ID: <VI1P191MB07017F3FAD956746CE02CB82D5A10@VI1P191MB0701.EURP191.PROD.OUTLOOK.COM>


You should fix the problems in a new version and submit.
Did you per accident submit the old version?
Or did you get tricked by the part after "Current CRAN status"?

Regards,
Berry

PS:You could easily get rid of the two notes as well.
Looks like you need to put SegregationTests.jpg in .Rbuildignore and link with https prefix to https://www.r-project.org/.





________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Cristiane Hayumi Taniguti <chtaniguti at usp.br>
Sent: Monday, August 26, 2019 14:32
To: r-package-devel at r-project.org <r-package-devel at r-project.org>
Subject: [R-pkg-devel] Last released version FAIL

Dear list members,

My name is Cristiane, I am mantainer of onemap package. The current version
of the package in CRAN is having problems passing to cran check
<https://cran.r-project.org/web/checks/check_results_onemap.html>. I
already fixed all the problems and made other updates in a new version. I
submit this new version and the automatically CRAN check also pointed the
errors, warnings and notes of the last version. The question is: Do I need
to fix the errors of the last version and submit this version again or can
I just submit the new version?

The new version that I want to submit have only 2 NOTES
<https://win-builder.r-project.org/incoming_pretest/onemap_2.1.1008_20190822_212246/Debian/00check.log>

Thank you in advance,

Cristiane

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From @eb@@t|@n@@nk@rgren @end|ng |rom @t@t|@t|k@uu@@e  Mon Aug 26 17:07:07 2019
From: @eb@@t|@n@@nk@rgren @end|ng |rom @t@t|@t|k@uu@@e (Sebastian Ankargren)
Date: Mon, 26 Aug 2019 15:07:07 +0000
Subject: [R-pkg-devel] 'configure' exists but is not executable
In-Reply-To: <5dedcded86a94c2ab6596be531df6c12@umanitoba.ca>
References: <160CFC4A-8D08-4CC2-B025-0FD723A33EC6@statistik.uu.se>
 <847836A7-2894-4B4B-B4E7-84589043D57A@statistik.uu.se>
 <5dedcded86a94c2ab6596be531df6c12@umanitoba.ca>
Message-ID: <468B3414-75C0-4ED4-BA9B-B78E393FF9A7@statistik.uu.se>

Dear Max,

That fixes the issue completely on Travis ? thanks. However, it worries me a little that I might need something similar for the build on CRAN? Or should I simply just assume that this is an issue specific to Travis?

/Sebastian

On 26 Aug 2019, at 16:09, Max Turgeon <Max.Turgeon at umanitoba.ca<mailto:Max.Turgeon at umanitoba.ca>> wrote:

Hi Sebastian,

Have you tried adding a line in your `.travis.yml` file that changes the permissions for `configure`? Something like this:


before_install:
  - chmod +x configure


Max Turgeon
Assistant Professor
Department of Statistics
Department of Computer Science
University of Manitoba
maxturgeon.ca<https://urlproxy.sunet.se/canit/urlproxy.php?_q=aHR0cDovL21heHR1cmdlb24uY2E%3D&_s=c2ViYXN0aWFuLmFua2FyZ3JlbkBzdGF0aXN0aWsudXUuc2U%3D&_c=2483e576&_r=dXUtc2U%3D>

________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org<mailto:r-package-devel-bounces at r-project.org>> on behalf of Sebastian Ankargren <sebastian.ankargren at statistik.uu.se<mailto:sebastian.ankargren at statistik.uu.se>>
Sent: August 26, 2019 8:47:02 AM
To: r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>
Subject: [R-pkg-devel] 'configure' exists but is not executable

Dear package developers,

I have a package that is dependent upon Rcpp and RcppArmadillo and for this reason I use a configure file. On my local machine with:
R version 3.6.0 (2019-04-26)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Mojave 10.14.3

?my package passes R CMD check. However, on Travis CI I get

* installing *source* package ?mfbvar? ...
** using staged installation
ERROR: 'configure' exists but is not executable -- see the 'R Installation and Administration Manual'

This despite the configure file being executable locally. Some of my attempts at fixing this include:
- chmod +x configure
- removing configure, committing/pushing, putting configure back and chmod +x configure before committing/pushing again to ensure the executable version is pushed
- creating a new configure from configure.ac using autoconf

All of my attempts have been unsuccessful and I?m a little bit puzzled why it doesn?t work on Travis. Does anyone have any suggestions? The failure is present both on Linux and OS X. I am not sure whether the issue is specific to Travis, but I have no other ways of testing it before submitting to CRAN.

Travis link: https://travis-ci.org/ankargren/mfbvar
Github link: https://github.com/ankargren/mfbvar

Appreciate any input you might have!

Best,

Sebastian








N?r du har kontakt med oss p? Uppsala universitet med e-post s? inneb?r det att vi behandlar dina personuppgifter. F?r att l?sa mer om hur vi g?r det kan du l?sa h?r: http://www.uu.se/om-uu/dataskydd-personuppgifter/

E-mailing Uppsala University means that we will process your personal data. For more information on how this is performed, please read here:http://www.uu.se/en/about-uu/data-protection-policy

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From M@x@Turgeon @end|ng |rom um@n|tob@@c@  Mon Aug 26 17:21:49 2019
From: M@x@Turgeon @end|ng |rom um@n|tob@@c@ (Max Turgeon)
Date: Mon, 26 Aug 2019 15:21:49 +0000
Subject: [R-pkg-devel] 'configure' exists but is not executable
In-Reply-To: <468B3414-75C0-4ED4-BA9B-B78E393FF9A7@statistik.uu.se>
References: <160CFC4A-8D08-4CC2-B025-0FD723A33EC6@statistik.uu.se>
 <847836A7-2894-4B4B-B4E7-84589043D57A@statistik.uu.se>
 <5dedcded86a94c2ab6596be531df6c12@umanitoba.ca>,
 <468B3414-75C0-4ED4-BA9B-B78E393FF9A7@statistik.uu.se>
Message-ID: <ccc8681856794df9a8d5fff2b94d13e7@umanitoba.ca>

I'm glad to hear it worked. As for CRAN, I would assume they take care of permissions on their end somehow, I can't say for sure. But a certain number of packages use configure scripts (e.g. RcppArmadillo and RcppParallel), so if anything special is required, I would look at their respective Github repositories.


Max Turgeon
Assistant Professor
Department of Statistics
Department of Computer Science
University of Manitoba
maxturgeon.ca<http://maxturgeon.ca>


________________________________
From: Sebastian Ankargren <sebastian.ankargren at statistik.uu.se>
Sent: August 26, 2019 10:07:07 AM
To: Max Turgeon; r-package-devel at r-project.org
Subject: Re: 'configure' exists but is not executable

Dear Max,

That fixes the issue completely on Travis ? thanks. However, it worries me a little that I might need something similar for the build on CRAN? Or should I simply just assume that this is an issue specific to Travis?

/Sebastian

On 26 Aug 2019, at 16:09, Max Turgeon <Max.Turgeon at umanitoba.ca<mailto:Max.Turgeon at umanitoba.ca>> wrote:

Hi Sebastian,

Have you tried adding a line in your `.travis.yml` file that changes the permissions for `configure`? Something like this:


before_install:
  - chmod +x configure


Max Turgeon
Assistant Professor
Department of Statistics
Department of Computer Science
University of Manitoba
maxturgeon.ca<https://urlproxy.sunet.se/canit/urlproxy.php?_q=aHR0cDovL21heHR1cmdlb24uY2E%3D&_s=c2ViYXN0aWFuLmFua2FyZ3JlbkBzdGF0aXN0aWsudXUuc2U%3D&_c=2483e576&_r=dXUtc2U%3D>

________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org<mailto:r-package-devel-bounces at r-project.org>> on behalf of Sebastian Ankargren <sebastian.ankargren at statistik.uu.se<mailto:sebastian.ankargren at statistik.uu.se>>
Sent: August 26, 2019 8:47:02 AM
To: r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>
Subject: [R-pkg-devel] 'configure' exists but is not executable

Dear package developers,

I have a package that is dependent upon Rcpp and RcppArmadillo and for this reason I use a configure file. On my local machine with:
R version 3.6.0 (2019-04-26)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Mojave 10.14.3

?my package passes R CMD check. However, on Travis CI I get

* installing *source* package ?mfbvar? ...
** using staged installation
ERROR: 'configure' exists but is not executable -- see the 'R Installation and Administration Manual'

This despite the configure file being executable locally. Some of my attempts at fixing this include:
- chmod +x configure
- removing configure, committing/pushing, putting configure back and chmod +x configure before committing/pushing again to ensure the executable version is pushed
- creating a new configure from configure.ac using autoconf

All of my attempts have been unsuccessful and I?m a little bit puzzled why it doesn?t work on Travis. Does anyone have any suggestions? The failure is present both on Linux and OS X. I am not sure whether the issue is specific to Travis, but I have no other ways of testing it before submitting to CRAN.

Travis link: https://travis-ci.org/ankargren/mfbvar
Github link: https://github.com/ankargren/mfbvar

Appreciate any input you might have!

Best,

Sebastian








N?r du har kontakt med oss p? Uppsala universitet med e-post s? inneb?r det att vi behandlar dina personuppgifter. F?r att l?sa mer om hur vi g?r det kan du l?sa h?r: http://www.uu.se/om-uu/dataskydd-personuppgifter/

E-mailing Uppsala University means that we will process your personal data. For more information on how this is performed, please read here:http://www.uu.se/en/about-uu/data-protection-policy

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From cht@n|gut| @end|ng |rom u@p@br  Mon Aug 26 18:21:06 2019
From: cht@n|gut| @end|ng |rom u@p@br (Cristiane Hayumi Taniguti)
Date: Mon, 26 Aug 2019 13:21:06 -0300
Subject: [R-pkg-devel] Last released version FAIL
In-Reply-To: <VI1P191MB07017F3FAD956746CE02CB82D5A10@VI1P191MB0701.EURP191.PROD.OUTLOOK.COM>
References: <CAGnmNJxkkJNybMay225my1Ea2-pTJNasE8ru0J7_7hYFkt1ciw@mail.gmail.com>
 <VI1P191MB07017F3FAD956746CE02CB82D5A10@VI1P191MB0701.EURP191.PROD.OUTLOOK.COM>
Message-ID: <CAGnmNJyrvduqY0Dc4LoQKGtdta5kmRJqik04v_Tug+jZa0TagQ@mail.gmail.com>

Thank you for the answers!

Yes, I got tricked by the "Current CRAN status" in the automatically answer
of CRAN submission.
At the email body they pointed the FAIL in the current version and ask to
"Please fix all problems and resubmit a fixed version via the webform.".
I thought that the fail of the current version should also be repaired and
resubmitted with the same version number, than users can also be able to
install an older version. But now I understood that this current version
will be replaced by the new version, I should not worry about the old
problems.

I will just fix the two simple NOTEs of the new version and it should be
enough.

Thank you again,

Cris


On Mon, Aug 26, 2019 at 11:22 AM Berry Boessenkool <
berryboessenkool at hotmail.com> wrote:

>
> You should fix the problems in a new version and submit.
> Did you per accident submit the old version?
> Or did you get tricked by the part after "Current CRAN status"?
>
> Regards,
> Berry
>
> PS:You could easily get rid of the two notes as well.
> Looks like you need to put SegregationTests.jpg in .Rbuildignore and link
> with https prefix to https://www.r-project.org/.
>
>
>
>
>
> ------------------------------
> *From:* R-package-devel <r-package-devel-bounces at r-project.org> on behalf
> of Cristiane Hayumi Taniguti <chtaniguti at usp.br>
> *Sent:* Monday, August 26, 2019 14:32
> *To:* r-package-devel at r-project.org <r-package-devel at r-project.org>
> *Subject:* [R-pkg-devel] Last released version FAIL
>
> Dear list members,
>
> My name is Cristiane, I am mantainer of onemap package. The current version
> of the package in CRAN is having problems passing to cran check
> <https://cran.r-project.org/web/checks/check_results_onemap.html>. I
> already fixed all the problems and made other updates in a new version. I
> submit this new version and the automatically CRAN check also pointed the
> errors, warnings and notes of the last version. The question is: Do I need
> to fix the errors of the last version and submit this version again or can
> I just submit the new version?
>
> The new version that I want to submit have only 2 NOTES
> <
> https://win-builder.r-project.org/incoming_pretest/onemap_2.1.1008_20190822_212246/Debian/00check.log
> >
>
> Thank you in advance,
>
> Cristiane
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From @ergue|@@oko| @end|ng |rom gm@||@com  Fri Aug 30 11:10:09 2019
From: @ergue|@@oko| @end|ng |rom gm@||@com (Serguei Sokol)
Date: Fri, 30 Aug 2019 11:10:09 +0200
Subject: [R-pkg-devel] third part software dependency
Message-ID: <18799183-2647-badc-e051-f303a49dca59@gmail.com>

Hi,

I am preparing a new package r2sundials for submission to cran. It 
depends on third part software 
(https://computing.llnl.gov/projects/sundials). This will be my first 
submission of the kind so I am wondering how it is supposed to be tested 
so that I can reliably check the box "tested on R-devel" during 
submission process?
I suppose that sundials is not installed on windev. And even if it was, 
I need a particular option in this software (index size set to 32 bits) 
which is probably not activated in the hypothetical installation. So I 
cannot use win-builder.r-project.org.
Am I supposed to install current r-devel version and test my package on 
it locally?

And another question.
Recently, I had to fix many LTO (link time optimization) related issues 
in a third part software included in one of my old packages. Have I to 
test with LTO activated the new package too given that it is _not_ 
included in the package ?

Thanks to share your experience and wisdom.

Best,
Serguei.


From edd @end|ng |rom deb|@n@org  Fri Aug 30 14:24:43 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Fri, 30 Aug 2019 07:24:43 -0500
Subject: [R-pkg-devel] third part software dependency
In-Reply-To: <18799183-2647-badc-e051-f303a49dca59@gmail.com>
References: <18799183-2647-badc-e051-f303a49dca59@gmail.com>
Message-ID: <23913.5515.42756.121348@rob.eddelbuettel.com>


On 30 August 2019 at 11:10, Serguei Sokol wrote:
| I am preparing a new package r2sundials for submission to cran. It 
| depends on third part software 
| (https://computing.llnl.gov/projects/sundials). This will be my first 
| submission of the kind so I am wondering how it is supposed to be tested 
| so that I can reliably check the box "tested on R-devel" during 
| submission process?
| I suppose that sundials is not installed on windev. And even if it was, 
| I need a particular option in this software (index size set to 32 bits) 
| which is probably not activated in the hypothetical installation. So I 
| cannot use win-builder.r-project.org.
| Am I supposed to install current r-devel version and test my package on 
| it locally?

The builder.r-hub.io service is a good alternative. It offers twelve
different platforms, including a few r-devel ones.

That said, it won't have sundials either so you may have to pull sundials in
during configure or via Make dependencies or ...

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From pro|jcn@@h @end|ng |rom gm@||@com  Fri Aug 30 15:26:12 2019
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Fri, 30 Aug 2019 09:26:12 -0400
Subject: [R-pkg-devel] General considerations about vignettes
Message-ID: <644a2c54-017c-ca14-4d69-2ffb1c2948ba@gmail.com>

I'm seeking some general advice about including vignettes in my packages,
which are largely for nonlinear estimation and function minimization (optimization).
This means that my packages offer alternatives to many other tools, and the user
then has the chore of deciding which is appropriate. Bad choices can be very
costly in inappropriate results or computational efficiencies. Hence, I include
vignettes to offer comparisons and examples of use.

Unfortunately, as in a case this week, changes in the comparison packages break
my package(s), and I get an email from CRAN telling me to fix it before some
date not far in the future. This means a) work for me, possibly at an inopportune
time; b) risk of loss of capability, in the present case in the nlsr package which
offers some unique capabilities, and c) extra work for CRAN for what is, arguably,
updating of peripheral documentation. Updating optimization packages on CRAN can be,
I have discovered, a very time-consuming task. Package optimx took over 3 months
to get updated.

It should be noted in the present situation that just before I got the msg from
CRAN I got a msg from the maintainer of the package that has changed and breaks
the vignette with some suggestions on a fix. The issue is that his package has
changed function syntax -- a situation all of us know is fraught with troubles,
since improvements may cause breakage.

I am NOT saying that my vignettes should not be updated. However, I'm wondering
if I should set up a repository for my vignettes on Github/Gitlab or similar, and
simply link to them. This would separate the updating of vignettes from the central
packages. Their updating could be less strictly tied to CRAN activities, and could
also be a task undertaken by others who are not listed as maintainer.

I'd welcome some (hopefully constructive) comments. Would CRAN maintainers feel
this to be helpful, or does it lower the value of official R packages? Do
other maintainers experience the same requests, or do they just not include
vignettes (and many do not)?


John Nash


From edd @end|ng |rom deb|@n@org  Fri Aug 30 15:58:51 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Fri, 30 Aug 2019 08:58:51 -0500
Subject: [R-pkg-devel] third part software dependency
In-Reply-To: <23913.5515.42756.121348@rob.eddelbuettel.com>
References: <18799183-2647-badc-e051-f303a49dca59@gmail.com>
 <23913.5515.42756.121348@rob.eddelbuettel.com>
Message-ID: <23913.11163.835257.360216@rob.eddelbuettel.com>


On 30 August 2019 at 07:24, Dirk Eddelbuettel wrote:
| 
| On 30 August 2019 at 11:10, Serguei Sokol wrote:
| | I am preparing a new package r2sundials for submission to cran. It 
| | depends on third part software 
| | (https://computing.llnl.gov/projects/sundials). This will be my first 
| | submission of the kind so I am wondering how it is supposed to be tested 
| | so that I can reliably check the box "tested on R-devel" during 
| | submission process?
| | I suppose that sundials is not installed on windev. And even if it was, 
| | I need a particular option in this software (index size set to 32 bits) 
| | which is probably not activated in the hypothetical installation. So I 
| | cannot use win-builder.r-project.org.
| | Am I supposed to install current r-devel version and test my package on 
| | it locally?
| 
| The builder.r-hub.io service is a good alternative. It offers twelve
| different platforms, including a few r-devel ones.
| 
| That said, it won't have sundials either so you may have to pull sundials in
| during configure or via Make dependencies or ...

An alternative is of course to use a Docker image. I have long provided two
different containers within the Rocker Project that have r-devel (to be
invoked as RD).  You can pretty easily fire up the container, install
sundials and then save it again locally.  Ask me off-line about how if you
need help.

Or, of course, do as I and many others do and just keep a local r-devel build
in /usr/local ....

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From |uc@r @end|ng |rom |edor@project@org  Fri Aug 30 15:59:19 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Fri, 30 Aug 2019 15:59:19 +0200
Subject: [R-pkg-devel] General considerations about vignettes
In-Reply-To: <644a2c54-017c-ca14-4d69-2ffb1c2948ba@gmail.com>
References: <644a2c54-017c-ca14-4d69-2ffb1c2948ba@gmail.com>
Message-ID: <CALEXWq2QqHhOqTB9EejOopCH8t4HZA+=g6C2C6PLw8Yyeq3Rwg@mail.gmail.com>

On Fri, 30 Aug 2019 at 15:26, J C Nash <profjcnash at gmail.com> wrote:
>
> I'm seeking some general advice about including vignettes in my packages,
> which are largely for nonlinear estimation and function minimization (optimization).
> This means that my packages offer alternatives to many other tools, and the user
> then has the chore of deciding which is appropriate. Bad choices can be very
> costly in inappropriate results or computational efficiencies. Hence, I include
> vignettes to offer comparisons and examples of use.
>
> Unfortunately, as in a case this week, changes in the comparison packages break
> my package(s), and I get an email from CRAN telling me to fix it before some
> date not far in the future. This means a) work for me, possibly at an inopportune
> time; b) risk of loss of capability, in the present case in the nlsr package which
> offers some unique capabilities, and c) extra work for CRAN for what is, arguably,
> updating of peripheral documentation. Updating optimization packages on CRAN can be,
> I have discovered, a very time-consuming task. Package optimx took over 3 months
> to get updated.
>
> It should be noted in the present situation that just before I got the msg from
> CRAN I got a msg from the maintainer of the package that has changed and breaks
> the vignette with some suggestions on a fix. The issue is that his package has
> changed function syntax -- a situation all of us know is fraught with troubles,
> since improvements may cause breakage.
>
> I am NOT saying that my vignettes should not be updated. However, I'm wondering
> if I should set up a repository for my vignettes on Github/Gitlab or similar, and
> simply link to them. This would separate the updating of vignettes from the central
> packages. Their updating could be less strictly tied to CRAN activities, and could
> also be a task undertaken by others who are not listed as maintainer.
>
> I'd welcome some (hopefully constructive) comments. Would CRAN maintainers feel
> this to be helpful, or does it lower the value of official R packages? Do
> other maintainers experience the same requests, or do they just not include
> vignettes (and many do not)?

My two cents:

For me, as a user, vignettes are the most valuable form of
documentation in a package. Of course, this is personal opinion. But
these days with so many good packages out there, I don't have time to
install all of them and dive into the manual and the examples just to
decide which one is better for my use case. A good written vignette
most of the time is my driving factor (sometimes, if it's a small
package with one particular functionality, a good README is enough,
but that's not the case here).

Thus, as a maintainer, I try to lead by example. It's time consuming,
but on the other hand, many times a help request by a user can be
resolved with "please, take a look at section x of vignette y".

One thing I do to make them as maintainable as possible is to try to
avoid dependencies on third-party packages as much as possible. In
your case, comparing yourself with other alternatives may be
important. I'd suggest to set eval=FALSE for chunks with expensive
demonstrations of other packages, and then show a static figure with
the comparison that you made once, but doesn't need to be recreated
each time the vignette is built. In this way, issues like the one you
described won't affect your package, at least immediately. Until some
user reaches you to say, hey, I've tried the code in this vignette for
package x and it doesn't work for me. Then it's time to revisit that
code and rebuild the figure.

You could have vignettes that you don't rebuild constantly in a
separate repo and link them from a main vignette on CRAN, but that's
no different from what I propose above, and it's one click away.

Hope it helps. Regards,
-- 
I?aki ?car


From r@||@@tubner @end|ng |rom gm@||@com  Fri Aug 30 16:04:52 2019
From: r@||@@tubner @end|ng |rom gm@||@com (Ralf Stubner)
Date: Fri, 30 Aug 2019 16:04:52 +0200
Subject: [R-pkg-devel] third part software dependency
In-Reply-To: <18799183-2647-badc-e051-f303a49dca59@gmail.com>
References: <18799183-2647-badc-e051-f303a49dca59@gmail.com>
Message-ID: <CAFQwRQzzTzDhm7_sgp2rJOVpomYvvcLyd7sHLQeKk5DaF5DX=Q@mail.gmail.com>

On Fri, Aug 30, 2019 at 11:10 AM Serguei Sokol <serguei.sokol at gmail.com> wrote:
> I am preparing a new package r2sundials for submission to cran. It
> depends on third part software
> (https://computing.llnl.gov/projects/sundials).

Are you aware of the sundialr package?
https://cran.r-project.org/package=sundialr

> This will be my first
> submission of the kind so I am wondering how it is supposed to be tested
> so that I can reliably check the box "tested on R-devel" during
> submission process?
> I suppose that sundials is not installed on windev. And even if it was,
> I need a particular option in this software (index size set to 32 bits)
> which is probably not activated in the hypothetical installation. So I
> cannot use win-builder.r-project.org.
> Am I supposed to install current r-devel version and test my package on
> it locally?

Besides Dirk's suggestions, you can also use a CI service like Travis.
there you can install additional dependencies before testing the
package itself.

However, the question remains how CRAN will test the package without
having sundials installed.

cheerio
ralf


From @ergue|@@oko| @end|ng |rom gm@||@com  Fri Aug 30 16:22:48 2019
From: @ergue|@@oko| @end|ng |rom gm@||@com (Serguei Sokol)
Date: Fri, 30 Aug 2019 16:22:48 +0200
Subject: [R-pkg-devel] third part software dependency
In-Reply-To: <CAFQwRQzzTzDhm7_sgp2rJOVpomYvvcLyd7sHLQeKk5DaF5DX=Q@mail.gmail.com>
References: <18799183-2647-badc-e051-f303a49dca59@gmail.com>
 <CAFQwRQzzTzDhm7_sgp2rJOVpomYvvcLyd7sHLQeKk5DaF5DX=Q@mail.gmail.com>
Message-ID: <7a0ebb84-5de9-1298-23be-a4b53e99e169@gmail.com>

Hi Ralf,

On 30/08/2019 16:04, Ralf Stubner wrote:
> On Fri, Aug 30, 2019 at 11:10 AM Serguei Sokol <serguei.sokol at gmail.com> wrote:
>> I am preparing a new package r2sundials for submission to cran. It
>> depends on third part software
>> (https://computing.llnl.gov/projects/sundials).
> 
> Are you aware of the sundialr package?
> https://cran.r-project.org/package=sundialr
Yes, I do. I explain why I created a new package in Readme.md visible 
here https://github.com/sgsokol/r2sundials

> 
>> This will be my first
>> submission of the kind so I am wondering how it is supposed to be tested
>> so that I can reliably check the box "tested on R-devel" during
>> submission process?
>> I suppose that sundials is not installed on windev. And even if it was,
>> I need a particular option in this software (index size set to 32 bits)
>> which is probably not activated in the hypothetical installation. So I
>> cannot use win-builder.r-project.org.
>> Am I supposed to install current r-devel version and test my package on
>> it locally?
> 
> Besides Dirk's suggestions, you can also use a CI service like Travis.
> there you can install additional dependencies before testing the
> package itself.
Thanks for suggestion but I don't use Travis. Until now I didn't need 
it. Locally, I installed sundials/cvodes and my package. That's enough 
for the tests.

> 
> However, the question remains how CRAN will test the package without
> having sundials installed.
Right.

Best,
Serguei.


From ||@t@ @end|ng |rom dewey@myzen@co@uk  Fri Aug 30 16:54:10 2019
From: ||@t@ @end|ng |rom dewey@myzen@co@uk (Michael Dewey)
Date: Fri, 30 Aug 2019 15:54:10 +0100
Subject: [R-pkg-devel] General considerations about vignettes
In-Reply-To: <CALEXWq2QqHhOqTB9EejOopCH8t4HZA+=g6C2C6PLw8Yyeq3Rwg@mail.gmail.com>
References: <644a2c54-017c-ca14-4d69-2ffb1c2948ba@gmail.com>
 <CALEXWq2QqHhOqTB9EejOopCH8t4HZA+=g6C2C6PLw8Yyeq3Rwg@mail.gmail.com>
Message-ID: <3bcfcccc-0b66-ef38-1308-83bc16219a3d@dewey.myzen.co.uk>

Comments in-line

On 30/08/2019 14:59, I?aki Ucar wrote:
> On Fri, 30 Aug 2019 at 15:26, J C Nash <profjcnash at gmail.com> wrote:
>>
>> I'm seeking some general advice about including vignettes in my packages,
>> which are largely for nonlinear estimation and function minimization (optimization).
>> This means that my packages offer alternatives to many other tools, and the user
>> then has the chore of deciding which is appropriate. Bad choices can be very
>> costly in inappropriate results or computational efficiencies. Hence, I include
>> vignettes to offer comparisons and examples of use.
>>
>> Unfortunately, as in a case this week, changes in the comparison packages break
>> my package(s), and I get an email from CRAN telling me to fix it before some
>> date not far in the future. This means a) work for me, possibly at an inopportune
>> time; b) risk of loss of capability, in the present case in the nlsr package which
>> offers some unique capabilities, and c) extra work for CRAN for what is, arguably,
>> updating of peripheral documentation. Updating optimization packages on CRAN can be,
>> I have discovered, a very time-consuming task. Package optimx took over 3 months
>> to get updated.
>>
>> It should be noted in the present situation that just before I got the msg from
>> CRAN I got a msg from the maintainer of the package that has changed and breaks
>> the vignette with some suggestions on a fix. The issue is that his package has
>> changed function syntax -- a situation all of us know is fraught with troubles,
>> since improvements may cause breakage.
>>
>> I am NOT saying that my vignettes should not be updated. However, I'm wondering
>> if I should set up a repository for my vignettes on Github/Gitlab or similar, and
>> simply link to them. This would separate the updating of vignettes from the central
>> packages. Their updating could be less strictly tied to CRAN activities, and could
>> also be a task undertaken by others who are not listed as maintainer.
>>
>> I'd welcome some (hopefully constructive) comments. Would CRAN maintainers feel
>> this to be helpful, or does it lower the value of official R packages? Do
>> other maintainers experience the same requests, or do they just not include
>> vignettes (and many do not)?
> 
> My two cents:
> 
> For me, as a user, vignettes are the most valuable form of
> documentation in a package. Of course, this is personal opinion.

Yes, but it is widely shared (in the sense that I think it too).

I think the issue here is whether the intention is to compare with a 
particular implementation of a technique in which case you probably do 
need to do what you are currently doing or to compare with the technique 
in general terms. If the latter then I?aki's solution seems perfect to 
me since even if the package interface changes it still implemented the 
same technique (I assume).

Michael

  But
> these days with so many good packages out there, I don't have time to
> install all of them and dive into the manual and the examples just to
> decide which one is better for my use case. A good written vignette
> most of the time is my driving factor (sometimes, if it's a small
> package with one particular functionality, a good README is enough,
> but that's not the case here).
> 
> Thus, as a maintainer, I try to lead by example. It's time consuming,
> but on the other hand, many times a help request by a user can be
> resolved with "please, take a look at section x of vignette y".
> 
> One thing I do to make them as maintainable as possible is to try to
> avoid dependencies on third-party packages as much as possible. In
> your case, comparing yourself with other alternatives may be
> important. I'd suggest to set eval=FALSE for chunks with expensive
> demonstrations of other packages, and then show a static figure with
> the comparison that you made once, but doesn't need to be recreated
> each time the vignette is built. In this way, issues like the one you
> described won't affect your package, at least immediately. Until some
> user reaches you to say, hey, I've tried the code in this vignette for
> package x and it doesn't work for me. Then it's time to revisit that
> code and rebuild the figure.
> 
> You could have vignettes that you don't rebuild constantly in a
> separate repo and link them from a main vignette on CRAN, but that's
> no different from what I propose above, and it's one click away.
> 
> Hope it helps. Regards,
> 

-- 
Michael
http://www.dewey.myzen.co.uk/home.html


From @ergue|@@oko| @end|ng |rom gm@||@com  Fri Aug 30 17:04:55 2019
From: @ergue|@@oko| @end|ng |rom gm@||@com (Serguei Sokol)
Date: Fri, 30 Aug 2019 17:04:55 +0200
Subject: [R-pkg-devel] third part software dependency
In-Reply-To: <23913.11163.835257.360216@rob.eddelbuettel.com>
References: <18799183-2647-badc-e051-f303a49dca59@gmail.com>
 <23913.5515.42756.121348@rob.eddelbuettel.com>
 <23913.11163.835257.360216@rob.eddelbuettel.com>
Message-ID: <1236f2ea-d421-97a6-88bd-380a196fc131@gmail.com>

On 30/08/2019 15:58, Dirk Eddelbuettel wrote:
> 
> On 30 August 2019 at 07:24, Dirk Eddelbuettel wrote:
> |
> | On 30 August 2019 at 11:10, Serguei Sokol wrote:
> | | I am preparing a new package r2sundials for submission to cran. It
> | | depends on third part software
> | | (https://computing.llnl.gov/projects/sundials). This will be my first
> | | submission of the kind so I am wondering how it is supposed to be tested
> | | so that I can reliably check the box "tested on R-devel" during
> | | submission process?
> | | I suppose that sundials is not installed on windev. And even if it was,
> | | I need a particular option in this software (index size set to 32 bits)
> | | which is probably not activated in the hypothetical installation. So I
> | | cannot use win-builder.r-project.org.
> | | Am I supposed to install current r-devel version and test my package on
> | | it locally?
> |
> | The builder.r-hub.io service is a good alternative. It offers twelve
> | different platforms, including a few r-devel ones.
> |
> | That said, it won't have sundials either so you may have to pull sundials in
> | during configure or via Make dependencies or ...
> 
> An alternative is of course to use a Docker image. I have long provided two
> different containers within the Rocker Project that have r-devel (to be
> invoked as RD).  You can pretty easily fire up the container, install
> sundials and then save it again locally.  Ask me off-line about how if you
> need help.
> 
> Or, of course, do as I and many others do and just keep a local r-devel build
> in /usr/local ....
Thank Dirk. This was my spare option and I think this is what I'll do.


From m@rk@v@nder|oo @end|ng |rom gm@||@com  Fri Aug 30 17:08:11 2019
From: m@rk@v@nder|oo @end|ng |rom gm@||@com (Mark van der Loo)
Date: Fri, 30 Aug 2019 17:08:11 +0200
Subject: [R-pkg-devel] General considerations about vignettes
In-Reply-To: <3bcfcccc-0b66-ef38-1308-83bc16219a3d@dewey.myzen.co.uk>
References: <644a2c54-017c-ca14-4d69-2ffb1c2948ba@gmail.com>
 <CALEXWq2QqHhOqTB9EejOopCH8t4HZA+=g6C2C6PLw8Yyeq3Rwg@mail.gmail.com>
 <3bcfcccc-0b66-ef38-1308-83bc16219a3d@dewey.myzen.co.uk>
Message-ID: <CAOKDuOgiVTFqRthiq7MbhtVZBaYu61BkzLg_9-VpfTcK2GkkHQ@mail.gmail.com>

At the cost of some level of reproducibility, you could use a static
vignette and be very clear about the package versions used in the
comparisons:
http://www.markvanderloo.eu/yaRb/2019/01/11/add-a-static-pdf-vignette-to-an-r-package/

As this does diminish the coherence of CRAN somewhat I'm not really
favoring it, but I can see cases where this may be useful (e.g. I use a
static vignette in one pkg to include a published paper).

-Mark

On Fri, Aug 30, 2019 at 5:00 PM Michael Dewey <lists at dewey.myzen.co.uk>
wrote:

> Comments in-line
>
> On 30/08/2019 14:59, I?aki Ucar wrote:
> > On Fri, 30 Aug 2019 at 15:26, J C Nash <profjcnash at gmail.com> wrote:
> >>
> >> I'm seeking some general advice about including vignettes in my
> packages,
> >> which are largely for nonlinear estimation and function minimization
> (optimization).
> >> This means that my packages offer alternatives to many other tools, and
> the user
> >> then has the chore of deciding which is appropriate. Bad choices can be
> very
> >> costly in inappropriate results or computational efficiencies. Hence, I
> include
> >> vignettes to offer comparisons and examples of use.
> >>
> >> Unfortunately, as in a case this week, changes in the comparison
> packages break
> >> my package(s), and I get an email from CRAN telling me to fix it before
> some
> >> date not far in the future. This means a) work for me, possibly at an
> inopportune
> >> time; b) risk of loss of capability, in the present case in the nlsr
> package which
> >> offers some unique capabilities, and c) extra work for CRAN for what
> is, arguably,
> >> updating of peripheral documentation. Updating optimization packages on
> CRAN can be,
> >> I have discovered, a very time-consuming task. Package optimx took over
> 3 months
> >> to get updated.
> >>
> >> It should be noted in the present situation that just before I got the
> msg from
> >> CRAN I got a msg from the maintainer of the package that has changed
> and breaks
> >> the vignette with some suggestions on a fix. The issue is that his
> package has
> >> changed function syntax -- a situation all of us know is fraught with
> troubles,
> >> since improvements may cause breakage.
> >>
> >> I am NOT saying that my vignettes should not be updated. However, I'm
> wondering
> >> if I should set up a repository for my vignettes on Github/Gitlab or
> similar, and
> >> simply link to them. This would separate the updating of vignettes from
> the central
> >> packages. Their updating could be less strictly tied to CRAN
> activities, and could
> >> also be a task undertaken by others who are not listed as maintainer.
> >>
> >> I'd welcome some (hopefully constructive) comments. Would CRAN
> maintainers feel
> >> this to be helpful, or does it lower the value of official R packages?
> Do
> >> other maintainers experience the same requests, or do they just not
> include
> >> vignettes (and many do not)?
> >
> > My two cents:
> >
> > For me, as a user, vignettes are the most valuable form of
> > documentation in a package. Of course, this is personal opinion.
>
> Yes, but it is widely shared (in the sense that I think it too).
>
> I think the issue here is whether the intention is to compare with a
> particular implementation of a technique in which case you probably do
> need to do what you are currently doing or to compare with the technique
> in general terms. If the latter then I?aki's solution seems perfect to
> me since even if the package interface changes it still implemented the
> same technique (I assume).
>
> Michael
>
>   But
> > these days with so many good packages out there, I don't have time to
> > install all of them and dive into the manual and the examples just to
> > decide which one is better for my use case. A good written vignette
> > most of the time is my driving factor (sometimes, if it's a small
> > package with one particular functionality, a good README is enough,
> > but that's not the case here).
> >
> > Thus, as a maintainer, I try to lead by example. It's time consuming,
> > but on the other hand, many times a help request by a user can be
> > resolved with "please, take a look at section x of vignette y".
> >
> > One thing I do to make them as maintainable as possible is to try to
> > avoid dependencies on third-party packages as much as possible. In
> > your case, comparing yourself with other alternatives may be
> > important. I'd suggest to set eval=FALSE for chunks with expensive
> > demonstrations of other packages, and then show a static figure with
> > the comparison that you made once, but doesn't need to be recreated
> > each time the vignette is built. In this way, issues like the one you
> > described won't affect your package, at least immediately. Until some
> > user reaches you to say, hey, I've tried the code in this vignette for
> > package x and it doesn't work for me. Then it's time to revisit that
> > code and rebuild the figure.
> >
> > You could have vignettes that you don't rebuild constantly in a
> > separate repo and link them from a main vignette on CRAN, but that's
> > no different from what I propose above, and it's one click away.
> >
> > Hope it helps. Regards,
> >
>
> --
> Michael
> http://www.dewey.myzen.co.uk/home.html
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Fri Aug 30 19:45:00 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Fri, 30 Aug 2019 17:45:00 +0000
Subject: [R-pkg-devel] General considerations about vignettes
In-Reply-To: <CAOKDuOgiVTFqRthiq7MbhtVZBaYu61BkzLg_9-VpfTcK2GkkHQ@mail.gmail.com>
References: <644a2c54-017c-ca14-4d69-2ffb1c2948ba@gmail.com>
 <CALEXWq2QqHhOqTB9EejOopCH8t4HZA+=g6C2C6PLw8Yyeq3Rwg@mail.gmail.com>
 <3bcfcccc-0b66-ef38-1308-83bc16219a3d@dewey.myzen.co.uk>
 <CAOKDuOgiVTFqRthiq7MbhtVZBaYu61BkzLg_9-VpfTcK2GkkHQ@mail.gmail.com>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E01CC778738@MBXP01.ds.man.ac.uk>

When adding static vignettes, it is a good idea to put the 'real' ones somewhere under inst/doc. 
A manual index file under inst/doc/ will add the benefit that the help system will present to the user the real code and not the stub Rnw  in the approach suggested by Michael. Package Countr (https://cran.r-project.org/package=Countr) uses this approach for its vignettes (sorry for the self-reference). 

Georgi Boshnakov


-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Mark van der Loo
Sent: 30 August 2019 16:08
To: Michael Dewey
Cc: List r-package-devel
Subject: Re: [R-pkg-devel] General considerations about vignettes

At the cost of some level of reproducibility, you could use a static
vignette and be very clear about the package versions used in the
comparisons:
http://www.markvanderloo.eu/yaRb/2019/01/11/add-a-static-pdf-vignette-to-an-r-package/

As this does diminish the coherence of CRAN somewhat I'm not really
favoring it, but I can see cases where this may be useful (e.g. I use a
static vignette in one pkg to include a published paper).

-Mark

On Fri, Aug 30, 2019 at 5:00 PM Michael Dewey <lists at dewey.myzen.co.uk>
wrote:

> Comments in-line
>
> On 30/08/2019 14:59, I?aki Ucar wrote:
> > On Fri, 30 Aug 2019 at 15:26, J C Nash <profjcnash at gmail.com> wrote:
> >>
> >> I'm seeking some general advice about including vignettes in my
> packages,
> >> which are largely for nonlinear estimation and function minimization
> (optimization).
> >> This means that my packages offer alternatives to many other tools, and
> the user
> >> then has the chore of deciding which is appropriate. Bad choices can be
> very
> >> costly in inappropriate results or computational efficiencies. Hence, I
> include
> >> vignettes to offer comparisons and examples of use.
> >>
> >> Unfortunately, as in a case this week, changes in the comparison
> packages break
> >> my package(s), and I get an email from CRAN telling me to fix it before
> some
> >> date not far in the future. This means a) work for me, possibly at an
> inopportune
> >> time; b) risk of loss of capability, in the present case in the nlsr
> package which
> >> offers some unique capabilities, and c) extra work for CRAN for what
> is, arguably,
> >> updating of peripheral documentation. Updating optimization packages on
> CRAN can be,
> >> I have discovered, a very time-consuming task. Package optimx took over
> 3 months
> >> to get updated.
> >>
> >> It should be noted in the present situation that just before I got the
> msg from
> >> CRAN I got a msg from the maintainer of the package that has changed
> and breaks
> >> the vignette with some suggestions on a fix. The issue is that his
> package has
> >> changed function syntax -- a situation all of us know is fraught with
> troubles,
> >> since improvements may cause breakage.
> >>
> >> I am NOT saying that my vignettes should not be updated. However, I'm
> wondering
> >> if I should set up a repository for my vignettes on Github/Gitlab or
> similar, and
> >> simply link to them. This would separate the updating of vignettes from
> the central
> >> packages. Their updating could be less strictly tied to CRAN
> activities, and could
> >> also be a task undertaken by others who are not listed as maintainer.
> >>
> >> I'd welcome some (hopefully constructive) comments. Would CRAN
> maintainers feel
> >> this to be helpful, or does it lower the value of official R packages?
> Do
> >> other maintainers experience the same requests, or do they just not
> include
> >> vignettes (and many do not)?
> >
> > My two cents:
> >
> > For me, as a user, vignettes are the most valuable form of
> > documentation in a package. Of course, this is personal opinion.
>
> Yes, but it is widely shared (in the sense that I think it too).
>
> I think the issue here is whether the intention is to compare with a
> particular implementation of a technique in which case you probably do
> need to do what you are currently doing or to compare with the technique
> in general terms. If the latter then I?aki's solution seems perfect to
> me since even if the package interface changes it still implemented the
> same technique (I assume).
>
> Michael
>
>   But
> > these days with so many good packages out there, I don't have time to
> > install all of them and dive into the manual and the examples just to
> > decide which one is better for my use case. A good written vignette
> > most of the time is my driving factor (sometimes, if it's a small
> > package with one particular functionality, a good README is enough,
> > but that's not the case here).
> >
> > Thus, as a maintainer, I try to lead by example. It's time consuming,
> > but on the other hand, many times a help request by a user can be
> > resolved with "please, take a look at section x of vignette y".
> >
> > One thing I do to make them as maintainable as possible is to try to
> > avoid dependencies on third-party packages as much as possible. In
> > your case, comparing yourself with other alternatives may be
> > important. I'd suggest to set eval=FALSE for chunks with expensive
> > demonstrations of other packages, and then show a static figure with
> > the comparison that you made once, but doesn't need to be recreated
> > each time the vignette is built. In this way, issues like the one you
> > described won't affect your package, at least immediately. Until some
> > user reaches you to say, hey, I've tried the code in this vignette for
> > package x and it doesn't work for me. Then it's time to revisit that
> > code and rebuild the figure.
> >
> > You could have vignettes that you don't rebuild constantly in a
> > separate repo and link them from a main vignette on CRAN, but that's
> > no different from what I propose above, and it's one click away.
> >
> > Hope it helps. Regards,
> >
>
> --
> Michael
> http://www.dewey.myzen.co.uk/home.html
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

From @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@  Fri Aug 30 20:50:55 2019
From: @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@ (Sameh M. Abdulah)
Date: Fri, 30 Aug 2019 18:50:55 +0000
Subject: [R-pkg-devel] set pkg_config for 3rd party software
Message-ID: <D115402E-21CE-44EE-B867-E6902833A459@kaust.edu.sa>

Hi,

I recently asked some questions about my R package which were well responded by Dirk.

I have another question related to pkg_config path,

I am using this command to add the installation path to the PKG_CONFIG_PATH   so that all cmake commands can get the required libraries from this path,

Sys.setenv(PKG_CONFIG_PATH=paste(Sys.getenv("PKG_CONFIG_PATH"),paste(.libPaths(),"exageostat/lib/pkgconfig",sep='/',collapse=':'),sep=':'))

Is there a simple way to set this path without explicitly calling this line before installing my package? OR is there any other path that I can use so that all software CMake commands can easily find the required libraries?



--Sameh

	[[alternative HTML version deleted]]


From gor@n@bro@trom @end|ng |rom umu@@e  Sat Aug 31 18:47:16 2019
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Sat, 31 Aug 2019 18:47:16 +0200
Subject: [R-pkg-devel] R, BLAS, and FCLEN
Message-ID: <aa335279-734d-6ac8-e957-5070768201c5@umu.se>

I'm having difficulties updating my package eha: When I run standard 
checks 'at home' everything is fine, but 'CRAN-submissions' reports 
(among other things):

geomsup.f:324:9: warning: type of ?dgemv? does not match original 
declaration [-Wlto-type-mismatch]
   324 |      &     one, score, ione)
       |         ^
/home/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:107:1: note: type mismatch in 
parameter 12
   107 | F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
       | ^

This is odd since the LAPACK subroutine dgemv takes only 11 parameters. 
However, in include/R_ext/BLAS.h we have

F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
		const double *alpha, const double *a, const int *lda,
		const double *x, const int *incx, const double *beta,
		double *y, const int *incy FCLEN);

with a 12th parameter FCLEN?? How am I supposed to fix this, and what 
the ... is FCLEN? googling leads to nothing useful (for me). It seems as 
if R is redefining some standard LAPACK routines.

Also a note I do not understand (in this context):

note: type ?void? should match type ?long int?

Any help is much appreciated.

Best, G?ran

PS. How can I trigger these Warnings 'at home'?


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Aug 31 21:26:24 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 31 Aug 2019 15:26:24 -0400
Subject: [R-pkg-devel] R, BLAS, and FCLEN
In-Reply-To: <aa335279-734d-6ac8-e957-5070768201c5@umu.se>
References: <aa335279-734d-6ac8-e957-5070768201c5@umu.se>
Message-ID: <f2e97af7-488a-dbdd-bc0d-df5d435c42e4@gmail.com>

On 31/08/2019 12:47 p.m., G?ran Brostr?m wrote:
> I'm having difficulties updating my package eha: When I run standard
> checks 'at home' everything is fine, but 'CRAN-submissions' reports
> (among other things):
> 
> geomsup.f:324:9: warning: type of ?dgemv? does not match original
> declaration [-Wlto-type-mismatch]
>     324 |      &     one, score, ione)
>         |         ^
> /home/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:107:1: note: type mismatch in
> parameter 12
>     107 | F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>         | ^
> 
> This is odd since the LAPACK subroutine dgemv takes only 11 parameters.
> However, in include/R_ext/BLAS.h we have
> 
> F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
> 		const double *alpha, const double *a, const int *lda,
> 		const double *x, const int *incx, const double *beta,
> 		double *y, const int *incy FCLEN);
> 
> with a 12th parameter FCLEN?? How am I supposed to fix this, and what
> the ... is FCLEN? googling leads to nothing useful (for me). It seems as
> if R is redefining some standard LAPACK routines.
> 
> Also a note I do not understand (in this context):
> 
> note: type ?void? should match type ?long int?
> 
> Any help is much appreciated.
> 

Sounds likely to be related to this item from R-devel NEWS:

http://developer.r-project.org/blosxom.cgi/R-devel/2019/08/29#n2019-08-29

"   Header ?Rconfig.h? contains the value of ?FC_LEN_T? deduced at 
installation which is used by the prototypes in headers ?R_ext/BLAS.h? 
and ?R_ext/Lapack.h? but to avoid extensive breakage this is only 
exposed when ?USE_FC_LEN_T? is defined.

     If a package's C/C++ calls to BLAS/LAPACK allow for the ?hidden? 
arguments used by most Fortran compilers to pass the lengths of Fortran 
character arguments, define ?USE_FC_LEN_T? and include ?Rconfig.h? 
(possibly _via_ ?R.h?) before including ?R_ext/BLAS.h? or ?R_ext/Lapack.h?."

Duncan Murdoch


From gor@n@bro@trom @end|ng |rom umu@@e  Sun Sep  1 11:34:49 2019
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Sun, 1 Sep 2019 11:34:49 +0200
Subject: [R-pkg-devel] R, BLAS, and FCLEN
In-Reply-To: <f2e97af7-488a-dbdd-bc0d-df5d435c42e4@gmail.com>
References: <aa335279-734d-6ac8-e957-5070768201c5@umu.se>
 <f2e97af7-488a-dbdd-bc0d-df5d435c42e4@gmail.com>
Message-ID: <21880b4c-f9e8-2725-3554-89b077e0f125@umu.se>



On 2019-08-31 21:26, Duncan Murdoch wrote:
> On 31/08/2019 12:47 p.m., G?ran Brostr?m wrote:
>> I'm having difficulties updating my package eha: When I run standard
>> checks 'at home' everything is fine, but 'CRAN-submissions' reports
>> (among other things):
>>
>> geomsup.f:324:9: warning: type of ?dgemv? does not match original
>> declaration [-Wlto-type-mismatch]
>> ??? 324 |????? &???? one, score, ione)
>> ??????? |???????? ^
>> /home/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:107:1: note: type mismatch in
>> parameter 12
>> ??? 107 | F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>> ??????? | ^
>>
>> This is odd since the LAPACK subroutine dgemv takes only 11 parameters.
>> However, in include/R_ext/BLAS.h we have
>>
>> F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>> ??????? const double *alpha, const double *a, const int *lda,
>> ??????? const double *x, const int *incx, const double *beta,
>> ??????? double *y, const int *incy FCLEN);
>>
>> with a 12th parameter FCLEN?? How am I supposed to fix this, and what
>> the ... is FCLEN? googling leads to nothing useful (for me). It seems as
>> if R is redefining some standard LAPACK routines.
>>
>> Also a note I do not understand (in this context):
>>
>> note: type ?void? should match type ?long int?
>>
>> Any help is much appreciated.
>>
> 
> Sounds likely to be related to this item from R-devel NEWS:
> 
> http://developer.r-project.org/blosxom.cgi/R-devel/2019/08/29#n2019-08-29
> 
> "?? Header ?Rconfig.h? contains the value of ?FC_LEN_T? deduced at 
> installation which is used by the prototypes in headers ?R_ext/BLAS.h? 
> and ?R_ext/Lapack.h? but to avoid extensive breakage this is only 
> exposed when ?USE_FC_LEN_T? is defined.
> 
>  ??? If a package's C/C++ calls to BLAS/LAPACK allow for the ?hidden? 
> arguments used by most Fortran compilers to pass the lengths of Fortran 
> character arguments, define ?USE_FC_LEN_T? and include ?Rconfig.h? 
> (possibly _via_ ?R.h?) before including ?R_ext/BLAS.h? or 
> ?R_ext/Lapack.h?."

Thanks Duncan,

but my call to dgemv is from a FORTRAN subroutine, no C is involved. It 
is called by .Fortran in R code. I am confused (not for the first time).

G?ran

> 
> Duncan Murdoch


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun Sep  1 16:22:43 2019
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 1 Sep 2019 09:22:43 -0500
Subject: [R-pkg-devel] URL of a frame (or a vignette)?
Message-ID: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>

Hello:


 ????? How can I get a URL for a frame?


 ????? Specifically, I want a URL that I can cite for the "bssm: 
Bayesian Inference of Non-linear and
Non-Gaussian State Space Models in R" vignette in the bssm package on 
CRAN.? If the package is installed, it's available there as "bssm.pdf".? 
However, I want to include it in an RMarkdown vignette I'm writing, and 
I'd rather not force the reader to be on a computer with the package 
installed -- and force myself to figure out a way to find it in that 
case, if that can even be done.


 ????? Thanks,
 ????? Spencer Graves


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Sep  1 16:37:47 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sun, 01 Sep 2019 07:37:47 -0700
Subject: [R-pkg-devel] URL of a frame (or a vignette)?
In-Reply-To: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>
References: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>
Message-ID: <6CBE2061-E145-4AE4-915D-9564C8C3A2C1@dcn.davis.ca.us>

Wouldn't you just refer to [1] or one of the links mentioned there?

[1] https://cran.r-project.org/package=bssm

On September 1, 2019 7:22:43 AM PDT, Spencer Graves <spencer.graves at effectivedefense.org> wrote:
>Hello:
>
>
> ????? How can I get a URL for a frame?
>
>
> ????? Specifically, I want a URL that I can cite for the "bssm: 
>Bayesian Inference of Non-linear and
>Non-Gaussian State Space Models in R" vignette in the bssm package on 
>CRAN.? If the package is installed, it's available there as
>"bssm.pdf".? 
>However, I want to include it in an RMarkdown vignette I'm writing, and
>
>I'd rather not force the reader to be on a computer with the package 
>installed -- and force myself to figure out a way to find it in that 
>case, if that can even be done.
>
>
> ????? Thanks,
> ????? Spencer Graves
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun Sep  1 16:41:30 2019
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 1 Sep 2019 09:41:30 -0500
Subject: [R-pkg-devel] URL of a frame (or a vignette)?
In-Reply-To: <6CBE2061-E145-4AE4-915D-9564C8C3A2C1@dcn.davis.ca.us>
References: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>
 <6CBE2061-E145-4AE4-915D-9564C8C3A2C1@dcn.davis.ca.us>
Message-ID: <4f66b589-1731-afda-922f-649237888ef1@effectivedefense.org>

Hi, Jeff:


 ????? That's what I needed.? I clicked on the vignette I wanted and got 
the following:


https://cran.r-project.org/web/packages/bssm/vignettes/bssm.pdf


 ????? Thanks,
 ????? Spencer Graves


On 2019-09-01 09:37, Jeff Newmiller wrote:
> Wouldn't you just refer to [1] or one of the links mentioned there?
>
> [1] https://cran.r-project.org/package=bssm
>
> On September 1, 2019 7:22:43 AM PDT, Spencer Graves <spencer.graves at effectivedefense.org> wrote:
>> Hello:
>>
>>
>>  ????? How can I get a URL for a frame?
>>
>>
>>  ????? Specifically, I want a URL that I can cite for the "bssm:
>> Bayesian Inference of Non-linear and
>> Non-Gaussian State Space Models in R" vignette in the bssm package on
>> CRAN.? If the package is installed, it's available there as
>> "bssm.pdf".
>> However, I want to include it in an RMarkdown vignette I'm writing, and
>>
>> I'd rather not force the reader to be on a computer with the package
>> installed -- and force myself to figure out a way to find it in that
>> case, if that can even be done.
>>
>>
>>  ????? Thanks,
>>  ????? Spencer Graves
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Sun Sep  1 16:56:55 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Sun, 1 Sep 2019 14:56:55 +0000
Subject: [R-pkg-devel] URL of a frame (or a vignette)?
In-Reply-To: <4f66b589-1731-afda-922f-649237888ef1@effectivedefense.org>
References: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>
 <6CBE2061-E145-4AE4-915D-9564C8C3A2C1@dcn.davis.ca.us>
 <4f66b589-1731-afda-922f-649237888ef1@effectivedefense.org>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E01CC7788C1@MBXP01.ds.man.ac.uk>

It may be better to use the canonical url, https://cran.r-project.org/package=bssm, as in:

https://cran.r-project.org/package=bssm/bssm.pdf

By the way, the vignettes for an installed package can be found by

vignette(package="bssm")

or

help(package="bssm", help_type = "html")

The latter has the advantage that it present links in a browser even if by default the help is presented in text mode.


Georgi Boshnakov



-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Spencer Graves
Sent: 01 September 2019 15:42
To: Jeff Newmiller; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] URL of a frame (or a vignette)?

Hi, Jeff:


 ????? That's what I needed.? I clicked on the vignette I wanted and got 
the following:


https://cran.r-project.org/web/packages/bssm/vignettes/bssm.pdf


 ????? Thanks,
 ????? Spencer Graves


On 2019-09-01 09:37, Jeff Newmiller wrote:
> Wouldn't you just refer to [1] or one of the links mentioned there?
>
> [1] https://cran.r-project.org/package=bssm
>
> On September 1, 2019 7:22:43 AM PDT, Spencer Graves <spencer.graves at effectivedefense.org> wrote:
>> Hello:
>>
>>
>>  ????? How can I get a URL for a frame?
>>
>>
>>  ????? Specifically, I want a URL that I can cite for the "bssm:
>> Bayesian Inference of Non-linear and
>> Non-Gaussian State Space Models in R" vignette in the bssm package on
>> CRAN.? If the package is installed, it's available there as
>> "bssm.pdf".
>> However, I want to include it in an RMarkdown vignette I'm writing, and
>>
>> I'd rather not force the reader to be on a computer with the package
>> installed -- and force myself to figure out a way to find it in that
>> case, if that can even be done.
>>
>>
>>  ????? Thanks,
>>  ????? Spencer Graves
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Sun Sep  1 17:13:22 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Sun, 1 Sep 2019 15:13:22 +0000
Subject: [R-pkg-devel] URL of a frame (or a vignette)?
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E01CC7788C1@MBXP01.ds.man.ac.uk>
References: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>
 <6CBE2061-E145-4AE4-915D-9564C8C3A2C1@dcn.davis.ca.us>
 <4f66b589-1731-afda-922f-649237888ef1@effectivedefense.org>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788C1@MBXP01.ds.man.ac.uk>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E01CC7788DC@MBXP01.ds.man.ac.uk>

Correction: 

https://cran.r-project.org/package=bssm/vignettes/bssm.pdf


-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Georgi Boshnakov
Sent: 01 September 2019 15:57
To: Spencer Graves; Jeff Newmiller; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] URL of a frame (or a vignette)?

It may be better to use the canonical url, https://cran.r-project.org/package=bssm, as in:

https://cran.r-project.org/package=bssm/bssm.pdf

By the way, the vignettes for an installed package can be found by

vignette(package="bssm")

or

help(package="bssm", help_type = "html")

The latter has the advantage that it present links in a browser even if by default the help is presented in text mode.


Georgi Boshnakov



-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Spencer Graves
Sent: 01 September 2019 15:42
To: Jeff Newmiller; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] URL of a frame (or a vignette)?

Hi, Jeff:


 ????? That's what I needed.? I clicked on the vignette I wanted and got 
the following:


https://cran.r-project.org/web/packages/bssm/vignettes/bssm.pdf


 ????? Thanks,
 ????? Spencer Graves


On 2019-09-01 09:37, Jeff Newmiller wrote:
> Wouldn't you just refer to [1] or one of the links mentioned there?
>
> [1] https://cran.r-project.org/package=bssm
>
> On September 1, 2019 7:22:43 AM PDT, Spencer Graves <spencer.graves at effectivedefense.org> wrote:
>> Hello:
>>
>>
>>  ????? How can I get a URL for a frame?
>>
>>
>>  ????? Specifically, I want a URL that I can cite for the "bssm:
>> Bayesian Inference of Non-linear and
>> Non-Gaussian State Space Models in R" vignette in the bssm package on
>> CRAN.? If the package is installed, it's available there as
>> "bssm.pdf".
>> However, I want to include it in an RMarkdown vignette I'm writing, and
>>
>> I'd rather not force the reader to be on a computer with the package
>> installed -- and force myself to figure out a way to find it in that
>> case, if that can even be done.
>>
>>
>>  ????? Thanks,
>>  ????? Spencer Graves
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel
______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Sep  1 17:27:30 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sun, 01 Sep 2019 08:27:30 -0700
Subject: [R-pkg-devel] URL of a frame (or a vignette)?
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E01CC7788DC@MBXP01.ds.man.ac.uk>
References: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>
 <6CBE2061-E145-4AE4-915D-9564C8C3A2C1@dcn.davis.ca.us>
 <4f66b589-1731-afda-922f-649237888ef1@effectivedefense.org>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788C1@MBXP01.ds.man.ac.uk>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788DC@MBXP01.ds.man.ac.uk>
Message-ID: <A9D50EBF-F41D-4A1E-81FB-7D3CE9CCA998@dcn.davis.ca.us>

I am not going to claim definitive knowledge, but my understanding of CRAN is that only the package URL that I copied from the page itself will remain if the package is archived. Thus, unless the package vignette has a non-CRAN permanent URL (e.g. arXiv) it may be safer in the long run to link through the main package URL.

On September 1, 2019 8:13:22 AM PDT, Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk> wrote:
>Correction: 
>
>https://cran.r-project.org/package=bssm/vignettes/bssm.pdf
>
>
>-----Original Message-----
>From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On
>Behalf Of Georgi Boshnakov
>Sent: 01 September 2019 15:57
>To: Spencer Graves; Jeff Newmiller; r-package-devel at r-project.org
>Subject: Re: [R-pkg-devel] URL of a frame (or a vignette)?
>
>It may be better to use the canonical url,
>https://cran.r-project.org/package=bssm, as in:
>
>https://cran.r-project.org/package=bssm/bssm.pdf
>
>By the way, the vignettes for an installed package can be found by
>
>vignette(package="bssm")
>
>or
>
>help(package="bssm", help_type = "html")
>
>The latter has the advantage that it present links in a browser even if
>by default the help is presented in text mode.
>
>
>Georgi Boshnakov
>
>
>
>-----Original Message-----
>From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On
>Behalf Of Spencer Graves
>Sent: 01 September 2019 15:42
>To: Jeff Newmiller; r-package-devel at r-project.org
>Subject: Re: [R-pkg-devel] URL of a frame (or a vignette)?
>
>Hi, Jeff:
>
>
>????? That's what I needed.? I clicked on the vignette I wanted and got
>
>the following:
>
>
>https://cran.r-project.org/web/packages/bssm/vignettes/bssm.pdf
>
>
> ????? Thanks,
> ????? Spencer Graves
>
>
>On 2019-09-01 09:37, Jeff Newmiller wrote:
>> Wouldn't you just refer to [1] or one of the links mentioned there?
>>
>> [1] https://cran.r-project.org/package=bssm
>>
>> On September 1, 2019 7:22:43 AM PDT, Spencer Graves
><spencer.graves at effectivedefense.org> wrote:
>>> Hello:
>>>
>>>
>>>  ????? How can I get a URL for a frame?
>>>
>>>
>>>  ????? Specifically, I want a URL that I can cite for the "bssm:
>>> Bayesian Inference of Non-linear and
>>> Non-Gaussian State Space Models in R" vignette in the bssm package
>on
>>> CRAN.? If the package is installed, it's available there as
>>> "bssm.pdf".
>>> However, I want to include it in an RMarkdown vignette I'm writing,
>and
>>>
>>> I'd rather not force the reader to be on a computer with the package
>>> installed -- and force myself to figure out a way to find it in that
>>> case, if that can even be done.
>>>
>>>
>>>  ????? Thanks,
>>>  ????? Spencer Graves
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun Sep  1 17:33:17 2019
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 1 Sep 2019 10:33:17 -0500
Subject: [R-pkg-devel] URL of a frame (or a vignette)?
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E01CC7788DC@MBXP01.ds.man.ac.uk>
References: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>
 <6CBE2061-E145-4AE4-915D-9564C8C3A2C1@dcn.davis.ca.us>
 <4f66b589-1731-afda-922f-649237888ef1@effectivedefense.org>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788C1@MBXP01.ds.man.ac.uk>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788DC@MBXP01.ds.man.ac.uk>
Message-ID: <55e64fbc-ffa6-a28a-0e48-29411c7f2900@effectivedefense.org>

 ????? What's the difference between


https://cran.r-project.org/package=bssm/vignettes/bssm.pdf


 ????? and


https://cran.r-project.org/web/packages/bssm/vignettes/bssm.pdf


 ????? When I tried the former, it automatically changed to the latter.? 
Is the former considered to be more stable?


 ????? Thanks,
 ????? Spencer


On 2019-09-01 10:13, Georgi Boshnakov wrote:
> Correction:
>
> https://cran.r-project.org/package=bssm/vignettes/bssm.pdf
>
>
> -----Original Message-----
> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Georgi Boshnakov
> Sent: 01 September 2019 15:57
> To: Spencer Graves; Jeff Newmiller; r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] URL of a frame (or a vignette)?
>
> It may be better to use the canonical url, https://cran.r-project.org/package=bssm, as in:
>
> https://cran.r-project.org/package=bssm/bssm.pdf
>
> By the way, the vignettes for an installed package can be found by
>
> vignette(package="bssm")
>
> or
>
> help(package="bssm", help_type = "html")
>
> The latter has the advantage that it present links in a browser even if by default the help is presented in text mode.
>
>
> Georgi Boshnakov
>
>
>
> -----Original Message-----
> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Spencer Graves
> Sent: 01 September 2019 15:42
> To: Jeff Newmiller; r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] URL of a frame (or a vignette)?
>
> Hi, Jeff:
>
>
>   ????? That's what I needed.? I clicked on the vignette I wanted and got
> the following:
>
>
> https://cran.r-project.org/web/packages/bssm/vignettes/bssm.pdf
>
>
>   ????? Thanks,
>   ????? Spencer Graves
>
>
> On 2019-09-01 09:37, Jeff Newmiller wrote:
>> Wouldn't you just refer to [1] or one of the links mentioned there?
>>
>> [1] https://cran.r-project.org/package=bssm
>>
>> On September 1, 2019 7:22:43 AM PDT, Spencer Graves <spencer.graves at effectivedefense.org> wrote:
>>> Hello:
>>>
>>>
>>>   ????? How can I get a URL for a frame?
>>>
>>>
>>>   ????? Specifically, I want a URL that I can cite for the "bssm:
>>> Bayesian Inference of Non-linear and
>>> Non-Gaussian State Space Models in R" vignette in the bssm package on
>>> CRAN.? If the package is installed, it's available there as
>>> "bssm.pdf".
>>> However, I want to include it in an RMarkdown vignette I'm writing, and
>>>
>>> I'd rather not force the reader to be on a computer with the package
>>> installed -- and force myself to figure out a way to find it in that
>>> case, if that can even be done.
>>>
>>>
>>>   ????? Thanks,
>>>   ????? Spencer Graves
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Sun Sep  1 17:49:34 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Sun, 1 Sep 2019 15:49:34 +0000
Subject: [R-pkg-devel] URL of a frame (or a vignette)?
In-Reply-To: <55e64fbc-ffa6-a28a-0e48-29411c7f2900@effectivedefense.org>
References: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>
 <6CBE2061-E145-4AE4-915D-9564C8C3A2C1@dcn.davis.ca.us>
 <4f66b589-1731-afda-922f-649237888ef1@effectivedefense.org>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788C1@MBXP01.ds.man.ac.uk>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788DC@MBXP01.ds.man.ac.uk>
 <55e64fbc-ffa6-a28a-0e48-29411c7f2900@effectivedefense.org>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E01CC7788F7@MBXP01.ds.man.ac.uk>

The link  https://cran.r-project.org/package=bssm  is stable (and given at the bottom of the CRAN page. 
Jeff is right that adding vignettes/bssm.pdf to it is not guaranteed in any way. 

GB

-----Original Message-----
From: Spencer Graves [mailto:spencer.graves at effectivedefense.org] 
Sent: 01 September 2019 16:33
To: Georgi Boshnakov; Jeff Newmiller; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] URL of a frame (or a vignette)?

 ????? What's the difference between


https://cran.r-project.org/package=bssm/vignettes/bssm.pdf


 ????? and


https://cran.r-project.org/web/packages/bssm/vignettes/bssm.pdf


 ????? When I tried the former, it automatically changed to the latter.? 
Is the former considered to be more stable?


 ????? Thanks,
 ????? Spencer


On 2019-09-01 10:13, Georgi Boshnakov wrote:
> Correction:
>
> https://cran.r-project.org/package=bssm/vignettes/bssm.pdf
>
>
> -----Original Message-----
> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Georgi Boshnakov
> Sent: 01 September 2019 15:57
> To: Spencer Graves; Jeff Newmiller; r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] URL of a frame (or a vignette)?
>
> It may be better to use the canonical url, https://cran.r-project.org/package=bssm, as in:
>
> https://cran.r-project.org/package=bssm/bssm.pdf
>
> By the way, the vignettes for an installed package can be found by
>
> vignette(package="bssm")
>
> or
>
> help(package="bssm", help_type = "html")
>
> The latter has the advantage that it present links in a browser even if by default the help is presented in text mode.
>
>
> Georgi Boshnakov
>
>
>
> -----Original Message-----
> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Spencer Graves
> Sent: 01 September 2019 15:42
> To: Jeff Newmiller; r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] URL of a frame (or a vignette)?
>
> Hi, Jeff:
>
>
>   ????? That's what I needed.? I clicked on the vignette I wanted and got
> the following:
>
>
> https://cran.r-project.org/web/packages/bssm/vignettes/bssm.pdf
>
>
>   ????? Thanks,
>   ????? Spencer Graves
>
>
> On 2019-09-01 09:37, Jeff Newmiller wrote:
>> Wouldn't you just refer to [1] or one of the links mentioned there?
>>
>> [1] https://cran.r-project.org/package=bssm
>>
>> On September 1, 2019 7:22:43 AM PDT, Spencer Graves <spencer.graves at effectivedefense.org> wrote:
>>> Hello:
>>>
>>>
>>>   ????? How can I get a URL for a frame?
>>>
>>>
>>>   ????? Specifically, I want a URL that I can cite for the "bssm:
>>> Bayesian Inference of Non-linear and
>>> Non-Gaussian State Space Models in R" vignette in the bssm package on
>>> CRAN.? If the package is installed, it's available there as
>>> "bssm.pdf".
>>> However, I want to include it in an RMarkdown vignette I'm writing, and
>>>
>>> I'd rather not force the reader to be on a computer with the package
>>> installed -- and force myself to figure out a way to find it in that
>>> case, if that can even be done.
>>>
>>>
>>>   ????? Thanks,
>>>   ????? Spencer Graves
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Sep  1 17:49:52 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 1 Sep 2019 11:49:52 -0400
Subject: [R-pkg-devel] URL of a frame (or a vignette)?
In-Reply-To: <55e64fbc-ffa6-a28a-0e48-29411c7f2900@effectivedefense.org>
References: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>
 <6CBE2061-E145-4AE4-915D-9564C8C3A2C1@dcn.davis.ca.us>
 <4f66b589-1731-afda-922f-649237888ef1@effectivedefense.org>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788C1@MBXP01.ds.man.ac.uk>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788DC@MBXP01.ds.man.ac.uk>
 <55e64fbc-ffa6-a28a-0e48-29411c7f2900@effectivedefense.org>
Message-ID: <d9654cfd-f845-8fb2-fb80-e22b1466bd77@gmail.com>

On 01/09/2019 11:33 a.m., Spencer Graves wrote:
>   ????? What's the difference between
> 
> 
> https://cran.r-project.org/package=bssm/vignettes/bssm.pdf
> 
> 
>   ????? and
> 
> 
> https://cran.r-project.org/web/packages/bssm/vignettes/bssm.pdf
> 
> 
>   ????? When I tried the former, it automatically changed to the latter.
> Is the former considered to be more stable?

CRAN puts this on every package page:

"Please use the canonical form https://CRAN.R-project.org/package=xxxx 
to link to this page."

I think one of the checks will complain if it notices you give the link 
in a different form.  I forget which URLs it checks.

Duncan Murdoch


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Sep  1 17:57:10 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sun, 01 Sep 2019 08:57:10 -0700
Subject: [R-pkg-devel] URL of a frame (or a vignette)?
In-Reply-To: <d9654cfd-f845-8fb2-fb80-e22b1466bd77@gmail.com>
References: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>
 <6CBE2061-E145-4AE4-915D-9564C8C3A2C1@dcn.davis.ca.us>
 <4f66b589-1731-afda-922f-649237888ef1@effectivedefense.org>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788C1@MBXP01.ds.man.ac.uk>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788DC@MBXP01.ds.man.ac.uk>
 <55e64fbc-ffa6-a28a-0e48-29411c7f2900@effectivedefense.org>
 <d9654cfd-f845-8fb2-fb80-e22b1466bd77@gmail.com>
Message-ID: <59D76A7B-438F-41EA-81E1-8074FCE3B7C4@dcn.davis.ca.us>

I don't know if [1] implies vignette persistence after archiving, but it might. I think it just has to fall back to a warning with an archive link to qualify. (Quite a slick trick if so because there can potentially be a parade of different package vignettes over time.)

[1] https://stat.ethz.ch/pipermail/r-package-devel/2016q3/001100.html


On September 1, 2019 8:49:52 AM PDT, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>On 01/09/2019 11:33 a.m., Spencer Graves wrote:
>>   ????? What's the difference between
>> 
>> 
>> https://cran.r-project.org/package=bssm/vignettes/bssm.pdf
>> 
>> 
>>   ????? and
>> 
>> 
>> https://cran.r-project.org/web/packages/bssm/vignettes/bssm.pdf
>> 
>> 
>>   ????? When I tried the former, it automatically changed to the
>latter.
>> Is the former considered to be more stable?
>
>CRAN puts this on every package page:
>
>"Please use the canonical form https://CRAN.R-project.org/package=xxxx 
>to link to this page."
>
>I think one of the checks will complain if it notices you give the link
>
>in a different form.  I forget which URLs it checks.
>
>Duncan Murdoch

-- 
Sent from my phone. Please excuse my brevity.


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun Sep  1 21:19:04 2019
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 1 Sep 2019 14:19:04 -0500
Subject: [R-pkg-devel] URL of a frame (or a vignette)?
In-Reply-To: <d9654cfd-f845-8fb2-fb80-e22b1466bd77@gmail.com>
References: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>
 <6CBE2061-E145-4AE4-915D-9564C8C3A2C1@dcn.davis.ca.us>
 <4f66b589-1731-afda-922f-649237888ef1@effectivedefense.org>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788C1@MBXP01.ds.man.ac.uk>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788DC@MBXP01.ds.man.ac.uk>
 <55e64fbc-ffa6-a28a-0e48-29411c7f2900@effectivedefense.org>
 <d9654cfd-f845-8fb2-fb80-e22b1466bd77@gmail.com>
Message-ID: <7adbe78d-6355-e89d-d1b4-199993f4c181@effectivedefense.org>

 ????? I just learned that finding the package on "rdocumentation.org", 
then clicking on the vignette I want at the end of the page, "bssm.Rmd", 
gave me a URL that is portable, at least for the moment:


https://www.rdocumentation.org/packages/bssm/versions/0.1.7/vignettes/bssm.Rmd


 ????? This seems less likely to be trapped by CRAN checks unless it 
actually stops working ;-)


 ????? Thanks to all who replied to my question.
 ????? Spencer


On 2019-09-01 10:49, Duncan Murdoch wrote:
> On 01/09/2019 11:33 a.m., Spencer Graves wrote:
>> ? ????? What's the difference between
>>
>>
>> https://cran.r-project.org/package=bssm/vignettes/bssm.pdf
>>
>>
>> ? ????? and
>>
>>
>> https://cran.r-project.org/web/packages/bssm/vignettes/bssm.pdf
>>
>>
>> ? ????? When I tried the former, it automatically changed to the latter.
>> Is the former considered to be more stable?
>
> CRAN puts this on every package page:
>
> "Please use the canonical form https://CRAN.R-project.org/package=xxxx 
> to link to this page."
>
> I think one of the checks will complain if it notices you give the 
> link in a different form.? I forget which URLs it checks.
>
> Duncan Murdoch
>


From gor@n@bro@trom @end|ng |rom umu@@e  Sun Sep  1 21:46:04 2019
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Sun, 1 Sep 2019 21:46:04 +0200
Subject: [R-pkg-devel] R, BLAS, and FCLEN
In-Reply-To: <aa335279-734d-6ac8-e957-5070768201c5@umu.se>
References: <aa335279-734d-6ac8-e957-5070768201c5@umu.se>
Message-ID: <2d39dac4-0094-374e-d2d2-2cc12773835d@umu.se>



On 2019-08-31 18:47, G?ran Brostr?m wrote:
> I'm having difficulties updating my package eha: When I run standard 
> checks 'at home' everything is fine, but 'CRAN-submissions' reports 
> (among other things):
> 
> geomsup.f:324:9: warning: type of ?dgemv? does not match original 
> declaration [-Wlto-type-mismatch]
>  ? 324 |????? &???? one, score, ione)
>  ????? |???????? ^
> /home/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:107:1: note: type mismatch in 
> parameter 12
>  ? 107 | F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>  ????? | ^
> 
> This is odd since the LAPACK subroutine dgemv takes only 11 parameters. 
> However, in include/R_ext/BLAS.h we have
> 
> F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>  ??????? const double *alpha, const double *a, const int *lda,
>  ??????? const double *x, const int *incx, const double *beta,
>  ??????? double *y, const int *incy FCLEN);
> 
> with a 12th parameter FCLEN?? How am I supposed to fix this, and what 
> the ... is FCLEN? googling leads to nothing useful (for me). It seems as 
> if R is redefining some standard LAPACK routines.
> 
> Also a note I do not understand (in this context):
> 
> note: type ?void? should match type ?long int?
> 
> Any help is much appreciated.
> 
> Best, G?ran
> 
> PS. How can I trigger these Warnings 'at home'?

See https://www.stats.ox.ac.uk/pub/bdr/LTO/README.txt (thanks to Uwe 
Ligges).

Another relevant document seems to be (2019-05-15):

https://developer.r-project.org/Blog/public/2019/05/15/gfortran-issues-with-lapack/index.html

First sentence:
"Recent version of the GNU Fortran compiler (7, 8, 9) include 
optimizations that break interoperability between C and Fortran code 
with BLAS/LAPACK."

And later:
"For the time being, everyone should use -fno-optimize-sibling-calls 
with GFortran version 7 and newer."

G,

> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Mon Sep  2 10:49:51 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Mon, 2 Sep 2019 08:49:51 +0000
Subject: [R-pkg-devel] URL of a frame (or a vignette)?
In-Reply-To: <7adbe78d-6355-e89d-d1b4-199993f4c181@effectivedefense.org>
References: <21b31f02-07b3-acea-cda6-f5e10553c236@effectivedefense.org>
 <6CBE2061-E145-4AE4-915D-9564C8C3A2C1@dcn.davis.ca.us>
 <4f66b589-1731-afda-922f-649237888ef1@effectivedefense.org>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788C1@MBXP01.ds.man.ac.uk>
 <438D2EC9EAFE5946B2D5864670EA468E01CC7788DC@MBXP01.ds.man.ac.uk>
 <55e64fbc-ffa6-a28a-0e48-29411c7f2900@effectivedefense.org>
 <d9654cfd-f845-8fb2-fb80-e22b1466bd77@gmail.com>
 <7adbe78d-6355-e89d-d1b4-199993f4c181@effectivedefense.org>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E01CC7789E1@MBXP01.ds.man.ac.uk>

I personally would not link to rdocumentation. They update packages rather erratically and the information can be months or even years old, without any indication. The drop down list "Other versions" at the top of the package page is a misnomer, it should be "Older versions".

My main objection though is that, in my opinion, they blatantly disrespect the GPL license. Their pages are like a trap, with all their links 
pointing back to their site. They do not put even a link to CRAN, the place where they take the files from. Even the authors' names are linked them! The only way to ensure a prominent link to CRAN is to have a badge or link at the top of the README file, which they show. This is one of the reasons a put a CRAN badge at the top of my README file, even though it looks strange on CRAN. 

I alerted them about this a couple of years ago in their 'Comments' area but they did not respond. 


Georgi Boshnakov
 

-----Original Message-----
From: Spencer Graves [mailto:spencer.graves at effectivedefense.org] 
Sent: 01 September 2019 20:19
To: Duncan Murdoch; Georgi Boshnakov; Jeff Newmiller; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] URL of a frame (or a vignette)?

 ????? I just learned that finding the package on "rdocumentation.org", 
then clicking on the vignette I want at the end of the page, "bssm.Rmd", 
gave me a URL that is portable, at least for the moment:


https://www.rdocumentation.org/packages/bssm/versions/0.1.7/vignettes/bssm.Rmd


 ????? This seems less likely to be trapped by CRAN checks unless it 
actually stops working ;-)


 ????? Thanks to all who replied to my question.
 ????? Spencer


On 2019-09-01 10:49, Duncan Murdoch wrote:
> On 01/09/2019 11:33 a.m., Spencer Graves wrote:
>> ? ????? What's the difference between
>>
>>
>> https://cran.r-project.org/package=bssm/vignettes/bssm.pdf
>>
>>
>> ? ????? and
>>
>>
>> https://cran.r-project.org/web/packages/bssm/vignettes/bssm.pdf
>>
>>
>> ? ????? When I tried the former, it automatically changed to the latter.
>> Is the former considered to be more stable?
>
> CRAN puts this on every package page:
>
> "Please use the canonical form https://CRAN.R-project.org/package=xxxx 
> to link to this page."
>
> I think one of the checks will complain if it notices you give the 
> link in a different form.? I forget which URLs it checks.
>
> Duncan Murdoch
>


From @|mon@pene| @end|ng |rom un|v-|yon1@|r  Tue Sep  3 10:52:34 2019
From: @|mon@pene| @end|ng |rom un|v-|yon1@|r (Simon Penel)
Date: Tue, 3 Sep 2019 10:52:34 +0200
Subject: [R-pkg-devel] question about "checking for non-standard things in
 the check directory"
Message-ID: <766a5a64-fee6-8751-88c5-1cf8336d6e89@univ-lyon1.fr>

Hello,

I would like to? submit a new release of the package seqinr.

I am using the following:

R CMD check --as-cran

* using R Under development (unstable) (2019-09-01 r77119)
* using platform: x86_64-pc-linux-gnu (64-bit)


Everything worked fine except for? this message:

* checking for non-standard things in the check directory ... NOTE
Found the following files/directories:
   ?Acinetobacter_ADP1_uid61597.fasta? ?ec999.ffn? ?ortho3.fasta?
   ?test.revalign?

I was unable to find some information about this message.

I understand that these files are created? in the check directory when 
running the examples, but I don't understand what's the matter with this?

What should I do to get rid of this NOTE ?

thanks for your help

All the best,

Simon









-- 
Simon Penel     ^(;,;)^
Laboratoire de Biometrie et Biologie Evolutive
Bat 711 - CNRS UMR 5558
43 bd du 11 novembre 1918 69622 Villeurbanne Cedex
Tel:   04 72 43 29 04      Fax:  04 72 43 13 88
http://lbbe.univ-lyon1.fr/-Penel-Simon-.html?lang=fr


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Tue Sep  3 14:04:57 2019
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Tue, 3 Sep 2019 14:04:57 +0200
Subject: [R-pkg-devel] 
 question about "checking for non-standard things in
 the check directory"
In-Reply-To: <766a5a64-fee6-8751-88c5-1cf8336d6e89@univ-lyon1.fr>
References: <766a5a64-fee6-8751-88c5-1cf8336d6e89@univ-lyon1.fr>
Message-ID: <55ac921a-726f-4603-a4de-62c781070792@statistik.tu-dortmund.de>



On 03.09.2019 10:52, Simon Penel wrote:
> Hello,
> 
> I would like to? submit a new release of the package seqinr.
> 
> I am using the following:
> 
> R CMD check --as-cran
> 
> * using R Under development (unstable) (2019-09-01 r77119)
> * using platform: x86_64-pc-linux-gnu (64-bit)
> 
> 
> Everything worked fine except for? this message:
> 
> * checking for non-standard things in the check directory ... NOTE
> Found the following files/directories:
>  ? ?Acinetobacter_ADP1_uid61597.fasta? ?ec999.ffn? ?ortho3.fasta?
>  ? ?test.revalign?
> 
> I was unable to find some information about this message.
> 
> I understand that these files are created? in the check directory when 
> running the examples, but I don't understand what's the matter with this?

because you must not write to the user filespace in examples as detailed 
in the CRAN policies. Please rather write to tempdir() in examples.

Best,
Uwe Ligges


> 
> What should I do to get rid of this NOTE ?
> 
> thanks for your help
> 
> All the best,
> 
> Simon
> 
> 
> 
> 
> 
> 
> 
> 
>


From @|mon@pene| @end|ng |rom un|v-|yon1@|r  Tue Sep  3 14:39:33 2019
From: @|mon@pene| @end|ng |rom un|v-|yon1@|r (Simon Penel)
Date: Tue, 3 Sep 2019 14:39:33 +0200
Subject: [R-pkg-devel] 
 question about "checking for non-standard things in
 the check directory"
In-Reply-To: <55ac921a-726f-4603-a4de-62c781070792@statistik.tu-dortmund.de>
References: <766a5a64-fee6-8751-88c5-1cf8336d6e89@univ-lyon1.fr>
 <55ac921a-726f-4603-a4de-62c781070792@statistik.tu-dortmund.de>
Message-ID: <6163b425-470c-a33a-8afb-1e6a107861ba@univ-lyon1.fr>

Thanks a lot? , it's worked,

all the best

Simon



Le 03/09/2019 ? 14:04, Uwe Ligges a ?crit?:
>
>
> On 03.09.2019 10:52, Simon Penel wrote:
>> Hello,
>>
>> I would like to? submit a new release of the package seqinr.
>>
>> I am using the following:
>>
>> R CMD check --as-cran
>>
>> * using R Under development (unstable) (2019-09-01 r77119)
>> * using platform: x86_64-pc-linux-gnu (64-bit)
>>
>>
>> Everything worked fine except for? this message:
>>
>> * checking for non-standard things in the check directory ... NOTE
>> Found the following files/directories:
>> ?? ?Acinetobacter_ADP1_uid61597.fasta? ?ec999.ffn? ?ortho3.fasta?
>> ?? ?test.revalign?
>>
>> I was unable to find some information about this message.
>>
>> I understand that these files are created? in the check directory 
>> when running the examples, but I don't understand what's the matter 
>> with this?
>
> because you must not write to the user filespace in examples as 
> detailed in the CRAN policies. Please rather write to tempdir() in 
> examples.
>
> Best,
> Uwe Ligges
>
>
>>
>> What should I do to get rid of this NOTE ?
>>
>> thanks for your help
>>
>> All the best,
>>
>> Simon
>>
>>
>>
>>
>>
>>
>>
>>
>>
> .
>

-- 
Simon Penel     ^(;,;)^
Laboratoire de Biometrie et Biologie Evolutive
Bat 711 - CNRS UMR 5558
43 bd du 11 novembre 1918 69622 Villeurbanne Cedex
Tel:   04 72 43 29 04      Fax:  04 72 43 13 88
http://lbbe.univ-lyon1.fr/-Penel-Simon-.html?lang=fr


From boennecd @end|ng |rom gm@||@com  Tue Sep  3 15:07:14 2019
From: boennecd @end|ng |rom gm@||@com (Benjamin Christoffersen)
Date: Tue, 3 Sep 2019 15:07:14 +0200
Subject: [R-pkg-devel] Single character in Fortran function and FCONE and
 FCLEN macros
Message-ID: <CAHHSL8voEM87rYG_iK4Mknxe9Oh6_5zwUXRPgfJOJVkiEVpVjA@mail.gmail.com>

Dear Sirs,

I have tried to update my 'dynamichazard' package on CRAN but I have
had some issues with the '-Wlto-type-mismatch' checks. In particular,
I have tried to follow "Writing R Extensions" section "Fortran
character strings" and defined a C++ header file
(https://github.com/boennecd/dynamichazard/blob/460fe74cadad5c029c4f0ffb50074139135c2166/src/Rconfig-wrap.h)
with the following content

> #ifndef RCONFIG_WRAP_H
> #define RCONFIG_WRAP_H
> #define USE_FC_LEN_T
> #include <Rconfig.h>
>
> #ifndef FCLEN
> #define FCLEN
> #endif
> #ifndef FCONE
> #define FCONE
> #endif
>
> #endif

which I include before including 'R_ext/BLAS.h' and 'R_ext/Lapack.h'
files. I then make the following C declaration of the Fortran
subroutine that causes the issue
(https://github.com/boennecd/dynamichazard/blob/460fe74cadad5c029c4f0ffb50074139135c2166/src/BLAS_LAPACK/R_BLAS_LAPACK.cpp#L2-L29)

> extern "C"
>   {
>     void F77_NAME(dchur)(
>         const char*,   // UPLO
>         const char*,   // TRANS
>         int*,    // N
>         int*,    // M
>         double*, // R
>         int*,    // LDR
>         double*, // X
>         double*, // Z
>         int*,    // LDZ
>         double*, // Y
>         double*, // RHO
>         double*, // C
>         double*, // S
>         int*     // INFO,
>         FCLEN FCLEN
>     );
>   }

Lastly, I use the 'FCONE' macro when calling the function. The Fortran
subroutine (a LINPACK subroutine) is defined in this file:
https://github.com/boennecd/dynamichazard/blob/460fe74cadad5c029c4f0ffb50074139135c2166/src/BLAS_LAPACK/dchur.f#L7

I gather the above is as done in the BLAS and LAPACK header in R. Yet,
I still got a mail in the CRAN submission stating that

> We see
>
> * checking whether package ?dynamichazard? can be installed ...
> [207s/211s] WARNING
> Found the following significant warnings:
>    BLAS_LAPACK/R_BLAS_LAPACK.cpp:12:10: warning: type of ?dchur_? does
> not match original declaration [-Wlto-type-mismatch]
>
> and there's also
>
> BLAS_LAPACK/R_BLAS_LAPACK.cpp:12:10: warning: type of ?dchur_? does not
> match original declaration [-Wlto-type-mismatch]
>     12 |     void F77_NAME(dchur)(
>        |          ^
> BLAS_LAPACK/dchur.f:7:1: note: type mismatch in parameter 15
>      7 |       SUBROUTINE DCHUR(UPLO,TRANS,N,M,R,LDR,X,Z,LDZ,Y,RHO,C,S,INFO)
>        | ^
> BLAS_LAPACK/dchur.f:7:1: note: type ?long int? should match type ?void?
> BLAS_LAPACK/dchur.f:7:1: note: ?dchur? was previously declared here

I am not sure how to handle the issue. I am sorry if I am doing
something which is obviously wrong.

I also got some messages about the declarations in RcppArmadillo but I
gather these are upstream issues which I cannot do anything about
> /home/Hornik/tmp/R-d-gcc-LTO/include/R_ext/Lapack.h:1584:1: warning: ?dtrtri_? violates the C++ One Definition Rule [-Wodr]
>  1584 | F77_NAME(dtrtri)(const char* uplo, const char* diag,
>       | ^
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:421:8: note: type mismatch in parameter 7
>   421 |   void arma_fortran(arma_dtrtri)(const char* uplo, const char* diag, const blas_int* n, double* a, const blas_int* lda, blas_int* info, blas_len uplo_len, blas_len diag_len);
>       |        ^
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:421:8: note: type ?blas_len? should match type ?void?
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:421:8: note: ?dtrtri_? was previously declared here
> /home/Hornik/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:242:1: warning: ?dsyrk_? violates the C++ One Definition Rule [-Wodr]
>   242 | F77_NAME(dsyrk)(const char *uplo, const char *trans,
>       | ^
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_blas.hpp:110:8: note: type mismatch in parameter 11
>   110 |   void arma_fortran(arma_dsyrk)(const char* uplo, const char* transA, const blas_int* n, const blas_int* k, const double* alpha, const double* > A, const blas_int* ldA, const double* beta, double* C, const blas_int* ldC, blas_len uplo_len, blas_len transA_len);
>       |        ^
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_blas.hpp:110:8: note: type ?blas_len? should match type ?void?
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_blas.hpp:110:8: note: ?dsyrk_? was previously declared here
> /home/Hornik/tmp/R-d-gcc-LTO/include/R_ext/Lapack.h:825:1: warning: ?dpotrf_? violates the C++ One Definition Rule [-Wodr]
>   825 | F77_NAME(dpotrf)(const char* uplo, const int* n,
>       | ^
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:467:8: note: type mismatch in parameter 6
>   467 |   void arma_fortran(arma_dpotrf)(const char* uplo, const blas_int* n, double* a, const blas_int* lda, blas_int* info, blas_len uplo_len);
>       |        ^
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:467:8: note: type ?blas_len? should match type ?void?
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:467:8: note: ?dpotrf_? was previously declared here
> installing to /home/Hornik/tmp/CRAN/dynamichazard.Rcheck/00LOCK-dynamichazard/00new/dynamichazard/libs

Sincerely Yours,
Benjamin Christoffersen


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Tue Sep  3 15:37:20 2019
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Tue, 3 Sep 2019 15:37:20 +0200
Subject: [R-pkg-devel] 
 Single character in Fortran function and FCONE and FCLEN macros
In-Reply-To: <CAHHSL8voEM87rYG_iK4Mknxe9Oh6_5zwUXRPgfJOJVkiEVpVjA@mail.gmail.com>
References: <CAHHSL8voEM87rYG_iK4Mknxe9Oh6_5zwUXRPgfJOJVkiEVpVjA@mail.gmail.com>
Message-ID: <a4de759c-e807-786d-b700-d8cd6e90ef84@gmail.com>

On 9/3/19 3:07 PM, Benjamin Christoffersen wrote:
> Dear Sirs,
>
> I have tried to update my 'dynamichazard' package on CRAN but I have
> had some issues with the '-Wlto-type-mismatch' checks. In particular,
> I have tried to follow "Writing R Extensions" section "Fortran
> character strings" and defined a C++ header file
> (https://github.com/boennecd/dynamichazard/blob/460fe74cadad5c029c4f0ffb50074139135c2166/src/Rconfig-wrap.h)
> with the following content
>
>> #ifndef RCONFIG_WRAP_H
>> #define RCONFIG_WRAP_H
>> #define USE_FC_LEN_T
>> #include <Rconfig.h>
>>
>> #ifndef FCLEN
>> #define FCLEN
>> #endif
>> #ifndef FCONE
>> #define FCONE
>> #endif
>>
>> #endif

I'd try following WRE on this exactly: include R_ext/BLAS.h and only 
after that define FCONE (if not defined) - and FCLEN if you need it as 
well.

> which I include before including 'R_ext/BLAS.h' and 'R_ext/Lapack.h'
> files. I then make the following C declaration of the Fortran
> subroutine that causes the issue
> (https://github.com/boennecd/dynamichazard/blob/460fe74cadad5c029c4f0ffb50074139135c2166/src/BLAS_LAPACK/R_BLAS_LAPACK.cpp#L2-L29)
>
>> extern "C"
>>    {
>>      void F77_NAME(dchur)(
>>          const char*,   // UPLO
>>          const char*,   // TRANS
>>          int*,    // N
>>          int*,    // M
>>          double*, // R
>>          int*,    // LDR
>>          double*, // X
>>          double*, // Z
>>          int*,    // LDZ
>>          double*, // Y
>>          double*, // RHO
>>          double*, // C
>>          double*, // S
>>          int*     // INFO,
>>          FCLEN FCLEN
>>      );
>>    }
> Lastly, I use the 'FCONE' macro when calling the function. The Fortran
> subroutine (a LINPACK subroutine) is defined in this file:
> https://github.com/boennecd/dynamichazard/blob/460fe74cadad5c029c4f0ffb50074139135c2166/src/BLAS_LAPACK/dchur.f#L7
>
> I gather the above is as done in the BLAS and LAPACK header in R. Yet,
> I still got a mail in the CRAN submission stating that
>
>> We see
>>
>> * checking whether package ?dynamichazard? can be installed ...
>> [207s/211s] WARNING
>> Found the following significant warnings:
>>     BLAS_LAPACK/R_BLAS_LAPACK.cpp:12:10: warning: type of ?dchur_? does
>> not match original declaration [-Wlto-type-mismatch]
>>
>> and there's also
>>
>> BLAS_LAPACK/R_BLAS_LAPACK.cpp:12:10: warning: type of ?dchur_? does not
>> match original declaration [-Wlto-type-mismatch]
>>      12 |     void F77_NAME(dchur)(
>>         |          ^
>> BLAS_LAPACK/dchur.f:7:1: note: type mismatch in parameter 15
>>       7 |       SUBROUTINE DCHUR(UPLO,TRANS,N,M,R,LDR,X,Z,LDZ,Y,RHO,C,S,INFO)
>>         | ^
>> BLAS_LAPACK/dchur.f:7:1: note: type ?long int? should match type ?void?
>> BLAS_LAPACK/dchur.f:7:1: note: ?dchur? was previously declared here
> I am not sure how to handle the issue. I am sorry if I am doing
> something which is obviously wrong.
I'd try debugging this with gcc -E, checking whether the FCLEN and FCONE 
macros work as intended. If the build process of the package seemed too 
complicated for that, you could also look at the disassembly for the 
calls, or compile with -fdump-tree-all? and look at the gfortran/gcc 
diagnostic files to see if the calls include the hidden 1s. The output 
seems to suggest that the macros have not been defined properly.||
> I also got some messages about the declarations in RcppArmadillo but I
> gather these are upstream issues which I cannot do anything about
>> /home/Hornik/tmp/R-d-gcc-LTO/include/R_ext/Lapack.h:1584:1: warning: ?dtrtri_? violates the C++ One Definition Rule [-Wodr]
>>   1584 | F77_NAME(dtrtri)(const char* uplo, const char* diag,
>>        | ^
>> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:421:8: note: type mismatch in parameter 7
>>    421 |   void arma_fortran(arma_dtrtri)(const char* uplo, const char* diag, const blas_int* n, double* a, const blas_int* lda, blas_int* info, blas_len uplo_len, blas_len diag_len);
>>        |        ^
>> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:421:8: note: type ?blas_len? should match type ?void?
>> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:421:8: note: ?dtrtri_? was previously declared here
>> /home/Hornik/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:242:1: warning: ?dsyrk_? violates the C++ One Definition Rule [-Wodr]
>>    242 | F77_NAME(dsyrk)(const char *uplo, const char *trans,
>>        | ^
>> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_blas.hpp:110:8: note: type mismatch in parameter 11
>>    110 |   void arma_fortran(arma_dsyrk)(const char* uplo, const char* transA, const blas_int* n, const blas_int* k, const double* alpha, const double* > A, const blas_int* ldA, const double* beta, double* C, const blas_int* ldC, blas_len uplo_len, blas_len transA_len);
>>        |        ^
>> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_blas.hpp:110:8: note: type ?blas_len? should match type ?void?
>> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_blas.hpp:110:8: note: ?dsyrk_? was previously declared here
>> /home/Hornik/tmp/R-d-gcc-LTO/include/R_ext/Lapack.h:825:1: warning: ?dpotrf_? violates the C++ One Definition Rule [-Wodr]
>>    825 | F77_NAME(dpotrf)(const char* uplo, const int* n,
>>        | ^
>> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:467:8: note: type mismatch in parameter 6
>>    467 |   void arma_fortran(arma_dpotrf)(const char* uplo, const blas_int* n, double* a, const blas_int* lda, blas_int* info, blas_len uplo_len);
>>        |        ^
>> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:467:8: note: type ?blas_len? should match type ?void?
>> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:467:8: note: ?dpotrf_? was previously declared here
>> installing to /home/Hornik/tmp/CRAN/dynamichazard.Rcheck/00LOCK-dynamichazard/00new/dynamichazard/libs

Yes, that seems to be an upstream problem.

Best
Tomas

> Sincerely Yours,
> Benjamin Christoffersen
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



	[[alternative HTML version deleted]]


From er|c@|e||er @end|ng |rom gm@||@com  Wed Sep  4 23:30:27 2019
From: er|c@|e||er @end|ng |rom gm@||@com (Eric Leifer)
Date: Wed, 4 Sep 2019 17:30:27 -0400
Subject: [R-pkg-devel] DESCRIPTION file errors
Message-ID: <CADC3n86G7v1xuqrXk0eoc=o+HFC2R7WzajceVfb5q+PRUROwKA@mail.gmail.com>

Hello,
I submitted a new package to CRAN, and received the following error message.
# start error message
 Possibly mis-spelled words in DESCRIPTION:
    Bunn (12:30)
    Couper (12:39)
    EV (11:10)
    Follmann (14:40)
    JF (14:25)
    Kolecki (14:29)
    Leifer (14:5)
    Slud (11:5)
    Troendle (14:16)

  Malformed Description field: should contain one or more complete
sentences.
# end error message
I believe I am getting the error message because I am including references
in the Description field of my DESCRIPTION file.  Here's what my
Description field looks like:
# start Description field
Description:
    Used for the design and analysis of a 2x2 factorial trial for
    a time-to-event endpoint.  Performs power calculations and significance
    testing.  Important reference papers include
    Slud EV. (1994) <https://www.ncbi.nlm.nih.gov/pubmed/8086609>
    Lin DY, Gong J, Gallo P, Bunn PH, Couper D. (2016)
    <https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5026867>
    Leifer ES, Troendle JF, Kolecki A, Follmann DA. (2019)
    <
https://github.com/EricSLeifer/factorial2x2/blob/master/Leifer%20et%20al%20Factorial.pdf
>
# end Description field
Question:  should I be including my references in a different format in the
Description field?  Should I include references in my DESCRIPTION file at
all?

Thank you in advance for any help.
Eric

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Thu Sep  5 04:27:53 2019
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Thu, 5 Sep 2019 04:27:53 +0200
Subject: [R-pkg-devel] DESCRIPTION file errors
In-Reply-To: <CADC3n86G7v1xuqrXk0eoc=o+HFC2R7WzajceVfb5q+PRUROwKA@mail.gmail.com>
References: <CADC3n86G7v1xuqrXk0eoc=o+HFC2R7WzajceVfb5q+PRUROwKA@mail.gmail.com>
Message-ID: <2e19bab2-b838-01ea-bfd2-6bd424a6973e@statistik.tu-dortmund.de>



On 04.09.2019 23:30, Eric Leifer wrote:
> Hello,
> I submitted a new package to CRAN, and received the following error message.
> # start error message
>   Possibly mis-spelled words in DESCRIPTION:
>      Bunn (12:30)
>      Couper (12:39)
>      EV (11:10)
>      Follmann (14:40)
>      JF (14:25)
>      Kolecki (14:29)
>      Leifer (14:5)
>      Slud (11:5)
>      Troendle (14:16)
> 
>    Malformed Description field: should contain one or more complete
> sentences.
> # end error message
> I believe I am getting the error message because I am including references
> in the Description field of my DESCRIPTION file.  Here's what my
> Description field looks like:
> # start Description field
> Description:
>      Used for the design and analysis of a 2x2 factorial trial for
>      a time-to-event endpoint.  Performs power calculations and significance
>      testing.  Important reference papers include
>      Slud EV. (1994) <https://www.ncbi.nlm.nih.gov/pubmed/8086609>
>      Lin DY, Gong J, Gallo P, Bunn PH, Couper D. (2016)
>      <https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5026867>
>      Leifer ES, Troendle JF, Kolecki A, Follmann DA. (2019)
>      <
> https://github.com/EricSLeifer/factorial2x2/blob/master/Leifer%20et%20al%20Factorial.pdf
>>
> # end Description field
> Question:  should I be including my references in a different format in the
> Description field?  Should I include references in my DESCRIPTION file at
> all?

You need a final period after the reference in your last sentence.

You can replace the links via the (ideally stable) DOI as in 
<DOI:10.1111/biom.12507>.

Best,
Uwe Ligges



> Thank you in advance for any help.
> Eric
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Thu Sep  5 12:26:45 2019
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Thu, 5 Sep 2019 12:26:45 +0200
Subject: [R-pkg-devel] set pkg_config for 3rd party software
In-Reply-To: <D115402E-21CE-44EE-B867-E6902833A459@kaust.edu.sa>
References: <D115402E-21CE-44EE-B867-E6902833A459@kaust.edu.sa>
Message-ID: <23920.58085.22252.888537@stat.math.ethz.ch>

>>>>> Sameh M Abdulah 
>>>>>     on Fri, 30 Aug 2019 18:50:55 +0000 writes:

    > Hi,
    > I recently asked some questions about my R package which were well responded by Dirk.

    > I have another question related to pkg_config path,

    > I am using this command to add the installation path to the PKG_CONFIG_PATH   so that all cmake commands can get the required libraries from this path,

    > Sys.setenv(PKG_CONFIG_PATH=paste(Sys.getenv("PKG_CONFIG_PATH"),paste(.libPaths(),"exageostat/lib/pkgconfig",sep='/',collapse=':'),sep=':'))

    > Is there a simple way to set this path without explicitly calling this line before installing my package? OR is there any other path that I can use so that all software CMake commands can easily find the required libraries?

    > --Sameh

Not an answer, but a  #METOO   with a hopefull very related
question, also on using 'pkg-config' (Note: "-", not "_" here)
for package configuration.

I'm maintainer of CRAN package Rmpfr (for arbitrary precise arithmetic..),
    https://cran.r-project.org/package=Rmpfr
development & source on R-forge
     http://rmpfr.r-forge.r-project.org/
and  https://r-forge.r-project.org/scm/viewvc.php/pkg/?root=rmpfr
which "down there"  is principally an interface to the GNU MPFR
C library (which also needs the GNU  GMP C library).

I do have a  Rmpfr/configure.ac from which to produce
Rmpfr/configure which then ensures that both libraries (MPFR and GMP)
are found and are "working".
The 'configure' script then (supposedly, but not on Windows?) takes
either src/Makevars.in  (non-Windows)
or     src/Makevars.win (Windows)
to produce  src/Makevars
which then is used during compilation of the C sources of my
package.

Notably it will contain   '-lmpfr -lgmp'  among the LDFLAGS in
any case.

Now back to the 'pkg-config' : The compiler *also* needs correct

-I<path>  (the path used  by ' #include <...> ' statement)

and for linking a correct  -L<path>.

Now, my main OS,  Linux Fedora (as all other decent Linux distributions)
does provide MPFR and GMP libraries (and include headers) as OS
packages, installed in  /usr/lib/ (actually /lib64 nowadays)
and /usr/include respectively.

However, for some reasons I don't know the *version* of the MPFR
library that the OS provides is outdate (to my taste), and I'd
really want a newer version of MPFR,  which I easily install in
a version of /usr/local/..... *and* I also make sure that

    pkg-config --libs mpfr
and pkg-config --cflags mpfr

list the corresponding LDFLAGS  and CFLAGS

(the first giving

  -L/usr/local.../mpfr/4.0.1/lib -lmpfr -lgmp 

 the 2nd

  -I/usr/local.../mpfr/4.0.1/include 
)

Now what is the officially / best way to have either 'configure'
or  Makevars.{in,win}  use the 'pkg-config' information
*dynamically*, i.e.,
if I update my MPFR from 4.0.1 to 4.0.2  the newer 4.0.2 is found ?

My current setup would not even work on some platforms to really
end up using my local version of MPFR instead of the system-wide
OS default (using /lib64 and /usr/include/ and then
which even with quite new Fedora 30 is still MPFR 3.1.6 .. much
too old for some of the things I want).


From edd @end|ng |rom deb|@n@org  Thu Sep  5 12:59:49 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Thu, 5 Sep 2019 05:59:49 -0500
Subject: [R-pkg-devel] 
 Single character in Fortran function and FCONE and FCLEN macros
In-Reply-To: <a4de759c-e807-786d-b700-d8cd6e90ef84@gmail.com>
References: <CAHHSL8voEM87rYG_iK4Mknxe9Oh6_5zwUXRPgfJOJVkiEVpVjA@mail.gmail.com>
 <a4de759c-e807-786d-b700-d8cd6e90ef84@gmail.com>
Message-ID: <23920.60069.35078.742013@rob.eddelbuettel.com>


On 3 September 2019 at 15:37, Tomas Kalibera wrote:
| Yes, that seems to be an upstream problem.

Maybe checking with the documentation for Armadillo documentation at
http://arma.sourceforge.net/docs.html (large page, see about the various
#define in config.hpp near the bottom) could be of help. Might be worth
trying to set ARMA_DONT_USE_FORTRAN_HIDDEN_ARGS.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @ergue|@@oko| @end|ng |rom gm@||@com  Thu Sep  5 14:46:17 2019
From: @ergue|@@oko| @end|ng |rom gm@||@com (Serguei Sokol)
Date: Thu, 5 Sep 2019 14:46:17 +0200
Subject: [R-pkg-devel] set pkg_config for 3rd party software
In-Reply-To: <23920.58085.22252.888537@stat.math.ethz.ch>
References: <D115402E-21CE-44EE-B867-E6902833A459@kaust.edu.sa>
 <23920.58085.22252.888537@stat.math.ethz.ch>
Message-ID: <c71aa29d-27dc-41bd-1703-995e33d7d4e8@gmail.com>

On 05/09/2019 12:26, Martin Maechler wrote:
>>>>>> Sameh M Abdulah
>>>>>>      on Fri, 30 Aug 2019 18:50:55 +0000 writes:
> 
>      > Hi,
>      > I recently asked some questions about my R package which were well responded by Dirk.
> 
>      > I have another question related to pkg_config path,
> 
>      > I am using this command to add the installation path to the PKG_CONFIG_PATH   so that all cmake commands can get the required libraries from this path,
> 
>      > Sys.setenv(PKG_CONFIG_PATH=paste(Sys.getenv("PKG_CONFIG_PATH"),paste(.libPaths(),"exageostat/lib/pkgconfig",sep='/',collapse=':'),sep=':'))
> 
>      > Is there a simple way to set this path without explicitly calling this line before installing my package? OR is there any other path that I can use so that all software CMake commands can easily find the required libraries?
> 
>      > --Sameh
> 
> Not an answer, but a  #METOO   with a hopefull very related
> question, also on using 'pkg-config' (Note: "-", not "_" here)
> for package configuration.
> 
> I'm maintainer of CRAN package Rmpfr (for arbitrary precise arithmetic..),
>      https://cran.r-project.org/package=Rmpfr
> development & source on R-forge
>       http://rmpfr.r-forge.r-project.org/
> and  https://r-forge.r-project.org/scm/viewvc.php/pkg/?root=rmpfr
> which "down there"  is principally an interface to the GNU MPFR
> C library (which also needs the GNU  GMP C library).
> 
> I do have a  Rmpfr/configure.ac from which to produce
> Rmpfr/configure which then ensures that both libraries (MPFR and GMP)
> are found and are "working".
> The 'configure' script then (supposedly, but not on Windows?) takes
> either src/Makevars.in  (non-Windows)
> or     src/Makevars.win (Windows)
> to produce  src/Makevars
> which then is used during compilation of the C sources of my
> package.
I have a small marginal remark about this.
Makevars.win is not windows equivalent of Makevars.in but of plain 
Makevars (see
https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Package-subdirectories 
)
On windows, you can use configure.win which in turn can use 
Makevars.win.in to produce Makevars.win. The latter will be used by make 
on that platform (see 
https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Configure-and-cleanup 
)

Best,
Serguei.

> 
> Notably it will contain   '-lmpfr -lgmp'  among the LDFLAGS in
> any case.
> 
> Now back to the 'pkg-config' : The compiler *also* needs correct
> 
> -I<path>  (the path used  by ' #include <...> ' statement)
> 
> and for linking a correct  -L<path>.
> 
> Now, my main OS,  Linux Fedora (as all other decent Linux distributions)
> does provide MPFR and GMP libraries (and include headers) as OS
> packages, installed in  /usr/lib/ (actually /lib64 nowadays)
> and /usr/include respectively.
> 
> However, for some reasons I don't know the *version* of the MPFR
> library that the OS provides is outdate (to my taste), and I'd
> really want a newer version of MPFR,  which I easily install in
> a version of /usr/local/..... *and* I also make sure that
> 
>      pkg-config --libs mpfr
> and pkg-config --cflags mpfr
> 
> list the corresponding LDFLAGS  and CFLAGS
> 
> (the first giving
> 
>    -L/usr/local.../mpfr/4.0.1/lib -lmpfr -lgmp
> 
>   the 2nd
> 
>    -I/usr/local.../mpfr/4.0.1/include
> )
> 
> Now what is the officially / best way to have either 'configure'
> or  Makevars.{in,win}  use the 'pkg-config' information
> *dynamically*, i.e.,
> if I update my MPFR from 4.0.1 to 4.0.2  the newer 4.0.2 is found ?
> 
> My current setup would not even work on some platforms to really
> end up using my local version of MPFR instead of the system-wide
> OS default (using /lib64 and /usr/include/ and then
> which even with quite new Fedora 30 is still MPFR 3.1.6 .. much
> too old for some of the things I want).
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From r@||@@tubner @end|ng |rom gm@||@com  Thu Sep  5 16:53:36 2019
From: r@||@@tubner @end|ng |rom gm@||@com (Ralf Stubner)
Date: Thu, 5 Sep 2019 16:53:36 +0200
Subject: [R-pkg-devel] set pkg_config for 3rd party software
In-Reply-To: <23920.58085.22252.888537@stat.math.ethz.ch>
References: <D115402E-21CE-44EE-B867-E6902833A459@kaust.edu.sa>
 <23920.58085.22252.888537@stat.math.ethz.ch>
Message-ID: <CAFQwRQyumboUgjTbnjZfLJdGy6myviE_JxUKQneEtxDJ+Nut6A@mail.gmail.com>

On Thu, Sep 5, 2019 at 12:27 PM Martin Maechler
<maechler at stat.math.ethz.ch> wrote:

> Now what is the officially / best way to have either 'configure'
> or  Makevars.{in,win}  use the 'pkg-config' information
> *dynamically*, i.e.,
> if I update my MPFR from 4.0.1 to 4.0.2  the newer 4.0.2 is found ?

I don't know what is best, but here are three alternatives:

* Use PKG_CHECK_MODULES which sets up default variables with _CFLAGS
and _LIBS suffix after searching for a library with pkg-config, c.f.
https://autotools.io/pkgconfig/pkg_check_modules.html
* Call pkg-config by hand in configure.ac (and hence configure).
Example: https://github.com/eddelbuettel/rcppredis/blob/master/configure.ac#L47-L60
* Call pkg-config within an "Anticonf" configure script. Example:
https://github.com/jeroen/curl/blob/master/configure#L16-L24

cheerio
ralf


From edd @end|ng |rom deb|@n@org  Thu Sep  5 17:14:21 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Thu, 5 Sep 2019 10:14:21 -0500
Subject: [R-pkg-devel] set pkg_config for 3rd party software
In-Reply-To: <CAFQwRQyumboUgjTbnjZfLJdGy6myviE_JxUKQneEtxDJ+Nut6A@mail.gmail.com>
References: <D115402E-21CE-44EE-B867-E6902833A459@kaust.edu.sa>
 <23920.58085.22252.888537@stat.math.ethz.ch>
 <CAFQwRQyumboUgjTbnjZfLJdGy6myviE_JxUKQneEtxDJ+Nut6A@mail.gmail.com>
Message-ID: <23921.9805.109819.530726@rob.eddelbuettel.com>


On 5 September 2019 at 16:53, Ralf Stubner wrote:
| I don't know what is best, but here are three alternatives:
| 
| * Use PKG_CHECK_MODULES which sets up default variables with _CFLAGS
| and _LIBS suffix after searching for a library with pkg-config, c.f.
| https://autotools.io/pkgconfig/pkg_check_modules.html
| * Call pkg-config by hand in configure.ac (and hence configure).
| Example: https://github.com/eddelbuettel/rcppredis/blob/master/configure.ac#L47-L60
| * Call pkg-config within an "Anticonf" configure script. Example:
| https://github.com/jeroen/curl/blob/master/configure#L16-L24

Make it four alternatives:

  * Call pkg-config from an autoconf configure script.  Examples:

  edd at rob:~$ grep -l pkg-config git/*/configure.{ac,in}
  git/libxls/configure.ac
  git/nloptr/configure.ac
  git/rcppmlpack2/configure.ac
  git/rcppredis/configure.ac
  git/rprotobuf/configure.ac
  edd at rob:~$

I know all the cool kids these days hate autoconf, but it a) really is just
careful (and more portable) shell scripting (plus some extra glue).  And it
b) avoids having users on some marginal OSs yell at you when they do not have
bash (just yesterday a Nix user had to comment on a five year old bug in that
is no longer valid as we went back to autoconf there too).  As an extra bonus
it c) also works on Slowlaris.

Best, Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Thu Sep  5 18:36:03 2019
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Thu, 5 Sep 2019 18:36:03 +0200
Subject: [R-pkg-devel] set pkg_config for 3rd party software
In-Reply-To: <23921.9805.109819.530726@rob.eddelbuettel.com>
References: <D115402E-21CE-44EE-B867-E6902833A459@kaust.edu.sa>
 <23920.58085.22252.888537@stat.math.ethz.ch>
 <CAFQwRQyumboUgjTbnjZfLJdGy6myviE_JxUKQneEtxDJ+Nut6A@mail.gmail.com>
 <23921.9805.109819.530726@rob.eddelbuettel.com>
Message-ID: <23921.14707.897708.406983@stat.math.ethz.ch>

>>>>> Dirk Eddelbuettel 
>>>>>     on Thu, 5 Sep 2019 10:14:21 -0500 writes:

    > On 5 September 2019 at 16:53, Ralf Stubner wrote:
    > | I don't know what is best, but here are three alternatives:
    > | 
    > | * Use PKG_CHECK_MODULES which sets up default variables with _CFLAGS
    > | and _LIBS suffix after searching for a library with pkg-config, c.f.
    > | https://autotools.io/pkgconfig/pkg_check_modules.html
    > | * Call pkg-config by hand in configure.ac (and hence configure).
    > | Example: https://github.com/eddelbuettel/rcppredis/blob/master/configure.ac#L47-L60
    > | * Call pkg-config within an "Anticonf" configure script. Example:
    > | https://github.com/jeroen/curl/blob/master/configure#L16-L24

    > Make it four alternatives:

    > * Call pkg-config from an autoconf configure script.  Examples:

    > edd at rob:~$ grep -l pkg-config git/*/configure.{ac,in}
    > git/libxls/configure.ac
    > git/nloptr/configure.ac
    > git/rcppmlpack2/configure.ac
    > git/rcppredis/configure.ac
    > git/rprotobuf/configure.ac
    > edd at rob:~$

    > I know all the cool kids these days hate autoconf, but it a) really is just
    > careful (and more portable) shell scripting (plus some extra glue).  And it
    > b) avoids having users on some marginal OSs yell at you when they do not have
    > bash (just yesterday a Nix user had to comment on a five year old bug in that
    > is no longer valid as we went back to autoconf there too).  As an extra bonus
    > it c) also works on Slowlaris.

    > Best, Dirk

Thank you, Ralf, and Dirk.... that was very useful already !

However, the real problem I am fighting still is not related to
`pkg-config` and friends at all, but to the fact that my OS has
a version of libmpfr in the main system library and that seems
to be used in *any* case when the final <pkg>.so file is linked
together:

For me (on Fedora 30)

  $ R CMD config LDFLAGS
  -L/usr/lib64

  $ ls -l /usr/lib64/libmpfr*
  lrwxrwxrwx. 1 root root     16 Feb  2  2019 /usr/lib64/libmpfr.so -> libmpfr.so.4.1.6
  lrwxrwxrwx. 1 root root     16 Feb  2  2019 /usr/lib64/libmpfr.so.4 -> libmpfr.so.4.1.6
  -rwxr-xr-x. 1 root root 827872 Feb  2  2019 /usr/lib64/libmpfr.so.4.1.6

and for that reason, when         R CMD INSTALL Rmpfr ...

gets to the final linking, it uses

  gcc -shared -L/usr/lib64 -o Rmpfr.so Ops.o .... utils.o -L/usr/local.../mpfr/4.0.2/lib -lmpfr -lgmp

and the early -L/usr/lib64  just "ensures" that my package lib
(Rmpfr.so) is linked against  /usr/lib64/libmpfr.so.4.1.6  which
is old and I "hate" rather than against the much better
libmpfr.so.6.0.2 which would be found in /usr/local.../mpfr/4.0.2/lib

Yes, on a machine with root permission I can hack around to get
what I want,  but of course I'd really like   'R CMD INSTALL ..'
to do the "right thing"
just from my  configure  plus src/Makevars{.in}  files.
Yes, I tried  'LDFLAGS = ' (to set it to "empty") in
src/Makevars*  but that did not help either.

Martin


From r@ph@e|@h@rtm@nn @end|ng |rom p@ycho|og|e@un|-|re|burg@de  Fri Sep  6 08:19:37 2019
From: r@ph@e|@h@rtm@nn @end|ng |rom p@ycho|og|e@un|-|re|burg@de (Raphael Hartmann)
Date: Fri, 06 Sep 2019 08:19:37 +0200
Subject: [R-pkg-devel] GSL update on CRAN
Message-ID: <web-5884323@be2.uni-freiburg.de>


Hello,
 
I developed an R package that requires at least version 2.3 of GSL
(ftp://ftp.gnu.org/gnu/gsl/). The newest version is 2.6.
 
Version 2.3 is now available for over two years, and I was wondering
whether it was possible to update GSL on the win-builder? I would
really appreciate it. Without it my package will be rejected on CRAN.
 
Or is there an option to include the whole GSL library in the package?
 
On my machines (two debian based and one Windows server 16 and one
Windows 10) the package passes the checks of "R CMD check --as-cran".
On builder.r-hub.io with Windows server 12 it is also successful.

I would be glad for any advice / suggestions / hints. 

 
Best wishes
Raphael


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Fri Sep  6 11:21:09 2019
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Fri, 6 Sep 2019 11:21:09 +0200
Subject: [R-pkg-devel] set pkg_config for 3rd party software
In-Reply-To: <23921.14707.897708.406983@stat.math.ethz.ch>
References: <D115402E-21CE-44EE-B867-E6902833A459@kaust.edu.sa>
 <23920.58085.22252.888537@stat.math.ethz.ch>
 <CAFQwRQyumboUgjTbnjZfLJdGy6myviE_JxUKQneEtxDJ+Nut6A@mail.gmail.com>
 <23921.9805.109819.530726@rob.eddelbuettel.com>
 <23921.14707.897708.406983@stat.math.ethz.ch>
Message-ID: <23922.9477.419060.189183@stat.math.ethz.ch>

>>>>> Martin Maechler 
>>>>>     on Thu, 5 Sep 2019 18:36:03 +0200 writes:

>>>>> Dirk Eddelbuettel 
>>>>>     on Thu, 5 Sep 2019 10:14:21 -0500 writes:

    >> On 5 September 2019 at 16:53, Ralf Stubner wrote:
    >> | I don't know what is best, but here are three alternatives:
    >> | 
    >> | * Use PKG_CHECK_MODULES which sets up default variables with _CFLAGS
    >> | and _LIBS suffix after searching for a library with pkg-config, c.f.
    >> | https://autotools.io/pkgconfig/pkg_check_modules.html
    >> | * Call pkg-config by hand in configure.ac (and hence configure).
    >> | Example: https://github.com/eddelbuettel/rcppredis/blob/master/configure.ac#L47-L60
    >> | * Call pkg-config within an "Anticonf" configure script. Example:
    >> | https://github.com/jeroen/curl/blob/master/configure#L16-L24

    >> Make it four alternatives:

    >> * Call pkg-config from an autoconf configure script.  Examples:

    >> edd at rob:~$ grep -l pkg-config git/*/configure.{ac,in}
    >> git/libxls/configure.ac
    >> git/nloptr/configure.ac
    >> git/rcppmlpack2/configure.ac
    >> git/rcppredis/configure.ac
    >> git/rprotobuf/configure.ac
    >> edd at rob:~$

    >> I know all the cool kids these days hate autoconf, but it a) really is just
    >> careful (and more portable) shell scripting (plus some extra glue).  And it
    >> b) avoids having users on some marginal OSs yell at you when they do not have
    >> bash (just yesterday a Nix user had to comment on a five year old bug in that
    >> is no longer valid as we went back to autoconf there too).  As an extra bonus
    >> it c) also works on Slowlaris.

    >> Best, Dirk

    > Thank you, Ralf, and Dirk.... that was very useful already !

    > However, the real problem I am fighting still is not related to
    > `pkg-config` and friends at all, but to the fact that my OS has
    > a version of libmpfr in the main system library and that seems
    > to be used in *any* case when the final <pkg>.so file is linked
    > together:

    > For me (on Fedora 30)

    > $ R CMD config LDFLAGS
    > -L/usr/lib64

    > $ ls -l /usr/lib64/libmpfr*
    > lrwxrwxrwx. 1 root root     16 Feb  2  2019 /usr/lib64/libmpfr.so -> libmpfr.so.4.1.6
    > lrwxrwxrwx. 1 root root     16 Feb  2  2019 /usr/lib64/libmpfr.so.4 -> libmpfr.so.4.1.6
    > -rwxr-xr-x. 1 root root 827872 Feb  2  2019 /usr/lib64/libmpfr.so.4.1.6

    > and for that reason, when         R CMD INSTALL Rmpfr ...

    > gets to the final linking, it uses

    > gcc -shared -L/usr/lib64 -o Rmpfr.so Ops.o .... utils.o -L/usr/local.../mpfr/4.0.2/lib -lmpfr -lgmp

    > and the early -L/usr/lib64  just "ensures" that my package lib
    > (Rmpfr.so) is linked against  /usr/lib64/libmpfr.so.4.1.6  which
    > is old and I "hate" rather than against the much better
    > libmpfr.so.6.0.2 which would be found in /usr/local.../mpfr/4.0.2/lib

    > Yes, on a machine with root permission I can hack around to get
    > what I want,  but of course I'd really like   'R CMD INSTALL ..'
    > to do the "right thing"
    > just from my  configure  plus src/Makevars{.in}  files.
    > Yes, I tried  'LDFLAGS = ' (to set it to "empty") in
    > src/Makevars*  but that did not help either.

    > Martin

I now finally did what most of us should do before posting here:
Carefully consulting the famous WRE "Writing R Extensions" R
Manual, notably the section ('1.2.1' currently),
named "Using Makevars" :
   https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Using-Makevars

and came to the conclusion that at least for now,
I have to revert to using a 'src/Makefile' instead of just
Makevars files, the main reason being that  R's own
<R>/etc/Makevars  file is included *after* the package src/Makevars
file  and so it does not help if I (un)set LDFLAGS in the latter.

Thank you for listening - it helped me to get to a more systematic
answer (and if you find that my conclusion has been wrong, I'm
happy to hear about that).

Martin


From r@||@@tubner @end|ng |rom gm@||@com  Fri Sep  6 11:22:15 2019
From: r@||@@tubner @end|ng |rom gm@||@com (Ralf Stubner)
Date: Fri, 6 Sep 2019 11:22:15 +0200
Subject: [R-pkg-devel] set pkg_config for 3rd party software
In-Reply-To: <23921.14707.897708.406983@stat.math.ethz.ch>
References: <D115402E-21CE-44EE-B867-E6902833A459@kaust.edu.sa>
 <23920.58085.22252.888537@stat.math.ethz.ch>
 <CAFQwRQyumboUgjTbnjZfLJdGy6myviE_JxUKQneEtxDJ+Nut6A@mail.gmail.com>
 <23921.9805.109819.530726@rob.eddelbuettel.com>
 <23921.14707.897708.406983@stat.math.ethz.ch>
Message-ID: <CAFQwRQxHfY5wKNcx7AU=rsbokps7ahS3E09a8JchAKNtzKZ1sA@mail.gmail.com>

On Thu, Sep 5, 2019 at 6:36 PM Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
> For me (on Fedora 30)
>
>   $ R CMD config LDFLAGS
>   -L/usr/lib64

This looks wrong. I would expect that /usr/lib64 is one of the
standard directories that are searched anyway. So why put it into the
very beginning of the search? BTW, this does not happen on Debian:

$ R CMD config LDFLAGS
-Wl,-z,relro

> Yes, on a machine with root permission I can hack around to get
> what I want,  but of course I'd really like   'R CMD INSTALL ..'
> to do the "right thing"
> just from my  configure  plus src/Makevars{.in}  files.
> Yes, I tried  'LDFLAGS = ' (to set it to "empty") in
> src/Makevars*  but that did not help either.

I see no way to correct this within a package. The only thing that
comes to mind is adding a test in `configure{.ac}` that will fail when
a to old version of libmpfr is actually used for linking. If the test
fails, one can at least give an informative message. Then either an
admin corrects the configuration or the user overwrites LDFLAS in
~/.R/Makevars.

cheerio
ralf


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Fri Sep  6 12:17:39 2019
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Fri, 6 Sep 2019 12:17:39 +0200
Subject: [R-pkg-devel] set pkg_config for 3rd party software
In-Reply-To: <CAFQwRQxHfY5wKNcx7AU=rsbokps7ahS3E09a8JchAKNtzKZ1sA@mail.gmail.com>
References: <D115402E-21CE-44EE-B867-E6902833A459@kaust.edu.sa>
 <23920.58085.22252.888537@stat.math.ethz.ch>
 <CAFQwRQyumboUgjTbnjZfLJdGy6myviE_JxUKQneEtxDJ+Nut6A@mail.gmail.com>
 <23921.9805.109819.530726@rob.eddelbuettel.com>
 <23921.14707.897708.406983@stat.math.ethz.ch>
 <CAFQwRQxHfY5wKNcx7AU=rsbokps7ahS3E09a8JchAKNtzKZ1sA@mail.gmail.com>
Message-ID: <23922.12867.291891.581126@stat.math.ethz.ch>

>>>>> Ralf Stubner 
>>>>>     on Fri, 6 Sep 2019 11:22:15 +0200 writes:

    > On Thu, Sep 5, 2019 at 6:36 PM Martin Maechler
    > <maechler at stat.math.ethz.ch> wrote:
    >> For me (on Fedora 30)
    >> 
    >> $ R CMD config LDFLAGS
    >> -L/usr/lib64

    > This looks wrong. I would expect that /usr/lib64 is one of the
    > standard directories that are searched anyway. So why put it into the
    > very beginning of the search? BTW, this does not happen on Debian:

    > $ R CMD config LDFLAGS
    > -Wl,-z,relro

Thank you very much, Ralf!
Indeed my conclusion was wrong .. If I use Fedora's own R package,
then I also get something like the above :

 $ /usr/bin/R CMD config LDFLAGS
-Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld

(amazingly long ..)

It's just when I -- as in 99.9% of cases, as an R Core developer --
use my own built version of R, I get what you call "wrong".

... and it's  "of course" from my  ~/.R/config  settings
where added a comment for this explicit LDFLAGS setting, mentioning that
otherwise it would take -L/usr/local/lib64 and that *is*
unfortunately still true:

In current R incl R-devel's  <Rsource>/configure.ac  (lines 157-167)
LDFLAGS *is* set to this :
--------------------------------------------------------------------
: ${LIBnn=$libnn}
## We provide these defaults so that headers and libraries in
## '/usr/local' are found (by the native tools, mostly).
if test -f "/sw/etc/fink.conf"; then
  : ${CPPFLAGS="-I/sw/include -I/usr/local/include"}
  : ${LDFLAGS="-L/sw/lib -L/usr/local/lib"}
else
  : ${CPPFLAGS="-I/usr/local/include"}
  : ${LDFLAGS="-L/usr/local/${LIBnn}"}
fi
AC_SUBST(LIBnn)
--------------------------------------------------------------------

and that setting *did* harm me in the (relatively distant, ~ 7 years?)
past, and so I had replaced it with the  /usr/lib64  setting.

Hmm, maybe this should all have been on the  R-devel  mailing
list instead, and we should start asking if R's  configure.ac
(and hence configure) should be changed ?

Martin


From boennecd @end|ng |rom gm@||@com  Fri Sep  6 13:46:29 2019
From: boennecd @end|ng |rom gm@||@com (Benjamin Christoffersen)
Date: Fri, 6 Sep 2019 13:46:29 +0200
Subject: [R-pkg-devel] 
 Single character in Fortran function and FCONE and FCLEN macros
In-Reply-To: <a4de759c-e807-786d-b700-d8cd6e90ef84@gmail.com>
References: <CAHHSL8voEM87rYG_iK4Mknxe9Oh6_5zwUXRPgfJOJVkiEVpVjA@mail.gmail.com>
 <a4de759c-e807-786d-b700-d8cd6e90ef84@gmail.com>
Message-ID: <CAHHSL8tNWey-sOONGzVqrtwy--ECweYmjG18oejq099HSn1CXg@mail.gmail.com>

> I'd try following WRE on this exactly: include R_ext/BLAS.h and only after that define FCONE (if not defined) - and FCLEN if you need it as well.
That is an embarrassing error. I will try to do exactly as is written in WRE.

> I'd try debugging this with gcc -E, checking whether the FCLEN and FCONE macros work as intended. If the build process of the package seemed too complicated for that, you could also look at the disassembly for the calls, or compile with -fdump-tree-all  and look at the gfortran/gcc diagnostic files to see if the calls include the hidden 1s.
Thanks mentioning these options.

Best regards,
Benjamin


Den tir. 3. sep. 2019 kl. 15.37 skrev Tomas Kalibera <tomas.kalibera at gmail.com>:
>
> On 9/3/19 3:07 PM, Benjamin Christoffersen wrote:
>
> Dear Sirs,
>
> I have tried to update my 'dynamichazard' package on CRAN but I have
> had some issues with the '-Wlto-type-mismatch' checks. In particular,
> I have tried to follow "Writing R Extensions" section "Fortran
> character strings" and defined a C++ header file
> (https://github.com/boennecd/dynamichazard/blob/460fe74cadad5c029c4f0ffb50074139135c2166/src/Rconfig-wrap.h)
> with the following content
>
> #ifndef RCONFIG_WRAP_H
> #define RCONFIG_WRAP_H
> #define USE_FC_LEN_T
> #include <Rconfig.h>
>
> #ifndef FCLEN
> #define FCLEN
> #endif
> #ifndef FCONE
> #define FCONE
> #endif
>
> #endif
>
> I'd try following WRE on this exactly: include R_ext/BLAS.h and only after that define FCONE (if not defined) - and FCLEN if you need it as well.
>
> which I include before including 'R_ext/BLAS.h' and 'R_ext/Lapack.h'
> files. I then make the following C declaration of the Fortran
> subroutine that causes the issue
> (https://github.com/boennecd/dynamichazard/blob/460fe74cadad5c029c4f0ffb50074139135c2166/src/BLAS_LAPACK/R_BLAS_LAPACK.cpp#L2-L29)
>
> extern "C"
>   {
>     void F77_NAME(dchur)(
>         const char*,   // UPLO
>         const char*,   // TRANS
>         int*,    // N
>         int*,    // M
>         double*, // R
>         int*,    // LDR
>         double*, // X
>         double*, // Z
>         int*,    // LDZ
>         double*, // Y
>         double*, // RHO
>         double*, // C
>         double*, // S
>         int*     // INFO,
>         FCLEN FCLEN
>     );
>   }
>
> Lastly, I use the 'FCONE' macro when calling the function. The Fortran
> subroutine (a LINPACK subroutine) is defined in this file:
> https://github.com/boennecd/dynamichazard/blob/460fe74cadad5c029c4f0ffb50074139135c2166/src/BLAS_LAPACK/dchur.f#L7
>
> I gather the above is as done in the BLAS and LAPACK header in R. Yet,
> I still got a mail in the CRAN submission stating that
>
> We see
>
> * checking whether package ?dynamichazard? can be installed ...
> [207s/211s] WARNING
> Found the following significant warnings:
>    BLAS_LAPACK/R_BLAS_LAPACK.cpp:12:10: warning: type of ?dchur_? does
> not match original declaration [-Wlto-type-mismatch]
>
> and there's also
>
> BLAS_LAPACK/R_BLAS_LAPACK.cpp:12:10: warning: type of ?dchur_? does not
> match original declaration [-Wlto-type-mismatch]
>     12 |     void F77_NAME(dchur)(
>        |          ^
> BLAS_LAPACK/dchur.f:7:1: note: type mismatch in parameter 15
>      7 |       SUBROUTINE DCHUR(UPLO,TRANS,N,M,R,LDR,X,Z,LDZ,Y,RHO,C,S,INFO)
>        | ^
> BLAS_LAPACK/dchur.f:7:1: note: type ?long int? should match type ?void?
> BLAS_LAPACK/dchur.f:7:1: note: ?dchur? was previously declared here
>
> I am not sure how to handle the issue. I am sorry if I am doing
> something which is obviously wrong.
>
> I'd try debugging this with gcc -E, checking whether the FCLEN and FCONE macros work as intended. If the build process of the package seemed too complicated for that, you could also look at the disassembly for the calls, or compile with -fdump-tree-all  and look at the gfortran/gcc diagnostic files to see if the calls include the hidden 1s. The output seems to suggest that the macros have not been defined properly.
>
> I also got some messages about the declarations in RcppArmadillo but I
> gather these are upstream issues which I cannot do anything about
>
> /home/Hornik/tmp/R-d-gcc-LTO/include/R_ext/Lapack.h:1584:1: warning: ?dtrtri_? violates the C++ One Definition Rule [-Wodr]
>  1584 | F77_NAME(dtrtri)(const char* uplo, const char* diag,
>       | ^
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:421:8: note: type mismatch in parameter 7
>   421 |   void arma_fortran(arma_dtrtri)(const char* uplo, const char* diag, const blas_int* n, double* a, const blas_int* lda, blas_int* info, blas_len uplo_len, blas_len diag_len);
>       |        ^
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:421:8: note: type ?blas_len? should match type ?void?
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:421:8: note: ?dtrtri_? was previously declared here
> /home/Hornik/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:242:1: warning: ?dsyrk_? violates the C++ One Definition Rule [-Wodr]
>   242 | F77_NAME(dsyrk)(const char *uplo, const char *trans,
>       | ^
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_blas.hpp:110:8: note: type mismatch in parameter 11
>   110 |   void arma_fortran(arma_dsyrk)(const char* uplo, const char* transA, const blas_int* n, const blas_int* k, const double* alpha, const double* > A, const blas_int* ldA, const double* beta, double* C, const blas_int* ldC, blas_len uplo_len, blas_len transA_len);
>       |        ^
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_blas.hpp:110:8: note: type ?blas_len? should match type ?void?
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_blas.hpp:110:8: note: ?dsyrk_? was previously declared here
> /home/Hornik/tmp/R-d-gcc-LTO/include/R_ext/Lapack.h:825:1: warning: ?dpotrf_? violates the C++ One Definition Rule [-Wodr]
>   825 | F77_NAME(dpotrf)(const char* uplo, const int* n,
>       | ^
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:467:8: note: type mismatch in parameter 6
>   467 |   void arma_fortran(arma_dpotrf)(const char* uplo, const blas_int* n, double* a, const blas_int* lda, blas_int* info, blas_len uplo_len);
>       |        ^
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:467:8: note: type ?blas_len? should match type ?void?
> /home/Hornik/lib/R/Library/3.7/x86_64-linux-gnu/RcppArmadillo/include/armadillo_bits/def_lapack.hpp:467:8: note: ?dpotrf_? was previously declared here
> installing to /home/Hornik/tmp/CRAN/dynamichazard.Rcheck/00LOCK-dynamichazard/00new/dynamichazard/libs
>
> Yes, that seems to be an upstream problem.
>
> Best
> Tomas
>
> Sincerely Yours,
> Benjamin Christoffersen
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>


From edd @end|ng |rom deb|@n@org  Fri Sep  6 14:19:15 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Fri, 6 Sep 2019 07:19:15 -0500
Subject: [R-pkg-devel] set pkg_config for 3rd party software
In-Reply-To: <23922.12867.291891.581126@stat.math.ethz.ch>
References: <D115402E-21CE-44EE-B867-E6902833A459@kaust.edu.sa>
 <23920.58085.22252.888537@stat.math.ethz.ch>
 <CAFQwRQyumboUgjTbnjZfLJdGy6myviE_JxUKQneEtxDJ+Nut6A@mail.gmail.com>
 <23921.9805.109819.530726@rob.eddelbuettel.com>
 <23921.14707.897708.406983@stat.math.ethz.ch>
 <CAFQwRQxHfY5wKNcx7AU=rsbokps7ahS3E09a8JchAKNtzKZ1sA@mail.gmail.com>
 <23922.12867.291891.581126@stat.math.ethz.ch>
Message-ID: <23922.20163.250330.53556@rob.eddelbuettel.com>


Martin,

And not to beat a dead horse, but isn't the root cause the outdated rpm?

So can't you replace / update that package?  That's what I do over in the
.deb world, and for Ubuntu it is particularly easy with PPAs.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd @end|ng |rom deb|@n@org  Fri Sep  6 16:00:51 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Fri, 6 Sep 2019 09:00:51 -0500
Subject: [R-pkg-devel] set pkg_config for 3rd party software
In-Reply-To: <23922.20163.250330.53556@rob.eddelbuettel.com>
References: <D115402E-21CE-44EE-B867-E6902833A459@kaust.edu.sa>
 <23920.58085.22252.888537@stat.math.ethz.ch>
 <CAFQwRQyumboUgjTbnjZfLJdGy6myviE_JxUKQneEtxDJ+Nut6A@mail.gmail.com>
 <23921.9805.109819.530726@rob.eddelbuettel.com>
 <23921.14707.897708.406983@stat.math.ethz.ch>
 <CAFQwRQxHfY5wKNcx7AU=rsbokps7ahS3E09a8JchAKNtzKZ1sA@mail.gmail.com>
 <23922.12867.291891.581126@stat.math.ethz.ch>
 <23922.20163.250330.53556@rob.eddelbuettel.com>
Message-ID: <23922.26259.151261.148685@rob.eddelbuettel.com>


Martin,

On 6 September 2019 at 07:19, Dirk Eddelbuettel wrote:
| So can't you replace / update that package?  That's what I do over in the
| .deb world, and for Ubuntu it is particularly easy with PPAs.

And then there is of course this too:

  edd at rob:~$ pkg-config --modversion nlopt
  2.4.2
  edd at rob:~$ pkg-config --modversion quantlib
  1.16
  edd at rob:~$

so eg in QuantLib (which uses its own quantlib-config from going back to the
days before we had pkg-config) I test for minimally-viable versions, and only
if pkg-config reveals and insufficient version do I check explicit configure
options to supply a library dir and include dir.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From d@v|dhughjone@ @end|ng |rom gm@||@com  Sat Sep  7 15:48:39 2019
From: d@v|dhughjone@ @end|ng |rom gm@||@com (David Hugh-Jones)
Date: Sat, 7 Sep 2019 14:48:39 +0100
Subject: [R-pkg-devel] meta-question
Message-ID: <CAARY7kjj5p+vcJ4-6WEc9P3ja77m3mYGgyzAYkp1wNHpr7s9WA@mail.gmail.com>

Hi all,

A meta-question: I am developing a new package (
https://github.com/hughjonesd/santoku) and I would like to ask some
questions. But they are not about e.g. R CMD check or CRAN submission -
instead they're more abstract questions of software design. Is this the
right place to ask?

Cheers,
David

	[[alternative HTML version deleted]]


From Georg|n@@Ander@on @end|ng |rom phe@gov@uk  Sat Sep  7 10:36:04 2019
From: Georg|n@@Ander@on @end|ng |rom phe@gov@uk (Georgina Anderson)
Date: Sat, 7 Sep 2019 08:36:04 +0000
Subject: [R-pkg-devel] OFFICIAL: R-devel check error: package or NAMESPACE
 load failed, there is no package called broom
Message-ID: <69068DC5C231C74CA3D8CBAFCEFAF062F2C02A76@MAILMBXCOL02.phe.gov.uk>

OFFICIAL

Hi

Any help with the following update to my package PHEindicatormethods would be appreciated.

I have made a very minor change to the package to fix dependencies on the tidyr:nest() function as tidyr v 1.0.0 is due to be released with breaking changes on 9th September.
The version I am trying to upload to CRAN is 1.1.5 available here: https://github.com/PublicHealthEngland/PHEindicatormethods


When I run devtools::check_win_devel locally (Windows 10 laptop, R 3.6.1, rStudio 1.2.1335) it passes with no NOTES, ERRORS or WARNINGS (locally it also passes devtools::check_win on release and oldrelease and devtools::check_rhub)

When I submit to CRAN I have been notified that package PHEindicatormethods_1.1.5.tar.gz does not pass the incoming checks automatically, signposting failing pre-tests on Windows:

* using R Under development (unstable) (2019-09-02 r77130)

* using platform: x86_64-w64-mingw32 (64-bit)

* using session charset: ISO8859-1



This is the log file available for 7 days: https://win-builder.r-project.org/incoming_pretest/PHEindicatormethods_1.1.5_20190905_224346/Windows/00check.log

Below are two sections from the log that show the errors:


> library('PHEindicatormethods')

Error: package or namespace load failed for 'PHEindicatormethods' in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):

 there is no package called 'broom'

Execution halted

** running examples for arch 'x64' ... ERROR

Running examples in 'PHEindicatormethods-Ex.R' failed

The error occurred in:

R Under development (unstable) (2019-09-02 r77130) -- "Unsuffered Consequences"

Copyright (C) 2019 The R Foundation for Statistical Computing

Platform: x86_64-w64-mingw32/x64 (64-bit)


Error: processing vignette 'WorkedExamples_phe_sii.Rmd' failed with diagnostics:

package or namespace load failed for 'PHEindicatormethods' in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):

 there is no package called 'broom'

--- failed re-building 'WorkedExamples_phe_sii.Rmd'

SUMMARY: processing the following file failed:

  'WorkedExamples_phe_sii.Rmd'

Error: Vignette re-building failed.

Execution halted

I have checked the broom package and its upstream dependency on generics - I notice the tidy() function was moved from broom to generics a while back but this was before I submitted the current version (1.1.3) of my package to CRAN so not sure this can be the problem, although one of my functions does reference broom::tidy().  The evidence seems to point to changes in R-devel causing something in my package to break but without being able to reproduce the errors seen by CRAN I'm finding it difficult to pinpoint the problem.

Thanks
Georgie


**************************************************************************
The information contained in the EMail and any attachments is confidential and intended solely and for the attention and use of the named addressee(s). It may not be disclosed to any other person without the express authority of Public Health England, or the intended recipient, or both. If you are not the intended recipient, you must not disclose, copy, distribute or retain this message or any part of it. This footnote also confirms that this EMail has been swept for computer viruses by Symantec.Cloud, but please re-sweep any attachments before opening or saving. http://www.gov.uk/PHE
**************************************************************************
	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Sep  7 23:36:19 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 07 Sep 2019 14:36:19 -0700
Subject: [R-pkg-devel] meta-question
In-Reply-To: <CAARY7kjj5p+vcJ4-6WEc9P3ja77m3mYGgyzAYkp1wNHpr7s9WA@mail.gmail.com>
References: <CAARY7kjj5p+vcJ4-6WEc9P3ja77m3mYGgyzAYkp1wNHpr7s9WA@mail.gmail.com>
Message-ID: <CD12AB0F-0845-45A1-96D7-DB4D07036BA6@dcn.davis.ca.us>

I don't think this list is only for questions about submitting to CRAN, but it is specific to writing packages for R. If your question could just as
easily apply to another language then you probably ought to ask elsewhere.

Perhaps https://softwareengineering.stackexchange.com/help/on-topic ?

On September 7, 2019 6:48:39 AM PDT, David Hugh-Jones <davidhughjones at gmail.com> wrote:
>Hi all,
>
>A meta-question: I am developing a new package (
>https://github.com/hughjonesd/santoku) and I would like to ask some
>questions. But they are not about e.g. R CMD check or CRAN submission -
>instead they're more abstract questions of software design. Is this the
>right place to ask?
>
>Cheers,
>David
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From bnj|@ngece @end|ng |rom gm@||@com  Sun Sep  8 00:21:03 2019
From: bnj|@ngece @end|ng |rom gm@||@com (Bingnan Jiang)
Date: Sat, 7 Sep 2019 16:21:03 -0600
Subject: [R-pkg-devel] Package submission check error in "r-devel Windows
 ix86+x86_6" related to rJava
Message-ID: <CAGhNFiHJPxNNS146WGpiibqRQiU2q9yA+giawotiy+B-W6irPQ@mail.gmail.com>

Hello,

When I tried to submit a new version of package "RSCAT", an error happened
during the installation check in the environment "r-devel Windows
ix86+x86_6". It looks like all existing CRAN packages that depend on or
import "rJava" have the same issue on "r-devel Windows ix86+x86_6" (
https://cran.r-project.org/web/checks/check_summary_by_package.html#summary_by_package).
The error message is as follows:

Error: package or namespace load failed for 'rJava':
 .onLoad failed in loadNamespace() for 'rJava', details:
  call: inDL(x, as.logical(local), as.logical(now), ...)
  error: unable to load shared object
'd:/RCompile/CRANpkg/lib/3.7/rJava/libs/i386/rJava.dll':
  LoadLibrary failure:  %1 ist keine zul?ssige Win32-Anwendung.

The CRAN check passed on my local Win10 PC with r-devel. Could someone help
me to solve this problem? Or is it an issue of "r-devel Windows
ix86+x86_6". Thank you very much.

Regards,
Bingnan

	[[alternative HTML version deleted]]


From @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@  Sun Sep  8 12:04:02 2019
From: @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@ (Sameh M. Abdulah)
Date: Sun, 8 Sep 2019 10:04:02 +0000
Subject: [R-pkg-devel] Linking with OpenBLAS complains lapacke not found
Message-ID: <35CFF3BA962CA3B8.C8A91331-9DB0-4E5F-8D6B-C616A59CC434@mail.outlook.com>

I am linking my package against openblas but it complains that lapacke is not found which I need for the installation.

I have another alternative to linking against MKL but I cannot find it using MKLROOT variable on CRAN servers.


?Sameh

Get Outlook for iOS<https://aka.ms/o0ukef>

	[[alternative HTML version deleted]]


From br|@n @end|ng |rom br@verock@com  Sun Sep  8 13:28:38 2019
From: br|@n @end|ng |rom br@verock@com (Brian G. Peterson)
Date: Sun, 08 Sep 2019 06:28:38 -0500
Subject: [R-pkg-devel] Linking with OpenBLAS complains lapacke not found
In-Reply-To: <35CFF3BA962CA3B8.C8A91331-9DB0-4E5F-8D6B-C616A59CC434@mail.outlook.com>
References: <35CFF3BA962CA3B8.C8A91331-9DB0-4E5F-8D6B-C616A59CC434@mail.outlook.com>
Message-ID: <d896151832a83798dacfe05a5353b5b4b22e9587.camel@braverock.com>

On Sun, 2019-09-08 at 10:04 +0000, Sameh M. Abdulah wrote:
> I am linking my package against openblas but it complains that
> lapacke is not found which I need for the installation.
> 
> I have another alternative to linking against MKL but I cannot find
> it using MKLROOT variable on CRAN servers.

It isn't entirely clear what your question is, but shouldn't you just
be linking to the BLAS and leave the choice of BLAS to the individual
installation?  In most cases you should probably not be statically
linking to the BLAS.

Here is an old paper by Dirk with more information that might help you
sort it out.

https://cran.r-project.org/web/packages/gcbd/vignettes/gcbd.pdf

Regards,

Brian

-- 
Brian G. Peterson
ph: +1.773.459.4973
im: bgpbraverock


From @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@  Sun Sep  8 14:22:09 2019
From: @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@ (Sameh M. Abdulah)
Date: Sun, 8 Sep 2019 12:22:09 +0000
Subject: [R-pkg-devel] Linking with OpenBLAS complains lapacke not found
In-Reply-To: <d896151832a83798dacfe05a5353b5b4b22e9587.camel@braverock.com>
References: <35CFF3BA962CA3B8.C8A91331-9DB0-4E5F-8D6B-C616A59CC434@mail.outlook.com>
 <d896151832a83798dacfe05a5353b5b4b22e9587.camel@braverock.com>
Message-ID: <4D75F933-7501-47A1-A5DC-95872E21D3E6@kaust.edu.sa>

Brian,

This is the code I am using to linking with BLAS using MKL or OpenBLAS

#MKL
if [ -n "$MKLROOT" ] && [ -d "$MKLROOT" ]; then
    echo "mkl_dir directory exists!"
    echo "Great... continue set-up"
    source ${MKLROOT}/bin/mklvars.sh intel64
    DEFINE_BLAS_LIBS_CMAKE="-DBLAS_LIBRARIES='-L${MKLROOT}/lib -Wl,-rpath,${MKLROOT}/lib -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lpthread -lm -ldl'"
    #DEFINE_BLAS_LIBS_CMAKE="-DBLAS_LIBRARIES='-L${MKLROOT}/lib\ -Wl,-rpath,${MKLROOT}/lib\ -lmkl_intel_lp64\ -lmkl_sequential\ -lmkl_core\ -lpthread\ -lm\ -ldl'"
    XFLAG="-DBLA_VENDOR=Intel"
else
    echo "MKL not found, trying to compile and use OpenBLAS"
    XFLAG="-DBLA_VENDOR=Open"
    USE_OPENBLAS='true'
fi

# openblas
if [ "true" == "$USE_OPENBLAS" ]
then
    if pkg-config --exists openblas
    then
        _LOCATION=`pkg-config --variable=libdir openblas`
        echo "OpenBLAS FOUND in [$_LOCATION]"
    else
        if [ "$BUILD_DEPENDENCIES" == "true" ]
        then
            echo "Building OpenBLAS..."
            cd $TMPDIR
            wget https://github.com/xianyi/OpenBLAS/archive/v0.3.3.tar.gz -O - | tar -zx
            cd OpenBLAS-0.3.3
            $MAKE -j  >/dev/null|| $MAKE || { echo 'OpenBLAS installation failed' ; exit 1; }
            $MAKE install PREFIX=$PREFIX
            export CPATH=$CPATH:$PREFIX/include
        else
            echo "####################"
            echo "OpenBLAS NOT FOUND"
            echo "Please download it from: https://github.com/xianyi/OpenBLAS/releases"
            echo "After installing it, set the proper PKG_CONFIG_PATH variable"
            echo ""
            err=1
        fi
    fi
fi


It works great but when OpenBLAS is using, my application cannot find lapacke library.



?On 9/8/19, 2:28 PM, "Brian G. Peterson" <brian at braverock.com> wrote:

    On Sun, 2019-09-08 at 10:04 +0000, Sameh M. Abdulah wrote:
    > I am linking my package against openblas but it complains that
    > lapacke is not found which I need for the installation.
    > 
    > I have another alternative to linking against MKL but I cannot find
    > it using MKLROOT variable on CRAN servers.
    
    It isn't entirely clear what your question is, but shouldn't you just
    be linking to the BLAS and leave the choice of BLAS to the individual
    installation?  In most cases you should probably not be statically
    linking to the BLAS.
    
    Here is an old paper by Dirk with more information that might help you
    sort it out.
    
    https://cran.r-project.org/web/packages/gcbd/vignettes/gcbd.pdf
    
    Regards,
    
    Brian
    
    -- 
    Brian G. Peterson
    ph: +1.773.459.4973
    im: bgpbraverock
    
    


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Mon Sep  9 09:56:32 2019
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Mon, 9 Sep 2019 09:56:32 +0200
Subject: [R-pkg-devel] Linking with OpenBLAS complains lapacke not found
In-Reply-To: <4D75F933-7501-47A1-A5DC-95872E21D3E6@kaust.edu.sa>
References: <35CFF3BA962CA3B8.C8A91331-9DB0-4E5F-8D6B-C616A59CC434@mail.outlook.com>
 <d896151832a83798dacfe05a5353b5b4b22e9587.camel@braverock.com>
 <4D75F933-7501-47A1-A5DC-95872E21D3E6@kaust.edu.sa>
Message-ID: <09ab1f99-69f4-906e-2bcb-3ff8dcf935d8@gmail.com>

Please refer to BLAS_LIBS, LAPACK_LIBS in Writing R Extensions. For an 
example package that uses BLAS/LAPACK, see e.g. "stats" or "Matrix". The 
package will then use the BLAS/LAPACK implementation as chosen by the 
user/system administrator at dynamic linking time (see R Installation 
and Administration Manual for the defailts) - be it say reference BLAS, 
OpenBLAS, MKL or other; as a package author, one does not have to care 
which one it is.

Best
Tomas

On 9/8/19 2:22 PM, Sameh M. Abdulah wrote:
> Brian,
>
> This is the code I am using to linking with BLAS using MKL or OpenBLAS
>
> #MKL
> if [ -n "$MKLROOT" ] && [ -d "$MKLROOT" ]; then
>      echo "mkl_dir directory exists!"
>      echo "Great... continue set-up"
>      source ${MKLROOT}/bin/mklvars.sh intel64
>      DEFINE_BLAS_LIBS_CMAKE="-DBLAS_LIBRARIES='-L${MKLROOT}/lib -Wl,-rpath,${MKLROOT}/lib -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lpthread -lm -ldl'"
>      #DEFINE_BLAS_LIBS_CMAKE="-DBLAS_LIBRARIES='-L${MKLROOT}/lib\ -Wl,-rpath,${MKLROOT}/lib\ -lmkl_intel_lp64\ -lmkl_sequential\ -lmkl_core\ -lpthread\ -lm\ -ldl'"
>      XFLAG="-DBLA_VENDOR=Intel"
> else
>      echo "MKL not found, trying to compile and use OpenBLAS"
>      XFLAG="-DBLA_VENDOR=Open"
>      USE_OPENBLAS='true'
> fi
>
> # openblas
> if [ "true" == "$USE_OPENBLAS" ]
> then
>      if pkg-config --exists openblas
>      then
>          _LOCATION=`pkg-config --variable=libdir openblas`
>          echo "OpenBLAS FOUND in [$_LOCATION]"
>      else
>          if [ "$BUILD_DEPENDENCIES" == "true" ]
>          then
>              echo "Building OpenBLAS..."
>              cd $TMPDIR
>              wget https://github.com/xianyi/OpenBLAS/archive/v0.3.3.tar.gz -O - | tar -zx
>              cd OpenBLAS-0.3.3
>              $MAKE -j  >/dev/null|| $MAKE || { echo 'OpenBLAS installation failed' ; exit 1; }
>              $MAKE install PREFIX=$PREFIX
>              export CPATH=$CPATH:$PREFIX/include
>          else
>              echo "####################"
>              echo "OpenBLAS NOT FOUND"
>              echo "Please download it from: https://github.com/xianyi/OpenBLAS/releases"
>              echo "After installing it, set the proper PKG_CONFIG_PATH variable"
>              echo ""
>              err=1
>          fi
>      fi
> fi
>
>
> It works great but when OpenBLAS is using, my application cannot find lapacke library.
>
>
>
> ?On 9/8/19, 2:28 PM, "Brian G. Peterson" <brian at braverock.com> wrote:
>
>      On Sun, 2019-09-08 at 10:04 +0000, Sameh M. Abdulah wrote:
>      > I am linking my package against openblas but it complains that
>      > lapacke is not found which I need for the installation.
>      >
>      > I have another alternative to linking against MKL but I cannot find
>      > it using MKLROOT variable on CRAN servers.
>      
>      It isn't entirely clear what your question is, but shouldn't you just
>      be linking to the BLAS and leave the choice of BLAS to the individual
>      installation?  In most cases you should probably not be statically
>      linking to the BLAS.
>      
>      Here is an old paper by Dirk with more information that might help you
>      sort it out.
>      
>      https://cran.r-project.org/web/packages/gcbd/vignettes/gcbd.pdf
>      
>      Regards,
>      
>      Brian
>      
>      --
>      Brian G. Peterson
>      ph: +1.773.459.4973
>      im: bgpbraverock
>      
>      
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From |jh988488 @end|ng |rom gm@||@com  Mon Sep  9 12:53:38 2019
From: |jh988488 @end|ng |rom gm@||@com (Juhee Lee)
Date: Mon, 9 Sep 2019 19:53:38 +0900
Subject: [R-pkg-devel] Add reference in Description
Message-ID: <CACSCokehko9V2EsSwVpb_fXqmn2CAwhhRG+ha15hcPfAQBNymg@mail.gmail.com>

Hello, I submitted my package to CRAN and received this mail.


On 03.09.2019 23:33, CRAN submission wrote:
> [This was generated from CRAN.R-project.org/submit.html
<http://cran.r-project.org/submit.html>]
>
> The following package was uploaded to CRAN:
> ===========================================
>
> Package Information:
> Package: LARisk
> Version: 0.1.1
> Title: Estimate of Lifetime Attributable Cancer Risk
> Author(s): Young-Min Kim [aut, cre], YeongWoo Park [aut], Jinkyoung Yoo
> [aut], Taesung Shin [aut], DeokKi An [aut], Juhee Lee [aut],
> YuJeong An [aut], Songwon Seo [ctb], WonJin Lee [ctb], EunShil
> Cha [ctb], Seulki Ko [ctb], KyoungAe Kong [ctb]
> Maintainer: Young-Min Kim
> Suggests: R.rsp
> Description: The 'LARisk' to compute lifetime attributable risk of
> radiation-induced cancer reveals that it can be helpful with
> enhancement of the flexibility in research with fast
> calculation and various options.

Thanks, if there are references describing the (theoretical background
of) methods in your package, please add these in the Description field
of your DESCRIPTION file in the form
authors (year)
authors (year)
authors (year, ISBN:...)
with no space after 'doi:', 'arXiv:' and angle brackets for auto-linking.


So I added it in the Description field of my DESCRIPTION file like this:

Description: The 'LARisk' to compute lifetime attributable risk of
    radiation-induced cancer reveals that it can be helpful with
    enhancement of the flexibility in research with fast calculation
    and various options. Important reference papers include
    Berrington de Gonzalez A, et al.(2012) <DOI:10.1088/0952-4746/32/3/205>,
    National Research Council(2006, ISBN:978-0-309-09156-5).



But, I've gotten the reply like below.


Dear maintainer,

package LARisk_0.1.1.tar.gz has been auto-processed and is pending a manual
inspection. A CRAN team member will typically respond to you within the
next 5 working days. For technical reasons you may receive a second copy of
this message when a team member triggers a new check.

Log dir:
The files will be removed after roughly 7 days.
Installation time in seconds: 19
Check time in seconds: 111
R Under development (unstable) (2019-09-02 r77130)

Pretests results:
Windows:
Status: 1 NOTE
Debian:
Status: 1 NOTE



No strong reverse dependencies to be checked.

Best regards,
CRAN teams' auto-check service

------------------------------

Flavor: r-devel-windows-ix86+x86_64
Check: CRAN incoming feasibility, Result: NOTE
Maintainer: 'Young-Min Kim '

New submission

Possibly mis-spelled words in DESCRIPTION:
Berrington (32:5)
al (32:34)
de (32:16)

Flavor: r-devel-linux-x86_64-debian-gcc
Check: CRAN incoming feasibility, Result: NOTE
Maintainer: 'Young-Min Kim '

New submission

Possibly mis-spelled words in DESCRIPTION:
Berrington (32:5)
al (32:34)
de (32:16)

Found the following (possibly) invalid DOIs:
DOI: 10.1088/0952-4746/32/3/205
From: DESCRIPTION
Status: Forbidden
Message: 403


How do I modify it?


Best regards,

Juhee Lee.

	[[alternative HTML version deleted]]


From he|mut@@chuetz @end|ng |rom beb@c@@t  Mon Sep  9 14:54:36 2019
From: he|mut@@chuetz @end|ng |rom beb@c@@t (=?UTF-8?Q?Helmut_Sch=c3=bctz?=)
Date: Mon, 9 Sep 2019 14:54:36 +0200
Subject: [R-pkg-devel] Add reference in Description
In-Reply-To: <CACSCokehko9V2EsSwVpb_fXqmn2CAwhhRG+ha15hcPfAQBNymg@mail.gmail.com>
References: <CACSCokehko9V2EsSwVpb_fXqmn2CAwhhRG+ha15hcPfAQBNymg@mail.gmail.com>
Message-ID: <2a407670-879c-4e24-280d-cb007518b475@bebac.at>

Hi Juhee,

Juhee Lee wrote on 2019-09-09 12:53:
> [?] please add these in the Description field
> So I added it in the Description field of my DESCRIPTION file like this:
>
> Description: [?]
>      Berrington de Gonzalez A, et al.(2012) <DOI:10.1088/0952-4746/32/3/205>,
>      National Research Council(2006, ISBN:978-0-309-09156-5).

I would use <doi:...> instead of <DOI:...>
Interesting that CRAN started requesting references a while ago.
Note that /nothing/ about it is stated in the 'R-Extensions Manual'.

> But, I've gotten the reply like below.
>
>
> Possibly mis-spelled words in DESCRIPTION:
> Berrington (32:5)

Happens all the time, esp. with names. Sometimes words are common in 
your particular
field but unknown to the spell-checker.
It seems that the spell-checker learns or is less strict in later 
submissions.
Nothing to worry about.

> Found the following (possibly) invalid DOIs:
> DOI: 10.1088/0952-4746/32/3/205
> From: DESCRIPTION
> Status: Forbidden
> Message: 403

Strange. Generally you get that only if the document is behind a 
pay-wall and not
even the abstract can be accessed. I could access it.
Sometimes an entire site is down for maintenance (as Springer was ~ two 
weeks ago).
Then one gets an HTTP 404.

> How do I modify it?

You can't. Be patient. As stated in the note, wait for a member of CRAN 
to check that.
Wetware outperforms silicon-based lifeforms.

Cheers,
Helmut

-- 
Ing. Helmut Sch?tz
BEBAC?? Consultancy Services for
Bioequivalence and Bioavailability Studies
Neubaugasse 36/11
1070 Vienna, Austria
W https://bebac.at/
F https://forum.bebac.at/


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon Sep  9 15:13:13 2019
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 9 Sep 2019 15:13:13 +0200
Subject: [R-pkg-devel] Add reference in Description
In-Reply-To: <2a407670-879c-4e24-280d-cb007518b475@bebac.at>
References: <CACSCokehko9V2EsSwVpb_fXqmn2CAwhhRG+ha15hcPfAQBNymg@mail.gmail.com>
 <2a407670-879c-4e24-280d-cb007518b475@bebac.at>
Message-ID: <af68fd49-3375-8499-7236-5da926756f56@statistik.tu-dortmund.de>



On 09.09.2019 14:54, Helmut Sch?tz wrote:
> Hi Juhee,
> 
> Juhee Lee wrote on 2019-09-09 12:53:
>> [?] please add these in the Description field
>> So I added it in the Description field of my DESCRIPTION file like this:
>>
>> Description: [?]
>> ???? Berrington de Gonzalez A, et al.(2012) 
>> <DOI:10.1088/0952-4746/32/3/205>,
>> ???? National Research Council(2006, ISBN:978-0-309-09156-5).
> 
> I would use <doi:...> instead of <DOI:...>
> Interesting that CRAN started requesting references a while ago.
> Note that /nothing/ about it is stated in the 'R-Extensions Manual'.
> 
>> But, I've gotten the reply like below.
>>
>>
>> Possibly mis-spelled words in DESCRIPTION:
>> Berrington (32:5)
> 
> Happens all the time, esp. with names. Sometimes words are common in 
> your particular
> field but unknown to the spell-checker.
> It seems that the spell-checker learns or is less strict in later 
> submissions.
> Nothing to worry about.
> 
>> Found the following (possibly) invalid DOIs:
>> DOI: 10.1088/0952-4746/32/3/205
>> From: DESCRIPTION
>> Status: Forbidden
>> Message: 403
> 
> Strange. Generally you get that only if the document is behind a 
> pay-wall and not
> even the abstract can be accessed. I could access it.
> Sometimes an entire site is down for maintenance (as Springer was ~ two 
> weeks ago).
> Then one gets an HTTP 404.

All true, just le to me add: CRAN sends many requests to these sites a 
day, hence they may reject CRAN traffic, which you can simply ignore.


Best,
Uwe Ligges



>> How do I modify it?
> 
> You can't. Be patient. As stated in the note, wait for a member of CRAN 
> to check that.
> Wetware outperforms silicon-based lifeforms.
> 
> Cheers,
> Helmut
>


From @ndre@v||@r@|v@rez @end|ng |rom hotm@||@com  Mon Sep  9 16:47:42 2019
From: @ndre@v||@r@|v@rez @end|ng |rom hotm@||@com (Andrea Vilar Alvarez)
Date: Mon, 9 Sep 2019 14:47:42 +0000
Subject: [R-pkg-devel] Problems installing dependences of my package
Message-ID: <AM6PR04MB600849D420CCD65FC9EC8E99C5B70@AM6PR04MB6008.eurprd04.prod.outlook.com>



Hi,

I am writting because I am doing a package in R and I have some problems installing dependences which appear at DESCRIPTION file.

First of all, I am not sure about the difference between Depends and Imports, but I only use Depends.
My problem is that my package is going to be used at different computers and for different persons so I want that when other person use my package, it can be able to check  if the necesary packages are installed and if they are not installed, the package must be able to install  them.
I supposed that this problem was solved including the necesary packages and their versions at ?Depends?. And now, I have another problem because the versions are usually indicated using ?>=?, for example: forecast (>=8.7) but I need to use exactly the versi?n 8.7 because sometimes when packages are updated, they lost some functions. But if I use <= or == and the package is update to versi?n 8.8, my package installation fail.
How can I solve this? If I use R normaly (outside my package), I can install older versions of other packages using devtools::install_version() so why when I indicate  forecast (<=8.7) at Depends on the DESCRIPTION file, R is not able to install an older version if a new one is avaliable?

Thanks in advance for your attention.

Best regards,

Andrea.


	[[alternative HTML version deleted]]


From |uc@r @end|ng |rom |edor@project@org  Mon Sep  9 19:17:36 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Mon, 9 Sep 2019 19:17:36 +0200
Subject: [R-pkg-devel] Problems installing dependences of my package
In-Reply-To: <AM6PR04MB600849D420CCD65FC9EC8E99C5B70@AM6PR04MB6008.eurprd04.prod.outlook.com>
References: <AM6PR04MB600849D420CCD65FC9EC8E99C5B70@AM6PR04MB6008.eurprd04.prod.outlook.com>
Message-ID: <CALEXWq34x3E428pKrt8xWdqtxeTamUFyy4AXDpN6s=HKzVv54Q@mail.gmail.com>

On Mon, 9 Sep 2019 at 16:58, Andrea Vilar Alvarez
<andreavilaralvarez at hotmail.com> wrote:
>
> First of all, I am not sure about the difference between Depends and Imports, but I only use Depends.

Common advice goes the other way around: you should avoid Depends as
much as possible, so that your users' search path doesn't get polluted
with all your dependencies. Rule of thumb: "Depends: pkg1" is like you
are executing "library(pkg1)" in your users' session. You should avoid
that unless it's strictly necessary.

It's important to invest some time to truly understand the difference
between Imports and Depends. Some references:

- https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Package-Dependencies
- http://r-pkgs.had.co.nz/description.html

> My problem is that my package is going to be used at different computers and for different persons so I want that when other person use my package, it can be able to check  if the necesary packages are installed and if they are not installed, the package must be able to install  them.

That's the whole point of declaring dependencies, and that's how
install.packages() works: I install your package and R figures out
what's needed and installs it for me.

> I supposed that this problem was solved including the necesary packages and their versions at ?Depends?.

As noted above, preferably Imports. But yes, that's correct.

> And now, I have another problem because the versions are usually indicated using ?>=?, for example: forecast (>=8.7) but I need to use exactly the versi?n 8.7 because sometimes when packages are updated, they lost some functions. But if I use <= or == and the package is update to versi?n 8.8, my package installation fail.
> How can I solve this? If I use R normaly (outside my package), I can install older versions of other packages using devtools::install_version() so why when I indicate  forecast (<=8.7) at Depends on the DESCRIPTION file, R is not able to install an older version if a new one is avaliable?

That's another story. R does not support exact versioning. You have
several options to achieve this though [1, 2, 3, 4]. But if you want
to submit your package to CRAN with exact versioning, unfortunately
that's not gonna work; but there are good reasons for that.

[1] https://cran.r-project.org/package=versions
[2] https://cran.r-project.org/package=checkpoint
[3] https://cran.r-project.org/package=rbundler
[4] https://cran.r-project.org/package=packrat

I?aki


From ||@t@ @end|ng |rom dewey@myzen@co@uk  Mon Sep  9 19:24:42 2019
From: ||@t@ @end|ng |rom dewey@myzen@co@uk (Michael Dewey)
Date: Mon, 9 Sep 2019 18:24:42 +0100
Subject: [R-pkg-devel] Problems installing dependences of my package
In-Reply-To: <AM6PR04MB600849D420CCD65FC9EC8E99C5B70@AM6PR04MB6008.eurprd04.prod.outlook.com>
References: <AM6PR04MB600849D420CCD65FC9EC8E99C5B70@AM6PR04MB6008.eurprd04.prod.outlook.com>
Message-ID: <0a908190-5119-1add-57f9-8329b307ff13@dewey.myzen.co.uk>

Dear Andrea

Comments in-line

On 09/09/2019 15:47, Andrea Vilar Alvarez wrote:
> 
> 
> Hi,
> 
> I am writting because I am doing a package in R and I have some problems installing dependences which appear at DESCRIPTION file.
> 
> First of all, I am not sure about the difference between Depends and Imports, but I only use Depends.
> My problem is that my package is going to be used at different computers and for different persons so I want that when other person use my package, it can be able to check  if the necesary packages are installed and if they are not installed, the package must be able to install  them.

If I understand you correctly that is what install.packages() does for 
your users.

> I supposed that this problem was solved including the necesary packages and their versions at ?Depends?. And now, I have another problem because the versions are usually indicated using ?>=?, for example: forecast (>=8.7) but I need to use exactly the versi?n 8.7 because sometimes when packages are updated, they lost some functions. But if I use <= or == and the package is update to versi?n 8.8, my package installation fail.

As I read the manual. you can specify both and upper and lower bound. It 
is at the bottom of page 9 in the pdf I am reading.

> How can I solve this? If I use R normaly (outside my package), I can install older versions of other packages using devtools::install_version() so why when I indicate  forecast (<=8.7) at Depends on the DESCRIPTION file, R is not able to install an older version if a new one is avaliable?
> 
> Thanks in advance for your attention.
> 
> Best regards,
> 
> Andrea.
> 
> 
> 	[[alternative HTML version deleted]]

Please do not do that as it mangles your post. Please set your mailer o 
post in plain text not HTML

> 
> 
> 
> ---
> This email has been checked for viruses by AVG.
> https://www.avg.com
> 
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 

-- 
Michael
http://www.dewey.myzen.co.uk/home.html


From wdun|@p @end|ng |rom t|bco@com  Mon Sep  9 20:33:53 2019
From: wdun|@p @end|ng |rom t|bco@com (William Dunlap)
Date: Mon, 9 Sep 2019 11:33:53 -0700
Subject: [R-pkg-devel] Problems installing dependences of my package
In-Reply-To: <AM6PR04MB600849D420CCD65FC9EC8E99C5B70@AM6PR04MB6008.eurprd04.prod.outlook.com>
References: <AM6PR04MB600849D420CCD65FC9EC8E99C5B70@AM6PR04MB6008.eurprd04.prod.outlook.com>
Message-ID: <CAF8bMca+0q2JEWP7auU86qs22_yMZ1wvcbwBe3YY=5n+aw632g@mail.gmail.com>

> And now, I have another problem because the versions are usually
indicated using ?>=?, for example:
> forecast (>=8.7) but I need to use exactly the versi?n 8.7 because
sometimes when packages are updated,
> they lost some functions. But if I use <= or == and the package is update
to versi?n 8.8, my package installation fail.

In my experience, it is rare that version<= is required.  What function in
in forecast-8.7 was dropped in -8.8?
I didn't see any, but perhaps I missed something.

Bill Dunlap
TIBCO Software
wdunlap tibco.com


On Mon, Sep 9, 2019 at 7:58 AM Andrea Vilar Alvarez <
andreavilaralvarez at hotmail.com> wrote:

>
>
> Hi,
>
> I am writting because I am doing a package in R and I have some problems
> installing dependences which appear at DESCRIPTION file.
>
> First of all, I am not sure about the difference between Depends and
> Imports, but I only use Depends.
> My problem is that my package is going to be used at different computers
> and for different persons so I want that when other person use my package,
> it can be able to check  if the necesary packages are installed and if they
> are not installed, the package must be able to install  them.
> I supposed that this problem was solved including the necesary packages
> and their versions at ?Depends?. And now, I have another problem because
> the versions are usually indicated using ?>=?, for example: forecast
> (>=8.7) but I need to use exactly the versi?n 8.7 because sometimes when
> packages are updated, they lost some functions. But if I use <= or == and
> the package is update to versi?n 8.8, my package installation fail.
> How can I solve this? If I use R normaly (outside my package), I can
> install older versions of other packages using devtools::install_version()
> so why when I indicate  forecast (<=8.7) at Depends on the DESCRIPTION
> file, R is not able to install an older version if a new one is avaliable?
>
> Thanks in advance for your attention.
>
> Best regards,
>
> Andrea.
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From tr@ver@c @end|ng |rom gm@||@com  Mon Sep  9 20:40:55 2019
From: tr@ver@c @end|ng |rom gm@||@com (Travers Ching)
Date: Mon, 9 Sep 2019 11:40:55 -0700
Subject: [R-pkg-devel] Problems installing dependences of my package
In-Reply-To: <AM6PR04MB600849D420CCD65FC9EC8E99C5B70@AM6PR04MB6008.eurprd04.prod.outlook.com>
References: <AM6PR04MB600849D420CCD65FC9EC8E99C5B70@AM6PR04MB6008.eurprd04.prod.outlook.com>
Message-ID: <CAPLMX9Gf9uF_GhOUhBR1-Z34ScKwOTqiXz+1Fn9+QhFKd5GcBw@mail.gmail.com>

Hi Andrea,

If your code is highly dependent on a specific version, another option is
to include their code directly in your package.  The forecast package is
under GPL-3 license, meaning you can use their code.  You would just need
include the authors as a contributor ([ctb] tag) and make note of it in the
relevant source code files and the Copyright field in the description.

Travers

On Mon, Sep 9, 2019 at 7:57 AM Andrea Vilar Alvarez <
andreavilaralvarez at hotmail.com> wrote:

>
>
> Hi,
>
> I am writting because I am doing a package in R and I have some problems
> installing dependences which appear at DESCRIPTION file.
>
> First of all, I am not sure about the difference between Depends and
> Imports, but I only use Depends.
> My problem is that my package is going to be used at different computers
> and for different persons so I want that when other person use my package,
> it can be able to check  if the necesary packages are installed and if they
> are not installed, the package must be able to install  them.
> I supposed that this problem was solved including the necesary packages
> and their versions at ?Depends?. And now, I have another problem because
> the versions are usually indicated using ?>=?, for example: forecast
> (>=8.7) but I need to use exactly the versi?n 8.7 because sometimes when
> packages are updated, they lost some functions. But if I use <= or == and
> the package is update to versi?n 8.8, my package installation fail.
> How can I solve this? If I use R normaly (outside my package), I can
> install older versions of other packages using devtools::install_version()
> so why when I indicate  forecast (<=8.7) at Depends on the DESCRIPTION
> file, R is not able to install an older version if a new one is avaliable?
>
> Thanks in advance for your attention.
>
> Best regards,
>
> Andrea.
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From |jh988488 @end|ng |rom gm@||@com  Tue Sep 10 07:27:54 2019
From: |jh988488 @end|ng |rom gm@||@com (Juhee Lee)
Date: Tue, 10 Sep 2019 14:27:54 +0900
Subject: [R-pkg-devel] Add reference in Description
In-Reply-To: <af68fd49-3375-8499-7236-5da926756f56@statistik.tu-dortmund.de>
References: <CACSCokehko9V2EsSwVpb_fXqmn2CAwhhRG+ha15hcPfAQBNymg@mail.gmail.com>
 <2a407670-879c-4e24-280d-cb007518b475@bebac.at>
 <af68fd49-3375-8499-7236-5da926756f56@statistik.tu-dortmund.de>
Message-ID: <CACSCokfVGvtUtHreQoOim9reCPVmAtMs3k_6-2+Hm=EzRhg-4w@mail.gmail.com>

Hi.

Thank you for your reply. The question was solved.

I received another message from CRAN.
I think I can modify it.


Thank you,
Juhee Lee

2019? 9? 9? (?) ?? 10:13, Uwe Ligges <ligges at statistik.tu-dortmund.de>?? ??:

>
>
> On 09.09.2019 14:54, Helmut Sch?tz wrote:
> > Hi Juhee,
> >
> > Juhee Lee wrote on 2019-09-09 12:53:
> >> [?] please add these in the Description field
> >> So I added it in the Description field of my DESCRIPTION file like this:
> >>
> >> Description: [?]
> >>      Berrington de Gonzalez A, et al.(2012)
> >> <DOI:10.1088/0952-4746/32/3/205>,
> >>      National Research Council(2006, ISBN:978-0-309-09156-5).
> >
> > I would use <doi:...> instead of <DOI:...>
> > Interesting that CRAN started requesting references a while ago.
> > Note that /nothing/ about it is stated in the 'R-Extensions Manual'.
> >
> >> But, I've gotten the reply like below.
> >>
> >>
> >> Possibly mis-spelled words in DESCRIPTION:
> >> Berrington (32:5)
> >
> > Happens all the time, esp. with names. Sometimes words are common in
> > your particular
> > field but unknown to the spell-checker.
> > It seems that the spell-checker learns or is less strict in later
> > submissions.
> > Nothing to worry about.
> >
> >> Found the following (possibly) invalid DOIs:
> >> DOI: 10.1088/0952-4746/32/3/205
> >> From: DESCRIPTION
> >> Status: Forbidden
> >> Message: 403
> >
> > Strange. Generally you get that only if the document is behind a
> > pay-wall and not
> > even the abstract can be accessed. I could access it.
> > Sometimes an entire site is down for maintenance (as Springer was ~ two
> > weeks ago).
> > Then one gets an HTTP 404.
>
> All true, just le to me add: CRAN sends many requests to these sites a
> day, hence they may reject CRAN traffic, which you can simply ignore.
>
>
> Best,
> Uwe Ligges
>
>
>
> >> How do I modify it?
> >
> > You can't. Be patient. As stated in the note, wait for a member of CRAN
> > to check that.
> > Wetware outperforms silicon-based lifeforms.
> >
> > Cheers,
> > Helmut
> >
>

	[[alternative HTML version deleted]]


From @ndre@v||@r@|v@rez @end|ng |rom hotm@||@com  Tue Sep 10 09:02:34 2019
From: @ndre@v||@r@|v@rez @end|ng |rom hotm@||@com (Andrea Vilar Alvarez)
Date: Tue, 10 Sep 2019 07:02:34 +0000
Subject: [R-pkg-devel] Problems installing dependences of my package
In-Reply-To: <CAPLMX9Gf9uF_GhOUhBR1-Z34ScKwOTqiXz+1Fn9+QhFKd5GcBw@mail.gmail.com>
References: <AM6PR04MB600849D420CCD65FC9EC8E99C5B70@AM6PR04MB6008.eurprd04.prod.outlook.com>,
 <CAPLMX9Gf9uF_GhOUhBR1-Z34ScKwOTqiXz+1Fn9+QhFKd5GcBw@mail.gmail.com>
Message-ID: <AM6PR04MB6008312B598F0AA6A1B91720C5B60@AM6PR04MB6008.eurprd04.prod.outlook.com>



First of all I am so grateful for your advices and I am sorry for writting the previous email using HTML instead of plain text. 
I give forecast package as an example because is one of the packages that a I need in my package, but the truly problem was months ago using FIAR package because the condGranger() function was removed when it was updated and my package needed this function. Anyway the problem was solved and now I decided that the best option is use checkpoint() as I?aki recomended. 
 

Thank you so much again.

Andrea.

 
?



De: Travers Ching <traversc at gmail.com>

Enviado: Monday, September 9, 2019 8:40:55 PM

Para: Andrea Vilar Alvarez <andreavilaralvarez at hotmail.com>

CC: r-package-devel at r-project.org <r-package-devel at r-project.org>

Asunto: Re: [R-pkg-devel] Problems installing dependences of my package

?




Hi Andrea,



If your code is highly dependent on a specific version, another option is to include their code directly in your package.? The forecast package is under GPL-3 license, meaning you can use their code.? You would just need include the authors as a contributor
 ([ctb] tag) and make note of it in the relevant source code files and the Copyright field in the description.?






Travers






On Mon, Sep 9, 2019 at 7:57 AM Andrea Vilar Alvarez <andreavilaralvarez at hotmail.com> wrote:







Hi,



I am writting because I am doing a package in R and I have some problems installing dependences which appear at DESCRIPTION file.



First of all, I am not sure about the difference between Depends and Imports, but I only use Depends.

My problem is that my package is going to be used at different computers and for different persons so I want that when other person use my package, it can be able to check? if the necesary packages are installed and if they are not installed, the package must
 be able to install? them.

I supposed that this problem was solved including the necesary packages and their versions at ?Depends?. And now, I have another problem because the versions are usually indicated using ?>=?, for example: forecast (>=8.7) but I need to use exactly the versi?n
 8.7 because sometimes when packages are updated, they lost some functions. But if I use <= or == and the package is update to versi?n 8.8, my package installation fail.

How can I solve this? If I use R normaly (outside my package), I can install older versions of other packages using devtools::install_version() so why when I indicate? forecast (<=8.7) at Depends on the DESCRIPTION file, R is not able to install an older version
 if a new one is avaliable?



Thanks in advance for your attention.



Best regards,



Andrea.





? ? ? ? [[alternative HTML version deleted]]



______________________________________________

R-package-devel at r-project.org mailing list

https://stat.ethz.ch/mailman/listinfo/r-package-devel



From h@w|ckh@m @end|ng |rom gm@||@com  Tue Sep 10 14:15:47 2019
From: h@w|ckh@m @end|ng |rom gm@||@com (Hadley Wickham)
Date: Tue, 10 Sep 2019 07:15:47 -0500
Subject: [R-pkg-devel] 
 OFFICIAL: R-devel check error: package or NAMESPACE
 load failed, there is no package called broom
In-Reply-To: <69068DC5C231C74CA3D8CBAFCEFAF062F2C02A76@MAILMBXCOL02.phe.gov.uk>
References: <69068DC5C231C74CA3D8CBAFCEFAF062F2C02A76@MAILMBXCOL02.phe.gov.uk>
Message-ID: <CABdHhvHvOyVJ6ncJJMa-wubG9RnjHfU7wb8kOWDHEruJyzyZkQ@mail.gmail.com>

This works for me locally too, so I'd recommend trying win-devel
again. Sometimes you catch it in an inconsistent state and your check
fails for reasons unrelated to your package.

Hadley

On Sat, Sep 7, 2019 at 3:50 PM Georgina Anderson
<Georgina.Anderson at phe.gov.uk> wrote:
>
> OFFICIAL
>
> Hi
>
> Any help with the following update to my package PHEindicatormethods would be appreciated.
>
> I have made a very minor change to the package to fix dependencies on the tidyr:nest() function as tidyr v 1.0.0 is due to be released with breaking changes on 9th September.
> The version I am trying to upload to CRAN is 1.1.5 available here: https://github.com/PublicHealthEngland/PHEindicatormethods
>
>
> When I run devtools::check_win_devel locally (Windows 10 laptop, R 3.6.1, rStudio 1.2.1335) it passes with no NOTES, ERRORS or WARNINGS (locally it also passes devtools::check_win on release and oldrelease and devtools::check_rhub)
>
> When I submit to CRAN I have been notified that package PHEindicatormethods_1.1.5.tar.gz does not pass the incoming checks automatically, signposting failing pre-tests on Windows:
>
> * using R Under development (unstable) (2019-09-02 r77130)
>
> * using platform: x86_64-w64-mingw32 (64-bit)
>
> * using session charset: ISO8859-1
>
>
>
> This is the log file available for 7 days: https://win-builder.r-project.org/incoming_pretest/PHEindicatormethods_1.1.5_20190905_224346/Windows/00check.log
>
> Below are two sections from the log that show the errors:
>
>
> > library('PHEindicatormethods')
>
> Error: package or namespace load failed for 'PHEindicatormethods' in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
>
>  there is no package called 'broom'
>
> Execution halted
>
> ** running examples for arch 'x64' ... ERROR
>
> Running examples in 'PHEindicatormethods-Ex.R' failed
>
> The error occurred in:
>
> R Under development (unstable) (2019-09-02 r77130) -- "Unsuffered Consequences"
>
> Copyright (C) 2019 The R Foundation for Statistical Computing
>
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
>
> Error: processing vignette 'WorkedExamples_phe_sii.Rmd' failed with diagnostics:
>
> package or namespace load failed for 'PHEindicatormethods' in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
>
>  there is no package called 'broom'
>
> --- failed re-building 'WorkedExamples_phe_sii.Rmd'
>
> SUMMARY: processing the following file failed:
>
>   'WorkedExamples_phe_sii.Rmd'
>
> Error: Vignette re-building failed.
>
> Execution halted
>
> I have checked the broom package and its upstream dependency on generics - I notice the tidy() function was moved from broom to generics a while back but this was before I submitted the current version (1.1.3) of my package to CRAN so not sure this can be the problem, although one of my functions does reference broom::tidy().  The evidence seems to point to changes in R-devel causing something in my package to break but without being able to reproduce the errors seen by CRAN I'm finding it difficult to pinpoint the problem.
>
> Thanks
> Georgie
>
>
> **************************************************************************
> The information contained in the EMail and any attachments is confidential and intended solely and for the attention and use of the named addressee(s). It may not be disclosed to any other person without the express authority of Public Health England, or the intended recipient, or both. If you are not the intended recipient, you must not disclose, copy, distribute or retain this message or any part of it. This footnote also confirms that this EMail has been swept for computer viruses by Symantec.Cloud, but please re-sweep any attachments before opening or saving. http://www.gov.uk/PHE
> **************************************************************************
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
http://hadley.nz


From pedro@@ph@|o @end|ng |rom he|@|nk|@||  Tue Sep 10 16:39:05 2019
From: pedro@@ph@|o @end|ng |rom he|@|nk|@|| (Aphalo, Pedro J)
Date: Tue, 10 Sep 2019 14:39:05 +0000
Subject: [R-pkg-devel] 
 OFFICIAL: R-devel check error: package or NAMESPACE
 load failed, there is no package called broom
In-Reply-To: <CABdHhvHvOyVJ6ncJJMa-wubG9RnjHfU7wb8kOWDHEruJyzyZkQ@mail.gmail.com>
References: <69068DC5C231C74CA3D8CBAFCEFAF062F2C02A76@MAILMBXCOL02.phe.gov.uk>
 <CABdHhvHvOyVJ6ncJJMa-wubG9RnjHfU7wb8kOWDHEruJyzyZkQ@mail.gmail.com>
Message-ID: <HE1PR0701MB2492DCBDF4AB0798A036EF9895B60@HE1PR0701MB2492.eurprd07.prod.outlook.com>

It seems that 'broom' itself is failing tests on CRAN under Windows oldrel, and this may cause it to be missing from the R installation running tests on CRAN.

See:
https://cran.r-project.org/web/checks/check_results_broom.html

Pedro.

--

Pedro J. Aphalo
University Lecturer, Principal Investigator
Organismal and Evolutionary Biology (OEB) Research Programme
University of Helsinki
Finland


> -----Original Message-----
> From: R-package-devel <r-package-devel-bounces at r-project.org> On Behalf Of
> Hadley Wickham
> Sent: 10 September 2019 15:16
> To: Georgina Anderson <Georgina.Anderson at phe.gov.uk>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] OFFICIAL: R-devel check error: package or
> NAMESPACE load failed, there is no package called broom
> 
> This works for me locally too, so I'd recommend trying win-devel again.
> Sometimes you catch it in an inconsistent state and your check fails for reasons
> unrelated to your package.
> 
> Hadley
> 
> On Sat, Sep 7, 2019 at 3:50 PM Georgina Anderson
> <Georgina.Anderson at phe.gov.uk> wrote:
> >
> > OFFICIAL
> >
> > Hi
> >
> > Any help with the following update to my package PHEindicatormethods
> would be appreciated.
> >
> > I have made a very minor change to the package to fix dependencies on the
> tidyr:nest() function as tidyr v 1.0.0 is due to be released with breaking changes
> on 9th September.
> > The version I am trying to upload to CRAN is 1.1.5 available here:
> > https://github.com/PublicHealthEngland/PHEindicatormethods
> >
> >
> > When I run devtools::check_win_devel locally (Windows 10 laptop, R
> > 3.6.1, rStudio 1.2.1335) it passes with no NOTES, ERRORS or WARNINGS
> > (locally it also passes devtools::check_win on release and oldrelease
> > and devtools::check_rhub)
> >
> > When I submit to CRAN I have been notified that package
> PHEindicatormethods_1.1.5.tar.gz does not pass the incoming checks
> automatically, signposting failing pre-tests on Windows:
> >
> > * using R Under development (unstable) (2019-09-02 r77130)
> >
> > * using platform: x86_64-w64-mingw32 (64-bit)
> >
> > * using session charset: ISO8859-1
> >
> >
> >
> > This is the log file available for 7 days:
> > https://win-builder.r-project.org/incoming_pretest/PHEindicatormethods
> > _1.1.5_20190905_224346/Windows/00check.log
> >
> > Below are two sections from the log that show the errors:
> >
> >
> > > library('PHEindicatormethods')
> >
> > Error: package or namespace load failed for 'PHEindicatormethods' in
> loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
> >
> >  there is no package called 'broom'
> >
> > Execution halted
> >
> > ** running examples for arch 'x64' ... ERROR
> >
> > Running examples in 'PHEindicatormethods-Ex.R' failed
> >
> > The error occurred in:
> >
> > R Under development (unstable) (2019-09-02 r77130) -- "Unsuffered
> Consequences"
> >
> > Copyright (C) 2019 The R Foundation for Statistical Computing
> >
> > Platform: x86_64-w64-mingw32/x64 (64-bit)
> >
> >
> > Error: processing vignette 'WorkedExamples_phe_sii.Rmd' failed with
> diagnostics:
> >
> > package or namespace load failed for 'PHEindicatormethods' in
> loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
> >
> >  there is no package called 'broom'
> >
> > --- failed re-building 'WorkedExamples_phe_sii.Rmd'
> >
> > SUMMARY: processing the following file failed:
> >
> >   'WorkedExamples_phe_sii.Rmd'
> >
> > Error: Vignette re-building failed.
> >
> > Execution halted
> >
> > I have checked the broom package and its upstream dependency on generics -
> I notice the tidy() function was moved from broom to generics a while back but
> this was before I submitted the current version (1.1.3) of my package to CRAN
> so not sure this can be the problem, although one of my functions does
> reference broom::tidy().  The evidence seems to point to changes in R-devel
> causing something in my package to break but without being able to reproduce
> the errors seen by CRAN I'm finding it difficult to pinpoint the problem.
> >
> > Thanks
> > Georgie
> >
> >
> >
> *****************************************************************
> *****
> > **** The information contained in the EMail and any attachments is
> > confidential and intended solely and for the attention and use of the
> > named addressee(s). It may not be disclosed to any other person
> > without the express authority of Public Health England, or the
> > intended recipient, or both. If you are not the intended recipient,
> > you must not disclose, copy, distribute or retain this message or any
> > part of it. This footnote also confirms that this EMail has been swept
> > for computer viruses by Symantec.Cloud, but please re-sweep any
> > attachments before opening or saving. http://www.gov.uk/PHE
> >
> *****************************************************************
> *********
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> 
> 
> --
> http://hadley.nz
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From goochm| @end|ng |rom gm@||@com  Tue Sep 10 19:32:29 2019
From: goochm| @end|ng |rom gm@||@com (Michael Gooch)
Date: Tue, 10 Sep 2019 13:32:29 -0400
Subject: [R-pkg-devel] question / concern regarding CRAN package policy
 regarding compiler warnings
Message-ID: <CAPkLnK7hKVLoNWtWbGz=jWpb66e9kuq-=C4xuTZ-xLWt3yY3qw@mail.gmail.com>

I was told to bring this issue to r-devel or r-package-devel. It appears to
me that package-devel is the more appropriate of the two for this issue.



referencing this RcppEigen issue:
https://github.com/RcppCore/RcppEigen/issues/74


I presume the line in the policy document: "Packages should not attempt to
disable compiler diagnostics, nor to remove other diagnostic information
such as symbols in shared objects." is what is driving this interpretation.
If there are other relevant policy lines I?m open to being disabused of my
errant understanding, but this one jumped out at me as a likely candidate
for what is driving this issue.

is their understanding of CRAN policy accurate? Would you really treat
wrapping directives so that they?re only used in appropriate circumstances
as if it were the equivalent to tampering with compiler diagnostics (such
as using a -Wno flag)?



to me this stance doesn't make very much sense, but I presume there had to
have been a lot of thought and reasoning put into this. I?d like to be
helped to understand this policy choice, as it applies to this specific
kind of issue (making sure that only supported preprocessor statements are
used as is generally viewed as appropriate when writing C / CXX code).



There is a difference between preventing the occurrence of an inappropriate
line of code (i.e. wrapping a pragma directive that some versions of a
compiler cannot understand or use and will issue complaints about in #if
conditionals that ensure the pragma will be understood by the compiler)
from being provided to the compiler / preprocessor / linker etc., and
merely silencing such a warning that the compiler would otherwise be
issuing (i.e. using a -Wno-warnings style flag to hide the complain, but
still leaving it fully visible in the source file, and thus not actually
addressing the error in syntax/usage for the particular compiler or
platform).



I do not think that that approach is equivalent to tampering with compiler
diagnostics, or suppressing a warning in the same way that using -Wno flags
would be, but i'm being told that CRAN will treat that as equivalent to
warning-silencing. Is this true? What is the justification for that stance?



It would seem to me that this policy choice results in bad programming
practices, such as leaving in preprocessor directives for platforms that
cannot understand them. In any other context, platform specific
preprocessor driven inclusion or exclusion of code to ensure that only
appropriate code is used for a given compiler or platform would likely not
be objected to, so why it be a problem in a case such as this?



Not providing a directive to the preprocessor when it is not appropriate
and not supported for either the platform or the compiler itself is not
tampering or disabling a diagnostic, it is making an appropriate choice so
as NOT to create an error in the code. It so happens that the compiler in
question can warn about the issue and proceed without preventing
compilation and functional use of the code, but the warning in this case is
still telling the developer that there is an inappropriate piece of code
present in the source, and that OUGHT to be something one can remedy by
detecting the compiler (and its version) and ensuring that only compilers
that support the directives are actually provided with those directives.
That doesn?t appear to be tampering, or a malicious/anti-social development
decision, that would seem to be an entirely appropriate and proper use of
the preprocessor.

Trying to silence the warning with a -Wno flag WOULD be doing that, but
wrapping the pragma in a conditional so that it only exists when it will
have a functional utility is not much different from having OS specific
implementation files optionally included or excluded from the source
dependent on the platform. It certainly WOULD have the net effect of the
warning no longer being issued, but that would be because the errant lines
are never provided to the preprocessor in the first place, which itself is
actually an error, and as such should NOT be the state of affairs that CRAN
policy demands.



it seems entirely backward from what one ought to expect the developer to
do.

If I am misguided in thinking that there is a difference between telling
the compiler to ignore/silence a warning, as opposed to preventing an
inappropriate line of code from being provided/used by the compiler in the
first place, please help me to understand, because I?m really having a hard
time seeing those as the same thing.



M. Gooch

	[[alternative HTML version deleted]]


From r@ph@e|@h@rtm@nn @end|ng |rom p@ycho|og|e@un|-|re|burg@de  Wed Sep 11 11:49:51 2019
From: r@ph@e|@h@rtm@nn @end|ng |rom p@ycho|og|e@un|-|re|burg@de (Raphael Hartmann)
Date: Wed, 11 Sep 2019 11:49:51 +0200
Subject: [R-pkg-devel] GSL update on CRAN
In-Reply-To: <web-5884323@be2.uni-freiburg.de>
References: <web-5884323@be2.uni-freiburg.de>
Message-ID: <web-5602499@be1.uni-freiburg.de>

Hi,

I hope you don't mind me asking again:
Does anybody have an idea on how to implement the whole GSL library in
my package? I was not able to find sth. on Google.

Whom should I contact for asking whether it is possible to update GSL
for Windows on CRAN? There were no warnings or errors in the CRAN
checks for debian. For Windows on CRAN, the compiler gives only an
error where a GSL routine of version 2.3 is used.

Best wishes
Raphael



On Fri, 06 Sep 2019 08:19:37 +0200
 "Raphael Hartmann" <raphael.hartmann at psychologie.uni-freiburg.de>
wrote:
>
>Hello,
> 
>I developed an R package that requires at least version 2.3 of GSL
>(ftp://ftp.gnu.org/gnu/gsl/). The newest version is 2.6.
> 
>Version 2.3 is now available for over two years, and I was wondering
>whether it was possible to update GSL on the win-builder? I would
>really appreciate it. Without it my package will be rejected on CRAN.
> 
>Or is there an option to include the whole GSL library in the package?
> 
>On my machines (two debian based and one Windows server 16 and one
>Windows 10) the package passes the checks of "R CMD check --as-cran".
>On builder.r-hub.io with Windows server 12 it is also successful.
>
>I would be glad for any advice / suggestions / hints. 
>
> 
>Best wishes
>Raphael
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

--------------------------------------------------------------
Albert-Ludwigs-Universit?t Freiburg
Institute of Psychology, Cognition, Action, and Sustainability
Engelbergerstrasse 41
D-79085 Freiburg
Phone: +49 761 203 2465


From gor@n@bro@trom @end|ng |rom umu@@e  Wed Sep 11 13:36:40 2019
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Wed, 11 Sep 2019 13:36:40 +0200
Subject: [R-pkg-devel] R, BLAS, and FCLEN
In-Reply-To: <2d39dac4-0094-374e-d2d2-2cc12773835d@umu.se>
References: <aa335279-734d-6ac8-e957-5070768201c5@umu.se>
 <2d39dac4-0094-374e-d2d2-2cc12773835d@umu.se>
Message-ID: <8a0ca051-46dd-ba3c-4359-f7305b5e13ca@umu.se>

A followup question: Is it possible to call a BLAS/LAPACK subroutine, 
where one parameter is character, from FORTRAN (77) code called by 
.Fortran? (No problem "in the past".)

And if yes, how?  Documentation describes calls from C to Fortran and 
vice versa, but not this situation (AFAICS).

Yes, I know that .Fortran is not well seen these days, but my fortran 
code is ancient, from the before-R era, and I would like to leave it as-is.

G,

Den 2019-09-01 kl. 21:46, skrev G?ran Brostr?m:
> 
> 
> On 2019-08-31 18:47, G?ran Brostr?m wrote:
>> I'm having difficulties updating my package eha: When I run standard 
>> checks 'at home' everything is fine, but 'CRAN-submissions' reports 
>> (among other things):
>>
>> geomsup.f:324:9: warning: type of ?dgemv? does not match original 
>> declaration [-Wlto-type-mismatch]
>> ?? 324 |????? &???? one, score, ione)
>> ?????? |???????? ^
>> /home/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:107:1: note: type mismatch 
>> in parameter 12
>> ?? 107 | F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>> ?????? | ^
>>
>> This is odd since the LAPACK subroutine dgemv takes only 11 
>> parameters. However, in include/R_ext/BLAS.h we have
>>
>> F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>> ???????? const double *alpha, const double *a, const int *lda,
>> ???????? const double *x, const int *incx, const double *beta,
>> ???????? double *y, const int *incy FCLEN);
>>
>> with a 12th parameter FCLEN?? How am I supposed to fix this, and what 
>> the ... is FCLEN? googling leads to nothing useful (for me). It seems 
>> as if R is redefining some standard LAPACK routines.
>>
>> Also a note I do not understand (in this context):
>>
>> note: type ?void? should match type ?long int?
>>
>> Any help is much appreciated.
>>
>> Best, G?ran
>>
>> PS. How can I trigger these Warnings 'at home'?
> 
> See https://www.stats.ox.ac.uk/pub/bdr/LTO/README.txt (thanks to Uwe 
> Ligges).
> 
> Another relevant document seems to be (2019-05-15):
> 
> https://developer.r-project.org/Blog/public/2019/05/15/gfortran-issues-with-lapack/index.html 
> 
> 
> First sentence:
> "Recent version of the GNU Fortran compiler (7, 8, 9) include 
> optimizations that break interoperability between C and Fortran code 
> with BLAS/LAPACK."
> 
> And later:
> "For the time being, everyone should use -fno-optimize-sibling-calls 
> with GFortran version 7 and newer."
> 
> G,
> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From Georg|n@@Ander@on @end|ng |rom phe@gov@uk  Wed Sep 11 17:55:37 2019
From: Georg|n@@Ander@on @end|ng |rom phe@gov@uk (Georgina Anderson)
Date: Wed, 11 Sep 2019 15:55:37 +0000
Subject: [R-pkg-devel] 
 OFFICIAL: R-devel check error: package or NAMESPACE
 load failed, there is no package called broom
In-Reply-To: <HE1PR0701MB2492DCBDF4AB0798A036EF9895B60@HE1PR0701MB2492.eurprd07.prod.outlook.com>
References: <69068DC5C231C74CA3D8CBAFCEFAF062F2C02A76@MAILMBXCOL02.phe.gov.uk>
 <CABdHhvHvOyVJ6ncJJMa-wubG9RnjHfU7wb8kOWDHEruJyzyZkQ@mail.gmail.com>
 <HE1PR0701MB2492DCBDF4AB0798A036EF9895B60@HE1PR0701MB2492.eurprd07.prod.outlook.com>
Message-ID: <69068DC5C231C74CA3D8CBAFCEFAF062F2C03A45@MAILMBXCOL02.phe.gov.uk>

OFFICIAL
Many thanks Pedro and Hadley 

Just to complete the thread if anyone else experiencing similar problems.  
This package uploaded to CRAN with no problems on second attempt so likely just bad timing.
  
Interesting that broom is failing CRAN tests though.  I will keep an eye on that as I import it with my package.

Georgie

-----Original Message-----
From: Aphalo, Pedro J <pedro.aphalo at helsinki.fi> 
Sent: 10 September 2019 15:39
To: Hadley Wickham <h.wickham at gmail.com>; Georgina Anderson <Georgina.Anderson at phe.gov.uk>
Cc: r-package-devel at r-project.org
Subject: RE: [R-pkg-devel] OFFICIAL: R-devel check error: package or NAMESPACE load failed, there is no package called broom

It seems that 'broom' itself is failing tests on CRAN under Windows oldrel, and this may cause it to be missing from the R installation running tests on CRAN.

See:
https://cran.r-project.org/web/checks/check_results_broom.html

Pedro.

--

Pedro J. Aphalo
University Lecturer, Principal Investigator Organismal and Evolutionary Biology (OEB) Research Programme University of Helsinki Finland


> -----Original Message-----
> From: R-package-devel <r-package-devel-bounces at r-project.org> On 
> Behalf Of Hadley Wickham
> Sent: 10 September 2019 15:16
> To: Georgina Anderson <Georgina.Anderson at phe.gov.uk>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] OFFICIAL: R-devel check error: package or 
> NAMESPACE load failed, there is no package called broom
> 
> This works for me locally too, so I'd recommend trying win-devel again.
> Sometimes you catch it in an inconsistent state and your check fails 
> for reasons unrelated to your package.
> 
> Hadley
> 
> On Sat, Sep 7, 2019 at 3:50 PM Georgina Anderson 
> <Georgina.Anderson at phe.gov.uk> wrote:
> >
> > OFFICIAL
> >
> > Hi
> >
> > Any help with the following update to my package PHEindicatormethods
> would be appreciated.
> >
> > I have made a very minor change to the package to fix dependencies 
> > on the
> tidyr:nest() function as tidyr v 1.0.0 is due to be released with 
> breaking changes on 9th September.
> > The version I am trying to upload to CRAN is 1.1.5 available here:
> > https://github.com/PublicHealthEngland/PHEindicatormethods
> >
> >
> > When I run devtools::check_win_devel locally (Windows 10 laptop, R 
> > 3.6.1, rStudio 1.2.1335) it passes with no NOTES, ERRORS or WARNINGS 
> > (locally it also passes devtools::check_win on release and 
> > oldrelease and devtools::check_rhub)
> >
> > When I submit to CRAN I have been notified that package
> PHEindicatormethods_1.1.5.tar.gz does not pass the incoming checks 
> automatically, signposting failing pre-tests on Windows:
> >
> > * using R Under development (unstable) (2019-09-02 r77130)
> >
> > * using platform: x86_64-w64-mingw32 (64-bit)
> >
> > * using session charset: ISO8859-1
> >
> >
> >
> > This is the log file available for 7 days:
> > https://win-builder.r-project.org/incoming_pretest/PHEindicatormetho
> > ds _1.1.5_20190905_224346/Windows/00check.log
> >
> > Below are two sections from the log that show the errors:
> >
> >
> > > library('PHEindicatormethods')
> >
> > Error: package or namespace load failed for 'PHEindicatormethods' in
> loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
> >
> >  there is no package called 'broom'
> >
> > Execution halted
> >
> > ** running examples for arch 'x64' ... ERROR
> >
> > Running examples in 'PHEindicatormethods-Ex.R' failed
> >
> > The error occurred in:
> >
> > R Under development (unstable) (2019-09-02 r77130) -- "Unsuffered
> Consequences"
> >
> > Copyright (C) 2019 The R Foundation for Statistical Computing
> >
> > Platform: x86_64-w64-mingw32/x64 (64-bit)
> >
> >
> > Error: processing vignette 'WorkedExamples_phe_sii.Rmd' failed with
> diagnostics:
> >
> > package or namespace load failed for 'PHEindicatormethods' in
> loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
> >
> >  there is no package called 'broom'
> >
> > --- failed re-building 'WorkedExamples_phe_sii.Rmd'
> >
> > SUMMARY: processing the following file failed:
> >
> >   'WorkedExamples_phe_sii.Rmd'
> >
> > Error: Vignette re-building failed.
> >
> > Execution halted
> >
> > I have checked the broom package and its upstream dependency on 
> > generics -
> I notice the tidy() function was moved from broom to generics a while 
> back but this was before I submitted the current version (1.1.3) of my 
> package to CRAN so not sure this can be the problem, although one of 
> my functions does reference broom::tidy().  The evidence seems to 
> point to changes in R-devel causing something in my package to break 
> but without being able to reproduce the errors seen by CRAN I'm finding it difficult to pinpoint the problem.
> >
> > Thanks
> > Georgie
> >
> >
> >
> *****************************************************************
> *****
> > **** The information contained in the EMail and any attachments is 
> > confidential and intended solely and for the attention and use of 
> > the named addressee(s). It may not be disclosed to any other person 
> > without the express authority of Public Health England, or the 
> > intended recipient, or both. If you are not the intended recipient, 
> > you must not disclose, copy, distribute or retain this message or 
> > any part of it. This footnote also confirms that this EMail has been 
> > swept for computer viruses by Symantec.Cloud, but please re-sweep 
> > any attachments before opening or saving. http://www.gov.uk/PHE
> >
> *****************************************************************
> *********
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list 
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> 
> 
> --
> http://hadley.nz
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

**************************************************************************
The information contained in the EMail and any attachments is confidential and intended solely and for the attention and use of the named addressee(s). It may not be disclosed to any other person without the express authority of Public Health England, or the intended recipient, or both. If you are not the intended recipient, you must not disclose, copy, distribute or retain this message or any part of it. This footnote also confirms that this EMail has been swept for computer viruses by Symantec.Cloud, but please re-sweep any attachments before opening or saving. http://www.gov.uk/PHE


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Thu Sep 12 09:13:24 2019
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Thu, 12 Sep 2019 09:13:24 +0200
Subject: [R-pkg-devel] R, BLAS, and FCLEN
In-Reply-To: <8a0ca051-46dd-ba3c-4359-f7305b5e13ca@umu.se>
References: <aa335279-734d-6ac8-e957-5070768201c5@umu.se>
 <2d39dac4-0094-374e-d2d2-2cc12773835d@umu.se>
 <8a0ca051-46dd-ba3c-4359-f7305b5e13ca@umu.se>
Message-ID: <23929.61460.289420.590627@stat.math.ethz.ch>

>>>>> G?ran Brostr?m 
>>>>>     on Wed, 11 Sep 2019 13:36:40 +0200 writes:

    > A followup question: Is it possible to call a BLAS/LAPACK subroutine, 
    > where one parameter is character, from FORTRAN (77) code called by 
    > .Fortran? (No problem "in the past".)

[as there wasn't a reply till now : ]

Yes, that should continue to be possible.

    > And if yes, how?

I'm sorry I don't know (and currently lack the time to try to find out)...

Martin

    >   Documentation describes calls from C to Fortran and 
    > vice versa, but not this situation (AFAICS).

    > Yes, I know that .Fortran is not well seen these days, but my fortran 
    > code is ancient, from the before-R era, and I would like to leave it as-is.

    > G,

    > Den 2019-09-01 kl. 21:46, skrev G?ran Brostr?m:
    >> 
    >> 
    >> On 2019-08-31 18:47, G?ran Brostr?m wrote:
    >>> I'm having difficulties updating my package eha: When I run standard 
    >>> checks 'at home' everything is fine, but 'CRAN-submissions' reports 
    >>> (among other things):
    >>> 
    >>> geomsup.f:324:9: warning: type of ?dgemv? does not match original 
    >>> declaration [-Wlto-type-mismatch]
    >>> ?? 324 |????? &???? one, score, ione)
    >>> ?????? |???????? ^
    >>> /home/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:107:1: note: type mismatch 
    >>> in parameter 12
    >>> ?? 107 | F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
    >>> ?????? | ^
    >>> 
    >>> This is odd since the LAPACK subroutine dgemv takes only 11 
    >>> parameters. However, in include/R_ext/BLAS.h we have
    >>> 
    >>> F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
    >>> ???????? const double *alpha, const double *a, const int *lda,
    >>> ???????? const double *x, const int *incx, const double *beta,
    >>> ???????? double *y, const int *incy FCLEN);
    >>> 
    >>> with a 12th parameter FCLEN?? How am I supposed to fix this, and what 
    >>> the ... is FCLEN? googling leads to nothing useful (for me). It seems 
    >>> as if R is redefining some standard LAPACK routines.
    >>> 
    >>> Also a note I do not understand (in this context):
    >>> 
    >>> note: type ?void? should match type ?long int?
    >>> 
    >>> Any help is much appreciated.
    >>> 
    >>> Best, G?ran
    >>> 
    >>> PS. How can I trigger these Warnings 'at home'?
    >> 
    >> See https://www.stats.ox.ac.uk/pub/bdr/LTO/README.txt (thanks to Uwe 
    >> Ligges).
    >> 
    >> Another relevant document seems to be (2019-05-15):
    >> 
    >> https://developer.r-project.org/Blog/public/2019/05/15/gfortran-issues-with-lapack/index.html 
    >> 
    >> 
    >> First sentence:
    >> "Recent version of the GNU Fortran compiler (7, 8, 9) include 
    >> optimizations that break interoperability between C and Fortran code 
    >> with BLAS/LAPACK."
    >> 
    >> And later:
    >> "For the time being, everyone should use -fno-optimize-sibling-calls 
    >> with GFortran version 7 and newer."
    >> 
    >> G,
    >> 
    >>> ______________________________________________
    >>> R-package-devel at r-project.org mailing list
    >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
    >> 
    >> ______________________________________________
    >> R-package-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-package-devel

    > ______________________________________________
    > R-package-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-package-devel


From gor@n@bro@trom @end|ng |rom umu@@e  Fri Sep 13 00:07:15 2019
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Fri, 13 Sep 2019 00:07:15 +0200
Subject: [R-pkg-devel] R, BLAS, and FCLEN (solved)
In-Reply-To: <23929.61460.289420.590627@stat.math.ethz.ch>
References: <aa335279-734d-6ac8-e957-5070768201c5@umu.se>
 <2d39dac4-0094-374e-d2d2-2cc12773835d@umu.se>
 <8a0ca051-46dd-ba3c-4359-f7305b5e13ca@umu.se>
 <23929.61460.289420.590627@stat.math.ethz.ch>
Message-ID: <ca2eca43-4312-ef67-327c-b76fa5c1af7f@umu.se>



On 2019-09-12 09:13, Martin Maechler wrote:
>>>>>> G?ran Brostr?m
>>>>>>      on Wed, 11 Sep 2019 13:36:40 +0200 writes:
> 
>      > A followup question: Is it possible to call a BLAS/LAPACK subroutine,
>      > where one parameter is character, from FORTRAN (77) code called by
>      > .Fortran? (No problem "in the past".)
> 
> [as there wasn't a reply till now : ]
> 
> Yes, that should continue to be possible.
> 
>      > And if yes, how?
> 
> I'm sorry I don't know (and currently lack the time to try to find out)...

I solved it by writing a C wrapper (for the BLAS subroutine dgemv) cdgemv:

#define USE_FC_LEN_T
#include <Rconfig.h>
#include <R_ext/BLAS.h>
#ifndef FCONE
# define FCONE
#endif
#include <R.h>
#include "cdgemv.h"

void F77_SUB(cdgemv)(const int *trans, const int *m, const int *n,
		     const double *alpha, const double *a,
                      const int *lda,
		     const double *x, const int *incx,
                      const double *beta,
		     double *y, const int *incy){
    char trams;

    if (*trans == 1){
       trams = 'N';
       F77_CALL(dgemv)(&trams, m, n, alpha, a, lda, x, incx, beta, y,
                       incy FCONE);
    }else
       Rprintf("trans has wrong value\n");
    }
}

which I call from Fortran. Curiously, a Fortran wrapper also seems to work.

G,
> 
> Martin
> 
>      >   Documentation describes calls from C to Fortran and
>      > vice versa, but not this situation (AFAICS).
> 
>      > Yes, I know that .Fortran is not well seen these days, but my fortran
>      > code is ancient, from the before-R era, and I would like to leave it as-is.
> 
>      > G,
> 
>      > Den 2019-09-01 kl. 21:46, skrev G?ran Brostr?m:
>      >>
>      >>
>      >> On 2019-08-31 18:47, G?ran Brostr?m wrote:
>      >>> I'm having difficulties updating my package eha: When I run standard
>      >>> checks 'at home' everything is fine, but 'CRAN-submissions' reports
>      >>> (among other things):
>      >>>
>      >>> geomsup.f:324:9: warning: type of ?dgemv? does not match original
>      >>> declaration [-Wlto-type-mismatch]
>      >>> ?? 324 |????? &???? one, score, ione)
>      >>> ?????? |???????? ^
>      >>> /home/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:107:1: note: type mismatch
>      >>> in parameter 12
>      >>> ?? 107 | F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>      >>> ?????? | ^
>      >>>
>      >>> This is odd since the LAPACK subroutine dgemv takes only 11
>      >>> parameters. However, in include/R_ext/BLAS.h we have
>      >>>
>      >>> F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>      >>> ???????? const double *alpha, const double *a, const int *lda,
>      >>> ???????? const double *x, const int *incx, const double *beta,
>      >>> ???????? double *y, const int *incy FCLEN);
>      >>>
>      >>> with a 12th parameter FCLEN?? How am I supposed to fix this, and what
>      >>> the ... is FCLEN? googling leads to nothing useful (for me). It seems
>      >>> as if R is redefining some standard LAPACK routines.
>      >>>
>      >>> Also a note I do not understand (in this context):
>      >>>
>      >>> note: type ?void? should match type ?long int?
>      >>>
>      >>> Any help is much appreciated.
>      >>>
>      >>> Best, G?ran
>      >>>
>      >>> PS. How can I trigger these Warnings 'at home'?
>      >>
>      >> See https://www.stats.ox.ac.uk/pub/bdr/LTO/README.txt (thanks to Uwe
>      >> Ligges).
>      >>
>      >> Another relevant document seems to be (2019-05-15):
>      >>
>      >> https://developer.r-project.org/Blog/public/2019/05/15/gfortran-issues-with-lapack/index.html
>      >>
>      >>
>      >> First sentence:
>      >> "Recent version of the GNU Fortran compiler (7, 8, 9) include
>      >> optimizations that break interoperability between C and Fortran code
>      >> with BLAS/LAPACK."
>      >>
>      >> And later:
>      >> "For the time being, everyone should use -fno-optimize-sibling-calls
>      >> with GFortran version 7 and newer."
>      >>
>      >> G,
>      >>
>      >>> ______________________________________________
>      >>> R-package-devel at r-project.org mailing list
>      >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>      >>
>      >> ______________________________________________
>      >> R-package-devel at r-project.org mailing list
>      >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
>      > ______________________________________________
>      > R-package-devel at r-project.org mailing list
>      > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From m@rc|njurek1988 @end|ng |rom gm@||@com  Thu Sep 12 23:12:17 2019
From: m@rc|njurek1988 @end|ng |rom gm@||@com (Marcin Jurek)
Date: Thu, 12 Sep 2019 16:12:17 -0500
Subject: [R-pkg-devel] please help understand an error in openMP statements
Message-ID: <CAKpFkB0TSTrFT7_SBC5e0qS27CiVdANYgOvJnKE9y=QC39qtTA@mail.gmail.com>

Hello everyone, I'm submitting a package to CRAN which I tested locally, on
Travis CI, R-hub and win builder. It worked no problem in all these
environments. However, after submission, I keep getting the error described
here:

<https://win-builder.r-project.org/incoming_pretest/GPvecchia_0.1.0_20190912_151538/Debian/00install.out>
https://win-builder.r-project.org/incoming_pretest/GPvecchia_0.1.0_20190912_201702/Debian/00install.out


I'm not a pro when it comes to openMP but since all previous tests
completed successfully, I thought things were alright. Could you help me
understand what's wrong and how to fix it? Source code of the package can
be found at http://github.com/katzfuss-group/GPvecchia Thanks a lot!


Marcin

	[[alternative HTML version deleted]]


From @ergue|@@oko| @end|ng |rom gm@||@com  Fri Sep 13 10:27:58 2019
From: @ergue|@@oko| @end|ng |rom gm@||@com (Serguei Sokol)
Date: Fri, 13 Sep 2019 10:27:58 +0200
Subject: [R-pkg-devel] 
 please help understand an error in openMP statements
In-Reply-To: <CAKpFkB0TSTrFT7_SBC5e0qS27CiVdANYgOvJnKE9y=QC39qtTA@mail.gmail.com>
References: <CAKpFkB0TSTrFT7_SBC5e0qS27CiVdANYgOvJnKE9y=QC39qtTA@mail.gmail.com>
Message-ID: <387526c0-f95b-236c-7459-0f49c7f64a3d@gmail.com>

On 12/09/2019 23:12, Marcin Jurek wrote:
> Hello everyone, I'm submitting a package to CRAN which I tested locally, on
> Travis CI, R-hub and win builder. It worked no problem in all these
> environments. However, after submission, I keep getting the error described
> here:
> 
> <https://win-builder.r-project.org/incoming_pretest/GPvecchia_0.1.0_20190912_151538/Debian/00install.out>
> https://win-builder.r-project.org/incoming_pretest/GPvecchia_0.1.0_20190912_201702/Debian/00install.out
One obvious error is pretty well described by the compiler:

U_NZentries.cpp:258:19: error: ?covparms? not specified in enclosing 
?parallel?
   258 |  covmat= MaternFun(dist,covparms) + diagmat(nug) ; // summation 
from arma
       |          ~~~~~~~~~^~~~~~~~~~~~~~~
U_NZentries.cpp:230:11: error: enclosing ?parallel?
   230 |   #pragma omp parallel for 
shared(locs,revNNarray,revCondOnLatent,nuggets, nnp,m,Lentries,COV) 
private(k,M,dist,onevec,covmat,nug,n0,inds,revCon_row,inds00,succ,attempt) 
default(none) schedule(static)

It simply stets that you should add 'covparms' either to private() or to 
shared() list on line 230.

I have no idea for other messages complaining about 'none'.

Best Serguei.


> 
> 
> I'm not a pro when it comes to openMP but since all previous tests
> completed successfully, I thought things were alright. Could you help me
> understand what's wrong and how to fix it? Source code of the package can
> be found at http://github.com/katzfuss-group/GPvecchia Thanks a lot!
> 
> 
> Marcin
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Sep 13 10:43:54 2019
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 13 Sep 2019 11:43:54 +0300
Subject: [R-pkg-devel] 
 please help understand an error in openMP statements
In-Reply-To: <CAKpFkB0TSTrFT7_SBC5e0qS27CiVdANYgOvJnKE9y=QC39qtTA@mail.gmail.com>
References: <CAKpFkB0TSTrFT7_SBC5e0qS27CiVdANYgOvJnKE9y=QC39qtTA@mail.gmail.com>
Message-ID: <20190913114354.34064d44@Tarkus>

On Thu, 12 Sep 2019 16:12:17 -0500
Marcin Jurek <marcinjurek1988 at gmail.com> wrote:

> U_NZentries.cpp:258:19: error: ?covparms? not specified in enclosing ?parallel?
>   258 |  covmat= MaternFun(dist,covparms) + diagmat(nug) ; // summation from arma
>       |          ~~~~~~~~~^~~~~~~~~~~~~~~

This might be a compiler bug: const arma::vec covparms from the
argument list should have been automatically predetermined "shared". If
you try to specify #pragma omp shared(...,covparams) manually, you might
hit another error: "covparams" is predetermined "shared" for "shared".
In a similar case, I couldn't find a good workaround and had to switch
to default(shared).

> U_NZentries.cpp:271:12: error: ?none? not specified in enclosing ?parallel?
>   271 |     M=solve(chol(covmat,"upper"),onevec);
>       |       ~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~

This is probably about the temporary returned from
chol(covmat,"upper"). Declare a variable for it inside the loop, and
the compiler will understand that it's private. Again, this shouldn't
be happening, so what I'm offering is a workaround.

What I find really strange is that gcc-4.9.3/mingw_32/bin/g++.exe
doesn't have any problems with this code, while supposedly newer g++-9
does.

-- 
Best regards,
Ivan


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Fri Sep 13 11:07:04 2019
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Fri, 13 Sep 2019 11:07:04 +0200
Subject: [R-pkg-devel] R, BLAS, and FCLEN (solved)
In-Reply-To: <ca2eca43-4312-ef67-327c-b76fa5c1af7f@umu.se>
References: <aa335279-734d-6ac8-e957-5070768201c5@umu.se>
 <2d39dac4-0094-374e-d2d2-2cc12773835d@umu.se>
 <8a0ca051-46dd-ba3c-4359-f7305b5e13ca@umu.se>
 <23929.61460.289420.590627@stat.math.ethz.ch>
 <ca2eca43-4312-ef67-327c-b76fa5c1af7f@umu.se>
Message-ID: <7bf530a9-cc0e-5ced-9a4d-11ee9891ee77@gmail.com>

Dear G?ran,

I can reproduce the problem with eha version 2.6.0. The reason for the 
type mismatch, and hence the LTO warning, is _not_ the calls to dgemv 
from Fortran code, but the calls to dgemv from the C code from the other 
source files in your package. There is no need to go through wrappers 
when calling dgemv from Fortran (as long as both modules are compiled 
with the same compiler, or with compatible compilers).

When you fix all the calls to dgemv in your C source files to use 
"FCONE", as documented in WRE, the warning about the call to dgemv from 
geomsup.f will go away (yes, the warnings from the LTO linker/compiler 
are confusing). There is no need for creating any wrappers for 
BLAS/LAPACK calls.

One can check that the generated calls from the Fortran are correct e.g. 
via compiling with -fdump-tree-all and then dumping
$ egrep -e '(^;;)|(dgemv)' eha.so.ltrans0.232t.optimized | grep dgemv -B1
(the file name above will depend on the exact version of your compiler)

;; Function d2_loglik_ph (d2_loglik_ph, funcdef_no=77, decl_uid=4474, 
cgraph_uid=103, symbol_order=990)
 ? dgemv_ (&trans, mb_497(D), nn_499(D), &alf, z_502(D), mb_497(D), 
b_503(D), &one, &Rf_beta, ezb_501, &one);
--
;; Function d2_loglik_phexp (d2_loglik_phexp, funcdef_no=87, 
decl_uid=4470, cgraph_uid=100, symbol_order=1108)
 ? dgemv_ (&trans, mb_253(D), nn_255(D), &alf, z_258(D), mb_253(D), 
b_259(D), &one, &Rf_beta, ezb_257, &one);
--
;; Function gmlfun (gmlfun_, funcdef_no=98, decl_uid=4484, 
cgraph_uid=108, symbol_order=874)
 ? dgemv_ (&"N"[1]{lb: 1 sz: 1}, nn_68(D), antcov_63(D), &C.7966, 
covar_83(D), nn_68(D), beta_84(D), &C.7965, &C.7964, score_81(D), 
&C.7963, 1);
--
;; Function geomsup (geomsup_, funcdef_no=116, decl_uid=4498, 
cgraph_uid=117, symbol_order=823)
 ? dgemv_ (&"N"[1]{lb: 1 sz: 1}, nn_55(D), antcov_51(D), &C.9626, 
covar_89(D), nn_55(D), startbeta_83(D), &C.9625, &C.9624, score_87(D), 
&C.9623, 1);
--
;; Function sup (sup, funcdef_no=128, decl_uid=4335, cgraph_uid=7, 
symbol_order=1772)
 ? dgemv_ (&trans, &nn, &p, &one, covar_281(D), &nn, beta_340(D), &ione, 
&one, score_230, &ione);

You can see that the calls to dgemv from gmlfun and geomsup are fine 
(from Fortran code), the other are bad (from C code).? Indeed, one would 
have found out also by creating a minimal reproducible example - it is 
always useful, even when not attempting to report a bug.

Best
Tomas

On 9/13/19 12:07 AM, G?ran Brostr?m wrote:
>
>
> On 2019-09-12 09:13, Martin Maechler wrote:
>>>>>>> G?ran Brostr?m
>>>>>>> ???? on Wed, 11 Sep 2019 13:36:40 +0200 writes:
>>
>> ???? > A followup question: Is it possible to call a BLAS/LAPACK 
>> subroutine,
>> ???? > where one parameter is character, from FORTRAN (77) code 
>> called by
>> ???? > .Fortran? (No problem "in the past".)
>>
>> [as there wasn't a reply till now : ]
>>
>> Yes, that should continue to be possible.
>>
>> ???? > And if yes, how?
>>
>> I'm sorry I don't know (and currently lack the time to try to find 
>> out)...
>
> I solved it by writing a C wrapper (for the BLAS subroutine dgemv) 
> cdgemv:
>
> #define USE_FC_LEN_T
> #include <Rconfig.h>
> #include <R_ext/BLAS.h>
> #ifndef FCONE
> # define FCONE
> #endif
> #include <R.h>
> #include "cdgemv.h"
>
> void F77_SUB(cdgemv)(const int *trans, const int *m, const int *n,
> ???????????? const double *alpha, const double *a,
> ???????????????????? const int *lda,
> ???????????? const double *x, const int *incx,
> ???????????????????? const double *beta,
> ???????????? double *y, const int *incy){
> ?? char trams;
>
> ?? if (*trans == 1){
> ????? trams = 'N';
> ????? F77_CALL(dgemv)(&trams, m, n, alpha, a, lda, x, incx, beta, y,
> ????????????????????? incy FCONE);
> ?? }else
> ????? Rprintf("trans has wrong value\n");
> ?? }
> }
>
> which I call from Fortran. Curiously, a Fortran wrapper also seems to 
> work.
>
> G,
>>
>> Martin
>>
>> ???? >?? Documentation describes calls from C to Fortran and
>> ???? > vice versa, but not this situation (AFAICS).
>>
>> ???? > Yes, I know that .Fortran is not well seen these days, but my 
>> fortran
>> ???? > code is ancient, from the before-R era, and I would like to 
>> leave it as-is.
>>
>> ???? > G,
>>
>> ???? > Den 2019-09-01 kl. 21:46, skrev G?ran Brostr?m:
>> ???? >>
>> ???? >>
>> ???? >> On 2019-08-31 18:47, G?ran Brostr?m wrote:
>> ???? >>> I'm having difficulties updating my package eha: When I run 
>> standard
>> ???? >>> checks 'at home' everything is fine, but 'CRAN-submissions' 
>> reports
>> ???? >>> (among other things):
>> ???? >>>
>> ???? >>> geomsup.f:324:9: warning: type of ?dgemv? does not match 
>> original
>> ???? >>> declaration [-Wlto-type-mismatch]
>> ???? >>> ?? 324 |????? &???? one, score, ione)
>> ???? >>> ?????? |???????? ^
>> ???? >>> /home/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:107:1: note: type 
>> mismatch
>> ???? >>> in parameter 12
>> ???? >>> ?? 107 | F77_NAME(dgemv)(const char *trans, const int *m, 
>> const int *n,
>> ???? >>> ?????? | ^
>> ???? >>>
>> ???? >>> This is odd since the LAPACK subroutine dgemv takes only 11
>> ???? >>> parameters. However, in include/R_ext/BLAS.h we have
>> ???? >>>
>> ???? >>> F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>> ???? >>> ???????? const double *alpha, const double *a, const int *lda,
>> ???? >>> ???????? const double *x, const int *incx, const double *beta,
>> ???? >>> ???????? double *y, const int *incy FCLEN);
>> ???? >>>
>> ???? >>> with a 12th parameter FCLEN?? How am I supposed to fix this, 
>> and what
>> ???? >>> the ... is FCLEN? googling leads to nothing useful (for me). 
>> It seems
>> ???? >>> as if R is redefining some standard LAPACK routines.
>> ???? >>>
>> ???? >>> Also a note I do not understand (in this context):
>> ???? >>>
>> ???? >>> note: type ?void? should match type ?long int?
>> ???? >>>
>> ???? >>> Any help is much appreciated.
>> ???? >>>
>> ???? >>> Best, G?ran
>> ???? >>>
>> ???? >>> PS. How can I trigger these Warnings 'at home'?
>> ???? >>
>> ???? >> See https://www.stats.ox.ac.uk/pub/bdr/LTO/README.txt (thanks 
>> to Uwe
>> ???? >> Ligges).
>> ???? >>
>> ???? >> Another relevant document seems to be (2019-05-15):
>> ???? >>
>> ???? >> 
>> https://developer.r-project.org/Blog/public/2019/05/15/gfortran-issues-with-lapack/index.html
>> ???? >>
>> ???? >>
>> ???? >> First sentence:
>> ???? >> "Recent version of the GNU Fortran compiler (7, 8, 9) include
>> ???? >> optimizations that break interoperability between C and 
>> Fortran code
>> ???? >> with BLAS/LAPACK."
>> ???? >>
>> ???? >> And later:
>> ???? >> "For the time being, everyone should use 
>> -fno-optimize-sibling-calls
>> ???? >> with GFortran version 7 and newer."
>> ???? >>
>> ???? >> G,
>> ???? >>
>> ???? >>> ______________________________________________
>> ???? >>> R-package-devel at r-project.org mailing list
>> ???? >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> ???? >>
>> ???? >> ______________________________________________
>> ???? >> R-package-devel at r-project.org mailing list
>> ???? >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ???? > ______________________________________________
>> ???? > R-package-devel at r-project.org mailing list
>> ???? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From gor@n@bro@trom @end|ng |rom umu@@e  Fri Sep 13 12:34:26 2019
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Fri, 13 Sep 2019 12:34:26 +0200
Subject: [R-pkg-devel] R, BLAS, and FCLEN (solved)
In-Reply-To: <7bf530a9-cc0e-5ced-9a4d-11ee9891ee77@gmail.com>
References: <aa335279-734d-6ac8-e957-5070768201c5@umu.se>
 <2d39dac4-0094-374e-d2d2-2cc12773835d@umu.se>
 <8a0ca051-46dd-ba3c-4359-f7305b5e13ca@umu.se>
 <23929.61460.289420.590627@stat.math.ethz.ch>
 <ca2eca43-4312-ef67-327c-b76fa5c1af7f@umu.se>
 <7bf530a9-cc0e-5ced-9a4d-11ee9891ee77@gmail.com>
Message-ID: <e1781923-5338-5ca6-7cea-4ef9f73a7bf0@umu.se>

Dear Tomas,

your explanation matches exactly my expectation, but not my experience. 
I uploaded (to CRAN) version 2.7.5 yesterday, and there I use, in  the 
Fortran function gmlfun, directly called by .Fortran:

       call cdgemv(trans, nn, antcov, one, covar, nn, beta, ione, one,
      &     score, ione)

that is, the C wrapper of dgemv (my home-brew)

No warnings from R-devel CMD check --as-cran, and when installed it runs 
fine.

However, if I change that call to

        call dgemv(trans, nn, antcov, one, covar, nn, beta, ione, one,
      &     score, ione)

that is, a direct call to the Fortran subroutine dgemv, I get, from 
R-devel CMD check --as-cran,

gmlfun.f:224:1: warning: type of ?dgemv? does not match original 
declaration [-Wlto-type-mismatch]
       &     score, ione)
  ^
/home/gobr0002/R/src/R-devel/include/R_ext/BLAS.h:107:1: note: type 
mismatch in parameter 12
  F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
  ^

and when I install and run, I get error:

 > library(eha)
Loading required package: survival
 > fit <- coxreg(Surv(enter, exit, event) ~ ses, data = mort, geometric 
= TRUE)
Error in geome.fit(X, Y, rs, strats, offset, init, max.survs, method,  :
   BLAS/LAPACK routine 'DGEMV ' gave error code -1
 >
 > sessionInfo()
R version 3.6.1 (2019-07-05)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 19.04
...
Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.8.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.8.0
...
Other attached packages:
[1] eha_2.7.5.1000    survival_2.44-1.1
-------------

To summarize: The calls from C code are fixed and work fine. Direct call 
from fortran "level 1" gives error, from "level 2" is fine. "level 1" is 
fortran code directly called by .Fortran, "level 2" is fortran code 
called from fortran code called by .Fortran.

This was done with

R Under development (unstable) (2019-08-31 r77115). I could try a more 
recent version of R-devel.

About a 'small reproducible example': It is not that easy to shrink the 
eha package to include only the relevant fortran code, since there are 
subtle interdependencies in the package code. It would take a 
considerable amount of time (for me) to create that package.
I can make eha_2.7.5.tar.gz available, but it was sent in to CRAN yesterday.

G?ran

On 2019-09-13 11:07, Tomas Kalibera wrote:
> Dear G?ran,
> 
> I can reproduce the problem with eha version 2.6.0. The reason for the 
> type mismatch, and hence the LTO warning, is _not_ the calls to dgemv 
> from Fortran code, but the calls to dgemv from the C code from the other 
> source files in your package. There is no need to go through wrappers 
> when calling dgemv from Fortran (as long as both modules are compiled 
> with the same compiler, or with compatible compilers).
> 
> When you fix all the calls to dgemv in your C source files to use 
> "FCONE", as documented in WRE, the warning about the call to dgemv from 
> geomsup.f will go away (yes, the warnings from the LTO linker/compiler 
> are confusing). There is no need for creating any wrappers for 
> BLAS/LAPACK calls.
> 
> One can check that the generated calls from the Fortran are correct e.g. 
> via compiling with -fdump-tree-all and then dumping
> $ egrep -e '(^;;)|(dgemv)' eha.so.ltrans0.232t.optimized | grep dgemv -B1
> (the file name above will depend on the exact version of your compiler)
> 
> ;; Function d2_loglik_ph (d2_loglik_ph, funcdef_no=77, decl_uid=4474, 
> cgraph_uid=103, symbol_order=990)
>  ? dgemv_ (&trans, mb_497(D), nn_499(D), &alf, z_502(D), mb_497(D), 
> b_503(D), &one, &Rf_beta, ezb_501, &one);
> -- 
> ;; Function d2_loglik_phexp (d2_loglik_phexp, funcdef_no=87, 
> decl_uid=4470, cgraph_uid=100, symbol_order=1108)
>  ? dgemv_ (&trans, mb_253(D), nn_255(D), &alf, z_258(D), mb_253(D), 
> b_259(D), &one, &Rf_beta, ezb_257, &one);
> -- 
> ;; Function gmlfun (gmlfun_, funcdef_no=98, decl_uid=4484, 
> cgraph_uid=108, symbol_order=874)
>  ? dgemv_ (&"N"[1]{lb: 1 sz: 1}, nn_68(D), antcov_63(D), &C.7966, 
> covar_83(D), nn_68(D), beta_84(D), &C.7965, &C.7964, score_81(D), 
> &C.7963, 1);
> -- 
> ;; Function geomsup (geomsup_, funcdef_no=116, decl_uid=4498, 
> cgraph_uid=117, symbol_order=823)
>  ? dgemv_ (&"N"[1]{lb: 1 sz: 1}, nn_55(D), antcov_51(D), &C.9626, 
> covar_89(D), nn_55(D), startbeta_83(D), &C.9625, &C.9624, score_87(D), 
> &C.9623, 1);
> -- 
> ;; Function sup (sup, funcdef_no=128, decl_uid=4335, cgraph_uid=7, 
> symbol_order=1772)
>  ? dgemv_ (&trans, &nn, &p, &one, covar_281(D), &nn, beta_340(D), &ione, 
> &one, score_230, &ione);
> 
> You can see that the calls to dgemv from gmlfun and geomsup are fine 
> (from Fortran code), the other are bad (from C code).? Indeed, one would 
> have found out also by creating a minimal reproducible example - it is 
> always useful, even when not attempting to report a bug.
> 
> Best
> Tomas
> 
> On 9/13/19 12:07 AM, G?ran Brostr?m wrote:
>>
>>
>> On 2019-09-12 09:13, Martin Maechler wrote:
>>>>>>>> G?ran Brostr?m
>>>>>>>> ???? on Wed, 11 Sep 2019 13:36:40 +0200 writes:
>>>
>>> ???? > A followup question: Is it possible to call a BLAS/LAPACK 
>>> subroutine,
>>> ???? > where one parameter is character, from FORTRAN (77) code 
>>> called by
>>> ???? > .Fortran? (No problem "in the past".)
>>>
>>> [as there wasn't a reply till now : ]
>>>
>>> Yes, that should continue to be possible.
>>>
>>> ???? > And if yes, how?
>>>
>>> I'm sorry I don't know (and currently lack the time to try to find 
>>> out)...
>>
>> I solved it by writing a C wrapper (for the BLAS subroutine dgemv) 
>> cdgemv:
>>
>> #define USE_FC_LEN_T
>> #include <Rconfig.h>
>> #include <R_ext/BLAS.h>
>> #ifndef FCONE
>> # define FCONE
>> #endif
>> #include <R.h>
>> #include "cdgemv.h"
>>
>> void F77_SUB(cdgemv)(const int *trans, const int *m, const int *n,
>> ???????????? const double *alpha, const double *a,
>> ???????????????????? const int *lda,
>> ???????????? const double *x, const int *incx,
>> ???????????????????? const double *beta,
>> ???????????? double *y, const int *incy){
>> ?? char trams;
>>
>> ?? if (*trans == 1){
>> ????? trams = 'N';
>> ????? F77_CALL(dgemv)(&trams, m, n, alpha, a, lda, x, incx, beta, y,
>> ????????????????????? incy FCONE);
>> ?? }else
>> ????? Rprintf("trans has wrong value\n");
>> ?? }
>> }
>>
>> which I call from Fortran. Curiously, a Fortran wrapper also seems to 
>> work.
>>
>> G,
>>>
>>> Martin
>>>
>>> ???? >?? Documentation describes calls from C to Fortran and
>>> ???? > vice versa, but not this situation (AFAICS).
>>>
>>> ???? > Yes, I know that .Fortran is not well seen these days, but my 
>>> fortran
>>> ???? > code is ancient, from the before-R era, and I would like to 
>>> leave it as-is.
>>>
>>> ???? > G,
>>>
>>> ???? > Den 2019-09-01 kl. 21:46, skrev G?ran Brostr?m:
>>> ???? >>
>>> ???? >>
>>> ???? >> On 2019-08-31 18:47, G?ran Brostr?m wrote:
>>> ???? >>> I'm having difficulties updating my package eha: When I run 
>>> standard
>>> ???? >>> checks 'at home' everything is fine, but 'CRAN-submissions' 
>>> reports
>>> ???? >>> (among other things):
>>> ???? >>>
>>> ???? >>> geomsup.f:324:9: warning: type of ?dgemv? does not match 
>>> original
>>> ???? >>> declaration [-Wlto-type-mismatch]
>>> ???? >>> ?? 324 |????? &???? one, score, ione)
>>> ???? >>> ?????? |???????? ^
>>> ???? >>> /home/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:107:1: note: type 
>>> mismatch
>>> ???? >>> in parameter 12
>>> ???? >>> ?? 107 | F77_NAME(dgemv)(const char *trans, const int *m, 
>>> const int *n,
>>> ???? >>> ?????? | ^
>>> ???? >>>
>>> ???? >>> This is odd since the LAPACK subroutine dgemv takes only 11
>>> ???? >>> parameters. However, in include/R_ext/BLAS.h we have
>>> ???? >>>
>>> ???? >>> F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>>> ???? >>> ???????? const double *alpha, const double *a, const int *lda,
>>> ???? >>> ???????? const double *x, const int *incx, const double *beta,
>>> ???? >>> ???????? double *y, const int *incy FCLEN);
>>> ???? >>>
>>> ???? >>> with a 12th parameter FCLEN?? How am I supposed to fix this, 
>>> and what
>>> ???? >>> the ... is FCLEN? googling leads to nothing useful (for me). 
>>> It seems
>>> ???? >>> as if R is redefining some standard LAPACK routines.
>>> ???? >>>
>>> ???? >>> Also a note I do not understand (in this context):
>>> ???? >>>
>>> ???? >>> note: type ?void? should match type ?long int?
>>> ???? >>>
>>> ???? >>> Any help is much appreciated.
>>> ???? >>>
>>> ???? >>> Best, G?ran
>>> ???? >>>
>>> ???? >>> PS. How can I trigger these Warnings 'at home'?
>>> ???? >>
>>> ???? >> See https://www.stats.ox.ac.uk/pub/bdr/LTO/README.txt (thanks 
>>> to Uwe
>>> ???? >> Ligges).
>>> ???? >>
>>> ???? >> Another relevant document seems to be (2019-05-15):
>>> ???? >>
>>> ???? >> 
>>> https://developer.r-project.org/Blog/public/2019/05/15/gfortran-issues-with-lapack/index.html 
>>>
>>> ???? >>
>>> ???? >>
>>> ???? >> First sentence:
>>> ???? >> "Recent version of the GNU Fortran compiler (7, 8, 9) include
>>> ???? >> optimizations that break interoperability between C and 
>>> Fortran code
>>> ???? >> with BLAS/LAPACK."
>>> ???? >>
>>> ???? >> And later:
>>> ???? >> "For the time being, everyone should use 
>>> -fno-optimize-sibling-calls
>>> ???? >> with GFortran version 7 and newer."
>>> ???? >>
>>> ???? >> G,
>>> ???? >>
>>> ???? >>> ______________________________________________
>>> ???? >>> R-package-devel at r-project.org mailing list
>>> ???? >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>> ???? >>
>>> ???? >> ______________________________________________
>>> ???? >> R-package-devel at r-project.org mailing list
>>> ???? >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>> ???? > ______________________________________________
>>> ???? > R-package-devel at r-project.org mailing list
>>> ???? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
>


From v|ncentv@nhee@ @end|ng |rom gm@||@com  Fri Sep 13 13:21:52 2019
From: v|ncentv@nhee@ @end|ng |rom gm@||@com (Vincent van Hees)
Date: Fri, 13 Sep 2019 13:21:52 +0200
Subject: [R-pkg-devel] My test passes in OSx on Travis,
 but not in OSx on CRAN
Message-ID: <CALnEB15V0f2j+rXkB4p3L0QQ55ZXw9dZCtGGerKUG7aWeGagOQ@mail.gmail.com>

Dear all,

I have a test in my R package that passes in OSx on Travis-CI, but it does
not pass in OSx on CRAN. What does pass on both CRAN and Travis are the
Linux tests. Also, on CRAN the Windows flavor passes. So, there seems to be
an issue specific to the combination OSx and CRAN.

The easiest solution for me would be to add 'skip_on_cran()' at the top of
the test, but that would blind me for serious issues (if any). I already
made sure that the seeds are set before random number generators and that
value checks are limited to 3 decimal places to deal machine precision
issues. Does anyone have suggestions for me on what else I can do to
investigate this?

Link
<https://github.com/wadpac/GGIR/blob/master/tests/testthat/test_read.myacc.csv.R>
to the specific test on GitHub. The function that is being tested first
creates dummy csv-files with random data and then checks that my wrapper
function around data.table() is able to read and interpret those dummy
files.
Link <https://cran.r-project.org/web/checks/check_results_GGIR.html> to
CRAN results
Link <https://travis-ci.org/wadpac/GGIR> to Travis-CI page for the package

I have a local Windows and Linux machine, but for OSx testing I depend on
Travis-CI.

Thanks,
Vincent

	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Fri Sep 13 13:30:05 2019
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Fri, 13 Sep 2019 13:30:05 +0200
Subject: [R-pkg-devel] My test passes in OSx on Travis,
 but not in OSx on CRAN
In-Reply-To: <CALnEB15V0f2j+rXkB4p3L0QQ55ZXw9dZCtGGerKUG7aWeGagOQ@mail.gmail.com>
References: <CALnEB15V0f2j+rXkB4p3L0QQ55ZXw9dZCtGGerKUG7aWeGagOQ@mail.gmail.com>
Message-ID: <12ffca2c-3267-18c8-b1f1-a17857b12ce0@gmail.com>

The error seems to be because you are trying to write to the user's home 
directory. This is not allowed. Probably by accident your test creates 
"~/testcsv4.csv" (the same problem is present for other test files).

Best
Tomas

On 9/13/19 1:21 PM, Vincent van Hees wrote:
> Dear all,
>
> I have a test in my R package that passes in OSx on Travis-CI, but it does
> not pass in OSx on CRAN. What does pass on both CRAN and Travis are the
> Linux tests. Also, on CRAN the Windows flavor passes. So, there seems to be
> an issue specific to the combination OSx and CRAN.
>
> The easiest solution for me would be to add 'skip_on_cran()' at the top of
> the test, but that would blind me for serious issues (if any). I already
> made sure that the seeds are set before random number generators and that
> value checks are limited to 3 decimal places to deal machine precision
> issues. Does anyone have suggestions for me on what else I can do to
> investigate this?
>
> Link
> <https://github.com/wadpac/GGIR/blob/master/tests/testthat/test_read.myacc.csv.R>
> to the specific test on GitHub. The function that is being tested first
> creates dummy csv-files with random data and then checks that my wrapper
> function around data.table() is able to read and interpret those dummy
> files.
> Link <https://cran.r-project.org/web/checks/check_results_GGIR.html> to
> CRAN results
> Link <https://travis-ci.org/wadpac/GGIR> to Travis-CI page for the package
>
> I have a local Windows and Linux machine, but for OSx testing I depend on
> Travis-CI.
>
> Thanks,
> Vincent
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From v|ncentv@nhee@ @end|ng |rom gm@||@com  Fri Sep 13 13:44:18 2019
From: v|ncentv@nhee@ @end|ng |rom gm@||@com (Vincent van Hees)
Date: Fri, 13 Sep 2019 13:44:18 +0200
Subject: [R-pkg-devel] My test passes in OSx on Travis,
 but not in OSx on CRAN
In-Reply-To: <12ffca2c-3267-18c8-b1f1-a17857b12ce0@gmail.com>
References: <CALnEB15V0f2j+rXkB4p3L0QQ55ZXw9dZCtGGerKUG7aWeGagOQ@mail.gmail.com>
 <12ffca2c-3267-18c8-b1f1-a17857b12ce0@gmail.com>
Message-ID: <CALnEB14+QqLES2uTVfP6nTi12BvZb+M9DR4xD6Q1HW=N4_wB1g@mail.gmail.com>

Thanks Tomas for your quick response, that sounds like a very plausible
explanation.
I will make those corrections and will start prepare a new release.
Best, Vincent



On Fri, 13 Sep 2019 at 13:30, Tomas Kalibera <tomas.kalibera at gmail.com>
wrote:

> The error seems to be because you are trying to write to the user's home
> directory. This is not allowed. Probably by accident your test creates
> "~/testcsv4.csv" (the same problem is present for other test files).
>
> Best
> Tomas
>
> On 9/13/19 1:21 PM, Vincent van Hees wrote:
> > Dear all,
> >
> > I have a test in my R package that passes in OSx on Travis-CI, but it
> does
> > not pass in OSx on CRAN. What does pass on both CRAN and Travis are the
> > Linux tests. Also, on CRAN the Windows flavor passes. So, there seems to
> be
> > an issue specific to the combination OSx and CRAN.
> >
> > The easiest solution for me would be to add 'skip_on_cran()' at the top
> of
> > the test, but that would blind me for serious issues (if any). I already
> > made sure that the seeds are set before random number generators and that
> > value checks are limited to 3 decimal places to deal machine precision
> > issues. Does anyone have suggestions for me on what else I can do to
> > investigate this?
> >
> > Link
> > <
> https://github.com/wadpac/GGIR/blob/master/tests/testthat/test_read.myacc.csv.R
> >
> > to the specific test on GitHub. The function that is being tested first
> > creates dummy csv-files with random data and then checks that my wrapper
> > function around data.table() is able to read and interpret those dummy
> > files.
> > Link <https://cran.r-project.org/web/checks/check_results_GGIR.html> to
> > CRAN results
> > Link <https://travis-ci.org/wadpac/GGIR> to Travis-CI page for the
> package
> >
> > I have a local Windows and Linux machine, but for OSx testing I depend on
> > Travis-CI.
> >
> > Thanks,
> > Vincent
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>
>

	[[alternative HTML version deleted]]


From rub@k @end|ng |rom m@th@@@u@dk  Fri Sep 13 13:54:00 2019
From: rub@k @end|ng |rom m@th@@@u@dk (Ege Rubak)
Date: Fri, 13 Sep 2019 13:54:00 +0200
Subject: [R-pkg-devel] GSL update on CRAN
In-Reply-To: <web-5602499@be1.uni-freiburg.de>
References: <web-5884323@be2.uni-freiburg.de> <web-5602499@be1.uni-freiburg.de>
Message-ID: <cbe05f50-eae0-15b0-7f06-92da4b388ad7@math.aau.dk>

Hi,

It may be a big task to ship all of GSL with your R package, and since 
it is a large standard library which is "easy" to install on most 
systems, I doubt that it's worth the effort. I would recommend putting 
`GSL (>=2.3)` in `SystemRequirements` in your DESCRIPTION file.

As you point out, this requires that the CRAN team can find the time to 
update GSL on their machines. Uwe often sees things on this list, so you 
may be lucky that he replies directly when he has time (the CRAN people 
tend to have busy day jobs also).

If you don't hear anything on this list in the near future you could 
also try to submit your package to CRAN with the message that you are 
aware that it fails on their Windows machines due to an old version of 
GSL which you would like to be updated if possible. If done in a 
respectful manner I think this should be OK and not wasting their time, 
but others on this list may have better suggestions of how to approach 
this issue.

Best wishes,
Ege

On 11/09/2019 11.49, Raphael Hartmann wrote:
> Hi,
> 
> I hope you don't mind me asking again:
> Does anybody have an idea on how to implement the whole GSL library in
> my package? I was not able to find sth. on Google.
> 
> Whom should I contact for asking whether it is possible to update GSL
> for Windows on CRAN? There were no warnings or errors in the CRAN
> checks for debian. For Windows on CRAN, the compiler gives only an
> error where a GSL routine of version 2.3 is used.
> 
> Best wishes
> Raphael
> 
> 
> 
> On Fri, 06 Sep 2019 08:19:37 +0200
>   "Raphael Hartmann" <raphael.hartmann at psychologie.uni-freiburg.de>
> wrote:
>>
>> Hello,
>>
>> I developed an R package that requires at least version 2.3 of GSL
>> (ftp://ftp.gnu.org/gnu/gsl/). The newest version is 2.6.
>>
>> Version 2.3 is now available for over two years, and I was wondering
>> whether it was possible to update GSL on the win-builder? I would
>> really appreciate it. Without it my package will be rejected on CRAN.
>>
>> Or is there an option to include the whole GSL library in the package?
>>
>> On my machines (two debian based and one Windows server 16 and one
>> Windows 10) the package passes the checks of "R CMD check --as-cran".
>> On builder.r-hub.io with Windows server 12 it is also successful.
>>
>> I would be glad for any advice / suggestions / hints.
>>
>>
>> Best wishes
>> Raphael
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> --------------------------------------------------------------
> Albert-Ludwigs-Universit?t Freiburg
> Institute of Psychology, Cognition, Action, and Sustainability
> Engelbergerstrasse 41
> D-79085 Freiburg
> Phone: +49 761 203 2465
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From gor@n@bro@trom @end|ng |rom umu@@e  Fri Sep 13 14:50:36 2019
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Fri, 13 Sep 2019 14:50:36 +0200
Subject: [R-pkg-devel] R, BLAS, and FCLEN (solved, really!)
In-Reply-To: <e1781923-5338-5ca6-7cea-4ef9f73a7bf0@umu.se>
References: <aa335279-734d-6ac8-e957-5070768201c5@umu.se>
 <2d39dac4-0094-374e-d2d2-2cc12773835d@umu.se>
 <8a0ca051-46dd-ba3c-4359-f7305b5e13ca@umu.se>
 <23929.61460.289420.590627@stat.math.ethz.ch>
 <ca2eca43-4312-ef67-327c-b76fa5c1af7f@umu.se>
 <7bf530a9-cc0e-5ced-9a4d-11ee9891ee77@gmail.com>
 <e1781923-5338-5ca6-7cea-4ef9f73a7bf0@umu.se>
Message-ID: <e2bad0ce-e693-4b92-29ef-d2647a7f9316@umu.se>



On 2019-09-13 12:34, G?ran Brostr?m wrote:
> Dear Tomas,
> 
> your explanation matches exactly my expectation, but not my experience. 
> I uploaded (to CRAN) version 2.7.5 yesterday, and there I use, in? the 
> Fortran function gmlfun, directly called by .Fortran:
> 
>  ????? call cdgemv(trans, nn, antcov, one, covar, nn, beta, ione, one,
>  ???? &???? score, ione)
> 
> that is, the C wrapper of dgemv (my home-brew)
> 
> No warnings from R-devel CMD check --as-cran, and when installed it runs 
> fine.
> 
> However, if I change that call to
> 
>  ?????? call dgemv(trans, nn, antcov, one, covar, nn, beta, ione, one,
>  ???? &???? score, ione)
> 
> that is, a direct call to the Fortran subroutine dgemv, I get, from 
> R-devel CMD check --as-cran,
> 
> gmlfun.f:224:1: warning: type of ?dgemv? does not match original 
> declaration [-Wlto-type-mismatch]
>  ????? &???? score, ione)
>  ?^
> /home/gobr0002/R/src/R-devel/include/R_ext/BLAS.h:107:1: note: type 
> mismatch in parameter 12
>  ?F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>  ?^

This error message was triggered by my mistake in the change from cdgemv 
to dgemv: I forgot to change 'trans' back from type INTEGER to 
CHARACTER. Our final conclusion (for now) is then:

Yes, you can call BLAS subroutines directly from Fortran code, even in 
packages! Many thanks to Tomas!

Excuse my confusion,

G,

> 
> and when I install and run, I get error:
> 
>  > library(eha)
> Loading required package: survival
>  > fit <- coxreg(Surv(enter, exit, event) ~ ses, data = mort, geometric 
> = TRUE)
> Error in geome.fit(X, Y, rs, strats, offset, init, max.survs, method,? :
>  ? BLAS/LAPACK routine 'DGEMV ' gave error code -1
>  >
>  > sessionInfo()
> R version 3.6.1 (2019-07-05)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Ubuntu 19.04
> ...
> Matrix products: default
> BLAS:?? /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.8.0
> LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.8.0
> ...
> Other attached packages:
> [1] eha_2.7.5.1000??? survival_2.44-1.1
> -------------
> 
> To summarize: The calls from C code are fixed and work fine. Direct call 
> from fortran "level 1" gives error, from "level 2" is fine. "level 1" is 
> fortran code directly called by .Fortran, "level 2" is fortran code 
> called from fortran code called by .Fortran.
> 
> This was done with
> 
> R Under development (unstable) (2019-08-31 r77115). I could try a more 
> recent version of R-devel.
> 
> About a 'small reproducible example': It is not that easy to shrink the 
> eha package to include only the relevant fortran code, since there are 
> subtle interdependencies in the package code. It would take a 
> considerable amount of time (for me) to create that package.
> I can make eha_2.7.5.tar.gz available, but it was sent in to CRAN 
> yesterday.
> 
> G?ran
> 
> On 2019-09-13 11:07, Tomas Kalibera wrote:
>> Dear G?ran,
>>
>> I can reproduce the problem with eha version 2.6.0. The reason for the 
>> type mismatch, and hence the LTO warning, is _not_ the calls to dgemv 
>> from Fortran code, but the calls to dgemv from the C code from the 
>> other source files in your package. There is no need to go through 
>> wrappers when calling dgemv from Fortran (as long as both modules are 
>> compiled with the same compiler, or with compatible compilers).
>>
>> When you fix all the calls to dgemv in your C source files to use 
>> "FCONE", as documented in WRE, the warning about the call to dgemv 
>> from geomsup.f will go away (yes, the warnings from the LTO 
>> linker/compiler are confusing). There is no need for creating any 
>> wrappers for BLAS/LAPACK calls.
>>
>> One can check that the generated calls from the Fortran are correct 
>> e.g. via compiling with -fdump-tree-all and then dumping
>> $ egrep -e '(^;;)|(dgemv)' eha.so.ltrans0.232t.optimized | grep dgemv -B1
>> (the file name above will depend on the exact version of your compiler)
>>
>> ;; Function d2_loglik_ph (d2_loglik_ph, funcdef_no=77, decl_uid=4474, 
>> cgraph_uid=103, symbol_order=990)
>> ?? dgemv_ (&trans, mb_497(D), nn_499(D), &alf, z_502(D), mb_497(D), 
>> b_503(D), &one, &Rf_beta, ezb_501, &one);
>> -- 
>> ;; Function d2_loglik_phexp (d2_loglik_phexp, funcdef_no=87, 
>> decl_uid=4470, cgraph_uid=100, symbol_order=1108)
>> ?? dgemv_ (&trans, mb_253(D), nn_255(D), &alf, z_258(D), mb_253(D), 
>> b_259(D), &one, &Rf_beta, ezb_257, &one);
>> -- 
>> ;; Function gmlfun (gmlfun_, funcdef_no=98, decl_uid=4484, 
>> cgraph_uid=108, symbol_order=874)
>> ?? dgemv_ (&"N"[1]{lb: 1 sz: 1}, nn_68(D), antcov_63(D), &C.7966, 
>> covar_83(D), nn_68(D), beta_84(D), &C.7965, &C.7964, score_81(D), 
>> &C.7963, 1);
>> -- 
>> ;; Function geomsup (geomsup_, funcdef_no=116, decl_uid=4498, 
>> cgraph_uid=117, symbol_order=823)
>> ?? dgemv_ (&"N"[1]{lb: 1 sz: 1}, nn_55(D), antcov_51(D), &C.9626, 
>> covar_89(D), nn_55(D), startbeta_83(D), &C.9625, &C.9624, score_87(D), 
>> &C.9623, 1);
>> -- 
>> ;; Function sup (sup, funcdef_no=128, decl_uid=4335, cgraph_uid=7, 
>> symbol_order=1772)
>> ?? dgemv_ (&trans, &nn, &p, &one, covar_281(D), &nn, beta_340(D), 
>> &ione, &one, score_230, &ione);
>>
>> You can see that the calls to dgemv from gmlfun and geomsup are fine 
>> (from Fortran code), the other are bad (from C code).? Indeed, one 
>> would have found out also by creating a minimal reproducible example - 
>> it is always useful, even when not attempting to report a bug.
>>
>> Best
>> Tomas
>>
>> On 9/13/19 12:07 AM, G?ran Brostr?m wrote:
>>>
>>>
>>> On 2019-09-12 09:13, Martin Maechler wrote:
>>>>>>>>> G?ran Brostr?m
>>>>>>>>> ???? on Wed, 11 Sep 2019 13:36:40 +0200 writes:
>>>>
>>>> ???? > A followup question: Is it possible to call a BLAS/LAPACK 
>>>> subroutine,
>>>> ???? > where one parameter is character, from FORTRAN (77) code 
>>>> called by
>>>> ???? > .Fortran? (No problem "in the past".)
>>>>
>>>> [as there wasn't a reply till now : ]
>>>>
>>>> Yes, that should continue to be possible.
>>>>
>>>> ???? > And if yes, how?
>>>>
>>>> I'm sorry I don't know (and currently lack the time to try to find 
>>>> out)...
>>>
>>> I solved it by writing a C wrapper (for the BLAS subroutine dgemv) 
>>> cdgemv:
>>>
>>> #define USE_FC_LEN_T
>>> #include <Rconfig.h>
>>> #include <R_ext/BLAS.h>
>>> #ifndef FCONE
>>> # define FCONE
>>> #endif
>>> #include <R.h>
>>> #include "cdgemv.h"
>>>
>>> void F77_SUB(cdgemv)(const int *trans, const int *m, const int *n,
>>> ???????????? const double *alpha, const double *a,
>>> ???????????????????? const int *lda,
>>> ???????????? const double *x, const int *incx,
>>> ???????????????????? const double *beta,
>>> ???????????? double *y, const int *incy){
>>> ?? char trams;
>>>
>>> ?? if (*trans == 1){
>>> ????? trams = 'N';
>>> ????? F77_CALL(dgemv)(&trams, m, n, alpha, a, lda, x, incx, beta, y,
>>> ????????????????????? incy FCONE);
>>> ?? }else
>>> ????? Rprintf("trans has wrong value\n");
>>> ?? }
>>> }
>>>
>>> which I call from Fortran. Curiously, a Fortran wrapper also seems to 
>>> work.
>>>
>>> G,
>>>>
>>>> Martin
>>>>
>>>> ???? >?? Documentation describes calls from C to Fortran and
>>>> ???? > vice versa, but not this situation (AFAICS).
>>>>
>>>> ???? > Yes, I know that .Fortran is not well seen these days, but my 
>>>> fortran
>>>> ???? > code is ancient, from the before-R era, and I would like to 
>>>> leave it as-is.
>>>>
>>>> ???? > G,
>>>>
>>>> ???? > Den 2019-09-01 kl. 21:46, skrev G?ran Brostr?m:
>>>> ???? >>
>>>> ???? >>
>>>> ???? >> On 2019-08-31 18:47, G?ran Brostr?m wrote:
>>>> ???? >>> I'm having difficulties updating my package eha: When I run 
>>>> standard
>>>> ???? >>> checks 'at home' everything is fine, but 'CRAN-submissions' 
>>>> reports
>>>> ???? >>> (among other things):
>>>> ???? >>>
>>>> ???? >>> geomsup.f:324:9: warning: type of ?dgemv? does not match 
>>>> original
>>>> ???? >>> declaration [-Wlto-type-mismatch]
>>>> ???? >>> ?? 324 |????? &???? one, score, ione)
>>>> ???? >>> ?????? |???????? ^
>>>> ???? >>> /home/tmp/R-d-gcc-LTO/include/R_ext/BLAS.h:107:1: note: 
>>>> type mismatch
>>>> ???? >>> in parameter 12
>>>> ???? >>> ?? 107 | F77_NAME(dgemv)(const char *trans, const int *m, 
>>>> const int *n,
>>>> ???? >>> ?????? | ^
>>>> ???? >>>
>>>> ???? >>> This is odd since the LAPACK subroutine dgemv takes only 11
>>>> ???? >>> parameters. However, in include/R_ext/BLAS.h we have
>>>> ???? >>>
>>>> ???? >>> F77_NAME(dgemv)(const char *trans, const int *m, const int *n,
>>>> ???? >>> ???????? const double *alpha, const double *a, const int *lda,
>>>> ???? >>> ???????? const double *x, const int *incx, const double *beta,
>>>> ???? >>> ???????? double *y, const int *incy FCLEN);
>>>> ???? >>>
>>>> ???? >>> with a 12th parameter FCLEN?? How am I supposed to fix 
>>>> this, and what
>>>> ???? >>> the ... is FCLEN? googling leads to nothing useful (for 
>>>> me). It seems
>>>> ???? >>> as if R is redefining some standard LAPACK routines.
>>>> ???? >>>
>>>> ???? >>> Also a note I do not understand (in this context):
>>>> ???? >>>
>>>> ???? >>> note: type ?void? should match type ?long int?
>>>> ???? >>>
>>>> ???? >>> Any help is much appreciated.
>>>> ???? >>>
>>>> ???? >>> Best, G?ran
>>>> ???? >>>
>>>> ???? >>> PS. How can I trigger these Warnings 'at home'?
>>>> ???? >>
>>>> ???? >> See https://www.stats.ox.ac.uk/pub/bdr/LTO/README.txt 
>>>> (thanks to Uwe
>>>> ???? >> Ligges).
>>>> ???? >>
>>>> ???? >> Another relevant document seems to be (2019-05-15):
>>>> ???? >>
>>>> ???? >> 
>>>> https://developer.r-project.org/Blog/public/2019/05/15/gfortran-issues-with-lapack/index.html 
>>>>
>>>> ???? >>
>>>> ???? >>
>>>> ???? >> First sentence:
>>>> ???? >> "Recent version of the GNU Fortran compiler (7, 8, 9) include
>>>> ???? >> optimizations that break interoperability between C and 
>>>> Fortran code
>>>> ???? >> with BLAS/LAPACK."
>>>> ???? >>
>>>> ???? >> And later:
>>>> ???? >> "For the time being, everyone should use 
>>>> -fno-optimize-sibling-calls
>>>> ???? >> with GFortran version 7 and newer."
>>>> ???? >>
>>>> ???? >> G,
>>>> ???? >>
>>>> ???? >>> ______________________________________________
>>>> ???? >>> R-package-devel at r-project.org mailing list
>>>> ???? >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>> ???? >>
>>>> ???? >> ______________________________________________
>>>> ???? >> R-package-devel at r-project.org mailing list
>>>> ???? >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>> ???? > ______________________________________________
>>>> ???? > R-package-devel at r-project.org mailing list
>>>> ???? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From r@ph@e|@h@rtm@nn @end|ng |rom p@ycho|og|e@un|-|re|burg@de  Fri Sep 13 15:17:21 2019
From: r@ph@e|@h@rtm@nn @end|ng |rom p@ycho|og|e@un|-|re|burg@de (Raphael Hartmann)
Date: Fri, 13 Sep 2019 15:17:21 +0200
Subject: [R-pkg-devel] GSL update on CRAN
In-Reply-To: <cbe05f50-eae0-15b0-7f06-92da4b388ad7@math.aau.dk>
References: <web-5884323@be2.uni-freiburg.de> <web-5602499@be1.uni-freiburg.de>
 <cbe05f50-eae0-15b0-7f06-92da4b388ad7@math.aau.dk>
Message-ID: <web-5625577@be1.uni-freiburg.de>

Hi Ege

Thank you for your answer.

I also think it won't be easy to build it in my package. The hint with
the description file is a good one. Does that get read automatically?
So far, I had the following line 'SystemRequirements: GNU Scientific
Library version >= 2.5' (at that time I was not aware that it needs
only version 2.3). Of course my package got rejected on CRAN when I
tried to upload it.

I can imagine that they all don't have much time. That means I can only
wait and see what happens.

Maybe at some point I will try to upload the package with a kind
message, as you suggested.

Thank you very much for all the hints.


Best wishes
Raphael

On Fri, 13 Sep 2019 13:54:00 +0200
 Ege Rubak <rubak at math.aau.dk> wrote:
>Hi,
>
>It may be a big task to ship all of GSL with your R package, and since
>it is a large standard library which is "easy" to install on most
>systems, I doubt that it's worth the effort. I would recommend putting
>`GSL (>=2.3)` in `SystemRequirements` in your DESCRIPTION file.
>
>As you point out, this requires that the CRAN team can find the time
>to update GSL on their machines. Uwe often sees things on this list,
>so you may be lucky that he replies directly when he has time (the
>CRAN people tend to have busy day jobs also).
>
>If you don't hear anything on this list in the near future you could
>also try to submit your package to CRAN with the message that you are
>aware that it fails on their Windows machines due to an old version of
>GSL which you would like to be updated if possible. If done in a
>respectful manner I think this should be OK and not wasting their
>time, but others on this list may have better suggestions of how to
>approach this issue.
>
>Best wishes,
>Ege
>
>On 11/09/2019 11.49, Raphael Hartmann wrote:
>> Hi,
>> 
>> I hope you don't mind me asking again:
>> Does anybody have an idea on how to implement the whole GSL library
>in
>> my package? I was not able to find sth. on Google.
>> 
>> Whom should I contact for asking whether it is possible to update
>GSL
>> for Windows on CRAN? There were no warnings or errors in the CRAN
>> checks for debian. For Windows on CRAN, the compiler gives only an
>> error where a GSL routine of version 2.3 is used.
>> 
>> Best wishes
>> Raphael
>> 
>> 
>> 
>> On Fri, 06 Sep 2019 08:19:37 +0200
>>   "Raphael Hartmann" <raphael.hartmann at psychologie.uni-freiburg.de>
>> wrote:
>>>
>>> Hello,
>>>
>>> I developed an R package that requires at least version 2.3 of GSL
>>> (ftp://ftp.gnu.org/gnu/gsl/). The newest version is 2.6.
>>>
>>> Version 2.3 is now available for over two years, and I was
>wondering
>>> whether it was possible to update GSL on the win-builder? I would
>>> really appreciate it. Without it my package will be rejected on
>CRAN.
>>>
>>> Or is there an option to include the whole GSL library in the
>package?
>>>
>>> On my machines (two debian based and one Windows server 16 and one
>>> Windows 10) the package passes the checks of "R CMD check
>--as-cran".
>>> On builder.r-hub.io with Windows server 12 it is also successful.
>>>
>>> I would be glad for any advice / suggestions / hints.
>>>
>>>
>>> Best wishes
>>> Raphael
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> 
>> --------------------------------------------------------------
>> Albert-Ludwigs-Universit?t Freiburg
>> Institute of Psychology, Cognition, Action, and Sustainability
>> Engelbergerstrasse 41
>> D-79085 Freiburg
>> Phone: +49 761 203 2465
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

--------------------------------------------------------------
Albert-Ludwigs-Universit?t Freiburg
Institute of Psychology, Cognition, Action, and Sustainability
Engelbergerstrasse 41
D-79085 Freiburg
Phone: +49 761 203 2465


From cht@n|gut| @end|ng |rom u@p@br  Fri Sep 13 16:15:07 2019
From: cht@n|gut| @end|ng |rom u@p@br (Cristiane Hayumi Taniguti)
Date: Fri, 13 Sep 2019 11:15:07 -0300
Subject: [R-pkg-devel] How reproduce CRAN check
Message-ID: <CAGnmNJy9Z9AnZUrs+Z94gRE7JSiho=UQe1zQUOHQ3k85Dt+wpA@mail.gmail.com>

I'm having difficulties updating my package onemap: When I run standard
checks as --as-cran in linux, winbuilder and using docker images everything
is fine, but 'CRAN-submissions' reports this problem in my c++ code:

onemap.Rcheck/onemap-Ex.Rout:
.............../usr/local/bin/../include/c++/v1/memory:1825:35: runtime
error: nan is outside the range of representable values of type 'int'
onemap.Rcheck/onemap-Ex.Rout:twopts_out.cpp:147:7: runtime error: nan is
outside the range of representable values of type 'int'
onemap.Rcheck/onemap-Ex.Rout:twopts_out.cpp:147:26: runtime error: nan
is outside the range of representable values of type 'int'
onemap.Rcheck/onemap-Ex.Rout:
...........................twopts_f2.cpp:101:7: runtime error: nan is
outside the range of representable values of type 'int'
onemap.Rcheck/onemap-Ex.Rout:twopts_f2.cpp:101:26: runtime error: nan is
outside the range of representable values of type 'int'

This problem was there in the last CRAN version of my package too  <
https://www.stats.ox.ac.uk/pub/bdr/memtests/clang-UBSAN/onemap>

I am having a hard time trying to reproduce this error "at home" and fix
the problem. Without reproduce this I am not able to find what is causing
the nan in my code.

Here <https://drive.google.com/open?id=1L9Qcz9qraZOo-jaq-fwkF-PQfmg73mSv> is
the new version source package

Any help is much appreciated.

Cris

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Sep 13 16:39:51 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 13 Sep 2019 10:39:51 -0400
Subject: [R-pkg-devel] How reproduce CRAN check
In-Reply-To: <CAGnmNJy9Z9AnZUrs+Z94gRE7JSiho=UQe1zQUOHQ3k85Dt+wpA@mail.gmail.com>
References: <CAGnmNJy9Z9AnZUrs+Z94gRE7JSiho=UQe1zQUOHQ3k85Dt+wpA@mail.gmail.com>
Message-ID: <10d9d6ab-fa3e-9381-b23e-09b4c2ac38ec@gmail.com>

On 13/09/2019 10:15 a.m., Cristiane Hayumi Taniguti wrote:
> I'm having difficulties updating my package onemap: When I run standard
> checks as --as-cran in linux, winbuilder and using docker images everything
> is fine, but 'CRAN-submissions' reports this problem in my c++ code:
> 
> onemap.Rcheck/onemap-Ex.Rout:
> .............../usr/local/bin/../include/c++/v1/memory:1825:35: runtime
> error: nan is outside the range of representable values of type 'int'
> onemap.Rcheck/onemap-Ex.Rout:twopts_out.cpp:147:7: runtime error: nan is
> outside the range of representable values of type 'int'
> onemap.Rcheck/onemap-Ex.Rout:twopts_out.cpp:147:26: runtime error: nan
> is outside the range of representable values of type 'int'
> onemap.Rcheck/onemap-Ex.Rout:
> ...........................twopts_f2.cpp:101:7: runtime error: nan is
> outside the range of representable values of type 'int'
> onemap.Rcheck/onemap-Ex.Rout:twopts_f2.cpp:101:26: runtime error: nan is
> outside the range of representable values of type 'int'
> 
> This problem was there in the last CRAN version of my package too  <
> https://www.stats.ox.ac.uk/pub/bdr/memtests/clang-UBSAN/onemap>
> 
> I am having a hard time trying to reproduce this error "at home" and fix
> the problem. Without reproduce this I am not able to find what is causing
> the nan in my code.
> 
> Here <https://drive.google.com/open?id=1L9Qcz9qraZOo-jaq-fwkF-PQfmg73mSv> is
> the new version source package

I would add some kind of Rprintf statement near line 101 of 
twopts_f2.cpp to show the value that you are apparently trying to coerce 
to int at that point.  Apparently it is sometimes equal to NaN, and this 
is being caught in the CRAN checks, but not in yours.  That might be 
because they are doing more stringent checks (UBSAN is very stringent), 
or it might be that the value is actually different on their system.

Duncan Murdoch


From henr|k@bengt@@on @end|ng |rom gm@||@com  Fri Sep 13 16:43:11 2019
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Fri, 13 Sep 2019 07:43:11 -0700
Subject: [R-pkg-devel] How reproduce CRAN check
In-Reply-To: <CAGnmNJy9Z9AnZUrs+Z94gRE7JSiho=UQe1zQUOHQ3k85Dt+wpA@mail.gmail.com>
References: <CAGnmNJy9Z9AnZUrs+Z94gRE7JSiho=UQe1zQUOHQ3k85Dt+wpA@mail.gmail.com>
Message-ID: <CAFDcVCQy-fx3OQPrEuY+85YBAy_oBGOTxSz+dML4fh36MCZ8gw@mail.gmail.com>

As first step of being able to reproduce the error, have a look at
R-Hub (https://blog.r-hub.io/2019/03/26/why-care/).  It'll allow you
to use their servers to test your package on many different
configurations.  It helped me several times. You can launch it all
from you local R prompt, e.g.

> rhub::check()

?? Choose build platform

 1: Debian Linux, R-devel, clang, ISO-8859-15 locale (debian-clang-devel)
 2: Debian Linux, R-devel, GCC (debian-gcc-devel)
 3: Debian Linux, R-devel, GCC, no long double (debian-gcc-devel-nold)
 4: Debian Linux, R-patched, GCC (debian-gcc-patched)
 5: Debian Linux, R-release, GCC (debian-gcc-release)
 6: Fedora Linux, R-devel, clang, gfortran (fedora-clang-devel)
 7: Fedora Linux, R-devel, GCC (fedora-gcc-devel)
 8: CentOS 6, stock R from EPEL (linux-x86_64-centos6-epel)
 9: CentOS 6 with Redhat Developer Toolset, R from EPEL
(linux-x86_64-centos6-epel-rdt)
10: Debian Linux, R-devel, GCC ASAN/UBSAN (linux-x86_64-rocker-gcc-san)
11: macOS 10.11 El Capitan, R-release (experimental) (macos-elcapitan-release)
12: Oracle Solaris 10, x86, 32 bit, R-patched (experimental)
(solaris-x86-patched)
13: Ubuntu Linux 16.04 LTS, R-devel, GCC (ubuntu-gcc-devel)
14: Ubuntu Linux 16.04 LTS, R-release, GCC (ubuntu-gcc-release)
15: Ubuntu Linux 16.04 LTS, R-devel with rchk (ubuntu-rchk)
16: Windows Server 2008 R2 SP1, R-devel, 32/64 bit (windows-x86_64-devel)
17: Windows Server 2012, R-devel, Rtools4.0, 32/64 bit (experimental)
(windows-x86_64-devel-rtools4)
18: Windows Server 2008 R2 SP1, R-oldrel, 32/64 bit (windows-x86_64-oldrel)
19: Windows Server 2008 R2 SP1, R-patched, 32/64 bit (windows-x86_64-patched)
20: Windows Server 2008 R2 SP1, R-release, 32/64 bit (windows-x86_64-release)

Selection: 10

/Henrik

PS. "Google Drive"; the sooner you migrate to Git and an online Git
repos (GitHub, Gitlab, Bitbucket, ...) the sooner you'll thank
yourself for doing so and saving yourself lots of time. The world of
continuous integration (read "automagic instant R CMD check on Linux,
macOS, WIndows - for free in the cloud") will also open up to you.

On Fri, Sep 13, 2019 at 7:15 AM Cristiane Hayumi Taniguti
<chtaniguti at usp.br> wrote:
>
> I'm having difficulties updating my package onemap: When I run standard
> checks as --as-cran in linux, winbuilder and using docker images everything
> is fine, but 'CRAN-submissions' reports this problem in my c++ code:
>
> onemap.Rcheck/onemap-Ex.Rout:
> .............../usr/local/bin/../include/c++/v1/memory:1825:35: runtime
> error: nan is outside the range of representable values of type 'int'
> onemap.Rcheck/onemap-Ex.Rout:twopts_out.cpp:147:7: runtime error: nan is
> outside the range of representable values of type 'int'
> onemap.Rcheck/onemap-Ex.Rout:twopts_out.cpp:147:26: runtime error: nan
> is outside the range of representable values of type 'int'
> onemap.Rcheck/onemap-Ex.Rout:
> ...........................twopts_f2.cpp:101:7: runtime error: nan is
> outside the range of representable values of type 'int'
> onemap.Rcheck/onemap-Ex.Rout:twopts_f2.cpp:101:26: runtime error: nan is
> outside the range of representable values of type 'int'
>
> This problem was there in the last CRAN version of my package too  <
> https://www.stats.ox.ac.uk/pub/bdr/memtests/clang-UBSAN/onemap>
>
> I am having a hard time trying to reproduce this error "at home" and fix
> the problem. Without reproduce this I am not able to find what is causing
> the nan in my code.
>
> Here <https://drive.google.com/open?id=1L9Qcz9qraZOo-jaq-fwkF-PQfmg73mSv> is
> the new version source package
>
> Any help is much appreciated.
>
> Cris
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From |uc@r @end|ng |rom |edor@project@org  Fri Sep 13 17:35:29 2019
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Fri, 13 Sep 2019 17:35:29 +0200
Subject: [R-pkg-devel] How reproduce CRAN check
In-Reply-To: <CAGnmNJy9Z9AnZUrs+Z94gRE7JSiho=UQe1zQUOHQ3k85Dt+wpA@mail.gmail.com>
References: <CAGnmNJy9Z9AnZUrs+Z94gRE7JSiho=UQe1zQUOHQ3k85Dt+wpA@mail.gmail.com>
Message-ID: <CALEXWq3JL7rwZYRxWHPBnBAkQC5PPYhupS5duYoPvnbK9xoE+w@mail.gmail.com>

On Fri, 13 Sep 2019 at 16:16, Cristiane Hayumi Taniguti
<chtaniguti at usp.br> wrote:
>
> ...........................twopts_f2.cpp:101:7: runtime error: nan is
> outside the range of representable values of type 'int'
> onemap.Rcheck/onemap-Ex.Rout:twopts_f2.cpp:101:26: runtime error: nan is
> outside the range of representable values of type 'int'

Here: https://github.com/augusto-garcia/onemap/blob/master/src/twopts_f2.cpp#L101
-> k1=segreg_type(i); k2=segreg_type(j);

k1 and k2 are vectors of integers, but segreg_type is a NumericVector
(double), which may contain NaN.

I?aki


From john@m@h@rro|d @end|ng |rom gm@||@com  Sat Sep 14 03:33:20 2019
From: john@m@h@rro|d @end|ng |rom gm@||@com (John Harrold)
Date: Fri, 13 Sep 2019 18:33:20 -0700
Subject: [R-pkg-devel] Number of cores in examples
Message-ID: <CANAiAiXKCD2gd0mU_zUgn96zT3L3hY=Voqc_1FAv+8+-hqghLA@mail.gmail.com>

Hello,

I recently submitted a package for consideration in CRAN. One of the
comments was:

Please ensure that you do not use more than 2 cores in your examples.

I do not believe my package does this. Is this a general comment for a
package that requires doParallel or was this triggered because one of my
examples actually used more than 2 cores?

Thanks
John
-- 
John
:wq

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sat Sep 14 07:51:53 2019
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sat, 14 Sep 2019 07:51:53 +0200
Subject: [R-pkg-devel] Number of cores in examples
In-Reply-To: <CANAiAiXKCD2gd0mU_zUgn96zT3L3hY=Voqc_1FAv+8+-hqghLA@mail.gmail.com>
References: <CANAiAiXKCD2gd0mU_zUgn96zT3L3hY=Voqc_1FAv+8+-hqghLA@mail.gmail.com>
Message-ID: <65f676f0-e507-7eb5-c665-44e2b8050a65@statistik.tu-dortmund.de>



On 14.09.2019 03:33, John Harrold wrote:
> Hello,
> 
> I recently submitted a package for consideration in CRAN. One of the
> comments was:
> 
> Please ensure that you do not use more than 2 cores in your examples.
> 
> I do not believe my package does this. Is this a general comment for a
> package that requires doParallel or was this triggered because one of my
> examples actually used more than 2 cores?

The latter. In examples, vignettes and tests you must not start more 
than 2 workers as resources for CRAN checks are limited.

Best,
Uwe Ligges


> 
> Thanks
> John
>


From john@m@h@rro|d @end|ng |rom gm@||@com  Sun Sep 15 05:39:55 2019
From: john@m@h@rro|d @end|ng |rom gm@||@com (John Harrold)
Date: Sat, 14 Sep 2019 20:39:55 -0700
Subject: [R-pkg-devel] Number of cores in examples
In-Reply-To: <65f676f0-e507-7eb5-c665-44e2b8050a65@statistik.tu-dortmund.de>
References: <CANAiAiXKCD2gd0mU_zUgn96zT3L3hY=Voqc_1FAv+8+-hqghLA@mail.gmail.com>
 <65f676f0-e507-7eb5-c665-44e2b8050a65@statistik.tu-dortmund.de>
Message-ID: <CANAiAiXEXiU7iF-1TEu_mcSr0igrv5N6A+uxh_BW-wcYJvfmTg@mail.gmail.com>

Thanks Uwe,

Is there a way to find out on my end where this is happening?

Thanks
john

On Fri, Sep 13, 2019 at 10:51 PM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

>
>
> On 14.09.2019 03:33, John Harrold wrote:
> > Hello,
> >
> > I recently submitted a package for consideration in CRAN. One of the
> > comments was:
> >
> > Please ensure that you do not use more than 2 cores in your examples.
> >
> > I do not believe my package does this. Is this a general comment for a
> > package that requires doParallel or was this triggered because one of my
> > examples actually used more than 2 cores?
>
> The latter. In examples, vignettes and tests you must not start more
> than 2 workers as resources for CRAN checks are limited.
>
> Best,
> Uwe Ligges
>
>
> >
> > Thanks
> > John
> >
>


-- 
John
:wq

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sun Sep 15 09:42:57 2019
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sun, 15 Sep 2019 09:42:57 +0200
Subject: [R-pkg-devel] Number of cores in examples
In-Reply-To: <CANAiAiXEXiU7iF-1TEu_mcSr0igrv5N6A+uxh_BW-wcYJvfmTg@mail.gmail.com>
References: <CANAiAiXKCD2gd0mU_zUgn96zT3L3hY=Voqc_1FAv+8+-hqghLA@mail.gmail.com>
 <65f676f0-e507-7eb5-c665-44e2b8050a65@statistik.tu-dortmund.de>
 <CANAiAiXEXiU7iF-1TEu_mcSr0igrv5N6A+uxh_BW-wcYJvfmTg@mail.gmail.com>
Message-ID: <1ea869d5-e221-a870-59a1-de38a215dea0@statistik.tu-dortmund.de>



On 15.09.2019 05:39, John Harrold wrote:
> Thanks Uwe,
> 
> Is there a way to find out on my end where this is happening?

Yes, simply set the env var
_R_CHECK_LIMIT_CORES_=true
to reproduce.

Best,
Uwe

> 
> Thanks
> john
> 
> On Fri, Sep 13, 2019 at 10:51 PM Uwe Ligges 
> <ligges at statistik.tu-dortmund.de 
> <mailto:ligges at statistik.tu-dortmund.de>> wrote:
> 
> 
> 
>     On 14.09.2019 03:33, John Harrold wrote:
>      > Hello,
>      >
>      > I recently submitted a package for consideration in CRAN. One of the
>      > comments was:
>      >
>      > Please ensure that you do not use more than 2 cores in your examples.
>      >
>      > I do not believe my package does this. Is this a general comment
>     for a
>      > package that requires doParallel or was this triggered because
>     one of my
>      > examples actually used more than 2 cores?
> 
>     The latter. In examples, vignettes and tests you must not start more
>     than 2 workers as resources for CRAN checks are limited.
> 
>     Best,
>     Uwe Ligges
> 
> 
>      >
>      > Thanks
>      > John
>      >
> 
> 
> 
> -- 
> John
> :wq


From john@m@h@rro|d @end|ng |rom gm@||@com  Sun Sep 15 18:31:38 2019
From: john@m@h@rro|d @end|ng |rom gm@||@com (John Harrold)
Date: Sun, 15 Sep 2019 09:31:38 -0700
Subject: [R-pkg-devel] Number of cores in examples
In-Reply-To: <1ea869d5-e221-a870-59a1-de38a215dea0@statistik.tu-dortmund.de>
References: <CANAiAiXKCD2gd0mU_zUgn96zT3L3hY=Voqc_1FAv+8+-hqghLA@mail.gmail.com>
 <65f676f0-e507-7eb5-c665-44e2b8050a65@statistik.tu-dortmund.de>
 <CANAiAiXEXiU7iF-1TEu_mcSr0igrv5N6A+uxh_BW-wcYJvfmTg@mail.gmail.com>
 <1ea869d5-e221-a870-59a1-de38a215dea0@statistik.tu-dortmund.de>
Message-ID: <CANAiAiVwBYMmszgiGQaknL=OqFAy_sGRnkqdrd0X=5=5w-XJhg@mail.gmail.com>

Howdy Folks,

I'm testing this on R-hub, and I've set option in the environment. I put
links to the Windows and Ubuntu outputs below. I've searched for the
obvious (core, parallel, etc), but I'm not really sure what I need to look
for to indicate that more than one core is being used. If someone could
point it out to me I'd be very grateful.

Windows:
https://drive.google.com/file/d/1187cRyrJLFJetaOW3WHL-mLTCTwYxOeG/view?usp=sharing

Ubuntu:
https://drive.google.com/file/d/1XhaKFpaPaRyJLvHuFcbWNyztzYpsLj8r/view?usp=sharing

Thanks
John



On Sun, Sep 15, 2019 at 12:42 AM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

>
>
> On 15.09.2019 05:39, John Harrold wrote:
> > Thanks Uwe,
> >
> > Is there a way to find out on my end where this is happening?
>
> Yes, simply set the env var
> _R_CHECK_LIMIT_CORES_=true
> to reproduce.
>
> Best,
> Uwe
>
> >
> > Thanks
> > john
> >
> > On Fri, Sep 13, 2019 at 10:51 PM Uwe Ligges
> > <ligges at statistik.tu-dortmund.de
> > <mailto:ligges at statistik.tu-dortmund.de>> wrote:
> >
> >
> >
> >     On 14.09.2019 03:33, John Harrold wrote:
> >      > Hello,
> >      >
> >      > I recently submitted a package for consideration in CRAN. One of
> the
> >      > comments was:
> >      >
> >      > Please ensure that you do not use more than 2 cores in your
> examples.
> >      >
> >      > I do not believe my package does this. Is this a general comment
> >     for a
> >      > package that requires doParallel or was this triggered because
> >     one of my
> >      > examples actually used more than 2 cores?
> >
> >     The latter. In examples, vignettes and tests you must not start more
> >     than 2 workers as resources for CRAN checks are limited.
> >
> >     Best,
> >     Uwe Ligges
> >
> >
> >      >
> >      > Thanks
> >      > John
> >      >
> >
> >
> >
> > --
> > John
> > :wq
>


-- 
John
:wq

	[[alternative HTML version deleted]]


From john@m@h@rro|d @end|ng |rom gm@||@com  Sun Sep 15 19:49:42 2019
From: john@m@h@rro|d @end|ng |rom gm@||@com (John Harrold)
Date: Sun, 15 Sep 2019 10:49:42 -0700
Subject: [R-pkg-devel] Number of cores in examples
In-Reply-To: <8cbd9cc5e3294734adb13d910cff96ec@umanitoba.ca>
References: <CANAiAiXKCD2gd0mU_zUgn96zT3L3hY=Voqc_1FAv+8+-hqghLA@mail.gmail.com>
 <65f676f0-e507-7eb5-c665-44e2b8050a65@statistik.tu-dortmund.de>
 <CANAiAiXEXiU7iF-1TEu_mcSr0igrv5N6A+uxh_BW-wcYJvfmTg@mail.gmail.com>
 <1ea869d5-e221-a870-59a1-de38a215dea0@statistik.tu-dortmund.de>
 <CANAiAiVwBYMmszgiGQaknL=OqFAy_sGRnkqdrd0X=5=5w-XJhg@mail.gmail.com>
 <8cbd9cc5e3294734adb13d910cff96ec@umanitoba.ca>
Message-ID: <CANAiAiUiyd1pgn1QZ6jQjrYGhSOUfTy6nfywVpX6mZayQo2qag@mail.gmail.com>

Hello Max,

The comment I received was:

Please ensure that you do not use more than 2 cores in your examples.

I believe the only output I received was these incoming pretest results:

https://win-builder.r-project.org/incoming_pretest/ubiquity_1.0.0_20190821_023712/

Feel free to browse through them.

Thanks
John

On Sun, Sep 15, 2019 at 10:26 AM Max Turgeon <Max.Turgeon at umanitoba.ca>
wrote:

> Hi John,
>
>
> From the R-hub output you shared with us, we can see that you don't get
> the error on Ubuntu with R-devel, nor on Windows with R-3.6.1. When you
> received the original email from CRAN with the check output, on which
> platform did you get the error about using too many cores? Perhaps that
> info could help narrow it down, or at least you would know on which
> platform to test.
>
>
> Max Turgeon
> Assistant Professor
> Department of Statistics
> Department of Computer Science
> University of Manitoba
> maxturgeon.ca
>
>
> ------------------------------
> *From:* R-package-devel <r-package-devel-bounces at r-project.org> on behalf
> of John Harrold <john.m.harrold at gmail.com>
> *Sent:* September 15, 2019 11:31:38 AM
> *To:* Uwe Ligges
> *Cc:* r-package-devel at r-project.org
> *Subject:* Re: [R-pkg-devel] Number of cores in examples
>
> Howdy Folks,
>
> I'm testing this on R-hub, and I've set option in the environment. I put
> links to the Windows and Ubuntu outputs below. I've searched for the
> obvious (core, parallel, etc), but I'm not really sure what I need to look
> for to indicate that more than one core is being used. If someone could
> point it out to me I'd be very grateful.
>
> Windows:
>
> https://drive.google.com/file/d/1187cRyrJLFJetaOW3WHL-mLTCTwYxOeG/view?usp=sharing
>
> Ubuntu:
>
> https://drive.google.com/file/d/1XhaKFpaPaRyJLvHuFcbWNyztzYpsLj8r/view?usp=sharing
>
> Thanks
> John
>
>
>
> On Sun, Sep 15, 2019 at 12:42 AM Uwe Ligges <
> ligges at statistik.tu-dortmund.de>
> wrote:
>
> >
> >
> > On 15.09.2019 05:39, John Harrold wrote:
> > > Thanks Uwe,
> > >
> > > Is there a way to find out on my end where this is happening?
> >
> > Yes, simply set the env var
> > _R_CHECK_LIMIT_CORES_=true
> > to reproduce.
> >
> > Best,
> > Uwe
> >
> > >
> > > Thanks
> > > john
> > >
> > > On Fri, Sep 13, 2019 at 10:51 PM Uwe Ligges
> > > <ligges at statistik.tu-dortmund.de
> > > <mailto:ligges at statistik.tu-dortmund.de
> <ligges at statistik.tu-dortmund.de>>> wrote:
> > >
> > >
> > >
> > >     On 14.09.2019 03:33, John Harrold wrote:
> > >      > Hello,
> > >      >
> > >      > I recently submitted a package for consideration in CRAN. One of
> > the
> > >      > comments was:
> > >      >
> > >      > Please ensure that you do not use more than 2 cores in your
> > examples.
> > >      >
> > >      > I do not believe my package does this. Is this a general comment
> > >     for a
> > >      > package that requires doParallel or was this triggered because
> > >     one of my
> > >      > examples actually used more than 2 cores?
> > >
> > >     The latter. In examples, vignettes and tests you must not start
> more
> > >     than 2 workers as resources for CRAN checks are limited.
> > >
> > >     Best,
> > >     Uwe Ligges
> > >
> > >
> > >      >
> > >      > Thanks
> > >      > John
> > >      >
> > >
> > >
> > >
> > > --
> > > John
> > > :wq
> >
>
>
> --
> John
> :wq
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


-- 
John
:wq

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon Sep 16 03:27:49 2019
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 16 Sep 2019 03:27:49 +0200
Subject: [R-pkg-devel] Number of cores in examples
In-Reply-To: <CANAiAiUiyd1pgn1QZ6jQjrYGhSOUfTy6nfywVpX6mZayQo2qag@mail.gmail.com>
References: <CANAiAiXKCD2gd0mU_zUgn96zT3L3hY=Voqc_1FAv+8+-hqghLA@mail.gmail.com>
 <65f676f0-e507-7eb5-c665-44e2b8050a65@statistik.tu-dortmund.de>
 <CANAiAiXEXiU7iF-1TEu_mcSr0igrv5N6A+uxh_BW-wcYJvfmTg@mail.gmail.com>
 <1ea869d5-e221-a870-59a1-de38a215dea0@statistik.tu-dortmund.de>
 <CANAiAiVwBYMmszgiGQaknL=OqFAy_sGRnkqdrd0X=5=5w-XJhg@mail.gmail.com>
 <8cbd9cc5e3294734adb13d910cff96ec@umanitoba.ca>
 <CANAiAiUiyd1pgn1QZ6jQjrYGhSOUfTy6nfywVpX6mZayQo2qag@mail.gmail.com>
Message-ID: <facc4257-0cf9-12d2-5169-805038f44768@statistik.tu-dortmund.de>

The message came from a CRAN team member, so please ask the CRAN team 
member who found that issue if you cannot work it out. Readers of this 
list cannot help unless reading the sources of your package that you 
have not shared with the list.

Note that CRAN team members may also make mistakes given there are 
dozens of new submissions on a single day.

Best,
Uwe Ligges





On 15.09.2019 19:49, John Harrold wrote:
> Hello Max,
> 
> The comment I received was:
> 
> Please ensure that you do not use more than 2 cores in your examples.
> 
> I believe the only output I received was these incoming pretest results:
> 
> https://win-builder.r-project.org/incoming_pretest/ubiquity_1.0.0_20190821_023712/
> 
> Feel free to browse through them.
> 
> Thanks
> John
> 
> On Sun, Sep 15, 2019 at 10:26 AM Max Turgeon <Max.Turgeon at umanitoba.ca>
> wrote:
> 
>> Hi John,
>>
>>
>>  From the R-hub output you shared with us, we can see that you don't get
>> the error on Ubuntu with R-devel, nor on Windows with R-3.6.1. When you
>> received the original email from CRAN with the check output, on which
>> platform did you get the error about using too many cores? Perhaps that
>> info could help narrow it down, or at least you would know on which
>> platform to test.
>>
>>
>> Max Turgeon
>> Assistant Professor
>> Department of Statistics
>> Department of Computer Science
>> University of Manitoba
>> maxturgeon.ca
>>
>>
>> ------------------------------
>> *From:* R-package-devel <r-package-devel-bounces at r-project.org> on behalf
>> of John Harrold <john.m.harrold at gmail.com>
>> *Sent:* September 15, 2019 11:31:38 AM
>> *To:* Uwe Ligges
>> *Cc:* r-package-devel at r-project.org
>> *Subject:* Re: [R-pkg-devel] Number of cores in examples
>>
>> Howdy Folks,
>>
>> I'm testing this on R-hub, and I've set option in the environment. I put
>> links to the Windows and Ubuntu outputs below. I've searched for the
>> obvious (core, parallel, etc), but I'm not really sure what I need to look
>> for to indicate that more than one core is being used. If someone could
>> point it out to me I'd be very grateful.
>>
>> Windows:
>>
>> https://drive.google.com/file/d/1187cRyrJLFJetaOW3WHL-mLTCTwYxOeG/view?usp=sharing
>>
>> Ubuntu:
>>
>> https://drive.google.com/file/d/1XhaKFpaPaRyJLvHuFcbWNyztzYpsLj8r/view?usp=sharing
>>
>> Thanks
>> John
>>
>>
>>
>> On Sun, Sep 15, 2019 at 12:42 AM Uwe Ligges <
>> ligges at statistik.tu-dortmund.de>
>> wrote:
>>
>>>
>>>
>>> On 15.09.2019 05:39, John Harrold wrote:
>>>> Thanks Uwe,
>>>>
>>>> Is there a way to find out on my end where this is happening?
>>>
>>> Yes, simply set the env var
>>> _R_CHECK_LIMIT_CORES_=true
>>> to reproduce.
>>>
>>> Best,
>>> Uwe
>>>
>>>>
>>>> Thanks
>>>> john
>>>>
>>>> On Fri, Sep 13, 2019 at 10:51 PM Uwe Ligges
>>>> <ligges at statistik.tu-dortmund.de
>>>> <mailto:ligges at statistik.tu-dortmund.de
>> <ligges at statistik.tu-dortmund.de>>> wrote:
>>>>
>>>>
>>>>
>>>>      On 14.09.2019 03:33, John Harrold wrote:
>>>>       > Hello,
>>>>       >
>>>>       > I recently submitted a package for consideration in CRAN. One of
>>> the
>>>>       > comments was:
>>>>       >
>>>>       > Please ensure that you do not use more than 2 cores in your
>>> examples.
>>>>       >
>>>>       > I do not believe my package does this. Is this a general comment
>>>>      for a
>>>>       > package that requires doParallel or was this triggered because
>>>>      one of my
>>>>       > examples actually used more than 2 cores?
>>>>
>>>>      The latter. In examples, vignettes and tests you must not start
>> more
>>>>      than 2 workers as resources for CRAN checks are limited.
>>>>
>>>>      Best,
>>>>      Uwe Ligges
>>>>
>>>>
>>>>       >
>>>>       > Thanks
>>>>       > John
>>>>       >
>>>>
>>>>
>>>>
>>>> --
>>>> John
>>>> :wq
>>>
>>
>>
>> --
>> John
>> :wq
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
>


From wo||g@ng@|enh@rd @end|ng |rom un|-wuerzburg@de  Mon Sep 16 09:57:11 2019
From: wo||g@ng@|enh@rd @end|ng |rom un|-wuerzburg@de (Wolfgang Lenhard)
Date: Mon, 16 Sep 2019 09:57:11 +0200
Subject: [R-pkg-devel] References in package description file
Message-ID: <a5d6c035-9eb4-295e-3d4f-685eda2f317d@uni-wuerzburg.de>

Hello world,
is there a standard way of adding references (scientific papers ...) to 
the description file in R packages other than putting the DOI in the 
description text? Does a best practise exist on how much references are 
advisable in order not to clutter the package information? Or should I 
put these things in the vignette instead?

Thanks and best regards,
 ??? Wolfgang


From d@v|dhughjone@ @end|ng |rom gm@||@com  Mon Sep 16 10:05:18 2019
From: d@v|dhughjone@ @end|ng |rom gm@||@com (David Hugh-Jones)
Date: Mon, 16 Sep 2019 09:05:18 +0100
Subject: [R-pkg-devel] References in package description file
In-Reply-To: <a5d6c035-9eb4-295e-3d4f-685eda2f317d@uni-wuerzburg.de>
References: <a5d6c035-9eb4-295e-3d4f-685eda2f317d@uni-wuerzburg.de>
Message-ID: <CAARY7kj2cmar08txs=WZ2UDpDXrERg584kEmzQ-NJ4sSX1es-A@mail.gmail.com>

Hi Wolfgang,

You can use the CITATION file. See ?citation and ?bibentry.

Cheers,
David


On Mon, 16 Sep 2019 at 08:55, Wolfgang Lenhard <
wolfgang.lenhard at uni-wuerzburg.de> wrote:

> Hello world,
> is there a standard way of adding references (scientific papers ...) to
> the description file in R packages other than putting the DOI in the
> description text? Does a best practise exist on how much references are
> advisable in order not to clutter the package information? Or should I
> put these things in the vignette instead?
>
> Thanks and best regards,
>      Wolfgang
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From wo||g@ng@|enh@rd @end|ng |rom un|-wuerzburg@de  Mon Sep 16 10:20:44 2019
From: wo||g@ng@|enh@rd @end|ng |rom un|-wuerzburg@de (Wolfgang Lenhard)
Date: Mon, 16 Sep 2019 10:20:44 +0200
Subject: [R-pkg-devel] References in package description file
In-Reply-To: <CAARY7kj2cmar08txs=WZ2UDpDXrERg584kEmzQ-NJ4sSX1es-A@mail.gmail.com>
References: <a5d6c035-9eb4-295e-3d4f-685eda2f317d@uni-wuerzburg.de>
 <CAARY7kj2cmar08txs=WZ2UDpDXrERg584kEmzQ-NJ4sSX1es-A@mail.gmail.com>
Message-ID: <29ef3ca2-d48f-fd23-98c9-c7685d4c8081@uni-wuerzburg.de>

Fantastic! Thanks!

Am 16.09.2019 um 10:05 schrieb David Hugh-Jones:
> Hi Wolfgang,
>
> You can use the CITATION file. See??citation and ?bibentry.
>
> Cheers,
> David
>
>
> On Mon, 16 Sep 2019 at 08:55, Wolfgang Lenhard 
> <wolfgang.lenhard at uni-wuerzburg.de 
> <mailto:wolfgang.lenhard at uni-wuerzburg.de>> wrote:
>
>     Hello world,
>     is there a standard way of adding references (scientific papers
>     ...) to
>     the description file in R packages other than putting the DOI in the
>     description text? Does a best practise exist on how much
>     references are
>     advisable in order not to clutter the package information? Or
>     should I
>     put these things in the vignette instead?
>
>     Thanks and best regards,
>     ???? Wolfgang
>
>     ______________________________________________
>     R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

-- 
Prof. Dr. Wolfgang Lenhard
Lehrstuhl Psychologie IV
Raum 02.130
Wittelsbacherplatz 1
D-97070 W?rzburg

Tel.: 0931 3189791
FAX:  0931 3184891
URL:  https://go.uniwue.de/lenhard
Map:  https://go.uni-wuerzburg.de/3b


	[[alternative HTML version deleted]]


From cht@n|gut| @end|ng |rom u@p@br  Tue Sep 17 18:17:42 2019
From: cht@n|gut| @end|ng |rom u@p@br (Cristiane Hayumi Taniguti)
Date: Tue, 17 Sep 2019 13:17:42 -0300
Subject: [R-pkg-devel] How reproduce CRAN check
In-Reply-To: <CALEXWq3JL7rwZYRxWHPBnBAkQC5PPYhupS5duYoPvnbK9xoE+w@mail.gmail.com>
References: <CAGnmNJy9Z9AnZUrs+Z94gRE7JSiho=UQe1zQUOHQ3k85Dt+wpA@mail.gmail.com>
 <CALEXWq3JL7rwZYRxWHPBnBAkQC5PPYhupS5duYoPvnbK9xoE+w@mail.gmail.com>
Message-ID: <CAGnmNJxqGWT_NtL4=54XrpjKzRGwqW5t74Z5c9P_CJtkXwyYMw@mail.gmail.com>

Hello, thanks for all the answers.

I did the new tests with all suggestions.

I included the Rprintf in my script, however it did not show any NaN when
running with my examples (the same that CRAN check pointed the error)

The check in r-hub Debian Linux, R-devel, GCC ASAN/UBSAN
(linux-x86_64-rocker-gcc-san) did not show the error.

The r-debug seems to be a good tool, but I had problems to build my package
on it. First, the library libglu1-mesa-dev was missing for rgl package
installation, then, I installed it, but I  found the following errors when
trying to install the required MDSMap package:

"Shadow memory range interleaves with an existing memory mapping. ASan
cannot proceed correctly. ABORTING."
and
"/usr/bin/ld: cannot find -lgfortran"

I did the modifications in rcpp files (update here<
https://github.com/Cristianetaniguti/onemap/commit/8d90eab994c9c5cc56202c2c15c5eae7c639315b>),
but I still can not test the package with it. Would be a problem if I
submit anyway?

On Fri, Sep 13, 2019 at 12:35 PM I?aki Ucar <iucar at fedoraproject.org> wrote:

> On Fri, 13 Sep 2019 at 16:16, Cristiane Hayumi Taniguti
> <chtaniguti at usp.br> wrote:
> >
> > ...........................twopts_f2.cpp:101:7: runtime error: nan is
> > outside the range of representable values of type 'int'
> > onemap.Rcheck/onemap-Ex.Rout:twopts_f2.cpp:101:26: runtime error: nan is
> > outside the range of representable values of type 'int'
>
> Here:
> https://github.com/augusto-garcia/onemap/blob/master/src/twopts_f2.cpp#L101
> -> k1=segreg_type(i); k2=segreg_type(j);
>
> k1 and k2 are vectors of integers, but segreg_type is a NumericVector
> (double), which may contain NaN.
>
> I?aki
>

	[[alternative HTML version deleted]]


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Wed Sep 18 08:46:44 2019
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Wed, 18 Sep 2019 01:46:44 -0500
Subject: [R-pkg-devel] unable to run 'make clean' in 'src'
Message-ID: <39e415fc-9364-31ec-f0e0-59c9801ed6fb@effectivedefense.org>

Hello:


 ????? "R CMD build bssm" complains:


 ??? ??????? unable to run 'make clean' in 'src'


 ????? This is on a Windows 10 computer with R 3.6.1 installed with, I 
think, Rtools35.exe.? "sessionInfo()" says, "Platform: 
x86_64-w64-mingw32/x64 (64-bit)".


 ????? This is trying to build a local clone of 
"https://github.com/sbgraves237/bssm", which is only slightly different 
from "helske/bssm".


 ????? What do you suggest?


 ????? Thanks,
 ????? Spencer Graves


p.s. 
"https://stackoverflow.com/questions/28723882/problems-installing-development-package-from-either-github-or-local#28724622" 
documents a discussion of this message from 2015.? It asks if "Rtools is 
in your PATH?"? The "path" includes "C:\RBuildTools\3.5" and "C:\Program 
Files\R\R3.6.1\bin" plus other non-R stuff.? That discussion also said, 
"The .o files in the src directory were messing things up."? bssm/src 
does not contain any *.o files.


From s@rez@@i@vi@@ m@iii@g oii m@ii@um@@c@ir  Wed Sep 18 11:26:05 2019
From: s@rez@@i@vi@@ m@iii@g oii m@ii@um@@c@ir (s@rez@@i@vi@@ m@iii@g oii m@ii@um@@c@ir)
Date: Wed, 18 Sep 2019 13:56:05 +0430
Subject: [R-pkg-devel] Help
Message-ID: <305e549b51d3311f5289d532b6195d5e@mail.um.ac.ir>

Hello,

I' have just tried to submit a package to CRAN which has a Bioconductor
dependency. I import "GeneticsPed" in my package but
 when installing it, have this error:

ERROR: dependency 'GeneticsPed' is not available for package 'LRQMM'
        * removing 'C:/Users/.../LRQMM'.

or this check: 
https://cran.um.ac.ir/web/checks/check_results_LRQMM.html

I tried "biocViews " in description file with empty form, but not been
succeed.

How can i solving this problem?

Thanks.

Sayyed Reza Alavian
	[[alternative HTML version deleted]]


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Wed Sep 18 13:30:00 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Wed, 18 Sep 2019 11:30:00 +0000
Subject: [R-pkg-devel] unable to run 'make clean' in 'src'
In-Reply-To: <39e415fc-9364-31ec-f0e0-59c9801ed6fb@effectivedefense.org>
References: <39e415fc-9364-31ec-f0e0-59c9801ed6fb@effectivedefense.org>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E01CC77AF6F@MBXP01.ds.man.ac.uk>

I don't know about Windows 10 but I think that the pointers to Rtools need to be to the bin subdirectory. Also, it is prudent to have these at the beginning of the search path, e.g.

PATH=c:\Rtools\bin;c:\Rtools\mingw_64\bin;c:\ProgramF\R\R-3.6.0patched\bin;

I am not sure if the entry for ming_w64 above is (still) needed.


Georgi Boshnakov


-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Spencer Graves
Sent: 18 September 2019 07:47
To: R Package Development
Subject: [R-pkg-devel] unable to run 'make clean' in 'src'

Hello:


 ????? "R CMD build bssm" complains:


 ??? ??????? unable to run 'make clean' in 'src'


 ????? This is on a Windows 10 computer with R 3.6.1 installed with, I 
think, Rtools35.exe.? "sessionInfo()" says, "Platform: 
x86_64-w64-mingw32/x64 (64-bit)".


 ????? This is trying to build a local clone of 
"https://github.com/sbgraves237/bssm", which is only slightly different 
from "helske/bssm".


 ????? What do you suggest?


 ????? Thanks,
 ????? Spencer Graves


p.s. 
"https://stackoverflow.com/questions/28723882/problems-installing-development-package-from-either-github-or-local#28724622" 
documents a discussion of this message from 2015.? It asks if "Rtools is 
in your PATH?"? The "path" includes "C:\RBuildTools\3.5" and "C:\Program 
Files\R\R3.6.1\bin" plus other non-R stuff.? That discussion also said, 
"The .o files in the src directory were messing things up."? bssm/src 
does not contain any *.o files.

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

From R@ph@e|@BONNET @end|ng |rom un|v-coted@zur@|r  Wed Sep 18 13:59:36 2019
From: R@ph@e|@BONNET @end|ng |rom un|v-coted@zur@|r (Raphael Bonnet)
Date: Wed, 18 Sep 2019 13:59:36 +0200
Subject: [R-pkg-devel] script translation - good practice?
In-Reply-To: <c41e8106-c9d0-2051-ea1c-a8c2e24e0367@univ-cotedazur.fr>
References: <c41e8106-c9d0-2051-ea1c-a8c2e24e0367@univ-cotedazur.fr>
Message-ID: <fdb293ff-6bdc-02da-f003-30eddfbbed02@univ-cotedazur.fr>

Hi everyone,

I just rewrote a bit of Matlab code into R and that I would like to make 
it available for the community.
Unfortunately this bit of code has been published by authors that I've 
never contacted.

I was wondering if I could submit a package to CRAN by keeping the same 
license as the journal in which the code was published and citing the 
paper and the authors.
Can I associate myself as [cre, trl] in the description file?

Thanks,
Raphael


From pd@|gd @end|ng |rom gm@||@com  Wed Sep 18 14:11:53 2019
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Wed, 18 Sep 2019 14:11:53 +0200
Subject: [R-pkg-devel] script translation - good practice?
In-Reply-To: <fdb293ff-6bdc-02da-f003-30eddfbbed02@univ-cotedazur.fr>
References: <c41e8106-c9d0-2051-ea1c-a8c2e24e0367@univ-cotedazur.fr>
 <fdb293ff-6bdc-02da-f003-30eddfbbed02@univ-cotedazur.fr>
Message-ID: <7629F4C8-7DA6-42F0-96D9-828AD8FCD64F@gmail.com>

Not a lawyer, but...

I would expect that it depends on what license it was published under originally. If it doesn't explicitly allow the creation of derivative works, then I would be wary.

-pd

> On 18 Sep 2019, at 13:59 , Raphael Bonnet <Raphael.BONNET at univ-cotedazur.fr> wrote:
> 
> Hi everyone,
> 
> I just rewrote a bit of Matlab code into R and that I would like to make it available for the community.
> Unfortunately this bit of code has been published by authors that I've never contacted.
> 
> I was wondering if I could submit a package to CRAN by keeping the same license as the journal in which the code was published and citing the paper and the authors.
> Can I associate myself as [cre, trl] in the description file?
> 
> Thanks,
> Raphael
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From R@ph@e|@BONNET @end|ng |rom un|v-coted@zur@|r  Wed Sep 18 14:20:00 2019
From: R@ph@e|@BONNET @end|ng |rom un|v-coted@zur@|r (Raphael Bonnet)
Date: Wed, 18 Sep 2019 14:20:00 +0200
Subject: [R-pkg-devel] script translation - good practice?
In-Reply-To: <7629F4C8-7DA6-42F0-96D9-828AD8FCD64F@gmail.com>
References: <c41e8106-c9d0-2051-ea1c-a8c2e24e0367@univ-cotedazur.fr>
 <fdb293ff-6bdc-02da-f003-30eddfbbed02@univ-cotedazur.fr>
 <7629F4C8-7DA6-42F0-96D9-828AD8FCD64F@gmail.com>
Message-ID: <2e418540-3ea0-5be4-2d3a-1c98d783eaa2@univ-cotedazur.fr>

Thank you Peter for your response,

It looks ok for the license. The journal's content appears to be under 
this license:
https://creativecommons.org/licenses/by/3.0/

Raphael

Le 18/09/2019 ? 14:11, peter dalgaard a ?crit?:
> Not a lawyer, but...
>
> I would expect that it depends on what license it was published under originally. If it doesn't explicitly allow the creation of derivative works, then I would be wary.
>
> -pd
>
>> On 18 Sep 2019, at 13:59 , Raphael Bonnet <Raphael.BONNET at univ-cotedazur.fr> wrote:
>>
>> Hi everyone,
>>
>> I just rewrote a bit of Matlab code into R and that I would like to make it available for the community.
>> Unfortunately this bit of code has been published by authors that I've never contacted.
>>
>> I was wondering if I could submit a package to CRAN by keeping the same license as the journal in which the code was published and citing the paper and the authors.
>> Can I associate myself as [cre, trl] in the description file?
>>
>> Thanks,
>> Raphael
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From pd@|gd @end|ng |rom gm@||@com  Wed Sep 18 14:50:34 2019
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Wed, 18 Sep 2019 14:50:34 +0200
Subject: [R-pkg-devel] script translation - good practice?
In-Reply-To: <2e418540-3ea0-5be4-2d3a-1c98d783eaa2@univ-cotedazur.fr>
References: <c41e8106-c9d0-2051-ea1c-a8c2e24e0367@univ-cotedazur.fr>
 <fdb293ff-6bdc-02da-f003-30eddfbbed02@univ-cotedazur.fr>
 <7629F4C8-7DA6-42F0-96D9-828AD8FCD64F@gmail.com>
 <2e418540-3ea0-5be4-2d3a-1c98d783eaa2@univ-cotedazur.fr>
Message-ID: <B21B5FAC-14DF-462B-9F37-3D696BC09535@gmail.com>

Yes. Check out

https://www.gnu.org/licenses/license-list.en.html#GPLCompatibleLicenses

and also note that CC-BY is not recommended as a software license (by CC themselves). As there is one-way compatibility, it should be possible to clarify the situation by putting your derivative work under the GPL.

Although not legally required, it would probably be good manners to inform the original authors.

-pd

> On 18 Sep 2019, at 14:20 , Raphael Bonnet <Raphael.BONNET at univ-cotedazur.fr> wrote:
> 
> Thank you Peter for your response,
> 
> It looks ok for the license. The journal's content appears to be under this license:
> https://creativecommons.org/licenses/by/3.0/
> 
> Raphael
> 
> Le 18/09/2019 ? 14:11, peter dalgaard a ?crit :
>> Not a lawyer, but...
>> 
>> I would expect that it depends on what license it was published under originally. If it doesn't explicitly allow the creation of derivative works, then I would be wary.
>> 
>> -pd
>> 
>>> On 18 Sep 2019, at 13:59 , Raphael Bonnet <Raphael.BONNET at univ-cotedazur.fr> wrote:
>>> 
>>> Hi everyone,
>>> 
>>> I just rewrote a bit of Matlab code into R and that I would like to make it available for the community.
>>> Unfortunately this bit of code has been published by authors that I've never contacted.
>>> 
>>> I was wondering if I could submit a package to CRAN by keeping the same license as the journal in which the code was published and citing the paper and the authors.
>>> Can I associate myself as [cre, trl] in the description file?
>>> 
>>> Thanks,
>>> Raphael
>>> 
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Thu Sep 19 08:50:24 2019
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Thu, 19 Sep 2019 01:50:24 -0500
Subject: [R-pkg-devel] unable to run 'make clean' in 'src'
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E01CC77AF6F@MBXP01.ds.man.ac.uk>
References: <39e415fc-9364-31ec-f0e0-59c9801ed6fb@effectivedefense.org>
 <438D2EC9EAFE5946B2D5864670EA468E01CC77AF6F@MBXP01.ds.man.ac.uk>
Message-ID: <79a24735-9533-aad2-d0f1-1e08a55c3e6a@effectivedefense.org>

Hi, Georgi et al.:


 ????? Thanks to Georgi, I changed my path.? That led me to a different 
error.? A search for the new error led me to:


https://thecoatlessprofessor.com/programming/cpp/installing-rtools-for-compiled-code-via-rcpp/


That recommended:


install.packages("installr")
library("installr")
install.Rtools()


 ????? I uninstalled Rtools, then installed them using this, and that 
problem disappeared.? Now I'm dealing with '"pdflatex" not found". I'll 
discuss that in a new thread.


 ????? Thanks,
 ????? Spencer Graves


On 2019-09-18 06:30, Georgi Boshnakov wrote:
> I don't know about Windows 10 but I think that the pointers to Rtools need to be to the bin subdirectory. Also, it is prudent to have these at the beginning of the search path, e.g.
>
> PATH=c:\Rtools\bin;c:\Rtools\mingw_64\bin;c:\ProgramF\R\R-3.6.0patched\bin;
>
> I am not sure if the entry for ming_w64 above is (still) needed.
>
>
> Georgi Boshnakov
>
>
> -----Original Message-----
> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Spencer Graves
> Sent: 18 September 2019 07:47
> To: R Package Development
> Subject: [R-pkg-devel] unable to run 'make clean' in 'src'
>
> Hello:
>
>
>   ????? "R CMD build bssm" complains:
>
>
>   ??? ??????? unable to run 'make clean' in 'src'
>
>
>   ????? This is on a Windows 10 computer with R 3.6.1 installed with, I
> think, Rtools35.exe.? "sessionInfo()" says, "Platform:
> x86_64-w64-mingw32/x64 (64-bit)".
>
>
>   ????? This is trying to build a local clone of
> "https://github.com/sbgraves237/bssm", which is only slightly different
> from "helske/bssm".
>
>
>   ????? What do you suggest?
>
>
>   ????? Thanks,
>   ????? Spencer Graves
>
>
> p.s.
> "https://stackoverflow.com/questions/28723882/problems-installing-development-package-from-either-github-or-local#28724622"  
> documents a discussion of this message from 2015.? It asks if "Rtools is
> in your PATH?"? The "path" includes "C:\RBuildTools\3.5" and "C:\Program
> Files\R\R3.6.1\bin" plus other non-R stuff.? That discussion also said,
> "The .o files in the src directory were messing things up."? bssm/src
> does not contain any *.o files.
>
> ______________________________________________
> R-package-devel at r-project.org  mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Thu Sep 19 08:50:31 2019
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Thu, 19 Sep 2019 01:50:31 -0500
Subject: [R-pkg-devel] Warning in system2(..., stdout = FALSE,
 stderr = FALSE) :, '"pdflatex"' not found
Message-ID: <a0523a3a-83d9-11c5-0a47-0797a1c0789b@effectivedefense.org>

Hello, All:


 ????? What's the recommended way to get pdflatex installed on Windows 
10 to run "R CMD"?


 ????? I ask, because "R CMD build bssm" under Windows 10 produced 
'Warning in system2(..., stdout = FALSE, stderr = FALSE) : '"pdflatex"' 
not found'.


 ????? This was after installing Rtools using the following (recommended 
by 
"https://thecoatlessprofessor.com/programming/cpp/installing-rtools-for-compiled-code-via-rcpp/"): 



install.packages("installr")
library("installr")
install.Rtools()


 ????? Below please find the output in a commands window including 
"sessionInfo()".


 ??? ? Thanks,
 ??? ? Spencer Graves


 >R CMD build bssm
* checking for file 'bssm/DESCRIPTION' ... OK
* preparing 'bssm':
* checking DESCRIPTION meta-information ... OK
* cleaning src
* installing the package to build vignettes
* creating vignettes ... ERROR
--- re-building 'bssm.Rmd' using rmarkdown
[WARNING] Note with key '1' defined at line 318 column 1 but not used.
Warning in system2(..., stdout = FALSE, stderr = FALSE) :
 ? '"pdflatex"' not found
Error: processing vignette 'bssm.Rmd' failed with diagnostics:
Failed to compile bssm.tex. See https://yihui.name/tinytex/r/#debugging 
for debugging tips.
--- failed re-building 'bssm.Rmd'

--- re-building 'growth_model.Rmd' using rmarkdown
Warning in system2(..., stdout = FALSE, stderr = FALSE) :
 ? '"pdflatex"' not found
Error: processing vignette 'growth_model.Rmd' failed with diagnostics:
Failed to compile growth_model.tex. See 
https://yihui.name/tinytex/r/#debugging for debugging tips.
--- failed re-building 'growth_model.Rmd'

SUMMARY: processing the following files failed:
 ? 'bssm.Rmd' 'growth_model.Rmd'

Error: Vignette re-building failed.
Execution halted

C:\Users\spenc\Documents\R\bssm\bssm>
C:\Users\spenc\Documents\R\bssm\bssm>pdflatex
'pdflatex' is not recognized as an internal or external command,
operable program or batch file.

C:\Users\spenc\Documents\R\bssm\bssm>r

R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

 ? Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

 > sessionInfo()
R version 3.6.1 (2019-07-05)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 18362)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats???? graphics? grDevices utils???? datasets? methods?? base

loaded via a namespace (and not attached):
[1] compiler_3.6.1

	[[alternative HTML version deleted]]


From @r@v|ndj@y@r@m@n@gr| @end|ng |rom gm@||@com  Thu Sep 19 12:51:03 2019
From: @r@v|ndj@y@r@m@n@gr| @end|ng |rom gm@||@com (Aravind J.)
Date: Thu, 19 Sep 2019 16:21:03 +0530
Subject: [R-pkg-devel] Reproducing CRAN pre-tests
Message-ID: <CA+0rMg=tgdE_phVG5+8UkiU7OC34+62Gu6xyYW5okM_KjDXWog@mail.gmail.com>

Hi,

I am trying to submit an updated version of my package PGRdup to CRAN. The
package has compiled code in C.

I do development in a windows environment.

The update was to fix issues in
https://cran.r-project.org/web/checks/check_results_PGRdup.html.

I have successfully fixed PCRE2 compatability issues and the issue with "
?strncpy? specified bound depends on the length of the source argument".

For all instances of of strncpy I had changed the dependency on the length
of the source argument to that of destination argument.

On submission, now one issue remains with debian pre-test.

  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:106:10:
warning: ?__builtin_strncpy? specified bound depends on the length of
the source argument [-Wstringop-overflow=]

https://win-builder.r-project.org/incoming_pretest/PGRdup_0.2.3.4_20190919_090630/Debian/00check.log

How to reproduce this error. I have tried rhub platforms
windows-x86_64-devel, ubuntu-gcc-release, fedora-clang-devel,
linux-x86_64-rocker-gcc-san, linux-x86_64-rocker-gcc-san and ubuntu-rchk
without any success.

How to reproduce the pre-test results in a windows environment? and how to
fix this specific error?

Regards,

-- 
J.Aravind
Scientist,
Division of Germplasm Conservation,
ICAR-National Bureau of Plant Genetic Resources,
New Delhi - 110 012
Email: j.aravind at icar.gov.in

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Sep 19 13:15:35 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 19 Sep 2019 07:15:35 -0400
Subject: [R-pkg-devel] Reproducing CRAN pre-tests
In-Reply-To: <CA+0rMg=tgdE_phVG5+8UkiU7OC34+62Gu6xyYW5okM_KjDXWog@mail.gmail.com>
References: <CA+0rMg=tgdE_phVG5+8UkiU7OC34+62Gu6xyYW5okM_KjDXWog@mail.gmail.com>
Message-ID: <3f87639a-681a-a63d-354a-474a1a268b54@gmail.com>

On 19/09/2019 6:51 a.m., Aravind J. wrote:
> Hi,
> 
> I am trying to submit an updated version of my package PGRdup to CRAN. The
> package has compiled code in C.
> 
> I do development in a windows environment.
> 
> The update was to fix issues in
> https://cran.r-project.org/web/checks/check_results_PGRdup.html.
> 
> I have successfully fixed PCRE2 compatability issues and the issue with "
> ?strncpy? specified bound depends on the length of the source argument".
> 
> For all instances of of strncpy I had changed the dependency on the length
> of the source argument to that of destination argument.
> 
> On submission, now one issue remains with debian pre-test.
> 
>    /usr/include/x86_64-linux-gnu/bits/string_fortified.h:106:10:
> warning: ?__builtin_strncpy? specified bound depends on the length of
> the source argument [-Wstringop-overflow=]
> 
> https://win-builder.r-project.org/incoming_pretest/PGRdup_0.2.3.4_20190919_090630/Debian/00check.log
> 
> How to reproduce this error. I have tried rhub platforms
> windows-x86_64-devel, ubuntu-gcc-release, fedora-clang-devel,
> linux-x86_64-rocker-gcc-san, linux-x86_64-rocker-gcc-san and ubuntu-rchk
> without any success.
> 
> How to reproduce the pre-test results in a windows environment? and how to
> fix this specific error?
> 

The install.out file points to the error here:

fdouble_metaphone.c: In function ?DoubleMetaphone?:
fdouble_metaphone.c:271:33: note: length computed here
   271 |     strncpy(original->str, str, strlen(str) + 1);

Presumably you need to limit the copy to the destination length.

Duncan Murdoch


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Thu Sep 19 15:29:12 2019
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Thu, 19 Sep 2019 08:29:12 -0500
Subject: [R-pkg-devel] Warning in system2(..., stdout = FALSE,
 stderr = FALSE) :, '"pdflatex"' not found
In-Reply-To: <a0523a3a-83d9-11c5-0a47-0797a1c0789b@effectivedefense.org>
References: <a0523a3a-83d9-11c5-0a47-0797a1c0789b@effectivedefense.org>
Message-ID: <c14864d5-8fc0-5657-acf6-44598dc9d2f7@effectivedefense.org>

Update:? A web search for 'installing pdflatex for "R CMD" on Windows 
10?' suggested I install MiKTeX.? I did that from miktex.org, and it got 
me past that error.? Spencer


On 2019-09-19 01:50, Spencer Graves wrote:
> Hello, All:
>
>
> ????? What's the recommended way to get pdflatex installed on Windows
> 10 to run "R CMD"?
>
>
> ????? I ask, because "R CMD build bssm" under Windows 10 produced
> 'Warning in system2(..., stdout = FALSE, stderr = FALSE) : '"pdflatex"'
> not found'.
>
>
> ????? This was after installing Rtools using the following (recommended
> by
> "https://thecoatlessprofessor.com/programming/cpp/installing-rtools-for-compiled-code-via-rcpp/"):
>
>
>
> install.packages("installr")
> library("installr")
> install.Rtools()
>
>
> ????? Below please find the output in a commands window including
> "sessionInfo()".
>
>
> ??? ? Thanks,
> ??? ? Spencer Graves
>
>
> >R CMD build bssm
> * checking for file 'bssm/DESCRIPTION' ... OK
> * preparing 'bssm':
> * checking DESCRIPTION meta-information ... OK
> * cleaning src
> * installing the package to build vignettes
> * creating vignettes ... ERROR
> --- re-building 'bssm.Rmd' using rmarkdown
> [WARNING] Note with key '1' defined at line 318 column 1 but not used.
> Warning in system2(..., stdout = FALSE, stderr = FALSE) :
> ? '"pdflatex"' not found
> Error: processing vignette 'bssm.Rmd' failed with diagnostics:
> Failed to compile bssm.tex. See https://yihui.name/tinytex/r/#debugging
> for debugging tips.
> --- failed re-building 'bssm.Rmd'
>
> --- re-building 'growth_model.Rmd' using rmarkdown
> Warning in system2(..., stdout = FALSE, stderr = FALSE) :
> ? '"pdflatex"' not found
> Error: processing vignette 'growth_model.Rmd' failed with diagnostics:
> Failed to compile growth_model.tex. See
> https://yihui.name/tinytex/r/#debugging for debugging tips.
> --- failed re-building 'growth_model.Rmd'
>
> SUMMARY: processing the following files failed:
> ? 'bssm.Rmd' 'growth_model.Rmd'
>
> Error: Vignette re-building failed.
> Execution halted
>
> C:\Users\spenc\Documents\R\bssm\bssm>
> C:\Users\spenc\Documents\R\bssm\bssm>pdflatex
> 'pdflatex' is not recognized as an internal or external command,
> operable program or batch file.
>
> C:\Users\spenc\Documents\R\bssm\bssm>r
>
> R version 3.6.1 (2019-07-05) -- "Action of the Toes"
> Copyright (C) 2019 The R Foundation for Statistical Computing
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
> ? Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
> > sessionInfo()
> R version 3.6.1 (2019-07-05)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 10 x64 (build 18362)
>
> Matrix products: default
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats???? graphics? grDevices utils???? datasets? methods base
>
> loaded via a namespace (and not attached):
> [1] compiler_3.6.1
>
> [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Thu Sep 19 19:19:29 2019
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Thu, 19 Sep 2019 10:19:29 -0700
Subject: [R-pkg-devel] Warning in system2(..., stdout = FALSE,
 stderr = FALSE) :, '"pdflatex"' not found
In-Reply-To: <c14864d5-8fc0-5657-acf6-44598dc9d2f7@effectivedefense.org>
References: <a0523a3a-83d9-11c5-0a47-0797a1c0789b@effectivedefense.org>
 <c14864d5-8fc0-5657-acf6-44598dc9d2f7@effectivedefense.org>
Message-ID: <01210429-8d94-b66f-793b-e4cfc1342160@gmail.com>

On 9/19/19 6:29 AM, Spencer Graves wrote:
> Update: A web search for 'installing pdflatex for "R CMD" on Windows 
> 10?' suggested I install MiKTeX.? I did that from miktex.org, and it 
> got me past that error.? Spencer
>
Please note these things are documented in R Installation and 
Administration Manual (see Appendix D)

Best
Tomas

>
> On 2019-09-19 01:50, Spencer Graves wrote:
>> Hello, All:
>>
>>
>> ????? What's the recommended way to get pdflatex installed on Windows
>> 10 to run "R CMD"?
>>
>>
>> ????? I ask, because "R CMD build bssm" under Windows 10 produced
>> 'Warning in system2(..., stdout = FALSE, stderr = FALSE) : '"pdflatex"'
>> not found'.
>>
>>
>> ????? This was after installing Rtools using the following (recommended
>> by
>> "https://thecoatlessprofessor.com/programming/cpp/installing-rtools-for-compiled-code-via-rcpp/"): 
>>
>>
>>
>>
>> install.packages("installr")
>> library("installr")
>> install.Rtools()
>>
>>
>> ????? Below please find the output in a commands window including
>> "sessionInfo()".
>>
>>
>> ??? ? Thanks,
>> ??? ? Spencer Graves
>>
>>
>> >R CMD build bssm
>> * checking for file 'bssm/DESCRIPTION' ... OK
>> * preparing 'bssm':
>> * checking DESCRIPTION meta-information ... OK
>> * cleaning src
>> * installing the package to build vignettes
>> * creating vignettes ... ERROR
>> --- re-building 'bssm.Rmd' using rmarkdown
>> [WARNING] Note with key '1' defined at line 318 column 1 but not used.
>> Warning in system2(..., stdout = FALSE, stderr = FALSE) :
>> ? '"pdflatex"' not found
>> Error: processing vignette 'bssm.Rmd' failed with diagnostics:
>> Failed to compile bssm.tex. See https://yihui.name/tinytex/r/#debugging
>> for debugging tips.
>> --- failed re-building 'bssm.Rmd'
>>
>> --- re-building 'growth_model.Rmd' using rmarkdown
>> Warning in system2(..., stdout = FALSE, stderr = FALSE) :
>> ? '"pdflatex"' not found
>> Error: processing vignette 'growth_model.Rmd' failed with diagnostics:
>> Failed to compile growth_model.tex. See
>> https://yihui.name/tinytex/r/#debugging for debugging tips.
>> --- failed re-building 'growth_model.Rmd'
>>
>> SUMMARY: processing the following files failed:
>> ? 'bssm.Rmd' 'growth_model.Rmd'
>>
>> Error: Vignette re-building failed.
>> Execution halted
>>
>> C:\Users\spenc\Documents\R\bssm\bssm>
>> C:\Users\spenc\Documents\R\bssm\bssm>pdflatex
>> 'pdflatex' is not recognized as an internal or external command,
>> operable program or batch file.
>>
>> C:\Users\spenc\Documents\R\bssm\bssm>r
>>
>> R version 3.6.1 (2019-07-05) -- "Action of the Toes"
>> Copyright (C) 2019 The R Foundation for Statistical Computing
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>
>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> You are welcome to redistribute it under certain conditions.
>> Type 'license()' or 'licence()' for distribution details.
>>
>> ? Natural language support but running in an English locale
>>
>> R is a collaborative project with many contributors.
>> Type 'contributors()' for more information and
>> 'citation()' on how to cite R or R packages in publications.
>>
>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> 'help.start()' for an HTML browser interface to help.
>> Type 'q()' to quit R.
>>
>> > sessionInfo()
>> R version 3.6.1 (2019-07-05)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows 10 x64 (build 18362)
>>
>> Matrix products: default
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252
>> [2] LC_CTYPE=English_United States.1252
>> [3] LC_MONETARY=English_United States.1252
>> [4] LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats???? graphics? grDevices utils???? datasets? methods base
>>
>> loaded via a namespace (and not attached):
>> [1] compiler_3.6.1
>>
>> [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Thu Sep 19 19:57:12 2019
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Thu, 19 Sep 2019 12:57:12 -0500
Subject: [R-pkg-devel] Warning in system2(..., stdout = FALSE,
 stderr = FALSE) :, '"pdflatex"' not found
In-Reply-To: <01210429-8d94-b66f-793b-e4cfc1342160@gmail.com>
References: <a0523a3a-83d9-11c5-0a47-0797a1c0789b@effectivedefense.org>
 <c14864d5-8fc0-5657-acf6-44598dc9d2f7@effectivedefense.org>
 <01210429-8d94-b66f-793b-e4cfc1342160@gmail.com>
Message-ID: <644bd553-c66b-646b-1342-a5533ddc142c@effectivedefense.org>



On 2019-09-19 12:19, Tomas Kalibera wrote:
> On 9/19/19 6:29 AM, Spencer Graves wrote:
>> Update: A web search for 'installing pdflatex for "R CMD" on Windows 
>> 10?' suggested I install MiKTeX.? I did that from miktex.org, and it 
>> got me past that error.? Spencer
>>
> Please note these things are documented in R Installation and 
> Administration Manual (see Appendix D)


 ????? Thanks for documenting this.? It's important to have that as part 
of this thread.


 ????? I perhaps should have thought to look there, but I didn't. And 
the web searches I tried didn't lead me there. ? Spencer

>
> Best
> Tomas
>
>>
>> On 2019-09-19 01:50, Spencer Graves wrote:
>>> Hello, All:
>>>
>>>
>>> ????? What's the recommended way to get pdflatex installed on Windows
>>> 10 to run "R CMD"?
>>>
>>>
>>> ????? I ask, because "R CMD build bssm" under Windows 10 produced
>>> 'Warning in system2(..., stdout = FALSE, stderr = FALSE) : '"pdflatex"'
>>> not found'.
>>>
>>>
>>> ????? This was after installing Rtools using the following (recommended
>>> by
>>> "https://thecoatlessprofessor.com/programming/cpp/installing-rtools-for-compiled-code-via-rcpp/"): 
>>>
>>>
>>>
>>>
>>> install.packages("installr")
>>> library("installr")
>>> install.Rtools()
>>>
>>>
>>> ????? Below please find the output in a commands window including
>>> "sessionInfo()".
>>>
>>>
>>> ??? ? Thanks,
>>> ??? ? Spencer Graves
>>>
>>>
>>> >R CMD build bssm
>>> * checking for file 'bssm/DESCRIPTION' ... OK
>>> * preparing 'bssm':
>>> * checking DESCRIPTION meta-information ... OK
>>> * cleaning src
>>> * installing the package to build vignettes
>>> * creating vignettes ... ERROR
>>> --- re-building 'bssm.Rmd' using rmarkdown
>>> [WARNING] Note with key '1' defined at line 318 column 1 but not used.
>>> Warning in system2(..., stdout = FALSE, stderr = FALSE) :
>>> ? '"pdflatex"' not found
>>> Error: processing vignette 'bssm.Rmd' failed with diagnostics:
>>> Failed to compile bssm.tex. See https://yihui.name/tinytex/r/#debugging
>>> for debugging tips.
>>> --- failed re-building 'bssm.Rmd'
>>>
>>> --- re-building 'growth_model.Rmd' using rmarkdown
>>> Warning in system2(..., stdout = FALSE, stderr = FALSE) :
>>> ? '"pdflatex"' not found
>>> Error: processing vignette 'growth_model.Rmd' failed with diagnostics:
>>> Failed to compile growth_model.tex. See
>>> https://yihui.name/tinytex/r/#debugging for debugging tips.
>>> --- failed re-building 'growth_model.Rmd'
>>>
>>> SUMMARY: processing the following files failed:
>>> ? 'bssm.Rmd' 'growth_model.Rmd'
>>>
>>> Error: Vignette re-building failed.
>>> Execution halted
>>>
>>> C:\Users\spenc\Documents\R\bssm\bssm>
>>> C:\Users\spenc\Documents\R\bssm\bssm>pdflatex
>>> 'pdflatex' is not recognized as an internal or external command,
>>> operable program or batch file.
>>>
>>> C:\Users\spenc\Documents\R\bssm\bssm>r
>>>
>>> R version 3.6.1 (2019-07-05) -- "Action of the Toes"
>>> Copyright (C) 2019 The R Foundation for Statistical Computing
>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>>
>>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>>> You are welcome to redistribute it under certain conditions.
>>> Type 'license()' or 'licence()' for distribution details.
>>>
>>> ? Natural language support but running in an English locale
>>>
>>> R is a collaborative project with many contributors.
>>> Type 'contributors()' for more information and
>>> 'citation()' on how to cite R or R packages in publications.
>>>
>>> Type 'demo()' for some demos, 'help()' for on-line help, or
>>> 'help.start()' for an HTML browser interface to help.
>>> Type 'q()' to quit R.
>>>
>>> > sessionInfo()
>>> R version 3.6.1 (2019-07-05)
>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>> Running under: Windows 10 x64 (build 18362)
>>>
>>> Matrix products: default
>>>
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252
>>> [2] LC_CTYPE=English_United States.1252
>>> [3] LC_MONETARY=English_United States.1252
>>> [4] LC_NUMERIC=C
>>> [5] LC_TIME=English_United States.1252
>>>
>>> attached base packages:
>>> [1] stats???? graphics? grDevices utils???? datasets? methods base
>>>
>>> loaded via a namespace (and not attached):
>>> [1] compiler_3.6.1
>>>
>>> [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>
>


From @r@v|ndj@y@r@m@n@gr| @end|ng |rom gm@||@com  Fri Sep 20 11:43:50 2019
From: @r@v|ndj@y@r@m@n@gr| @end|ng |rom gm@||@com (Aravind J.)
Date: Fri, 20 Sep 2019 15:13:50 +0530
Subject: [R-pkg-devel] Fwd:  Reproducing CRAN pre-tests
In-Reply-To: <CA+0rMgkAK3VnLC2DJ9upo-1ez+=GV8rfXGS=m4pmPpUQHeNQkQ@mail.gmail.com>
References: <CA+0rMg=tgdE_phVG5+8UkiU7OC34+62Gu6xyYW5okM_KjDXWog@mail.gmail.com>
 <3f87639a-681a-a63d-354a-474a1a268b54@gmail.com>
 <CA+0rMgkAK3VnLC2DJ9upo-1ez+=GV8rfXGS=m4pmPpUQHeNQkQ@mail.gmail.com>
Message-ID: <CA+0rMgmfksHaBWf4ZuUy1jOqzZthU98PEybAdm3NDkrq5VC0Cw@mail.gmail.com>

Hi,

I was able to fix the issue and submit my package successfully to CRAN.

However, the question remains, is there any way to replicate the CRAN
pre-tests locally for future debugging, particularly in a windows
environment?

I had tried rhub platforms without any success.

Warm Regards


On Thu, 19 Sep 2019 at 16:45, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 19/09/2019 6:51 a.m., Aravind J. wrote:
> > Hi,
> >
> > I am trying to submit an updated version of my package PGRdup to CRAN.
> The
> > package has compiled code in C.
> >
> > I do development in a windows environment.
> >
> > The update was to fix issues in
> > https://cran.r-project.org/web/checks/check_results_PGRdup.html.
> >
> > I have successfully fixed PCRE2 compatability issues and the issue with "
> > ?strncpy? specified bound depends on the length of the source argument".
> >
> > For all instances of of strncpy I had changed the dependency on the
> length
> > of the source argument to that of destination argument.
> >
> > On submission, now one issue remains with debian pre-test.
> >
> >    /usr/include/x86_64-linux-gnu/bits/string_fortified.h:106:10:
> > warning: ?__builtin_strncpy? specified bound depends on the length of
> > the source argument [-Wstringop-overflow=]
> >
> >
> https://win-builder.r-project.org/incoming_pretest/PGRdup_0.2.3.4_20190919_090630/Debian/00check.log
> >
> > How to reproduce this error. I have tried rhub platforms
> > windows-x86_64-devel, ubuntu-gcc-release, fedora-clang-devel,
> > linux-x86_64-rocker-gcc-san, linux-x86_64-rocker-gcc-san and ubuntu-rchk
> > without any success.
> >
> > How to reproduce the pre-test results in a windows environment? and how
> to
> > fix this specific error?
> >
>
> The install.out file points to the error here:
>
> fdouble_metaphone.c: In function ?DoubleMetaphone?:
> fdouble_metaphone.c:271:33: note: length computed here
>    271 |     strncpy(original->str, str, strlen(str) + 1);
>
> Presumably you need to limit the copy to the destination length.
>
> Duncan Murdoch
>


-- 

J.Aravind
Scientist,
Division of Germplasm Conservation,
ICAR-National Bureau of Plant Genetic Resources,
New Delhi - 110 012
Email: j.aravind at icar.gov.in

	[[alternative HTML version deleted]]


From r@||@@tubner @end|ng |rom gm@||@com  Fri Sep 20 11:50:56 2019
From: r@||@@tubner @end|ng |rom gm@||@com (Ralf Stubner)
Date: Fri, 20 Sep 2019 11:50:56 +0200
Subject: [R-pkg-devel] Fwd: Reproducing CRAN pre-tests
In-Reply-To: <CA+0rMgmfksHaBWf4ZuUy1jOqzZthU98PEybAdm3NDkrq5VC0Cw@mail.gmail.com>
References: <CA+0rMg=tgdE_phVG5+8UkiU7OC34+62Gu6xyYW5okM_KjDXWog@mail.gmail.com>
 <3f87639a-681a-a63d-354a-474a1a268b54@gmail.com>
 <CA+0rMgkAK3VnLC2DJ9upo-1ez+=GV8rfXGS=m4pmPpUQHeNQkQ@mail.gmail.com>
 <CA+0rMgmfksHaBWf4ZuUy1jOqzZthU98PEybAdm3NDkrq5VC0Cw@mail.gmail.com>
Message-ID: <CAFQwRQxYcJWwh2+LFdShudF0w5JC=u9DrZ56y_GumzhuYBOrXQ@mail.gmail.com>

On Fri, Sep 20, 2019 at 11:44 AM Aravind J.
<aravindjayaramanagri at gmail.com> wrote:
> However, the question remains, is there any way to replicate the CRAN
> pre-tests locally for future debugging, particularly in a windows
> environment?
>
> I had tried rhub platforms without any success.

I have found the docker image wch1/r-debug most helful for debugging
memory issues, c.f.
https://github.com/wch/r-debug/blob/master/debugging-r.md. I am not
using Windows myself, but since docker is available on Windows, this
image should be useable there as well.

cheerio
ralf


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sat Sep 21 03:30:29 2019
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Fri, 20 Sep 2019 20:30:29 -0500
Subject: [R-pkg-devel] incomplete final line found on 'growth_model.log'
Message-ID: <6036e1cb-a8b1-1dea-c32d-177ba205c838@effectivedefense.org>

 ????? "R CMD build bssm" on a Windows 10 machine ends by complaining, 
"? incomplete final line found on 'growth_model.log'". This problem was 
not fixed by adding a couple of blank lines to 'growth_model.Rmd'.


 ????? Suggestions?
 ????? Thanks,
 ????? Spencer Graves


p.s.? The same command worked fine on a Windows 7 computer.? The "bssm" 
package used here was cloned from 
""https://github.com/sbgraves237/bssm":? This is not identical to 
helski/bssm, but close.


*EXCERPT FROM CMD: *


...
* creating vignettes ... ERROR
--- re-building 'bssm.Rmd' using rmarkdown
[WARNING] Note with key '1' defined at line 318 column 1 but not used.
--- finished re-building 'bssm.Rmd'

--- re-building 'growth_model.Rmd' using rmarkdown
Warning in readLines(log) :
 ? incomplete final line found on 'growth_model.log'
Error: processing vignette 'growth_model.Rmd' failed with diagnostics:
Failed to compile growth_model.tex. See 
https://yihui.name/tinytex/r/#debugging for debugging tips.
--- failed re-building 'growth_model.Rmd'

SUMMARY: processing the following file failed:
 ? 'growth_model.Rmd'

Error: Vignette re-building failed.
Execution halted


*PLFLATEX.LOG


*2019-09-19 08:11:08,435-0500 INFO? pdflatex - starting with command 
line: C:\PROGRA~1\MIKTEX~1.9\miktex\bin\x64\pdflatex.exe -halt-on-error 
-interaction=batchmode bssm.tex
2019-09-19 08:11:08,435-0500 WARN? pdflatex - running with administrator 
privileges
2019-09-19 08:11:08,450-0500 INFO? pdflatex - running 'initexmf' to 
refresh the file name database
2019-09-19 08:11:13,734-0500 INFO? pdflatex - running 'initexmf' to 
create font map files
2019-09-19 08:11:22,735-0500 INFO? pdflatex - allowing known shell commands
2019-09-19 08:11:22,735-0500 INFO? pdflatex - enabling input (output) 
from (to) processes
2019-09-19 08:11:22,798-0500 INFO? pdflatex - going to create file: 
pdflatex.fmt
2019-09-19 08:11:31,033-0500 FATAL pdflatex - GUI framework cannot be 
initialized.
2019-09-19 08:11:31,033-0500 FATAL pdflatex - Info:
2019-09-19 08:11:31,033-0500 FATAL pdflatex - Source: 
Libraries\MiKTeX\UI\Qt\mikuiqt.cpp
2019-09-19 08:11:31,033-0500 FATAL pdflatex - Line: 77
2019-09-19 08:11:31,033-0500 INFO? pdflatex - finishing with exit code 1
2019-09-19 08:12:53,079-0500 INFO? pdflatex - starting with command 
line: C:\PROGRA~1\MIKTEX~1.9\miktex\bin\x64\pdflatex.exe -halt-on-error 
-interaction=batchmode growth_model.tex
2019-09-19 08:12:53,079-0500 WARN? pdflatex - running with administrator 
privileges
2019-09-19 08:12:53,079-0500 INFO? pdflatex - allowing known shell commands
2019-09-19 08:12:53,079-0500 INFO? pdflatex - enabling input (output) 
from (to) processes
2019-09-19 08:12:53,392-0500 FATAL pdflatex - GUI framework cannot be 
initialized.
2019-09-19 08:12:53,392-0500 FATAL pdflatex - Info:
2019-09-19 08:12:53,392-0500 FATAL pdflatex - Source: 
Libraries\MiKTeX\UI\Qt\mikuiqt.cpp
2019-09-19 08:12:53,392-0500 FATAL pdflatex - Line: 77
2019-09-19 08:12:53,392-0500 INFO? pdflatex - finishing with exit code 1
2019-09-19 13:15:45,812-0500 INFO? pdflatex - starting with command 
line: C:\PROGRA~1\MIKTEX~1.9\miktex\bin\x64\pdflatex.exe -halt-on-error 
-interaction=batchmode growth_model.tex
2019-09-19 13:15:45,815-0500 WARN? pdflatex - running with administrator 
privileges
2019-09-19 13:15:45,819-0500 INFO? pdflatex - allowing known shell commands
2019-09-19 13:15:45,819-0500 INFO? pdflatex - enabling input (output) 
from (to) processes
2019-09-19 13:15:46,231-0500 FATAL pdflatex - GUI framework cannot be 
initialized.
2019-09-19 13:15:46,231-0500 FATAL pdflatex - Info:
2019-09-19 13:15:46,231-0500 FATAL pdflatex - Source: 
Libraries\MiKTeX\UI\Qt\mikuiqt.cpp
2019-09-19 13:15:46,231-0500 FATAL pdflatex - Line: 77
2019-09-19 13:15:46,231-0500 INFO? pdflatex - finishing with exit code 1
2019-09-19 13:22:55,302-0500 INFO? pdflatex - starting with command 
line: C:\PROGRA~1\MIKTEX~1.9\miktex\bin\x64\pdflatex.exe -halt-on-error 
-interaction=batchmode growth_model.tex
2019-09-19 13:22:55,302-0500 WARN? pdflatex - running with administrator 
privileges
2019-09-19 13:22:55,302-0500 INFO? pdflatex - allowing known shell commands
2019-09-19 13:22:55,302-0500 INFO? pdflatex - enabling input (output) 
from (to) processes
2019-09-19 13:22:55,640-0500 FATAL pdflatex - GUI framework cannot be 
initialized.
2019-09-19 13:22:55,640-0500 FATAL pdflatex - Info:
2019-09-19 13:22:55,640-0500 FATAL pdflatex - Source: 
Libraries\MiKTeX\UI\Qt\mikuiqt.cpp
2019-09-19 13:22:55,640-0500 FATAL pdflatex - Line: 77
2019-09-19 13:22:55,641-0500 INFO? pdflatex - finishing with exit code 1
2019-09-19 13:22:56,136-0500 INFO? pdflatex - starting with command 
line: C:\PROGRA~1\MIKTEX~1.9\miktex\bin\x64\pdflatex.exe -halt-on-error 
-interaction=batchmode growth_model.tex
2019-09-19 13:22:56,139-0500 WARN? pdflatex - running with administrator 
privileges
2019-09-19 13:22:56,154-0500 INFO? pdflatex - allowing known shell commands
2019-09-19 13:22:56,155-0500 INFO? pdflatex - enabling input (output) 
from (to) processes
2019-09-19 13:22:56,434-0500 FATAL pdflatex - GUI framework cannot be 
initialized.
2019-09-19 13:22:56,435-0500 FATAL pdflatex - Info:
2019-09-19 13:22:56,435-0500 FATAL pdflatex - Source: 
Libraries\MiKTeX\UI\Qt\mikuiqt.cpp
2019-09-19 13:22:56,435-0500 FATAL pdflatex - Line: 77
2019-09-19 13:22:56,435-0500 INFO? pdflatex - finishing with exit code 1
2019-09-19 13:26:01,857-0500 INFO? pdflatex - starting with command 
line: C:\PROGRA~1\MIKTEX~1.9\miktex\bin\x64\pdflatex.exe -halt-on-error 
-interaction=batchmode growth_model.tex
2019-09-19 13:26:01,873-0500 WARN? pdflatex - running with administrator 
privileges
2019-09-19 13:26:01,873-0500 INFO? pdflatex - allowing known shell commands
2019-09-19 13:26:01,873-0500 INFO? pdflatex - enabling input (output) 
from (to) processes
2019-09-19 13:26:02,188-0500 FATAL pdflatex - GUI framework cannot be 
initialized.
2019-09-19 13:26:02,188-0500 FATAL pdflatex - Info:
2019-09-19 13:26:02,188-0500 FATAL pdflatex - Source: 
Libraries\MiKTeX\UI\Qt\mikuiqt.cpp
2019-09-19 13:26:02,188-0500 FATAL pdflatex - Line: 77
2019-09-19 13:26:02,188-0500 INFO? pdflatex - finishing with exit code 1


*> **sessionInfo() in the Terminal


*R version 3.6.1 (2019-07-05)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 18362)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats???? graphics? grDevices utils???? datasets? methods?? base

loaded via a namespace (and not attached):
[1] compiler_3.6.1

**


	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Sat Sep 21 16:10:57 2019
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Sat, 21 Sep 2019 07:10:57 -0700
Subject: [R-pkg-devel] Fwd: Reproducing CRAN pre-tests
In-Reply-To: <CA+0rMgmfksHaBWf4ZuUy1jOqzZthU98PEybAdm3NDkrq5VC0Cw@mail.gmail.com>
References: <CA+0rMg=tgdE_phVG5+8UkiU7OC34+62Gu6xyYW5okM_KjDXWog@mail.gmail.com>
 <3f87639a-681a-a63d-354a-474a1a268b54@gmail.com>
 <CA+0rMgkAK3VnLC2DJ9upo-1ez+=GV8rfXGS=m4pmPpUQHeNQkQ@mail.gmail.com>
 <CA+0rMgmfksHaBWf4ZuUy1jOqzZthU98PEybAdm3NDkrq5VC0Cw@mail.gmail.com>
Message-ID: <f8040ec5-a22b-a0e6-3abb-3e3b0adcb7aa@gmail.com>

On 9/20/19 2:43 AM, Aravind J. wrote:
> Hi,
>
> I was able to fix the issue and submit my package successfully to CRAN.
>
> However, the question remains, is there any way to replicate the CRAN
> pre-tests locally for future debugging, particularly in a windows
> environment?
>
> I had tried rhub platforms without any success.

As this is in a recurring question I am offering a bit more detailed 
advice. In summary the setups of the CRAN systems are documented, so one 
can create easily a similar setup in a container or use those say from 
r-hub. But if that doesn't help to reproduce for whatever reason, my 
advice is don't focus too much on trying to replicate exactly the CRAN 
checking system, often it does not help to find the problem. The CRAN 
outputs have been tuned to include all necessary information.

https://cran.r-project.org/web/checks/check_flavors.html describes the 
architectures/compilers used and more information in "Details".

https://cran.r-project.org/web/checks/check_issue_kinds.html describes 
setups for additional checks (valgrind, asan, ubsan, ..).

If you can't reproduce in a container that tries to mimic some of these 
configurations, it does not necessarily mean that the container is not 
configured properly - some errors are non-deterministic or depend 
(deterministically) on things you can't control. This should not be the 
case of compiler warnings, though, I usually can reproduce these with 
the specific compiler with the same or newer version, usually even on a 
different Linux distribution or even on Windows, but rarely the 
distribution matters where it also depends say on system headers. With 
most warnings from the compiler one should be able to fix without being 
able to reproduce, only in a few cases (including -Wstringop-overflow 
though) it can be hard. Of course one has to enable the warnings that 
are not normally enabled by default.

With other kinds of errors one gets sufficiently detailed output that 
there is no need trying to reproduce the checking process. E.g. for 
memory errors with asan/ubsan/valgrind/rchk, one always has to read the 
code around the locations mentioned, no matter what, until one finds the 
error manually and fixes it. It is easy to see that something is an 
error in this case once found, and as soon as it is plausible the error 
fixed is the one reported in the CRAN outputs, I'd just check the 
package using usual means and submit a new version of the package. 
Iterating on the code, making inconsequential changes until the tool is 
happy, might lead and often does to hiding the error instead of fixing 
it, also one does not learn much from that. When one does not run the 
tool locally, the temptation is not there.

With say segfaults being able to reproduce is very important, but there 
running in a container even carefully set up to mimic the check system 
often will not help, the result is often non-deterministic. One needs to 
provoke the error on whatever system, gctorture often helped me in such 
cases, but often one has to experiment with different variants of say 
the R code example during which the segfault happened, or with different 
external libraries (say LAPACK), or with slightly different inputs. This 
is hard work, success rate increases with experience - there is no 
simple trick around it. Trying to literally mimic the test system beyond 
some point to which it is easy is often a waste of time here, I often 
instead intentionally run on many different platforms from the tested 
one, often getting in the end a reproducible crash in a different 
configuration from the one used by CRAN.? With segfaults one can also 
already switch to debug-friendly build (debug symbols, I prefer with no 
compiler optimizations) before trying the process of provoking the bug; 
if you provoke it in an optimized build, but then switch to a 
debug-friendly build, it often scares the bug away, especially the type 
of bugs that are hard to find. With segfaults and other bugs that 
require debugging, running in an external service, modifying the code to 
add checks and assertions, or even in a stripped down container, is not 
always helpful (one has to install tools for the debugging, sometimes 
this means also upgrading packages, one cannot easily do some kind of 
debugging in Docker in the default security setup). It is best to try to 
provoke the error first on the system where one normally does all 
development and debugging.

Tomas

>
> Warm Regards
>
>
> On Thu, 19 Sep 2019 at 16:45, Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
>
>> On 19/09/2019 6:51 a.m., Aravind J. wrote:
>>> Hi,
>>>
>>> I am trying to submit an updated version of my package PGRdup to CRAN.
>> The
>>> package has compiled code in C.
>>>
>>> I do development in a windows environment.
>>>
>>> The update was to fix issues in
>>> https://cran.r-project.org/web/checks/check_results_PGRdup.html.
>>>
>>> I have successfully fixed PCRE2 compatability issues and the issue with "
>>> ?strncpy? specified bound depends on the length of the source argument".
>>>
>>> For all instances of of strncpy I had changed the dependency on the
>> length
>>> of the source argument to that of destination argument.
>>>
>>> On submission, now one issue remains with debian pre-test.
>>>
>>>     /usr/include/x86_64-linux-gnu/bits/string_fortified.h:106:10:
>>> warning: ?__builtin_strncpy? specified bound depends on the length of
>>> the source argument [-Wstringop-overflow=]
>>>
>>>
>> https://win-builder.r-project.org/incoming_pretest/PGRdup_0.2.3.4_20190919_090630/Debian/00check.log
>>> How to reproduce this error. I have tried rhub platforms
>>> windows-x86_64-devel, ubuntu-gcc-release, fedora-clang-devel,
>>> linux-x86_64-rocker-gcc-san, linux-x86_64-rocker-gcc-san and ubuntu-rchk
>>> without any success.
>>>
>>> How to reproduce the pre-test results in a windows environment? and how
>> to
>>> fix this specific error?
>>>
>> The install.out file points to the error here:
>>
>> fdouble_metaphone.c: In function ?DoubleMetaphone?:
>> fdouble_metaphone.c:271:33: note: length computed here
>>     271 |     strncpy(original->str, str, strlen(str) + 1);
>>
>> Presumably you need to limit the copy to the destination length.
>>
>> Duncan Murdoch
>>
>


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun Sep 22 20:33:23 2019
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 22 Sep 2019 13:33:23 -0500
Subject: [R-pkg-devel] How to submit to CRAN from GitHub?
In-Reply-To: <5d87916428c38_43fbdb003ba1c15084a@6c59b2b4-ab90-4730-93a3-772dd0f5a76a.mail>
References: <5d87916428c38_43fbdb003ba1c15084a@6c59b2b4-ab90-4730-93a3-772dd0f5a76a.mail>
Message-ID: <9f77d755-2fd5-eac0-c322-e12abc8fd545@effectivedefense.org>

Hello:


 ????? Two questions:


HOW TO SUBMIT TO CRAN FROM GITHUB:? Is there a standard method for 
submitting to CRAN from GitHub?? (There's a simple protocol for 
submitting to CRAN from R-Forge, but I've experienced insurmountable 
problems using R-Forge recently.)


PACKAGE STILL FAILING TRAVIS CI:? The latest report from 
builds at travis-ci.org on my Ecdat package for R on GitHub ends with 
"Found warnings, treating as errors (as requested)."? The word "warning" 
appears in that report over 100 times.? I didn't see anything there that 
suggested to me anything I understand how to change.


NOTE:? "R CMD build Ecdat --resave-data" followed by "R CMD check 
Ecdat_0.3.3-tar.gz" completed with no errors, warnings or notes under 
macOS 10.14.6 and Windows 7 and 10.


 ????? Thanks,
 ????? Spencer Graves


-------- Forwarded Message --------
Subject: 	Still Failing: sbgraves237/Ecdat#9 (master - c680f08)
Date: 	Sun, 22 Sep 2019 15:21:08 +0000
From: 	Travis CI <builds at travis-ci.org>
To: 	spencer.graves at effectivedefense.org



sbgraves237

/

Ecdat

<https://travis-ci.org/sbgraves237/Ecdat?utm_medium=notification&utm_source=email> 


branch iconmaster <https://github.com/sbgraves237/Ecdat/tree/master>

build has failed
Build #9 is still failing 
<https://travis-ci.org/sbgraves237/Ecdat/builds/588124072?utm_medium=notification&utm_source=email>
arrow to build time
clock icon5 mins and 8 secs

sbgraves237 avatarsbgraves237

c680f08 CHANGESET ? 
<https://github.com/sbgraves237/Ecdat/compare/cd2bdef45642...c680f08d04b8>

roll date

Want to know about upcoming build environment updates?

Would you like to stay up-to-date with the upcoming Travis CI build 
environment updates? We set up a mailing list for you!

SIGN UP HERE <http://eepurl.com/9OCsP>

book icon

Documentation <https://docs.travis-ci.com/> about Travis CI

Have any questions? We're here to help. <mailto:support at travis-ci.com>
Unsubscribe 
<https://travis-ci.org/account/preferences/unsubscribe?repository=25157200&utm_medium=notification&utm_source=email> 
from build emails from the sbgraves237/Ecdat repository.
To unsubscribe from *all* build emails, please update your settings 
<https://travis-ci.org/account/preferences/unsubscribe?utm_medium=notification&utm_source=email>. 

black and white travis ci logo <https://travis-ci.com>

Travis CI GmbH, Rigaer Str. 8, 10427 Berlin, Germany | GF/CEO: Randy 
Jacops | Contact: contact at travis-ci.com <mailto:contact at travis-ci.com> | 
Amtsgericht Charlottenburg, Berlin, HRB 140133 B | Umsatzsteuer-ID gem?? 
?27 a Umsatzsteuergesetz: DE282002648


	[[alternative HTML version deleted]]


From wo||g@ng@|enh@rd @end|ng |rom un|-wuerzburg@de  Sun Sep 22 20:43:13 2019
From: wo||g@ng@|enh@rd @end|ng |rom un|-wuerzburg@de (Wolfgang Lenhard)
Date: Sun, 22 Sep 2019 20:43:13 +0200
Subject: [R-pkg-devel] How to submit to CRAN from GitHub?
In-Reply-To: <9f77d755-2fd5-eac0-c322-e12abc8fd545@effectivedefense.org>
References: <5d87916428c38_43fbdb003ba1c15084a@6c59b2b4-ab90-4730-93a3-772dd0f5a76a.mail>
 <9f77d755-2fd5-eac0-c322-e12abc8fd545@effectivedefense.org>
Message-ID: <2edcbff0-c3ec-a668-b41a-d3891d893fe6@uni-wuerzburg.de>

Dear Spencer,
release: not directly, but via devtools in RStudio. Please have a look 
at the fantastic description from Hadley Wickham: 
http://r-pkgs.had.co.nz/release.html

Best,
 ??? Wolfgang

Am 22.09.19 um 20:33 schrieb Spencer Graves:
> Hello:
>
>
>   ????? Two questions:
>
>
> HOW TO SUBMIT TO CRAN FROM GITHUB:? Is there a standard method for
> submitting to CRAN from GitHub?? (There's a simple protocol for
> submitting to CRAN from R-Forge, but I've experienced insurmountable
> problems using R-Forge recently.)
>
>
> PACKAGE STILL FAILING TRAVIS CI:? The latest report from
> builds at travis-ci.org on my Ecdat package for R on GitHub ends with
> "Found warnings, treating as errors (as requested)."? The word "warning"
> appears in that report over 100 times.? I didn't see anything there that
> suggested to me anything I understand how to change.
>
>
> NOTE:? "R CMD build Ecdat --resave-data" followed by "R CMD check
> Ecdat_0.3.3-tar.gz" completed with no errors, warnings or notes under
> macOS 10.14.6 and Windows 7 and 10.
>
>
>   ????? Thanks,
>   ????? Spencer Graves
>
>
> -------- Forwarded Message --------
> Subject: 	Still Failing: sbgraves237/Ecdat#9 (master - c680f08)
> Date: 	Sun, 22 Sep 2019 15:21:08 +0000
> From: 	Travis CI <builds at travis-ci.org>
> To: 	spencer.graves at effectivedefense.org
>
>
>
> sbgraves237
>
> /
>
> Ecdat
>
> <https://travis-ci.org/sbgraves237/Ecdat?utm_medium=notification&utm_source=email>
>
>
> branch iconmaster <https://github.com/sbgraves237/Ecdat/tree/master>
>
> build has failed
> Build #9 is still failing
> <https://travis-ci.org/sbgraves237/Ecdat/builds/588124072?utm_medium=notification&utm_source=email>
> arrow to build time
> clock icon5 mins and 8 secs
>
> sbgraves237 avatarsbgraves237
>
> c680f08 CHANGESET ?
> <https://github.com/sbgraves237/Ecdat/compare/cd2bdef45642...c680f08d04b8>
>
> roll date
>
> Want to know about upcoming build environment updates?
>
> Would you like to stay up-to-date with the upcoming Travis CI build
> environment updates? We set up a mailing list for you!
>
> SIGN UP HERE <http://eepurl.com/9OCsP>
>
> book icon
>
> Documentation <https://docs.travis-ci.com/> about Travis CI
>
> Have any questions? We're here to help. <mailto:support at travis-ci.com>
> Unsubscribe
> <https://travis-ci.org/account/preferences/unsubscribe?repository=25157200&utm_medium=notification&utm_source=email>
> from build emails from the sbgraves237/Ecdat repository.
> To unsubscribe from *all* build emails, please update your settings
> <https://travis-ci.org/account/preferences/unsubscribe?utm_medium=notification&utm_source=email>.
>
> black and white travis ci logo <https://travis-ci.com>
>
> Travis CI GmbH, Rigaer Str. 8, 10427 Berlin, Germany | GF/CEO: Randy
> Jacops | Contact: contact at travis-ci.com <mailto:contact at travis-ci.com> |
> Amtsgericht Charlottenburg, Berlin, HRB 140133 B | Umsatzsteuer-ID gem??
> ?27 a Umsatzsteuergesetz: DE282002648
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From d@v|dhughjone@ @end|ng |rom gm@||@com  Sun Sep 22 22:39:22 2019
From: d@v|dhughjone@ @end|ng |rom gm@||@com (David Hugh-Jones)
Date: Sun, 22 Sep 2019 21:39:22 +0100
Subject: [R-pkg-devel] How to submit to CRAN from GitHub?
In-Reply-To: <9f77d755-2fd5-eac0-c322-e12abc8fd545@effectivedefense.org>
References: <5d87916428c38_43fbdb003ba1c15084a@6c59b2b4-ab90-4730-93a3-772dd0f5a76a.mail>
 <9f77d755-2fd5-eac0-c322-e12abc8fd545@effectivedefense.org>
Message-ID: <CAARY7kiNdGboi0R49p+z8VoYjrokR95AX-1HoqanmTdHrupBYw@mail.gmail.com>

If you click on the ?check? log in travis, you will find:

* checking data for ASCII and uncompressed saves ... WARNING
1411
1412 Note: significantly better compression could be obtained
1413 by using R CMD build --resave-data


(Excuse the poor formatting ? posting from my phone.)

This suggests you need to compress your data (there may be a usethis::
function to do this also).

There?s no especial way to submit from GitHub, though I find the approach
taken by devtools::release() to be quite helpful.

D

On Sun, 22 Sep 2019 at 19:33, Spencer Graves <
spencer.graves at effectivedefense.org> wrote:

> Hello:
>
>
>        Two questions:
>
>
> HOW TO SUBMIT TO CRAN FROM GITHUB:  Is there a standard method for
> submitting to CRAN from GitHub?  (There's a simple protocol for
> submitting to CRAN from R-Forge, but I've experienced insurmountable
> problems using R-Forge recently.)
>
>
> PACKAGE STILL FAILING TRAVIS CI:  The latest report from
> builds at travis-ci.org on my Ecdat package for R on GitHub ends with
> "Found warnings, treating as errors (as requested)."  The word "warning"
> appears in that report over 100 times.  I didn't see anything there that
> suggested to me anything I understand how to change.
>
>
> NOTE:  "R CMD build Ecdat --resave-data" followed by "R CMD check
> Ecdat_0.3.3-tar.gz" completed with no errors, warnings or notes under
> macOS 10.14.6 and Windows 7 and 10.
>
>
>        Thanks,
>        Spencer Graves
>
>
> -------- Forwarded Message --------
> Subject:        Still Failing: sbgraves237/Ecdat#9 (master - c680f08)
> Date:   Sun, 22 Sep 2019 15:21:08 +0000
> From:   Travis CI <builds at travis-ci.org>
> To:     spencer.graves at effectivedefense.org
>
>
>
> sbgraves237
>
> /
>
> Ecdat
>
> <
> https://travis-ci.org/sbgraves237/Ecdat?utm_medium=notification&utm_source=email>
>
>
>
> branch iconmaster <https://github.com/sbgraves237/Ecdat/tree/master>
>
> build has failed
> Build #9 is still failing
> <
> https://travis-ci.org/sbgraves237/Ecdat/builds/588124072?utm_medium=notification&utm_source=email
> >
> arrow to build time
> clock icon5 mins and 8 secs
>
> sbgraves237 avatarsbgraves237
>
> c680f08 CHANGESET ?
> <https://github.com/sbgraves237/Ecdat/compare/cd2bdef45642...c680f08d04b8>
>
> roll date
>
> Want to know about upcoming build environment updates?
>
> Would you like to stay up-to-date with the upcoming Travis CI build
> environment updates? We set up a mailing list for you!
>
> SIGN UP HERE <http://eepurl.com/9OCsP>
>
> book icon
>
> Documentation <https://docs.travis-ci.com/> about Travis CI
>
> Have any questions? We're here to help. <mailto:support at travis-ci.com>
> Unsubscribe
> <
> https://travis-ci.org/account/preferences/unsubscribe?repository=25157200&utm_medium=notification&utm_source=email>
>
> from build emails from the sbgraves237/Ecdat repository.
> To unsubscribe from *all* build emails, please update your settings
> <
> https://travis-ci.org/account/preferences/unsubscribe?utm_medium=notification&utm_source=email>.
>
>
> black and white travis ci logo <https://travis-ci.com>
>
> Travis CI GmbH, Rigaer Str. 8
> <https://www.google.com/maps/search/Rigaer+Str.+8?entry=gmail&source=g>,
> 10427 Berlin, Germany | GF/CEO: Randy
> Jacops | Contact: contact at travis-ci.com <mailto:contact at travis-ci.com> |
> Amtsgericht Charlottenburg, Berlin, HRB 140133 B | Umsatzsteuer-ID gem??
> ?27 a Umsatzsteuergesetz: DE282002648
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
-- 
Sent from Gmail Mobile

	[[alternative HTML version deleted]]


From D|vy@n@h@Ag@rw@| @end|ng |rom pennmed|c|ne@upenn@edu  Mon Sep 23 10:44:37 2019
From: D|vy@n@h@Ag@rw@| @end|ng |rom pennmed|c|ne@upenn@edu (Agarwal, Divyansh)
Date: Mon, 23 Sep 2019 08:44:37 +0000
Subject: [R-pkg-devel] Packages required and available but unsuitable
 versions: Error
Message-ID: <36B9C8E7-7D77-4E2A-833A-B022DD82DB51@pennmedicine.upenn.edu>

Dear R developers community,

I?m trying to build and submit an R package to CRAN but keep getting the following error:
Packages required and available but unsuitable versions:
  'org.Hs.eg.db', 'org.Mm.eg.db', 'org.Ce.eg.db'

The DESCRIPTION file for my package includes the following:
Depends:
  R (>= 3.5.0),
  stats (>= 3.5.0),
  MASS (>= 7.3-49),
Encoding: UTF-8
Imports:
  nbpMatching (>= 1.5.1),
  crossmatch (>= 1.3-1),
  Matrix (>= 1.2-17),
  org.Hs.eg.db (>= 3.6.0),
  org.Mm.eg.db (>= 3.6.0),
  org.Ce.eg.db (>= 3.6.0),
  Seurat (>= 3.0.0),
  AnnotationDbi (>= 1.42.1)

The details of the error log are here: <https://win-builder.r-project.org/incoming_pretest/multicross_2.0.0_20190923_044655/>

I?ve tried a few different things such as specifying an R version under ?Depends? or updating the version for the ?org.? packages to the latest version (>=3.8) but I haven?t been able to resolve the error and warnings shown in the error log.  I would be really grateful to you if you could kindly advise a potential solution for how to possibly fix this error.

Thanks a lot in advance!
Divyansh



	[[alternative HTML version deleted]]


From mtmorg@n@b|oc @end|ng |rom gm@||@com  Mon Sep 23 13:44:06 2019
From: mtmorg@n@b|oc @end|ng |rom gm@||@com (Martin Morgan)
Date: Mon, 23 Sep 2019 11:44:06 +0000
Subject: [R-pkg-devel] Packages required and available but unsuitable
 versions: Error
In-Reply-To: <36B9C8E7-7D77-4E2A-833A-B022DD82DB51@pennmedicine.upenn.edu>
References: <36B9C8E7-7D77-4E2A-833A-B022DD82DB51@pennmedicine.upenn.edu>
Message-ID: <CY4PR05MB360708ACC135477E73888064F9850@CY4PR05MB3607.namprd05.prod.outlook.com>

Probably the easiest 'solution' is to remove the version dependencies, e.g., 'org.Hs.eg.db, org.Mm.eg.db, ...'.

I suspect that the root cause is that the Windows builders do not have the correct version of these packages installed for the version of R in use, perhaps because the version of the package BiocVersion (it should be 3.10.1 in R-devel) is incorrect.

Martin Morgan
Bioconductor

?On 9/23/19, 6:06 AM, "R-package-devel on behalf of Agarwal, Divyansh" <r-package-devel-bounces at r-project.org on behalf of Divyansh.Agarwal at pennmedicine.upenn.edu> wrote:

    Dear R developers community,
    
    I?m trying to build and submit an R package to CRAN but keep getting the following error:
    Packages required and available but unsuitable versions:
      'org.Hs.eg.db', 'org.Mm.eg.db', 'org.Ce.eg.db'
    
    The DESCRIPTION file for my package includes the following:
    Depends:
      R (>= 3.5.0),
      stats (>= 3.5.0),
      MASS (>= 7.3-49),
    Encoding: UTF-8
    Imports:
      nbpMatching (>= 1.5.1),
      crossmatch (>= 1.3-1),
      Matrix (>= 1.2-17),
      org.Hs.eg.db (>= 3.6.0),
      org.Mm.eg.db (>= 3.6.0),
      org.Ce.eg.db (>= 3.6.0),
      Seurat (>= 3.0.0),
      AnnotationDbi (>= 1.42.1)
    
    The details of the error log are here: <https://win-builder.r-project.org/incoming_pretest/multicross_2.0.0_20190923_044655/>
    
    I?ve tried a few different things such as specifying an R version under ?Depends? or updating the version for the ?org.? packages to the latest version (>=3.8) but I haven?t been able to resolve the error and warnings shown in the error log.  I would be really grateful to you if you could kindly advise a potential solution for how to possibly fix this error.
    
    Thanks a lot in advance!
    Divyansh
    
    
    
    	[[alternative HTML version deleted]]
    
    ______________________________________________
    R-package-devel at r-project.org mailing list
    https://stat.ethz.ch/mailman/listinfo/r-package-devel
    

From D|vy@n@h@Ag@rw@| @end|ng |rom pennmed|c|ne@upenn@edu  Mon Sep 23 14:45:15 2019
From: D|vy@n@h@Ag@rw@| @end|ng |rom pennmed|c|ne@upenn@edu (Agarwal, Divyansh)
Date: Mon, 23 Sep 2019 12:45:15 +0000
Subject: [R-pkg-devel] 
 [External] Re: Packages required and available but
 unsuitable versions: Error
Message-ID: <8941E0E7-B1E0-4C76-9DD6-125716BD49A2@pennmedicine.upenn.edu>

Hi Martin,

Thanks so much. Removing the version dependencies for those 3 packages fixed the ERROR but I'm now having an issue with these WARNINGS:
Warning: replacing previous import ?AnnotationDbi::select? by ?MASS::select? when loading ?multicross?
Warning: replacing previous import ?Matrix::cov2cor? by ?stats::cov2cor? when loading ?multicross?
Warning: replacing previous import ?Matrix::toeplitz? by ?stats::toeplitz? when loading ?multicross?
Warning: replacing previous import ?nbpMatching::quantile? by ?stats::quantile? when loading ?multicross?
Warning: replacing previous import ?Matrix::update? by ?stats::update? when loading ?multicross?

Looking at a couple of forums I thought putting stats and MASS under "Depends" in the DESCRIPTION file would address these warnings, but they still come up. For reference, my DESCRIPTION file is ?

Depends:
          stats (>= 3.5.0),
          MASS (>= 7.3-49),
Encoding: UTF-8
 Imports:
          nbpMatching (>= 1.5.1),
          crossmatch (>= 1.3-1),
          Matrix (>= 1.2-17),
          org.Hs.eg.db (>= 3.6.0),
          org.Mm.eg.db (>= 3.6.0),
          org.Ce.eg.db (>= 3.6.0),
          Seurat (>= 3.0.0),
          AnnotationDbi (>= 1.42.1)

Please let me know what you'd recommend. Thank you again for taking the time to offer your help, and am really grateful for your suggestions. 

Sincerely,
Divyansh


?On 9/23/19, 7:44 AM, "Martin Morgan" <mtmorgan.bioc at gmail.com> wrote:

    Probably the easiest 'solution' is to remove the version dependencies, e.g., 'org.Hs.eg.db, org.Mm.eg.db, ...'.
    
    I suspect that the root cause is that the Windows builders do not have the correct version of these packages installed for the version of R in use, perhaps because the version of the package BiocVersion (it should be 3.10.1 in R-devel) is incorrect.
    
    Martin Morgan
    Bioconductor
    
    On 9/23/19, 6:06 AM, "R-package-devel on behalf of Agarwal, Divyansh" <r-package-devel-bounces at r-project.org on behalf of Divyansh.Agarwal at pennmedicine.upenn.edu> wrote:
    
        Dear R developers community,
        
        I?m trying to build and submit an R package to CRAN but keep getting the following error:
        Packages required and available but unsuitable versions:
          'org.Hs.eg.db', 'org.Mm.eg.db', 'org.Ce.eg.db'
        
        The DESCRIPTION file for my package includes the following:
        Depends:
          R (>= 3.5.0),
          stats (>= 3.5.0),
          MASS (>= 7.3-49),
        Encoding: UTF-8
        Imports:
          nbpMatching (>= 1.5.1),
          crossmatch (>= 1.3-1),
          Matrix (>= 1.2-17),
          org.Hs.eg.db (>= 3.6.0),
          org.Mm.eg.db (>= 3.6.0),
          org.Ce.eg.db (>= 3.6.0),
          Seurat (>= 3.0.0),
          AnnotationDbi (>= 1.42.1)
        
        The details of the error log are here: <https://win-builder.r-project.org/incoming_pretest/multicross_2.0.0_20190923_044655/>
        
        I?ve tried a few different things such as specifying an R version under ?Depends? or updating the version for the ?org.? packages to the latest version (>=3.8) but I haven?t been able to resolve the error and warnings shown in the error log.  I would be really grateful to you if you could kindly advise a potential solution for how to possibly fix this error.
        
        Thanks a lot in advance!
        Divyansh
        
        
        
        	[[alternative HTML version deleted]]
        
        ______________________________________________
        R-package-devel at r-project.org mailing list
        https://stat.ethz.ch/mailman/listinfo/r-package-devel
        
    


From mtmorg@n@b|oc @end|ng |rom gm@||@com  Mon Sep 23 15:41:58 2019
From: mtmorg@n@b|oc @end|ng |rom gm@||@com (Martin Morgan)
Date: Mon, 23 Sep 2019 13:41:58 +0000
Subject: [R-pkg-devel] 
 [External] Re: Packages required and available but
 unsuitable versions: Error
In-Reply-To: <8941E0E7-B1E0-4C76-9DD6-125716BD49A2@pennmedicine.upenn.edu>
References: <8941E0E7-B1E0-4C76-9DD6-125716BD49A2@pennmedicine.upenn.edu>
Message-ID: <CY4PR05MB3607AAECDA7D733FA9FAF249F9850@CY4PR05MB3607.namprd05.prod.outlook.com>

The warnings are fixed by changing the NAMESPACE file, not the DESCRIPTION file. Decide which function(s) you would like to import, and import only those using importFrom("Matrix", "sparseMatrix") or import("Matrix", except = "toeplitz")

Martin

?On 9/23/19, 8:45 AM, "Agarwal, Divyansh" <Divyansh.Agarwal at pennmedicine.upenn.edu> wrote:

    Hi Martin,
    
    Thanks so much. Removing the version dependencies for those 3 packages fixed the ERROR but I'm now having an issue with these WARNINGS:
    Warning: replacing previous import ?AnnotationDbi::select? by ?MASS::select? when loading ?multicross?
    Warning: replacing previous import ?Matrix::cov2cor? by ?stats::cov2cor? when loading ?multicross?
    Warning: replacing previous import ?Matrix::toeplitz? by ?stats::toeplitz? when loading ?multicross?
    Warning: replacing previous import ?nbpMatching::quantile? by ?stats::quantile? when loading ?multicross?
    Warning: replacing previous import ?Matrix::update? by ?stats::update? when loading ?multicross?
    
    Looking at a couple of forums I thought putting stats and MASS under "Depends" in the DESCRIPTION file would address these warnings, but they still come up. For reference, my DESCRIPTION file is ?
    
    Depends:
              stats (>= 3.5.0),
              MASS (>= 7.3-49),
    Encoding: UTF-8
     Imports:
              nbpMatching (>= 1.5.1),
              crossmatch (>= 1.3-1),
              Matrix (>= 1.2-17),
              org.Hs.eg.db (>= 3.6.0),
              org.Mm.eg.db (>= 3.6.0),
              org.Ce.eg.db (>= 3.6.0),
              Seurat (>= 3.0.0),
              AnnotationDbi (>= 1.42.1)
    
    Please let me know what you'd recommend. Thank you again for taking the time to offer your help, and am really grateful for your suggestions. 
    
    Sincerely,
    Divyansh
    
    
    ?On 9/23/19, 7:44 AM, "Martin Morgan" <mtmorgan.bioc at gmail.com> wrote:
    
        Probably the easiest 'solution' is to remove the version dependencies, e.g., 'org.Hs.eg.db, org.Mm.eg.db, ...'.
        
        I suspect that the root cause is that the Windows builders do not have the correct version of these packages installed for the version of R in use, perhaps because the version of the package BiocVersion (it should be 3.10.1 in R-devel) is incorrect.
        
        Martin Morgan
        Bioconductor
        
        On 9/23/19, 6:06 AM, "R-package-devel on behalf of Agarwal, Divyansh" <r-package-devel-bounces at r-project.org on behalf of Divyansh.Agarwal at pennmedicine.upenn.edu> wrote:
        
            Dear R developers community,
            
            I?m trying to build and submit an R package to CRAN but keep getting the following error:
            Packages required and available but unsuitable versions:
              'org.Hs.eg.db', 'org.Mm.eg.db', 'org.Ce.eg.db'
            
            The DESCRIPTION file for my package includes the following:
            Depends:
              R (>= 3.5.0),
              stats (>= 3.5.0),
              MASS (>= 7.3-49),
            Encoding: UTF-8
            Imports:
              nbpMatching (>= 1.5.1),
              crossmatch (>= 1.3-1),
              Matrix (>= 1.2-17),
              org.Hs.eg.db (>= 3.6.0),
              org.Mm.eg.db (>= 3.6.0),
              org.Ce.eg.db (>= 3.6.0),
              Seurat (>= 3.0.0),
              AnnotationDbi (>= 1.42.1)
            
            The details of the error log are here: <https://win-builder.r-project.org/incoming_pretest/multicross_2.0.0_20190923_044655/>
            
            I?ve tried a few different things such as specifying an R version under ?Depends? or updating the version for the ?org.? packages to the latest version (>=3.8) but I haven?t been able to resolve the error and warnings shown in the error log.  I would be really grateful to you if you could kindly advise a potential solution for how to possibly fix this error.
            
            Thanks a lot in advance!
            Divyansh
            
            
            
            	[[alternative HTML version deleted]]
            
            ______________________________________________
            R-package-devel at r-project.org mailing list
            https://stat.ethz.ch/mailman/listinfo/r-package-devel
            
        
    
    

From tdhock5 @end|ng |rom gm@||@com  Tue Sep 24 01:57:47 2019
From: tdhock5 @end|ng |rom gm@||@com (Toby Hocking)
Date: Mon, 23 Sep 2019 16:57:47 -0700
Subject: [R-pkg-devel] unicode WARNING on solaris?
Message-ID: <CALK03d2u57jz2FgTmW_=poVy27rYXKFxQXa2ssp+e5QSdYwZoQ@mail.gmail.com>

Hi all,

is there a known fix for this WARNING which I am getting on solaris for my
newly submitted nc package?
https://www.r-project.org/nosvn/R.check/r-patched-solaris-x86/nc-00check.html

A quick google search for "it is not known that wchar_t is Unicode on this
platform cran" shows that many other packages have this WARNING as well.

I searched r-devel and r-pkg-devel for the warning text but I did not find
any messages discussing a fix.

Thanks for any help
Toby

	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Tue Sep 24 10:38:41 2019
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Tue, 24 Sep 2019 10:38:41 +0200
Subject: [R-pkg-devel] unicode WARNING on solaris?
In-Reply-To: <CALK03d2u57jz2FgTmW_=poVy27rYXKFxQXa2ssp+e5QSdYwZoQ@mail.gmail.com>
References: <CALK03d2u57jz2FgTmW_=poVy27rYXKFxQXa2ssp+e5QSdYwZoQ@mail.gmail.com>
Message-ID: <a95fe0a8-24bc-7575-ddfa-0604bad8261b@gmail.com>

On 9/24/19 1:57 AM, Toby Hocking wrote:
> Hi all,
>
> is there a known fix for this WARNING which I am getting on solaris for my
> newly submitted nc package?
> https://www.r-project.org/nosvn/R.check/r-patched-solaris-x86/nc-00check.html

It seems that deparse() came across some non-printable characters. Such 
characters would be replaced by \U or \u escapes. This is implemented 
using wide characters in R, but on that platform __STDC_ISO_10646__ is 
not defined, so wchar_t has unknown representation (not known to be 
Unicode), hence the warning.

Best
Tomas

>
> A quick google search for "it is not known that wchar_t is Unicode on this
> platform cran" shows that many other packages have this WARNING as well.
>
> I searched r-devel and r-pkg-devel for the warning text but I did not find
> any messages discussing a fix.
>
> Thanks for any help
> Toby
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@  Tue Sep 24 12:10:08 2019
From: @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@ (Sameh M. Abdulah)
Date: Tue, 24 Sep 2019 10:10:08 +0000
Subject: [R-pkg-devel] Package or namespace load failed: undefined symbol
Message-ID: <DD7DFEE9-3EEF-4F98-80F4-6467C10203AA@kaust.edu.sa>

Hi,

I am uploading my R package to CRAN. One of the dynamic libraries the package requires depends on LAPACKE library which usually integrated with BLAS and CBLAS in the same .so file (as I understand). CRAN has OpenBLAS already installed on the system. However, this OpenBLAS library does not maintain implementation of LAPACKE library. Thus, I have modified my configure file to install a standalone OpenBLAS library to use it.

The problem that my installation has successfully passed, however, CRAN fails in loading my package giving me this error:

/srv/hornik/tmp/CRAN/exageostatr.Rcheck/exageostatr/lib/libcoreblas.so: undefined symbol: LAPACKE_slarfb_work

LAPACKE_slarfb_work is a function defined in the LAPACKE library. I have tried to set the PKG_LIBS path to my OpenBLAS lib but again it fails.

Any suggestions?


--Sameh

	[[alternative HTML version deleted]]


From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Tue Sep 24 14:16:26 2019
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (SP))
Date: Tue, 24 Sep 2019 12:16:26 +0000
Subject: [R-pkg-devel] Require <package>-package.Rd?
Message-ID: <581a012f01524e6b887582a574fc0a7b@UM-MAIL3214.unimaas.nl>

Hi All,

When starting to work with an unfamiliar package, one might typically look for vignettes, a paper/book accompanying the package, a package website, and of course the help files themselves, but

help(package="<package>")

is often not so useful -- such a listing of functions (with titles) might not clarify what the main 'workhorses' of the package are and how to get started. Personally, the first thing I do is try:

help(<package>)

in the hopes that the package author(s) have created a <package>-package.Rd file to get new users started (or to point them to appropriate places to get going). In my experience, if such a package help file is available, it is tremendously useful.

Unfortunately, many packages do not provide a <package>-package.Rd file. I am curious how others and CRAN members would feel about making this a requirement (not retrospectively, but at least for new / resubmissions).

Best,
Wolfgang


From Jor|@@Mey@ @end|ng |rom ugent@be  Tue Sep 24 14:29:15 2019
From: Jor|@@Mey@ @end|ng |rom ugent@be (Joris Meys)
Date: Tue, 24 Sep 2019 14:29:15 +0200
Subject: [R-pkg-devel] Require <package>-package.Rd?
In-Reply-To: <581a012f01524e6b887582a574fc0a7b@UM-MAIL3214.unimaas.nl>
References: <581a012f01524e6b887582a574fc0a7b@UM-MAIL3214.unimaas.nl>
Message-ID: <CAO1zAVaJjGdoJgp0+OwCk0qd5Ch-bhR7KdV8jf-bRqThwHTEXg@mail.gmail.com>

Dear Dr. Vichtbauer,

I'm not a CRAN member, but I personally think this is a sensible
requirement. I try to include those in every package myself, even if it's
only to direct people to a vignette.

That said, I do look for vignettes first when I encounter an unfamiliar
package actually. That format gives more possibilities for giving a good
introduction to the package imho.

My humble 2 cents
Cheers
Joris

On Tue, Sep 24, 2019 at 2:17 PM Viechtbauer, Wolfgang (SP) <
wolfgang.viechtbauer at maastrichtuniversity.nl> wrote:

> Hi All,
>
> When starting to work with an unfamiliar package, one might typically look
> for vignettes, a paper/book accompanying the package, a package website,
> and of course the help files themselves, but
>
> help(package="<package>")
>
> is often not so useful -- such a listing of functions (with titles) might
> not clarify what the main 'workhorses' of the package are and how to get
> started. Personally, the first thing I do is try:
>
> help(<package>)
>
> in the hopes that the package author(s) have created a
> <package>-package.Rd file to get new users started (or to point them to
> appropriate places to get going). In my experience, if such a package help
> file is available, it is tremendously useful.
>
> Unfortunately, many packages do not provide a <package>-package.Rd file. I
> am curious how others and CRAN members would feel about making this a
> requirement (not retrospectively, but at least for new / resubmissions).
>
> Best,
> Wolfgang
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


-- 
Joris Meys
Statistical consultant

Department of Data Analysis and Mathematical Modelling
Ghent University
Coupure Links 653, B-9000 Gent (Belgium)
<https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>

tel: +32 (0)9 264 61 79
-----------
Biowiskundedagen 2017-2018
http://www.biowiskundedagen.ugent.be/

-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Tue Sep 24 14:38:44 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Tue, 24 Sep 2019 07:38:44 -0500
Subject: [R-pkg-devel] Require <package>-package.Rd?
In-Reply-To: <CAO1zAVaJjGdoJgp0+OwCk0qd5Ch-bhR7KdV8jf-bRqThwHTEXg@mail.gmail.com>
References: <581a012f01524e6b887582a574fc0a7b@UM-MAIL3214.unimaas.nl>
 <CAO1zAVaJjGdoJgp0+OwCk0qd5Ch-bhR7KdV8jf-bRqThwHTEXg@mail.gmail.com>
Message-ID: <23946.3668.197881.103624@rob.eddelbuettel.com>


Wolfgang, Joris,

This may not necessarily work -- see "Goodhart's Law" [1]

Once you impose something like this, (some) will skirt it with just the
minimum requirement of an (essentially) empty file.  An existing set of
examples is provided by the vignettes of (at least) one developer which each
consist (or consisted ?) of just a single line with a hyperlink to the
corresponding package website.  Passes the letter of the law (hey, look, a
vignette) and all possible tests, but clearly violates the spirit of the law
that documentation and package should be self-contained (and no, connectivity
should not be assumed).

Moral persuasion may be better. We should encourage best practices and
highlight packages that follow them.

Dirk


[1] https://en.wikipedia.org/wiki/Goodhart%27s_law

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Tue Sep 24 14:50:09 2019
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (SP))
Date: Tue, 24 Sep 2019 12:50:09 +0000
Subject: [R-pkg-devel] Require <package>-package.Rd?
In-Reply-To: <23946.3668.197881.103624@rob.eddelbuettel.com>
References: <581a012f01524e6b887582a574fc0a7b@UM-MAIL3214.unimaas.nl>
 <CAO1zAVaJjGdoJgp0+OwCk0qd5Ch-bhR7KdV8jf-bRqThwHTEXg@mail.gmail.com>
 <23946.3668.197881.103624@rob.eddelbuettel.com>
Message-ID: <caa6eb0fe4944d4cb95dedd352216925@UM-MAIL3214.unimaas.nl>

Hi Dirk,

Point well taken, but the same goes for many other CRAN requirements. For example, I can create totally useless help files for all the functions that pass all checks. Just because some will try to skirt around a requirement doesn't mean it's a useless requirement. In fact, the point of such requirements is to promote good practices and I would like to believe that most package authors would make an honest effort to create a somewhat useful <package>-package.Rd file, even (as Joris pointed out) it is essentially just a pointer to the vignette(s) (which is also useful).

Best,
Wolfgang

-----Original Message-----
From: Dirk Eddelbuettel [mailto:edd at debian.org] 
Sent: Tuesday, 24 September, 2019 14:39
To: Joris.Meys at ugent.be
Cc: Viechtbauer, Wolfgang (SP); r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Require <package>-package.Rd?

Wolfgang, Joris,

This may not necessarily work -- see "Goodhart's Law" [1]

Once you impose something like this, (some) will skirt it with just the
minimum requirement of an (essentially) empty file.  An existing set of
examples is provided by the vignettes of (at least) one developer which each
consist (or consisted ?) of just a single line with a hyperlink to the
corresponding package website.  Passes the letter of the law (hey, look, a
vignette) and all possible tests, but clearly violates the spirit of the law
that documentation and package should be self-contained (and no, connectivity
should not be assumed).

Moral persuasion may be better. We should encourage best practices and
highlight packages that follow them.

Dirk


[1] https://en.wikipedia.org/wiki/Goodhart%27s_law

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Tue Sep 24 15:02:07 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Tue, 24 Sep 2019 13:02:07 +0000
Subject: [R-pkg-devel] Require <package>-package.Rd?
In-Reply-To: <581a012f01524e6b887582a574fc0a7b@UM-MAIL3214.unimaas.nl>
References: <581a012f01524e6b887582a574fc0a7b@UM-MAIL3214.unimaas.nl>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E01CC77C076@MBXP01.ds.man.ac.uk>

It is worth noting that 

help(package="<package>")

shows  file <package>-package.Rd, while 

help(<package>)

shows topic "package".

Topic <package>-package.Rd is also printed at the top of the pdf manual, while package.Rd follows the alphabetical ordering of the remaining topics. It is unfortunate that Hadley Wickham's tools (at least 'pkgdown') recommend and use <package>.Rd, instead of <package>-package.Rd as overall package description. 

Georgi Boshnakov



-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Viechtbauer, Wolfgang (SP)
Sent: 24 September 2019 13:16
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Require <package>-package.Rd?

Hi All,

When starting to work with an unfamiliar package, one might typically look for vignettes, a paper/book accompanying the package, a package website, and of course the help files themselves, but

help(package="<package>")

is often not so useful -- such a listing of functions (with titles) might not clarify what the main 'workhorses' of the package are and how to get started. Personally, the first thing I do is try:

help(<package>)

in the hopes that the package author(s) have created a <package>-package.Rd file to get new users started (or to point them to appropriate places to get going). In my experience, if such a package help file is available, it is tremendously useful.

Unfortunately, many packages do not provide a <package>-package.Rd file. I am curious how others and CRAN members would feel about making this a requirement (not retrospectively, but at least for new / resubmissions).

Best,
Wolfgang

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Tue Sep 24 15:33:57 2019
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (SP))
Date: Tue, 24 Sep 2019 13:33:57 +0000
Subject: [R-pkg-devel] Require <package>-package.Rd?
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E01CC77C076@MBXP01.ds.man.ac.uk>
References: <581a012f01524e6b887582a574fc0a7b@UM-MAIL3214.unimaas.nl>
 <438D2EC9EAFE5946B2D5864670EA468E01CC77C076@MBXP01.ds.man.ac.uk>
Message-ID: <449c9e2acdc94a84975dce5de2086abb@UM-MAIL3214.unimaas.nl>

Hi Georgi,

help(package="utils") shows the index, not utils-package.Rd.

help(utils) shows utils-package.Rd.

Best,
Wolfgang

-----Original Message-----
From: Georgi Boshnakov [mailto:georgi.boshnakov at manchester.ac.uk] 
Sent: Tuesday, 24 September, 2019 15:02
To: Viechtbauer, Wolfgang (SP); r-package-devel at r-project.org
Subject: RE: Require <package>-package.Rd?

It is worth noting that 

help(package="<package>")

shows  file <package>-package.Rd, while 

help(<package>)

shows topic "package".

Topic <package>-package.Rd is also printed at the top of the pdf manual, while package.Rd follows the alphabetical ordering of the remaining topics. It is unfortunate that Hadley Wickham's tools (at least 'pkgdown') recommend and use <package>.Rd, instead of <package>-package.Rd as overall package description. 

Georgi Boshnakov

-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Viechtbauer, Wolfgang (SP)
Sent: 24 September 2019 13:16
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Require <package>-package.Rd?

Hi All,

When starting to work with an unfamiliar package, one might typically look for vignettes, a paper/book accompanying the package, a package website, and of course the help files themselves, but

help(package="<package>")

is often not so useful -- such a listing of functions (with titles) might not clarify what the main 'workhorses' of the package are and how to get started. Personally, the first thing I do is try:

help(<package>)

in the hopes that the package author(s) have created a <package>-package.Rd file to get new users started (or to point them to appropriate places to get going). In my experience, if such a package help file is available, it is tremendously useful.

Unfortunately, many packages do not provide a <package>-package.Rd file. I am curious how others and CRAN members would feel about making this a requirement (not retrospectively, but at least for new / resubmissions).

Best,
Wolfgang


From d@v|dhughjone@ @end|ng |rom gm@||@com  Tue Sep 24 17:37:21 2019
From: d@v|dhughjone@ @end|ng |rom gm@||@com (David Hugh-Jones)
Date: Tue, 24 Sep 2019 16:37:21 +0100
Subject: [R-pkg-devel] Require <package>-package.Rd?
In-Reply-To: <CAO1zAVaJjGdoJgp0+OwCk0qd5Ch-bhR7KdV8jf-bRqThwHTEXg@mail.gmail.com>
References: <581a012f01524e6b887582a574fc0a7b@UM-MAIL3214.unimaas.nl>
 <CAO1zAVaJjGdoJgp0+OwCk0qd5Ch-bhR7KdV8jf-bRqThwHTEXg@mail.gmail.com>
Message-ID: <CAARY7kgTKC0zws-xBiNCLgQmngLwhgc_+Q71Xh0GCaSfY7c-oA@mail.gmail.com>

I would be in favour. I actually used R for several years before figuring
out that the vignette was usually where the useful introduction was. Until
then I was like ?R help is way too technical?

On Tue, 24 Sep 2019 at 13:26, Joris Meys <Joris.Meys at ugent.be> wrote:

> Dear Dr. Vichtbauer,
>
> I'm not a CRAN member, but I personally think this is a sensible
> requirement. I try to include those in every package myself, even if it's
> only to direct people to a vignette.
>
> That said, I do look for vignettes first when I encounter an unfamiliar
> package actually. That format gives more possibilities for giving a good
> introduction to the package imho.
>
> My humble 2 cents
> Cheers
> Joris
>
> On Tue, Sep 24, 2019 at 2:17 PM Viechtbauer, Wolfgang (SP) <
> wolfgang.viechtbauer at maastrichtuniversity.nl> wrote:
>
> > Hi All,
> >
> > When starting to work with an unfamiliar package, one might typically
> look
> > for vignettes, a paper/book accompanying the package, a package website,
> > and of course the help files themselves, but
> >
> > help(package="<package>")
> >
> > is often not so useful -- such a listing of functions (with titles) might
> > not clarify what the main 'workhorses' of the package are and how to get
> > started. Personally, the first thing I do is try:
> >
> > help(<package>)
> >
> > in the hopes that the package author(s) have created a
> > <package>-package.Rd file to get new users started (or to point them to
> > appropriate places to get going). In my experience, if such a package
> help
> > file is available, it is tremendously useful.
> >
> > Unfortunately, many packages do not provide a <package>-package.Rd file.
> I
> > am curious how others and CRAN members would feel about making this a
> > requirement (not retrospectively, but at least for new / resubmissions).
> >
> > Best,
> > Wolfgang
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>
>
> --
> Joris Meys
> Statistical consultant
>
> Department of Data Analysis and Mathematical Modelling
> Ghent University
> Coupure Links 653, B-9000 Gent (Belgium)
> <
> https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g
> >
>
> tel: +32 (0)9 264 61 79
> -----------
> Biowiskundedagen 2017-2018
> http://www.biowiskundedagen.ugent.be/
>
> -------------------------------
> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
-- 
Sent from Gmail Mobile

	[[alternative HTML version deleted]]


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Tue Sep 24 19:06:38 2019
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Tue, 24 Sep 2019 17:06:38 +0000
Subject: [R-pkg-devel] Require <package>-package.Rd?
In-Reply-To: <449c9e2acdc94a84975dce5de2086abb@UM-MAIL3214.unimaas.nl>
References: <581a012f01524e6b887582a574fc0a7b@UM-MAIL3214.unimaas.nl>
 <438D2EC9EAFE5946B2D5864670EA468E01CC77C076@MBXP01.ds.man.ac.uk>
 <449c9e2acdc94a84975dce5de2086abb@UM-MAIL3214.unimaas.nl>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E01CC77C0E4@MBXP01.ds.man.ac.uk>

> help(package="utils") shows the index, not utils-package.Rd.

Indeed, I should have run it before emailing, I meant:

package ? utils

which does show "utils-package.Rd" and similarly for other packages. 

'help(topic)' shows a file which contains alias for 'topic'. In the case of 'help(utils)', fille "utils-package.Rd" has an alias for "utils", so tht is shown.

For what it's worth, the index shown by 'help(package = "package")' is very useful for html formatted pages, where everything is linked and the links to the vignettes appear at the top.   If html is not the default rendering, one can use 

    help(package = "Matrix", help_type = "html")

 to get this.


Georgi Boshnakov


-----Original Message-----
From: Viechtbauer, Wolfgang (SP) [mailto:wolfgang.viechtbauer at maastrichtuniversity.nl] 
Sent: 24 September 2019 14:34
To: Georgi Boshnakov; r-package-devel at r-project.org
Subject: RE: Require <package>-package.Rd?

Hi Georgi,

help(package="utils") shows the index, not utils-package.Rd.

help(utils) shows utils-package.Rd.

Best,
Wolfgang

-----Original Message-----
From: Georgi Boshnakov [mailto:georgi.boshnakov at manchester.ac.uk] 
Sent: Tuesday, 24 September, 2019 15:02
To: Viechtbauer, Wolfgang (SP); r-package-devel at r-project.org
Subject: RE: Require <package>-package.Rd?

It is worth noting that 

help(package="<package>")

shows  file <package>-package.Rd, while 

help(<package>)

shows topic "package".

Topic <package>-package.Rd is also printed at the top of the pdf manual, while package.Rd follows the alphabetical ordering of the remaining topics. It is unfortunate that Hadley Wickham's tools (at least 'pkgdown') recommend and use <package>.Rd, instead of <package>-package.Rd as overall package description. 

Georgi Boshnakov

-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Viechtbauer, Wolfgang (SP)
Sent: 24 September 2019 13:16
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Require <package>-package.Rd?

Hi All,

When starting to work with an unfamiliar package, one might typically look for vignettes, a paper/book accompanying the package, a package website, and of course the help files themselves, but

help(package="<package>")

is often not so useful -- such a listing of functions (with titles) might not clarify what the main 'workhorses' of the package are and how to get started. Personally, the first thing I do is try:

help(<package>)

in the hopes that the package author(s) have created a <package>-package.Rd file to get new users started (or to point them to appropriate places to get going). In my experience, if such a package help file is available, it is tremendously useful.

Unfortunately, many packages do not provide a <package>-package.Rd file. I am curious how others and CRAN members would feel about making this a requirement (not retrospectively, but at least for new / resubmissions).

Best,
Wolfgang


From henr|k@bengt@@on @end|ng |rom gm@||@com  Tue Sep 24 20:07:51 2019
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Tue, 24 Sep 2019 11:07:51 -0700
Subject: [R-pkg-devel] Why doesn't R CMD check warn that globalVariables()
 is undefined/not imported?
Message-ID: <CAFDcVCR+SmxgcsiZTNYtAybZ5btWyHuAHQ1amWPDAshjxMWFSQ@mail.gmail.com>

'R CMD check' will give a warning that 'speed' is an unknown variable in:

  low_speeds <- function(limit) {
    subset(datasets::cars, speed <= limit)
  }

We can tell 'R CMD check' that 'speed' is a false positive by
declaring it a "global" variable.  This can be done, by:

  low_speeds <- function(limit) {
    subset(datasets::cars, speed <= limit)
  }
  utils::globalVariables("speed")

So, far so good. But, why doesn't 'R CMD check' complain about
'globalVariables' not being defined if we use

  globalVariables("speed")

without utils::* and without having an importFrom("utils",
"globalVariables") in the NAMESPACE?

For what it's worth, if I add a globalVariables() inside a function
definition, e.g.

  low_speeds <- function(limit) {
    globalVariables("speed")
    subset(datasets::cars, speed <= limit)
  }
  globalVariables("speed")

then 'R CMD check' will indeed complain about that inner globalVariables():

$ R --vanilla CMD check teeny_0.1.0.tar.gz
* using log directory ?/home/hb/repositories/teeny.Rcheck?
* using R version 3.6.1 (2019-07-05)
* using platform: x86_64-pc-linux-gnu (64-bit)
[...]
* checking R code for possible problems ... NOTE
low_speeds: no visible global function definition for ?globalVariables?
Undefined global functions or variables:
  globalVariables
Consider adding
  importFrom("utils", "globalVariables")
to your NAMESPACE file.

Is this an oversight in R CMD check, or is it implicit that the
'utils' package is attached when installing and checking packages and
we can use 'utils' objects at the top level of a package?

Thanks,

Henrik


From c@@rd|@g@bor @end|ng |rom gm@||@com  Tue Sep 24 20:12:47 2019
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Tue, 24 Sep 2019 19:12:47 +0100
Subject: [R-pkg-devel] 
 Why doesn't R CMD check warn that globalVariables()
 is undefined/not imported?
In-Reply-To: <CAFDcVCR+SmxgcsiZTNYtAybZ5btWyHuAHQ1amWPDAshjxMWFSQ@mail.gmail.com>
References: <CAFDcVCR+SmxgcsiZTNYtAybZ5btWyHuAHQ1amWPDAshjxMWFSQ@mail.gmail.com>
Message-ID: <CABtg=K=WOQ1cAYjXpipMWKzjyWnE1EMa2bBHjKG7X4SDH_yfJw@mail.gmail.com>

I believe that this is because if it is outside of a function, then it
runs at INSTALL time, and codetools checks the installed code, i.e.
the function objects typically, and the checks never see the
globalVariables() call.

Gabor

On Tue, Sep 24, 2019 at 7:08 PM Henrik Bengtsson
<henrik.bengtsson at gmail.com> wrote:
>
> 'R CMD check' will give a warning that 'speed' is an unknown variable in:
>
>   low_speeds <- function(limit) {
>     subset(datasets::cars, speed <= limit)
>   }
>
> We can tell 'R CMD check' that 'speed' is a false positive by
> declaring it a "global" variable.  This can be done, by:
>
>   low_speeds <- function(limit) {
>     subset(datasets::cars, speed <= limit)
>   }
>   utils::globalVariables("speed")
>
> So, far so good. But, why doesn't 'R CMD check' complain about
> 'globalVariables' not being defined if we use
>
>   globalVariables("speed")
>
> without utils::* and without having an importFrom("utils",
> "globalVariables") in the NAMESPACE?
>
> For what it's worth, if I add a globalVariables() inside a function
> definition, e.g.
>
>   low_speeds <- function(limit) {
>     globalVariables("speed")
>     subset(datasets::cars, speed <= limit)
>   }
>   globalVariables("speed")
>
> then 'R CMD check' will indeed complain about that inner globalVariables():
>
> $ R --vanilla CMD check teeny_0.1.0.tar.gz
> * using log directory ?/home/hb/repositories/teeny.Rcheck?
> * using R version 3.6.1 (2019-07-05)
> * using platform: x86_64-pc-linux-gnu (64-bit)
> [...]
> * checking R code for possible problems ... NOTE
> low_speeds: no visible global function definition for ?globalVariables?
> Undefined global functions or variables:
>   globalVariables
> Consider adding
>   importFrom("utils", "globalVariables")
> to your NAMESPACE file.
>
> Is this an oversight in R CMD check, or is it implicit that the
> 'utils' package is attached when installing and checking packages and
> we can use 'utils' objects at the top level of a package?
>
> Thanks,
>
> Henrik
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From roy@mende|@@ohn @end|ng |rom no@@@gov  Tue Sep 24 20:43:48 2019
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Tue, 24 Sep 2019 11:43:48 -0700
Subject: [R-pkg-devel] Resubmitting after a few days
Message-ID: <554FEDA2-2FE2-42B9-915D-09CD6AD5D3E2@noaa.gov>

Hi All:

A few days ago I  had to resubmit because an external URL I was using in my vignette changed and the nightly builds were issuing warnings.  This morning a user reported a bug.  I have the fix and a new version,  but the test machines,  and I suppose it will also be true of CRAN,  are unhappy about the interval since last submit.  Should I just submit the new version anyway with a note in cram-comments that this is a bug fix.

Thanks,

-Roy

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From henr|k@bengt@@on @end|ng |rom gm@||@com  Tue Sep 24 20:49:17 2019
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Tue, 24 Sep 2019 11:49:17 -0700
Subject: [R-pkg-devel] 
 Why doesn't R CMD check warn that globalVariables()
 is undefined/not imported?
In-Reply-To: <CABtg=K=WOQ1cAYjXpipMWKzjyWnE1EMa2bBHjKG7X4SDH_yfJw@mail.gmail.com>
References: <CAFDcVCR+SmxgcsiZTNYtAybZ5btWyHuAHQ1amWPDAshjxMWFSQ@mail.gmail.com>
 <CABtg=K=WOQ1cAYjXpipMWKzjyWnE1EMa2bBHjKG7X4SDH_yfJw@mail.gmail.com>
Message-ID: <CAFDcVCTUcJLMePrAjs+ijefK=RhvrR56ZL6YVf4u_vrJc6XOiA@mail.gmail.com>

On Tue, Sep 24, 2019 at 11:13 AM G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
>
> I believe that this is because if it is outside of a function, then it
> runs at INSTALL time, and codetools checks the installed code, i.e.
> the function objects typically, and the checks never see the
> globalVariables() call.

That would make sense.  Would you say this is a false negative for 'R
CMD check', that is, should it ideally warn about this?

Personally, I argue that one should use:

utils::globalVariables(...)

or

globalVariables(...)
NAMESPACE: importFrom(utils, globalVariables)

/Henrik

>
> Gabor
>
> On Tue, Sep 24, 2019 at 7:08 PM Henrik Bengtsson
> <henrik.bengtsson at gmail.com> wrote:
> >
> > 'R CMD check' will give a warning that 'speed' is an unknown variable in:
> >
> >   low_speeds <- function(limit) {
> >     subset(datasets::cars, speed <= limit)
> >   }
> >
> > We can tell 'R CMD check' that 'speed' is a false positive by
> > declaring it a "global" variable.  This can be done, by:
> >
> >   low_speeds <- function(limit) {
> >     subset(datasets::cars, speed <= limit)
> >   }
> >   utils::globalVariables("speed")
> >
> > So, far so good. But, why doesn't 'R CMD check' complain about
> > 'globalVariables' not being defined if we use
> >
> >   globalVariables("speed")
> >
> > without utils::* and without having an importFrom("utils",
> > "globalVariables") in the NAMESPACE?
> >
> > For what it's worth, if I add a globalVariables() inside a function
> > definition, e.g.
> >
> >   low_speeds <- function(limit) {
> >     globalVariables("speed")
> >     subset(datasets::cars, speed <= limit)
> >   }
> >   globalVariables("speed")
> >
> > then 'R CMD check' will indeed complain about that inner globalVariables():
> >
> > $ R --vanilla CMD check teeny_0.1.0.tar.gz
> > * using log directory ?/home/hb/repositories/teeny.Rcheck?
> > * using R version 3.6.1 (2019-07-05)
> > * using platform: x86_64-pc-linux-gnu (64-bit)
> > [...]
> > * checking R code for possible problems ... NOTE
> > low_speeds: no visible global function definition for ?globalVariables?
> > Undefined global functions or variables:
> >   globalVariables
> > Consider adding
> >   importFrom("utils", "globalVariables")
> > to your NAMESPACE file.
> >
> > Is this an oversight in R CMD check, or is it implicit that the
> > 'utils' package is attached when installing and checking packages and
> > we can use 'utils' objects at the top level of a package?
> >
> > Thanks,
> >
> > Henrik
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel


From r@||@@tubner @end|ng |rom gm@||@com  Wed Sep 25 09:23:28 2019
From: r@||@@tubner @end|ng |rom gm@||@com (Ralf Stubner)
Date: Wed, 25 Sep 2019 09:23:28 +0200
Subject: [R-pkg-devel] 
 Package or namespace load failed: undefined symbol
In-Reply-To: <DD7DFEE9-3EEF-4F98-80F4-6467C10203AA@kaust.edu.sa>
References: <DD7DFEE9-3EEF-4F98-80F4-6467C10203AA@kaust.edu.sa>
Message-ID: <CAFQwRQzXnvSN2JWT0sZfeWMKQ5HbYLofoCyZKLF1GfJcenTy7g@mail.gmail.com>

On Tue, Sep 24, 2019 at 12:10 PM Sameh M. Abdulah
<sameh.abdulah at kaust.edu.sa> wrote:
> I am uploading my R package to CRAN. One of the dynamic libraries the package requires depends on LAPACKE library which usually integrated with BLAS and CBLAS in the same .so file (as I understand). CRAN has OpenBLAS already installed on the system. However, this OpenBLAS library does not maintain implementation of LAPACKE library. Thus, I have modified my configure file to install a standalone OpenBLAS library to use it.
>
> The problem that my installation has successfully passed, however, CRAN fails in loading my package giving me this error:
>
> /srv/hornik/tmp/CRAN/exageostatr.Rcheck/exageostatr/lib/libcoreblas.so: undefined symbol: LAPACKE_slarfb_work

This looks as if you are building OpenBLAS as a /dynamic/ library
installed in your package directory. This cannot work since the
run-time linker will not search your package directory for dynamic
libraries. You could build OpenBLAS as a /static/ library instead.
However, I am unsure why you want to build OpenBLAS in the first
place, since any R package can reliably link with the BLAS and LAPACK
versions used by R. See WRE on Makevars, BLAS_LIBS etc. for details.

cheerio
ralf


From @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@  Wed Sep 25 10:29:20 2019
From: @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@ (Sameh M. Abdulah)
Date: Wed, 25 Sep 2019 08:29:20 +0000
Subject: [R-pkg-devel] 
 Package or namespace load failed: undefined symbol
In-Reply-To: <CAFQwRQzXnvSN2JWT0sZfeWMKQ5HbYLofoCyZKLF1GfJcenTy7g@mail.gmail.com>
References: <DD7DFEE9-3EEF-4F98-80F4-6467C10203AA@kaust.edu.sa>
 <CAFQwRQzXnvSN2JWT0sZfeWMKQ5HbYLofoCyZKLF1GfJcenTy7g@mail.gmail.com>
Message-ID: <E3E52404-38F5-47E5-A464-457157F69715@kaust.edu.sa>

Thanks Ralf

I am installing OpenBLAS because I need LAPACKE libraries which I cannot find on the current version of OpenBLAS on CRAN. 

I add the libraries directory in my package to the PKG_CONFIG_PATH. Is this enough for the system to use my OpenBLAS library?


Thanks
Sameh

?On 9/25/19, 10:23 AM, "Ralf Stubner" <ralf.stubner at gmail.com> wrote:

    On Tue, Sep 24, 2019 at 12:10 PM Sameh M. Abdulah
    <sameh.abdulah at kaust.edu.sa> wrote:
    > I am uploading my R package to CRAN. One of the dynamic libraries the package requires depends on LAPACKE library which usually integrated with BLAS and CBLAS in the same .so file (as I understand). CRAN has OpenBLAS already installed on the system. However, this OpenBLAS library does not maintain implementation of LAPACKE library. Thus, I have modified my configure file to install a standalone OpenBLAS library to use it.
    >
    > The problem that my installation has successfully passed, however, CRAN fails in loading my package giving me this error:
    >
    > /srv/hornik/tmp/CRAN/exageostatr.Rcheck/exageostatr/lib/libcoreblas.so: undefined symbol: LAPACKE_slarfb_work
    
    This looks as if you are building OpenBLAS as a /dynamic/ library
    installed in your package directory. This cannot work since the
    run-time linker will not search your package directory for dynamic
    libraries. You could build OpenBLAS as a /static/ library instead.
    However, I am unsure why you want to build OpenBLAS in the first
    place, since any R package can reliably link with the BLAS and LAPACK
    versions used by R. See WRE on Makevars, BLAS_LIBS etc. for details.
    
    cheerio
    ralf
    


From he|mut@@chuetz @end|ng |rom beb@c@@t  Wed Sep 25 12:12:55 2019
From: he|mut@@chuetz @end|ng |rom beb@c@@t (=?UTF-8?Q?Helmut_Sch=c3=bctz?=)
Date: Wed, 25 Sep 2019 12:12:55 +0200
Subject: [R-pkg-devel] Resubmitting after a few days
In-Reply-To: <554FEDA2-2FE2-42B9-915D-09CD6AD5D3E2@noaa.gov>
References: <554FEDA2-2FE2-42B9-915D-09CD6AD5D3E2@noaa.gov>
Message-ID: <0412604a-5a2e-8d4e-fd9e-a6046c5357c9@bebac.at>

Hi Roy,

Roy Mendelssohn - NOAA Federal via R-package-devel wrote on 2019-09-24 
20:43:
> Hi All:
>
> A few days ago I  had to resubmit because an external URL I was using in my vignette changed and the nightly builds were issuing warnings.  This morning a user reported a bug.  I have the fix and a new version,  but the test machines,  and I suppose it will also be true of CRAN,  are unhappy about the interval since last submit.

They will. ;-)

> Should I just submit the new version anyway with a note in cram-comments that this is a bug fix.

Absolutely. The one-month interval for new versions is a *recommendation*.
If a bug has to be fixed, go for it -- together with an explanation.
Happened to me once as well (new version correcting a bug after two days).
IIRC, Hadley had to submit a new version of one of his packages after 
three days. Murphy's law.

Cheers,
Helmut

-- 
Ing. Helmut Sch?tz
BEBAC?? Consultancy Services for
Bioequivalence and Bioavailability Studies
1070 Vienna, Austria
W https://bebac.at/
F https://forum.bebac.at/


	[[alternative HTML version deleted]]


From r@||@@tubner @end|ng |rom gm@||@com  Wed Sep 25 13:00:12 2019
From: r@||@@tubner @end|ng |rom gm@||@com (Ralf Stubner)
Date: Wed, 25 Sep 2019 13:00:12 +0200
Subject: [R-pkg-devel] 
 Package or namespace load failed: undefined symbol
In-Reply-To: <E3E52404-38F5-47E5-A464-457157F69715@kaust.edu.sa>
References: <DD7DFEE9-3EEF-4F98-80F4-6467C10203AA@kaust.edu.sa>
 <CAFQwRQzXnvSN2JWT0sZfeWMKQ5HbYLofoCyZKLF1GfJcenTy7g@mail.gmail.com>
 <E3E52404-38F5-47E5-A464-457157F69715@kaust.edu.sa>
Message-ID: <CAFQwRQyFrQ3zYKCjq0fJFEU23T0Q-9=EqRkUE+Z0r+eZUxziUg@mail.gmail.com>

On Wed, Sep 25, 2019 at 10:29 AM Sameh M. Abdulah
<sameh.abdulah at kaust.edu.sa> wrote:
> I am installing OpenBLAS because I need LAPACKE libraries which I cannot find on the current version of OpenBLAS on CRAN.
>
> I add the libraries directory in my package to the PKG_CONFIG_PATH. Is this enough for the system to use my OpenBLAS library?

I seem to be missing some context here. I might be able to help you if
provide a higher level description of what you are trying to achieve.
For example, why do you need LAPACKE instead of the C interface to
LAPACK provided by R_ext/Lapack.h? And if you really need LAPACKE, why
not include only that in your package and link with the BLAS/LAPACK
used by R?

cheerio
ralf


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Wed Sep 25 13:09:21 2019
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Wed, 25 Sep 2019 13:09:21 +0200
Subject: [R-pkg-devel] 
 Package or namespace load failed: undefined symbol
In-Reply-To: <CAFQwRQyFrQ3zYKCjq0fJFEU23T0Q-9=EqRkUE+Z0r+eZUxziUg@mail.gmail.com>
References: <DD7DFEE9-3EEF-4F98-80F4-6467C10203AA@kaust.edu.sa>
 <CAFQwRQzXnvSN2JWT0sZfeWMKQ5HbYLofoCyZKLF1GfJcenTy7g@mail.gmail.com>
 <E3E52404-38F5-47E5-A464-457157F69715@kaust.edu.sa>
 <CAFQwRQyFrQ3zYKCjq0fJFEU23T0Q-9=EqRkUE+Z0r+eZUxziUg@mail.gmail.com>
Message-ID: <cb3aec8b-636a-6578-a2ef-ae1f5b41f566@gmail.com>

On 9/25/19 1:00 PM, Ralf Stubner wrote:
> On Wed, Sep 25, 2019 at 10:29 AM Sameh M. Abdulah
> <sameh.abdulah at kaust.edu.sa> wrote:
>> I am installing OpenBLAS because I need LAPACKE libraries which I cannot find on the current version of OpenBLAS on CRAN.
>>
>> I add the libraries directory in my package to the PKG_CONFIG_PATH. Is this enough for the system to use my OpenBLAS library?
> I seem to be missing some context here. I might be able to help you if
> provide a higher level description of what you are trying to achieve.
> For example, why do you need LAPACKE instead of the C interface to
> LAPACK provided by R_ext/Lapack.h? And if you really need LAPACKE, why
> not include only that in your package and link with the BLAS/LAPACK
> used by R?

Also with LAPACKE you will have the problem of (in)compatibility in 
calls from C to Fortran with the hidden length arguments for character 
arguments. It would be better to use LAPACK directly, passing the hidden 
length arguments as described in Writing R Extensions (the R-devel 
version of it, section 6.6.1). Or, if you wanted a standards-based 
solution, use iso_c_binding (also described in WRE). You would use the 
LAPACK already provided in the system (either reference from R, or any 
other as selected by administrator/user), not include it with your package.

Best
Tomas

>
> cheerio
> ralf
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From edd @end|ng |rom deb|@n@org  Wed Sep 25 13:36:23 2019
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 25 Sep 2019 06:36:23 -0500
Subject: [R-pkg-devel] Resubmitting after a few days
In-Reply-To: <554FEDA2-2FE2-42B9-915D-09CD6AD5D3E2@noaa.gov>
References: <554FEDA2-2FE2-42B9-915D-09CD6AD5D3E2@noaa.gov>
Message-ID: <23947.20791.857032.86226@rob.eddelbuettel.com>


On 24 September 2019 at 11:43, Roy Mendelssohn - NOAA Federal via R-package-devel wrote:
| A few days ago I  had to resubmit because an external URL I was using in my vignette changed and the nightly builds were issuing warnings.  This morning a user reported a bug.  I have the fix and a new version,  but the test machines,  and I suppose it will also be true of CRAN,  are unhappy about the interval since last submit.  Should I just submit the new version anyway with a note in cram-comments that this is a bug fix.

Yes: AFAICT these are recommendations to not overburden CRAN.

And I have hit two distinct types:

 - more than six uploads in six months (which happened when an upstream
   package was hyperactive) which lead me to space uploads out a little more
   as "one a month should be plenty" indeed

 - less than seven days since the last upload (which lead me to just wait two
   days on a very recent "better bug fix to a bug fix" upload I made, and
   then got me the very automated processing)

You can look in the R sources for what the cutoffs are (which is how I
confirmed it was 7) and act accordingly.  So yes, in sum, explain what you do
to CRAN -- and some human will generally do the Right Thing.

(And big thanks and kudos to CRAN for the increased automation documented in
the short update at the end of the most recent R Journal issue. Very
impressive, and very well done.)

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@  Wed Sep 25 15:34:48 2019
From: @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@ (Sameh M. Abdulah)
Date: Wed, 25 Sep 2019 13:34:48 +0000
Subject: [R-pkg-devel] 
 Package or namespace load failed: undefined symbol
In-Reply-To: <CAFQwRQyFrQ3zYKCjq0fJFEU23T0Q-9=EqRkUE+Z0r+eZUxziUg@mail.gmail.com>
References: <DD7DFEE9-3EEF-4F98-80F4-6467C10203AA@kaust.edu.sa>
 <CAFQwRQzXnvSN2JWT0sZfeWMKQ5HbYLofoCyZKLF1GfJcenTy7g@mail.gmail.com>
 <E3E52404-38F5-47E5-A464-457157F69715@kaust.edu.sa>
 <CAFQwRQyFrQ3zYKCjq0fJFEU23T0Q-9=EqRkUE+Z0r+eZUxziUg@mail.gmail.com>
Message-ID: <14594819-67CA-4875-8D01-A06DA3FBE70D@kaust.edu.sa>

Dear   Ralf

My package depends on another C-based software that needs LAPACKE to compile. I do not know a lot about it. I think adding LAPACKE to my package will be a good solution.
Could you please give me more information of how to do this?

--Sameh



?On 9/25/19, 2:00 PM, "Ralf Stubner" <ralf.stubner at gmail.com> wrote:

    On Wed, Sep 25, 2019 at 10:29 AM Sameh M. Abdulah
    <sameh.abdulah at kaust.edu.sa> wrote:
    > I am installing OpenBLAS because I need LAPACKE libraries which I cannot find on the current version of OpenBLAS on CRAN.
    >
    > I add the libraries directory in my package to the PKG_CONFIG_PATH. Is this enough for the system to use my OpenBLAS library?
    
    I seem to be missing some context here. I might be able to help you if
    provide a higher level description of what you are trying to achieve.
    For example, why do you need LAPACKE instead of the C interface to
    LAPACK provided by R_ext/Lapack.h? And if you really need LAPACKE, why
    not include only that in your package and link with the BLAS/LAPACK
    used by R?
    
    cheerio
    ralf
    


From d@v|dhughjone@ @end|ng |rom gm@||@com  Wed Sep 25 15:51:58 2019
From: d@v|dhughjone@ @end|ng |rom gm@||@com (David Hugh-Jones)
Date: Wed, 25 Sep 2019 14:51:58 +0100
Subject: [R-pkg-devel] What counts as an API change?
Message-ID: <CAARY7khF5Xk2+tdsKnY9HubvO3kkTUL_TQGi0M4W=pSKunCxVw@mail.gmail.com>

Hi all,

Philosophical question. My package follows semantic versioning (
https://semver.org). Incompatible API changes should trigger a major
version upgrade. OK, but what counts as an incompatible change to an R API?
Suppose my current function signature is

foo <- function (a, b, c, d)

and the new one is

foo <- function (a, b, c, d, e)

is that compatible? What if I add an argument, but not at the end:

foo <- function (a, b, c, e, d)

That would be incompatible if people have been calling the arguments by
order rather than by name. But sometimes that is unlikely: I doubt if many
people write

lm(y ~ x, mydata, z==3, f, na.omit, "qr", FALSE, FALSE, TRUE, TRUE, FALSE)

Should I be strict or relaxed about this?

Cheers,
David

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Sep 25 16:00:59 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 25 Sep 2019 07:00:59 -0700
Subject: [R-pkg-devel] What counts as an API change?
In-Reply-To: <CAARY7khF5Xk2+tdsKnY9HubvO3kkTUL_TQGi0M4W=pSKunCxVw@mail.gmail.com>
References: <CAARY7khF5Xk2+tdsKnY9HubvO3kkTUL_TQGi0M4W=pSKunCxVw@mail.gmail.com>
Message-ID: <AC80C057-E97A-4401-A6F7-3D6FCC0814B6@dcn.davis.ca.us>

Both of your examples are incompatible.

foo <- function (a, b, c, d, e = NA )

(add with default value) would be compatible.

Your second example cannot be made compatible even with default values because the positional behaviour has changed.

On September 25, 2019 6:51:58 AM PDT, David Hugh-Jones <davidhughjones at gmail.com> wrote:
>Hi all,
>
>Philosophical question. My package follows semantic versioning (
>https://semver.org). Incompatible API changes should trigger a major
>version upgrade. OK, but what counts as an incompatible change to an R
>API?
>Suppose my current function signature is
>
>foo <- function (a, b, c, d)
>
>and the new one is
>
>foo <- function (a, b, c, d, e)
>
>is that compatible? What if I add an argument, but not at the end:
>
>foo <- function (a, b, c, e, d)
>
>That would be incompatible if people have been calling the arguments by
>order rather than by name. But sometimes that is unlikely: I doubt if
>many
>people write
>
>lm(y ~ x, mydata, z==3, f, na.omit, "qr", FALSE, FALSE, TRUE, TRUE,
>FALSE)
>
>Should I be strict or relaxed about this?
>
>Cheers,
>David
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From d@v|dhughjone@ @end|ng |rom gm@||@com  Wed Sep 25 16:27:25 2019
From: d@v|dhughjone@ @end|ng |rom gm@||@com (David Hugh-Jones)
Date: Wed, 25 Sep 2019 15:27:25 +0100
Subject: [R-pkg-devel] What counts as an API change?
In-Reply-To: <AC80C057-E97A-4401-A6F7-3D6FCC0814B6@dcn.davis.ca.us>
References: <CAARY7khF5Xk2+tdsKnY9HubvO3kkTUL_TQGi0M4W=pSKunCxVw@mail.gmail.com>
 <AC80C057-E97A-4401-A6F7-3D6FCC0814B6@dcn.davis.ca.us>
Message-ID: <CAARY7kg6MRkDigsxc2b=aViaFFa3cpL_o0o5TAxd8YJSqGCUdg@mail.gmail.com>

Hi Jeff,

You're right. Indeed, assume default values are provided. I should have
been more precise.

I understand that the positional behaviour has changed. But I wonder if it
always matters. OTOH I appreciate the force of the idea that an API change
is an API change, and should be defined precisely.

Best,
David


On Wed, 25 Sep 2019 at 15:01, Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
wrote:

> Both of your examples are incompatible.
>
> foo <- function (a, b, c, d, e = NA )
>
> (add with default value) would be compatible.
>
> Your second example cannot be made compatible even with default values
> because the positional behaviour has changed.
>
> On September 25, 2019 6:51:58 AM PDT, David Hugh-Jones <
> davidhughjones at gmail.com> wrote:
> >Hi all,
> >
> >Philosophical question. My package follows semantic versioning (
> >https://semver.org). Incompatible API changes should trigger a major
> >version upgrade. OK, but what counts as an incompatible change to an R
> >API?
> >Suppose my current function signature is
> >
> >foo <- function (a, b, c, d)
> >
> >and the new one is
> >
> >foo <- function (a, b, c, d, e)
> >
> >is that compatible? What if I add an argument, but not at the end:
> >
> >foo <- function (a, b, c, e, d)
> >
> >That would be incompatible if people have been calling the arguments by
> >order rather than by name. But sometimes that is unlikely: I doubt if
> >many
> >people write
> >
> >lm(y ~ x, mydata, z==3, f, na.omit, "qr", FALSE, FALSE, TRUE, TRUE,
> >FALSE)
> >
> >Should I be strict or relaxed about this?
> >
> >Cheers,
> >David
> >
> >       [[alternative HTML version deleted]]
> >
> >______________________________________________
> >R-package-devel at r-project.org mailing list
> >https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> --
> Sent from my phone. Please excuse my brevity.
>

	[[alternative HTML version deleted]]


From roy@mende|@@ohn @end|ng |rom no@@@gov  Wed Sep 25 16:39:11 2019
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Wed, 25 Sep 2019 07:39:11 -0700
Subject: [R-pkg-devel] Resubmitting after a few days
In-Reply-To: <23947.20791.857032.86226@rob.eddelbuettel.com>
References: <554FEDA2-2FE2-42B9-915D-09CD6AD5D3E2@noaa.gov>
 <23947.20791.857032.86226@rob.eddelbuettel.com>
Message-ID: <C74C6D6C-909D-452D-9F80-A90631344BDF@noaa.gov>

Thanks all.  I asked because I don't want to unnecessarily overburden the CRAN maintainers.  In this case,  it wasn't a minor bug.

-Roy

> On Sep 25, 2019, at 4:36 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
> 
> 
> On 24 September 2019 at 11:43, Roy Mendelssohn - NOAA Federal via R-package-devel wrote:
> | A few days ago I  had to resubmit because an external URL I was using in my vignette changed and the nightly builds were issuing warnings.  This morning a user reported a bug.  I have the fix and a new version,  but the test machines,  and I suppose it will also be true of CRAN,  are unhappy about the interval since last submit.  Should I just submit the new version anyway with a note in cram-comments that this is a bug fix.
> 
> Yes: AFAICT these are recommendations to not overburden CRAN.
> 
> And I have hit two distinct types:
> 
> - more than six uploads in six months (which happened when an upstream
>   package was hyperactive) which lead me to space uploads out a little more
>   as "one a month should be plenty" indeed
> 
> - less than seven days since the last upload (which lead me to just wait two
>   days on a very recent "better bug fix to a bug fix" upload I made, and
>   then got me the very automated processing)
> 
> You can look in the R sources for what the cutoffs are (which is how I
> confirmed it was 7) and act accordingly.  So yes, in sum, explain what you do
> to CRAN -- and some human will generally do the Right Thing.
> 
> (And big thanks and kudos to CRAN for the increased automation documented in
> the short update at the end of the most recent R Journal issue. Very
> impressive, and very well done.)
> 
> Dirk
> 
> -- 
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Sep 25 18:26:23 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 25 Sep 2019 09:26:23 -0700
Subject: [R-pkg-devel] What counts as an API change?
In-Reply-To: <CAARY7kg6MRkDigsxc2b=aViaFFa3cpL_o0o5TAxd8YJSqGCUdg@mail.gmail.com>
References: <CAARY7khF5Xk2+tdsKnY9HubvO3kkTUL_TQGi0M4W=pSKunCxVw@mail.gmail.com>
 <AC80C057-E97A-4401-A6F7-3D6FCC0814B6@dcn.davis.ca.us>
 <CAARY7kg6MRkDigsxc2b=aViaFFa3cpL_o0o5TAxd8YJSqGCUdg@mail.gmail.com>
Message-ID: <4B37F960-FCBA-479C-8A92-DE1B92860273@dcn.davis.ca.us>

"assume default values are provided."

Ah, no. Choosing to specify or not specify default values is a critical step. As is deciding where any ... argument will be placed (all specific arguments after that have to be named when called so positional compatibility cannot come back to bite you).

"I wonder if it always matters"

That would depend on the relationship you plan to maintain with users of your package. Still, sometimes breaking changes are necessary for a better future.

I think the definition of breaking is pretty clear if you are precise in your argument lists. (R CMD check is very helpful in pestering you to document your arguments, so you do have the opportunity to be precise in your API definition.) It is really bad to have silent changes in behavior, and precision in specification is crucial to avoid that if you distribute packages.

On September 25, 2019 7:27:25 AM PDT, David Hugh-Jones <davidhughjones at gmail.com> wrote:
>Hi Jeff,
>
>You're right. Indeed, assume default values are provided. I should have
>been more precise.
>
>I understand that the positional behaviour has changed. But I wonder if
>it
>always matters. OTOH I appreciate the force of the idea that an API
>change
>is an API change, and should be defined precisely.
>
>Best,
>David
>
>
>On Wed, 25 Sep 2019 at 15:01, Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
>wrote:
>
>> Both of your examples are incompatible.
>>
>> foo <- function (a, b, c, d, e = NA )
>>
>> (add with default value) would be compatible.
>>
>> Your second example cannot be made compatible even with default
>values
>> because the positional behaviour has changed.
>>
>> On September 25, 2019 6:51:58 AM PDT, David Hugh-Jones <
>> davidhughjones at gmail.com> wrote:
>> >Hi all,
>> >
>> >Philosophical question. My package follows semantic versioning (
>> >https://semver.org). Incompatible API changes should trigger a major
>> >version upgrade. OK, but what counts as an incompatible change to an
>R
>> >API?
>> >Suppose my current function signature is
>> >
>> >foo <- function (a, b, c, d)
>> >
>> >and the new one is
>> >
>> >foo <- function (a, b, c, d, e)
>> >
>> >is that compatible? What if I add an argument, but not at the end:
>> >
>> >foo <- function (a, b, c, e, d)
>> >
>> >That would be incompatible if people have been calling the arguments
>by
>> >order rather than by name. But sometimes that is unlikely: I doubt
>if
>> >many
>> >people write
>> >
>> >lm(y ~ x, mydata, z==3, f, na.omit, "qr", FALSE, FALSE, TRUE, TRUE,
>> >FALSE)
>> >
>> >Should I be strict or relaxed about this?
>> >
>> >Cheers,
>> >David
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> >______________________________________________
>> >R-package-devel at r-project.org mailing list
>> >https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> --
>> Sent from my phone. Please excuse my brevity.
>>

-- 
Sent from my phone. Please excuse my brevity.


From tdhock5 @end|ng |rom gm@||@com  Wed Sep 25 19:59:40 2019
From: tdhock5 @end|ng |rom gm@||@com (Toby Hocking)
Date: Wed, 25 Sep 2019 10:59:40 -0700
Subject: [R-pkg-devel] unicode WARNING on solaris?
In-Reply-To: <a95fe0a8-24bc-7575-ddfa-0604bad8261b@gmail.com>
References: <CALK03d2u57jz2FgTmW_=poVy27rYXKFxQXa2ssp+e5QSdYwZoQ@mail.gmail.com>
 <a95fe0a8-24bc-7575-ddfa-0604bad8261b@gmail.com>
Message-ID: <CALK03d1w4YgghRzJF=OSVCDWVnSfi8gdr7VyeF=O9b2gAACumA@mail.gmail.com>

Hi Tomas thanks for the explanation. Does that mean that there is no known
fix? i.e. it is OK to re-submit a new version of my package without fixing
these WARNINGS?

On Tue, Sep 24, 2019 at 1:38 AM Tomas Kalibera <tomas.kalibera at gmail.com>
wrote:

> On 9/24/19 1:57 AM, Toby Hocking wrote:
> > Hi all,
> >
> > is there a known fix for this WARNING which I am getting on solaris for
> my
> > newly submitted nc package?
> >
> https://www.r-project.org/nosvn/R.check/r-patched-solaris-x86/nc-00check.html
>
> It seems that deparse() came across some non-printable characters. Such
> characters would be replaced by \U or \u escapes. This is implemented
> using wide characters in R, but on that platform __STDC_ISO_10646__ is
> not defined, so wchar_t has unknown representation (not known to be
> Unicode), hence the warning.
>
> Best
> Tomas
>
> >
> > A quick google search for "it is not known that wchar_t is Unicode on
> this
> > platform cran" shows that many other packages have this WARNING as well.
> >
> > I searched r-devel and r-pkg-devel for the warning text but I did not
> find
> > any messages discussing a fix.
> >
> > Thanks for any help
> > Toby
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>
>

	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Wed Sep 25 20:45:14 2019
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Wed, 25 Sep 2019 20:45:14 +0200
Subject: [R-pkg-devel] unicode WARNING on solaris?
In-Reply-To: <CALK03d1w4YgghRzJF=OSVCDWVnSfi8gdr7VyeF=O9b2gAACumA@mail.gmail.com>
References: <CALK03d2u57jz2FgTmW_=poVy27rYXKFxQXa2ssp+e5QSdYwZoQ@mail.gmail.com>
 <a95fe0a8-24bc-7575-ddfa-0604bad8261b@gmail.com>
 <CALK03d1w4YgghRzJF=OSVCDWVnSfi8gdr7VyeF=O9b2gAACumA@mail.gmail.com>
Message-ID: <15a3fc5e-8cb5-7a44-9fb6-1d99ba06c0cb@gmail.com>

On 9/25/19 7:59 PM, Toby Hocking wrote:
> Hi Tomas thanks for the explanation. Does that mean that there is no 
> known fix? i.e. it is OK to re-submit a new version of my package 
> without fixing these WARNINGS?

One way to fix would be to remove non-ASCII characters from the 
examples. I see \u4e8c \u4e09 \U0001F60E.
Tomas

>
> On Tue, Sep 24, 2019 at 1:38 AM Tomas Kalibera 
> <tomas.kalibera at gmail.com <mailto:tomas.kalibera at gmail.com>> wrote:
>
>     On 9/24/19 1:57 AM, Toby Hocking wrote:
>     > Hi all,
>     >
>     > is there a known fix for this WARNING which I am getting on
>     solaris for my
>     > newly submitted nc package?
>     >
>     https://www.r-project.org/nosvn/R.check/r-patched-solaris-x86/nc-00check.html
>
>     It seems that deparse() came across some non-printable characters.
>     Such
>     characters would be replaced by \U or \u escapes. This is implemented
>     using wide characters in R, but on that platform
>     __STDC_ISO_10646__ is
>     not defined, so wchar_t has unknown representation (not known to be
>     Unicode), hence the warning.
>
>     Best
>     Tomas
>
>     >
>     > A quick google search for "it is not known that wchar_t is
>     Unicode on this
>     > platform cran" shows that many other packages have this WARNING
>     as well.
>     >
>     > I searched r-devel and r-pkg-devel for the warning text but I
>     did not find
>     > any messages discussing a fix.
>     >
>     > Thanks for any help
>     > Toby
>     >
>     >? ? ? ?[[alternative HTML version deleted]]
>     >
>     > ______________________________________________
>     > R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org> mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>


	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Wed Sep 25 23:00:26 2019
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Wed, 25 Sep 2019 23:00:26 +0200
Subject: [R-pkg-devel] How reproduce CRAN check
In-Reply-To: <CAGnmNJxqGWT_NtL4=54XrpjKzRGwqW5t74Z5c9P_CJtkXwyYMw@mail.gmail.com>
References: <CAGnmNJy9Z9AnZUrs+Z94gRE7JSiho=UQe1zQUOHQ3k85Dt+wpA@mail.gmail.com>
 <CALEXWq3JL7rwZYRxWHPBnBAkQC5PPYhupS5duYoPvnbK9xoE+w@mail.gmail.com>
 <CAGnmNJxqGWT_NtL4=54XrpjKzRGwqW5t74Z5c9P_CJtkXwyYMw@mail.gmail.com>
Message-ID: <37adec12-84d9-d984-6616-865057420d79@gmail.com>

On 9/17/19 6:17 PM, Cristiane Hayumi Taniguti wrote:
> Hello, thanks for all the answers.
>
> I did the new tests with all suggestions.
>
> I included the Rprintf in my script, however it did not show any NaN when
> running with my examples (the same that CRAN check pointed the error)

The approach of adding a runtime check looking for NaNs should work. You 
can reproduce the problem (extracted from the vignette for which the 
CRAN checks report NaNs, tested on the CRAN version of the package):

---

library(onemap)
data("onemap_example_f2")
data("vcf_example_f2")
comb_example <- combine_onemap(onemap_example_f2, vcf_example_f2)
twopts_f2 <- rf_2pts(comb_example)
mark_all_f2 <- make_seq(twopts_f2, "all")

CHR_mks <- group_seq(input.2pts = twopts_f2, seqs = "CHROM", unlink.mks 
= mark_all_f2,
 ????????????????????? repeated = FALSE)

---

With a smaller example like this, it is easier to iterate using added 
runtime checks. Also it is easier to debug as one can have it in an 
interactive R session.

Now one can check the "geno" vector before passed to the range 
constructor of std::vector<int>, you will see it has "NaNs" as reported 
by UBSAN. One way to check is just add a function to the code that 
searches the vector and prints a message, and call it before the line 
indicated in the UBSAN reports

std::vector<int> k_sub(&geno[i*n_ind],&geno[i*n_ind+n_ind]);

It turns out that when there is an NaN in the vector, all values are 
NaN. So it is natural to continue debugging in the surrounding R code. 
It turns out that? est_rf_f2 in cpp_utils.R sometimes gets called with a 
vector of integers (not doubles) and this vector has NAs, which are 
later converted to NaN.

So perhaps you could continue debugging from there using the R debugger 
and in an interactive session, and it might make sense to add some 
diagnostics to the C code to make it easier to debug similar problems 
later if they appear. At least it would be worth checking the type of 
the argument, this is fast and would detect that the type is integer 
instead of double. But perhaps it might make sense to check validity 
even of the individual elements.

Best
Tomas


>
> The check in r-hub Debian Linux, R-devel, GCC ASAN/UBSAN
> (linux-x86_64-rocker-gcc-san) did not show the error.
>
> The r-debug seems to be a good tool, but I had problems to build my package
> on it. First, the library libglu1-mesa-dev was missing for rgl package
> installation, then, I installed it, but I  found the following errors when
> trying to install the required MDSMap package:
>
> "Shadow memory range interleaves with an existing memory mapping. ASan
> cannot proceed correctly. ABORTING."
> and
> "/usr/bin/ld: cannot find -lgfortran"
>
> I did the modifications in rcpp files (update here<
> https://github.com/Cristianetaniguti/onemap/commit/8d90eab994c9c5cc56202c2c15c5eae7c639315b>),
> but I still can not test the package with it. Would be a problem if I
> submit anyway?
>
> On Fri, Sep 13, 2019 at 12:35 PM I?aki Ucar <iucar at fedoraproject.org> wrote:
>
>> On Fri, 13 Sep 2019 at 16:16, Cristiane Hayumi Taniguti
>> <chtaniguti at usp.br> wrote:
>>> ...........................twopts_f2.cpp:101:7: runtime error: nan is
>>> outside the range of representable values of type 'int'
>>> onemap.Rcheck/onemap-Ex.Rout:twopts_f2.cpp:101:26: runtime error: nan is
>>> outside the range of representable values of type 'int'
>> Here:
>> https://github.com/augusto-garcia/onemap/blob/master/src/twopts_f2.cpp#L101
>> -> k1=segreg_type(i); k2=segreg_type(j);
>>
>> k1 and k2 are vectors of integers, but segreg_type is a NumericVector
>> (double), which may contain NaN.
>>
>> I?aki
>>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From d@v|dhughjone@ @end|ng |rom gm@||@com  Wed Sep 25 23:28:27 2019
From: d@v|dhughjone@ @end|ng |rom gm@||@com (David Hugh-Jones)
Date: Wed, 25 Sep 2019 22:28:27 +0100
Subject: [R-pkg-devel] What counts as an API change?
In-Reply-To: <4B37F960-FCBA-479C-8A92-DE1B92860273@dcn.davis.ca.us>
References: <CAARY7khF5Xk2+tdsKnY9HubvO3kkTUL_TQGi0M4W=pSKunCxVw@mail.gmail.com>
 <AC80C057-E97A-4401-A6F7-3D6FCC0814B6@dcn.davis.ca.us>
 <CAARY7kg6MRkDigsxc2b=aViaFFa3cpL_o0o5TAxd8YJSqGCUdg@mail.gmail.com>
 <4B37F960-FCBA-479C-8A92-DE1B92860273@dcn.davis.ca.us>
Message-ID: <CAARY7kg921KiMRKxEkYHEQLY5EqKJWbh1P=_YZzhrqmoXw8TMw@mail.gmail.com>

Thanks Jeff. My function is currently:

insert_column <- function (ht, ..., after = 0, copy_cell_props = TRUE)

and I want to add a `fill` argument:

insert_column <- function (ht, ..., after = 0, fill = NULL, copy_cell_props
= TRUE)

This is definitely the best place for the fill argument - I wouldn't like
to put it after copy_cell_props.

Actually, thinking about it, both after and copy_cell_props have to be
named arguments, given the position of ... . So maybe this is my get out of
jail free card. If I add "fill", existing function calls won't break, and I
can call this "adding functionality in a backwards-compatible manner".

David


On Wed, 25 Sep 2019 at 17:26, Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
wrote:

> "assume default values are provided."
>
> Ah, no. Choosing to specify or not specify default values is a critical
> step. As is deciding where any ... argument will be placed (all specific
> arguments after that have to be named when called so positional
> compatibility cannot come back to bite you).
>
> "I wonder if it always matters"
>
> That would depend on the relationship you plan to maintain with users of
> your package. Still, sometimes breaking changes are necessary for a better
> future.
>
> I think the definition of breaking is pretty clear if you are precise in
> your argument lists. (R CMD check is very helpful in pestering you to
> document your arguments, so you do have the opportunity to be precise in
> your API definition.) It is really bad to have silent changes in behavior,
> and precision in specification is crucial to avoid that if you distribute
> packages.
>
> On September 25, 2019 7:27:25 AM PDT, David Hugh-Jones <
> davidhughjones at gmail.com> wrote:
> >Hi Jeff,
> >
> >You're right. Indeed, assume default values are provided. I should have
> >been more precise.
> >
> >I understand that the positional behaviour has changed. But I wonder if
> >it
> >always matters. OTOH I appreciate the force of the idea that an API
> >change
> >is an API change, and should be defined precisely.
> >
> >Best,
> >David
> >
> >
> >On Wed, 25 Sep 2019 at 15:01, Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
> >wrote:
> >
> >> Both of your examples are incompatible.
> >>
> >> foo <- function (a, b, c, d, e = NA )
> >>
> >> (add with default value) would be compatible.
> >>
> >> Your second example cannot be made compatible even with default
> >values
> >> because the positional behaviour has changed.
> >>
> >> On September 25, 2019 6:51:58 AM PDT, David Hugh-Jones <
> >> davidhughjones at gmail.com> wrote:
> >> >Hi all,
> >> >
> >> >Philosophical question. My package follows semantic versioning (
> >> >https://semver.org). Incompatible API changes should trigger a major
> >> >version upgrade. OK, but what counts as an incompatible change to an
> >R
> >> >API?
> >> >Suppose my current function signature is
> >> >
> >> >foo <- function (a, b, c, d)
> >> >
> >> >and the new one is
> >> >
> >> >foo <- function (a, b, c, d, e)
> >> >
> >> >is that compatible? What if I add an argument, but not at the end:
> >> >
> >> >foo <- function (a, b, c, e, d)
> >> >
> >> >That would be incompatible if people have been calling the arguments
> >by
> >> >order rather than by name. But sometimes that is unlikely: I doubt
> >if
> >> >many
> >> >people write
> >> >
> >> >lm(y ~ x, mydata, z==3, f, na.omit, "qr", FALSE, FALSE, TRUE, TRUE,
> >> >FALSE)
> >> >
> >> >Should I be strict or relaxed about this?
> >> >
> >> >Cheers,
> >> >David
> >> >
> >> >       [[alternative HTML version deleted]]
> >> >
> >> >______________________________________________
> >> >R-package-devel at r-project.org mailing list
> >> >https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >> --
> >> Sent from my phone. Please excuse my brevity.
> >>
>
> --
> Sent from my phone. Please excuse my brevity.
>

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Sep 26 00:12:16 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 25 Sep 2019 15:12:16 -0700
Subject: [R-pkg-devel] What counts as an API change?
In-Reply-To: <CAARY7kg921KiMRKxEkYHEQLY5EqKJWbh1P=_YZzhrqmoXw8TMw@mail.gmail.com>
References: <CAARY7khF5Xk2+tdsKnY9HubvO3kkTUL_TQGi0M4W=pSKunCxVw@mail.gmail.com>
 <AC80C057-E97A-4401-A6F7-3D6FCC0814B6@dcn.davis.ca.us>
 <CAARY7kg6MRkDigsxc2b=aViaFFa3cpL_o0o5TAxd8YJSqGCUdg@mail.gmail.com>
 <4B37F960-FCBA-479C-8A92-DE1B92860273@dcn.davis.ca.us>
 <CAARY7kg921KiMRKxEkYHEQLY5EqKJWbh1P=_YZzhrqmoXw8TMw@mail.gmail.com>
Message-ID: <B5B15F58-DE16-4FCA-AFB6-8CF4BD27BA20@dcn.davis.ca.us>

No "maybe" about it.

On September 25, 2019 2:28:27 PM PDT, David Hugh-Jones <davidhughjones at gmail.com> wrote:
>Thanks Jeff. My function is currently:
>
>insert_column <- function (ht, ..., after = 0, copy_cell_props = TRUE)
>
>and I want to add a `fill` argument:
>
>insert_column <- function (ht, ..., after = 0, fill = NULL,
>copy_cell_props
>= TRUE)
>
>This is definitely the best place for the fill argument - I wouldn't
>like
>to put it after copy_cell_props.
>
>Actually, thinking about it, both after and copy_cell_props have to be
>named arguments, given the position of ... . So maybe this is my get
>out of
>jail free card. If I add "fill", existing function calls won't break,
>and I
>can call this "adding functionality in a backwards-compatible manner".
>
>David
>
>
>On Wed, 25 Sep 2019 at 17:26, Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
>wrote:
>
>> "assume default values are provided."
>>
>> Ah, no. Choosing to specify or not specify default values is a
>critical
>> step. As is deciding where any ... argument will be placed (all
>specific
>> arguments after that have to be named when called so positional
>> compatibility cannot come back to bite you).
>>
>> "I wonder if it always matters"
>>
>> That would depend on the relationship you plan to maintain with users
>of
>> your package. Still, sometimes breaking changes are necessary for a
>better
>> future.
>>
>> I think the definition of breaking is pretty clear if you are precise
>in
>> your argument lists. (R CMD check is very helpful in pestering you to
>> document your arguments, so you do have the opportunity to be precise
>in
>> your API definition.) It is really bad to have silent changes in
>behavior,
>> and precision in specification is crucial to avoid that if you
>distribute
>> packages.
>>
>> On September 25, 2019 7:27:25 AM PDT, David Hugh-Jones <
>> davidhughjones at gmail.com> wrote:
>> >Hi Jeff,
>> >
>> >You're right. Indeed, assume default values are provided. I should
>have
>> >been more precise.
>> >
>> >I understand that the positional behaviour has changed. But I wonder
>if
>> >it
>> >always matters. OTOH I appreciate the force of the idea that an API
>> >change
>> >is an API change, and should be defined precisely.
>> >
>> >Best,
>> >David
>> >
>> >
>> >On Wed, 25 Sep 2019 at 15:01, Jeff Newmiller
><jdnewmil at dcn.davis.ca.us>
>> >wrote:
>> >
>> >> Both of your examples are incompatible.
>> >>
>> >> foo <- function (a, b, c, d, e = NA )
>> >>
>> >> (add with default value) would be compatible.
>> >>
>> >> Your second example cannot be made compatible even with default
>> >values
>> >> because the positional behaviour has changed.
>> >>
>> >> On September 25, 2019 6:51:58 AM PDT, David Hugh-Jones <
>> >> davidhughjones at gmail.com> wrote:
>> >> >Hi all,
>> >> >
>> >> >Philosophical question. My package follows semantic versioning (
>> >> >https://semver.org). Incompatible API changes should trigger a
>major
>> >> >version upgrade. OK, but what counts as an incompatible change to
>an
>> >R
>> >> >API?
>> >> >Suppose my current function signature is
>> >> >
>> >> >foo <- function (a, b, c, d)
>> >> >
>> >> >and the new one is
>> >> >
>> >> >foo <- function (a, b, c, d, e)
>> >> >
>> >> >is that compatible? What if I add an argument, but not at the
>end:
>> >> >
>> >> >foo <- function (a, b, c, e, d)
>> >> >
>> >> >That would be incompatible if people have been calling the
>arguments
>> >by
>> >> >order rather than by name. But sometimes that is unlikely: I
>doubt
>> >if
>> >> >many
>> >> >people write
>> >> >
>> >> >lm(y ~ x, mydata, z==3, f, na.omit, "qr", FALSE, FALSE, TRUE,
>TRUE,
>> >> >FALSE)
>> >> >
>> >> >Should I be strict or relaxed about this?
>> >> >
>> >> >Cheers,
>> >> >David
>> >> >
>> >> >       [[alternative HTML version deleted]]
>> >> >
>> >> >______________________________________________
>> >> >R-package-devel at r-project.org mailing list
>> >> >https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >>
>> >> --
>> >> Sent from my phone. Please excuse my brevity.
>> >>
>>
>> --
>> Sent from my phone. Please excuse my brevity.
>>

-- 
Sent from my phone. Please excuse my brevity.


From hugh@p@r@on@ge @end|ng |rom gm@||@com  Thu Sep 26 01:24:27 2019
From: hugh@p@r@on@ge @end|ng |rom gm@||@com (Hugh Parsonage)
Date: Thu, 26 Sep 2019 09:24:27 +1000
Subject: [R-pkg-devel] What counts as an API change?
In-Reply-To: <CAJmOi+PiGyyRrKWthuxAonDJkct=8XiSnkeHAn7j+Virt=q7Mg@mail.gmail.com>
References: <CAARY7khF5Xk2+tdsKnY9HubvO3kkTUL_TQGi0M4W=pSKunCxVw@mail.gmail.com>
 <CAJmOi+PiGyyRrKWthuxAonDJkct=8XiSnkeHAn7j+Virt=q7Mg@mail.gmail.com>
Message-ID: <CAJmOi+O-=vVV1r2VYYBOo1xmuf2hMvqbCZT99LqzVr38OUCfBg@mail.gmail.com>

> The approach I take is a major version increment is required if it
> requires an existing unit test to be changed or if it requires a reverse
> dependency to change a unit test.
>
> (With the exception of tests marked explicitly as unstable.)
>
> In my view the test suite is a good way to advertise exactly what
> developers can rely on in minor version upgrades.
>
> On Wed, 25 Sep 2019 at 11:52 pm, David Hugh-Jones <
> davidhughjones at gmail.com> wrote:
>
>> Hi all,
>>
>> Philosophical question. My package follows semantic versioning (
>> https://semver.org). Incompatible API changes should trigger a major
>> version upgrade. OK, but what counts as an incompatible change to an R
>> API?
>> Suppose my current function signature is
>>
>> foo <- function (a, b, c, d)
>>
>> and the new one is
>>
>> foo <- function (a, b, c, d, e)
>>
>> is that compatible? What if I add an argument, but not at the end:
>>
>> foo <- function (a, b, c, e, d)
>>
>> That would be incompatible if people have been calling the arguments by
>> order rather than by name. But sometimes that is unlikely: I doubt if many
>> people write
>>
>> lm(y ~ x, mydata, z==3, f, na.omit, "qr", FALSE, FALSE, TRUE, TRUE, FALSE)
>>
>> Should I be strict or relaxed about this?
>>
>> Cheers,
>> David
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>

	[[alternative HTML version deleted]]


From neon|r@ @end|ng |rom gm@||@com  Thu Sep 26 10:22:49 2019
From: neon|r@ @end|ng |rom gm@||@com (neonira Arinoem)
Date: Thu, 26 Sep 2019 10:22:49 +0200
Subject: [R-pkg-devel] What counts as an API change?
In-Reply-To: <CAJmOi+O-=vVV1r2VYYBOo1xmuf2hMvqbCZT99LqzVr38OUCfBg@mail.gmail.com>
References: <CAARY7khF5Xk2+tdsKnY9HubvO3kkTUL_TQGi0M4W=pSKunCxVw@mail.gmail.com>
 <CAJmOi+PiGyyRrKWthuxAonDJkct=8XiSnkeHAn7j+Virt=q7Mg@mail.gmail.com>
 <CAJmOi+O-=vVV1r2VYYBOo1xmuf2hMvqbCZT99LqzVr38OUCfBg@mail.gmail.com>
Message-ID: <CAN--Dz17jYHcRZMwWD+QjS2mgZ+Ps5ph4U9h+9+fGPArTdD7pw@mail.gmail.com>

Very interesting thread.

Indeed just got one question in relationship with SEMVER and API.
For a given package, does CRAN adapt the control and acceptance processes
according to SEMVER, when submitting a new package  version ?
Any reference material about CRAN control and acceptance processes are
welcome. Haven't found any yet online.

Neonira

Le jeu. 26 sept. 2019 ? 01:24, Hugh Parsonage <hugh.parsonage at gmail.com> a
?crit :

> > The approach I take is a major version increment is required if it
> > requires an existing unit test to be changed or if it requires a reverse
> > dependency to change a unit test.
> >
> > (With the exception of tests marked explicitly as unstable.)
> >
> > In my view the test suite is a good way to advertise exactly what
> > developers can rely on in minor version upgrades.
> >
> > On Wed, 25 Sep 2019 at 11:52 pm, David Hugh-Jones <
> > davidhughjones at gmail.com> wrote:
> >
> >> Hi all,
> >>
> >> Philosophical question. My package follows semantic versioning (
> >> https://semver.org). Incompatible API changes should trigger a major
> >> version upgrade. OK, but what counts as an incompatible change to an R
> >> API?
> >> Suppose my current function signature is
> >>
> >> foo <- function (a, b, c, d)
> >>
> >> and the new one is
> >>
> >> foo <- function (a, b, c, d, e)
> >>
> >> is that compatible? What if I add an argument, but not at the end:
> >>
> >> foo <- function (a, b, c, e, d)
> >>
> >> That would be incompatible if people have been calling the arguments by
> >> order rather than by name. But sometimes that is unlikely: I doubt if
> many
> >> people write
> >>
> >> lm(y ~ x, mydata, z==3, f, na.omit, "qr", FALSE, FALSE, TRUE, TRUE,
> FALSE)
> >>
> >> Should I be strict or relaxed about this?
> >>
> >> Cheers,
> >> David
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Sep 26 11:59:05 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 26 Sep 2019 05:59:05 -0400
Subject: [R-pkg-devel] What counts as an API change?
In-Reply-To: <CAN--Dz17jYHcRZMwWD+QjS2mgZ+Ps5ph4U9h+9+fGPArTdD7pw@mail.gmail.com>
References: <CAARY7khF5Xk2+tdsKnY9HubvO3kkTUL_TQGi0M4W=pSKunCxVw@mail.gmail.com>
 <CAJmOi+PiGyyRrKWthuxAonDJkct=8XiSnkeHAn7j+Virt=q7Mg@mail.gmail.com>
 <CAJmOi+O-=vVV1r2VYYBOo1xmuf2hMvqbCZT99LqzVr38OUCfBg@mail.gmail.com>
 <CAN--Dz17jYHcRZMwWD+QjS2mgZ+Ps5ph4U9h+9+fGPArTdD7pw@mail.gmail.com>
Message-ID: <b587c9be-a2e8-a5f0-7f0e-7732502cd68c@gmail.com>

On 26/09/2019 4:22 a.m., neonira Arinoem wrote:
> Very interesting thread.
> 
> Indeed just got one question in relationship with SEMVER and API.
> For a given package, does CRAN adapt the control and acceptance processes
> according to SEMVER, when submitting a new package  version ?
> Any reference material about CRAN control and acceptance processes are
> welcome. Haven't found any yet online.

CRAN requires that your new version is greater than the existing one; it 
also flags high version numbers, e.g. those that follow Hadley's 
recommendation of using 9000 to signal "in-development".  I imagine it 
would also flag non-standard version numbers, i.e. ones that the 
package_version(strict = TRUE) function doesn't accept.  Other than 
that, it more or less ignores the version number.

I'm not sure what you mean by "control and acceptance processes".  Do 
you mean internal processes, or the rules submitters need to follow? 
The latter are documented in the CRAN policies document.

Duncan Murdoch

> 
> Neonira
> 
> Le jeu. 26 sept. 2019 ? 01:24, Hugh Parsonage <hugh.parsonage at gmail.com> a
> ?crit :
> 
>>> The approach I take is a major version increment is required if it
>>> requires an existing unit test to be changed or if it requires a reverse
>>> dependency to change a unit test.
>>>
>>> (With the exception of tests marked explicitly as unstable.)
>>>
>>> In my view the test suite is a good way to advertise exactly what
>>> developers can rely on in minor version upgrades.
>>>
>>> On Wed, 25 Sep 2019 at 11:52 pm, David Hugh-Jones <
>>> davidhughjones at gmail.com> wrote:
>>>
>>>> Hi all,
>>>>
>>>> Philosophical question. My package follows semantic versioning (
>>>> https://semver.org). Incompatible API changes should trigger a major
>>>> version upgrade. OK, but what counts as an incompatible change to an R
>>>> API?
>>>> Suppose my current function signature is
>>>>
>>>> foo <- function (a, b, c, d)
>>>>
>>>> and the new one is
>>>>
>>>> foo <- function (a, b, c, d, e)
>>>>
>>>> is that compatible? What if I add an argument, but not at the end:
>>>>
>>>> foo <- function (a, b, c, e, d)
>>>>
>>>> That would be incompatible if people have been calling the arguments by
>>>> order rather than by name. But sometimes that is unlikely: I doubt if
>> many
>>>> people write
>>>>
>>>> lm(y ~ x, mydata, z==3, f, na.omit, "qr", FALSE, FALSE, TRUE, TRUE,
>> FALSE)
>>>>
>>>> Should I be strict or relaxed about this?
>>>>
>>>> Cheers,
>>>> David
>>>>
>>>>          [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From r@||@@tubner @end|ng |rom gm@||@com  Thu Sep 26 15:34:34 2019
From: r@||@@tubner @end|ng |rom gm@||@com (Ralf Stubner)
Date: Thu, 26 Sep 2019 15:34:34 +0200
Subject: [R-pkg-devel] 
 Package or namespace load failed: undefined symbol
In-Reply-To: <14594819-67CA-4875-8D01-A06DA3FBE70D@kaust.edu.sa>
References: <DD7DFEE9-3EEF-4F98-80F4-6467C10203AA@kaust.edu.sa>
 <CAFQwRQzXnvSN2JWT0sZfeWMKQ5HbYLofoCyZKLF1GfJcenTy7g@mail.gmail.com>
 <E3E52404-38F5-47E5-A464-457157F69715@kaust.edu.sa>
 <CAFQwRQyFrQ3zYKCjq0fJFEU23T0Q-9=EqRkUE+Z0r+eZUxziUg@mail.gmail.com>
 <14594819-67CA-4875-8D01-A06DA3FBE70D@kaust.edu.sa>
Message-ID: <CAFQwRQyqo+AvE-N3EZnoLHy1YR2cPcrv+ugPHiuYCqUYxBaA_A@mail.gmail.com>

On Wed, Sep 25, 2019 at 3:34 PM Sameh M. Abdulah
<sameh.abdulah at kaust.edu.sa> wrote:
> My package depends on another C-based software that needs LAPACKE to compile. I do not know a lot about it. I think adding LAPACKE to my package will be a good solution.
> Could you please give me more information of how to do this?

Including LAPACKE in your package won't help you in this case, since
it is not your package but one of its dependencies that needs it. So
LAPACKE needs to be installed when that dependency is installed, which
happens before your package gets installed.

How do you expect the dependencies to get installed? Is that done by
an admin before the package installation?

cheerio
ralf


From @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@  Thu Sep 26 15:41:55 2019
From: @@meh@@bdu|@h @end|ng |rom k@u@t@edu@@@ (Sameh M. Abdulah)
Date: Thu, 26 Sep 2019 13:41:55 +0000
Subject: [R-pkg-devel] 
 Package or namespace load failed: undefined symbol
In-Reply-To: <CAFQwRQyqo+AvE-N3EZnoLHy1YR2cPcrv+ugPHiuYCqUYxBaA_A@mail.gmail.com>
References: <DD7DFEE9-3EEF-4F98-80F4-6467C10203AA@kaust.edu.sa>
 <CAFQwRQzXnvSN2JWT0sZfeWMKQ5HbYLofoCyZKLF1GfJcenTy7g@mail.gmail.com>
 <E3E52404-38F5-47E5-A464-457157F69715@kaust.edu.sa>
 <CAFQwRQyFrQ3zYKCjq0fJFEU23T0Q-9=EqRkUE+Z0r+eZUxziUg@mail.gmail.com>
 <14594819-67CA-4875-8D01-A06DA3FBE70D@kaust.edu.sa>
 <CAFQwRQyqo+AvE-N3EZnoLHy1YR2cPcrv+ugPHiuYCqUYxBaA_A@mail.gmail.com>
Message-ID: <9A034FE1-ABE2-4785-A48F-D8F692A94678@kaust.edu.sa>

I am installing my dependencies including OpenBLAS during  the package installation via the configure file. 
What is surprising me that even all dependencies are installed successfully. R cannot load one of the library
that depends on LAPACKE. My method is to install all my dependencies inside the installation directory of my R package and
set PKG_CONFIG_PATH to this path. Do I need to set any other paths so that R can see my new OpenBLAS which include LAPACKE?

--Sameh




?On 9/26/19, 4:34 PM, "Ralf Stubner" <ralf.stubner at gmail.com> wrote:

    On Wed, Sep 25, 2019 at 3:34 PM Sameh M. Abdulah
    <sameh.abdulah at kaust.edu.sa> wrote:
    > My package depends on another C-based software that needs LAPACKE to compile. I do not know a lot about it. I think adding LAPACKE to my package will be a good solution.
    > Could you please give me more information of how to do this?
    
    Including LAPACKE in your package won't help you in this case, since
    it is not your package but one of its dependencies that needs it. So
    LAPACKE needs to be installed when that dependency is installed, which
    happens before your package gets installed.
    
    How do you expect the dependencies to get installed? Is that done by
    an admin before the package installation?
    
    cheerio
    ralf
    


From bnj|@ngece @end|ng |rom gm@||@com  Thu Sep 26 18:45:08 2019
From: bnj|@ngece @end|ng |rom gm@||@com (Bingnan Jiang)
Date: Thu, 26 Sep 2019 10:45:08 -0600
Subject: [R-pkg-devel] Package submission check error in "r-devel Windows
 ix86+x86_6" related to rJava
Message-ID: <CAGhNFiFAeF5pKdKKZxBgLBkNAE5Uxs3CJZFgopbHmOQ5Xk5Rjg@mail.gmail.com>

Hello,

When I tried to submit a new version of package "RSCAT", an error happened
during the installation check in the environment "r-devel Windows
ix86+x86_6". It looks like existing CRAN packages that depend on or import
"rJava" have the same issue on "r-devel Windows ix86+x86_6" (
https://cran.r-project.org/web/checks/check_summary_by_package.html#summary_by_package).
The error message is as follows:

Error: package or namespace load failed for 'rJava':
 .onLoad failed in loadNamespace() for 'rJava', details:
  call: inDL(x, as.logical(local), as.logical(now), ...)
  error: unable to load shared object
'd:/RCompile/CRANpkg/lib/3.7/rJava/libs/i386/rJava.dll':
  LoadLibrary failure:  %1 ist keine zul?ssige Win32-Anwendung.
The CRAN check passed on my local Win10 PC with r-devel. Could someone help
me to solve this problem? Or is it an issue of "r-devel Windows
ix86+x86_6". Thank you very much.

Regards,
Bingnan

	[[alternative HTML version deleted]]


From r@||@@tubner @end|ng |rom gm@||@com  Fri Sep 27 13:05:58 2019
From: r@||@@tubner @end|ng |rom gm@||@com (Ralf Stubner)
Date: Fri, 27 Sep 2019 13:05:58 +0200
Subject: [R-pkg-devel] 
 Package or namespace load failed: undefined symbol
In-Reply-To: <9A034FE1-ABE2-4785-A48F-D8F692A94678@kaust.edu.sa>
References: <DD7DFEE9-3EEF-4F98-80F4-6467C10203AA@kaust.edu.sa>
 <CAFQwRQzXnvSN2JWT0sZfeWMKQ5HbYLofoCyZKLF1GfJcenTy7g@mail.gmail.com>
 <E3E52404-38F5-47E5-A464-457157F69715@kaust.edu.sa>
 <CAFQwRQyFrQ3zYKCjq0fJFEU23T0Q-9=EqRkUE+Z0r+eZUxziUg@mail.gmail.com>
 <14594819-67CA-4875-8D01-A06DA3FBE70D@kaust.edu.sa>
 <CAFQwRQyqo+AvE-N3EZnoLHy1YR2cPcrv+ugPHiuYCqUYxBaA_A@mail.gmail.com>
 <9A034FE1-ABE2-4785-A48F-D8F692A94678@kaust.edu.sa>
Message-ID: <CAFQwRQxUiWcaH=kMNT8zGE2_VGyYt2Aa59OGUvJ8fSaf5Ls8CQ@mail.gmail.com>

On Thu, Sep 26, 2019 at 3:41 PM Sameh M. Abdulah
<sameh.abdulah at kaust.edu.sa> wrote:
>
> I am installing my dependencies including OpenBLAS during  the package installation via the configure file.
> What is surprising me that even all dependencies are installed successfully. R cannot load one of the library
> that depends on LAPACKE. My method is to install all my dependencies inside the installation directory of my R package and
> set PKG_CONFIG_PATH to this path. Do I need to set any other paths so that R can see my new OpenBLAS which include LAPACKE?

With PKG_CONFIGURE _PATH you enable finding the right compiler flags
for compilation. However, this does not help you with the necessary
run time linking, since you seem to be building dynamic libraries. One
way forward might be:

* Build a static version of LAPACKE
* Build a static version of your dependency
* Build your package linking with your static libs and BLAS/LAPACK as
described in WRE.

cheerio
ralf


From z|||ynn @end|ng |rom gm@||@com  Fri Sep 27 05:43:43 2019
From: z|||ynn @end|ng |rom gm@||@com (Zachary Flynn)
Date: Thu, 26 Sep 2019 23:43:43 -0400
Subject: [R-pkg-devel] Passing CRAN check when an examples must save a file
Message-ID: <CACfhunRiNMJcaymDMoJZQYd63Ac0wBB-CSUxF5ynf3B=Ohcjjg@mail.gmail.com>

I am working on a function in a package that saves a file.  I want to write
an example to document the function so it must save a file, but when I do,
the automatic CRAN checks reject the package because there is a
non-standard file saved in the directory when the second test runs (first,
it runs a test on Windows where the check error does not occur, then on
Linux where it does).  The relevant check output is:

* checking for non-standard things in the check directory ... NOTE
Found the following files/directories:
  ?Produc.csv?

There is no file called Produc.csv anywhere in the directory (the
error doesn't show up in the first run on Windows).

It is generated by running the example code which automatic CRAN
testing might be doing in between running the Windows and Linux
checks?

How do I write an example that must save a file to be an example of
using the function without triggering this issue?

Zach Flynn

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Sep 27 14:36:00 2019
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 27 Sep 2019 08:36:00 -0400
Subject: [R-pkg-devel] 
 Passing CRAN check when an examples must save a file
In-Reply-To: <CACfhunRiNMJcaymDMoJZQYd63Ac0wBB-CSUxF5ynf3B=Ohcjjg@mail.gmail.com>
References: <CACfhunRiNMJcaymDMoJZQYd63Ac0wBB-CSUxF5ynf3B=Ohcjjg@mail.gmail.com>
Message-ID: <74862bb1-0878-2634-04a4-89137709a202@gmail.com>

On 26/09/2019 11:43 p.m., Zachary Flynn wrote:
> I am working on a function in a package that saves a file.  I want to write
> an example to document the function so it must save a file, but when I do,
> the automatic CRAN checks reject the package because there is a
> non-standard file saved in the directory when the second test runs (first,
> it runs a test on Windows where the check error does not occur, then on
> Linux where it does).  The relevant check output is:
> 
> * checking for non-standard things in the check directory ... NOTE
> Found the following files/directories:
>    ?Produc.csv?
> 
> There is no file called Produc.csv anywhere in the directory (the
> error doesn't show up in the first run on Windows).
> 
> It is generated by running the example code which automatic CRAN
> testing might be doing in between running the Windows and Linux
> checks?
> 
> How do I write an example that must save a file to be an example of
> using the function without triggering this issue?

Save the file to the temporary directory, ?.g.

   filename <- file.path(tempdir(), "Prod?c.csv")
   write.csv(something, file = filename)

You could clean up at the end of the example with

   unlink(filename)

but you shouldn't rely on this alone to prevent the error:  if you're 
writing files, you should *only* be doing it in the temporary directory.

Duncan Murdoch


From z|||ynn @end|ng |rom gm@||@com  Fri Sep 27 20:56:11 2019
From: z|||ynn @end|ng |rom gm@||@com (Zachary Flynn)
Date: Fri, 27 Sep 2019 14:56:11 -0400
Subject: [R-pkg-devel] 
 Passing CRAN check when an examples must save a file
In-Reply-To: <74862bb1-0878-2634-04a4-89137709a202@gmail.com>
References: <CACfhunRiNMJcaymDMoJZQYd63Ac0wBB-CSUxF5ynf3B=Ohcjjg@mail.gmail.com>
 <74862bb1-0878-2634-04a4-89137709a202@gmail.com>
Message-ID: <CACfhunRmbj_+rLuDGYsFo+8e2d2wsWJG1wxihms5zNs1S-eYsg@mail.gmail.com>

Thanks much, that solved the issue,

Zach Flynn


On Fri, Sep 27, 2019, 8:36 AM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 26/09/2019 11:43 p.m., Zachary Flynn wrote:
> > I am working on a function in a package that saves a file.  I want to
> write
> > an example to document the function so it must save a file, but when I
> do,
> > the automatic CRAN checks reject the package because there is a
> > non-standard file saved in the directory when the second test runs
> (first,
> > it runs a test on Windows where the check error does not occur, then on
> > Linux where it does).  The relevant check output is:
> >
> > * checking for non-standard things in the check directory ... NOTE
> > Found the following files/directories:
> >    ?Produc.csv?
> >
> > There is no file called Produc.csv anywhere in the directory (the
> > error doesn't show up in the first run on Windows).
> >
> > It is generated by running the example code which automatic CRAN
> > testing might be doing in between running the Windows and Linux
> > checks?
> >
> > How do I write an example that must save a file to be an example of
> > using the function without triggering this issue?
>
> Save the file to the temporary directory, ?.g.
>
>    filename <- file.path(tempdir(), "Prod?c.csv")
>    write.csv(something, file = filename)
>
> You could clean up at the end of the example with
>
>    unlink(filename)
>
> but you shouldn't rely on this alone to prevent the error:  if you're
> writing files, you should *only* be doing it in the temporary directory.
>
> Duncan Murdoch
>

	[[alternative HTML version deleted]]


From jpr|t|k|n @end|ng |rom pobox@com  Sat Sep 28 01:56:20 2019
From: jpr|t|k|n @end|ng |rom pobox@com (Joshua N Pritikin)
Date: Fri, 27 Sep 2019 19:56:20 -0400
Subject: [R-pkg-devel] how to throw a C++ exception across modules
Message-ID: <20190927235620.q7s5gto6qv4zg2ze@tailwind>

OpenMx exports an API that I import into another package (gwsem) like 
this,

  aldp = R_GetCCallable("OpenMx", "AddLoadDataProvider")

gwsem registers some C++ classes through this API.

This works great until gwsem throws a C++ exception. OpenMx calls gwsem in 
a try-catch region. This works flawlessly on Linux. However, it seems to 
not work on Windows. win-builder.r-project.org complained,

** running tests for arch 'i386' ... [23s] ERROR
  Running 'testthat.R' [22s]
Running the tests in 'tests/testthat.R' failed.
Complete output:
  > library(testthat)
  > library(gwsem)
  Loading required package: OpenMx
  > 
  > test_check("gwsem")
  
  This application has requested the Runtime to terminate it in an unusual way.
  Please contact the application's support team for more information.
  terminate called after throwing an instance of 'std::runtime_error'
    what():  MxComputeLoadData: out of data (record 250 requested but only 199 in file)

What solution is recommended?

Thank you.

-- 
Joshua N. Pritikin, Ph.D.
Virginia Institute for Psychiatric and Behavioral Genetics
Virginia Commonwealth University
PO Box 980126
800 E Leigh St, Biotech One, Suite 1-133
Richmond, VA 23219
http://exuberant-island.surge.sh


From t|@goo||voto @end|ng |rom gm@||@com  Sat Sep 28 02:16:30 2019
From: t|@goo||voto @end|ng |rom gm@||@com (Tiago Olivoto)
Date: Fri, 27 Sep 2019 21:16:30 -0300
Subject: [R-pkg-devel] Fwd: Passing CRAN check when an examples must save a
 file
In-Reply-To: <74862bb1-0878-2634-04a4-89137709a202@gmail.com>
References: <CACfhunRiNMJcaymDMoJZQYd63Ac0wBB-CSUxF5ynf3B=Ohcjjg@mail.gmail.com>
 <74862bb1-0878-2634-04a4-89137709a202@gmail.com>
Message-ID: <CAMyz+tW6qMaxUuYVcQPCbovF_uMPuoaEfL9+zHD-oiWLsRxP3w@mail.gmail.com>

Dear all,
I had the same problem when I submitted my R package 'metan' to CRAN for
the first time.

"Please ensure that your functions do not write by default or in your
examples/vignettes/tests in the user's home filespace (including the
package directory and getwd()). In your examples/vignettes/tests you can
write to tempdir()"

I have several 'summary()' functions like:








*summary.waasb <- function(object, export = FALSE, file.name
<http://file.name> = "summary_waasb", ...) {  # do all I need here  if
(export == TRUE) {    sink(paste0(file.name <http://file.name>, ".txt"))
# do all I need here    sink()  }}*

All 'export' arguments are set to 'FALSE'. So, no file is generated in the
user's working directory.
Is the above function not according to the CRAN policies?

In two vignettes I have a code like:



*```{r, eval=FALSE }summary(stat_ge, export = TRUE)```*

Please, note that 'eval = FALSE'. Could this be the problem?
The suggestion is to write to a tempdir() but even looking at the Duncan
Murdoch's answer I cannot see how to do that in my case.
Looking for any suggestion.
Best regards,
Tiago Olivoto









---------- Forwarded message ---------
De: Duncan Murdoch <murdoch.duncan at gmail.com>
Date: sex, 27 de set de 2019 ?s 09:44
Subject: Re: [R-pkg-devel] Passing CRAN check when an examples must save a
file
To: Zachary Flynn <zlflynn at gmail.com>, <r-package-devel at r-project.org>


On 26/09/2019 11:43 p.m., Zachary Flynn wrote:
> I am working on a function in a package that saves a file.  I want to
write
> an example to document the function so it must save a file, but when I do,
> the automatic CRAN checks reject the package because there is a
> non-standard file saved in the directory when the second test runs (first,
> it runs a test on Windows where the check error does not occur, then on
> Linux where it does).  The relevant check output is:
>
> * checking for non-standard things in the check directory ... NOTE
> Found the following files/directories:
>    ?Produc.csv?
>
> There is no file called Produc.csv anywhere in the directory (the
> error doesn't show up in the first run on Windows).
>
> It is generated by running the example code which automatic CRAN
> testing might be doing in between running the Windows and Linux
> checks?
>
> How do I write an example that must save a file to be an example of
> using the function without triggering this issue?

Save the file to the temporary directory, ?.g.

   filename <- file.path(tempdir(), "Prod?c.csv")
   write.csv(something, file = filename)

You could clean up at the end of the example with

   unlink(filename)

but you shouldn't rely on this alone to prevent the error:  if you're
writing files, you should *only* be doing it in the temporary directory.

Duncan Murdoch

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Sep 28 07:41:42 2019
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 27 Sep 2019 22:41:42 -0700
Subject: [R-pkg-devel] 
 Fwd: Passing CRAN check when an examples must save a file
In-Reply-To: <CAMyz+tW6qMaxUuYVcQPCbovF_uMPuoaEfL9+zHD-oiWLsRxP3w@mail.gmail.com>
References: <CACfhunRiNMJcaymDMoJZQYd63Ac0wBB-CSUxF5ynf3B=Ohcjjg@mail.gmail.com>
 <74862bb1-0878-2634-04a4-89137709a202@gmail.com>
 <CAMyz+tW6qMaxUuYVcQPCbovF_uMPuoaEfL9+zHD-oiWLsRxP3w@mail.gmail.com>
Message-ID: <D6CD7678-F3CE-4962-8960-9328BE5D36BC@dcn.davis.ca.us>

Read the Posting Guide... sending html formatted email corrupts your message.

Reading between the garbage...

a) Pasting an extension is not necessary.
b) using tempfile() in your example as an argument to sink( file=) is a straightforward way to illustrate that a file can be created.

On September 27, 2019 5:16:30 PM PDT, Tiago Olivoto <tiagoolivoto at gmail.com> wrote:
>Dear all,
>I had the same problem when I submitted my R package 'metan' to CRAN
>for
>the first time.
>
>"Please ensure that your functions do not write by default or in your
>examples/vignettes/tests in the user's home filespace (including the
>package directory and getwd()). In your examples/vignettes/tests you
>can
>write to tempdir()"
>
>I have several 'summary()' functions like:
>
>
>
>
>
>
>
>
>*summary.waasb <- function(object, export = FALSE, file.name
><http://file.name> = "summary_waasb", ...) {  # do all I need here  if
>(export == TRUE) {    sink(paste0(file.name <http://file.name>,
>".txt"))
># do all I need here    sink()  }}*
>
>All 'export' arguments are set to 'FALSE'. So, no file is generated in
>the
>user's working directory.
>Is the above function not according to the CRAN policies?
>
>In two vignettes I have a code like:
>
>
>
>*```{r, eval=FALSE }summary(stat_ge, export = TRUE)```*
>
>Please, note that 'eval = FALSE'. Could this be the problem?
>The suggestion is to write to a tempdir() but even looking at the
>Duncan
>Murdoch's answer I cannot see how to do that in my case.
>Looking for any suggestion.
>Best regards,
>Tiago Olivoto
>
>
>
>
>
>
>
>
>
>---------- Forwarded message ---------
>De: Duncan Murdoch <murdoch.duncan at gmail.com>
>Date: sex, 27 de set de 2019 ?s 09:44
>Subject: Re: [R-pkg-devel] Passing CRAN check when an examples must
>save a
>file
>To: Zachary Flynn <zlflynn at gmail.com>, <r-package-devel at r-project.org>
>
>
>On 26/09/2019 11:43 p.m., Zachary Flynn wrote:
>> I am working on a function in a package that saves a file.  I want to
>write
>> an example to document the function so it must save a file, but when
>I do,
>> the automatic CRAN checks reject the package because there is a
>> non-standard file saved in the directory when the second test runs
>(first,
>> it runs a test on Windows where the check error does not occur, then
>on
>> Linux where it does).  The relevant check output is:
>>
>> * checking for non-standard things in the check directory ... NOTE
>> Found the following files/directories:
>>    ?Produc.csv?
>>
>> There is no file called Produc.csv anywhere in the directory (the
>> error doesn't show up in the first run on Windows).
>>
>> It is generated by running the example code which automatic CRAN
>> testing might be doing in between running the Windows and Linux
>> checks?
>>
>> How do I write an example that must save a file to be an example of
>> using the function without triggering this issue?
>
>Save the file to the temporary directory, ?.g.
>
>   filename <- file.path(tempdir(), "Prod?c.csv")
>   write.csv(something, file = filename)
>
>You could clean up at the end of the example with
>
>   unlink(filename)
>
>but you shouldn't rely on this alone to prevent the error:  if you're
>writing files, you should *only* be doing it in the temporary
>directory.
>
>Duncan Murdoch
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From @gutreuter @end|ng |rom gm@||@com  Mon Sep 30 16:31:23 2019
From: @gutreuter @end|ng |rom gm@||@com (Steve Gutreuter)
Date: Mon, 30 Sep 2019 10:31:23 -0400
Subject: [R-pkg-devel] Building fails with 'mypackage/DESCRIPTION' does not
 exist
Message-ID: <CAP2ZeLtnuQsxzybnxZ5SgAB4M2UpmiPPuxj9X9wBgtRJWNGnkg@mail.gmail.com>

I have a package which will no longer build after minor changes.  The
problem occurs under both Windows 10 and Linux Mint.  For example, from a
Windows terminal I do:

C:\Users\xyz\OneDrive - ORG\Computing\Devel> R CMD build screenr

and I get:

* checking for file 'mypackage/DESCRIPTION' ... OK
* preparing 'mypackage':
* checking DESCRIPTION meta-information ... OK
* installing the package to process help pages
* saving partial Rd database
 Error in .read_description(ldpath) :
   file 'mypackage/DESCRIPTION' does not exist
 Execution halted

So the first and third lines of output contradict the error message, and of
course mypackage/DESCRIPTION does exist.  I suspect the problem has nothing
to do with the DESCRIPTION file, but have not found way to identify the
actual problem in searches on StackOverflow and elsewhere. My .R files in
mypackage/R contain Roxygen comments, and curiously devtools::document()
adds nothing to mypackage/man.

Any suggestions about how to debug or solve this problem?

Thanks!
Steve

	[[alternative HTML version deleted]]


From M@x@Turgeon @end|ng |rom um@n|tob@@c@  Mon Sep 30 21:37:09 2019
From: M@x@Turgeon @end|ng |rom um@n|tob@@c@ (Max Turgeon)
Date: Mon, 30 Sep 2019 19:37:09 +0000
Subject: [R-pkg-devel] 
 Building fails with 'mypackage/DESCRIPTION' does not exist
In-Reply-To: <CAP2ZeLtnuQsxzybnxZ5SgAB4M2UpmiPPuxj9X9wBgtRJWNGnkg@mail.gmail.com>
References: <CAP2ZeLtnuQsxzybnxZ5SgAB4M2UpmiPPuxj9X9wBgtRJWNGnkg@mail.gmail.com>
Message-ID: <40213d54c2dc42e4bc3039903c9b5a80@umanitoba.ca>

Hi Steve,


Is there a reason why your package is called `screenr`, and yet the output mentions `mypackage` as the name of the package? Did you manually edit the output? If not, then it would perhaps suggest that you have another description file lying around in your directory that's causing some interference...


In general, we are missing a bit of context to truly be able to help you. I cloned your repo from Github (https://github.com/sgutreuter/screenr) and was able to build the package without any issue, but it may not be the most up-to-date version of the package either.


Cheers,


Max Turgeon
Assistant Professor
Department of Statistics
Department of Computer Science
University of Manitoba
maxturgeon.ca<http://maxturgeon.ca>


________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Steve Gutreuter <sgutreuter at gmail.com>
Sent: September 30, 2019 9:31:23 AM
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Building fails with 'mypackage/DESCRIPTION' does not exist

I have a package which will no longer build after minor changes.  The
problem occurs under both Windows 10 and Linux Mint.  For example, from a
Windows terminal I do:

C:\Users\xyz\OneDrive - ORG\Computing\Devel> R CMD build screenr

and I get:

* checking for file 'mypackage/DESCRIPTION' ... OK
* preparing 'mypackage':
* checking DESCRIPTION meta-information ... OK
* installing the package to process help pages
* saving partial Rd database
 Error in .read_description(ldpath) :
   file 'mypackage/DESCRIPTION' does not exist
 Execution halted

So the first and third lines of output contradict the error message, and of
course mypackage/DESCRIPTION does exist.  I suspect the problem has nothing
to do with the DESCRIPTION file, but have not found way to identify the
actual problem in searches on StackOverflow and elsewhere. My .R files in
mypackage/R contain Roxygen comments, and curiously devtools::document()
adds nothing to mypackage/man.

Any suggestions about how to debug or solve this problem?

Thanks!
Steve

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From pd@|gd @end|ng |rom gm@||@com  Mon Sep 30 21:37:06 2019
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Mon, 30 Sep 2019 21:37:06 +0200
Subject: [R-pkg-devel] 
 Building fails with 'mypackage/DESCRIPTION' does not exist
In-Reply-To: <CAP2ZeLtnuQsxzybnxZ5SgAB4M2UpmiPPuxj9X9wBgtRJWNGnkg@mail.gmail.com>
References: <CAP2ZeLtnuQsxzybnxZ5SgAB4M2UpmiPPuxj9X9wBgtRJWNGnkg@mail.gmail.com>
Message-ID: <E1A23F80-9ACB-418B-9929-24A5B3C0DCB5@gmail.com>

Is it really called "mypackage"? Otherwise I'd first check that it is spelled the same way in all cases... 

Another possibility is that the embedded spaces in the pathname is doing you in.

-pd

> On 30 Sep 2019, at 16:31 , Steve Gutreuter <sgutreuter at gmail.com> wrote:
> 
> I have a package which will no longer build after minor changes.  The
> problem occurs under both Windows 10 and Linux Mint.  For example, from a
> Windows terminal I do:
> 
> C:\Users\xyz\OneDrive - ORG\Computing\Devel> R CMD build screenr
> 
> and I get:
> 
> * checking for file 'mypackage/DESCRIPTION' ... OK
> * preparing 'mypackage':
> * checking DESCRIPTION meta-information ... OK
> * installing the package to process help pages
> * saving partial Rd database
> Error in .read_description(ldpath) :
>   file 'mypackage/DESCRIPTION' does not exist
> Execution halted
> 
> So the first and third lines of output contradict the error message, and of
> course mypackage/DESCRIPTION does exist.  I suspect the problem has nothing
> to do with the DESCRIPTION file, but have not found way to identify the
> actual problem in searches on StackOverflow and elsewhere. My .R files in
> mypackage/R contain Roxygen comments, and curiously devtools::document()
> adds nothing to mypackage/man.
> 
> Any suggestions about how to debug or solve this problem?
> 
> Thanks!
> Steve
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From h@w|ckh@m @end|ng |rom gm@||@com  Mon Sep 30 22:16:50 2019
From: h@w|ckh@m @end|ng |rom gm@||@com (Hadley Wickham)
Date: Mon, 30 Sep 2019 15:16:50 -0500
Subject: [R-pkg-devel] Require <package>-package.Rd?
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E01CC77C076@MBXP01.ds.man.ac.uk>
References: <581a012f01524e6b887582a574fc0a7b@UM-MAIL3214.unimaas.nl>
 <438D2EC9EAFE5946B2D5864670EA468E01CC77C076@MBXP01.ds.man.ac.uk>
Message-ID: <CABdHhvF1iugQgnd+k1Cau5q2DymJ7pWQ9MSVJ60vpfLveZB4kg@mail.gmail.com>

On Tue, Sep 24, 2019 at 8:07 AM Georgi Boshnakov
<georgi.boshnakov at manchester.ac.uk> wrote:
>
> It is worth noting that
>
> help(package="<package>")
>
> shows  file <package>-package.Rd, while
>
> help(<package>)
>
> shows topic "package".
>
> Topic <package>-package.Rd is also printed at the top of the pdf manual, while package.Rd follows the alphabetical ordering of the remaining topics. It is unfortunate that Hadley Wickham's tools (at least 'pkgdown') recommend and use <package>.Rd, instead of <package>-package.Rd as overall package description.

I'm not sure what lead you to that believe, but we definitely support
(and have supported for years) package?<package>.  See, e.g.
https://usethis.r-lib.org/reference/use_package_doc.html

Hadley

-- 
http://hadley.nz


From wdun|@p @end|ng |rom t|bco@com  Mon Sep 30 23:30:31 2019
From: wdun|@p @end|ng |rom t|bco@com (William Dunlap)
Date: Mon, 30 Sep 2019 14:30:31 -0700
Subject: [R-pkg-devel] 
 Building fails with 'mypackage/DESCRIPTION' does not exist
In-Reply-To: <CAP2ZeLtnuQsxzybnxZ5SgAB4M2UpmiPPuxj9X9wBgtRJWNGnkg@mail.gmail.com>
References: <CAP2ZeLtnuQsxzybnxZ5SgAB4M2UpmiPPuxj9X9wBgtRJWNGnkg@mail.gmail.com>
Message-ID: <CAF8bMcYstPfGTHXPi79H5YkER=QLwnS29GTmfRMwrMmum+9P2Q@mail.gmail.com>

Will the package build if you back out the "minor changes"?  If so, what
were the minor changes (show diff output)?

Bill Dunlap
TIBCO Software
wdunlap tibco.com


On Mon, Sep 30, 2019 at 12:24 PM Steve Gutreuter <sgutreuter at gmail.com>
wrote:

> I have a package which will no longer build after minor changes.  The
> problem occurs under both Windows 10 and Linux Mint.  For example, from a
> Windows terminal I do:
>
> C:\Users\xyz\OneDrive - ORG\Computing\Devel> R CMD build screenr
>
> and I get:
>
> * checking for file 'mypackage/DESCRIPTION' ... OK
> * preparing 'mypackage':
> * checking DESCRIPTION meta-information ... OK
> * installing the package to process help pages
> * saving partial Rd database
>  Error in .read_description(ldpath) :
>    file 'mypackage/DESCRIPTION' does not exist
>  Execution halted
>
> So the first and third lines of output contradict the error message, and of
> course mypackage/DESCRIPTION does exist.  I suspect the problem has nothing
> to do with the DESCRIPTION file, but have not found way to identify the
> actual problem in searches on StackOverflow and elsewhere. My .R files in
> mypackage/R contain Roxygen comments, and curiously devtools::document()
> adds nothing to mypackage/man.
>
> Any suggestions about how to debug or solve this problem?
>
> Thanks!
> Steve
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


