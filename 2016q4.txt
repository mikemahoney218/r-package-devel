From pdalgd at gmail.com  Sat Oct  1 12:02:11 2016
From: pdalgd at gmail.com (peter dalgaard)
Date: Sat, 1 Oct 2016 12:02:11 +0200
Subject: [R-pkg-devel] R Packages Never Finish Check
In-Reply-To: <589cd580-de88-cf31-3b7a-e7989da97b60@gmail.com>
References: <HE1PR0201MB14660C3399141B12D3BB16939FC10@HE1PR0201MB1466.eurprd02.prod.outlook.com>
	<589cd580-de88-cf31-3b7a-e7989da97b60@gmail.com>
Message-ID: <82B29EB4-F007-433A-9829-8DAC87B4690B@gmail.com>


> On 30 Sep 2016, at 18:52 , Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 30/09/2016 12:24 PM, Ortega, Cameron wrote:
>> Hi,
>> 
>> When I attempt to run Check on any package, the "checking installed package size..." Check never finishes. This is across multiple versions of R and RStudio, with every package I have attempted to run, including packages confirmed to pass Check quickly and with no issues for others.
>> 
>> I have attempted to run Check using the following methods:
>> -Check under the Build tab of RStudio
>> -Running devtools::check() from the RStudio console
>> -Running R CMD check from the command line
>> 
>> Has anyone experienced Check failing to progress on any step, or have any ideas about what I should try next?
> 
> I've never seen that, and I run R CMD check a lot, and devtools::check sometimes.  So you're probably stuck debugging it yourself.
> 
> Do the usual debugging things:  simplify the process.  You're using devtools::check; see if the same thing happens in a terminal running R CMD check.  Depending on the answer to that, simplify the package down to almost nothing, and see if it still happens.
> 
> If you're lucky, it will only happen in devtools::check, and then you can see what it is doing that's different than what R CMD check does.  If they both give the same problem, you might need to dive into the R sources to see what "* checking installed package size ..." really does, and try running code like that independently.
> 

I think she said that she tried that... 

One more thing: when something "checks size" and loops forever, my suspicicion goes in the direction of the file system (link loops and such); perhaps try moving the build (or install) location? Also, our usual foe: virus checkers, could be involved.

Peter D.

> Duncan Murdoch
> 
>> 
>> 
>> This is my session info:
>> R version 3.3.1 (2016-06-21)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows 7 x64 (build 7601) Service Pack 1
>> 
>> locale:
>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252
>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>> 
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> 
>> loaded via a namespace (and not attached):
>> [1] tools_3.3.1
>> 
>> 
>> 
>> 
>> 
>> 
>> 
>> This is a print out from the RStudio Check:
>> ==> devtools::check()
>> 
>> Updating linkedata documentation
>> Loading linkedata
>> Writing NAMESPACE
>> Writing linkedata.Rd
>> Writing linke.Rd
>> Setting env vars ---------------------------------------------------------------
>> CFLAGS  : -Wall -pedantic
>> CXXFLAGS: -Wall -pedantic
>> Building linkedata -------------------------------------------------------------
>> "C:/PROGRA~1/R/R-33~1.1/bin/x64/R" --no-site-file --no-environ --no-save  \
>>   --no-restore --quiet CMD build  \
>>   "C:\Users\caort\Documents\Subversion\rcode\lib\src\linkedata"  \
>>   --no-resave-data --no-manual
>> 
>> * checking for file 'C:\Users\caort\Documents\Subversion\rcode\lib\src\linkedata/DESCRIPTION' ... OK
>> * preparing 'linkedata':
>> * checking DESCRIPTION meta-information ... OK
>> * checking for LF line-endings in source and make files
>> * checking for empty or unneeded directories
>> Removed empty directory 'linkedata/zipdta'
>> * looking to see if a 'data/datalist' file should be added
>> * building 'linkedata_0.1.0.tar.gz'
>> 
>> Setting env vars ---------------------------------------------------------------
>> _R_CHECK_CRAN_INCOMING_ : FALSE
>> _R_CHECK_FORCE_SUGGESTS_: FALSE
>> Checking linkedata -------------------------------------------------------------
>> "C:/PROGRA~1/R/R-33~1.1/bin/x64/R" --no-site-file --no-environ --no-save  \
>>   --no-restore --quiet CMD check  \
>>   "C:\Users\caort\AppData\Local\Temp\Rtmp8EbYiM/linkedata_0.1.0.tar.gz"  \
>>   --as-cran --timings --no-manual
>> 
>> * using log directory 'C:/Users/caort/Documents/Subversion/rcode/lib/src/linkedata.Rcheck'
>> * using R version 3.3.1 (2016-06-21)
>> * using platform: x86_64-w64-mingw32 (64-bit)
>> * using session charset: ISO8859-1
>> * using options '--no-manual --as-cran'
>> * checking for file 'linkedata/DESCRIPTION' ... OK
>> * checking extension type ... Package
>> * this is package 'linkedata' version '0.1.0'
>> * checking package namespace information ... OK
>> * checking package dependencies ... NOTE
>> Package suggested but not available for checking: 'pvsolcalcs'
>> * checking if this is a source package ... OK
>> * checking if there is a namespace ... OK
>> * checking for executable files ... OK
>> * checking for hidden files and directories ... OK
>> * checking for portable file names ... OK
>> * checking whether package 'linkedata' can be installed ... OK
>> * checking installed package size ...
>> 
>> 
>> 
>> 
>> 
>> **************************************************************************************
>> This e-mail and any attachments thereto may contain confidential information and/or information protected by intellectual property rights for the exclusive attention of the intended addressees named above. If you have received this transmission in error, please immediately notify the sender by return e-mail and delete this message and its attachments. Unauthorized use, copying or further full or partial distribution of this e-mail or its contents is prohibited.
>> **************************************************************************************
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From henrik.bengtsson at gmail.com  Sun Oct  2 19:45:07 2016
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Sun, 2 Oct 2016 10:45:07 -0700
Subject: [R-pkg-devel] R Packages Never Finish Check
In-Reply-To: <82B29EB4-F007-433A-9829-8DAC87B4690B@gmail.com>
References: <HE1PR0201MB14660C3399141B12D3BB16939FC10@HE1PR0201MB1466.eurprd02.prod.outlook.com>
	<589cd580-de88-cf31-3b7a-e7989da97b60@gmail.com>
	<82B29EB4-F007-433A-9829-8DAC87B4690B@gmail.com>
Message-ID: <CAFDcVCQfpKhmnTmX5gwjB=J7wt9ac-LCjfrvumVHLWcq=FR5wA@mail.gmail.com>

I think R CMD check calls

res <- system2("du", "-k", TRUE, TRUE)

also on Windows, cf.
https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3859

It could be that you have a corrupt / different `du` tool on your
PATH.  As a first thing, try calling the above from within you package
directory.  You can also try it on the command line.   You should get
a list of sizes and paths.  If 'du' is doing something else, that
could be your answer.

As Peter says, it could also be that there's a link loop causing `du`
to never finish.  Now that link loop could either be in your package
source or in the temporary package source directory that R CMD check
sets up.  Troubleshooting the latter will be more tricky.

My $.02

Henrik

On Sat, Oct 1, 2016 at 3:02 AM, peter dalgaard <pdalgd at gmail.com> wrote:
>
>> On 30 Sep 2016, at 18:52 , Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> On 30/09/2016 12:24 PM, Ortega, Cameron wrote:
>>> Hi,
>>>
>>> When I attempt to run Check on any package, the "checking installed package size..." Check never finishes. This is across multiple versions of R and RStudio, with every package I have attempted to run, including packages confirmed to pass Check quickly and with no issues for others.
>>>
>>> I have attempted to run Check using the following methods:
>>> -Check under the Build tab of RStudio
>>> -Running devtools::check() from the RStudio console
>>> -Running R CMD check from the command line
>>>
>>> Has anyone experienced Check failing to progress on any step, or have any ideas about what I should try next?
>>
>> I've never seen that, and I run R CMD check a lot, and devtools::check sometimes.  So you're probably stuck debugging it yourself.
>>
>> Do the usual debugging things:  simplify the process.  You're using devtools::check; see if the same thing happens in a terminal running R CMD check.  Depending on the answer to that, simplify the package down to almost nothing, and see if it still happens.
>>
>> If you're lucky, it will only happen in devtools::check, and then you can see what it is doing that's different than what R CMD check does.  If they both give the same problem, you might need to dive into the R sources to see what "* checking installed package size ..." really does, and try running code like that independently.
>>
>
> I think she said that she tried that...
>
> One more thing: when something "checks size" and loops forever, my suspicicion goes in the direction of the file system (link loops and such); perhaps try moving the build (or install) location? Also, our usual foe: virus checkers, could be involved.
>
> Peter D.
>
>> Duncan Murdoch
>>
>>>
>>>
>>> This is my session info:
>>> R version 3.3.1 (2016-06-21)
>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>> Running under: Windows 7 x64 (build 7601) Service Pack 1
>>>
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252
>>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>>> [5] LC_TIME=English_United States.1252
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> loaded via a namespace (and not attached):
>>> [1] tools_3.3.1
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> This is a print out from the RStudio Check:
>>> ==> devtools::check()
>>>
>>> Updating linkedata documentation
>>> Loading linkedata
>>> Writing NAMESPACE
>>> Writing linkedata.Rd
>>> Writing linke.Rd
>>> Setting env vars ---------------------------------------------------------------
>>> CFLAGS  : -Wall -pedantic
>>> CXXFLAGS: -Wall -pedantic
>>> Building linkedata -------------------------------------------------------------
>>> "C:/PROGRA~1/R/R-33~1.1/bin/x64/R" --no-site-file --no-environ --no-save  \
>>>   --no-restore --quiet CMD build  \
>>>   "C:\Users\caort\Documents\Subversion\rcode\lib\src\linkedata"  \
>>>   --no-resave-data --no-manual
>>>
>>> * checking for file 'C:\Users\caort\Documents\Subversion\rcode\lib\src\linkedata/DESCRIPTION' ... OK
>>> * preparing 'linkedata':
>>> * checking DESCRIPTION meta-information ... OK
>>> * checking for LF line-endings in source and make files
>>> * checking for empty or unneeded directories
>>> Removed empty directory 'linkedata/zipdta'
>>> * looking to see if a 'data/datalist' file should be added
>>> * building 'linkedata_0.1.0.tar.gz'
>>>
>>> Setting env vars ---------------------------------------------------------------
>>> _R_CHECK_CRAN_INCOMING_ : FALSE
>>> _R_CHECK_FORCE_SUGGESTS_: FALSE
>>> Checking linkedata -------------------------------------------------------------
>>> "C:/PROGRA~1/R/R-33~1.1/bin/x64/R" --no-site-file --no-environ --no-save  \
>>>   --no-restore --quiet CMD check  \
>>>   "C:\Users\caort\AppData\Local\Temp\Rtmp8EbYiM/linkedata_0.1.0.tar.gz"  \
>>>   --as-cran --timings --no-manual
>>>
>>> * using log directory 'C:/Users/caort/Documents/Subversion/rcode/lib/src/linkedata.Rcheck'
>>> * using R version 3.3.1 (2016-06-21)
>>> * using platform: x86_64-w64-mingw32 (64-bit)
>>> * using session charset: ISO8859-1
>>> * using options '--no-manual --as-cran'
>>> * checking for file 'linkedata/DESCRIPTION' ... OK
>>> * checking extension type ... Package
>>> * this is package 'linkedata' version '0.1.0'
>>> * checking package namespace information ... OK
>>> * checking package dependencies ... NOTE
>>> Package suggested but not available for checking: 'pvsolcalcs'
>>> * checking if this is a source package ... OK
>>> * checking if there is a namespace ... OK
>>> * checking for executable files ... OK
>>> * checking for hidden files and directories ... OK
>>> * checking for portable file names ... OK
>>> * checking whether package 'linkedata' can be installed ... OK
>>> * checking installed package size ...
>>>
>>>
>>>
>>>
>>>
>>> **************************************************************************************
>>> This e-mail and any attachments thereto may contain confidential information and/or information protected by intellectual property rights for the exclusive attention of the intended addressees named above. If you have received this transmission in error, please immediately notify the sender by return e-mail and delete this message and its attachments. Unauthorized use, copying or further full or partial distribution of this e-mail or its contents is prohibited.
>>> **************************************************************************************
>>>
>>>      [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> --
> Peter Dalgaard, Professor,
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Office: A 4.23
> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From stellajohnson630 at gmail.com  Sun Oct  2 22:05:57 2016
From: stellajohnson630 at gmail.com (S johnson)
Date: Sun, 2 Oct 2016 15:05:57 -0500
Subject: [R-pkg-devel] Note and warning about subdirectory sizes
Message-ID: <CABrdRMQvemSwOUBjy-YVDtWCCKNuqazufxh25_zdj-2MTheG1Q@mail.gmail.com>

Hi all,

I am running check() on an R package, and receive one note and one warning
(seem to be related):

* checking installed package size ... NOTE
  installed size is 25.9Mb
  sub-directories of 1Mb or more:

    doc       3.4Mb
    extdata  22.1Mb

* checking sizes of PDF files under ?inst/doc? ... WARNING
  ?gs+qpdf? made some significant size reductions:
     compacted ?ePort.pdf? from 1655Kb to 1076Kb
  consider running tools::compactPDF(gs_quality = "ebook") on these files

After pondering this note, I have three brief questions as follows,

1) When I run "du -hs" on the doc sub-directory, it lists its size as
only 10K. There is only one file inside the doc sub-directory, and
similarly, when I run "du -hs" on that one file, it lists its size as
only 10K. I wonder, then, why check() reports that this sub-directory
called doc is 3.4 Mb?

2) My extdata sub-directory is rather large. It is certainly over 1Mb.
This is due to a few dozen example images (.png files) that we feel is
important to include in the package. In general, do notes like these prevent
CRAN submission acceptance? If so, what would be an alternative? I
imagine there were other packages that had extdata subdirectory with
example components that are larger than 1Mb - and upon a Google search
that seems to be the case. Still, I wanted to seek your input!

3) I am unfamiliar with what I should consider running compactPDF() on.
None of the files are PDF files. The doc sub-directory has one .R file, and
the extdata sub-directory has .R files, .png files (taking up the most
space), and .txt files.

Thank you!

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Sun Oct  2 22:43:05 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 2 Oct 2016 16:43:05 -0400
Subject: [R-pkg-devel] Note and warning about subdirectory sizes
In-Reply-To: <CABrdRMQvemSwOUBjy-YVDtWCCKNuqazufxh25_zdj-2MTheG1Q@mail.gmail.com>
References: <CABrdRMQvemSwOUBjy-YVDtWCCKNuqazufxh25_zdj-2MTheG1Q@mail.gmail.com>
Message-ID: <c2d79008-60bc-7ffc-b1a5-881a9e744343@gmail.com>

On 02/10/2016 4:05 PM, S johnson wrote:
> Hi all,
>
> I am running check() on an R package, and receive one note and one warning
> (seem to be related):
>
> * checking installed package size ... NOTE
>   installed size is 25.9Mb
>   sub-directories of 1Mb or more:
>
>     doc       3.4Mb
>     extdata  22.1Mb
>
> * checking sizes of PDF files under ?inst/doc? ... WARNING
>   ?gs+qpdf? made some significant size reductions:
>      compacted ?ePort.pdf? from 1655Kb to 1076Kb
>   consider running tools::compactPDF(gs_quality = "ebook") on these files
>
> After pondering this note, I have three brief questions as follows,
>
> 1) When I run "du -hs" on the doc sub-directory, it lists its size as
> only 10K. There is only one file inside the doc sub-directory, and
> similarly, when I run "du -hs" on that one file, it lists its size as
> only 10K. I wonder, then, why check() reports that this sub-directory
> called doc is 3.4 Mb?

You are probably looking at the package source; the measurements are 
made after installation.  At that point the vignettes have been copied 
into the doc directory.

>
> 2) My extdata sub-directory is rather large. It is certainly over 1Mb.
> This is due to a few dozen example images (.png files) that we feel is
> important to include in the package. In general, do notes like these prevent
> CRAN submission acceptance? If so, what would be an alternative? I
> imagine there were other packages that had extdata subdirectory with
> example components that are larger than 1Mb - and upon a Google search
> that seems to be the case. Still, I wanted to seek your input!

There isn't a hard and fast rule.  If the data is necessary for the 
function of the package, then it will be allowed.  If it is not needed, 
then maybe not.  Often if the data is relatively stable but the code may 
be improved, you'll be asked to put them in separate packages, so that 
CRAN doesn't fill up with archived repetitions of the same data.

>
> 3) I am unfamiliar with what I should consider running compactPDF() on.
> None of the files are PDF files. The doc sub-directory has one .R file, and
> the extdata sub-directory has .R files, .png files (taking up the most
> space), and .txt files.
>

That message is likely talking about a vignette.  See the help page 
?compactPDF for how to invoke it during a build.

Duncan Murdoch


From luckbuttered at gmail.com  Mon Oct  3 07:03:33 2016
From: luckbuttered at gmail.com (Luck Buttered)
Date: Mon, 3 Oct 2016 00:03:33 -0500
Subject: [R-pkg-devel] .gitkeep file to prevent folder from erasing when
	empty
Message-ID: <CAGRPoRS-=hkerLArXRjKL7xnJa+meaYpui1qmgPQb6v09sZqZg@mail.gmail.com>

Hello everyone:

I am working on a vignette for a package that outputs reports for users. As
part of the vignette, users can manually run eval=FALSE code that creates
example reports. These example reports that they create can be saved to an
output folder within extdata (extdata/OutputFolder).

When I submit to CRAN, I will be sure that OutputFolder is empty. However,
whenever I make it empty, the entire folder disappears. To combat this
problem, I have placed a .gitkeep file within the OutputFolder.

I *believe* the presence of the .gitkeep file works as intended (prevents
the automatic removal of the OutputFolder when empty). However, upon
running check(), I receive a note:

*checking for hidden files and directories ... NOTE*
*Found the following hidden files and directories:*
*  inst/extdata/OutputFiles/.gitkeep*
*These were most likely included in error. See section ?Package*
*structure? in the ?Writing R Extensions? manual.*

Does anyone have advice on how to effectively remove this note? Otherwise,
does my rationale above seem like a reasonable purpose for keeping the note?

Thank you for helping me approach this!

	[[alternative HTML version deleted]]


From jranke at uni-bremen.de  Mon Oct  3 08:13:55 2016
From: jranke at uni-bremen.de (Johannes Ranke)
Date: Mon, 03 Oct 2016 08:13:55 +0200
Subject: [R-pkg-devel] .gitkeep file to prevent folder from erasing when
	empty
In-Reply-To: <CAGRPoRS-=hkerLArXRjKL7xnJa+meaYpui1qmgPQb6v09sZqZg@mail.gmail.com>
References: <CAGRPoRS-=hkerLArXRjKL7xnJa+meaYpui1qmgPQb6v09sZqZg@mail.gmail.com>
Message-ID: <2623821.lXO9V9e2jH@tux>

Hi,

You can include the .gitkeep file in .Rbuildignore. This will prevent it from 
being present in the package you test or submit, but git willl still see it 
and keep the directory.

Johannes

Am Montag, 3. Oktober 2016, 00:03:33 schrieb Luck Buttered:
> Hello everyone:
> 
> I am working on a vignette for a package that outputs reports for users. As
> part of the vignette, users can manually run eval=FALSE code that creates
> example reports. These example reports that they create can be saved to an
> output folder within extdata (extdata/OutputFolder).
> 
> When I submit to CRAN, I will be sure that OutputFolder is empty. However,
> whenever I make it empty, the entire folder disappears. To combat this
> problem, I have placed a .gitkeep file within the OutputFolder.
> 
> I *believe* the presence of the .gitkeep file works as intended (prevents
> the automatic removal of the OutputFolder when empty). However, upon
> running check(), I receive a note:
> 
> *checking for hidden files and directories ... NOTE*
> *Found the following hidden files and directories:*
> *  inst/extdata/OutputFiles/.gitkeep*
> *These were most likely included in error. See section ?Package*
> *structure? in the ?Writing R Extensions? manual.*
> 
> Does anyone have advice on how to effectively remove this note? Otherwise,
> does my rationale above seem like a reasonable purpose for keeping the note?
> 
> Thank you for helping me approach this!
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
-- 


From ligges at statistik.tu-dortmund.de  Mon Oct  3 09:25:16 2016
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 3 Oct 2016 09:25:16 +0200
Subject: [R-pkg-devel] .gitkeep file to prevent folder from erasing when
 empty
In-Reply-To: <2623821.lXO9V9e2jH@tux>
References: <CAGRPoRS-=hkerLArXRjKL7xnJa+meaYpui1qmgPQb6v09sZqZg@mail.gmail.com>
	<2623821.lXO9V9e2jH@tux>
Message-ID: <d1945da5-58fb-8062-8169-84c9d954bef0@statistik.tu-dortmund.de>



On 03.10.2016 08:13, Johannes Ranke wrote:
> Hi,
>
> You can include the .gitkeep file in .Rbuildignore. This will prevent it from
> being present in the package you test or submit, but git willl still see it
> and keep the directory.
>
> Johannes
>
> Am Montag, 3. Oktober 2016, 00:03:33 schrieb Luck Buttered:
>> Hello everyone:
>>
>> I am working on a vignette for a package that outputs reports for users. As
>> part of the vignette, users can manually run eval=FALSE code that creates
>> example reports. These example reports that they create can be saved to an
>> output folder within extdata (extdata/OutputFolder).


Note that this is a bad idea.
Your users may not have write access to that folder, e.g. for network 
wiede installation as the one at my department.
Also, you have to ask users (por let them enter a path or file) before 
writing somewhere on the filespace if not tempdir().

Best,
Uwe Ligges



>>
>> When I submit to CRAN, I will be sure that OutputFolder is empty. However,
>> whenever I make it empty, the entire folder disappears. To combat this
>> problem, I have placed a .gitkeep file within the OutputFolder.
>>
>> I *believe* the presence of the .gitkeep file works as intended (prevents
>> the automatic removal of the OutputFolder when empty). However, upon
>> running check(), I receive a note:
>>
>> *checking for hidden files and directories ... NOTE*
>> *Found the following hidden files and directories:*
>> *  inst/extdata/OutputFiles/.gitkeep*
>> *These were most likely included in error. See section ?Package*
>> *structure? in the ?Writing R Extensions? manual.*
>>
>> Does anyone have advice on how to effectively remove this note? Otherwise,
>> does my rationale above seem like a reasonable purpose for keeping the note?
>>
>> Thank you for helping me approach this!
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From luckbuttered at gmail.com  Mon Oct  3 15:15:49 2016
From: luckbuttered at gmail.com (Luck Buttered)
Date: Mon, 3 Oct 2016 08:15:49 -0500
Subject: [R-pkg-devel] .gitkeep file to prevent folder from erasing when
	empty
In-Reply-To: <d1945da5-58fb-8062-8169-84c9d954bef0@statistik.tu-dortmund.de>
References: <CAGRPoRS-=hkerLArXRjKL7xnJa+meaYpui1qmgPQb6v09sZqZg@mail.gmail.com>
	<2623821.lXO9V9e2jH@tux>
	<d1945da5-58fb-8062-8169-84c9d954bef0@statistik.tu-dortmund.de>
Message-ID: <CAGRPoRTEjvuoO8b1N2sbeZ+xDkMfw7WQ+u4Gs0zXxcjFBA4qYQ@mail.gmail.com>

Hello everyone:

Thank you for the helpful suggestions!

I moved the directory name to the .Rbuildignore file, as Johannes suggested.

Uwe, thanks for bringing up that topic! Yes, I read that we cannot
automatically write files to user's filespace (outside of tempdir()). So,
there is nothing in our package that will automatically write to user's
filespace. However, we do allow users to manually enter the suggested path
when going over examples in the vignette (which is the extdata/OutputFolder)
.

We did not think about if users cannot have write access to that folder.
However, that will not render the package useless for them. Instead, they
can manually enter an output folder pathway that works for them, and follow
the vignette examples that way. The presence of the extdata/OutputFolder is
just recommended for simplicity with following examples (and if write
available for users).

Thanks again!

On Mon, Oct 3, 2016 at 2:25 AM, Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

>
>
> On 03.10.2016 08:13, Johannes Ranke wrote:
>
>> Hi,
>>
>> You can include the .gitkeep file in .Rbuildignore. This will prevent it
>> from
>> being present in the package you test or submit, but git willl still see
>> it
>> and keep the directory.
>>
>> Johannes
>>
>> Am Montag, 3. Oktober 2016, 00:03:33 schrieb Luck Buttered:
>>
>>> Hello everyone:
>>>
>>> I am working on a vignette for a package that outputs reports for users.
>>> As
>>> part of the vignette, users can manually run eval=FALSE code that creates
>>> example reports. These example reports that they create can be saved to
>>> an
>>> output folder within extdata (extdata/OutputFolder).
>>>
>>
>
> Note that this is a bad idea.
> Your users may not have write access to that folder, e.g. for network
> wiede installation as the one at my department.
> Also, you have to ask users (por let them enter a path or file) before
> writing somewhere on the filespace if not tempdir().
>
> Best,
> Uwe Ligges
>
>
>
>
>
>>> When I submit to CRAN, I will be sure that OutputFolder is empty.
>>> However,
>>> whenever I make it empty, the entire folder disappears. To combat this
>>> problem, I have placed a .gitkeep file within the OutputFolder.
>>>
>>> I *believe* the presence of the .gitkeep file works as intended (prevents
>>> the automatic removal of the OutputFolder when empty). However, upon
>>> running check(), I receive a note:
>>>
>>> *checking for hidden files and directories ... NOTE*
>>> *Found the following hidden files and directories:*
>>> *  inst/extdata/OutputFiles/.gitkeep*
>>> *These were most likely included in error. See section ?Package*
>>> *structure? in the ?Writing R Extensions? manual.*
>>>
>>> Does anyone have advice on how to effectively remove this note?
>>> Otherwise,
>>> does my rationale above seem like a reasonable purpose for keeping the
>>> note?
>>>
>>> Thank you for helping me approach this!
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From roy.mendelssohn at noaa.gov  Mon Oct  3 19:10:13 2016
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Mon, 3 Oct 2016 10:10:13 -0700
Subject: [R-pkg-devel] Understanding notes from win-builder
Message-ID: <97D44E7A-B1A7-41B1-BA4B-66EA61FB3F52@noaa.gov>

Hi All:

I am working on preparing a package for submission to CRAN, so using devtools i submitted the package to win-builder.  I really appreciate that this has been setup, so that hopefully any final submission will be smooth.  win-builder returned three notes, and I am unclear on them in the sense of not certain what I should do to resolve them so hopefully there will  be no notes on submission.  The first one is:

> The Title field starts with the package name.
> The Title field should be in title case, current version then in title case:
> 'xtractomatic: An R package for accessing environmental data'
> 'Xtractomatic: An R Package for Accessing Environmental Data'
> 

the package name is "xtractomatic", but is the last line what is preferred in the DESCRIPTION file?

The other two notes are essentially the same:

> * checking examples ...
> ** running examples for arch 'i386' ... [87s] NOTE
> Examples with CPU or elapsed time > 10s
>            user system elapsed
> xtracto    3.29   0.81   36.49
> xtracto_3D 3.14   0.64   31.40
> xtractogon 0.92   0.20   10.73
> ** running examples for arch 'x64' ... [104s] NOTE
> Examples with CPU or elapsed time > 10s
>            user system elapsed
> xtracto    2.83   0.64   43.68
> xtracto_3D 2.58   0.72   43.60
> 

I assume the problem here is the amount of time to run the examples.  The problem is that what this package does is download data from a remote server, and times can vary a lot on the examples.  Is this a show stopper when I submit to CRAN?  I can try to simplify the examples to cut down on the time.  Alternatively, will it help to include this in the cram-comments.md file?

Any advice will be greatly appreciated.

-Roy

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new address and phone***
110 Shaffer Road
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From h.wickham at gmail.com  Mon Oct  3 19:22:42 2016
From: h.wickham at gmail.com (Hadley Wickham)
Date: Mon, 3 Oct 2016 12:22:42 -0500
Subject: [R-pkg-devel] Understanding notes from win-builder
In-Reply-To: <97D44E7A-B1A7-41B1-BA4B-66EA61FB3F52@noaa.gov>
References: <97D44E7A-B1A7-41B1-BA4B-66EA61FB3F52@noaa.gov>
Message-ID: <CABdHhvHJGVNZDsVTtXqCRKJ3sSai4i7qiTFT6PbQuQLwmBBmxw@mail.gmail.com>

On Mon, Oct 3, 2016 at 12:10 PM, Roy Mendelssohn - NOAA Federal
<roy.mendelssohn at noaa.gov> wrote:
> Hi All:
>
> I am working on preparing a package for submission to CRAN, so using devtools i submitted the package to win-builder.  I really appreciate that this has been setup, so that hopefully any final submission will be smooth.  win-builder returned three notes, and I am unclear on them in the sense of not certain what I should do to resolve them so hopefully there will  be no notes on submission.  The first one is:
>
>> The Title field starts with the package name.
>> The Title field should be in title case, current version then in title case:
>> 'xtractomatic: An R package for accessing environmental data'
>> 'Xtractomatic: An R Package for Accessing Environmental Data'
>>
>
> the package name is "xtractomatic", but is the last line what is preferred in the DESCRIPTION file?

On CRAN (and in other locations), packages are listed as
"package_name: package_title", which in your case would lead to:

xtractomatic: xtractomatic: An R package for accessing environmental data

So you need to first eliminate "xtractomatic" from the title.  CRAN
generally also considers "an R package" to be obvious from the context
so you also need to remove that. That leaves you with "Accessing
Environmental Data" and suggests you might want to be a bit more
specific.

> The other two notes are essentially the same:
>
>> * checking examples ...
>> ** running examples for arch 'i386' ... [87s] NOTE
>> Examples with CPU or elapsed time > 10s
>>            user system elapsed
>> xtracto    3.29   0.81   36.49
>> xtracto_3D 3.14   0.64   31.40
>> xtractogon 0.92   0.20   10.73
>> ** running examples for arch 'x64' ... [104s] NOTE
>> Examples with CPU or elapsed time > 10s
>>            user system elapsed
>> xtracto    2.83   0.64   43.68
>> xtracto_3D 2.58   0.72   43.60
>>
>
> I assume the problem here is the amount of time to run the examples.  The problem is that what this package does is download data from a remote server, and times can vary a lot on the examples.  Is this a show stopper when I submit to CRAN?  I can try to simplify the examples to cut down on the time.  Alternatively, will it help to include this in the cram-comments.md file?

You can use \donttest{} to tell CRAN to not run it as part of their
automated tests.

Hadley

-- 
http://hadley.nz


From roy.mendelssohn at noaa.gov  Mon Oct  3 19:44:20 2016
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Mon, 3 Oct 2016 10:44:20 -0700
Subject: [R-pkg-devel] Understanding notes from win-builder
In-Reply-To: <CABdHhvHJGVNZDsVTtXqCRKJ3sSai4i7qiTFT6PbQuQLwmBBmxw@mail.gmail.com>
References: <97D44E7A-B1A7-41B1-BA4B-66EA61FB3F52@noaa.gov>
	<CABdHhvHJGVNZDsVTtXqCRKJ3sSai4i7qiTFT6PbQuQLwmBBmxw@mail.gmail.com>
Message-ID: <8B09A138-2A22-4803-9273-BF34BB80E688@noaa.gov>

Hi Hadley:

> You can use \donttest{} to tell CRAN to not run it as part of their
> automated tests.
> 
> Hadley
> 

Thank you for the responses.  On the response above,  \donttest{} goes where?  Is that in each R files where I have an example, or somewhere else?

-Roy

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new address and phone***
110 Shaffer Road
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From brian at braverock.com  Mon Oct  3 19:48:00 2016
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 03 Oct 2016 12:48:00 -0500
Subject: [R-pkg-devel] Understanding notes from win-builder
In-Reply-To: <8B09A138-2A22-4803-9273-BF34BB80E688@noaa.gov>
References: <97D44E7A-B1A7-41B1-BA4B-66EA61FB3F52@noaa.gov>
	<CABdHhvHJGVNZDsVTtXqCRKJ3sSai4i7qiTFT6PbQuQLwmBBmxw@mail.gmail.com>
	<8B09A138-2A22-4803-9273-BF34BB80E688@noaa.gov>
Message-ID: <1475516880.14041.241.camel@brian-rcg>

In your examples section, do something like this:

\donttest{

   Sys.sleep(100) # long running example code here

}


-- 
Brian 

On Mon, 2016-10-03 at 10:44 -0700, Roy Mendelssohn - NOAA Federal wrote:
> Hi Hadley:
> 
> > You can use \donttest{} to tell CRAN to not run it as part of their
> > automated tests.
> > 
> > Hadley
> > 
> 
> Thank you for the responses.  On the response above,  \donttest{} goes where?  Is that in each R files where I have an example, or somewhere else?
> 
> -Roy
> 
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new address and phone***
> 110 Shaffer Road
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
> 
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected" 
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From roy.mendelssohn at noaa.gov  Mon Oct  3 19:56:39 2016
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Mon, 3 Oct 2016 10:56:39 -0700
Subject: [R-pkg-devel] Understanding notes from win-builder
In-Reply-To: <1475516880.14041.241.camel@brian-rcg>
References: <97D44E7A-B1A7-41B1-BA4B-66EA61FB3F52@noaa.gov>
	<CABdHhvHJGVNZDsVTtXqCRKJ3sSai4i7qiTFT6PbQuQLwmBBmxw@mail.gmail.com>
	<8B09A138-2A22-4803-9273-BF34BB80E688@noaa.gov>
	<1475516880.14041.241.camel@brian-rcg>
Message-ID: <339B4CFA-BB69-4989-A9E1-C36D9148A223@noaa.gov>

Thanks muchly!

-Roy

> On Oct 3, 2016, at 10:48 AM, Brian G. Peterson <brian at braverock.com> wrote:
> 
> In your examples section, do something like this:
> 
> \donttest{
> 
>   Sys.sleep(100) # long running example code here
> 
> }
> 
> 
> -- 
> Brian 
> 
> On Mon, 2016-10-03 at 10:44 -0700, Roy Mendelssohn - NOAA Federal wrote:
>> Hi Hadley:
>> 
>>> You can use \donttest{} to tell CRAN to not run it as part of their
>>> automated tests.
>>> 
>>> Hadley
>>> 
>> 
>> Thank you for the responses.  On the response above,  \donttest{} goes where?  Is that in each R files where I have an example, or somewhere else?
>> 
>> -Roy
>> 
>> **********************
>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>> **********************
>> Roy Mendelssohn
>> Supervisory Operations Research Analyst
>> NOAA/NMFS
>> Environmental Research Division
>> Southwest Fisheries Science Center
>> ***Note new address and phone***
>> 110 Shaffer Road
>> Santa Cruz, CA 95060
>> Phone: (831)-420-3666
>> Fax: (831) 420-3980
>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>> 
>> "Old age and treachery will overcome youth and skill."
>> "From those who have been given much, much will be expected" 
>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new address and phone***
110 Shaffer Road
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From murdoch.duncan at gmail.com  Mon Oct  3 20:56:31 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 3 Oct 2016 14:56:31 -0400
Subject: [R-pkg-devel] Understanding notes from win-builder
In-Reply-To: <CABdHhvHJGVNZDsVTtXqCRKJ3sSai4i7qiTFT6PbQuQLwmBBmxw@mail.gmail.com>
References: <97D44E7A-B1A7-41B1-BA4B-66EA61FB3F52@noaa.gov>
	<CABdHhvHJGVNZDsVTtXqCRKJ3sSai4i7qiTFT6PbQuQLwmBBmxw@mail.gmail.com>
Message-ID: <1e3a82cf-18d4-bae7-b1ed-7826bd36adc8@gmail.com>

On 03/10/2016 1:22 PM, Hadley Wickham wrote:
> On Mon, Oct 3, 2016 at 12:10 PM, Roy Mendelssohn - NOAA Federal
> <roy.mendelssohn at noaa.gov> wrote:
> > Hi All:
> >
> > I am working on preparing a package for submission to CRAN, so using devtools i submitted the package to win-builder.  I really appreciate that this has been setup, so that hopefully any final submission will be smooth.  win-builder returned three notes, and I am unclear on them in the sense of not certain what I should do to resolve them so hopefully there will  be no notes on submission.  The first one is:
> >
> >> The Title field starts with the package name.
> >> The Title field should be in title case, current version then in title case:
> >> 'xtractomatic: An R package for accessing environmental data'
> >> 'Xtractomatic: An R Package for Accessing Environmental Data'
> >>
> >
> > the package name is "xtractomatic", but is the last line what is preferred in the DESCRIPTION file?
>
> On CRAN (and in other locations), packages are listed as
> "package_name: package_title", which in your case would lead to:
>
> xtractomatic: xtractomatic: An R package for accessing environmental data
>
> So you need to first eliminate "xtractomatic" from the title.  CRAN
> generally also considers "an R package" to be obvious from the context
> so you also need to remove that. That leaves you with "Accessing
> Environmental Data" and suggests you might want to be a bit more
> specific.
>
> > The other two notes are essentially the same:
> >
> >> * checking examples ...
> >> ** running examples for arch 'i386' ... [87s] NOTE
> >> Examples with CPU or elapsed time > 10s
> >>            user system elapsed
> >> xtracto    3.29   0.81   36.49
> >> xtracto_3D 3.14   0.64   31.40
> >> xtractogon 0.92   0.20   10.73
> >> ** running examples for arch 'x64' ... [104s] NOTE
> >> Examples with CPU or elapsed time > 10s
> >>            user system elapsed
> >> xtracto    2.83   0.64   43.68
> >> xtracto_3D 2.58   0.72   43.60
> >>
> >
> > I assume the problem here is the amount of time to run the examples.  The problem is that what this package does is download data from a remote server, and times can vary a lot on the examples.  Is this a show stopper when I submit to CRAN?  I can try to simplify the examples to cut down on the time.  Alternatively, will it help to include this in the cram-comments.md file?
>
> You can use \donttest{} to tell CRAN to not run it as part of their
> automated tests.

But do leave in some tests, so the code that actually does something 
with the data gets exercised, and users who may not have Internet access 
when they look at your examples can see something.

Duncan Murdoch


From roy.mendelssohn at noaa.gov  Mon Oct  3 21:04:36 2016
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Mon, 3 Oct 2016 12:04:36 -0700
Subject: [R-pkg-devel] Understanding notes from win-builder
In-Reply-To: <1e3a82cf-18d4-bae7-b1ed-7826bd36adc8@gmail.com>
References: <97D44E7A-B1A7-41B1-BA4B-66EA61FB3F52@noaa.gov>
	<CABdHhvHJGVNZDsVTtXqCRKJ3sSai4i7qiTFT6PbQuQLwmBBmxw@mail.gmail.com>
	<1e3a82cf-18d4-bae7-b1ed-7826bd36adc8@gmail.com>
Message-ID: <9F295432-BC88-48F6-A33B-EC073B5FB0C1@noaa.gov>

Thanks.  The tests were not taking extraordinary amounts of time  (roughly 30-40s) but they were greater than 10s.  I retested with all the tests commented to be not tested, but based on this I have changed it so there is one simple test for each, and will see what those times are.  I will add those in my cran-comments and see what  comes of it.  When I check internally, there are no problems,  as the downloads are much faster, and varies depending on where I do the testing.

-Roy

> On Oct 3, 2016, at 11:56 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 03/10/2016 1:22 PM, Hadley Wickham wrote:
>> On Mon, Oct 3, 2016 at 12:10 PM, Roy Mendelssohn - NOAA Federal
>> <roy.mendelssohn at noaa.gov> wrote:
>> > Hi All:
>> >
>> > I am working on preparing a package for submission to CRAN, so using devtools i submitted the package to win-builder.  I really appreciate that this has been setup, so that hopefully any final submission will be smooth.  win-builder returned three notes, and I am unclear on them in the sense of not certain what I should do to resolve them so hopefully there will  be no notes on submission.  The first one is:
>> >
>> >> The Title field starts with the package name.
>> >> The Title field should be in title case, current version then in title case:
>> >> 'xtractomatic: An R package for accessing environmental data'
>> >> 'Xtractomatic: An R Package for Accessing Environmental Data'
>> >>
>> >
>> > the package name is "xtractomatic", but is the last line what is preferred in the DESCRIPTION file?
>> 
>> On CRAN (and in other locations), packages are listed as
>> "package_name: package_title", which in your case would lead to:
>> 
>> xtractomatic: xtractomatic: An R package for accessing environmental data
>> 
>> So you need to first eliminate "xtractomatic" from the title.  CRAN
>> generally also considers "an R package" to be obvious from the context
>> so you also need to remove that. That leaves you with "Accessing
>> Environmental Data" and suggests you might want to be a bit more
>> specific.
>> 
>> > The other two notes are essentially the same:
>> >
>> >> * checking examples ...
>> >> ** running examples for arch 'i386' ... [87s] NOTE
>> >> Examples with CPU or elapsed time > 10s
>> >>            user system elapsed
>> >> xtracto    3.29   0.81   36.49
>> >> xtracto_3D 3.14   0.64   31.40
>> >> xtractogon 0.92   0.20   10.73
>> >> ** running examples for arch 'x64' ... [104s] NOTE
>> >> Examples with CPU or elapsed time > 10s
>> >>            user system elapsed
>> >> xtracto    2.83   0.64   43.68
>> >> xtracto_3D 2.58   0.72   43.60
>> >>
>> >
>> > I assume the problem here is the amount of time to run the examples.  The problem is that what this package does is download data from a remote server, and times can vary a lot on the examples.  Is this a show stopper when I submit to CRAN?  I can try to simplify the examples to cut down on the time.  Alternatively, will it help to include this in the cram-comments.md file?
>> 
>> You can use \donttest{} to tell CRAN to not run it as part of their
>> automated tests.
> 
> But do leave in some tests, so the code that actually does something with the data gets exercised, and users who may not have Internet access when they look at your examples can see something.
> 
> Duncan Murdoch

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new address and phone***
110 Shaffer Road
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From murdoch.duncan at gmail.com  Mon Oct  3 21:40:42 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 3 Oct 2016 15:40:42 -0400
Subject: [R-pkg-devel] Understanding notes from win-builder
In-Reply-To: <9F295432-BC88-48F6-A33B-EC073B5FB0C1@noaa.gov>
References: <97D44E7A-B1A7-41B1-BA4B-66EA61FB3F52@noaa.gov>
	<CABdHhvHJGVNZDsVTtXqCRKJ3sSai4i7qiTFT6PbQuQLwmBBmxw@mail.gmail.com>
	<1e3a82cf-18d4-bae7-b1ed-7826bd36adc8@gmail.com>
	<9F295432-BC88-48F6-A33B-EC073B5FB0C1@noaa.gov>
Message-ID: <6cf97cd1-f159-8216-414a-39653e56d4c7@gmail.com>

On 03/10/2016 3:04 PM, Roy Mendelssohn - NOAA Federal wrote:
> Thanks.  The tests were not taking extraordinary amounts of time  (roughly 30-40s) but they were greater than 10s.  I retested with all the tests commented to be not tested, but based on this I have changed it so there is one simple test for each, and will see what those times are.  I will add those in my cran-comments and see what  comes of it.  When I check internally, there are no problems,  as the downloads are much faster, and varies depending on where I do the testing.

A possibility would be to include a small number of sample pages with 
your package, and offer a way to view them in a browser, or run your 
functions on them.  The system.file() function will give the installed 
location of those files.

For example, if you put sample.html in your package in directory 
inst/SamplePages, it will be installed into 
<pkg>/SamplePages/sample.html in your library, and can be browsed using

   browseURL(system.file("SamplePages/sample.html", package = "<pkg>"))

(with appropriate substitutions for <pkg>, of course).  You probably 
don't want to call browseURL() in a test, but you can
use

if (interactive()) browseURL( ... )

Duncan Murdoch

>
> -Roy
>
> > On Oct 3, 2016, at 11:56 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> >
> > On 03/10/2016 1:22 PM, Hadley Wickham wrote:
> >> On Mon, Oct 3, 2016 at 12:10 PM, Roy Mendelssohn - NOAA Federal
> >> <roy.mendelssohn at noaa.gov> wrote:
> >> > Hi All:
> >> >
> >> > I am working on preparing a package for submission to CRAN, so using devtools i submitted the package to win-builder.  I really appreciate that this has been setup, so that hopefully any final submission will be smooth.  win-builder returned three notes, and I am unclear on them in the sense of not certain what I should do to resolve them so hopefully there will  be no notes on submission.  The first one is:
> >> >
> >> >> The Title field starts with the package name.
> >> >> The Title field should be in title case, current version then in title case:
> >> >> 'xtractomatic: An R package for accessing environmental data'
> >> >> 'Xtractomatic: An R Package for Accessing Environmental Data'
> >> >>
> >> >
> >> > the package name is "xtractomatic", but is the last line what is preferred in the DESCRIPTION file?
> >>
> >> On CRAN (and in other locations), packages are listed as
> >> "package_name: package_title", which in your case would lead to:
> >>
> >> xtractomatic: xtractomatic: An R package for accessing environmental data
> >>
> >> So you need to first eliminate "xtractomatic" from the title.  CRAN
> >> generally also considers "an R package" to be obvious from the context
> >> so you also need to remove that. That leaves you with "Accessing
> >> Environmental Data" and suggests you might want to be a bit more
> >> specific.
> >>
> >> > The other two notes are essentially the same:
> >> >
> >> >> * checking examples ...
> >> >> ** running examples for arch 'i386' ... [87s] NOTE
> >> >> Examples with CPU or elapsed time > 10s
> >> >>            user system elapsed
> >> >> xtracto    3.29   0.81   36.49
> >> >> xtracto_3D 3.14   0.64   31.40
> >> >> xtractogon 0.92   0.20   10.73
> >> >> ** running examples for arch 'x64' ... [104s] NOTE
> >> >> Examples with CPU or elapsed time > 10s
> >> >>            user system elapsed
> >> >> xtracto    2.83   0.64   43.68
> >> >> xtracto_3D 2.58   0.72   43.60
> >> >>
> >> >
> >> > I assume the problem here is the amount of time to run the examples.  The problem is that what this package does is download data from a remote server, and times can vary a lot on the examples.  Is this a show stopper when I submit to CRAN?  I can try to simplify the examples to cut down on the time.  Alternatively, will it help to include this in the cram-comments.md file?
> >>
> >> You can use \donttest{} to tell CRAN to not run it as part of their
> >> automated tests.
> >
> > But do leave in some tests, so the code that actually does something with the data gets exercised, and users who may not have Internet access when they look at your examples can see something.
> >
> > Duncan Murdoch
>
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new address and phone***
> 110 Shaffer Road
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>


From luckbuttered at gmail.com  Tue Oct  4 01:58:45 2016
From: luckbuttered at gmail.com (Luck Buttered)
Date: Mon, 3 Oct 2016 18:58:45 -0500
Subject: [R-pkg-devel] .gitkeep file to prevent folder from erasing when
	empty
In-Reply-To: <CAGRPoRTEjvuoO8b1N2sbeZ+xDkMfw7WQ+u4Gs0zXxcjFBA4qYQ@mail.gmail.com>
References: <CAGRPoRS-=hkerLArXRjKL7xnJa+meaYpui1qmgPQb6v09sZqZg@mail.gmail.com>
	<2623821.lXO9V9e2jH@tux>
	<d1945da5-58fb-8062-8169-84c9d954bef0@statistik.tu-dortmund.de>
	<CAGRPoRTEjvuoO8b1N2sbeZ+xDkMfw7WQ+u4Gs0zXxcjFBA4qYQ@mail.gmail.com>
Message-ID: <CAGRPoRSszU-82-_nOH+J_F=ALEA+3SKyAW+dbyHrJR3Bvup4xA@mail.gmail.com>

Hello everyone:

Inside .Rbuildignore, I put the following line:

^OutputFolder$

However, I notice that the extdata/OutputFolder still disappears if there
are no files inside of it. (I am thinking this happens when I push changes
to Github). I am trying to keep the extdata/OutputFolder present (whether
or not it has files inside of it) for both github and when I submit the
package.

Thanks again for any input you may have!




On Mon, Oct 3, 2016 at 8:15 AM, Luck Buttered <luckbuttered at gmail.com>
wrote:

> Hello everyone:
>
> Thank you for the helpful suggestions!
>
> I moved the directory name to the .Rbuildignore file, as Johannes
> suggested.
>
> Uwe, thanks for bringing up that topic! Yes, I read that we cannot
> automatically write files to user's filespace (outside of tempdir()). So,
> there is nothing in our package that will automatically write to user's
> filespace. However, we do allow users to manually enter the suggested path
> when going over examples in the vignette (which is the
> extdata/OutputFolder).
>
> We did not think about if users cannot have write access to that folder.
> However, that will not render the package useless for them. Instead, they
> can manually enter an output folder pathway that works for them, and follow
> the vignette examples that way. The presence of the extdata/OutputFolder
> is just recommended for simplicity with following examples (and if write
> available for users).
>
> Thanks again!
>
> On Mon, Oct 3, 2016 at 2:25 AM, Uwe Ligges <ligges at statistik.tu-dortmund.
> de> wrote:
>
>>
>>
>> On 03.10.2016 08:13, Johannes Ranke wrote:
>>
>>> Hi,
>>>
>>> You can include the .gitkeep file in .Rbuildignore. This will prevent it
>>> from
>>> being present in the package you test or submit, but git willl still see
>>> it
>>> and keep the directory.
>>>
>>> Johannes
>>>
>>> Am Montag, 3. Oktober 2016, 00:03:33 schrieb Luck Buttered:
>>>
>>>> Hello everyone:
>>>>
>>>> I am working on a vignette for a package that outputs reports for
>>>> users. As
>>>> part of the vignette, users can manually run eval=FALSE code that
>>>> creates
>>>> example reports. These example reports that they create can be saved to
>>>> an
>>>> output folder within extdata (extdata/OutputFolder).
>>>>
>>>
>>
>> Note that this is a bad idea.
>> Your users may not have write access to that folder, e.g. for network
>> wiede installation as the one at my department.
>> Also, you have to ask users (por let them enter a path or file) before
>> writing somewhere on the filespace if not tempdir().
>>
>> Best,
>> Uwe Ligges
>>
>>
>>
>>
>>
>>>> When I submit to CRAN, I will be sure that OutputFolder is empty.
>>>> However,
>>>> whenever I make it empty, the entire folder disappears. To combat this
>>>> problem, I have placed a .gitkeep file within the OutputFolder.
>>>>
>>>> I *believe* the presence of the .gitkeep file works as intended
>>>> (prevents
>>>> the automatic removal of the OutputFolder when empty). However, upon
>>>> running check(), I receive a note:
>>>>
>>>> *checking for hidden files and directories ... NOTE*
>>>> *Found the following hidden files and directories:*
>>>> *  inst/extdata/OutputFiles/.gitkeep*
>>>> *These were most likely included in error. See section ?Package*
>>>> *structure? in the ?Writing R Extensions? manual.*
>>>>
>>>> Does anyone have advice on how to effectively remove this note?
>>>> Otherwise,
>>>> does my rationale above seem like a reasonable purpose for keeping the
>>>> note?
>>>>
>>>> Thank you for helping me approach this!
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
>

	[[alternative HTML version deleted]]


From luckbuttered at gmail.com  Tue Oct  4 03:02:44 2016
From: luckbuttered at gmail.com (Luck Buttered)
Date: Mon, 3 Oct 2016 20:02:44 -0500
Subject: [R-pkg-devel] Note and warning about subdirectory sizes
In-Reply-To: <c2d79008-60bc-7ffc-b1a5-881a9e744343@gmail.com>
References: <CABrdRMQvemSwOUBjy-YVDtWCCKNuqazufxh25_zdj-2MTheG1Q@mail.gmail.com>
	<c2d79008-60bc-7ffc-b1a5-881a9e744343@gmail.com>
Message-ID: <CAGRPoRSMh7=4eP5g7D7xJV68J7gHyPeH00E-D+JeLNYo7KBM3Q@mail.gmail.com>

Hi all,

Thank you for your help.  The only original question I am still a bit
stuck on is #3.  I read a lot about the command today, and tried
several approaches, but am unsure how to remove that warning.

* checking sizes of PDF files under ?inst/doc? ... WARNING
  ?gs+qpdf? made some significant size reductions:
     compacted ?ePort.pdf? from 1655Kb to 1076Kb
  consider running tools::compactPDF(gs_quality = "ebook") on these files


I work on a Mac with both RStudio and terminal (can do either).  In
either RStudio or terminal, I could run the command:

compactPDF("inst/doc", qpdf = Sys.which(Sys.getenv("R_QPDF", "qpdf")),
gs_quality = "ebook")

I would not get any output from that. And when I then run:

check()

I noticed the WARNING was still there.

I also ran:

R CMD build --compact-vignettes=gs

But then when I ran check(), I still noticed the WARNING.

I also ran:

build(compact-vignettes("gs+qpdf"))

which gave me the error:

Error in inherits(x, "package") : object 'compact' not found


I tried a few other syntax I found online, but they mostly gave me warnings.

So, what I would love for any advice/input on, is what I can do to
remove that WARNING (if I must)? I am not sure if I am running
commands incorrectly, running in the wrong folder, should be using
command/Rstudio, etc. Even reading advice online and looking at the
documentation of build and compactPDF is not solving this for me (and
it may be due to my inexperience with R and terminal).

Thanks again for any help!!!

On Sun, Oct 2, 2016 at 3:43 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> On 02/10/2016 4:05 PM, S johnson wrote:
>>
>> Hi all,
>>
>> I am running check() on an R package, and receive one note and one warning
>> (seem to be related):
>>
>> * checking installed package size ... NOTE
>>   installed size is 25.9Mb
>>   sub-directories of 1Mb or more:
>>
>>     doc       3.4Mb
>>     extdata  22.1Mb
>>
>> * checking sizes of PDF files under ?inst/doc? ... WARNING
>>   ?gs+qpdf? made some significant size reductions:
>>      compacted ?ePort.pdf? from 1655Kb to 1076Kb
>>   consider running tools::compactPDF(gs_quality = "ebook") on these files
>>
>> After pondering this note, I have three brief questions as follows,
>>
>> 1) When I run "du -hs" on the doc sub-directory, it lists its size as
>> only 10K. There is only one file inside the doc sub-directory, and
>> similarly, when I run "du -hs" on that one file, it lists its size as
>> only 10K. I wonder, then, why check() reports that this sub-directory
>> called doc is 3.4 Mb?
>
>
> You are probably looking at the package source; the measurements are made
> after installation.  At that point the vignettes have been copied into the
> doc directory.
>
>>
>> 2) My extdata sub-directory is rather large. It is certainly over 1Mb.
>> This is due to a few dozen example images (.png files) that we feel is
>> important to include in the package. In general, do notes like these
>> prevent
>> CRAN submission acceptance? If so, what would be an alternative? I
>> imagine there were other packages that had extdata subdirectory with
>> example components that are larger than 1Mb - and upon a Google search
>> that seems to be the case. Still, I wanted to seek your input!
>
>
> There isn't a hard and fast rule.  If the data is necessary for the function
> of the package, then it will be allowed.  If it is not needed, then maybe
> not.  Often if the data is relatively stable but the code may be improved,
> you'll be asked to put them in separate packages, so that CRAN doesn't fill
> up with archived repetitions of the same data.
>
>>
>> 3) I am unfamiliar with what I should consider running compactPDF() on.
>> None of the files are PDF files. The doc sub-directory has one .R file,
>> and
>> the extdata sub-directory has .R files, .png files (taking up the most
>> space), and .txt files.
>>
>
> That message is likely talking about a vignette.  See the help page
> ?compactPDF for how to invoke it during a build.
>
> Duncan Murdoch
>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From nilsson.henric at gmail.com  Tue Oct  4 08:48:50 2016
From: nilsson.henric at gmail.com (Henric Winell)
Date: Tue, 4 Oct 2016 08:48:50 +0200
Subject: [R-pkg-devel] Note and warning about subdirectory sizes
In-Reply-To: <CAGRPoRSMh7=4eP5g7D7xJV68J7gHyPeH00E-D+JeLNYo7KBM3Q@mail.gmail.com>
References: <CABrdRMQvemSwOUBjy-YVDtWCCKNuqazufxh25_zdj-2MTheG1Q@mail.gmail.com>
	<c2d79008-60bc-7ffc-b1a5-881a9e744343@gmail.com>
	<CAGRPoRSMh7=4eP5g7D7xJV68J7gHyPeH00E-D+JeLNYo7KBM3Q@mail.gmail.com>
Message-ID: <157559c4-1971-84cc-8579-961bf147a00f@gmail.com>

Den 2016-10-04 kl. 03:02, skrev Luck Buttered:

> Hi all,
>
> Thank you for your help.  The only original question I am still a bit
> stuck on is #3.  I read a lot about the command today, and tried
> several approaches, but am unsure how to remove that warning.
>
> * checking sizes of PDF files under ?inst/doc? ... WARNING
>   ?gs+qpdf? made some significant size reductions:
>      compacted ?ePort.pdf? from 1655Kb to 1076Kb
>   consider running tools::compactPDF(gs_quality = "ebook") on these files
>
>
> I work on a Mac with both RStudio and terminal (can do either).  In
> either RStudio or terminal, I could run the command:
>
> compactPDF("inst/doc", qpdf = Sys.which(Sys.getenv("R_QPDF", "qpdf")),
> gs_quality = "ebook")
>
> I would not get any output from that. And when I then run:
>
> check()
>
> I noticed the WARNING was still there.
>
> I also ran:
>
> R CMD build --compact-vignettes=gs

What was the output of that command?

Note that using '--compact-vignettes=gs+qpdf', as suggested by the 
warning message, typically results in even better compression.

> But then when I ran check(), I still noticed the WARNING.

Assuming that this is devtools::check(), which I'm unfamiliar with, a 
quick glance at its man page suggests that it checks (and builds) your 
*source* file.  But the compacted pdfs are in the newly built tarball 
that resulted from running 'R CMD build', so I think you want 
devtools::check_built()?  Alternatively, It seems to me that you can use 
devtools::check() and pass on the compacting command through the 
'build_args' argument.


Henric Winell



>
> I also ran:
>
> build(compact-vignettes("gs+qpdf"))
>
> which gave me the error:
>
> Error in inherits(x, "package") : object 'compact' not found
>
>
> I tried a few other syntax I found online, but they mostly gave me warnings.
>
> So, what I would love for any advice/input on, is what I can do to
> remove that WARNING (if I must)? I am not sure if I am running
> commands incorrectly, running in the wrong folder, should be using
> command/Rstudio, etc. Even reading advice online and looking at the
> documentation of build and compactPDF is not solving this for me (and
> it may be due to my inexperience with R and terminal).
>
> Thanks again for any help!!!
>
> On Sun, Oct 2, 2016 at 3:43 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>> On 02/10/2016 4:05 PM, S johnson wrote:
>>>
>>> Hi all,
>>>
>>> I am running check() on an R package, and receive one note and one warning
>>> (seem to be related):
>>>
>>> * checking installed package size ... NOTE
>>>   installed size is 25.9Mb
>>>   sub-directories of 1Mb or more:
>>>
>>>     doc       3.4Mb
>>>     extdata  22.1Mb
>>>
>>> * checking sizes of PDF files under ?inst/doc? ... WARNING
>>>   ?gs+qpdf? made some significant size reductions:
>>>      compacted ?ePort.pdf? from 1655Kb to 1076Kb
>>>   consider running tools::compactPDF(gs_quality = "ebook") on these files
>>>
>>> After pondering this note, I have three brief questions as follows,
>>>
>>> 1) When I run "du -hs" on the doc sub-directory, it lists its size as
>>> only 10K. There is only one file inside the doc sub-directory, and
>>> similarly, when I run "du -hs" on that one file, it lists its size as
>>> only 10K. I wonder, then, why check() reports that this sub-directory
>>> called doc is 3.4 Mb?
>>
>>
>> You are probably looking at the package source; the measurements are made
>> after installation.  At that point the vignettes have been copied into the
>> doc directory.
>>
>>>
>>> 2) My extdata sub-directory is rather large. It is certainly over 1Mb.
>>> This is due to a few dozen example images (.png files) that we feel is
>>> important to include in the package. In general, do notes like these
>>> prevent
>>> CRAN submission acceptance? If so, what would be an alternative? I
>>> imagine there were other packages that had extdata subdirectory with
>>> example components that are larger than 1Mb - and upon a Google search
>>> that seems to be the case. Still, I wanted to seek your input!
>>
>>
>> There isn't a hard and fast rule.  If the data is necessary for the function
>> of the package, then it will be allowed.  If it is not needed, then maybe
>> not.  Often if the data is relatively stable but the code may be improved,
>> you'll be asked to put them in separate packages, so that CRAN doesn't fill
>> up with archived repetitions of the same data.
>>
>>>
>>> 3) I am unfamiliar with what I should consider running compactPDF() on.
>>> None of the files are PDF files. The doc sub-directory has one .R file,
>>> and
>>> the extdata sub-directory has .R files, .png files (taking up the most
>>> space), and .txt files.
>>>
>>
>> That message is likely talking about a vignette.  See the help page
>> ?compactPDF for how to invoke it during a build.
>>
>> Duncan Murdoch
>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From ligges at statistik.tu-dortmund.de  Tue Oct  4 13:09:15 2016
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 4 Oct 2016 13:09:15 +0200
Subject: [R-pkg-devel] .gitkeep file to prevent folder from erasing when
 empty
In-Reply-To: <CAGRPoRSszU-82-_nOH+J_F=ALEA+3SKyAW+dbyHrJR3Bvup4xA@mail.gmail.com>
References: <CAGRPoRS-=hkerLArXRjKL7xnJa+meaYpui1qmgPQb6v09sZqZg@mail.gmail.com>
	<2623821.lXO9V9e2jH@tux>
	<d1945da5-58fb-8062-8169-84c9d954bef0@statistik.tu-dortmund.de>
	<CAGRPoRTEjvuoO8b1N2sbeZ+xDkMfw7WQ+u4Gs0zXxcjFBA4qYQ@mail.gmail.com>
	<CAGRPoRSszU-82-_nOH+J_F=ALEA+3SKyAW+dbyHrJR3Bvup4xA@mail.gmail.com>
Message-ID: <0558501e-b3fc-f555-82b4-aedb80f5ab2e@statistik.tu-dortmund.de>



On 04.10.2016 01:58, Luck Buttered wrote:
> Hello everyone:
>
> Inside .Rbuildignore, I put the following line:
>
> ^OutputFolder$


Then indicate that you just want to ignore files within OutputFolder.

Best,
Uwe Ligges






> However, I notice that the extdata/OutputFolder still disappears if
> there are no files inside of it. (I am thinking this happens when I push
> changes to Github). I am trying to keep the extdata/OutputFolder present
> (whether or not it has files inside of it) for both github and when I
> submit the package.
>
> Thanks again for any input you may have!
>
>
>
>
> On Mon, Oct 3, 2016 at 8:15 AM, Luck Buttered <luckbuttered at gmail.com
> <mailto:luckbuttered at gmail.com>> wrote:
>
>     Hello everyone:
>
>     Thank you for the helpful suggestions!
>
>     I moved the directory name to the .Rbuildignore file, as Johannes
>     suggested.
>
>     Uwe, thanks for bringing up that topic! Yes, I read that we cannot
>     automatically write files to user's filespace (outside of
>     tempdir()). So, there is nothing in our package that will
>     automatically write to user's filespace. However, we do allow users
>     to manually enter the suggested path when going over examples in the
>     vignette (which is the extdata/OutputFolder).
>
>     We did not think about if users cannot have write access to that
>     folder. However, that will not render the package useless for them.
>     Instead, they can manually enter an output folder pathway that works
>     for them, and follow the vignette examples that way. The presence of
>     the extdata/OutputFolder is just recommended for simplicity with
>     following examples (and if write available for users).
>
>     Thanks again!
>
>     On Mon, Oct 3, 2016 at 2:25 AM, Uwe Ligges
>     <ligges at statistik.tu-dortmund.de
>     <mailto:ligges at statistik.tu-dortmund.de>> wrote:
>
>
>
>         On 03.10.2016 08:13, Johannes Ranke wrote:
>
>             Hi,
>
>             You can include the .gitkeep file in .Rbuildignore. This
>             will prevent it from
>             being present in the package you test or submit, but git
>             willl still see it
>             and keep the directory.
>
>             Johannes
>
>             Am Montag, 3. Oktober 2016, 00:03:33 schrieb Luck Buttered:
>
>                 Hello everyone:
>
>                 I am working on a vignette for a package that outputs
>                 reports for users. As
>                 part of the vignette, users can manually run eval=FALSE
>                 code that creates
>                 example reports. These example reports that they create
>                 can be saved to an
>                 output folder within extdata (extdata/OutputFolder).
>
>
>
>         Note that this is a bad idea.
>         Your users may not have write access to that folder, e.g. for
>         network wiede installation as the one at my department.
>         Also, you have to ask users (por let them enter a path or file)
>         before writing somewhere on the filespace if not tempdir().
>
>         Best,
>         Uwe Ligges
>
>
>
>
>
>                 When I submit to CRAN, I will be sure that OutputFolder
>                 is empty. However,
>                 whenever I make it empty, the entire folder disappears.
>                 To combat this
>                 problem, I have placed a .gitkeep file within the
>                 OutputFolder.
>
>                 I *believe* the presence of the .gitkeep file works as
>                 intended (prevents
>                 the automatic removal of the OutputFolder when empty).
>                 However, upon
>                 running check(), I receive a note:
>
>                 *checking for hidden files and directories ... NOTE*
>                 *Found the following hidden files and directories:*
>                 *  inst/extdata/OutputFiles/.gitkeep*
>                 *These were most likely included in error. See section
>                 ?Package*
>                 *structure? in the ?Writing R Extensions? manual.*
>
>                 Does anyone have advice on how to effectively remove
>                 this note? Otherwise,
>                 does my rationale above seem like a reasonable purpose
>                 for keeping the note?
>
>                 Thank you for helping me approach this!
>
>                         [[alternative HTML version deleted]]
>
>                 ______________________________________________
>                 R-package-devel at r-project.org
>                 <mailto:R-package-devel at r-project.org> mailing list
>                 https://stat.ethz.ch/mailman/listinfo/r-package-devel
>                 <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>
>
>         ______________________________________________
>         R-package-devel at r-project.org
>         <mailto:R-package-devel at r-project.org> mailing list
>         https://stat.ethz.ch/mailman/listinfo/r-package-devel
>         <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>
>
>


From ligges at statistik.tu-dortmund.de  Tue Oct  4 13:11:46 2016
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 4 Oct 2016 13:11:46 +0200
Subject: [R-pkg-devel] Note and warning about subdirectory sizes
In-Reply-To: <CAGRPoRSMh7=4eP5g7D7xJV68J7gHyPeH00E-D+JeLNYo7KBM3Q@mail.gmail.com>
References: <CABrdRMQvemSwOUBjy-YVDtWCCKNuqazufxh25_zdj-2MTheG1Q@mail.gmail.com>
	<c2d79008-60bc-7ffc-b1a5-881a9e744343@gmail.com>
	<CAGRPoRSMh7=4eP5g7D7xJV68J7gHyPeH00E-D+JeLNYo7KBM3Q@mail.gmail.com>
Message-ID: <e0c4572b-4fe5-8b67-d954-f1f9134735f5@statistik.tu-dortmund.de>



On 04.10.2016 03:02, Luck Buttered wrote:
> Hi all,
>
> Thank you for your help.  The only original question I am still a bit
> stuck on is #3.  I read a lot about the command today, and tried
> several approaches, but am unsure how to remove that warning.
>
> * checking sizes of PDF files under ?inst/doc? ... WARNING
>   ?gs+qpdf? made some significant size reductions:
>      compacted ?ePort.pdf? from 1655Kb to 1076Kb
>   consider running tools::compactPDF(gs_quality = "ebook") on these files
>
>
> I work on a Mac with both RStudio and terminal (can do either).  In
> either RStudio or terminal, I could run the command:
>
> compactPDF("inst/doc", qpdf = Sys.which(Sys.getenv("R_QPDF", "qpdf")),
> gs_quality = "ebook")
>
> I would not get any output from that. And when I then run:
>
> check()
>
> I noticed the WARNING was still there.
>
> I also ran:
>
> R CMD build --compact-vignettes=gs
>
> But then when I ran check(), I still noticed the WARNING.


You shoudl be able to run

R CMD build --compact-vignettes=gs
on the package directory and then
R CMD check
on the tarball. In that case the warning should disappear.

Best,
Uwe Ligges




>
> I also ran:
>
> build(compact-vignettes("gs+qpdf"))
>
> which gave me the error:
>
> Error in inherits(x, "package") : object 'compact' not found
>
>
> I tried a few other syntax I found online, but they mostly gave me warnings.
>
> So, what I would love for any advice/input on, is what I can do to
> remove that WARNING (if I must)? I am not sure if I am running
> commands incorrectly, running in the wrong folder, should be using
> command/Rstudio, etc. Even reading advice online and looking at the
> documentation of build and compactPDF is not solving this for me (and
> it may be due to my inexperience with R and terminal).
>
> Thanks again for any help!!!
>
> On Sun, Oct 2, 2016 at 3:43 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>> On 02/10/2016 4:05 PM, S johnson wrote:
>>>
>>> Hi all,
>>>
>>> I am running check() on an R package, and receive one note and one warning
>>> (seem to be related):
>>>
>>> * checking installed package size ... NOTE
>>>   installed size is 25.9Mb
>>>   sub-directories of 1Mb or more:
>>>
>>>     doc       3.4Mb
>>>     extdata  22.1Mb
>>>
>>> * checking sizes of PDF files under ?inst/doc? ... WARNING
>>>   ?gs+qpdf? made some significant size reductions:
>>>      compacted ?ePort.pdf? from 1655Kb to 1076Kb
>>>   consider running tools::compactPDF(gs_quality = "ebook") on these files
>>>
>>> After pondering this note, I have three brief questions as follows,
>>>
>>> 1) When I run "du -hs" on the doc sub-directory, it lists its size as
>>> only 10K. There is only one file inside the doc sub-directory, and
>>> similarly, when I run "du -hs" on that one file, it lists its size as
>>> only 10K. I wonder, then, why check() reports that this sub-directory
>>> called doc is 3.4 Mb?
>>
>>
>> You are probably looking at the package source; the measurements are made
>> after installation.  At that point the vignettes have been copied into the
>> doc directory.
>>
>>>
>>> 2) My extdata sub-directory is rather large. It is certainly over 1Mb.
>>> This is due to a few dozen example images (.png files) that we feel is
>>> important to include in the package. In general, do notes like these
>>> prevent
>>> CRAN submission acceptance? If so, what would be an alternative? I
>>> imagine there were other packages that had extdata subdirectory with
>>> example components that are larger than 1Mb - and upon a Google search
>>> that seems to be the case. Still, I wanted to seek your input!
>>
>>
>> There isn't a hard and fast rule.  If the data is necessary for the function
>> of the package, then it will be allowed.  If it is not needed, then maybe
>> not.  Often if the data is relatively stable but the code may be improved,
>> you'll be asked to put them in separate packages, so that CRAN doesn't fill
>> up with archived repetitions of the same data.
>>
>>>
>>> 3) I am unfamiliar with what I should consider running compactPDF() on.
>>> None of the files are PDF files. The doc sub-directory has one .R file,
>>> and
>>> the extdata sub-directory has .R files, .png files (taking up the most
>>> space), and .txt files.
>>>
>>
>> That message is likely talking about a vignette.  See the help page
>> ?compactPDF for how to invoke it during a build.
>>
>> Duncan Murdoch
>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From pdalgd at gmail.com  Wed Oct  5 19:48:47 2016
From: pdalgd at gmail.com (peter dalgaard)
Date: Wed, 5 Oct 2016 19:48:47 +0200
Subject: [R-pkg-devel] R-3.3.2 on October 31
Message-ID: <97739CEE-FC57-4B03-8DDD-C3CE0EE036FA@gmail.com>

Just a quick heads-up, mostly for those who want to keep their packages up to date with respect to updates of R: We intend to have a patch release on October 31. Nickname and detailed schedule will be made available on developer.r-project.org in due course.

For the R Core Team

Peter Dalgaard

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com









-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From lists at dewey.myzen.co.uk  Fri Oct  7 15:22:58 2016
From: lists at dewey.myzen.co.uk (Michael Dewey)
Date: Fri, 7 Oct 2016 14:22:58 +0100
Subject: [R-pkg-devel] Use of \alias{} versus \concept{}
Message-ID: <06cc7b21-2b6d-d938-9a9a-4e915055503a@dewey.myzen.co.uk>

In my CRAN package metap I implement a number of techniques which have 
multiple names. So, for instance, what I call sumz is also called sum of 
normals, and Stouffer's method. I decided it would be kinder if they 
were documented under all the names I know. Looking at the trusty manual 
I see that \alias{x} does not need to just define an R object so that 
works OK and puts the name, x, in the package index. But I also notice 
that there is \concept{x} which does not index x but makes it findable 
by help.search.

Is the sole reason for \concept{} to enable documenting something which 
does not make it to the index or is there some subtlety which I am missing?

And of course any other advice, especially "Don't do that" is welcome.

-- 
Michael
http://www.dewey.myzen.co.uk/home.html


From gillian at iris.washington.edu  Fri Oct  7 21:06:08 2016
From: gillian at iris.washington.edu (Gillian Sharer)
Date: Fri, 7 Oct 2016 12:06:08 -0700
Subject: [R-pkg-devel] win-builder, compiling C code,
	make[1]: ar: Command not found
Message-ID: <05D65256-1802-4191-8BA4-61CD7BDDCCA0@iris.washington.edu>

Hi,

I tried to submit a package to win-builder with C code and it won?t compile. I get this result:

  ar -crs libmseed.a fileutils.o genutils.o gswap.o lmplatform.o lookup.o msrutils.o pack.o packdata.o traceutils.o    tracelist.o parseutils.o unpack.o unpackdata.o selection.o logging.o
  make[1]: ar: Command not found
  make[1]: *** [libmseed.a] Error 127
  make[1]: Leaving directory `/cygdrive/d/temp/RtmpUvWmaH/R.INSTALL3e847db06d40/IRISSeismic/src- i386/libmseed'
  make: *** [libmseed/libmseed.a] Error 2
  Warning: running command 'make -f "Makevars.win" -f "D:/RCompile/recent/R/etc/i386/Makeconf" -f   "D:/RCompile/recent/R/etc/i386/Makevars.site" -f "D:/RCompile/recent/R/share/make/winshlib.mk"   SHLIB="IRISSeismic.dll" OBJECTS="parseMiniSEED.o"' had status 2
  ERROR: compilation failed for package ?IRISSeismic'

It says it can?t find the command ar, which I don?t understand. This was my original Makevars.win file:

  PKG_CFLAGS=
  PKG_CPPFLAGS=-Ilibmseed
  PKG_LIBS=-Llibmseed -lmseed
  $(SHLIB): libmseed/libmseed.a
  libmseed/libmseed.a:
	@(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)?)
  clean:
	@(cd libmseed && $(MAKE) clean)

and I also tried it using the following with the same results:

  libmseed/libmseed.a:
	@(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)? AR="$(AR)")

A google search turned up nothing and a stackoverflow question has not had any responses yet. Is there something I?m missing? And is there any other relevant information I can provide? I don?t have much experience compiling C code, but it works on Mac OSX and Linux.

Thanks,
Gillian Sharer
gillian at iris.washington.edu

From murdoch.duncan at gmail.com  Fri Oct  7 21:24:06 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 7 Oct 2016 15:24:06 -0400
Subject: [R-pkg-devel] win-builder, compiling C code,
 make[1]: ar: Command not found
In-Reply-To: <05D65256-1802-4191-8BA4-61CD7BDDCCA0@iris.washington.edu>
References: <05D65256-1802-4191-8BA4-61CD7BDDCCA0@iris.washington.edu>
Message-ID: <163e150c-d741-6bb2-7868-b3ee43c6e827@gmail.com>

On 07/10/2016 3:06 PM, Gillian Sharer wrote:
> Hi,
>
> I tried to submit a package to win-builder with C code and it won?t compile. I get this result:
>
>    ar -crs libmseed.a fileutils.o genutils.o gswap.o lmplatform.o lookup.o msrutils.o pack.o packdata.o traceutils.o    tracelist.o parseutils.o unpack.o unpackdata.o selection.o logging.o
>    make[1]: ar: Command not found
>    make[1]: *** [libmseed.a] Error 127
>    make[1]: Leaving directory `/cygdrive/d/temp/RtmpUvWmaH/R.INSTALL3e847db06d40/IRISSeismic/src- i386/libmseed'
>    make: *** [libmseed/libmseed.a] Error 2
>    Warning: running command 'make -f "Makevars.win" -f "D:/RCompile/recent/R/etc/i386/Makeconf" -f   "D:/RCompile/recent/R/etc/i386/Makevars.site" -f "D:/RCompile/recent/R/share/make/winshlib.mk"   SHLIB="IRISSeismic.dll" OBJECTS="parseMiniSEED.o"' had status 2
>    ERROR: compilation failed for package ?IRISSeismic'
>
> It says it can?t find the command ar, which I don?t understand. This was my original Makevars.win file:
>
>    PKG_CFLAGS=
>    PKG_CPPFLAGS=-Ilibmseed
>    PKG_LIBS=-Llibmseed -lmseed
>    $(SHLIB): libmseed/libmseed.a
>    libmseed/libmseed.a:
> 	@(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)?)
>    clean:
> 	@(cd libmseed && $(MAKE) clean)
>
> and I also tried it using the following with the same results:
>
>    libmseed/libmseed.a:
> 	@(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)? AR="$(AR)")
>
> A google search turned up nothing and a stackoverflow question has not had any responses yet. Is there something I?m missing? And is there any other relevant information I can provide? I don?t have much experience compiling C code, but it works on Mac OSX and Linux.

It's just what it said:  you don't have ar on your path.  Normally the 
$(AR) variable is set to $(BINPREF)ar.  Perhaps you've changed 
R_HOME/etc/Makeconf so that isn't true, or have overridden BINPREF with 
a value different from the default.

Duncan Murdoch


From gillian at iris.washington.edu  Sat Oct  8 00:44:04 2016
From: gillian at iris.washington.edu (Gillian Sharer)
Date: Fri, 7 Oct 2016 15:44:04 -0700
Subject: [R-pkg-devel] win-builder, compiling C code,
	make[1]: ar: Command not found
In-Reply-To: <163e150c-d741-6bb2-7868-b3ee43c6e827@gmail.com>
References: <05D65256-1802-4191-8BA4-61CD7BDDCCA0@iris.washington.edu>
	<163e150c-d741-6bb2-7868-b3ee43c6e827@gmail.com>
Message-ID: <DECB7715-0D29-4D37-88F5-190027EA4602@iris.washington.edu>

Thank you for your response. I apologize for asking basic questions, but I?m new to this. On my local machine (mac osx) the $R_HOME/etc/Makeconf AR=ar and $BINPREF is not set. I have ar in my path.

I?m uploading the package to http://win-builder.r-project.org/ using devtools::build_win. Am I right in thinking the path in question is on the Windows machine? I don?t have access to the Windows Makeconf file, so do I need to set something in the Makevars.win file? 

I tried adding this to the src/Makevars.win file:
AR=$(BINPREF)ar

Then I tried:
BINPREF=/mingw_$(WIN)/bin/
AR=$(BINPREF)ar

And:
BINPREF=d:/Compiler/gcc-4.9.3/mingw_32/bin/
AR=$(BINPREF)ar

None of these changed the win-builder results. Do I have the wrong path or is Makevars.win the wrong place to set this?

Thanks,
Gillian Sharer


> On Oct 7, 2016, at 12:24 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 07/10/2016 3:06 PM, Gillian Sharer wrote:
>> Hi,
>> 
>> I tried to submit a package to win-builder with C code and it won?t compile. I get this result:
>> 
>>   ar -crs libmseed.a fileutils.o genutils.o gswap.o lmplatform.o lookup.o msrutils.o pack.o packdata.o traceutils.o    tracelist.o parseutils.o unpack.o unpackdata.o selection.o logging.o
>>   make[1]: ar: Command not found
>>   make[1]: *** [libmseed.a] Error 127
>>   make[1]: Leaving directory `/cygdrive/d/temp/RtmpUvWmaH/R.INSTALL3e847db06d40/IRISSeismic/src- i386/libmseed'
>>   make: *** [libmseed/libmseed.a] Error 2
>>   Warning: running command 'make -f "Makevars.win" -f "D:/RCompile/recent/R/etc/i386/Makeconf" -f   "D:/RCompile/recent/R/etc/i386/Makevars.site" -f "D:/RCompile/recent/R/share/make/winshlib.mk"   SHLIB="IRISSeismic.dll" OBJECTS="parseMiniSEED.o"' had status 2
>>   ERROR: compilation failed for package ?IRISSeismic'
>> 
>> It says it can?t find the command ar, which I don?t understand. This was my original Makevars.win file:
>> 
>>   PKG_CFLAGS=
>>   PKG_CPPFLAGS=-Ilibmseed
>>   PKG_LIBS=-Llibmseed -lmseed
>>   $(SHLIB): libmseed/libmseed.a
>>   libmseed/libmseed.a:
>> 	@(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)?)
>>   clean:
>> 	@(cd libmseed && $(MAKE) clean)
>> 
>> and I also tried it using the following with the same results:
>> 
>>   libmseed/libmseed.a:
>> 	@(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)? AR="$(AR)")
>> 
>> A google search turned up nothing and a stackoverflow question has not had any responses yet. Is there something I?m missing? And is there any other relevant information I can provide? I don?t have much experience compiling C code, but it works on Mac OSX and Linux.
> 
> It's just what it said:  you don't have ar on your path.  Normally the $(AR) variable is set to $(BINPREF)ar.  Perhaps you've changed R_HOME/etc/Makeconf so that isn't true, or have overridden BINPREF with a value different from the default.
> 
> Duncan Murdoch
> 
> 


From wdunlap at tibco.com  Sat Oct  8 00:50:42 2016
From: wdunlap at tibco.com (William Dunlap)
Date: Fri, 7 Oct 2016 15:50:42 -0700
Subject: [R-pkg-devel] win-builder, compiling C code,
 make[1]: ar: Command not found
In-Reply-To: <DECB7715-0D29-4D37-88F5-190027EA4602@iris.washington.edu>
References: <05D65256-1802-4191-8BA4-61CD7BDDCCA0@iris.washington.edu>
	<163e150c-d741-6bb2-7868-b3ee43c6e827@gmail.com>
	<DECB7715-0D29-4D37-88F5-190027EA4602@iris.washington.edu>
Message-ID: <CAF8bMcb4gLf-rSgMN2AW3y0CuRoptB5fO1scrzOPUOr6e1_YaQ@mail.gmail.com>

Do you have a Makefile in the directory yourPackage/src/libmseed?
If so, how does it call 'ar' or '$(AR)'?

Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Fri, Oct 7, 2016 at 3:44 PM, Gillian Sharer <gillian at iris.washington.edu>
wrote:

> Thank you for your response. I apologize for asking basic questions, but
> I?m new to this. On my local machine (mac osx) the $R_HOME/etc/Makeconf
> AR=ar and $BINPREF is not set. I have ar in my path.
>
> I?m uploading the package to http://win-builder.r-project.org/ using
> devtools::build_win. Am I right in thinking the path in question is on the
> Windows machine? I don?t have access to the Windows Makeconf file, so do I
> need to set something in the Makevars.win file?
>
> I tried adding this to the src/Makevars.win file:
> AR=$(BINPREF)ar
>
> Then I tried:
> BINPREF=/mingw_$(WIN)/bin/
> AR=$(BINPREF)ar
>
> And:
> BINPREF=d:/Compiler/gcc-4.9.3/mingw_32/bin/
> AR=$(BINPREF)ar
>
> None of these changed the win-builder results. Do I have the wrong path or
> is Makevars.win the wrong place to set this?
>
> Thanks,
> Gillian Sharer
>
>
> > On Oct 7, 2016, at 12:24 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
> >
> > On 07/10/2016 3:06 PM, Gillian Sharer wrote:
> >> Hi,
> >>
> >> I tried to submit a package to win-builder with C code and it won?t
> compile. I get this result:
> >>
> >>   ar -crs libmseed.a fileutils.o genutils.o gswap.o lmplatform.o
> lookup.o msrutils.o pack.o packdata.o traceutils.o    tracelist.o
> parseutils.o unpack.o unpackdata.o selection.o logging.o
> >>   make[1]: ar: Command not found
> >>   make[1]: *** [libmseed.a] Error 127
> >>   make[1]: Leaving directory `/cygdrive/d/temp/RtmpUvWmaH/
> R.INSTALL3e847db06d40/IRISSeismic/src- i386/libmseed'
> >>   make: *** [libmseed/libmseed.a] Error 2
> >>   Warning: running command 'make -f "Makevars.win" -f
> "D:/RCompile/recent/R/etc/i386/Makeconf" -f   "D:/RCompile/recent/R/etc/i386/Makevars.site"
> -f "D:/RCompile/recent/R/share/make/winshlib.mk"
>  SHLIB="IRISSeismic.dll" OBJECTS="parseMiniSEED.o"' had status 2
> >>   ERROR: compilation failed for package ?IRISSeismic'
> >>
> >> It says it can?t find the command ar, which I don?t understand. This
> was my original Makevars.win file:
> >>
> >>   PKG_CFLAGS=
> >>   PKG_CPPFLAGS=-Ilibmseed
> >>   PKG_LIBS=-Llibmseed -lmseed
> >>   $(SHLIB): libmseed/libmseed.a
> >>   libmseed/libmseed.a:
> >>      @(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)?)
> >>   clean:
> >>      @(cd libmseed && $(MAKE) clean)
> >>
> >> and I also tried it using the following with the same results:
> >>
> >>   libmseed/libmseed.a:
> >>      @(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)?
> AR="$(AR)")
> >>
> >> A google search turned up nothing and a stackoverflow question has not
> had any responses yet. Is there something I?m missing? And is there any
> other relevant information I can provide? I don?t have much experience
> compiling C code, but it works on Mac OSX and Linux.
> >
> > It's just what it said:  you don't have ar on your path.  Normally the
> $(AR) variable is set to $(BINPREF)ar.  Perhaps you've changed
> R_HOME/etc/Makeconf so that isn't true, or have overridden BINPREF with a
> value different from the default.
> >
> > Duncan Murdoch
> >
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From gillian at iris.washington.edu  Sat Oct  8 02:30:54 2016
From: gillian at iris.washington.edu (Gillian Sharer)
Date: Fri, 7 Oct 2016 17:30:54 -0700
Subject: [R-pkg-devel] win-builder, compiling C code,
	make[1]: ar: Command not found
In-Reply-To: <CAF8bMcb4gLf-rSgMN2AW3y0CuRoptB5fO1scrzOPUOr6e1_YaQ@mail.gmail.com>
References: <05D65256-1802-4191-8BA4-61CD7BDDCCA0@iris.washington.edu>
	<163e150c-d741-6bb2-7868-b3ee43c6e827@gmail.com>
	<DECB7715-0D29-4D37-88F5-190027EA4602@iris.washington.edu>
	<CAF8bMcb4gLf-rSgMN2AW3y0CuRoptB5fO1scrzOPUOr6e1_YaQ@mail.gmail.com>
Message-ID: <90BE112C-7F3D-41D6-BD29-F3C77F717315@iris.washington.edu>


It?s solved! Changing ?ar? to ?$(AR)? in the Makefile along with adding AR="$(AR)" to @(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)") in the Makevars.win fixed the problem.

Thank you!
Gillian Sharer

> On Oct 7, 2016, at 3:50 PM, William Dunlap <wdunlap at tibco.com> wrote:
> 
> Do you have a Makefile in the directory yourPackage/src/libmseed?
> If so, how does it call 'ar' or '$(AR)'?
> 
> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com
> 
> On Fri, Oct 7, 2016 at 3:44 PM, Gillian Sharer <gillian at iris.washington.edu> wrote:
> Thank you for your response. I apologize for asking basic questions, but I?m new to this. On my local machine (mac osx) the $R_HOME/etc/Makeconf AR=ar and $BINPREF is not set. I have ar in my path.
> 
> I?m uploading the package to http://win-builder.r-project.org/ using devtools::build_win. Am I right in thinking the path in question is on the Windows machine? I don?t have access to the Windows Makeconf file, so do I need to set something in the Makevars.win file?
> 
> I tried adding this to the src/Makevars.win file:
> AR=$(BINPREF)ar
> 
> Then I tried:
> BINPREF=/mingw_$(WIN)/bin/
> AR=$(BINPREF)ar
> 
> And:
> BINPREF=d:/Compiler/gcc-4.9.3/mingw_32/bin/
> AR=$(BINPREF)ar
> 
> None of these changed the win-builder results. Do I have the wrong path or is Makevars.win the wrong place to set this?
> 
> Thanks,
> Gillian Sharer
> 
> 
> > On Oct 7, 2016, at 12:24 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> >
> > On 07/10/2016 3:06 PM, Gillian Sharer wrote:
> >> Hi,
> >>
> >> I tried to submit a package to win-builder with C code and it won?t compile. I get this result:
> >>
> >>   ar -crs libmseed.a fileutils.o genutils.o gswap.o lmplatform.o lookup.o msrutils.o pack.o packdata.o traceutils.o    tracelist.o parseutils.o unpack.o unpackdata.o selection.o logging.o
> >>   make[1]: ar: Command not found
> >>   make[1]: *** [libmseed.a] Error 127
> >>   make[1]: Leaving directory `/cygdrive/d/temp/RtmpUvWmaH/R.INSTALL3e847db06d40/IRISSeismic/src- i386/libmseed'
> >>   make: *** [libmseed/libmseed.a] Error 2
> >>   Warning: running command 'make -f "Makevars.win" -f "D:/RCompile/recent/R/etc/i386/Makeconf" -f   "D:/RCompile/recent/R/etc/i386/Makevars.site" -f "D:/RCompile/recent/R/share/make/winshlib.mk"   SHLIB="IRISSeismic.dll" OBJECTS="parseMiniSEED.o"' had status 2
> >>   ERROR: compilation failed for package ?IRISSeismic'
> >>
> >> It says it can?t find the command ar, which I don?t understand. This was my original Makevars.win file:
> >>
> >>   PKG_CFLAGS=
> >>   PKG_CPPFLAGS=-Ilibmseed
> >>   PKG_LIBS=-Llibmseed -lmseed
> >>   $(SHLIB): libmseed/libmseed.a
> >>   libmseed/libmseed.a:
> >>      @(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)?)
> >>   clean:
> >>      @(cd libmseed && $(MAKE) clean)
> >>
> >> and I also tried it using the following with the same results:
> >>
> >>   libmseed/libmseed.a:
> >>      @(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)? AR="$(AR)")
> >>
> >> A google search turned up nothing and a stackoverflow question has not had any responses yet. Is there something I?m missing? And is there any other relevant information I can provide? I don?t have much experience compiling C code, but it works on Mac OSX and Linux.
> >
> > It's just what it said:  you don't have ar on your path.  Normally the $(AR) variable is set to $(BINPREF)ar.  Perhaps you've changed R_HOME/etc/Makeconf so that isn't true, or have overridden BINPREF with a value different from the default.
> >
> > Duncan Murdoch
> >
> >
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 


From wdunlap at tibco.com  Sat Oct  8 02:45:19 2016
From: wdunlap at tibco.com (William Dunlap)
Date: Fri, 7 Oct 2016 17:45:19 -0700
Subject: [R-pkg-devel] win-builder, compiling C code,
 make[1]: ar: Command not found
In-Reply-To: <90BE112C-7F3D-41D6-BD29-F3C77F717315@iris.washington.edu>
References: <05D65256-1802-4191-8BA4-61CD7BDDCCA0@iris.washington.edu>
	<163e150c-d741-6bb2-7868-b3ee43c6e827@gmail.com>
	<DECB7715-0D29-4D37-88F5-190027EA4602@iris.washington.edu>
	<CAF8bMcb4gLf-rSgMN2AW3y0CuRoptB5fO1scrzOPUOr6e1_YaQ@mail.gmail.com>
	<90BE112C-7F3D-41D6-BD29-F3C77F717315@iris.washington.edu>
Message-ID: <CAF8bMcb9-BnYfmxa_SmzdXDVbCryvHOTVBkE5kzDny3jbzmpPw@mail.gmail.com>

If you hadn't squelched command line echoing from your makefiles (by
putting the 'at' signs in front of the commands)  you might have discovered
the problem faster.

Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Fri, Oct 7, 2016 at 5:30 PM, Gillian Sharer <gillian at iris.washington.edu>
wrote:

>
> It?s solved! Changing ?ar? to ?$(AR)? in the Makefile along with adding
> AR="$(AR)" to @(cd libmseed && $(MAKE) static CC="$(CC)"
> CFLAGS="$(CFLAGS)") in the Makevars.win fixed the problem.
>
> Thank you!
> Gillian Sharer
>
> > On Oct 7, 2016, at 3:50 PM, William Dunlap <wdunlap at tibco.com> wrote:
> >
> > Do you have a Makefile in the directory yourPackage/src/libmseed?
> > If so, how does it call 'ar' or '$(AR)'?
> >
> > Bill Dunlap
> > TIBCO Software
> > wdunlap tibco.com
> >
> > On Fri, Oct 7, 2016 at 3:44 PM, Gillian Sharer <
> gillian at iris.washington.edu> wrote:
> > Thank you for your response. I apologize for asking basic questions, but
> I?m new to this. On my local machine (mac osx) the $R_HOME/etc/Makeconf
> AR=ar and $BINPREF is not set. I have ar in my path.
> >
> > I?m uploading the package to http://win-builder.r-project.org/ using
> devtools::build_win. Am I right in thinking the path in question is on the
> Windows machine? I don?t have access to the Windows Makeconf file, so do I
> need to set something in the Makevars.win file?
> >
> > I tried adding this to the src/Makevars.win file:
> > AR=$(BINPREF)ar
> >
> > Then I tried:
> > BINPREF=/mingw_$(WIN)/bin/
> > AR=$(BINPREF)ar
> >
> > And:
> > BINPREF=d:/Compiler/gcc-4.9.3/mingw_32/bin/
> > AR=$(BINPREF)ar
> >
> > None of these changed the win-builder results. Do I have the wrong path
> or is Makevars.win the wrong place to set this?
> >
> > Thanks,
> > Gillian Sharer
> >
> >
> > > On Oct 7, 2016, at 12:24 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
> > >
> > > On 07/10/2016 3:06 PM, Gillian Sharer wrote:
> > >> Hi,
> > >>
> > >> I tried to submit a package to win-builder with C code and it won?t
> compile. I get this result:
> > >>
> > >>   ar -crs libmseed.a fileutils.o genutils.o gswap.o lmplatform.o
> lookup.o msrutils.o pack.o packdata.o traceutils.o    tracelist.o
> parseutils.o unpack.o unpackdata.o selection.o logging.o
> > >>   make[1]: ar: Command not found
> > >>   make[1]: *** [libmseed.a] Error 127
> > >>   make[1]: Leaving directory `/cygdrive/d/temp/RtmpUvWmaH/
> R.INSTALL3e847db06d40/IRISSeismic/src- i386/libmseed'
> > >>   make: *** [libmseed/libmseed.a] Error 2
> > >>   Warning: running command 'make -f "Makevars.win" -f
> "D:/RCompile/recent/R/etc/i386/Makeconf" -f   "D:/RCompile/recent/R/etc/i386/Makevars.site"
> -f "D:/RCompile/recent/R/share/make/winshlib.mk"
>  SHLIB="IRISSeismic.dll" OBJECTS="parseMiniSEED.o"' had status 2
> > >>   ERROR: compilation failed for package ?IRISSeismic'
> > >>
> > >> It says it can?t find the command ar, which I don?t understand. This
> was my original Makevars.win file:
> > >>
> > >>   PKG_CFLAGS=
> > >>   PKG_CPPFLAGS=-Ilibmseed
> > >>   PKG_LIBS=-Llibmseed -lmseed
> > >>   $(SHLIB): libmseed/libmseed.a
> > >>   libmseed/libmseed.a:
> > >>      @(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)?)
> > >>   clean:
> > >>      @(cd libmseed && $(MAKE) clean)
> > >>
> > >> and I also tried it using the following with the same results:
> > >>
> > >>   libmseed/libmseed.a:
> > >>      @(cd libmseed && $(MAKE) static CC="$(CC)" CFLAGS="$(CFLAGS)?
> AR="$(AR)")
> > >>
> > >> A google search turned up nothing and a stackoverflow question has
> not had any responses yet. Is there something I?m missing? And is there any
> other relevant information I can provide? I don?t have much experience
> compiling C code, but it works on Mac OSX and Linux.
> > >
> > > It's just what it said:  you don't have ar on your path.  Normally the
> $(AR) variable is set to $(BINPREF)ar.  Perhaps you've changed
> R_HOME/etc/Makeconf so that isn't true, or have overridden BINPREF with a
> value different from the default.
> > >
> > > Duncan Murdoch
> > >
> > >
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From gkraemer at bgc-jena.mpg.de  Wed Oct 12 12:26:14 2016
From: gkraemer at bgc-jena.mpg.de (Guido Kraemer)
Date: Wed, 12 Oct 2016 12:26:14 +0200
Subject: [R-pkg-devel] fastICA on win-builder.r-project.org not installed?
Message-ID: <4faa1a3f-866b-8ff7-5543-7ec2377c535d@bgc-jena.mpg.de>

Dear R package devels,

I am trying to check a package which depends on fastICA on 
win-builder.r-project.org, the checks fail complaining that fastICA is 
not installed.

Cheers,
Guido

PS: the log can be found here:
https://win-builder.r-project.org/265alZrIl0s6/00check.log

-- 
Guido Kraemer
Max Planck Institute for Biogeochemistry Jena
Department for Biogeochemical Integration
Hans-Kn?ll-Str. 10
07745 Jena
Germany

phone: +49 3641 576293
e-mail: gkraemer at bgc-jena.mpg.de


From maechler at stat.math.ethz.ch  Wed Oct 12 14:41:34 2016
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 12 Oct 2016 14:41:34 +0200
Subject: [R-pkg-devel] fastICA on win-builder.r-project.org not
	installed?
In-Reply-To: <4faa1a3f-866b-8ff7-5543-7ec2377c535d@bgc-jena.mpg.de>
References: <4faa1a3f-866b-8ff7-5543-7ec2377c535d@bgc-jena.mpg.de>
Message-ID: <22526.12158.660868.535714@stat.math.ethz.ch>

>>>>> Guido Kraemer <gkraemer at bgc-jena.mpg.de>
>>>>>     on Wed, 12 Oct 2016 12:26:14 +0200 writes:

    > Dear R package devels, I am trying to check a package
    > which depends on fastICA on win-builder.r-project.org, the
    > checks fail complaining that fastICA is not installed.

Well, you are *interpreting* the error message.
What is true is that fastICA is not *visible* in the
' R CMD check <yourPkg> '
environment.

    > PS: the log can be found here:
    > https://win-builder.r-project.org/265alZrIl0s6/00check.log

fastICA  is not at all mentioned in your DESCRIPTION file.
That is *always* wrong for any package you even only sometimes
use in your package.
... and that entirely explains why it is not found during checking.
Checking (almost) exactly only sees the packages that you
declare to "require".

Possibly adding the one line

Suggests: fastICA

to the DESCRIPTION file may be sufficient.
Please read more about this in *the* manual (for this topic):
"Writing R Extensions", part of every R installation and
browseable e.g., here
   https://cran.r-project.org/doc/manuals/r-release/R-exts.html

https://cran.r-project.org/manuals.html mentions different
formats, including Epub.

Martin Maechler
ETH Zurich


From glennmschultz at me.com  Sun Oct 16 20:05:43 2016
From: glennmschultz at me.com (Glenn Schultz)
Date: Sun, 16 Oct 2016 18:05:43 +0000 (GMT)
Subject: [R-pkg-devel] using optimx in a package
Message-ID: <ee38ecc6-ee68-41bd-b16b-ee7297bce356@me.com>

All,

I am using optimx in my package to fit the term structure of interest rates. ?When I call the function from the package I get the following error:

Error in optimx.check(par, optcfg$ufn, optcfg$ugr, optcfg$uhess, lower, : 
Cannot evaluate function at initial parameters
Called from: optimx.check(par, optcfg$ufn, optcfg$ugr, optcfg$uhess, lower, 
upper, hessian, optcfg$ctrl, have.bounds = optcfg$have.bounds, 
usenumDeriv = optcfg$usenumDeriv, ...)

However, if I run the function locally outside of the package it runs a provides the correct solution to the problem. ?So, the issue is the function will not run correctly when called from the package. ?Any suggestions are appreciated. This package is written in S4

Glenn

Here is a dput of the Rates Object
structure(list(Date = c("2016-07-11", NA), ED1M = c(0.47785, 
0.0833), ED3M = c(0.6691, 0.25), ED6M = c(0.9514, 0.5), USSW1 = c(0.74, 
1), USSW2 = c(0.82, 2), USSW3 = c(0.88, 3), USSW4 = c(0.93, 4
), USSW5 = c(1, 5), USSW7 = c(1.13, 7), USSW10 = c(1.31, 10), 
USSW30 = c(1.72, 30)), .Names = c("Date", "ED1M", "ED3M", 
"ED6M", "USSW1", "USSW2", "USSW3", "USSW4", "USSW5", "USSW7", 
"USSW10", "USSW30"), row.names = 1:2, class = "data.frame")


Requirements

require(lubridate)
require(termstrc)
require(optimx)

months.in.year = 12
weeks.in.year = 52
pmt.frequency = 2
min.principal = 100
days.in.month = 30.44
Rates <- RatesObject #Rates(trade.date = "07-11-2016")


Here is the function
CalibrateCIR <- function(trade.date = character, 
sigma = numeric()){

rates.data <- Rates(trade.date = trade.date) 
shortrate = as.numeric(rates.data[1,2])/100

#set the column counter to make cashflows for termstrucutre
ColCount <- as.numeric(ncol(rates.data))
Mat.Years <- as.numeric(rates.data[2,2:ColCount])
Coupon.Rate <- as.numeric(rates.data[1,2:ColCount])
Issue.Date <- as.Date(rates.data[1,1])

#initialize coupon bonds S3 class
#This can be upgraded when bondlab has portfolio function
ISIN <- vector()
MATURITYDATE <- vector()
ISSUEDATE <- vector()
COUPONRATE <- vector()
PRICE <- vector()
ACCRUED <- vector()
CFISIN <- vector()
CF <- vector()
DATE <- vector()
CASHFLOWS <- list(CFISIN,CF,DATE)
names(CASHFLOWS) <- c("ISIN","CF","DATE")
TODAY <- vector()
data <- list()
TSInput <- list()

### Assign Values to List Items #########
data = NULL
data$ISIN <- colnames(rates.data[2:ColCount])
data$ISSUEDATE <- rep(as.Date(rates.data[1,1]),ColCount - 1)
data$MATURITYDATE <-
sapply(Mat.Years, function(Mat.Years = Mat.Years, Issue = Issue.Date) 
{Maturity = if(Mat.Years < 1) {
Issue %m+% months(round(Mat.Years * months.in.year))} else 
{Issue %m+% years(as.numeric(Mat.Years))}
return(as.character(Maturity))
}) 
data$COUPONRATE <- ifelse(Mat.Years < 1, 0, Coupon.Rate) 
data$PRICE <- ifelse(
Mat.Years < 1, (1 + (Coupon.Rate/100))^(Mat.Years * -1) * 100, 100)
data$ACCRUED <- rep(0, ColCount -1)

for(j in 1:(ColCount-1)){
Vector.Length <- as.numeric(round(
difftime(data[[3]][j],
data[[2]][j],
units = c("weeks"))/weeks.in.year,5))

Vector.Length <- ifelse(round(Vector.Length) < 1, 1 , 
round(Vector.Length * pmt.frequency))

data$CASHFLOWS$ISIN <- append(
data$CASHFLOWS$ISIN, rep(data[[1]][j],Vector.Length))

data$CASHFLOWS$CF <- append(
data$CASHFLOWS$CF,
as.numeric(
c(rep((data[[4]][j]/100/pmt.frequency),Vector.Length-1) * min.principal,
(min.principal + 
(data$COUPONRATE[j]/100/pmt.frequency)* min.principal))))

by.months = ifelse(data[[4]][j] == 0, round(difftime(
data[[3]][j], rates.data[1,1])/days.in.month), 6)

data$CASHFLOWS$DATE <- append(
data$CASHFLOW$DATE, seq(
as.Date(data[[2]][j]) %m+% months(as.numeric(by.months)), 
as.Date(data[[3]][j]),
by = as.character(paste(by.months, "months", sep = " "))))

} #The Loop Ends here and the list is made

data$TODAY <- as.Date(rates.data[1,1])
TSInput[[as.character(rates.data[1,1])]] <- c(data)

#set term strucutre input (TSInput) to class couponbonds
class(TSInput) <- "couponbonds"
CashFlow <- TSInput[[1]]
CIR.CF.Matrix <<- create_cashflows_matrix(TSInput[[1]], include_price = TRUE)
CIR.Mat.Matrix <<- create_maturities_matrix(TSInput[[1]], include_price = TRUE )

#Objective function for the origin to be inaccessable the followign 
#condition must be met
# 2 * kappa * theta <= sigma^2 
CIRTune <- function(param = numeric(), 
shortrate = numeric(), 
sigma = sigma, 
cfmatrix = matrix(), 
matmatrix = matrix()){

kappa = param[1]
theta = param[2]

FwdRate <- CIRSim(kappa = kappa,
theta = theta,
shortrate = Rates[1,2]/100,
T = 30,
step = 6/months.in.year,
sigma = sigma,
N = 1)

Spot <- cumprod(1+(FwdRate))
t <- seq(1,length(Spot),1)
Spot <- Spot^(1/t)
#DiscMatrix <<- 1/(Spot^matmatrix)
CIRTune <- sqrt((sum(colSums((cfmatrix * 1/(Spot^matmatrix)))^2))/ncol(matmatrix))
return(CIRTune)
}

# Fit the model to the market 
fit <- optimx(par = c(.1, .05), 
fn = CIRTune, 
method = "L-BFGS-B",
lower = c(.1,.01),
upper = c(.9, .2) , 
shortrate = shortrate,
sigma = sigma,
cfmatrix = CIR.CF.Matrix, 
matmatrix = CIR.Mat.Matrix) 

return(fit)
}




From edd at debian.org  Mon Oct 17 01:01:30 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 16 Oct 2016 18:01:30 -0500
Subject: [R-pkg-devel] using optimx in a package
In-Reply-To: <ee38ecc6-ee68-41bd-b16b-ee7297bce356@me.com>
References: <ee38ecc6-ee68-41bd-b16b-ee7297bce356@me.com>
Message-ID: <22532.1738.22464.558369@max.nulle.part>


On 16 October 2016 at 18:05, Glenn Schultz wrote:
| All,
| 
| I am using optimx in my package to fit the term structure of interest rates. ?When I call the function from the package I get the following error:
| 
| Error in optimx.check(par, optcfg$ufn, optcfg$ugr, optcfg$uhess, lower, : 
| Cannot evaluate function at initial parameters
| Called from: optimx.check(par, optcfg$ufn, optcfg$ugr, optcfg$uhess, lower, 
| upper, hessian, optcfg$ctrl, have.bounds = optcfg$have.bounds, 
| usenumDeriv = optcfg$usenumDeriv, ...)
| 
| However, if I run the function locally outside of the package it runs a provides the correct solution to the problem. ?So, the issue is the function will not run correctly when called from the package. ?Any suggestions are appreciated. This package is written in S4

Make sure you _import_ the optmix package correctly in _your_ package. What
is visible to the package, versus what your commandline sees, is (almost
entirely) governed by NAMESPACE and DESCRIPTION.

'R CMD check --as-cran', particular when R is R-devel, should have plenty of pointers.

Dirk

| Glenn
| 
| Here is a dput of the Rates Object
| structure(list(Date = c("2016-07-11", NA), ED1M = c(0.47785, 
| 0.0833), ED3M = c(0.6691, 0.25), ED6M = c(0.9514, 0.5), USSW1 = c(0.74, 
| 1), USSW2 = c(0.82, 2), USSW3 = c(0.88, 3), USSW4 = c(0.93, 4
| ), USSW5 = c(1, 5), USSW7 = c(1.13, 7), USSW10 = c(1.31, 10), 
| USSW30 = c(1.72, 30)), .Names = c("Date", "ED1M", "ED3M", 
| "ED6M", "USSW1", "USSW2", "USSW3", "USSW4", "USSW5", "USSW7", 
| "USSW10", "USSW30"), row.names = 1:2, class = "data.frame")
| 
| 
| Requirements
| 
| require(lubridate)
| require(termstrc)
| require(optimx)
| 
| months.in.year = 12
| weeks.in.year = 52
| pmt.frequency = 2
| min.principal = 100
| days.in.month = 30.44
| Rates <- RatesObject #Rates(trade.date = "07-11-2016")
| 
| 
| Here is the function
| CalibrateCIR <- function(trade.date = character, 
| sigma = numeric()){
| 
| rates.data <- Rates(trade.date = trade.date) 
| shortrate = as.numeric(rates.data[1,2])/100
| 
| #set the column counter to make cashflows for termstrucutre
| ColCount <- as.numeric(ncol(rates.data))
| Mat.Years <- as.numeric(rates.data[2,2:ColCount])
| Coupon.Rate <- as.numeric(rates.data[1,2:ColCount])
| Issue.Date <- as.Date(rates.data[1,1])
| 
| #initialize coupon bonds S3 class
| #This can be upgraded when bondlab has portfolio function
| ISIN <- vector()
| MATURITYDATE <- vector()
| ISSUEDATE <- vector()
| COUPONRATE <- vector()
| PRICE <- vector()
| ACCRUED <- vector()
| CFISIN <- vector()
| CF <- vector()
| DATE <- vector()
| CASHFLOWS <- list(CFISIN,CF,DATE)
| names(CASHFLOWS) <- c("ISIN","CF","DATE")
| TODAY <- vector()
| data <- list()
| TSInput <- list()
| 
| ### Assign Values to List Items #########
| data = NULL
| data$ISIN <- colnames(rates.data[2:ColCount])
| data$ISSUEDATE <- rep(as.Date(rates.data[1,1]),ColCount - 1)
| data$MATURITYDATE <-
| sapply(Mat.Years, function(Mat.Years = Mat.Years, Issue = Issue.Date) 
| {Maturity = if(Mat.Years < 1) {
| Issue %m+% months(round(Mat.Years * months.in.year))} else 
| {Issue %m+% years(as.numeric(Mat.Years))}
| return(as.character(Maturity))
| }) 
| data$COUPONRATE <- ifelse(Mat.Years < 1, 0, Coupon.Rate) 
| data$PRICE <- ifelse(
| Mat.Years < 1, (1 + (Coupon.Rate/100))^(Mat.Years * -1) * 100, 100)
| data$ACCRUED <- rep(0, ColCount -1)
| 
| for(j in 1:(ColCount-1)){
| Vector.Length <- as.numeric(round(
| difftime(data[[3]][j],
| data[[2]][j],
| units = c("weeks"))/weeks.in.year,5))
| 
| Vector.Length <- ifelse(round(Vector.Length) < 1, 1 , 
| round(Vector.Length * pmt.frequency))
| 
| data$CASHFLOWS$ISIN <- append(
| data$CASHFLOWS$ISIN, rep(data[[1]][j],Vector.Length))
| 
| data$CASHFLOWS$CF <- append(
| data$CASHFLOWS$CF,
| as.numeric(
| c(rep((data[[4]][j]/100/pmt.frequency),Vector.Length-1) * min.principal,
| (min.principal + 
| (data$COUPONRATE[j]/100/pmt.frequency)* min.principal))))
| 
| by.months = ifelse(data[[4]][j] == 0, round(difftime(
| data[[3]][j], rates.data[1,1])/days.in.month), 6)
| 
| data$CASHFLOWS$DATE <- append(
| data$CASHFLOW$DATE, seq(
| as.Date(data[[2]][j]) %m+% months(as.numeric(by.months)), 
| as.Date(data[[3]][j]),
| by = as.character(paste(by.months, "months", sep = " "))))
| 
| } #The Loop Ends here and the list is made
| 
| data$TODAY <- as.Date(rates.data[1,1])
| TSInput[[as.character(rates.data[1,1])]] <- c(data)
| 
| #set term strucutre input (TSInput) to class couponbonds
| class(TSInput) <- "couponbonds"
| CashFlow <- TSInput[[1]]
| CIR.CF.Matrix <<- create_cashflows_matrix(TSInput[[1]], include_price = TRUE)
| CIR.Mat.Matrix <<- create_maturities_matrix(TSInput[[1]], include_price = TRUE )
| 
| #Objective function for the origin to be inaccessable the followign 
| #condition must be met
| # 2 * kappa * theta <= sigma^2 
| CIRTune <- function(param = numeric(), 
| shortrate = numeric(), 
| sigma = sigma, 
| cfmatrix = matrix(), 
| matmatrix = matrix()){
| 
| kappa = param[1]
| theta = param[2]
| 
| FwdRate <- CIRSim(kappa = kappa,
| theta = theta,
| shortrate = Rates[1,2]/100,
| T = 30,
| step = 6/months.in.year,
| sigma = sigma,
| N = 1)
| 
| Spot <- cumprod(1+(FwdRate))
| t <- seq(1,length(Spot),1)
| Spot <- Spot^(1/t)
| #DiscMatrix <<- 1/(Spot^matmatrix)
| CIRTune <- sqrt((sum(colSums((cfmatrix * 1/(Spot^matmatrix)))^2))/ncol(matmatrix))
| return(CIRTune)
| }
| 
| # Fit the model to the market 
| fit <- optimx(par = c(.1, .05), 
| fn = CIRTune, 
| method = "L-BFGS-B",
| lower = c(.1,.01),
| upper = c(.9, .2) , 
| shortrate = shortrate,
| sigma = sigma,
| cfmatrix = CIR.CF.Matrix, 
| matmatrix = CIR.Mat.Matrix) 
| 
| return(fit)
| }
| 
| 
| 
| ______________________________________________
| R-package-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-package-devel
-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From profjcnash at gmail.com  Mon Oct 17 15:30:24 2016
From: profjcnash at gmail.com (ProfJCNash)
Date: Mon, 17 Oct 2016 09:30:24 -0400
Subject: [R-pkg-devel] using optimx in a package
In-Reply-To: <ee38ecc6-ee68-41bd-b16b-ee7297bce356@me.com>
References: <ee38ecc6-ee68-41bd-b16b-ee7297bce356@me.com>
Message-ID: <58b79a28-4e87-abfb-5cc2-13395608c52b@gmail.com>

You are calling an optimizer that wants gradients without specifying the gradient method. I've not done any work on
optimx for a couple of years -- on R-forge I've put optimrx which has a more maintainable design and allows more solvers
to be called using the optim() syntax, including parameter scaling, and also offers a clearer choice of which gradient
approximation is to be used. It's possible that the initial gradient could not be worked out, though the message talks
about the function.

I tried running the code, but there are some glitches that look like you transmitted in HTML or otherwise have
line endings or delimiters mangled. If you can post code that will run, I'll give it a try.

JN


On 16-10-16 02:05 PM, Glenn Schultz wrote:
> All,
> 
> I am using optimx in my package to fit the term structure of interest rates.  When I call the function from the package
> I get the following error:
> 
> Error in optimx.check(par, optcfg$ufn, optcfg$ugr, optcfg$uhess, lower, : Cannot evaluate function at initial parameters
> Called from: optimx.check(par, optcfg$ufn, optcfg$ugr, optcfg$uhess, lower, upper, hessian, optcfg$ctrl, have.bounds =
> optcfg$have.bounds, usenumDeriv = optcfg$usenumDeriv, ...)
> 
> However, if I run the function locally outside of the package it runs a provides the correct solution to the problem.
>  So, the issue is the function will not run correctly when called from the package.  Any suggestions are appreciated.
> This package is written in S4
> 
> Glenn
> 
> Here is a dput of the Rates Object
> structure(list(Date = c("2016-07-11", NA), ED1M = c(0.47785, 0.0833), ED3M = c(0.6691, 0.25), ED6M = c(0.9514, 0.5),
> USSW1 = c(0.74, 1), USSW2 = c(0.82, 2), USSW3 = c(0.88, 3), USSW4 = c(0.93, 4
> ), USSW5 = c(1, 5), USSW7 = c(1.13, 7), USSW10 = c(1.31, 10), USSW30 = c(1.72, 30)), .Names = c("Date", "ED1M", "ED3M",
> "ED6M", "USSW1", "USSW2", "USSW3", "USSW4", "USSW5", "USSW7", "USSW10", "USSW30"), row.names = 1:2, class = "data.frame")
> 
> 
> Requirements
> 
> require(lubridate)
> require(termstrc)
> require(optimx)
> 
> months.in.year = 12
> weeks.in.year = 52
> pmt.frequency = 2
> min.principal = 100
> days.in.month = 30.44
> Rates <- RatesObject #Rates(trade.date = "07-11-2016")
> 
> 
> Here is the function
> CalibrateCIR <- function(trade.date = character, sigma = numeric()){
> 
> rates.data <- Rates(trade.date = trade.date) shortrate = as.numeric(rates.data[1,2])/100
> 
> #set the column counter to make cashflows for termstrucutre
> ColCount <- as.numeric(ncol(rates.data))
> Mat.Years <- as.numeric(rates.data[2,2:ColCount])
> Coupon.Rate <- as.numeric(rates.data[1,2:ColCount])
> Issue.Date <- as.Date(rates.data[1,1])
> 
> #initialize coupon bonds S3 class
> #This can be upgraded when bondlab has portfolio function
> ISIN <- vector()
> MATURITYDATE <- vector()
> ISSUEDATE <- vector()
> COUPONRATE <- vector()
> PRICE <- vector()
> ACCRUED <- vector()
> CFISIN <- vector()
> CF <- vector()
> DATE <- vector()
> CASHFLOWS <- list(CFISIN,CF,DATE)
> names(CASHFLOWS) <- c("ISIN","CF","DATE")
> TODAY <- vector()
> data <- list()
> TSInput <- list()
> 
> ### Assign Values to List Items #########
> data = NULL
> data$ISIN <- colnames(rates.data[2:ColCount])
> data$ISSUEDATE <- rep(as.Date(rates.data[1,1]),ColCount - 1)
> data$MATURITYDATE <-
> sapply(Mat.Years, function(Mat.Years = Mat.Years, Issue = Issue.Date) {Maturity = if(Mat.Years < 1) {
> Issue %m+% months(round(Mat.Years * months.in.year))} else {Issue %m+% years(as.numeric(Mat.Years))}
> return(as.character(Maturity))
> }) data$COUPONRATE <- ifelse(Mat.Years < 1, 0, Coupon.Rate) data$PRICE <- ifelse(
> Mat.Years < 1, (1 + (Coupon.Rate/100))^(Mat.Years * -1) * 100, 100)
> data$ACCRUED <- rep(0, ColCount -1)
> 
> for(j in 1:(ColCount-1)){
> Vector.Length <- as.numeric(round(
> difftime(data[[3]][j],
> data[[2]][j],
> units = c("weeks"))/weeks.in.year,5))
> 
> Vector.Length <- ifelse(round(Vector.Length) < 1, 1 , round(Vector.Length * pmt.frequency))
> 
> data$CASHFLOWS$ISIN <- append(
> data$CASHFLOWS$ISIN, rep(data[[1]][j],Vector.Length))
> 
> data$CASHFLOWS$CF <- append(
> data$CASHFLOWS$CF,
> as.numeric(
> c(rep((data[[4]][j]/100/pmt.frequency),Vector.Length-1) * min.principal,
> (min.principal + (data$COUPONRATE[j]/100/pmt.frequency)* min.principal))))
> 
> by.months = ifelse(data[[4]][j] == 0, round(difftime(
> data[[3]][j], rates.data[1,1])/days.in.month), 6)
> 
> data$CASHFLOWS$DATE <- append(
> data$CASHFLOW$DATE, seq(
> as.Date(data[[2]][j]) %m+% months(as.numeric(by.months)), as.Date(data[[3]][j]),
> by = as.character(paste(by.months, "months", sep = " "))))
> 
> } #The Loop Ends here and the list is made
> 
> data$TODAY <- as.Date(rates.data[1,1])
> TSInput[[as.character(rates.data[1,1])]] <- c(data)
> 
> #set term strucutre input (TSInput) to class couponbonds
> class(TSInput) <- "couponbonds"
> CashFlow <- TSInput[[1]]
> CIR.CF.Matrix <<- create_cashflows_matrix(TSInput[[1]], include_price = TRUE)
> CIR.Mat.Matrix <<- create_maturities_matrix(TSInput[[1]], include_price = TRUE )
> 
> #Objective function for the origin to be inaccessable the followign #condition must be met
> # 2 * kappa * theta <= sigma^2 CIRTune <- function(param = numeric(), shortrate = numeric(), sigma = sigma, cfmatrix =
> matrix(), matmatrix = matrix()){
> 
> kappa = param[1]
> theta = param[2]
> 
> FwdRate <- CIRSim(kappa = kappa,
> theta = theta,
> shortrate = Rates[1,2]/100,
> T = 30,
> step = 6/months.in.year,
> sigma = sigma,
> N = 1)
> 
> Spot <- cumprod(1+(FwdRate))
> t <- seq(1,length(Spot),1)
> Spot <- Spot^(1/t)
> #DiscMatrix <<- 1/(Spot^matmatrix)
> CIRTune <- sqrt((sum(colSums((cfmatrix * 1/(Spot^matmatrix)))^2))/ncol(matmatrix))
> return(CIRTune)
> }
> 
> # Fit the model to the market fit <- optimx(par = c(.1, .05), fn = CIRTune, method = "L-BFGS-B",
> lower = c(.1,.01),
> upper = c(.9, .2) , shortrate = shortrate,
> sigma = sigma,
> cfmatrix = CIR.CF.Matrix, matmatrix = CIR.Mat.Matrix)
> return(fit)
> }
> 
> 
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From vineethawarriyar.kod at ucalgary.ca  Mon Oct 17 21:38:22 2016
From: vineethawarriyar.kod at ucalgary.ca (Vineetha Warriyar Kodalore Vijayan)
Date: Mon, 17 Oct 2016 19:38:22 +0000
Subject: [R-pkg-devel] Makevar file issue.
Message-ID: <BY2PR01MB1781EFB228B951FF7C250C6E97D00@BY2PR01MB1781.prod.exchangelabs.com>

Dear R package developers,


I have developed an R package and its working locally on my system ( mac os x El Capitan, Xcode 7,  gfortran 6.1) with  ~/.R/Makevars. The Makevar file in the home directory contains:


F77 = gfortran

FC = gfortran

FLIBS = -L/usr/local/gfortran/lib


Now I'm trying to make this package portable. How can I move this dependent Makevar file into my src folder? I tried to move the same, but got an error saying


 * installing *source* package 'pkgname' ...
 ** libs
 gfortran-4.8  -fPIC -Wall -g -O2  -c  epidata.f95 -o epidata.o
 make: gfortran-4.8: No such file or directory
 make: *** [epidata.o] Error 1

I did go through the writing R extension manual, but with my limited knowledge I couldn't find any solution. Any help would be really appreciated.



Thanks,

Vineetha

	[[alternative HTML version deleted]]


From berryboessenkool at hotmail.com  Wed Oct 19 21:29:04 2016
From: berryboessenkool at hotmail.com (Berry Boessenkool)
Date: Wed, 19 Oct 2016 19:29:04 +0000
Subject: [R-pkg-devel] package in 'Suggests'
Message-ID: <DB5PR0401MB199048C6DDDFD14A119C462FD5D20@DB5PR0401MB1990.eurprd04.prod.outlook.com>


Hi,


A package I am developing will have one additional (not core) function depending on RCurl.
To keep dependencies low, I am considering to put RCurl in 'Suggests' instead of 'Imports'.
Also, I guess some users / systems may not have libcurl installed.

Then I would write something like
indexDWD <- function(...)
{
if(!requireNamespace("RCurl", quietly=TRUE))
  stop("The R package 'RCurl' is not available. indexDWD can not obtain file list.\n",
       "install.packages('RCurl')       to enable this.")
... # otherwise do some nice stuff with RCurl::getURL
}

Can /should I still have an example tested by CRAN? (I've seen \dontrun used in similar situations)
Or should CRAN check never depend on an ftp-server being accessible?

A package in 'Suggests' with conditional usage via requireNamespace should be fine:
https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Suggested-packages
Do you think it is advisable practice in this case?
Do you think my function should give a warning instead of an error and return an empty charstring or similar?

Thanks ahead for your ideas and thoughts!
Berry



	[[alternative HTML version deleted]]


From lbusett at gmail.com  Wed Oct 19 22:14:28 2016
From: lbusett at gmail.com (Lorenzo Busetto)
Date: Wed, 19 Oct 2016 22:14:28 +0200
Subject: [R-pkg-devel] Submitting to CRAN a package depending on RGtk2
Message-ID: <CAM1G4ST2hNFrEKW7jphkyAZ4Wt54goCMaNrTMcKDWHi3Du26VQ@mail.gmail.com>

Dear all, I am currently in the process of releasing this github
package on CRAN:

   https://github.com/lbusett/MODIStsp

   , but I am encountering some issues which I hope someone can help
me overcome. Sorry for the long message, but the problem is  difficult
to explain briefly.  Also, since this is my first CRAN release
attempt, please excuse me if I'm asking something obvious.

   The problem I'm having derives from the fact that I'm using package
`gWidgetsRGtk2` to create a GUI. However, `gWidgetsRGtk2` depends on
package `RGtk2`, which itself requires some external libraries to
work.

This leads to the following problems:

On Windows

   If I keep `gWidgetsRGtk2` in the dependency list of my package,
checking it in RStudio goes well. I get no NOTES nor WARNINGS
(provided I have all dependencies installed).

> R CMD check results  0 errors | 0 warnings | 0 notes  R CMD check
> succeeded

 Also `build_win` passes with no problems

 However, if I then try to install the package from github, and even
if `gWidgetsRGtk2` is already installed in my library, installation
fails.  For example:

    devtools::install_github("lbusett/MODIStsp", ref =
'feature/cran_rel_candidate')

 gives me the following error:

> Warning: Failed to load RGtk2 dynamic library, attempting to install
> it. Please install GTK+ from
> http://ftp.gnome.org/pub/gnome/binaries/win64/gtk+/2.22/gtk+-bundle_2.22.1-20101229_win64.zip
> If the package still does not load, please ensure that GTK+ is
> installed and that it is on your PATH environment variable IN ANY
> CASE, RESTART R BEFORE TRYING TO LOAD THE PACKAGE AGAIN Error in
> inDL(x, as.logical(local), as.logical(now), ...) :  unable to load
> shared object
> 'C:/Users/lb/Documents/R/win-library/3.3/RGtk2/libs/x64/RGtk2.dll':
> LoadLibrary failure:  Impossible to find.....

, and I get an information window telling me that "libaptk-1.0-0.dll"
is missing.

Pressing "ok" on the message sends me in an infinite loop of attempted
installations of `RGTk2` and I have to force-close RStudio.

The only way I managed to install the package correctly from github is by:

1)  Removing the `gWidgetsRGtk2` dependency from my package, and

2)  Asking users to install `gWidgetsRGtk2` beforehand and load it at
least once. At first loading of that package,  after the
"libaptk-1.0-0.dll is missing" message, this info panel opens,
allowing me to install GTK+ libraries. After installing, continuing my
pakages' installation goes well

So, for example, this:

    install.packages("gWidgetsRGtk2")
    library("gWidgetsRGtk2")
    # wait for install of GTK+
    install_github("lbusett/MODIStsp", ref = 'devel')   # (In devel,
'gWidgetsRGtk2'is not a dependency)

works with no issues.

Asking the user to install the ""offending package beforehand is no
big deal, but I don't know if that is admissible for a CRAN package,
also because checking the package after removing the dependency gives
me the following warning:

> checking dependencies in R code ... WARNING 'loadNamespace' or
> 'requireNamespace' call not declared from: ?gWidgetsRGtk2? R CMD check
> results 0 errors | 1 warning  | 0 notes
>
> R CMD check succeeded

So, in the end my question is:

Do you know if there is a way to solve this problem, or how should I
deal with it in the process of making a CRAN release ?


On Linux


  On Linux builds, the problem is related but a bit different.

 1. First of all, package "RGTk2" requires some external libraries to
be installed beforehand (Cairo >= 1.0.0, ATK >= 1.10.0, Pango >=
1.10.0, GTK+ >= 2.8.0, GLib >= 2.8.0). Also, for my package to work  I
need to have "gdal" installed on the target PC with hdf4 support.

Setting the following YAML file allows me to pass the checks on
TRAVIS-CI (https://travis-ci.org/lbusett/MODIStsp/builds/168603035):

>     language: r
>     cache: packages
>     warnings_are_errors: false
>     matrix:
>       include:
>         - os: linux
>           dist: trusty
>           sudo: required
>           env:
>           global:
>             - R_BUILD_ARGS=" "
>             - R_CHECK_ARGS="--no-build-vignettes --no-manual --timings"
>             - R_CHECK_TIMINGS_="0"
>             - BOOTSTRAP_LATEX="1"
>       addons:
>         apt:
>           packages:
>             - libgdal-dev
>             - libproj-dev
>             - libcurl4-openssl-dev
>             - libgtk-3-dev
>       r_binary_packages:
>         - cairoDevice
>         - RGtk2


however, what I don't know is if/how/where I should specify these kind
of dependencies for CRAN submission
. Can anyone explain this to me, or point me to some reference ?


2. The second problem is again related to `gWidgetsRGtk2` dependency.

If I keep the dependency in, the build fails with this message
(https://travis-ci.org/lbusett/MODIStsp/builds/168600394):

> installing *source* package ?gWidgetsRGtk2? ... package
> ?gWidgetsRGtk2? successfully unpacked and MD5 sums checked R inst
> tests preparing package for lazy loading R session is headless; GTK+
> not initialized. (R:15669): Gtk-WARNING **: gtk_disable_setlocale()
> must be called before gtk_init() Error : .onLoad failed in
> loadNamespace() for 'cairoDevice', details:
>
>   call: fun(libname, pkgname)   error: GDK display not found - please
> make sure X11 is running   Error : package ?cairoDevice? could not be
> loaded   ERROR: lazy loading failed for package ?gWidgetsRGtk2?
>
> removing ?/home/travis/R/Library/gWidgetsRGtk2?
>
> Error: Command failed (1)
>
> Execution halted
>
> The command "Rscript -e 'deps <-
> devtools::dev_package_deps(dependencies =
> NA);devtools::install_deps(dependencies = TRUE);if (!all(deps$package
> %in% installed.packages())) { message("missing: ",
> paste(setdiff(deps$package, installed.packages()), collapse=", "));
> q(status = 1, save = "no")}'" failed and exited with 1 during .


As in the Windows case, the problem disappears if I remove the
`gWidgetsRGtk2` dependency, ....but then I get the WARNING in
build/installation.   I don't hink however that it's the same problem:
here it seems that the fail depends on the fact that x11 is not
running on the "TRAVIS" machine (sorry if I don't make sense here, but
I am quite a TRAVIS/Linux newby..)

So, in the end, also in this case:  Can anyone suggest a way to solve
this before I start the submission process ?

Thanks in advance for any help ! (And thanks for bearing with me up to
the end of this novel.... )


From edd at debian.org  Wed Oct 19 22:33:02 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 19 Oct 2016 15:33:02 -0500
Subject: [R-pkg-devel] package in 'Suggests'
In-Reply-To: <DB5PR0401MB199048C6DDDFD14A119C462FD5D20@DB5PR0401MB1990.eurprd04.prod.outlook.com>
References: <DB5PR0401MB199048C6DDDFD14A119C462FD5D20@DB5PR0401MB1990.eurprd04.prod.outlook.com>
Message-ID: <22535.55422.671435.257114@max.nulle.part>


On 19 October 2016 at 19:29, Berry Boessenkool wrote:
| A package I am developing will have one additional (not core) function depending on RCurl.
| To keep dependencies low, I am considering to put RCurl in 'Suggests' instead of 'Imports'.
| Also, I guess some users / systems may not have libcurl installed.
| 
| Then I would write something like
| indexDWD <- function(...)
| {
| if(!requireNamespace("RCurl", quietly=TRUE))
|   stop("The R package 'RCurl' is not available. indexDWD can not obtain file list.\n",
|        "install.packages('RCurl')       to enable this.")
| ... # otherwise do some nice stuff with RCurl::getURL
| }
| 
| Can /should I still have an example tested by CRAN? (I've seen \dontrun used in similar situations)
| Or should CRAN check never depend on an ftp-server being accessible?

What you have is the correct approach: test _if the package can be loaded_
and if so, proceed.  Else skip the test.

Some just put packages in Suggests: and then still assume them be installed.
That's just wrong in my book, though not enforced as a fail by CRAN.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd at debian.org  Wed Oct 19 22:36:52 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 19 Oct 2016 15:36:52 -0500
Subject: [R-pkg-devel] Submitting to CRAN a package depending on RGtk2
In-Reply-To: <CAM1G4ST2hNFrEKW7jphkyAZ4Wt54goCMaNrTMcKDWHi3Du26VQ@mail.gmail.com>
References: <CAM1G4ST2hNFrEKW7jphkyAZ4Wt54goCMaNrTMcKDWHi3Du26VQ@mail.gmail.com>
Message-ID: <22535.55652.788548.218172@max.nulle.part>


For this subproblem:

On 19 October 2016 at 22:14, Lorenzo Busetto wrote:
|   On Linux builds, the problem is related but a bit different.
| 
|  1. First of all, package "RGTk2" requires some external libraries to

yu can just install r-cran-rgtk2 on your (Debian or Ubuntu) system and you
should be good.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From lbusett at gmail.com  Wed Oct 19 23:24:54 2016
From: lbusett at gmail.com (Lorenzo Busetto)
Date: Wed, 19 Oct 2016 23:24:54 +0200
Subject: [R-pkg-devel] Submitting to CRAN a package depending on RGtk2
In-Reply-To: <22535.55652.788548.218172@max.nulle.part>
References: <CAM1G4ST2hNFrEKW7jphkyAZ4Wt54goCMaNrTMcKDWHi3Du26VQ@mail.gmail.com>
	<22535.55652.788548.218172@max.nulle.part>
Message-ID: <CAM1G4STtRvub_CDFn5FfikC8_QKktMAR9aK9x_nQG7nPpLJOZg@mail.gmail.com>

Hi Dirk,

thanks for the answer. Yes, I know that that does the trick. In fact,
in our  github README we have
the following intructions:

"Install the following required dependencies:

Cairo >= 1.0.0, ATK >= 1.10.0, Pango >= 1.10.0, GTK+ >= 2.8.0, GLib >=
2.8.0 (required by package RGtk2)
Curl (required by package curl)
GDAL >= 1.6.3, PROJ.4 >= 4.4.9 (required by package rgdal)

On Debian and Ubuntu-based systems, to install those packages open a
terminal and type

sudo apt-get install r-cran-cairodevice r-cran-rgtk2
libcurl4-openssl-dev libgdal-dev libproj-dev  "

One of my questions here (maybe dumb), is how/where I should  specify
those dependencies when submitting to CRAN.
Is putting intructions like these in the readme of the package
sufficient, or do I need to do something else ? That's what I was
asking as first point of the "Linux" part of the previous post (sorry
if it was not clear).

Lorenzo

On 19 October 2016 at 22:36, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> For this subproblem:
>
> On 19 October 2016 at 22:14, Lorenzo Busetto wrote:
> |   On Linux builds, the problem is related but a bit different.
> |
> |  1. First of all, package "RGTk2" requires some external libraries to
>
> yu can just install r-cran-rgtk2 on your (Debian or Ubuntu) system and you
> should be good.
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd at debian.org  Wed Oct 19 23:37:35 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 19 Oct 2016 16:37:35 -0500
Subject: [R-pkg-devel] Submitting to CRAN a package depending on RGtk2
In-Reply-To: <CAM1G4STtRvub_CDFn5FfikC8_QKktMAR9aK9x_nQG7nPpLJOZg@mail.gmail.com>
References: <CAM1G4ST2hNFrEKW7jphkyAZ4Wt54goCMaNrTMcKDWHi3Du26VQ@mail.gmail.com>
	<22535.55652.788548.218172@max.nulle.part>
	<CAM1G4STtRvub_CDFn5FfikC8_QKktMAR9aK9x_nQG7nPpLJOZg@mail.gmail.com>
Message-ID: <22535.59295.576520.22897@max.nulle.part>


On 19 October 2016 at 23:24, Lorenzo Busetto wrote:
| thanks for the answer. Yes, I know that that does the trick. In fact,
| in our  github README we have
| the following intructions:
| 
| "Install the following required dependencies:
| 
| Cairo >= 1.0.0, ATK >= 1.10.0, Pango >= 1.10.0, GTK+ >= 2.8.0, GLib >=
| 2.8.0 (required by package RGtk2)
| Curl (required by package curl)
| GDAL >= 1.6.3, PROJ.4 >= 4.4.9 (required by package rgdal)
| 
| On Debian and Ubuntu-based systems, to install those packages open a
| terminal and type
| 
| sudo apt-get install r-cran-cairodevice r-cran-rgtk2
| libcurl4-openssl-dev libgdal-dev libproj-dev  "

That's pretty good for the README. And yes, you need those -dev package for gdal.
 
| One of my questions here (maybe dumb), is how/where I should  specify
| those dependencies when submitting to CRAN.
| Is putting intructions like these in the readme of the package
| sufficient, or do I need to do something else ? That's what I was
| asking as first point of the "Linux" part of the previous post (sorry
| if it was not clear).

The 'SystemRequirements:' field in DESCRIPTION is the usual spot.

You can then test in a script 'configure' (which can be a shell script) to
see if the packages are installed / useable / survive a test compilation.
Jeroen has a scheme for that in a few of his recent package; but his dislike
of autoconf makes that a little over the top.  Maybe you can just rely on
pkg-config to do most of the work for you? Ie a la

  edd at max:~$ pkg-config --exists gdal && echo "Yes"
  Yes
  edd at max:~$ pkg-config --modversion gdal
  1.11.3
  edd at max:~$


Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murdoch.duncan at gmail.com  Thu Oct 20 00:06:45 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 19 Oct 2016 18:06:45 -0400
Subject: [R-pkg-devel] Submitting to CRAN a package depending on RGtk2
In-Reply-To: <CAM1G4STtRvub_CDFn5FfikC8_QKktMAR9aK9x_nQG7nPpLJOZg@mail.gmail.com>
References: <CAM1G4ST2hNFrEKW7jphkyAZ4Wt54goCMaNrTMcKDWHi3Du26VQ@mail.gmail.com>
	<22535.55652.788548.218172@max.nulle.part>
	<CAM1G4STtRvub_CDFn5FfikC8_QKktMAR9aK9x_nQG7nPpLJOZg@mail.gmail.com>
Message-ID: <0fb4faca-1d52-34a2-b16a-e2bf4c7f1c98@gmail.com>

On 19/10/2016 5:24 PM, Lorenzo Busetto wrote:
> Hi Dirk,
>
> thanks for the answer. Yes, I know that that does the trick. In fact,
> in our  github README we have
> the following intructions:
>
> "Install the following required dependencies:
>
> Cairo >= 1.0.0, ATK >= 1.10.0, Pango >= 1.10.0, GTK+ >= 2.8.0, GLib >=
> 2.8.0 (required by package RGtk2)
> Curl (required by package curl)
> GDAL >= 1.6.3, PROJ.4 >= 4.4.9 (required by package rgdal)

In your DESCRIPTION file, skip the indirect dependencies.  Your package 
just needs to say it depends on RGtk2, curl, and rgdal (unless it also 
needs to link to those libs).  It is a good idea to give detailed 
instructions in a README file in the package though.

>
> On Debian and Ubuntu-based systems, to install those packages open a
> terminal and type
>
> sudo apt-get install r-cran-cairodevice r-cran-rgtk2
> libcurl4-openssl-dev libgdal-dev libproj-dev  "
>
> One of my questions here (maybe dumb), is how/where I should  specify
> those dependencies when submitting to CRAN.

As Dirk said, SystemRequirements:, but only for the direct dependencies. 
  List the R packages in Depends, Imports, etc.

> Is putting intructions like these in the readme of the package
> sufficient, or do I need to do something else ? That's what I was
> asking as first point of the "Linux" part of the previous post (sorry
> if it was not clear).

Try to give instructions for all 3 major platforms (and maybe a few 
variations within each):  Linux, Windows, OS X. If you can, add Solaris: 
  once you're accepted onto CRAN, you'll be tested there as well.

Duncan Murdoch

>
> Lorenzo
>
> On 19 October 2016 at 22:36, Dirk Eddelbuettel <edd at debian.org> wrote:
>>
>> For this subproblem:
>>
>> On 19 October 2016 at 22:14, Lorenzo Busetto wrote:
>> |   On Linux builds, the problem is related but a bit different.
>> |
>> |  1. First of all, package "RGTk2" requires some external libraries to
>>
>> yu can just install r-cran-rgtk2 on your (Debian or Ubuntu) system and you
>> should be good.
>>
>> Dirk
>>
>> --
>> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From murdoch.duncan at gmail.com  Thu Oct 20 00:11:28 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 19 Oct 2016 18:11:28 -0400
Subject: [R-pkg-devel] package in 'Suggests'
In-Reply-To: <22535.55422.671435.257114@max.nulle.part>
References: <DB5PR0401MB199048C6DDDFD14A119C462FD5D20@DB5PR0401MB1990.eurprd04.prod.outlook.com>
	<22535.55422.671435.257114@max.nulle.part>
Message-ID: <2f9cdb1f-c939-cfe8-0750-bbb766307e6a@gmail.com>

On 19/10/2016 4:33 PM, Dirk Eddelbuettel wrote:
>
> On 19 October 2016 at 19:29, Berry Boessenkool wrote:
> | A package I am developing will have one additional (not core) function depending on RCurl.
> | To keep dependencies low, I am considering to put RCurl in 'Suggests' instead of 'Imports'.
> | Also, I guess some users / systems may not have libcurl installed.
> |
> | Then I would write something like
> | indexDWD <- function(...)
> | {
> | if(!requireNamespace("RCurl", quietly=TRUE))
> |   stop("The R package 'RCurl' is not available. indexDWD can not obtain file list.\n",
> |        "install.packages('RCurl')       to enable this.")
> | ... # otherwise do some nice stuff with RCurl::getURL
> | }
> |
> | Can /should I still have an example tested by CRAN? (I've seen \dontrun used in similar situations)
> | Or should CRAN check never depend on an ftp-server being accessible?
>
> What you have is the correct approach: test _if the package can be loaded_
> and if so, proceed.  Else skip the test.
>
> Some just put packages in Suggests: and then still assume them be installed.
> That's just wrong in my book, though not enforced as a fail by CRAN.

It's officially wrong, but not in our current suite of tests.

I think there would be some discussions on what is acceptable if the 
suggested package is missing:  I'd argue an error is the right thing if 
there isn't an alternate way to give the right answer, but that kind of 
error shouldn't cause your package to fail to be accepted.  However, we 
don't do those tests, because we currently don't have the resources to 
do so.

Duncan Murdoch


From lbusett at gmail.com  Thu Oct 20 11:05:52 2016
From: lbusett at gmail.com (Lorenzo Busetto)
Date: Thu, 20 Oct 2016 11:05:52 +0200
Subject: [R-pkg-devel] Submitting to CRAN a package depending on RGtk2
In-Reply-To: <0fb4faca-1d52-34a2-b16a-e2bf4c7f1c98@gmail.com>
References: <CAM1G4ST2hNFrEKW7jphkyAZ4Wt54goCMaNrTMcKDWHi3Du26VQ@mail.gmail.com>
	<22535.55652.788548.218172@max.nulle.part>
	<CAM1G4STtRvub_CDFn5FfikC8_QKktMAR9aK9x_nQG7nPpLJOZg@mail.gmail.com>
	<0fb4faca-1d52-34a2-b16a-e2bf4c7f1c98@gmail.com>
Message-ID: <CAM1G4SQTokmG7ByLwGJxBMKpE3tR2q1EE-4Ev71iJ7eOD2X-iA@mail.gmail.com>

Hi Duncan and Dirk,

1)  First of all, thanks for your replies
?:
?y?
ou put me in the right direction. Although I have to study a bit to really
get the "syntax", looking into Jeroen github pages I was able to understand
?how the "configure" file is supposed to work. In practice, it is run while
attempting package install and allows detecting if required libraries are
available and suggests to install them otherwise, right ?

 I have to say that this is the only part where Hadley Wickham's excellent
"R packages" web page failed me a bit. Also, the "Configure and cleanup"
section of CRAN's "Writing extensions" manual isn't (overly) helpful for a
newby ;-)
? ?
)
(Note that this is don't meant to criticize - just to report a possible
issue others may also encounter).

I also have a (maybe stupid) question on this: in theory, I could write
this "configuration check" also as a "R" function which sends out "system"
commands if it detects a Linux environment (configuring the commands on the
basis of the detected distro), and call it if/when a function of my package
needing that library is called so that the user is prompted to fix his/her
configuration.
Would that be a "bad practice" ?

2) On a different topic related to my original post. Yesterday, I was
?(?
?hopefully)?
 able to solve the issue regarding
?"?
gWidgetsRGtk
?"?
installation on Windows by using the "pacman" package to avoid calls to
"requireNamespace".

In practice, in my "main" function (MODIStsp.R) *where before I had*:





* # On interactive execution, load Rgtk2  if (gui) {   # "gui" is a flag
specifying if we are running an "interactive" session
requireNamespace("gWidgetsRGtk2")    options("guiToolkit" = "RGtk2")  }*

*now I have:??*




















*if (gui) { # "gui" is a flag specifying if we are running an "interactive"
session     # Use p_exists to check if gWidgetsRGtk2 is installed    if
(!pacman::p_exists("gWidgetsRGtk2", local = TRUE)) {          # If not, ask
user to install it      message("Library 'gWidgetsRgtk2' is not installed.
It is required to run MODIStsp !               Do you want to install it
now ?", type = " y/n")      inst_gw <- readline()      if (inst_gw =="y") {
# If user selects "y", use "p_load" to install the package
pacman::p_load("gWidgetsRGtk2")      } else {       # If user selects "n",
send message and exit.              stop("MODIStsp can not work withouth
gWidgetsRGtk2 ! Exiting !")      }           }    options("guiToolkit" =
"RGtk2")  }*

In this way, I can:

1)
?R?
emove
??
gWidgetsRgtk2 from my dependencies, so that I get no WARNINGS while
checking the package
2)
?A?
void the problems related to GTK+ library installation that where
preventing install_github to complete properly
? if I had ?gWidgetsRgtk2 as a dependency?
.

I checked this both on Windows and Linux, and it works.

Although I know that this is a bit of hack, could this be a "viable"
solution ?


regards,

Lorenzo

On 20 October 2016 at 00:06, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 19/10/2016 5:24 PM, Lorenzo Busetto wrote:
>
>> Hi Dirk,
>>
>> thanks for the answer. Yes, I know that that does the trick. In fact,
>> in our  github README we have
>> the following intructions:
>>
>> "Install the following required dependencies:
>>
>> Cairo >= 1.0.0, ATK >= 1.10.0, Pango >= 1.10.0, GTK+ >= 2.8.0, GLib >=
>> 2.8.0 (required by package RGtk2)
>> Curl (required by package curl)
>> GDAL >= 1.6.3, PROJ.4 >= 4.4.9 (required by package rgdal)
>>
>
> In your DESCRIPTION file, skip the indirect dependencies.  Your package
> just needs to say it depends on RGtk2, curl, and rgdal (unless it also
> needs to link to those libs).  It is a good idea to give detailed
> instructions in a README file in the package though.
>
>
>> On Debian and Ubuntu-based systems, to install those packages open a
>> terminal and type
>>
>> sudo apt-get install r-cran-cairodevice r-cran-rgtk2
>> libcurl4-openssl-dev libgdal-dev libproj-dev  "
>>
>> One of my questions here (maybe dumb), is how/where I should  specify
>> those dependencies when submitting to CRAN.
>>
>
> As Dirk said, SystemRequirements:, but only for the direct dependencies.
> List the R packages in Depends, Imports, etc.
>
> Is putting intructions like these in the readme of the package
>> sufficient, or do I need to do something else ? That's what I was
>> asking as first point of the "Linux" part of the previous post (sorry
>> if it was not clear).
>>
>
> Try to give instructions for all 3 major platforms (and maybe a few
> variations within each):  Linux, Windows, OS X. If you can, add Solaris:
> once you're accepted onto CRAN, you'll be tested there as well.
>
> Duncan Murdoch
>
>
>> Lorenzo
>>
>> On 19 October 2016 at 22:36, Dirk Eddelbuettel <edd at debian.org> wrote:
>>
>>>
>>> For this subproblem:
>>>
>>> On 19 October 2016 at 22:14, Lorenzo Busetto wrote:
>>> |   On Linux builds, the problem is related but a bit different.
>>> |
>>> |  1. First of all, package "RGTk2" requires some external libraries to
>>>
>>> yu can just install r-cran-rgtk2 on your (Debian or Ubuntu) system and
>>> you
>>> should be good.
>>>
>>> Dirk
>>>
>>> --
>>> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>>
>

	[[alternative HTML version deleted]]


From david.c.sterratt at ed.ac.uk  Thu Oct 20 15:07:37 2016
From: david.c.sterratt at ed.ac.uk (David C Sterratt)
Date: Thu, 20 Oct 2016 14:07:37 +0100
Subject: [R-pkg-devel] package in 'Suggests'
Message-ID: <eyueg3b88p5.fsf@bonnington.inf.ed.ac.uk>

Dear Lorenzo,

For my "retistruct" package, which depends on gWidgets2RGtk2, I have
gWidgets2RGtk2, gWidgets2 and cairoDevice as "Suggests" and I put the
following code in the function that opens the GUI ('retistruct()' in
https://github.com/davidcsterratt/retistruct/blob/master/pkg/retistruct/R/retistruct-gui.R):

  guiToolkit <- "RGtk2"
  require.package <- function(pkg) {
    suggests<-tools::package.dependencies(installed.packages()["retistruct",], depLevel="Suggests")$retistruct
    suggests <- suggests[suggests[,1] == pkg]
    uptodate <- ifelse(is.na(suggests[2]),
                       TRUE,
                       eval(parse(text=paste("packageVersion(suggests[1])", suggests[2],  "suggests[3]"))))
    if (!require(pkg, character.only=TRUE) |
        !uptodate) {
      message(paste("Trying to install required package", pkg))
      install.packages(pkg)
      if (!require(pkg, character.only=TRUE)) {
        stop(paste("Could not install", pkg))
      }
    }
  }
  require.package(paste0("gWidgets2", guiToolkit))
  require.package("cairoDevice")
  options(guiToolkit=guiToolkit)


The package can work without a GUI, and may be installed on systems that
do not have GTK installed. There is user documentation on installing
RGtk2 which, if it's useful to you, you could of course copy:
http://retistruct.r-forge.r-project.org/retistruct-user-guide.pdf

Best wishes,

David.

--
David C Sterratt, Research Fellow - http://homepages.inf.ed.ac.uk/sterratt
Institute for Adaptive and Neural Computation     tel: +44 131 651 1739
School of Informatics, University of Edinburgh    fax: +44 131 650 6899
Informatics Forum, 10 Crichton Street, Edinburgh EH8 9AB, Scotland, UK

-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From edd at debian.org  Thu Oct 20 15:34:18 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 20 Oct 2016 08:34:18 -0500
Subject: [R-pkg-devel] Submitting to CRAN a package depending on RGtk2
In-Reply-To: <CAM1G4SQTokmG7ByLwGJxBMKpE3tR2q1EE-4Ev71iJ7eOD2X-iA@mail.gmail.com>
References: <CAM1G4ST2hNFrEKW7jphkyAZ4Wt54goCMaNrTMcKDWHi3Du26VQ@mail.gmail.com>
	<22535.55652.788548.218172@max.nulle.part>
	<CAM1G4STtRvub_CDFn5FfikC8_QKktMAR9aK9x_nQG7nPpLJOZg@mail.gmail.com>
	<0fb4faca-1d52-34a2-b16a-e2bf4c7f1c98@gmail.com>
	<CAM1G4SQTokmG7ByLwGJxBMKpE3tR2q1EE-4Ev71iJ7eOD2X-iA@mail.gmail.com>
Message-ID: <22536.51162.778290.98762@max.nulle.part>


Lorenzo,

Your mails are too long (at least for my attention span, and available time)
and very poorly formatted. Many of us read email in text-only terminals.

On 20 October 2016 at 11:05, Lorenzo Busetto wrote:
| I also have a (maybe stupid) question on this: in theory, I could write
| this "configuration check" also as a "R" function which sends out "system"
| commands if it detects a Linux environment (configuring the commands on the

No, just use

   Sys.info()[["sysname"]]

and see `help(Sys.info()`.  R can tell you a lot about the environment.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From lbusett at gmail.com  Thu Oct 20 22:14:42 2016
From: lbusett at gmail.com (Lorenzo Busetto)
Date: Thu, 20 Oct 2016 22:14:42 +0200
Subject: [R-pkg-devel] Submitting to CRAN a package depending on RGtk2
In-Reply-To: <22536.51162.778290.98762@max.nulle.part>
References: <CAM1G4ST2hNFrEKW7jphkyAZ4Wt54goCMaNrTMcKDWHi3Du26VQ@mail.gmail.com>
	<22535.55652.788548.218172@max.nulle.part>
	<CAM1G4STtRvub_CDFn5FfikC8_QKktMAR9aK9x_nQG7nPpLJOZg@mail.gmail.com>
	<0fb4faca-1d52-34a2-b16a-e2bf4c7f1c98@gmail.com>
	<CAM1G4SQTokmG7ByLwGJxBMKpE3tR2q1EE-4Ev71iJ7eOD2X-iA@mail.gmail.com>
	<22536.51162.778290.98762@max.nulle.part>
Message-ID: <CAM1G4SSS4QuMYda7Bgc+hr+uuankfNZAeBLs5EftaAbfbNiGMw@mail.gmail.com>

Ok. Duly noted. I'll  be more concise and avoid even simple formatting
(seems italics broke my last post to pieces). I'll try again.

My main problem is that, if I have "gWidgetRGtk2" as an imported package,
installation on Windows from github crashes RStudio while trying to install
GTK+ libraries (although I have no ERRORS nor WARNINGS in R CMD check).

If I remove the dependency and ask users to install  "gWidgetsRGtk2"
beforehand (which doesn't crash) I obviously get this WARNING:

> checking dependencies in R code ... WARNING 'loadNamespace' or
'requireNamespace' call not declared from: ?gWidgetsRGtk2?

I found out I can avoid both problems  using the "pacman" package in my
Main:

> if (!pacman::p_exists("gWidgetsRGtk2", local = TRUE))
{pacman::p_load("gWidgetsRGtk2")}

In this way,  ?gWidgetsRGtk2? is  installed only at first execution of my
Main, and I'm up and running.

Is this a viable solution (clearly, provided I ask permission to the user
before installing with p_load)   ?

Thanks in advance,

Lorenzo

PS: better ?


On 20 October 2016 at 15:34, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> Lorenzo,
>
> Your mails are too long (at least for my attention span, and available
> time)
> and very poorly formatted. Many of us read email in text-only terminals.
>
> On 20 October 2016 at 11:05, Lorenzo Busetto wrote:
> | I also have a (maybe stupid) question on this: in theory, I could write
> | this "configuration check" also as a "R" function which sends out
> "system"
> | commands if it detects a Linux environment (configuring the commands on
> the
>
> No, just use
>
>    Sys.info()[["sysname"]]
>
> and see `help(Sys.info()`.  R can tell you a lot about the environment.
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Fri Oct 21 00:59:57 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 20 Oct 2016 18:59:57 -0400
Subject: [R-pkg-devel] Submitting to CRAN a package depending on RGtk2
In-Reply-To: <CAM1G4SSS4QuMYda7Bgc+hr+uuankfNZAeBLs5EftaAbfbNiGMw@mail.gmail.com>
References: <CAM1G4ST2hNFrEKW7jphkyAZ4Wt54goCMaNrTMcKDWHi3Du26VQ@mail.gmail.com>
	<22535.55652.788548.218172@max.nulle.part>
	<CAM1G4STtRvub_CDFn5FfikC8_QKktMAR9aK9x_nQG7nPpLJOZg@mail.gmail.com>
	<0fb4faca-1d52-34a2-b16a-e2bf4c7f1c98@gmail.com>
	<CAM1G4SQTokmG7ByLwGJxBMKpE3tR2q1EE-4Ev71iJ7eOD2X-iA@mail.gmail.com>
	<22536.51162.778290.98762@max.nulle.part>
	<CAM1G4SSS4QuMYda7Bgc+hr+uuankfNZAeBLs5EftaAbfbNiGMw@mail.gmail.com>
Message-ID: <e288f935-acd4-e1cf-e748-21071d714a24@gmail.com>

On 20/10/2016 4:14 PM, Lorenzo Busetto wrote:
> Ok. Duly noted. I'll  be more concise and avoid even simple formatting
> (seems italics broke my last post to pieces). I'll try again.
>
> My main problem is that, if I have "gWidgetRGtk2" as an imported package,
> installation on Windows from github crashes RStudio while trying to install
> GTK+ libraries (although I have no ERRORS nor WARNINGS in R CMD check).
>
> If I remove the dependency and ask users to install  "gWidgetsRGtk2"
> beforehand (which doesn't crash) I obviously get this WARNING:
>
>> checking dependencies in R code ... WARNING 'loadNamespace' or
> 'requireNamespace' call not declared from: ?gWidgetsRGtk2?
>
> I found out I can avoid both problems  using the "pacman" package in my
> Main:
>
>> if (!pacman::p_exists("gWidgetsRGtk2", local = TRUE))
> {pacman::p_load("gWidgetsRGtk2")}
>
> In this way,  ?gWidgetsRGtk2? is  installed only at first execution of my
> Main, and I'm up and running.
>
> Is this a viable solution (clearly, provided I ask permission to the user
> before installing with p_load)   ?
>

No, it wouldn't be acceptable on CRAN.  You need to declare your 
dependencies.

It sounds as though there's a bug somewhere, in R, RStudio, 
gWidgetRGtk2, or Windows.  You're in the unenviable position of having 
to find and fix it.  (CRAN won't care if this only affects RStudio, and 
you might get away with an install that doesn't support Windows.)

Duncan Murdoch

> Thanks in advance,
>
> Lorenzo
>
> PS: better ?
>
>
> On 20 October 2016 at 15:34, Dirk Eddelbuettel <edd at debian.org> wrote:
>
>>
>> Lorenzo,
>>
>> Your mails are too long (at least for my attention span, and available
>> time)
>> and very poorly formatted. Many of us read email in text-only terminals.
>>
>> On 20 October 2016 at 11:05, Lorenzo Busetto wrote:
>> | I also have a (maybe stupid) question on this: in theory, I could write
>> | this "configuration check" also as a "R" function which sends out
>> "system"
>> | commands if it detects a Linux environment (configuring the commands on
>> the
>>
>> No, just use
>>
>>    Sys.info()[["sysname"]]
>>
>> and see `help(Sys.info()`.  R can tell you a lot about the environment.
>>
>> Dirk
>>
>> --
>> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From edd at debian.org  Fri Oct 21 02:22:49 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 20 Oct 2016 19:22:49 -0500
Subject: [R-pkg-devel] Submitting to CRAN a package depending on RGtk2
In-Reply-To: <e288f935-acd4-e1cf-e748-21071d714a24@gmail.com>
References: <CAM1G4ST2hNFrEKW7jphkyAZ4Wt54goCMaNrTMcKDWHi3Du26VQ@mail.gmail.com>
	<22535.55652.788548.218172@max.nulle.part>
	<CAM1G4STtRvub_CDFn5FfikC8_QKktMAR9aK9x_nQG7nPpLJOZg@mail.gmail.com>
	<0fb4faca-1d52-34a2-b16a-e2bf4c7f1c98@gmail.com>
	<CAM1G4SQTokmG7ByLwGJxBMKpE3tR2q1EE-4Ev71iJ7eOD2X-iA@mail.gmail.com>
	<22536.51162.778290.98762@max.nulle.part>
	<CAM1G4SSS4QuMYda7Bgc+hr+uuankfNZAeBLs5EftaAbfbNiGMw@mail.gmail.com>
	<e288f935-acd4-e1cf-e748-21071d714a24@gmail.com>
Message-ID: <22537.24537.585825.529637@max.nulle.part>


On 20 October 2016 at 18:59, Duncan Murdoch wrote:
| No, it wouldn't be acceptable on CRAN.  You need to declare your 
| dependencies.
| 
| It sounds as though there's a bug somewhere, in R, RStudio, 
| gWidgetRGtk2, or Windows.  You're in the unenviable position of having 
| to find and fix it.  (CRAN won't care if this only affects RStudio, and 
| you might get away with an install that doesn't support Windows.)

I usually suspect threading, which is tricky / impossible to fix.  RStudio
needs it (as it is a GUI), and so does RGtk2.  IIRC we have had similar
issues with tcltk as well as with some of task parallelizers.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From bob at rud.is  Fri Oct 21 16:48:43 2016
From: bob at rud.is (Bob Rudis)
Date: Fri, 21 Oct 2016 10:48:43 -0400
Subject: [R-pkg-devel] New libcurl coming / question for pkg authors
Message-ID: <CAA-FpKV92anyHTG8obV1ESFTog=LZ2n4fV1JyAhKE8QR7+VJqQ@mail.gmail.com>

(didn't know where else to post this, but pkg authors seemed to be a
good group to run this by)

Some folks may know I work in cybersecurity and my org's been talking
with the curl/libcurl community regarding:
https://curl.haxx.se/mail/lib-2016-10/0076.html

TLDR: there's a new libcurl/curl coming out in early November which
contains a number of serious security fixes (which you'll have to wait
until they disclose them publicly to know, unfortunately).

There are an ever increasing number of orgs/users who work with pkgs &
their own code that rely on the curl & RCurl pkgs and it is really
going to be in their best interest to upgrade curl/libcurl and rebuild
the pkgs, especially if they run them in a server (e.g. Shiny, model
feature generation, automated scraping) context.

I don't use Windows regularly, but IIRC CRAN builds binaries for both
RCurl & curl that are either statically linked to libcurl or bundle
the shared library. I don't remember if that's true for macOS binaries
(I tend to build my envs from verified source for various paranoid
reasons).

My q is that how do we [widespread] encourage/inform users to upgrade
libcurl and re-install the pkgs?

I can (and will) be sending the R Core folks a note (tho they are all
prbly on here) when the new code is released, but there are many folks
who won't even see this and who really should upgrade.

Most processes involving R & libcurl/curl aren't going to be directly
attacked or susceptible, but we've (my org) has been informed that
these are going to be some pretty critical vulns (again, I can't talk
more abt it) and most R users aren't going to be watching for vulns in
this context, so I'm just trying to figure out the best way to get the
word out the largest R audience. I'll be posting something on
R-bloggers after the release, but I'm hoping others can help get the
word out as well.

thx,

-Bob


From lbusett at gmail.com  Sat Oct 22 16:02:39 2016
From: lbusett at gmail.com (Lorenzo Busetto)
Date: Sat, 22 Oct 2016 16:02:39 +0200
Subject: [R-pkg-devel] Submitting to CRAN a package depending on RGtk2
In-Reply-To: <22537.24537.585825.529637@max.nulle.part>
References: <CAM1G4ST2hNFrEKW7jphkyAZ4Wt54goCMaNrTMcKDWHi3Du26VQ@mail.gmail.com>
	<22535.55652.788548.218172@max.nulle.part>
	<CAM1G4STtRvub_CDFn5FfikC8_QKktMAR9aK9x_nQG7nPpLJOZg@mail.gmail.com>
	<0fb4faca-1d52-34a2-b16a-e2bf4c7f1c98@gmail.com>
	<CAM1G4SQTokmG7ByLwGJxBMKpE3tR2q1EE-4Ev71iJ7eOD2X-iA@mail.gmail.com>
	<22536.51162.778290.98762@max.nulle.part>
	<CAM1G4SSS4QuMYda7Bgc+hr+uuankfNZAeBLs5EftaAbfbNiGMw@mail.gmail.com>
	<e288f935-acd4-e1cf-e748-21071d714a24@gmail.com>
	<22537.24537.585825.529637@max.nulle.part>
Message-ID: <CAM1G4SRmhrZa2fa9YK2RmDtEVwy_efZSN=pBo1sCmbKpAWq81Q@mail.gmail.com>

After digging some more: the problem is related to installation of RGtk2,
and in particular on failing to load RGtk2.ddl . Looking at build logs, I
get this error (which is repeated N times until install crashes):

> Error in inDL(x, as.logical(local), as.logical(now), ...) :
> unable to load shared object
'C:/Users/LB_laptop/AppData/Local/Temp/RtmpO6FfXa/RLIBS_d981e3e76b6/RGtk2/libs/i386/RGtk2.dll':
> LoadLibrary failure:  The specified module could not be found.
>
> Warning: Failed to load RGtk2 dynamic library, attempting to install it.
> Please install GTK+ from
http://ftp.gnome.org/pub/gnome/binaries/win32/gtk+/2.22/gtk+-bundle_2.22.1-20101227_win32.zip
> If the package still does not load, please ensure that GTK+ is installed
and that it is on your PATH environment variable
> IN ANY CASE, RESTART R BEFORE TRYING TO LOAD THE PACKAGE AGAIN
> Error in inDL(x, as.logical(local), as.logical(now), ...) :
> unable to load shared object
'C:/Users/LB_laptop/AppData/Local/Temp/RtmpO6FfXa/RLIBS_d981e3e76b6/RGtk2/libs/i386/RGtk2.dll':
> LoadLibrary failure:  The specified module could not be found.

The baffling thing is that I have this error if I do the check on my
machine or from github, while sending to CRAN with build_win succeds (see
log at the bottom). My understanding is that on CRAN testing machines GTK+
is already present/configured, so that the library doesn't need to be
installed/found ( However,  trying to install GTK+ beforehand and setting
the PATH variable as suggested in the error message doesn't change anything)

Looking at other packages with the same dependencies shows that this is  a
common issue: for example, package "fit4NM" installs correctly from CRAN,
but if I download it on my machine and check from RStudio,  R CMD check
fails in the same way.

A workaround I found looking at other packages and allows me to keep both
RStudio and build_win  working is to keep gWidgetsRGtk2 as a "Suggested"
package instead than as an Import, and ask users to install at first
"interactive" execution.

So, if I may ask, would you have any suggestions in this case ?

Lorenzo


------ build_win LOG follows () -------

* using log directory 'd:/RCompile/CRANguest/R-devel/MODIStsp.Rcheck'
* using R Under development (unstable) (2016-10-22 r71558)
* using platform: x86_64-w64-mingw32 (64-bit)
* using session charset: ISO8859-1
* checking for file 'MODIStsp/DESCRIPTION' ... OK
* checking extension type ... Package
* this is package 'MODIStsp' version '1.2.2'
* checking CRAN incoming feasibility ... NOTE
Maintainer: 'Lorenzo Busetto <busetto.l at irea.cnr.it>'

New submission

Possibly mis-spelled words in DESCRIPTION:
  HDF (14:27)
  MODIS (3:19, 10:84, 12:19, 14:21, 15:64, 20:64)
  Preprocessing (2:48)
  Reflectance (16:21)
  mosaicking (11:73)
  preprocessing (11:35)
  rasters (10:63)
  reflectance (16:103)
  reprojection (11:85)
  resize (12:9)

Found the following (possibly) invalid URLs:
  URL: http://cran.r-project.org
    From: README.md
    Status: 200
    Message: OK
    CRAN URL not in canonical form
  A canonical CRAN URL starts with https://CRAN.R-project.org/

The Date field is over a month old.
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for hidden files and directories ... NOTE
Found the following hidden files and directories:
  .json
These were most likely included in error. See section 'Package
structure' in the 'Writing R Extensions' manual.

CRAN-pack does not know about
  .json
* checking for portable file names ... OK
* checking whether package 'MODIStsp' can be installed ... OK
* checking installed package size ... OK
* checking package directory ... OK
* checking 'build' directory ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... NOTE
Non-standard file/directory found at top level:
  'try_configure_'
* checking for left-over files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* loading checks for arch 'i386'
** checking whether the package can be loaded ... OK
** checking whether the package can be loaded with stated dependencies ... OK
** checking whether the package can be unloaded cleanly ... OK
** checking whether the namespace can be loaded with stated dependencies ... OK
** checking whether the namespace can be unloaded cleanly ... OK
** checking loading without being on the library search path ... OK
** checking use of S3 registration ... OK
* loading checks for arch 'x64'
** checking whether the package can be loaded ... OK
** checking whether the package can be loaded with stated dependencies ... OK
** checking whether the package can be unloaded cleanly ... OK
** checking whether the namespace can be loaded with stated dependencies ... OK
** checking whether the namespace can be unloaded cleanly ... OK
** checking loading without being on the library search path ... OK
** checking use of S3 registration ... OK
* checking dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... OK
* checking Rd files ... OK
* checking Rd metadata ... OK
* checking Rd line widths ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* checking Rd contents ... OK
* checking for unstated dependencies in examples ... OK
* checking sizes of PDF files under 'inst/doc' ... WARNING
  'gs+qpdf' made some significant size reductions:
     compacted 'MODIStsp.pdf' from 690Kb to 366Kb
  consider running tools::compactPDF(gs_quality = "ebook") on these files
* checking installed files from 'inst/doc' ... OK
* checking files in 'vignettes' ... OK
* checking examples ...
** running examples for arch 'i386' ... [3s] OK
** running examples for arch 'x64' ... [3s] OK
* checking for unstated dependencies in vignettes ... OK
* checking package vignettes in 'inst/doc' ... OK
* checking re-building of vignette outputs ... [26s] OK
* checking PDF version of manual ... OK
* DONE
Status: 1 WARNING, 3 NOTEs


On 21 October 2016 at 02:22, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 20 October 2016 at 18:59, Duncan Murdoch wrote:
> | No, it wouldn't be acceptable on CRAN.  You need to declare your
> | dependencies.
> |
> | It sounds as though there's a bug somewhere, in R, RStudio,
> | gWidgetRGtk2, or Windows.  You're in the unenviable position of having
> | to find and fix it.  (CRAN won't care if this only affects RStudio, and
> | you might get away with an install that doesn't support Windows.)
>
> I usually suspect threading, which is tricky / impossible to fix.  RStudio
> needs it (as it is a GUI), and so does RGtk2.  IIRC we have had similar
> issues with tcltk as well as with some of task parallelizers.
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From jeroen.ooms at stat.ucla.edu  Sun Oct 23 15:08:51 2016
From: jeroen.ooms at stat.ucla.edu (Jeroen Ooms)
Date: Sun, 23 Oct 2016 15:08:51 +0200
Subject: [R-pkg-devel] New libcurl coming / question for pkg authors
In-Reply-To: <CAA-FpKV92anyHTG8obV1ESFTog=LZ2n4fV1JyAhKE8QR7+VJqQ@mail.gmail.com>
References: <CAA-FpKV92anyHTG8obV1ESFTog=LZ2n4fV1JyAhKE8QR7+VJqQ@mail.gmail.com>
Message-ID: <CABFfbXvYTUCTE4-Dmr7UgfUX3Lep+8aiXm2W2iyZbmGzM-j_CQ@mail.gmail.com>

Thanks for the heads-up.

What are the type of attacks that you expect R users might be affected
by? Most problems discussed on the libcurl mailing lists are local
vulnerabilities. E.g. an out-of-bounds read or buffer overflow exploit
doesn't do anything that can easily be done from R itself?

I guess the worst case scenario would be if a server can trigger a
remote code execution by sending a specially crafted payload or so.
I'll keep my eyes open for that.

The macOS binaries are dynamically linked, so they will be fixed when
Apple pushes out an update for libcurl.dylib. On Windows we would need
to a rebuild.

AFAIK, R based services like shiny rely on mandatory access control
and explicitly assume remote code execution by the client is
possible/allowed. Assuming anything else would be silly, code
execution can be triggered anywhere in R, you really don't need an
exploit for that :-)

More generally, I wonder how useful it is to keep external C libraries
to high security standards while code from CRAN binding to those
libraries is not reviewed at all. In practice there are probably more
vulnerabilities in the C code for the 'curl' package than libcurl
itself.

It would be really interested having a broad discussion outlining the
most imminent threats for R users. I wrote a paper [1] about security
in R a few years back highlighting some issues, but not many people
seemed to bother. Perhaps that has changed.


[1] http://dx.doi.org/10.18637/jss.v055.i07

Jeroen




On Fri, Oct 21, 2016 at 4:48 PM, Bob Rudis <bob at rud.is> wrote:
> (didn't know where else to post this, but pkg authors seemed to be a
> good group to run this by)
>
> Some folks may know I work in cybersecurity and my org's been talking
> with the curl/libcurl community regarding:
> https://curl.haxx.se/mail/lib-2016-10/0076.html
>
> TLDR: there's a new libcurl/curl coming out in early November which
> contains a number of serious security fixes (which you'll have to wait
> until they disclose them publicly to know, unfortunately).
>
> There are an ever increasing number of orgs/users who work with pkgs &
> their own code that rely on the curl & RCurl pkgs and it is really
> going to be in their best interest to upgrade curl/libcurl and rebuild
> the pkgs, especially if they run them in a server (e.g. Shiny, model
> feature generation, automated scraping) context.
>
> I don't use Windows regularly, but IIRC CRAN builds binaries for both
> RCurl & curl that are either statically linked to libcurl or bundle
> the shared library. I don't remember if that's true for macOS binaries
> (I tend to build my envs from verified source for various paranoid
> reasons).
>
> My q is that how do we [widespread] encourage/inform users to upgrade
> libcurl and re-install the pkgs?
>
> I can (and will) be sending the R Core folks a note (tho they are all
> prbly on here) when the new code is released, but there are many folks
> who won't even see this and who really should upgrade.
>
> Most processes involving R & libcurl/curl aren't going to be directly
> attacked or susceptible, but we've (my org) has been informed that
> these are going to be some pretty critical vulns (again, I can't talk
> more abt it) and most R users aren't going to be watching for vulns in
> this context, so I'm just trying to figure out the best way to get the
> word out the largest R audience. I'll be posting something on
> R-bloggers after the release, but I'm hoping others can help get the
> word out as well.
>
> thx,
>
> -Bob
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From pavel at uow.edu.au  Fri Oct 21 09:39:17 2016
From: pavel at uow.edu.au (Pavel N. Krivitsky)
Date: Fri, 21 Oct 2016 18:39:17 +1100
Subject: [R-pkg-devel] Only printing a message once per top-level call.
Message-ID: <1477035557.27771.38.camel@uow.edu.au>

Dear All,

I have a package (ergm, in case you are wondering) that has some low-
level routines (say, low()) that produce messages that the end-user
needs to see and that tend to be called multiple times for every time
the top-level routine (say, high()) is called, often by other routines
that are top-level routines themselves.

What I'd like to do to have the low-level routine print the message the
first time it's called for a given top-level call, and then "remember"
and stay silent the next time to avoid spamming the end-user.

In other words,
   1. high()
      1. low()
         1. print message
      2. low()
         1. don't print message
      3. high()
         1. low()
            1. don't print message
   2. high()
      1. low()
         1. print message

One way to do that that I can see is to use local() to create a
blacklist of messages that have already been printed, which get cleared
every time the top-level call exists. I.e.,
   1. Use local() with a list of messages printed so far and a status of
      "active" or "inactive" (the initial state), which returns  a
      function that can query and update both of those.
   2. When high() is called, it first checks if the blacklist is active.?
      1. If it's active, then this high() must have been called from
         another high(), so it leaves the blacklist alone.
      2. If it's inactive, then it must be the top-level call, so it sets
         it to active and sets an on.exit() handler to clear the blacklist
         and set it to inactive.
   3. When low() wants to print a message, it queries the blacklist to see
      if it's already printed it. If not, it prints and adds it to the
      list.
   4. When the top-level high() finishes, the blacklist is cleared and set
      to inactive.

However, I wonder if there already is a way to do that, ideally built
in.

					Any thoughts?
					Pavel



-- 
Pavel Krivitsky
Lecturer in Statistics
National Institute of Applied Statistics Research Australia (NIASRA)
School of Mathematics and Applied Statistics | Building 39C Room 154
University of Wollongong NSW 2522 Australia
T +61 2 4221 3713
Web (NIASRA): http://niasra.uow.edu.au/index.html
Web (Personal): http://www.krivitsky.net/research
ORCID: 0000-0002-9101-3362

NOTICE: This email is intended for the addressee named and may contain
confidential information. If you are not the intended recipient, please
delete it and notify the sender. Please consider the environment before
printing this email.


From wdunlap at tibco.com  Mon Oct 24 18:11:29 2016
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 24 Oct 2016 09:11:29 -0700
Subject: [R-pkg-devel] Only printing a message once per top-level call.
In-Reply-To: <1477035557.27771.38.camel@uow.edu.au>
References: <1477035557.27771.38.camel@uow.edu.au>
Message-ID: <CAF8bMcaghDRtx5=Vy3ZgR8gLyaEq2e9LjWHFC=-X87O7diKHPQ@mail.gmail.com>

This is not a complete answer to your problem, but here is an example of
how to make and store messages of a certain class, "lowMessage", and later
print a table of the messages and their counts.

> lowMessage <- function(text, call = sys.call(-1))
   {
       # make a message of class "lowMessage"
       text <- sub("([^\n])$", "\\1\n", text)
       msg <- simpleMessage(text, call = call)
       class(msg) <- c("lowMessage", class(msg))
       message(msg)
   }

> handleLowMessages <- function(expr, call = sys.call(-1))
   {
       # store up lowMessages generated while evaluating 'expr'
       # and print a table of them when 'expr' has completed.
       # Returrn value of 'expr'.
       msgEnvir <- new.env()
       on.exit({
           lapply(names(msgEnvir), function(msg) message(msg, " (",
msgEnvir[[msg]], " times)"))
       })
       withCallingHandlers(expr, lowMessage = function(e)
       {
           text <- sub("\n$", "", conditionMessage(e))
           if (is.null(msgEnvir[[text]])) {
               msgEnvir[[text]] <- 1
           } else {
               msgEnvir[[text]] <- msgEnvir[[text]] + 1
           }
           invokeRestart("muffleMessage")
       })
   }

> low1 <- function(x) { lowMessage("using low1") ; x + 1 }

> low2 <- function(x) { lowMessage("using low2") ; x - 1 }

> high <- function(x, n1=3, n2=5) {
       for(i in seq_len(n1)) x <- low1(x)
       for(i in seq_len(n2)) x <- low2(x)
       x
   }

> high(10, 4, 7) # don't use the handler
using low1
using low1
using low1
using low1
using low2
using low2
using low2
using low2
using low2
using low2
using low2
[1] 7

> handleLowMessages(high(10, 4, 7))
using low1 (4 times)
using low2 (7 times)
[1] 7

> handleLowMessages(for(i in 1:3)high(i, 2, 8))
using low1 (6 times)
using low2 (24 times)


Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Fri, Oct 21, 2016 at 12:39 AM, Pavel N. Krivitsky <pavel at uow.edu.au>
wrote:

> Dear All,
>
> I have a package (ergm, in case you are wondering) that has some low-
> level routines (say, low()) that produce messages that the end-user
> needs to see and that tend to be called multiple times for every time
> the top-level routine (say, high()) is called, often by other routines
> that are top-level routines themselves.
>
> What I'd like to do to have the low-level routine print the message the
> first time it's called for a given top-level call, and then "remember"
> and stay silent the next time to avoid spamming the end-user.
>
> In other words,
>    1. high()
>       1. low()
>          1. print message
>       2. low()
>          1. don't print message
>       3. high()
>          1. low()
>             1. don't print message
>    2. high()
>       1. low()
>          1. print message
>
> One way to do that that I can see is to use local() to create a
> blacklist of messages that have already been printed, which get cleared
> every time the top-level call exists. I.e.,
>    1. Use local() with a list of messages printed so far and a status of
>       "active" or "inactive" (the initial state), which returns  a
>       function that can query and update both of those.
>    2. When high() is called, it first checks if the blacklist is active.
>       1. If it's active, then this high() must have been called from
>          another high(), so it leaves the blacklist alone.
>       2. If it's inactive, then it must be the top-level call, so it sets
>          it to active and sets an on.exit() handler to clear the blacklist
>          and set it to inactive.
>    3. When low() wants to print a message, it queries the blacklist to see
>       if it's already printed it. If not, it prints and adds it to the
>       list.
>    4. When the top-level high() finishes, the blacklist is cleared and set
>       to inactive.
>
> However, I wonder if there already is a way to do that, ideally built
> in.
>
>                                         Any thoughts?
>                                         Pavel
>
>
>
> --
> Pavel Krivitsky
> Lecturer in Statistics
> National Institute of Applied Statistics Research Australia (NIASRA)
> School of Mathematics and Applied Statistics | Building 39C Room 154
> University of Wollongong NSW 2522 Australia
> T +61 2 4221 3713
> Web (NIASRA): http://niasra.uow.edu.au/index.html
> Web (Personal): http://www.krivitsky.net/research
> ORCID: 0000-0002-9101-3362
>
> NOTICE: This email is intended for the addressee named and may contain
> confidential information. If you are not the intended recipient, please
> delete it and notify the sender. Please consider the environment before
> printing this email.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From nfultz at gmail.com  Mon Oct 24 18:12:35 2016
From: nfultz at gmail.com (Neal Fultz)
Date: Mon, 24 Oct 2016 09:12:35 -0700
Subject: [R-pkg-devel] Only printing a message once per top-level call.
In-Reply-To: <1477035557.27771.38.camel@uow.edu.au>
References: <1477035557.27771.38.camel@uow.edu.au>
Message-ID: <CAL9B2vdexpjuiq3qskz=4nuUUxSM49mPQg8+6DidoMzXF1qL3A@mail.gmail.com>

I would point you at last.warning, but also note that it says this in
?warnings:

Warning:

     It is undocumented where 'last.warning' is stored nor that it is
     visible, and this is subject to change.


But it does seem like you could test if your warning was already in there, eg


mywarningstring %in% names(last.warnings)



On Fri, Oct 21, 2016 at 12:39 AM, Pavel N. Krivitsky <pavel at uow.edu.au>
wrote:

> Dear All,
>
> I have a package (ergm, in case you are wondering) that has some low-
> level routines (say, low()) that produce messages that the end-user
> needs to see and that tend to be called multiple times for every time
> the top-level routine (say, high()) is called, often by other routines
> that are top-level routines themselves.
>
> What I'd like to do to have the low-level routine print the message the
> first time it's called for a given top-level call, and then "remember"
> and stay silent the next time to avoid spamming the end-user.
>
> In other words,
>    1. high()
>       1. low()
>          1. print message
>       2. low()
>          1. don't print message
>       3. high()
>          1. low()
>             1. don't print message
>    2. high()
>       1. low()
>          1. print message
>
> One way to do that that I can see is to use local() to create a
> blacklist of messages that have already been printed, which get cleared
> every time the top-level call exists. I.e.,
>    1. Use local() with a list of messages printed so far and a status of
>       "active" or "inactive" (the initial state), which returns  a
>       function that can query and update both of those.
>    2. When high() is called, it first checks if the blacklist is active.
>       1. If it's active, then this high() must have been called from
>          another high(), so it leaves the blacklist alone.
>       2. If it's inactive, then it must be the top-level call, so it sets
>          it to active and sets an on.exit() handler to clear the blacklist
>          and set it to inactive.
>    3. When low() wants to print a message, it queries the blacklist to see
>       if it's already printed it. If not, it prints and adds it to the
>       list.
>    4. When the top-level high() finishes, the blacklist is cleared and set
>       to inactive.
>
> However, I wonder if there already is a way to do that, ideally built
> in.
>
>                                         Any thoughts?
>                                         Pavel
>
>
>
> --
> Pavel Krivitsky
> Lecturer in Statistics
> National Institute of Applied Statistics Research Australia (NIASRA)
> School of Mathematics and Applied Statistics | Building 39C Room 154
> University of Wollongong NSW 2522 Australia
> T +61 2 4221 3713
> Web (NIASRA): http://niasra.uow.edu.au/index.html
> Web (Personal): http://www.krivitsky.net/research
> ORCID: 0000-0002-9101-3362
>
> NOTICE: This email is intended for the addressee named and may contain
> confidential information. If you are not the intended recipient, please
> delete it and notify the sender. Please consider the environment before
> printing this email.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From glennmschultz at me.com  Thu Oct 27 16:05:30 2016
From: glennmschultz at me.com (Glenn Schultz)
Date: Thu, 27 Oct 2016 14:05:30 +0000 (GMT)
Subject: [R-pkg-devel] environment scoping
Message-ID: <4834fa15-5f75-42df-b8d9-12b8a5d961ae@me.com>

All,

I would like to have some inputs available to many functions. ?For example, I have coefficient for a term structure fit which I would like to make a available to total return functions. ?Thereby eliminating the need to fit the same term structure over and over again. ?However, I still reading and researching scoping. ?My understanding is that I could fit the term structure and keep the coefficients in the global environment which would then make those coefficients available to all functions requiring a term structure object input. ?Am I correct in my understanding. ?What is the downside of environment global, if any?

Best Regards,
Glenn

From murdoch.duncan at gmail.com  Thu Oct 27 16:47:01 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 27 Oct 2016 10:47:01 -0400
Subject: [R-pkg-devel] environment scoping
In-Reply-To: <4834fa15-5f75-42df-b8d9-12b8a5d961ae@me.com>
References: <4834fa15-5f75-42df-b8d9-12b8a5d961ae@me.com>
Message-ID: <ebe34e7f-162f-52bb-2b7f-1e5d675e1418@gmail.com>

On 27/10/2016 10:05 AM, Glenn Schultz wrote:
> All,
>
> I would like to have some inputs available to many functions.  For example, I have coefficient for a term structure fit which I would like to make a available to total return functions.  Thereby eliminating the need to fit the same term structure over and over again.  However, I still reading and researching scoping.  My understanding is that I could fit the term structure and keep the coefficients in the global environment which would then make those coefficients available to all functions requiring a term structure object input.  Am I correct in my understanding.  What is the downside of environment global, if any?

You're writing in R-package-devel, so I'll assume you're thinking of 
doing this in a package that you will release to others.

In that case, the downside is huge.  The global environment doesn't 
belong to you, it belongs to the user.  If you choose to write to it, 
you could clobber something there that the user doesn't want clobbered.  
You'll hopefully get warnings from "R CMD check" about doing this, and 
CRAN will not accept your package.

There are a couple of ways to do what you want.  The simplest is to have 
the function that creates the common data return it in some sort of 
structure, and you pass that structure to other functions that need to 
work with it.  You can use S3 or S4 or other class systems to mark the 
structure for what it is.

Another approach that works sometimes is to have the function that 
creates the common data also create functions to work on it, and return 
them.  Since functions created in another function can see its local 
variables (even after it has returned!), those functions will have 
access to the common data, and nobody else will (without going through 
some contortions).  Some of the newer object systems support this 
approach, but you don't need to use them, you can just return a function 
(or a list of functions) and make calls to it/them.

I hope this helps.

Duncan Murdoch


From jenny at stat.ubc.ca  Thu Oct 27 16:55:36 2016
From: jenny at stat.ubc.ca (Jenny Bryan)
Date: Thu, 27 Oct 2016 07:55:36 -0700
Subject: [R-pkg-devel] environment scoping
In-Reply-To: <4834fa15-5f75-42df-b8d9-12b8a5d961ae@me.com>
References: <4834fa15-5f75-42df-b8d9-12b8a5d961ae@me.com>
Message-ID: <AE96FC15-5748-414C-9C3A-2A9F555F9007@stat.ubc.ca>

Hi Glenn,

It sounds like you should create an environment for your package. If you store these objects in the global environment, they are exposed to the user and, more importantly, user could modify or delete them. If you use an environment specific to your package, you can be sure you are the only one messing with them.

You create it like so:

.package_env <- new.env(parent = emptyenv())

And read from / write into it like so (very much like a list):

.package_env$foo <- ...
.package_env$foo

or with assign() and get():

assign(foo, bar, envir = .package_env)
get(foo, envir = .package_env)

This blog post by Jeff Allen is a nice write-up of what you're trying to do:

http://trestletech.com/2013/04/package-wide-variablescache-in-r-package/

-- Jenny

> On Oct 27, 2016, at 7:05 AM, Glenn Schultz <glennmschultz at me.com> wrote:
> 
> All,
> 
> I would like to have some inputs available to many functions.  For example, I have coefficient for a term structure fit which I would like to make a available to total return functions.  Thereby eliminating the need to fit the same term structure over and over again.  However, I still reading and researching scoping.  My understanding is that I could fit the term structure and keep the coefficients in the global environment which would then make those coefficients available to all functions requiring a term structure object input.  Am I correct in my understanding.  What is the downside of environment global, if any?
> 
> Best Regards,
> Glenn
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From wdunlap at tibco.com  Thu Oct 27 18:29:42 2016
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 27 Oct 2016 09:29:42 -0700
Subject: [R-pkg-devel] environment scoping
In-Reply-To: <AE96FC15-5748-414C-9C3A-2A9F555F9007@stat.ubc.ca>
References: <4834fa15-5f75-42df-b8d9-12b8a5d961ae@me.com>
	<AE96FC15-5748-414C-9C3A-2A9F555F9007@stat.ubc.ca>
Message-ID: <CAF8bMcaC+fX_-3-EPBwh46d3Omynuq_4u8CwhOj24EVi5BefRA@mail.gmail.com>

If I were writing a package for factoring integers I might store a vector
of known primes in an environment in my package and have my factoring
functions append to the list when they find some more primes.  This works
because there is only one set of of primes (given we stick with ordinary
integers).

However the term structure (of interest rates, I assume) depends on the
date, the county, the type of bond, the method used to estimate it, etc.  I
think it would be better to store it in some sort of object (function,
list, or environment) that the user would be expected to know about.  The
user would be expected to pass that data into each function that need that
information (via the argument list, by using a function made in the
environment containing the term structure, etc.).


Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Thu, Oct 27, 2016 at 7:55 AM, Jenny Bryan <jenny at stat.ubc.ca> wrote:

> Hi Glenn,
>
> It sounds like you should create an environment for your package. If you
> store these objects in the global environment, they are exposed to the user
> and, more importantly, user could modify or delete them. If you use an
> environment specific to your package, you can be sure you are the only one
> messing with them.
>
> You create it like so:
>
> .package_env <- new.env(parent = emptyenv())
>
> And read from / write into it like so (very much like a list):
>
> .package_env$foo <- ...
> .package_env$foo
>
> or with assign() and get():
>
> assign(foo, bar, envir = .package_env)
> get(foo, envir = .package_env)
>
> This blog post by Jeff Allen is a nice write-up of what you're trying to
> do:
>
> http://trestletech.com/2013/04/package-wide-variablescache-in-r-package/
>
> -- Jenny
>
> > On Oct 27, 2016, at 7:05 AM, Glenn Schultz <glennmschultz at me.com> wrote:
> >
> > All,
> >
> > I would like to have some inputs available to many functions.  For
> example, I have coefficient for a term structure fit which I would like to
> make a available to total return functions.  Thereby eliminating the need
> to fit the same term structure over and over again.  However, I still
> reading and researching scoping.  My understanding is that I could fit the
> term structure and keep the coefficients in the global environment which
> would then make those coefficients available to all functions requiring a
> term structure object input.  Am I correct in my understanding.  What is
> the downside of environment global, if any?
> >
> > Best Regards,
> > Glenn
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From glennmschultz at me.com  Thu Oct 27 20:18:19 2016
From: glennmschultz at me.com (Glenn Schultz)
Date: Thu, 27 Oct 2016 13:18:19 -0500
Subject: [R-pkg-devel] environment scoping
In-Reply-To: <CAF8bMcaC+fX_-3-EPBwh46d3Omynuq_4u8CwhOj24EVi5BefRA@mail.gmail.com>
References: <4834fa15-5f75-42df-b8d9-12b8a5d961ae@me.com>
	<AE96FC15-5748-414C-9C3A-2A9F555F9007@stat.ubc.ca>
	<CAF8bMcaC+fX_-3-EPBwh46d3Omynuq_4u8CwhOj24EVi5BefRA@mail.gmail.com>
Message-ID: <65F1CD5A-A395-4A26-BEC9-427E5F9C2FF6@me.com>

All,

Thank you, I have built the package such that it passes an object TermStrutrure to those functions which require it as an input.  The package is here

https://github.com/glennmschultz/BondLab <https://github.com/glennmschultz/BondLab>

The question is largely motivated by the source MortgageScenario.R and MortgageOAS.R.  I have decided to default to Diebold Lee model in termstuc.

 In the case of MortgageScenario.R:

Currently shift in the curve is driven by shift in the coupon curve and the term structure model is refit.  Naturally one could use the coefficients from the original fit to shift the curve making the 		analysis much faster and more intuitive than the current paradigm of shifting the coupon curve.  However, some portfolio prefer to be able to use either or.  So, I need to make either/or available.

In the case of MortgageOAS.R

This is currently a single factor CIR OAS model.  It will remain for teaching purposes as a single factor model is the gateway to multi-factor models.  Nevertheless, one may choose to batch job OAS across say 500 MBS.  In which case it makes little sense to replicate the paths 500 times.  Simulate the paths and pass them to the function.  Obviously, I am looking at parallel processing of a portfolio mortgage and asset backed securities.  Thank-you for the time that you have taken to consider and reply to my question.  This has been very helpful.

Best,
Glenn

 




> On Oct 27, 2016, at 11:29 AM, William Dunlap <wdunlap at tibco.com> wrote:
> 
> If I were writing a package for factoring integers I might store a vector of known primes in an environment in my package and have my factoring functions append to the list when they find some more primes.  This works because there is only one set of of primes (given we stick with ordinary integers).
> 
> However the term structure (of interest rates, I assume) depends on the date, the county, the type of bond, the method used to estimate it, etc.  I think it would be better to store it in some sort of object (function, list, or environment) that the user would be expected to know about.  The user would be expected to pass that data into each function that need that information (via the argument list, by using a function made in the environment containing the term structure, etc.).
> 
> 
> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com <http://tibco.com/>
> On Thu, Oct 27, 2016 at 7:55 AM, Jenny Bryan <jenny at stat.ubc.ca <mailto:jenny at stat.ubc.ca>> wrote:
> Hi Glenn,
> 
> It sounds like you should create an environment for your package. If you store these objects in the global environment, they are exposed to the user and, more importantly, user could modify or delete them. If you use an environment specific to your package, you can be sure you are the only one messing with them.
> 
> You create it like so:
> 
> .package_env <- new.env(parent = emptyenv())
> 
> And read from / write into it like so (very much like a list):
> 
> .package_env$foo <- ...
> .package_env$foo
> 
> or with assign() and get():
> 
> assign(foo, bar, envir = .package_env)
> get(foo, envir = .package_env)
> 
> This blog post by Jeff Allen is a nice write-up of what you're trying to do:
> 
> http://trestletech.com/2013/04/package-wide-variablescache-in-r-package/ <http://trestletech.com/2013/04/package-wide-variablescache-in-r-package/>
> 
> -- Jenny
> 
> > On Oct 27, 2016, at 7:05 AM, Glenn Schultz <glennmschultz at me.com <mailto:glennmschultz at me.com>> wrote:
> >
> > All,
> >
> > I would like to have some inputs available to many functions.  For example, I have coefficient for a term structure fit which I would like to make a available to total return functions.  Thereby eliminating the need to fit the same term structure over and over again.  However, I still reading and researching scoping.  My understanding is that I could fit the term structure and keep the coefficients in the global environment which would then make those coefficients available to all functions requiring a term structure object input.  Am I correct in my understanding.  What is the downside of environment global, if any?
> >
> > Best Regards,
> > Glenn
> > ______________________________________________
> > R-package-devel at r-project.org <mailto:R-package-devel at r-project.org> mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> 
> ______________________________________________
> R-package-devel at r-project.org <mailto:R-package-devel at r-project.org> mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> 


	[[alternative HTML version deleted]]


From henrik.bengtsson at gmail.com  Fri Oct 28 17:30:10 2016
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Fri, 28 Oct 2016 08:30:10 -0700
Subject: [R-pkg-devel] environment scoping
In-Reply-To: <65F1CD5A-A395-4A26-BEC9-427E5F9C2FF6@me.com>
References: <4834fa15-5f75-42df-b8d9-12b8a5d961ae@me.com>
	<AE96FC15-5748-414C-9C3A-2A9F555F9007@stat.ubc.ca>
	<CAF8bMcaC+fX_-3-EPBwh46d3Omynuq_4u8CwhOj24EVi5BefRA@mail.gmail.com>
	<65F1CD5A-A395-4A26-BEC9-427E5F9C2FF6@me.com>
Message-ID: <CAFDcVCQYSb3W0uZyJCj875qzAEt1JfWgWzRWYDVvhaZyEkpSrg@mail.gmail.com>

It sounds like memoization could help here. Package examples for this:
memoise and R.cache

Henrik

On Oct 27, 2016 11:19, "Glenn Schultz" <glennmschultz at me.com> wrote:

> All,
>
> Thank you, I have built the package such that it passes an object
> TermStrutrure to those functions which require it as an input.  The package
> is here
>
> https://github.com/glennmschultz/BondLab <https://github.com/
> glennmschultz/BondLab>
>
> The question is largely motivated by the source MortgageScenario.R and
> MortgageOAS.R.  I have decided to default to Diebold Lee model in termstuc.
>
>  In the case of MortgageScenario.R:
>
> Currently shift in the curve is driven by shift in the coupon curve and
> the term structure model is refit.  Naturally one could use the
> coefficients from the original fit to shift the curve making the
>     analysis much faster and more intuitive than the current paradigm of
> shifting the coupon curve.  However, some portfolio prefer to be able to
> use either or.  So, I need to make either/or available.
>
> In the case of MortgageOAS.R
>
> This is currently a single factor CIR OAS model.  It will remain for
> teaching purposes as a single factor model is the gateway to multi-factor
> models.  Nevertheless, one may choose to batch job OAS across say 500 MBS.
> In which case it makes little sense to replicate the paths 500 times.
> Simulate the paths and pass them to the function.  Obviously, I am looking
> at parallel processing of a portfolio mortgage and asset backed
> securities.  Thank-you for the time that you have taken to consider and
> reply to my question.  This has been very helpful.
>
> Best,
> Glenn
>
>
>
>
>
>
> > On Oct 27, 2016, at 11:29 AM, William Dunlap <wdunlap at tibco.com> wrote:
> >
> > If I were writing a package for factoring integers I might store a
> vector of known primes in an environment in my package and have my
> factoring functions append to the list when they find some more primes.
> This works because there is only one set of of primes (given we stick with
> ordinary integers).
> >
> > However the term structure (of interest rates, I assume) depends on the
> date, the county, the type of bond, the method used to estimate it, etc.  I
> think it would be better to store it in some sort of object (function,
> list, or environment) that the user would be expected to know about.  The
> user would be expected to pass that data into each function that need that
> information (via the argument list, by using a function made in the
> environment containing the term structure, etc.).
> >
> >
> > Bill Dunlap
> > TIBCO Software
> > wdunlap tibco.com <http://tibco.com/>
> > On Thu, Oct 27, 2016 at 7:55 AM, Jenny Bryan <jenny at stat.ubc.ca <mailto:
> jenny at stat.ubc.ca>> wrote:
> > Hi Glenn,
> >
> > It sounds like you should create an environment for your package. If you
> store these objects in the global environment, they are exposed to the user
> and, more importantly, user could modify or delete them. If you use an
> environment specific to your package, you can be sure you are the only one
> messing with them.
> >
> > You create it like so:
> >
> > .package_env <- new.env(parent = emptyenv())
> >
> > And read from / write into it like so (very much like a list):
> >
> > .package_env$foo <- ...
> > .package_env$foo
> >
> > or with assign() and get():
> >
> > assign(foo, bar, envir = .package_env)
> > get(foo, envir = .package_env)
> >
> > This blog post by Jeff Allen is a nice write-up of what you're trying to
> do:
> >
> > http://trestletech.com/2013/04/package-wide-variablescache-in-r-package/
> <http://trestletech.com/2013/04/package-wide-variablescache-in-r-package/>
> >
> > -- Jenny
> >
> > > On Oct 27, 2016, at 7:05 AM, Glenn Schultz <glennmschultz at me.com
> <mailto:glennmschultz at me.com>> wrote:
> > >
> > > All,
> > >
> > > I would like to have some inputs available to many functions.  For
> example, I have coefficient for a term structure fit which I would like to
> make a available to total return functions.  Thereby eliminating the need
> to fit the same term structure over and over again.  However, I still
> reading and researching scoping.  My understanding is that I could fit the
> term structure and keep the coefficients in the global environment which
> would then make those coefficients available to all functions requiring a
> term structure object input.  Am I correct in my understanding.  What is
> the downside of environment global, if any?
> > >
> > > Best Regards,
> > > Glenn
> > > ______________________________________________
> > > R-package-devel at r-project.org <mailto:R-package-devel at r-project.org>
> mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-package-devel <
> https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> >
> > ______________________________________________
> > R-package-devel at r-project.org <mailto:R-package-devel at r-project.org>
> mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel <
> https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> >
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From glennmschultz at me.com  Sun Oct 30 13:41:36 2016
From: glennmschultz at me.com (Glenn Schultz)
Date: Sun, 30 Oct 2016 12:41:36 +0000 (GMT)
Subject: [R-pkg-devel] unpacking into a folder
Message-ID: <68f82f43-db6d-49be-a33b-f272764b1cd5@me.com>

All,

My package has 5 directories which serve as data folders. ?I created source scripts for MBS pass-throughs and UST bonds in the BondData folder rather than create and store the objects as this makes it easier to add more bonds to the example data set. ?I have a function called BondLabSet() which runs a function that creates the objects from source in their respective folders. ?My question is related to CRAN.

Research CRAN, seems the preference is not set options, create folders which the user is unaware during the install. ?However, since BondLab is calling source in the directory installed and creating objects - not creating folders or setting options is running BondLabSetup() during install to create the BondData objects acceptable to CRAN?

Best Regards,
Glenn

From lbusett at gmail.com  Mon Oct 31 12:50:15 2016
From: lbusett at gmail.com (Lorenzo Busetto)
Date: Mon, 31 Oct 2016 12:50:15 +0100
Subject: [R-pkg-devel] package in 'Suggests'
In-Reply-To: <eyueg3b88p5.fsf@bonnington.inf.ed.ac.uk>
References: <eyueg3b88p5.fsf@bonnington.inf.ed.ac.uk>
Message-ID: <CAM1G4SS4d6nvm7ZVnDgfO4SfEOJKzXGP-xV28TgDeMcowabGpQ@mail.gmail.com>

Dear David,

    sorry for the late reply: I didn't notice your message earlier since it
ended-up in a different thread.

Thanks for your suggestion: this is actually what I'm currently  planning
to do, since also my package can work without the GUI.

regards,

Lorenzo



On 20 October 2016 at 15:07, David C Sterratt <david.c.sterratt at ed.ac.uk>
wrote:

> Dear Lorenzo,
>
> For my "retistruct" package, which depends on gWidgets2RGtk2, I have
> gWidgets2RGtk2, gWidgets2 and cairoDevice as "Suggests" and I put the
> following code in the function that opens the GUI ('retistruct()' in
> https://github.com/davidcsterratt/retistruct/blob/master/pkg/retistruct/R/
> retistruct-gui.R):
>
>   guiToolkit <- "RGtk2"
>   require.package <- function(pkg) {
>     suggests<-tools::package.dependencies(installed.packages()["retistruct",],
> depLevel="Suggests")$retistruct
>     suggests <- suggests[suggests[,1] == pkg]
>     uptodate <- ifelse(is.na(suggests[2]),
>                        TRUE,
>                        eval(parse(text=paste("packageVersion(suggests[1])",
> suggests[2],  "suggests[3]"))))
>     if (!require(pkg, character.only=TRUE) |
>         !uptodate) {
>       message(paste("Trying to install required package", pkg))
>       install.packages(pkg)
>       if (!require(pkg, character.only=TRUE)) {
>         stop(paste("Could not install", pkg))
>       }
>     }
>   }
>   require.package(paste0("gWidgets2", guiToolkit))
>   require.package("cairoDevice")
>   options(guiToolkit=guiToolkit)
>
>
> The package can work without a GUI, and may be installed on systems that
> do not have GTK installed. There is user documentation on installing
> RGtk2 which, if it's useful to you, you could of course copy:
> http://retistruct.r-forge.r-project.org/retistruct-user-guide.pdf
>
> Best wishes,
>
> David.
>
> --
> David C Sterratt, Research Fellow - http://homepages.inf.ed.ac.uk/sterratt
> Institute for Adaptive and Neural Computation     tel: +44 131 651 1739
> School of Informatics, University of Edinburgh    fax: +44 131 650 6899
> Informatics Forum, 10 Crichton Street, Edinburgh EH8 9AB, Scotland, UK
>
> --
> The University of Edinburgh is a charitable body, registered in
> Scotland, with registration number SC005336.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From rampaletienne at gmail.com  Tue Nov  1 14:49:42 2016
From: rampaletienne at gmail.com (Rampal Etienne)
Date: Tue, 1 Nov 2016 14:49:42 +0100
Subject: [R-pkg-devel] building binary gives error when trying to load
Message-ID: <ddd252fe-8a6b-6e3f-fec6-a79d1f18c669@gmail.com>

Dear all,

When I try to build a Windows binary in RStudio using R-devel, 
everything goes well until the packages is tested whether it can be 
loaded. I then get the error:

** testing if installed package can be loaded *** arch - i386 Error: 
'\U' used without hex digits in character string starting "'C:\U" 
Execution halted *** arch - x64 Error: '\U' used without hex digits in 
character string starting "'C:\U" Execution halted ERROR: loading failed 
for 'i386', 'x64' * removing 
'C:\Users\rampa\AppData\Local\Temp\Rtmp0o1Fm1\temp_libpath1cd445c31688/SADISA' 
Error: Command failed (1) Execution halted Exited with status 1.


I have updated RStudio, Rtools and Rdevel,and the problem persists. Does 
anyone have a clue how to solve this?

Before I updated to the newest Rdevel, everything worked fine.

Kind regards, Rampal Etienne

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Tue Nov  1 15:07:02 2016
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 1 Nov 2016 15:07:02 +0100
Subject: [R-pkg-devel] building binary gives error when trying to load
In-Reply-To: <ddd252fe-8a6b-6e3f-fec6-a79d1f18c669@gmail.com>
References: <ddd252fe-8a6b-6e3f-fec6-a79d1f18c669@gmail.com>
Message-ID: <2a369451-1f33-5b34-6e77-7275d77f3d44@statistik.tu-dortmund.de>

Use forward slashes in file specification such as c:/Users/rampa/....

Best,
Uwe Ligges



On 01.11.2016 14:49, Rampal Etienne wrote:
> Dear all,
>
> When I try to build a Windows binary in RStudio using R-devel,
> everything goes well until the packages is tested whether it can be
> loaded. I then get the error:
>
> ** testing if installed package can be loaded *** arch - i386 Error:
> '\U' used without hex digits in character string starting "'C:\U"
> Execution halted *** arch - x64 Error: '\U' used without hex digits in
> character string starting "'C:\U" Execution halted ERROR: loading failed
> for 'i386', 'x64' * removing
> 'C:\Users\rampa\AppData\Local\Temp\Rtmp0o1Fm1\temp_libpath1cd445c31688/SADISA'
> Error: Command failed (1) Execution halted Exited with status 1.
>
>
> I have updated RStudio, Rtools and Rdevel,and the problem persists. Does
> anyone have a clue how to solve this?
>
> Before I updated to the newest Rdevel, everything worked fine.
>
> Kind regards, Rampal Etienne
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From murdoch.duncan at gmail.com  Tue Nov  1 15:56:07 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 1 Nov 2016 10:56:07 -0400
Subject: [R-pkg-devel] building binary gives error when trying to load
In-Reply-To: <ddd252fe-8a6b-6e3f-fec6-a79d1f18c669@gmail.com>
References: <ddd252fe-8a6b-6e3f-fec6-a79d1f18c669@gmail.com>
Message-ID: <49ad5c9a-ac26-a03a-df7b-8619f50cb1ad@gmail.com>

On 01/11/2016 9:49 AM, Rampal Etienne wrote:
> Dear all,
>
> When I try to build a Windows binary in RStudio using R-devel,
> everything goes well until the packages is tested whether it can be
> loaded. I then get the error:
>
> ** testing if installed package can be loaded *** arch - i386 Error:
> '\U' used without hex digits in character string starting "'C:\U"
> Execution halted *** arch - x64 Error: '\U' used without hex digits in
> character string starting "'C:\U" Execution halted ERROR: loading failed
> for 'i386', 'x64' * removing
> 'C:\Users\rampa\AppData\Local\Temp\Rtmp0o1Fm1\temp_libpath1cd445c31688/SADISA'
> Error: Command failed (1) Execution halted Exited with status 1.

That looks like a bug.  It's in R, not RStudio.  To reproduce, start 
cmd.exe, and switch to a directory containing a source tarball or a 
source directory, and run

R CMD INSTALL --build <tarball>

For instance, when I do that with the tables package, I get

D:\svn\MyR>R CMD INSTALL --build tables
* installing to library 'f:\cygwin\home\murdoch\R\win-library\3.4'
* installing *source* package 'tables' ...
** R
** preparing package for lazy loading
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded
Error: '\c' is an unrecognized escape in character string starting "'f:\c"
Execution halted
ERROR: loading failed
* removing 'f:\cygwin\home\murdoch\R\win-library\3.4/tables'
* restoring previous 'f:\cygwin\home\murdoch\R\win-library\3.4/tables'

It appears that the script is building paths including unescaped 
backslashes when it constructs the library path.  You can probably work 
around it by specifying the library path explicitly.  Since you were 
installing into a temporary library, that's a little tricky, but for 
most people it should be easy.

I'll see if I can track it down and fix it.

Duncan Murdoch

>
>
> I have updated RStudio, Rtools and Rdevel,and the problem persists. Does
> anyone have a clue how to solve this?
>
> Before I updated to the newest Rdevel, everything worked fine.
>
> Kind regards, Rampal Etienne
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ligges at statistik.tu-dortmund.de  Tue Nov  1 17:01:28 2016
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 1 Nov 2016 17:01:28 +0100
Subject: [R-pkg-devel] building binary gives error when trying to load
In-Reply-To: <49ad5c9a-ac26-a03a-df7b-8619f50cb1ad@gmail.com>
References: <ddd252fe-8a6b-6e3f-fec6-a79d1f18c669@gmail.com>
	<49ad5c9a-ac26-a03a-df7b-8619f50cb1ad@gmail.com>
Message-ID: <0195e0da-6e71-1526-2c52-068b7e38b2ac@statistik.tu-dortmund.de>



On 01.11.2016 15:56, Duncan Murdoch wrote:
> On 01/11/2016 9:49 AM, Rampal Etienne wrote:
>> Dear all,
>>
>> When I try to build a Windows binary in RStudio using R-devel,
>> everything goes well until the packages is tested whether it can be
>> loaded. I then get the error:
>>
>> ** testing if installed package can be loaded *** arch - i386 Error:
>> '\U' used without hex digits in character string starting "'C:\U"
>> Execution halted *** arch - x64 Error: '\U' used without hex digits in
>> character string starting "'C:\U" Execution halted ERROR: loading failed
>> for 'i386', 'x64' * removing
>> 'C:\Users\rampa\AppData\Local\Temp\Rtmp0o1Fm1\temp_libpath1cd445c31688/SADISA'
>>
>> Error: Command failed (1) Execution halted Exited with status 1.
>
> That looks like a bug.


Indeed, it is also fairly new, as I typically do manual stuff that way 
and it hit me 5 minuites ago. Sorry for not having tested it as I did 
not believe there was a newly introduced bug.

Uwe



   It's in R, not RStudio.  To reproduce, start
> cmd.exe, and switch to a directory containing a source tarball or a
> source directory, and run
>
> R CMD INSTALL --build <tarball>
>
> For instance, when I do that with the tables package, I get
>
> D:\svn\MyR>R CMD INSTALL --build tables
> * installing to library 'f:\cygwin\home\murdoch\R\win-library\3.4'
> * installing *source* package 'tables' ...
> ** R
> ** preparing package for lazy loading
> ** help
> *** installing help indices
> ** building package indices
> ** installing vignettes
> ** testing if installed package can be loaded
> Error: '\c' is an unrecognized escape in character string starting "'f:\c"
> Execution halted
> ERROR: loading failed
> * removing 'f:\cygwin\home\murdoch\R\win-library\3.4/tables'
> * restoring previous 'f:\cygwin\home\murdoch\R\win-library\3.4/tables'
>
> It appears that the script is building paths including unescaped
> backslashes when it constructs the library path.  You can probably work
> around it by specifying the library path explicitly.  Since you were
> installing into a temporary library, that's a little tricky, but for
> most people it should be easy.
>
> I'll see if I can track it down and fix it.
>
> Duncan Murdoch
>
>>
>>
>> I have updated RStudio, Rtools and Rdevel,and the problem persists. Does
>> anyone have a clue how to solve this?
>>
>> Before I updated to the newest Rdevel, everything worked fine.
>>
>> Kind regards, Rampal Etienne
>>
>>     [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch.duncan at gmail.com  Tue Nov  1 19:52:52 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 1 Nov 2016 14:52:52 -0400
Subject: [R-pkg-devel] building binary gives error when trying to load
In-Reply-To: <34d1b5c1-c385-4a00-df8a-dfaa809775e1@sorch.se>
References: <ddd252fe-8a6b-6e3f-fec6-a79d1f18c669@gmail.com>
	<49ad5c9a-ac26-a03a-df7b-8619f50cb1ad@gmail.com>
	<0195e0da-6e71-1526-2c52-068b7e38b2ac@statistik.tu-dortmund.de>
	<34d1b5c1-c385-4a00-df8a-dfaa809775e1@sorch.se>
Message-ID: <7d8e4cd0-5d27-5d2e-8c93-ad8c80cf65e3@gmail.com>

On 01/11/2016 1:10 PM, Henric Winell wrote:
> On 2016-11-01 17:01, Uwe Ligges wrote:
>
> > On 01.11.2016 15:56, Duncan Murdoch wrote:
> >> On 01/11/2016 9:49 AM, Rampal Etienne wrote:
> >>> Dear all,
> >>>
> >>> When I try to build a Windows binary in RStudio using R-devel,
> >>> everything goes well until the packages is tested whether it can be
> >>> loaded. I then get the error:
> >>>
> >>> ** testing if installed package can be loaded *** arch - i386 Error:
> >>> '\U' used without hex digits in character string starting "'C:\U"
> >>> Execution halted *** arch - x64 Error: '\U' used without hex digits in
> >>> character string starting "'C:\U" Execution halted ERROR: loading failed
> >>> for 'i386', 'x64' * removing
> >>> 'C:\Users\rampa\AppData\Local\Temp\Rtmp0o1Fm1\temp_libpath1cd445c31688/SADISA'
> >>>
> >>>
> >>> Error: Command failed (1) Execution halted Exited with status 1.
> >>
> >> That looks like a bug.
> >
> >
> > Indeed, it is also fairly new, as I typically do manual stuff that way
> > and it hit me 5 minuites ago. Sorry for not having tested it as I did
> > not believe there was a newly introduced bug.
> >
> > Uwe
>
> I reported this issue to R-devel about ten days ago.
>
> https://stat.ethz.ch/pipermail/r-devel/2016-October/073286.html

Yes, it's been there for a few weeks.  I suspect Uwe has a more complete 
set of environment variables than most people, and some of those could 
have masked the error.

As for me, I rarely develop packages on Windows any more.

Now that Microsoft is pushing their R products so much, you'd think they 
could contribute some time to supporting their platform.

Duncan Murdoch
>
>
> Henric Winell
>
>
>
> >
>
> >
> >
> >   It's in R, not RStudio.  To reproduce, start
> >> cmd.exe, and switch to a directory containing a source tarball or a
> >> source directory, and run
> >>
> >> R CMD INSTALL --build <tarball>
> >>
> >> For instance, when I do that with the tables package, I get
> >>
> >> D:\svn\MyR>R CMD INSTALL --build tables
> >> * installing to library 'f:\cygwin\home\murdoch\R\win-library\3.4'
> >> * installing *source* package 'tables' ...
> >> ** R
> >> ** preparing package for lazy loading
> >> ** help
> >> *** installing help indices
> >> ** building package indices
> >> ** installing vignettes
> >> ** testing if installed package can be loaded
> >> Error: '\c' is an unrecognized escape in character string starting
> >> "'f:\c"
> >> Execution halted
> >> ERROR: loading failed
> >> * removing 'f:\cygwin\home\murdoch\R\win-library\3.4/tables'
> >> * restoring previous 'f:\cygwin\home\murdoch\R\win-library\3.4/tables'
> >>
> >> It appears that the script is building paths including unescaped
> >> backslashes when it constructs the library path.  You can probably work
> >> around it by specifying the library path explicitly.  Since you were
> >> installing into a temporary library, that's a little tricky, but for
> >> most people it should be easy.
> >>
> >> I'll see if I can track it down and fix it.
> >>
> >> Duncan Murdoch
> >>
> >>>
> >>>
> >>> I have updated RStudio, Rtools and Rdevel,and the problem persists. Does
> >>> anyone have a clue how to solve this?
> >>>
> >>> Before I updated to the newest Rdevel, everything worked fine.
> >>>
> >>> Kind regards, Rampal Etienne
> >>>
> >>>     [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-package-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>


From murdoch.duncan at gmail.com  Tue Nov  1 21:24:07 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 1 Nov 2016 16:24:07 -0400
Subject: [R-pkg-devel] building binary gives error when trying to load
In-Reply-To: <ddd252fe-8a6b-6e3f-fec6-a79d1f18c669@gmail.com>
References: <ddd252fe-8a6b-6e3f-fec6-a79d1f18c669@gmail.com>
Message-ID: <751e20ee-0ae0-08b6-c96e-fd35d90ec54d@gmail.com>

On 01/11/2016 9:49 AM, Rampal Etienne wrote:
> Dear all,
>
> When I try to build a Windows binary in RStudio using R-devel,
> everything goes well until the packages is tested whether it can be
> loaded. I then get the error:
>
> ** testing if installed package can be loaded *** arch - i386 Error:
> '\U' used without hex digits in character string starting "'C:\U"
> Execution halted *** arch - x64 Error: '\U' used without hex digits in
> character string starting "'C:\U" Execution halted ERROR: loading failed
> for 'i386', 'x64' * removing
> 'C:\Users\rampa\AppData\Local\Temp\Rtmp0o1Fm1\temp_libpath1cd445c31688/SADISA'
> Error: Command failed (1) Execution halted Exited with status 1.
>
>
> I have updated RStudio, Rtools and Rdevel,and the problem persists. Does
> anyone have a clue how to solve this?
>
> Before I updated to the newest Rdevel, everything worked fine.

This has been fixed as of revision 71616.

Duncan Murdoch


From murdoch.duncan at gmail.com  Tue Nov  1 21:31:22 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 1 Nov 2016 16:31:22 -0400
Subject: [R-pkg-devel] Package submissions via ftp will no longer be
	accepted by CRAN
Message-ID: <4a951952-1734-82c3-8fcd-efa5af66e5f5@gmail.com>

A notice to package developers:

For a long time CRAN has encouraged package maintainers to submit 
packages via the web submission page linked from

<https://cran.r-project.org/web/packages/policies.html>

This makes handling submissions substantially easier for us, and we have 
decided that it will be a requirement for submission from now on.

Documentation updates will be showing up as we find them.

Duncan Murdoch


From nilsson.henric at gmail.com  Tue Nov  1 21:53:02 2016
From: nilsson.henric at gmail.com (Henric Winell)
Date: Tue, 1 Nov 2016 21:53:02 +0100
Subject: [R-pkg-devel] building binary gives error when trying to load
In-Reply-To: <751e20ee-0ae0-08b6-c96e-fd35d90ec54d@gmail.com>
References: <ddd252fe-8a6b-6e3f-fec6-a79d1f18c669@gmail.com>
	<751e20ee-0ae0-08b6-c96e-fd35d90ec54d@gmail.com>
Message-ID: <1ca9a1d9-f069-a76e-d5d2-6e9b1ad10a46@gmail.com>

Den 2016-11-01 kl. 21:24, skrev Duncan Murdoch:
> On 01/11/2016 9:49 AM, Rampal Etienne wrote:
>> Dear all,
>>
>> When I try to build a Windows binary in RStudio using R-devel,
>> everything goes well until the packages is tested whether it can be
>> loaded. I then get the error:
>>
>> ** testing if installed package can be loaded *** arch - i386 Error:
>> '\U' used without hex digits in character string starting "'C:\U"
>> Execution halted *** arch - x64 Error: '\U' used without hex digits in
>> character string starting "'C:\U" Execution halted ERROR: loading failed
>> for 'i386', 'x64' * removing
>> 'C:\Users\rampa\AppData\Local\Temp\Rtmp0o1Fm1\temp_libpath1cd445c31688/SADISA'
>>
>> Error: Command failed (1) Execution halted Exited with status 1.
>>
>>
>> I have updated RStudio, Rtools and Rdevel,and the problem persists. Does
>> anyone have a clue how to solve this?
>>
>> Before I updated to the newest Rdevel, everything worked fine.
>
> This has been fixed as of revision 71616.

Many thanks for looking into and fixing this issue.

Henric Winell


>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From jranke at uni-bremen.de  Wed Nov  2 07:05:26 2016
From: jranke at uni-bremen.de (Johannes Ranke)
Date: Wed, 02 Nov 2016 07:05:26 +0100
Subject: [R-pkg-devel] NEWS.Rd and NEWS.md
Message-ID: <7911354.S6tzE1oroB@tux>

Dear fellow R package developers,

While the tools::news() function only supports NEWS files in NEWS.Rd format or 
as a NEWS text file, CRAN supports NEWS.md files which get nicely displayed as

https://cran.r-project.org/web/packages/<package>/news.html

What would be the recommended way to have both, NEWS.html on CRAN and a news 
file that can be displayed by the tools::news() function?

Kind regards,

Johannes

-- 
PD Dr. Johannes Ranke
Kronacher Str. 12
79639 Grenzach-Wyhlen


From stachel2 at msu.edu  Thu Nov  3 18:20:12 2016
From: stachel2 at msu.edu (Joseph Stachelek)
Date: Thu, 03 Nov 2016 13:20:12 -0400
Subject: [R-pkg-devel] Orphaned Package listing trouble?
Message-ID: <1478193612.2136.1.camel@msu.edu>

Hello all,

I am interested in updating a CRAN package which has the primary
purpose of serving a particular government database. This package has
seen no activity since 2014 and is now out-of-date. I have contacted
the maintainer email (waited several weeks) to offer to update the
package but received no response.

What should I do??

I assume that I cannot simply fix the package, change the maintainer
email, and submit to CRAN because I don't think the package has not
been officially orphaned. The official instructions say this:

> Everybody is more than welcome to take over as maintainer of an
orphaned package. Simply download the package sources, make changes if
necessary (respecting original author and license!) and resubmit the
package to CRAN with your name as maintainer in the DESCRIPTION file of
the package.

The reason I am not sure if it has been orphaned is that I am having
trouble viewing the orphaned package listing. The following page is
blank for me (shows no package listings):??
https://cran.r-project.org/src/contrib/Orphaned

-jsta


From ligges at statistik.tu-dortmund.de  Thu Nov  3 18:38:02 2016
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 3 Nov 2016 18:38:02 +0100
Subject: [R-pkg-devel] Orphaned Package listing trouble?
In-Reply-To: <1478193612.2136.1.camel@msu.edu>
References: <1478193612.2136.1.camel@msu.edu>
Message-ID: <f706fb09-94b2-c84b-fa7f-de0f3e819d88@statistik.tu-dortmund.de>



On 03.11.2016 18:20, Joseph Stachelek wrote:
> Hello all,
>
> I am interested in updating a CRAN package which has the primary
> purpose of serving a particular government database. This package has
> seen no activity since 2014 and is now out-of-date. I have contacted
> the maintainer email (waited several weeks) to offer to update the
> package but received no response.
>
> What should I do?
>
> I assume that I cannot simply fix the package, change the maintainer
> email, and submit to CRAN because I don't think the package has not
> been officially orphaned. The official instructions say this:
>
>> Everybody is more than welcome to take over as maintainer of an
> orphaned package. Simply download the package sources, make changes if
> necessary (respecting original author and license!) and resubmit the
> package to CRAN with your name as maintainer in the DESCRIPTION file of
> the package.
>
> The reason I am not sure if it has been orphaned is that I am having
> trouble viewing the orphaned package listing. The following page is
> blank for me (shows no package listings):
> https://cran.r-project.org/src/contrib/Orphaned
>
> -jsta


Hard to say without knowing which package you are taking about.

Best,
Uwe Ligges


From csardi.gabor at gmail.com  Thu Nov  3 18:39:32 2016
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 3 Nov 2016 17:39:32 +0000
Subject: [R-pkg-devel] Orphaned Package listing trouble?
In-Reply-To: <1478193612.2136.1.camel@msu.edu>
References: <1478193612.2136.1.camel@msu.edu>
Message-ID: <CABtg=KkC2mQn5Od11R1sPmU4g=N9j2jqpxMhDurtUO8S6dPkxQ@mail.gmail.com>

For the orphaned package list, search for "Orphaned" in
https://cran.r-project.org/src/contrib/PACKAGES.in

Gabor

On Thu, Nov 3, 2016 at 5:20 PM, Joseph Stachelek <stachel2 at msu.edu> wrote:
> Hello all,
>
> I am interested in updating a CRAN package which has the primary
> purpose of serving a particular government database. This package has
> seen no activity since 2014 and is now out-of-date. I have contacted
> the maintainer email (waited several weeks) to offer to update the
> package but received no response.
>
> What should I do?
>
> I assume that I cannot simply fix the package, change the maintainer
> email, and submit to CRAN because I don't think the package has not
> been officially orphaned. The official instructions say this:
>
>> Everybody is more than welcome to take over as maintainer of an
> orphaned package. Simply download the package sources, make changes if
> necessary (respecting original author and license!) and resubmit the
> package to CRAN with your name as maintainer in the DESCRIPTION file of
> the package.
>
> The reason I am not sure if it has been orphaned is that I am having
> trouble viewing the orphaned package listing. The following page is
> blank for me (shows no package listings):
> https://cran.r-project.org/src/contrib/Orphaned
>
> -jsta
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From stachel2 at msu.edu  Thu Nov  3 20:27:04 2016
From: stachel2 at msu.edu (Joseph Stachelek)
Date: Thu, 03 Nov 2016 15:27:04 -0400
Subject: [R-pkg-devel] Orphaned Package listing trouble?
In-Reply-To: <f706fb09-94b2-c84b-fa7f-de0f3e819d88@statistik.tu-dortmund.de>
References: <1478193612.2136.1.camel@msu.edu>
	<f706fb09-94b2-c84b-fa7f-de0f3e819d88@statistik.tu-dortmund.de>
Message-ID: <1478201224.2173.1.camel@msu.edu>

On Thu, 2016-11-03 at 18:38 +0100, Uwe Ligges wrote:
> 
> On 03.11.2016 18:20, Joseph Stachelek wrote:
> > 
> > Hello all,
> > 
> > I am interested in updating a CRAN package which has the primary
> > purpose of serving a particular government database. This package
> > has
> > seen no activity since 2014 and is now out-of-date. I have
> > contacted
> > the maintainer email (waited several weeks) to offer to update the
> > package but received no response.
> > 
> > What should I do?
> > 
> > I assume that I cannot simply fix the package, change the
> > maintainer
> > email, and submit to CRAN because I don't think the package has not
> > been officially orphaned. The official instructions say this:
> > 
> > > 
> > > Everybody is more than welcome to take over as maintainer of an
> > orphaned package. Simply download the package sources, make changes
> > if
> > necessary (respecting original author and license!) and resubmit
> > the
> > package to CRAN with your name as maintainer in the DESCRIPTION
> > file of
> > the package.
> > 
> > The reason I am not sure if it has been orphaned is that I am
> > having
> > trouble viewing the orphaned package listing. The following page is
> > blank for me (shows no package listings):
> > https://cran.r-project.org/src/contrib/Orphaned
> > 
> > -jsta
> 
> Hard to say without knowing which package you are taking about.
> 
> Best,
> Uwe Ligges
> 
> 
I am interested in the `dams` package. From Gabor's link it appears
that I was not mistaken and it has not been orphaned.

-jsta


From ligges at statistik.tu-dortmund.de  Thu Nov  3 20:32:32 2016
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 3 Nov 2016 20:32:32 +0100
Subject: [R-pkg-devel] Orphaned Package listing trouble?
In-Reply-To: <1478201224.2173.1.camel@msu.edu>
References: <1478193612.2136.1.camel@msu.edu>
	<f706fb09-94b2-c84b-fa7f-de0f3e819d88@statistik.tu-dortmund.de>
	<1478201224.2173.1.camel@msu.edu>
Message-ID: <83e1db12-ec65-d082-23c1-5e40bbf27aa3@statistik.tu-dortmund.de>



On 03.11.2016 20:27, Joseph Stachelek wrote:
> On Thu, 2016-11-03 at 18:38 +0100, Uwe Ligges wrote:
>>
>> On 03.11.2016 18:20, Joseph Stachelek wrote:
>>>
>>> Hello all,
>>>
>>> I am interested in updating a CRAN package which has the primary
>>> purpose of serving a particular government database. This package
>>> has
>>> seen no activity since 2014 and is now out-of-date. I have
>>> contacted
>>> the maintainer email (waited several weeks) to offer to update the
>>> package but received no response.
>>>
>>> What should I do?
>>>
>>> I assume that I cannot simply fix the package, change the
>>> maintainer
>>> email, and submit to CRAN because I don't think the package has not
>>> been officially orphaned. The official instructions say this:
>>>
>>>>
>>>> Everybody is more than welcome to take over as maintainer of an
>>> orphaned package. Simply download the package sources, make changes
>>> if
>>> necessary (respecting original author and license!) and resubmit
>>> the
>>> package to CRAN with your name as maintainer in the DESCRIPTION
>>> file of
>>> the package.
>>>
>>> The reason I am not sure if it has been orphaned is that I am
>>> having
>>> trouble viewing the orphaned package listing. The following page is
>>> blank for me (shows no package listings):
>>> https://cran.r-project.org/src/contrib/Orphaned
>>>
>>> -jsta
>>
>> Hard to say without knowing which package you are taking about.
>>
>> Best,
>> Uwe Ligges
>>
>>
> I am interested in the `dams` package. From Gabor's link it appears
> that I was not mistaken and it has not been orphaned.

Right, not orphaned, as
https://cran.r-project.org/web/packages/dams/index.html
lists a maintainer.

CRAN will contact the maintainer CCIng you.

Best,
Uwe Ligges









> -jsta
>


From rampaletienne at gmail.com  Fri Nov  4 15:01:09 2016
From: rampaletienne at gmail.com (Rampal S. Etienne)
Date: Fri, 4 Nov 2016 15:01:09 +0100
Subject: [R-pkg-devel] building binary gives error when trying to load
In-Reply-To: <1ca9a1d9-f069-a76e-d5d2-6e9b1ad10a46@gmail.com>
References: <ddd252fe-8a6b-6e3f-fec6-a79d1f18c669@gmail.com>
	<751e20ee-0ae0-08b6-c96e-fd35d90ec54d@gmail.com>
	<1ca9a1d9-f069-a76e-d5d2-6e9b1ad10a46@gmail.com>
Message-ID: <9a8bf23a-0aec-a539-36f5-7665f4bd91fb@gmail.com>

Thanks from my side as well!

Rampal


On 1-11-2016 21:53, Henric Winell wrote:
> Den 2016-11-01 kl. 21:24, skrev Duncan Murdoch:
>> On 01/11/2016 9:49 AM, Rampal Etienne wrote:
>>> Dear all,
>>>
>>> When I try to build a Windows binary in RStudio using R-devel,
>>> everything goes well until the packages is tested whether it can be
>>> loaded. I then get the error:
>>>
>>> ** testing if installed package can be loaded *** arch - i386 Error:
>>> '\U' used without hex digits in character string starting "'C:\U"
>>> Execution halted *** arch - x64 Error: '\U' used without hex digits in
>>> character string starting "'C:\U" Execution halted ERROR: loading
>>> failed
>>> for 'i386', 'x64' * removing
>>> 'C:\Users\rampa\AppData\Local\Temp\Rtmp0o1Fm1\temp_libpath1cd445c31688/SADISA'
>>>
>>>
>>> Error: Command failed (1) Execution halted Exited with status 1.
>>>
>>>
>>> I have updated RStudio, Rtools and Rdevel,and the problem persists.
>>> Does
>>> anyone have a clue how to solve this?
>>>
>>> Before I updated to the newest Rdevel, everything worked fine.
>>
>> This has been fixed as of revision 71616.
>
> Many thanks for looking into and fixing this issue.
>
> Henric Winell
>
>
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>


From russell-lenth at uiowa.edu  Sun Nov  6 03:28:09 2016
From: russell-lenth at uiowa.edu (Lenth, Russell V)
Date: Sun, 6 Nov 2016 02:28:09 +0000
Subject: [R-pkg-devel] Relicense to GPL-3?
Message-ID: <CO2PR04MB2214C560C989B50FE250530FF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>

Dear all,

I received an email from a user telling me that another package that depends on my package is licensed GPL(>=3), whereas mine is licensed GPL-2; and that therefore, the other package is in violation of its GPL-3 license. This apparently causes an issue with the Debian packaging system, throwing that other package into the "unstable" category.

Moreover, the correspondent asks me if I would consider changing the license for my package. To what is not specified, but I guess it would be to GPL-3.

I don't really understand why this isn't the other developer's problem and not mine. But on the other hand, I don't want to cause problems for others. The licensing stuff is hard for me to understand - in large part because of low motivation to dig into it; I really would rather think about providing better code and features than all sorts of legal gobble-de-gook. Nonetheless, I guess this stuff is important to some people (e.g., Debian) so I suppose I had better get it right.

My decision to put GPL-2 in the first place was primarily expedience: it seemed like what people wanted. So is GPL-3 "better"? Do I risk anything by changing it? Do I risk anything by not changing it? How much does it matter, really?

Thanks

Russ

Russell V. Lenth? -? Professor Emeritus
Department of Statistics and Actuarial Science?? 
The University of Iowa ?-? Iowa City, IA 52242? USA?? 
Voice (319)335-0712 (Dept. office)? -? FAX (319)335-3017


From edd at debian.org  Sun Nov  6 05:51:02 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 5 Nov 2016 23:51:02 -0500
Subject: [R-pkg-devel] Relicense to GPL-3?
In-Reply-To: <CO2PR04MB2214C560C989B50FE250530FF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
References: <CO2PR04MB2214C560C989B50FE250530FF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
Message-ID: <22558.46774.60723.36641@max.nulle.part>


On 6 November 2016 at 02:28, Lenth, Russell V wrote:
| I received an email from a user telling me that another package that
| depends on my package is licensed GPL(>=3), whereas mine is licensed GPL-2;
| and that therefore, the other package is in violation of its GPL-3 license.  

That is apparently so, but most easily fixed by relicensing as "GPL (>= 2)"
which CRAN expands to "GPL-2 | GPL-3" as you can see on _many_ CRAN package pages.

For what it is worth, I was in the same situation with package 'digest' which
was created so long ago that its license was also "GPL-2" (whereas most my
other packages tend to be "GPL (>= 2)" ).  I was asked by a commercial
downstream redistributor to change the license, contacted all eighteen (18)
other copyright holders (as the package had a number of patches and pull
request) as one has to.  By the time the final 'ok' was given the original
was request was withdrawn after some refactoring.  I still went ahead and
changed this in the sources which will be reflected in the next upload. See
https://github.com/eddelbuettel/digest/issues/36 for the full thread.

| This apparently causes an issue with the Debian packaging system, throwing
| that other package into the "unstable" category. 

That is confused. "Unstable" is the normal staging area for new uploads, and
presumes nobody has an issue with the license. 

| Moreover, the correspondent asks me if I would consider changing the
| license for my package. To what is not specified, but I guess it would be
| to GPL-3.

I'd say "GPL (>= 2)"

| I don't really understand why this isn't the other developer's problem and not mine.

To the license lawyers, your package imposes a constraint by being GPL-2 not
allowing use with eg GPL-3.

Hope this helps, I am sure others will chip in too.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From russell-lenth at uiowa.edu  Sun Nov  6 10:11:20 2016
From: russell-lenth at uiowa.edu (Lenth, Russell V)
Date: Sun, 6 Nov 2016 09:11:20 +0000
Subject: [R-pkg-devel] Relicense to GPL-3?
In-Reply-To: <CO2PR04MB2214C560C989B50FE250530FF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
References: <CO2PR04MB2214C560C989B50FE250530FF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
Message-ID: <CO2PR04MB2214B821B46ECBF95053AA4DF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>

A correction and clarification...

It is MY package's GPL-2 license that is being violated by the other package -- not its GPL-3 license.

Let me lay it out with some generic names:
  * The 'foo' package specifies a GPL-2 license
  * The 'bar' package depends on 'foo', but specifies a GPL-3 license. That violates foo's GPL-2 license.

More details:
  * 'foo' provides a particular type of analysis embodied in a function named 'manchoo', 
     and provides methods for various classes.
  * 'bar' provides an S3 method for 'manchoo', via statements like this in its NAMESPACE file:
        importFrom(foo, manchoo)
        S3method(manchoo, bar)
  * The developer of 'foo' welcomes such expanded availability of 'manchoo' methods.

So there seem to be two ways to resolve this:
  1. The developer of 'foo' changes its license to GPL-3 (does that indeed resolve the license issue?)
      -- OR --
  2. The developer of 'bar' removes the dependency on 'foo', by not importing 'manchoo' or its
      S3method; instead, it simply exports the function 'manchoo.bar' and moves 'foo' to Suggests

Thanks for any suggestions

Russ

-----Original Message-----
From: Lenth, Russell V 
Sent: Saturday, November 5, 2016 9:28 PM
To: 'r-package-devel at r-project.org' <r-package-devel at r-project.org>
Subject: Relicense to GPL-3?

Dear all,

I received an email from a user telling me that another package that depends on my package is licensed GPL(>=3), whereas mine is licensed GPL-2; and that therefore, the other package is in violation of its GPL-3 license. This apparently causes an issue with the Debian packaging system, throwing that other package into the "unstable" category.

Moreover, the correspondent asks me if I would consider changing the license for my package. To what is not specified, but I guess it would be to GPL-3.

I don't really understand why this isn't the other developer's problem and not mine. But on the other hand, I don't want to cause problems for others. The licensing stuff is hard for me to understand - in large part because of low motivation to dig into it; I really would rather think about providing better code and features than all sorts of legal gobble-de-gook. Nonetheless, I guess this stuff is important to some people (e.g., Debian) so I suppose I had better get it right.

My decision to put GPL-2 in the first place was primarily expedience: it seemed like what people wanted. So is GPL-3 "better"? Do I risk anything by changing it? Do I risk anything by not changing it? How much does it matter, really?

Thanks

Russ

Russell V. Lenth? -? Professor Emeritus
Department of Statistics and Actuarial Science The University of Iowa ?-? Iowa City, IA 52242? USA Voice (319)335-0712 (Dept. office)? -? FAX (319)335-3017


From edd at debian.org  Sun Nov  6 14:24:51 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 6 Nov 2016 07:24:51 -0600
Subject: [R-pkg-devel] Relicense to GPL-3?
In-Reply-To: <CO2PR04MB2214B821B46ECBF95053AA4DF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
References: <CO2PR04MB2214C560C989B50FE250530FF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
	<CO2PR04MB2214B821B46ECBF95053AA4DF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
Message-ID: <22559.12067.382016.644257@max.nulle.part>


On 6 November 2016 at 09:11, Lenth, Russell V wrote:
| A correction and clarification...
| 
| It is MY package's GPL-2 license that is being violated by the other package -- not its GPL-3 license.

No, let's stop here.  I don't think that is legally (or conceptually !!)
possible. Your code, your repo, ... are all self-contained and "fine".  But,
and the big but, is that GPL-3 stipulates no mixing with GPL-2.
 
| Let me lay it out with some generic names:
|   * The 'foo' package specifies a GPL-2 license
|   * The 'bar' package depends on 'foo', but specifies a GPL-3 license. That violates foo's GPL-2 license.

"violate" is IMHO not the correct terms.  More like "prohibits use" per terms in GPL-3.
See eg

   https://www.gnu.org/licenses/gpl-faq.en.html

   https://www.gnu.org/licenses/old-licenses/gpl-2.0-faq.en.html


| More details:
|   * 'foo' provides a particular type of analysis embodied in a function named 'manchoo', 
|      and provides methods for various classes.
|   * 'bar' provides an S3 method for 'manchoo', via statements like this in its NAMESPACE file:
|         importFrom(foo, manchoo)
|         S3method(manchoo, bar)
|   * The developer of 'foo' welcomes such expanded availability of 'manchoo' methods.
| 
| So there seem to be two ways to resolve this:
|   1. The developer of 'foo' changes its license to GPL-3 (does that indeed resolve the license issue?)

Yes as said yesterday. "GPL (>= 2)" aka "GPL-2 | GPL-3" does.  You can of
course use _only_ GPL-3 (but there are a lot of people around R who keep
GPL-2, including R itself (!!) -- see 'license()' as the startup prompt
suggests and numerous packages written by R Core and others).

|       -- OR --
|   2. The developer of 'bar' removes the dependency on 'foo', by not importing 'manchoo' or its
|       S3method; instead, it simply exports the function 'manchoo.bar' and moves 'foo' to Suggests

Maybe -- but moving to Suggests, as easy as it seems, is probably not a real
solution as you still have co-use. Spirit of the law, letter of the law. In
any event that applies only to 'bar', and you are 'foo'.

Dirk
 
| Thanks for any suggestions
| 
| Russ
| 
| -----Original Message-----
| From: Lenth, Russell V 
| Sent: Saturday, November 5, 2016 9:28 PM
| To: 'r-package-devel at r-project.org' <r-package-devel at r-project.org>
| Subject: Relicense to GPL-3?
| 
| Dear all,
| 
| I received an email from a user telling me that another package that depends on my package is licensed GPL(>=3), whereas mine is licensed GPL-2; and that therefore, the other package is in violation of its GPL-3 license. This apparently causes an issue with the Debian packaging system, throwing that other package into the "unstable" category.
| 
| Moreover, the correspondent asks me if I would consider changing the license for my package. To what is not specified, but I guess it would be to GPL-3.
| 
| I don't really understand why this isn't the other developer's problem and not mine. But on the other hand, I don't want to cause problems for others. The licensing stuff is hard for me to understand - in large part because of low motivation to dig into it; I really would rather think about providing better code and features than all sorts of legal gobble-de-gook. Nonetheless, I guess this stuff is important to some people (e.g., Debian) so I suppose I had better get it right.
| 
| My decision to put GPL-2 in the first place was primarily expedience: it seemed like what people wanted. So is GPL-3 "better"? Do I risk anything by changing it? Do I risk anything by not changing it? How much does it matter, really?
| 
| Thanks
| 
| Russ
| 
| Russell V. Lenth? -? Professor Emeritus
| Department of Statistics and Actuarial Science The University of Iowa ?-? Iowa City, IA 52242? USA Voice (319)335-0712 (Dept. office)? -? FAX (319)335-3017
| 
| ______________________________________________
| R-package-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murdoch.duncan at gmail.com  Sun Nov  6 16:31:38 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 6 Nov 2016 10:31:38 -0500
Subject: [R-pkg-devel] Relicense to GPL-3?
In-Reply-To: <CO2PR04MB2214B821B46ECBF95053AA4DF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
References: <CO2PR04MB2214C560C989B50FE250530FF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
	<CO2PR04MB2214B821B46ECBF95053AA4DF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
Message-ID: <e1c236bf-9f59-b5f6-af79-b99ea684cd8e@gmail.com>

On 06/11/2016 4:11 AM, Lenth, Russell V wrote:
> A correction and clarification...
>
> It is MY package's GPL-2 license that is being violated by the other package -- not its GPL-3 license.
>
> Let me lay it out with some generic names:
>   * The 'foo' package specifies a GPL-2 license
>   * The 'bar' package depends on 'foo', but specifies a GPL-3 license. That violates foo's GPL-2 license.
>
> More details:
>   * 'foo' provides a particular type of analysis embodied in a function named 'manchoo',
>      and provides methods for various classes.
>   * 'bar' provides an S3 method for 'manchoo', via statements like this in its NAMESPACE file:
>         importFrom(foo, manchoo)
>         S3method(manchoo, bar)
>   * The developer of 'foo' welcomes such expanded availability of 'manchoo' methods.
>
> So there seem to be two ways to resolve this:
>   1. The developer of 'foo' changes its license to GPL-3 (does that indeed resolve the license issue?)
>       -- OR --
>   2. The developer of 'bar' removes the dependency on 'foo', by not importing 'manchoo' or its
>       S3method; instead, it simply exports the function 'manchoo.bar' and moves 'foo' to Suggests

And a third way is for the developer of 'bar' to allow it to be dual 
licensed as GPL 2 or 3, or something else more permissive than GPL 3. 
They may not be able to do that if they are not the sole copyright 
holder, just as you won't be able to do 1 without the permission of all 
other copyright holders.

Duncan Murdoch


>
> Thanks for any suggestions
>
> Russ
>
> -----Original Message-----
> From: Lenth, Russell V
> Sent: Saturday, November 5, 2016 9:28 PM
> To: 'r-package-devel at r-project.org' <r-package-devel at r-project.org>
> Subject: Relicense to GPL-3?
>
> Dear all,
>
> I received an email from a user telling me that another package that depends on my package is licensed GPL(>=3), whereas mine is licensed GPL-2; and that therefore, the other package is in violation of its GPL-3 license. This apparently causes an issue with the Debian packaging system, throwing that other package into the "unstable" category.
>
> Moreover, the correspondent asks me if I would consider changing the license for my package. To what is not specified, but I guess it would be to GPL-3.
>
> I don't really understand why this isn't the other developer's problem and not mine. But on the other hand, I don't want to cause problems for others. The licensing stuff is hard for me to understand - in large part because of low motivation to dig into it; I really would rather think about providing better code and features than all sorts of legal gobble-de-gook. Nonetheless, I guess this stuff is important to some people (e.g., Debian) so I suppose I had better get it right.
>
> My decision to put GPL-2 in the first place was primarily expedience: it seemed like what people wanted. So is GPL-3 "better"? Do I risk anything by changing it? Do I risk anything by not changing it? How much does it matter, really?
>
> Thanks
>
> Russ
>
> Russell V. Lenth  -  Professor Emeritus
> Department of Statistics and Actuarial Science The University of Iowa  -  Iowa City, IA 52242  USA Voice (319)335-0712 (Dept. office)  -  FAX (319)335-3017
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From russell-lenth at uiowa.edu  Sun Nov  6 17:53:37 2016
From: russell-lenth at uiowa.edu (Lenth, Russell V)
Date: Sun, 6 Nov 2016 16:53:37 +0000
Subject: [R-pkg-devel] Relicense to GPL-3?
In-Reply-To: <e1c236bf-9f59-b5f6-af79-b99ea684cd8e@gmail.com>
References: <CO2PR04MB2214C560C989B50FE250530FF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
	<CO2PR04MB2214B821B46ECBF95053AA4DF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>,
	<e1c236bf-9f59-b5f6-af79-b99ea684cd8e@gmail.com>
Message-ID: <435DF7EB-ACAE-42B2-B095-BBFA7F5653E7@uiowa.edu>

Permission of "all other copyright holders" as in developers of all packages that depend on 'foo'?

Russ

Sent from my iPhone

> On Nov 6, 2016, at 9:31 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
>> On 06/11/2016 4:11 AM, Lenth, Russell V wrote:
>> A correction and clarification...
>> 
>> It is MY package's GPL-2 license that is being violated by the other package -- not its GPL-3 license.
>> 
>> Let me lay it out with some generic names:
>>  * The 'foo' package specifies a GPL-2 license
>>  * The 'bar' package depends on 'foo', but specifies a GPL-3 license. That violates foo's GPL-2 license.
>> 
>> More details:
>>  * 'foo' provides a particular type of analysis embodied in a function named 'manchoo',
>>     and provides methods for various classes.
>>  * 'bar' provides an S3 method for 'manchoo', via statements like this in its NAMESPACE file:
>>        importFrom(foo, manchoo)
>>        S3method(manchoo, bar)
>>  * The developer of 'foo' welcomes such expanded availability of 'manchoo' methods.
>> 
>> So there seem to be two ways to resolve this:
>>  1. The developer of 'foo' changes its license to GPL-3 (does that indeed resolve the license issue?)
>>      -- OR --
>>  2. The developer of 'bar' removes the dependency on 'foo', by not importing 'manchoo' or its
>>      S3method; instead, it simply exports the function 'manchoo.bar' and moves 'foo' to Suggests
> 
> And a third way is for the developer of 'bar' to allow it to be dual licensed as GPL 2 or 3, or something else more permissive than GPL 3. They may not be able to do that if they are not the sole copyright holder, just as you won't be able to do 1 without the permission of all other copyright holders.
> 
> Duncan Murdoch
> 
> 
>> 
>> Thanks for any suggestions
>> 
>> Russ
>> 
>> -----Original Message-----
>> From: Lenth, Russell V
>> Sent: Saturday, November 5, 2016 9:28 PM
>> To: 'r-package-devel at r-project.org' <r-package-devel at r-project.org>
>> Subject: Relicense to GPL-3?
>> 
>> Dear all,
>> 
>> I received an email from a user telling me that another package that depends on my package is licensed GPL(>=3), whereas mine is licensed GPL-2; and that therefore, the other package is in violation of its GPL-3 license. This apparently causes an issue with the Debian packaging system, throwing that other package into the "unstable" category.
>> 
>> Moreover, the correspondent asks me if I would consider changing the license for my package. To what is not specified, but I guess it would be to GPL-3.
>> 
>> I don't really understand why this isn't the other developer's problem and not mine. But on the other hand, I don't want to cause problems for others. The licensing stuff is hard for me to understand - in large part because of low motivation to dig into it; I really would rather think about providing better code and features than all sorts of legal gobble-de-gook. Nonetheless, I guess this stuff is important to some people (e.g., Debian) so I suppose I had better get it right.
>> 
>> My decision to put GPL-2 in the first place was primarily expedience: it seemed like what people wanted. So is GPL-3 "better"? Do I risk anything by changing it? Do I risk anything by not changing it? How much does it matter, really?
>> 
>> Thanks
>> 
>> Russ
>> 
>> Russell V. Lenth  -  Professor Emeritus
>> Department of Statistics and Actuarial Science The University of Iowa  -  Iowa City, IA 52242  USA Voice (319)335-0712 (Dept. office)  -  FAX (319)335-3017
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> 
> 


From edd at debian.org  Sun Nov  6 18:10:45 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 6 Nov 2016 11:10:45 -0600
Subject: [R-pkg-devel] Relicense to GPL-3?
In-Reply-To: <435DF7EB-ACAE-42B2-B095-BBFA7F5653E7@uiowa.edu>
References: <CO2PR04MB2214C560C989B50FE250530FF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
	<CO2PR04MB2214B821B46ECBF95053AA4DF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
	<e1c236bf-9f59-b5f6-af79-b99ea684cd8e@gmail.com>
	<435DF7EB-ACAE-42B2-B095-BBFA7F5653E7@uiowa.edu>
Message-ID: <22559.25621.437619.896005@max.nulle.part>


On 6 November 2016 at 16:53, Lenth, Russell V wrote:
| Permission of "all other copyright holders" as in developers of all packages that depend on 'foo'?

Please do have a look at the two FAQs I referenced before:

   https://www.gnu.org/licenses/gpl-faq.en.html

   https://www.gnu.org/licenses/old-licenses/gpl-2.0-faq.en.html

In particular this last question of yours is addressed in

   https://www.gnu.org/licenses/gpl-faq.html#HeardOtherLicense

Dependent packages are of cause NOT the copyright holders. Rather, the
authors of a package (ie you, and whoever worked with you) are.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From henrik.bengtsson at gmail.com  Sun Nov  6 19:05:10 2016
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Sun, 6 Nov 2016 10:05:10 -0800
Subject: [R-pkg-devel] Relicense to GPL-3?
In-Reply-To: <22559.25621.437619.896005@max.nulle.part>
References: <CO2PR04MB2214C560C989B50FE250530FF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
	<CO2PR04MB2214B821B46ECBF95053AA4DF1A40@CO2PR04MB2214.namprd04.prod.outlook.com>
	<e1c236bf-9f59-b5f6-af79-b99ea684cd8e@gmail.com>
	<435DF7EB-ACAE-42B2-B095-BBFA7F5653E7@uiowa.edu>
	<22559.25621.437619.896005@max.nulle.part>
Message-ID: <CAFDcVCSO+mjxY29_AvAB7yUHbd03dt5HkzqYY2Twhq81wBWg-A@mail.gmail.com>

What's already been said is good advice.  At first, it may be a bit
tricky to under copyright and licenses.  When I started out, I for the
longest held back on releasing software / packages because I somehow
thought I basically had to make a final decision on the license at
that moment and that the license was stuck forever.  I was wrong.  It
will stick forever, but only per release.

Here is how *I* think of copyright and software licenses these days:

* The copyright holder of a piece of software is the one who can
decide on what license he or she would like to distribute that
software.

* If there are multiple copyright holders of your software, then all
of you need to agree on the license.

* If someone contributed a non-trivial part of code to your software,
then that person holds copyright to that piece of code.  From this
point in time, your software has two copyright holders.

* For you to remain the sole copyright holder, you need to make an
explicit agreement with the other person that s/he transfer the
copyright to you.  Some maintainers (private person and / or
companies) do this in order to keep full control of the decision on
software licenses (for monetary and / or practical purposes).

* When releasing a software under a specific license, then you give
the users the rights specified in that license.

* It is not possible to revoke licenses retroactively because then you
would break the rights you have already given the users.  If version
1.0 was released with license A, you cannot go back a say it now
should be license B instead.

* At any time, the copyright holder may choose to use a different
license of a _future_ version of the software.  Even if version 1.0
was released with license A, version 1.1 can be with license B (and
license A can be dropped).

* Software can be release with multiple licenses.  You can choose to
release version 1.1 under license A and license B.  Then it is up to
the user to choose which one s/he wish to follow / agree to.  Moving
from GPL 2 to GPL (>= 2) == GPL 2 | GPL 3 would be such an example.

* If you're not the sole copyright holder, and you cannot agree with
the others or you fail to get in touch with the others (e.g. person
passed away), then the only way for you to become the sole copyright
holder is to remove the parts of the code that you don't have
copyright to.  When the remaining code is truly yours, i.e. you are
the sole copyright holder, then you have all the rights to choose
license going forward.

So, in your case, it is only people who have contributed to your piece
of software ("foo") that can make copyright claims to it.  Any
software that depends on your software is completely irrelevant to
this.  If you're the only one who contributed to your package, then
you can choose whatever licenses you want going forward (=next
version).  Also, the license of your software "foo" sets the rules for
any software that depends on it, and not the other way around (unless
you have a circular dependency, which is extremely rare).

Hope this helps

Henrik

On Sun, Nov 6, 2016 at 9:10 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 6 November 2016 at 16:53, Lenth, Russell V wrote:
> | Permission of "all other copyright holders" as in developers of all packages that depend on 'foo'?
>
> Please do have a look at the two FAQs I referenced before:
>
>    https://www.gnu.org/licenses/gpl-faq.en.html
>
>    https://www.gnu.org/licenses/old-licenses/gpl-2.0-faq.en.html
>
> In particular this last question of yours is addressed in
>
>    https://www.gnu.org/licenses/gpl-faq.html#HeardOtherLicense
>
> Dependent packages are of cause NOT the copyright holders. Rather, the
> authors of a package (ie you, and whoever worked with you) are.
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From vonehrenheim at gmail.com  Thu Nov 10 17:38:45 2016
From: vonehrenheim at gmail.com (Vilhelm von Ehrenheim)
Date: Thu, 10 Nov 2016 17:38:45 +0100
Subject: [R-pkg-devel] Using BLAS on Windows
In-Reply-To: <CAJ1MkgJFWiOq2qxCKJEi5ozoHcy9_Ui-U4gv0uQA_som9X7vOA@mail.gmail.com>
References: <CAJ1MkgJFWiOq2qxCKJEi5ozoHcy9_Ui-U4gv0uQA_som9X7vOA@mail.gmail.com>
Message-ID: <CAJ1MkgKy-Qx=K1+T0Cq7KDVB1xAqJ9_8smgzbx5OX28KJoFv5A@mail.gmail.com>

Hi!
I've tried to submit a package to CRAN that fails to build on windows as it
cannot find BLAS.

Here is the error:
```
#> lognet.o:lognet.c:(.text+0x8c): undefined reference to `dgemv_'
#> lognet.o:lognet.c:(.text+0x3d7): undefined reference to `dgemv_'
```

It works fine to build on linux machines and I'm currently using rhub to
try and build it on windows. I got a pointer from the denied CRAN
submission that I need to set my Makevars.win properly but I can't find how
to do this is a way that makes it work on Windows. Im no windows user so i
really dont understand what im doing.

My package is located here on github:
https://github.com/while/FTRLProximal

Any help would be greatly apprechiated.

Regards,
Vilhelm von Ehrenheim

	[[alternative HTML version deleted]]


From wdunlap at tibco.com  Thu Nov 10 18:34:12 2016
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 10 Nov 2016 09:34:12 -0800
Subject: [R-pkg-devel] Using BLAS on Windows
In-Reply-To: <CAJ1MkgKy-Qx=K1+T0Cq7KDVB1xAqJ9_8smgzbx5OX28KJoFv5A@mail.gmail.com>
References: <CAJ1MkgJFWiOq2qxCKJEi5ozoHcy9_Ui-U4gv0uQA_som9X7vOA@mail.gmail.com>
	<CAJ1MkgKy-Qx=K1+T0Cq7KDVB1xAqJ9_8smgzbx5OX28KJoFv5A@mail.gmail.com>
Message-ID: <CAF8bMcZwCrWgZ7963iAZjbq4M3C=L8rEas_ELZ0LWVQpsb17sw@mail.gmail.com>

The MGGM package has the following in src/Makevars.win to tell the linker
to link with the Lapack, BLAS, and Fortran libraries.

PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)

Its Makevars file is identical - is that Makevars.win really needed?  I
don't see Makevars or Makevars.win in your github site.


Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Thu, Nov 10, 2016 at 8:38 AM, Vilhelm von Ehrenheim <
vonehrenheim at gmail.com> wrote:

> Hi!
> I've tried to submit a package to CRAN that fails to build on windows as it
> cannot find BLAS.
>
> Here is the error:
> ```
> #> lognet.o:lognet.c:(.text+0x8c): undefined reference to `dgemv_'
> #> lognet.o:lognet.c:(.text+0x3d7): undefined reference to `dgemv_'
> ```
>
> It works fine to build on linux machines and I'm currently using rhub to
> try and build it on windows. I got a pointer from the denied CRAN
> submission that I need to set my Makevars.win properly but I can't find how
> to do this is a way that makes it work on Windows. Im no windows user so i
> really dont understand what im doing.
>
> My package is located here on github:
> https://github.com/while/FTRLProximal
>
> Any help would be greatly apprechiated.
>
> Regards,
> Vilhelm von Ehrenheim
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From vonehrenheim at gmail.com  Thu Nov 10 18:42:56 2016
From: vonehrenheim at gmail.com (Vilhelm von Ehrenheim)
Date: Thu, 10 Nov 2016 18:42:56 +0100
Subject: [R-pkg-devel] Using BLAS on Windows
In-Reply-To: <CAF8bMcZwCrWgZ7963iAZjbq4M3C=L8rEas_ELZ0LWVQpsb17sw@mail.gmail.com>
References: <CAJ1MkgJFWiOq2qxCKJEi5ozoHcy9_Ui-U4gv0uQA_som9X7vOA@mail.gmail.com>
	<CAJ1MkgKy-Qx=K1+T0Cq7KDVB1xAqJ9_8smgzbx5OX28KJoFv5A@mail.gmail.com>
	<CAF8bMcZwCrWgZ7963iAZjbq4M3C=L8rEas_ELZ0LWVQpsb17sw@mail.gmail.com>
Message-ID: <CAJ1MkgJyn3dTt4jq=jKcjFK9-AL0MM4TN0=A7_i3xtv9dbr4RA@mail.gmail.com>

No I didn't have any Makevars at all to begin with. I was just trying to
add it locallynow and using r-hub to build on windows.

However, your reply made me realize I put the file in the package root and
not in `src/`. Moving the file solved the problem and yes, it seems to be
sufficient to add only a `src/Makevars` and no Makevars.win.

Feel a bit stupid. Thank you so much for your help!


On Thu, Nov 10, 2016 at 6:34 PM, William Dunlap <wdunlap at tibco.com> wrote:

> The MGGM package has the following in src/Makevars.win to tell the linker
> to link with the Lapack, BLAS, and Fortran libraries.
>
> PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)
>
> Its Makevars file is identical - is that Makevars.win really needed?  I
> don't see Makevars or Makevars.win in your github site.
>
>
> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com
>
> On Thu, Nov 10, 2016 at 8:38 AM, Vilhelm von Ehrenheim <
> vonehrenheim at gmail.com> wrote:
>
>> Hi!
>> I've tried to submit a package to CRAN that fails to build on windows as
>> it
>> cannot find BLAS.
>>
>> Here is the error:
>> ```
>> #> lognet.o:lognet.c:(.text+0x8c): undefined reference to `dgemv_'
>> #> lognet.o:lognet.c:(.text+0x3d7): undefined reference to `dgemv_'
>> ```
>>
>> It works fine to build on linux machines and I'm currently using rhub to
>> try and build it on windows. I got a pointer from the denied CRAN
>> submission that I need to set my Makevars.win properly but I can't find
>> how
>> to do this is a way that makes it work on Windows. Im no windows user so i
>> really dont understand what im doing.
>>
>> My package is located here on github:
>> https://github.com/while/FTRLProximal
>>
>> Any help would be greatly apprechiated.
>>
>> Regards,
>> Vilhelm von Ehrenheim
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
>

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Thu Nov 10 18:45:21 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 10 Nov 2016 12:45:21 -0500
Subject: [R-pkg-devel] Using BLAS on Windows
In-Reply-To: <CAJ1MkgKy-Qx=K1+T0Cq7KDVB1xAqJ9_8smgzbx5OX28KJoFv5A@mail.gmail.com>
References: <CAJ1MkgJFWiOq2qxCKJEi5ozoHcy9_Ui-U4gv0uQA_som9X7vOA@mail.gmail.com>
	<CAJ1MkgKy-Qx=K1+T0Cq7KDVB1xAqJ9_8smgzbx5OX28KJoFv5A@mail.gmail.com>
Message-ID: <be37416e-3d1f-daa3-2e24-435e6e943a4c@gmail.com>

On 10/11/2016 11:38 AM, Vilhelm von Ehrenheim wrote:
> Hi!
> I've tried to submit a package to CRAN that fails to build on windows as it
> cannot find BLAS.
>
> Here is the error:
> ```
> #> lognet.o:lognet.c:(.text+0x8c): undefined reference to `dgemv_'
> #> lognet.o:lognet.c:(.text+0x3d7): undefined reference to `dgemv_'
> ```
>
> It works fine to build on linux machines and I'm currently using rhub to
> try and build it on windows. I got a pointer from the denied CRAN
> submission that I need to set my Makevars.win properly but I can't find how
> to do this is a way that makes it work on Windows. Im no windows user so i
> really dont understand what im doing.
>
> My package is located here on github:
> https://github.com/while/FTRLProximal
>
> Any help would be greatly apprechiated.

Pretty commonly packages have a Makevars.win file containing a single 
line like:

PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)

I don't know if you need LAPACK and Fortran libs; try it without those 
if you want.  R will set the macros appropriately when it is built.

Duncan Murdoch


From pedro.aphalo at helsinki.fi  Sat Nov 12 18:38:54 2016
From: pedro.aphalo at helsinki.fi (Pedro J. Aphalo)
Date: Sat, 12 Nov 2016 19:38:54 +0200
Subject: [R-pkg-devel] Packages extending ggplot2 and ggplot2 2.2.0
Message-ID: <794e148a-13ac-181a-8c73-3332f90e5be7@helsinki.fi>

Hello,

What is the best way to handle the need to reinstall FROM SOURCES 
packages ggpmisc, ggspectra, ggrepel, etc. after updating ggplot2 to the 
current version?

The message:
"Error: StatPeaks was built with an incompatible version of ggproto.
Please reinstall the package that provides this extension."

under Windows may be confusing as reinstalling using the default, from 
binaries, will not solve the problem.
Will binaries be rebuilt in CRAN? I guess not because they would not 
work with ggplot2 (< 2.2.0)...

So, my question is, as maintainer of ggpmisc and ggspectra, should I 
release new versions that import ggplot2 (>= 2.2.0)?

This would be easy enough, and in the case of ggspectra there are 
already some bug fixes that would be good to include in a release. In 
the case of ggpmisc, I have submitted a version to CRAN quite recently.

Best regards,

Pedro.

-- 
------------------------------------------------------------------------
Pedro J. Aphalo
University Lecturer, Principal Investigator
(Office 3805, Biocenter 3, Viikinkaari 1)

Department of Biosciences
Plant Biology
P.O. Box 65
00014 University of Helsinki
Finland

e-mail: pedro.aphalo at helsinki.fi <mailto:pedro.aphalo at helsinki.fi>
Tel. (mobile) +358 50 4150623
Tel. (office) +358 2941 57897

------------------------------------------------------------------------
*Web sites and blogs*
Web site (research group): http://blogs.helsinki.fi/senpep-blog/
Web site (own teaching): http://www.helsinki.fi/people/pedro.aphalo/
Blog (for plant science students): 
http://www.r4photobiology.info/blog4students/
Web site (using R in photobiology): http://www.r4photobiology.info/
------------------------------------------------------------------------
*Societies*
UV4Plants <http://www.uv4plants.org/> (communications officer), PSB 
<http://www.plantbehavior.org/> (member), ESP 
<http://www.photobiology.eu/> (member) SEB <http://www.sebiology.org/> 
(member), BES <http://www.britishecologicalsociety.org/> (member), SPPS 
<http://www.spps.fi/> (member), SMS 
<http://www.metsatieteellinenseura.fi/english> (member), TUG 
<http://tug.org/> (member), FOAS <http://www.foastat.org/> (member).
------------------------------------------------------------------------

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Sat Nov 12 22:18:52 2016
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 12 Nov 2016 22:18:52 +0100
Subject: [R-pkg-devel] Packages extending ggplot2 and ggplot2 2.2.0
In-Reply-To: <794e148a-13ac-181a-8c73-3332f90e5be7@helsinki.fi>
References: <794e148a-13ac-181a-8c73-3332f90e5be7@helsinki.fi>
Message-ID: <6c2db334-7d03-2960-e64e-3dd6fceef8fa@statistik.tu-dortmund.de>



On 12.11.2016 18:38, Pedro J. Aphalo wrote:
> Hello,
>
> What is the best way to handle the need to reinstall FROM SOURCES
> packages ggpmisc, ggspectra, ggrepel, etc. after updating ggplot2 to the
> current version?
>
> The message:
> "Error: StatPeaks was built with an incompatible version of ggproto.
> Please reinstall the package that provides this extension."
>
> under Windows may be confusing as reinstalling using the default, from
> binaries, will not solve the problem.

It will.


> Will binaries be rebuilt in CRAN?


Yes, at least for Windows.


> I guess not because they would not
> work with ggplot2 (< 2.2.0)...

They will fit to the ggplot2 version that is available.


> So, my question is, as maintainer of ggpmisc and ggspectra, should I
> release new versions that import ggplot2 (>= 2.2.0)?

Not needed.

Best,
Uwe Ligges



> This would be easy enough, and in the case of ggspectra there are
> already some bug fixes that would be good to include in a release. In
> the case of ggpmisc, I have submitted a version to CRAN quite recently.
>
> Best regards,
>
> Pedro.
>


From kamvarz at science.oregonstate.edu  Wed Nov 16 18:41:00 2016
From: kamvarz at science.oregonstate.edu (Zhian Kamvar)
Date: Wed, 16 Nov 2016 09:41:00 -0800
Subject: [R-pkg-devel] Change in maintainer email address
Message-ID: <F9A1BFA2-06AF-409F-AECB-DF1F46D61D72@science.oregonstate.edu>

Hello,

Does anyone have experience in the process needed to change the maintainer's email address on a package? Should the the maintainer preemptively send an email to CRAN notifying the upcoming change, or should the package be submitted first?

Thanks,
Zhian

From murdoch.duncan at gmail.com  Wed Nov 16 18:52:36 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 16 Nov 2016 12:52:36 -0500
Subject: [R-pkg-devel] Change in maintainer email address
In-Reply-To: <F9A1BFA2-06AF-409F-AECB-DF1F46D61D72@science.oregonstate.edu>
References: <F9A1BFA2-06AF-409F-AECB-DF1F46D61D72@science.oregonstate.edu>
Message-ID: <977fc9ee-52c5-eab7-42b2-0688bd9d804d@gmail.com>

On 16/11/2016 12:41 PM, Zhian Kamvar wrote:
> Hello,
>
> Does anyone have experience in the process needed to change the maintainer's email address on a package? Should the the maintainer preemptively send an email to CRAN notifying the upcoming change, or should the package be submitted first?
>

They should both happen around the same time.  It doesn't matter what order.

If one happens too much before the other, things are likely to go wrong 
and cause both you and CRAN extra work.

Duncan Murdoch


From edd at debian.org  Wed Nov 16 18:54:09 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 16 Nov 2016 11:54:09 -0600
Subject: [R-pkg-devel] Change in maintainer email address
In-Reply-To: <F9A1BFA2-06AF-409F-AECB-DF1F46D61D72@science.oregonstate.edu>
References: <F9A1BFA2-06AF-409F-AECB-DF1F46D61D72@science.oregonstate.edu>
Message-ID: <22572.40257.463081.693848@max.nulle.part>


On 16 November 2016 at 09:41, Zhian Kamvar wrote:
| Hello,
| 
| Does anyone have experience in the process needed to change the maintainer's email address on a package? Should the the maintainer preemptively send an email to CRAN notifying the upcoming change, or should the package be submitted first?

>From the CRAN Policy

     * Explain any change in the maintainer?s email address and if possible
       send confirmation from the previous address (by a separate email to
       CRAN at R-project.org) or explain why it is not possible.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From lbusett at gmail.com  Fri Nov 18 23:04:53 2016
From: lbusett at gmail.com (Lorenzo Busetto)
Date: Fri, 18 Nov 2016 23:04:53 +0100
Subject: [R-pkg-devel] Question about configure file and system requirements
Message-ID: <CAM1G4SQmB4WXfD795PUQG6DoBJT2Ein-k1aaBseWnUxNMAauRg@mail.gmail.com>

Dear all,

    a  quick question:

while preparing for a CRAN submission, am I supposed to include  a
"configure" file and list for system requirements also if those system
requirements "come from" the packages that I import ?

Asking this because the "configure" and system requirements are already
present in the imported packages, so my configuration check would duplicate
what is already done while installing the dependencies.

sorry if this is dumb...

Lorenzo

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Mon Nov 21 10:15:05 2016
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 21 Nov 2016 10:15:05 +0100
Subject: [R-pkg-devel] Question about configure file and system
	requirements
In-Reply-To: <CAM1G4SQmB4WXfD795PUQG6DoBJT2Ein-k1aaBseWnUxNMAauRg@mail.gmail.com>
References: <CAM1G4SQmB4WXfD795PUQG6DoBJT2Ein-k1aaBseWnUxNMAauRg@mail.gmail.com>
Message-ID: <22578.47897.298176.227640@stat.math.ethz.ch>

>>>>> Lorenzo Busetto <lbusett at gmail.com>
>>>>>     on Fri, 18 Nov 2016 23:04:53 +0100 writes:

    > Dear all, a quick question:

    > while preparing for a CRAN submission, am I supposed to
    > include a "configure" file and list for system
    > requirements also if those system requirements "come from"
    > the packages that I import ?

If the requirements are *only* in these packages, and not
(directly) in your package's functions,
you should *not* duplicate the checks (nor the entries in
DESCRIPTION),

by the same logic that you should not list 'Depends', 'Imports',
'Suggests', etc of those packages.

Martin Maechler
ETH Zurich

    > Asking this because the "configure" and system
    > requirements are already present in the imported packages,
    > so my configuration check would duplicate what is already
    > done while installing the dependencies.

    > sorry if this is dumb...

    > Lorenzo


From lbusett at gmail.com  Mon Nov 21 10:33:18 2016
From: lbusett at gmail.com (Lorenzo Busetto)
Date: Mon, 21 Nov 2016 10:33:18 +0100
Subject: [R-pkg-devel] Question about configure file and system
	requirements
In-Reply-To: <22578.47897.298176.227640@stat.math.ethz.ch>
References: <CAM1G4SQmB4WXfD795PUQG6DoBJT2Ein-k1aaBseWnUxNMAauRg@mail.gmail.com>
	<22578.47897.298176.227640@stat.math.ethz.ch>
Message-ID: <CAM1G4SR=U95gOF-ev40e1ppT8twGmBbsWDJpyi9wUM967XD7Jw@mail.gmail.com>

Hi Martin,

    thanks for your reply.

That's what I thought (hoped), but I wanted to be sure before submitting.

Lorenzo

On 21 November 2016 at 10:15, Martin Maechler <maechler at stat.math.ethz.ch>
wrote:

> >>>>> Lorenzo Busetto <lbusett at gmail.com>
> >>>>>     on Fri, 18 Nov 2016 23:04:53 +0100 writes:
>
>     > Dear all, a quick question:
>
>     > while preparing for a CRAN submission, am I supposed to
>     > include a "configure" file and list for system
>     > requirements also if those system requirements "come from"
>     > the packages that I import ?
>
> If the requirements are *only* in these packages, and not
> (directly) in your package's functions,
> you should *not* duplicate the checks (nor the entries in
> DESCRIPTION),
>
> by the same logic that you should not list 'Depends', 'Imports',
> 'Suggests', etc of those packages.
>
> Martin Maechler
> ETH Zurich
>
>     > Asking this because the "configure" and system
>     > requirements are already present in the imported packages,
>     > so my configuration check would duplicate what is already
>     > done while installing the dependencies.
>
>     > sorry if this is dumb...
>
>     > Lorenzo
>

	[[alternative HTML version deleted]]


From nawendt84 at gmail.com  Thu Nov 24 06:12:26 2016
From: nawendt84 at gmail.com (nawendt84 at gmail.com)
Date: Wed, 23 Nov 2016 23:12:26 -0600
Subject: [R-pkg-devel] R_useDynamicSymbols and R_forceSymbols
Message-ID: <583676ba.4564630a.f5001.5329@mx.google.com>

I am trying to get a handle on what R_useDynamicSymbols and R_forceSymbols are used for in the C init functions for R packages. From the documentation, they appear to have something to do with controlling visibility of functions within the compiled package library, but there is no description of when to use them and what Boolean value should be passed to them. Looking at several other R packages with C code, they all seem to use R_useDynamicSymbols and pass it false. Does anyone know when these should be used and why?

Thanks,


Nathan Wendt
Meteorologist, CIMMS/SPC Research Associate
2330 National Weather Center
120 David L Boren Blvd.
Norman, OK 73072


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus

	[[alternative HTML version deleted]]


From paul.buerkner at gmail.com  Sat Nov 26 17:40:11 2016
From: paul.buerkner at gmail.com (Paul Buerkner)
Date: Sat, 26 Nov 2016 17:40:11 +0100
Subject: [R-pkg-devel] problem with vignette index entries
Message-ID: <CAGoSky-qJ3H=E3mV6OP3oHu_G5W-cMATtegLWUy0ZTyNh12aeA@mail.gmail.com>

Hi all,

I have a problem with the vignette index entries of the brms package on
CRAN.

The main vignette (called brms.pdf in the inst/doc directory) is not
correctly indexed as "brms", and thus not accessible via vignette("brms").
Instead, for some reason, it takes over the name of another of the packages
vignettes called "brms_distreg". I assume it has something to do with
"brms" being the prefix of "brms_distreg", but I am not sure.

This happens only when downloading brms from CRAN, but not when building
the package locally, where vignette("brms") works correctly.

I am thankful for any kind of advice how to fix this problem!

All the best,
Paul

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Sun Nov 27 00:23:08 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 26 Nov 2016 18:23:08 -0500
Subject: [R-pkg-devel] problem with vignette index entries
In-Reply-To: <CAGoSky-qJ3H=E3mV6OP3oHu_G5W-cMATtegLWUy0ZTyNh12aeA@mail.gmail.com>
References: <CAGoSky-qJ3H=E3mV6OP3oHu_G5W-cMATtegLWUy0ZTyNh12aeA@mail.gmail.com>
Message-ID: <12942cc8-9ee7-df51-eb52-dc11e8b0958a@gmail.com>

On 26/11/2016 11:40 AM, Paul Buerkner wrote:
> Hi all,
>
> I have a problem with the vignette index entries of the brms package on
> CRAN.
>
> The main vignette (called brms.pdf in the inst/doc directory) is not
> correctly indexed as "brms", and thus not accessible via vignette("brms").
> Instead, for some reason, it takes over the name of another of the packages
> vignettes called "brms_distreg". I assume it has something to do with
> "brms" being the prefix of "brms_distreg", but I am not sure.
>
> This happens only when downloading brms from CRAN, but not when building
> the package locally, where vignette("brms") works correctly.
>
> I am thankful for any kind of advice how to fix this problem!
>

That looks like a bug in the vignette() function.  If you run 
help.start(), and click through to the vignette listing for your 
package, you'll see brms.pdf separately from brms_distreg.html.

Please post this as a bug report on bugs.r-project.org, and eventually 
someone will look into it.  (It might be me, but not in the next few weeks.)

If you aren't already registered to post bug reports there, let me know, 
and I'll create an account for you.  Because of spammers, we no longer 
allow automatic registrations.

Duncan Murdoch


From paul.buerkner at gmail.com  Sun Nov 27 11:38:16 2016
From: paul.buerkner at gmail.com (Paul Buerkner)
Date: Sun, 27 Nov 2016 11:38:16 +0100
Subject: [R-pkg-devel] problem with vignette index entries
In-Reply-To: <12942cc8-9ee7-df51-eb52-dc11e8b0958a@gmail.com>
References: <CAGoSky-qJ3H=E3mV6OP3oHu_G5W-cMATtegLWUy0ZTyNh12aeA@mail.gmail.com>
	<12942cc8-9ee7-df51-eb52-dc11e8b0958a@gmail.com>
Message-ID: <CAGoSky_nRst40K01yStHaFRViNRx8rJ5mkXg-MdysQxUvaaCKA@mail.gmail.com>

Thanks for quick response. I don't have an account yet but will submit a
bug report as soon as the account is working.

Best,
Paul


2016-11-27 0:23 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:

> On 26/11/2016 11:40 AM, Paul Buerkner wrote:
>
>> Hi all,
>>
>> I have a problem with the vignette index entries of the brms package on
>> CRAN.
>>
>> The main vignette (called brms.pdf in the inst/doc directory) is not
>> correctly indexed as "brms", and thus not accessible via vignette("brms").
>> Instead, for some reason, it takes over the name of another of the
>> packages
>> vignettes called "brms_distreg". I assume it has something to do with
>> "brms" being the prefix of "brms_distreg", but I am not sure.
>>
>> This happens only when downloading brms from CRAN, but not when building
>> the package locally, where vignette("brms") works correctly.
>>
>> I am thankful for any kind of advice how to fix this problem!
>>
>>
> That looks like a bug in the vignette() function.  If you run
> help.start(), and click through to the vignette listing for your package,
> you'll see brms.pdf separately from brms_distreg.html.
>
> Please post this as a bug report on bugs.r-project.org, and eventually
> someone will look into it.  (It might be me, but not in the next few weeks.)
>
> If you aren't already registered to post bug reports there, let me know,
> and I'll create an account for you.  Because of spammers, we no longer
> allow automatic registrations.
>
> Duncan Murdoch
>
>

	[[alternative HTML version deleted]]


From thierry.onkelinx at inbo.be  Mon Nov 28 16:19:06 2016
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Mon, 28 Nov 2016 16:19:06 +0100
Subject: [R-pkg-devel] Conflicting S3 imports?
Message-ID: <CAJuCY5xvCeTu-ogWakjuLujPo-vSnDzdA_4jSW-R4saVfPDL_g@mail.gmail.com>

Dear all,

When building my package "A" I get following warning.

class "inla" is defined (with package slot ?B?) but no metadata object
found to revise superClass information---not exported?  Making a copy in
package ?A?

- Both packages "A" and "B" use setOldClass("inla") to import the S3 class
"inla".
- Both package define S4 methods for the "inla" class.
- Package "B" defines two S4 classes, none of them have a slot of class
"inla".
- Package "A" defines several S4 classes. One of them ("cA") has a slot of
class "maybeInla", which is defined as setClassUnion("maybeInla", c("inla",
"NULL"))
- The "cA" class uses a slot of class "cB". "cB" is imported from package
"B".

Can someone explain me the warning. And give me a hint on how to avoid it?

Best regards,

Thierry


ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

	[[alternative HTML version deleted]]


From aarti.s2014 at gmail.com  Fri Dec  2 00:15:38 2016
From: aarti.s2014 at gmail.com (Aarti Singh)
Date: Thu, 1 Dec 2016 17:15:38 -0600
Subject: [R-pkg-devel] Error in dyn.load(dllfile) : unable to load shared
	object
Message-ID: <CAExJ3=Kp-K4zoRabaJPSk5rDYqHM=3SJndSzQkihcmEm6QQjqQ@mail.gmail.com>

Hello,

I am new to R package development. I am working on a package that has in
its src folder  one (prime) cpp file and some helper cpp (X.Cpp, Y.Cpp) and
one c file (Z.C) and their header files (X.h, Y.h and Z.h)

I am getting the following error when I do 'Build & Reload' in Rstudio.

"
Error in dyn.load(dllfile) :
  unable to load shared object '/Users/abcd/BART/bart_pkg1/src/bartpkg.so':
  dlopen(/Users/abcd/BART/bart_pkg1/src/bartpkg.so, 6): Symbol not found:
__ZN3RNG4nfixElm
  Referenced from: /Users/abcd/BART/bart_pkg1/src/bartpkg.so
  Expected in: flat namespace
 in /Users/abcd/BART/bart_pkg1/src/bartpkg.so
Calls: suppressPackageStartupMessages ... <Anonymous> -> load_all ->
load_dll -> library.dynam2 -> dyn.load
Execution halted

Exited with status 1.

"

I have followed the basic guidelines to build the package.

The .R file has directive #' @useDynLib bartpkg in the right place.

Also, the prime cpp file has the following tags in the right place.
1. #include <Rcpp.h>
  using namespace Rcpp;
2.  //' @param x A single integer.
     //' @export
     // [[Rcpp::export]]


And my NAMESPACE file shows 'useDynLib(bartpkg)' correctly.

I am able to see the 'bartpkg.so' shared object file in the src directory.


I tried in the terminal this command "c++filt -n _ZN3RNG4nfixElm" and was
able to see that the symbol in the error ' Symbol not found:
__ZN3RNG4nfixElm' is coming from the .C file RNG.C and is because of a
function 'nfix'.

But even if I remove the function 'nfix' or remove the RNG.C file
altogether, the same error ' Symbol not found: __ZN3RNG4nfixElm' comes.

can it  be a flag issue that my compiler is not able to compile the 'C'
file?
I am able to see that all the cpp files generate respective object files,
but I dont see anything like that for the C file.

I am using RStudio is the session info is
> sessionInfo()
R version 3.3.1 (2016-06-21)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.11.6 (El Capitan)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] bartpkg_0.1.0        packrat_0.4.8-1      Rcpp_0.12.8
msm_1.6.4            LaplacesDemon_16.0.1

loaded via a namespace (and not attached):
 [1] roxygen2_5.0.1  lattice_0.20-34 mvtnorm_1.0-5   digest_0.6.10
grid_3.3.1      magrittr_1.5
 [7] stringi_1.1.2   Matrix_1.2-7.1  splines_3.3.1   tools_3.3.1
stringr_1.1.0   survival_2.39-5
[13] parallel_3.3.1  rsconnect_0.5   inline_0.3.14   expm_0.999-0

I am stuck at this problem for weeks now.
Any help would be highly appreciated.


Thank you.

-Aarti

	[[alternative HTML version deleted]]


From gillian at iris.washington.edu  Fri Dec  2 01:31:23 2016
From: gillian at iris.washington.edu (Gillian Sharer)
Date: Thu, 1 Dec 2016 16:31:23 -0800
Subject: [R-pkg-devel] R checks, compiling C code and Windows ISO C warning
Message-ID: <C7A7D310-8644-4C8E-9027-3134513B224D@iris.washington.edu>


I?m trying to submit an R package to CRAN that contains C code and I cannot get past an issue with compiling on Windows. Specifically I have this line of C code, reading data in 64 bit:

> sscanf (hdrstr, " %"SCNd64, &datasize);


To me this seems like good and portable code. But CRAN checks on Windows give this warning:

> warning: ISO C does not support the 'I64' ms_scanf length modifier [-Wformat=]


The code as it is works fine on Windows, but I can?t find a way to get around this warning. Does anyone know of a better solution to read in 64 bit data?

Thanks,
Gillian Sharer
gillian at iris.washington.edu


From edd at debian.org  Fri Dec  2 05:15:25 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 1 Dec 2016 22:15:25 -0600
Subject: [R-pkg-devel] Error in dyn.load(dllfile) : unable to load
	shared	object
In-Reply-To: <CAExJ3=Kp-K4zoRabaJPSk5rDYqHM=3SJndSzQkihcmEm6QQjqQ@mail.gmail.com>
References: <CAExJ3=Kp-K4zoRabaJPSk5rDYqHM=3SJndSzQkihcmEm6QQjqQ@mail.gmail.com>
Message-ID: <22592.62813.402413.636295@max.nulle.part>


On 1 December 2016 at 17:15, Aarti Singh wrote:
| Hello,
| 
| I am new to R package development. I am working on a package that has in
| its src folder  one (prime) cpp file and some helper cpp (X.Cpp, Y.Cpp) and
| one c file (Z.C) and their header files (X.h, Y.h and Z.h)
| 
| I am getting the following error when I do 'Build & Reload' in Rstudio.
| 
| "
| Error in dyn.load(dllfile) :
|   unable to load shared object '/Users/abcd/BART/bart_pkg1/src/bartpkg.so':
|   dlopen(/Users/abcd/BART/bart_pkg1/src/bartpkg.so, 6): Symbol not found:
| __ZN3RNG4nfixElm
|   Referenced from: /Users/abcd/BART/bart_pkg1/src/bartpkg.so
|   Expected in: flat namespace
|  in /Users/abcd/BART/bart_pkg1/src/bartpkg.so
| Calls: suppressPackageStartupMessages ... <Anonymous> -> load_all ->
| load_dll -> library.dynam2 -> dyn.load
| Execution halted
| 
| Exited with status 1.
| 
| "
| 
| I have followed the basic guidelines to build the package.
| 
| The .R file has directive #' @useDynLib bartpkg in the right place.
| 
| Also, the prime cpp file has the following tags in the right place.
| 1. #include <Rcpp.h>
|   using namespace Rcpp;
| 2.  //' @param x A single integer.
|      //' @export
|      // [[Rcpp::export]]
| 
| 
| And my NAMESPACE file shows 'useDynLib(bartpkg)' correctly.
| 
| I am able to see the 'bartpkg.so' shared object file in the src directory.
| 
| 
| I tried in the terminal this command "c++filt -n _ZN3RNG4nfixElm" and was
| able to see that the symbol in the error ' Symbol not found:
| __ZN3RNG4nfixElm' is coming from the .C file RNG.C and is because of a
| function 'nfix'.
| 
| But even if I remove the function 'nfix' or remove the RNG.C file
| altogether, the same error ' Symbol not found: __ZN3RNG4nfixElm' comes.
| 
| can it  be a flag issue that my compiler is not able to compile the 'C'
| file?
| I am able to see that all the cpp files generate respective object files,
| but I dont see anything like that for the C file.
| 
| I am using RStudio is the session info is
| > sessionInfo()
| R version 3.3.1 (2016-06-21)
| Platform: x86_64-apple-darwin13.4.0 (64-bit)
| Running under: OS X 10.11.6 (El Capitan)
| 
| locale:
| [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
| 
| attached base packages:
| [1] stats     graphics  grDevices utils     datasets  methods   base
| 
| other attached packages:
| [1] bartpkg_0.1.0        packrat_0.4.8-1      Rcpp_0.12.8
| msm_1.6.4            LaplacesDemon_16.0.1
| 
| loaded via a namespace (and not attached):
|  [1] roxygen2_5.0.1  lattice_0.20-34 mvtnorm_1.0-5   digest_0.6.10
| grid_3.3.1      magrittr_1.5
|  [7] stringi_1.1.2   Matrix_1.2-7.1  splines_3.3.1   tools_3.3.1
| stringr_1.1.0   survival_2.39-5
| [13] parallel_3.3.1  rsconnect_0.5   inline_0.3.14   expm_0.999-0
| 
| I am stuck at this problem for weeks now.
| Any help would be highly appreciated.

Please don't cross post, but I just gave you a hint at your identical
StackOverflow question:
http://stackoverflow.com/questions/40922814/error-in-dyn-loaddllfile-unable-to-load-shared-object-expected-in-flat-na#comment69060886_40922814

Dirk 
 
| Thank you.
| 
| -Aarti
| 
| 	[[alternative HTML version deleted]]
| 
| ______________________________________________
| R-package-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From roy.mendelssohn at noaa.gov  Thu Dec  8 21:43:08 2016
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Thu, 8 Dec 2016 12:43:08 -0800
Subject: [R-pkg-devel] Nit-picky vignette questions
Message-ID: <4A8975E2-80A7-4D4B-AC12-DA138DB87AAD@noaa.gov>

Hi All:

In writing a vignette and referring to a function in another package,  say the function info() in the rerddap package,  it it better to refer to it as the "rerddap function info()" or as "rerddap::info()". This is for the vignette, not what I do internally.

Similarly in a code example in a vignette, if I am using the ggplot2 function ggplot(),  which would preferable  (this is a non-working example just to show the alternative)

   require(ggplot2)
   junk <- ggplot()


or

  junk <- ggplot2::ggplot()

Yes these are nitpicky questions,  but as long as I am doing a vignette, I might as well try to do all of it in a way that is recommended or preferable.

Thanks for any thoughts,

-Roy

PS - Is there something like the Python related program flake8 for R code?   I have both Google and Hadley's style recommendations,  but it is nice  (though tedious and painful) to have a program that points out any inconsistencies from a recommended standard

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From brian at braverock.com  Thu Dec  8 21:55:44 2016
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 08 Dec 2016 14:55:44 -0600
Subject: [R-pkg-devel] Nit-picky vignette questions
In-Reply-To: <4A8975E2-80A7-4D4B-AC12-DA138DB87AAD@noaa.gov>
References: <4A8975E2-80A7-4D4B-AC12-DA138DB87AAD@noaa.gov>
Message-ID: <1481230544.15474.40.camel@braverock.com>

In the text of a vignette, I always refer to them with links, just like
I would in other documentation:

\code{\link[xts]{to.period}}

and if I want to be explicit to the reader (who my be reading a format
where the links don't resolve, I would say something like:

see?\code{\link[xts]{to.period}} in the \code{xts} package.

In code examples in the vignette, I would use

xts::to.period()

unless I had done a library() or require() call.

Regards,

Brian

On Thu, 2016-12-08 at 12:43 -0800, Roy Mendelssohn - NOAA Federal
wrote:
> Hi All:
> 
> In writing a vignette and referring to a function in another
> package,??say the function info() in the rerddap package,??it it
> better to refer to it as the "rerddap function info()" or as
> "rerddap::info()". This is for the vignette, not what I do
> internally.
> 
> Similarly in a code example in a vignette, if I am using the ggplot2
> function ggplot(),??which would preferable??(this is a non-working
> example just to show the alternative)
> 
> ???require(ggplot2)
> ???junk <- ggplot()
> 
> 
> or
> 
> ? junk <- ggplot2::ggplot()
> 
> Yes these are nitpicky questions,??but as long as I am doing a
> vignette, I might as well try to do all of it in a way that is
> recommended or preferable.
> 
> Thanks for any thoughts,
> 
> -Roy
> 
> PS - Is there something like the Python related program flake8 for R
> code????I have both Google and Hadley's style recommendations,??but
> it is nice??(though tedious and painful) to have a program that
> points out any inconsistencies from a recommended standard
> 
> **********************
> "The contents of this message do not reflect any position of the U.S.
> Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
> 
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"?
> "the arc of the moral universe is long, but it bends toward justice"
> -MLK Jr.
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From thierry.onkelinx at inbo.be  Thu Dec  8 22:23:33 2016
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Thu, 8 Dec 2016 22:23:33 +0100
Subject: [R-pkg-devel] Nit-picky vignette questions
In-Reply-To: <4A8975E2-80A7-4D4B-AC12-DA138DB87AAD@noaa.gov>
References: <4A8975E2-80A7-4D4B-AC12-DA138DB87AAD@noaa.gov>
Message-ID: <CAJuCY5zcVbiKPb1LqrZtV2iyHZcbGJekJUzkC3V8i+xTR2ajLg@mail.gmail.com>

Hi Roy,

Have a look at the lintr package:
https://github.com/jimhester/lintr/blob/master/README.md
It works stand alone and integrates with several editors.

Best regards,


ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

2016-12-08 21:43 GMT+01:00 Roy Mendelssohn - NOAA Federal <
roy.mendelssohn at noaa.gov>:

> Hi All:
>
> In writing a vignette and referring to a function in another package,  say
> the function info() in the rerddap package,  it it better to refer to it as
> the "rerddap function info()" or as "rerddap::info()". This is for the
> vignette, not what I do internally.
>
> Similarly in a code example in a vignette, if I am using the ggplot2
> function ggplot(),  which would preferable  (this is a non-working example
> just to show the alternative)
>
>    require(ggplot2)
>    junk <- ggplot()
>
>
> or
>
>   junk <- ggplot2::ggplot()
>
> Yes these are nitpicky questions,  but as long as I am doing a vignette, I
> might as well try to do all of it in a way that is recommended or
> preferable.
>
> Thanks for any thoughts,
>
> -Roy
>
> PS - Is there something like the Python related program flake8 for R
> code?   I have both Google and Hadley's style recommendations,  but it is
> nice  (though tedious and painful) to have a program that points out any
> inconsistencies from a recommended standard
>
> **********************
> "The contents of this message do not reflect any position of the U.S.
> Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"
> "the arc of the moral universe is long, but it bends toward justice" -MLK
> Jr.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From wewolski at gmail.com  Mon Dec 12 15:45:49 2016
From: wewolski at gmail.com (Witold E Wolski)
Date: Mon, 12 Dec 2016 15:45:49 +0100
Subject: [R-pkg-devel] accessing data by packagename::dataname from within
	package code fails.
Message-ID: <CAAjnpdh91sMKbUYk6Tv8CYEJs9jA+Ztc2msEzsnJwX422nPVtw@mail.gmail.com>

I am wrting a package called bibliospec.
I have a dataset in data/AminoAcids.tsv and would like to be able to
access it with

bibliospec::AminoAcids

from within my package code.

R CMD build gives me the error:
Error : 'AminoAcids' is not an exported object from 'namespace:bibliospec'

I am able to access the data in package code with
data(AminoAcids)
AminoAcids

but this will give me a NOTE with R CMD check

Also, after loading the packagepackage I am able to access the data with
bibliospec::AminoAcids

But I can't access it from the package bibliospec code.
So why can't I access bibliospec::AminoAcids from within package code?

Help appreciated

Witold
-- 
Witold Eryk Wolski


From wewolski at gmail.com  Mon Dec 12 21:34:36 2016
From: wewolski at gmail.com (Witold E Wolski)
Date: Mon, 12 Dec 2016 21:34:36 +0100
Subject: [R-pkg-devel] accessing data by packagename::dataname from
	within package code fails.
In-Reply-To: <CAAjnpdh91sMKbUYk6Tv8CYEJs9jA+Ztc2msEzsnJwX422nPVtw@mail.gmail.com>
References: <CAAjnpdh91sMKbUYk6Tv8CYEJs9jA+Ztc2msEzsnJwX422nPVtw@mail.gmail.com>
Message-ID: <CAAjnpdjdaVn6DcTzs9echKg4XFCGBXt2FVqZBMnFM6VPOc4=4w@mail.gmail.com>

I have narrowed down the problem.
The error
Error : 'AminoAcids' is not an exported object from 'namespace:bibliospec'
Error : unable to load R code in package 'bibliospec'

occurs only if I try to access the data using bibliospec::AminoAcids

within the initialize method of an R reference class.
It does work, as far as I tested everywhere else. In other methods of
a reference class as well as in free functions.
It also does not work in the initialization list to the initialize function.
So I also can't do something like
initialize = function(aminoAcids=bibliospec::AminoAcids){


I guess this is an R FEATURE.

But then where and how is the best practice to initialize class
members with default values?

Thank you.





On 12 December 2016 at 15:45, Witold E Wolski <wewolski at gmail.com> wrote:
> I am wrting a package called bibliospec.
> I have a dataset in data/AminoAcids.tsv and would like to be able to
> access it with
>
> bibliospec::AminoAcids
>
> from within my package code.
>
> R CMD build gives me the error:
> Error : 'AminoAcids' is not an exported object from 'namespace:bibliospec'
>
> I am able to access the data in package code with
> data(AminoAcids)
> AminoAcids
>
> but this will give me a NOTE with R CMD check
>
> Also, after loading the packagepackage I am able to access the data with
> bibliospec::AminoAcids
>
> But I can't access it from the package bibliospec code.
> So why can't I access bibliospec::AminoAcids from within package code?
>
> Help appreciated
>
> Witold
> --
> Witold Eryk Wolski



-- 
Witold Eryk Wolski


From wdunlap at tibco.com  Mon Dec 12 21:54:50 2016
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 12 Dec 2016 12:54:50 -0800
Subject: [R-pkg-devel] accessing data by packagename::dataname from
 within package code fails.
In-Reply-To: <CAAjnpdjdaVn6DcTzs9echKg4XFCGBXt2FVqZBMnFM6VPOc4=4w@mail.gmail.com>
References: <CAAjnpdh91sMKbUYk6Tv8CYEJs9jA+Ztc2msEzsnJwX422nPVtw@mail.gmail.com>
	<CAAjnpdjdaVn6DcTzs9echKg4XFCGBXt2FVqZBMnFM6VPOc4=4w@mail.gmail.com>
Message-ID: <CAF8bMcY-OgUEaC1Ajv8pubFiFZ5Xo-5YN9aXn43yhjJ8Dc1Erw@mail.gmail.com>

You can define the data in the R directory.  You can keep it all in a *.R
file
by wrapping the text of the *.csv file in quotes and using
read.table(text="quoted stuff"), as in:

theData <- read.csv(header=TRUE, text="
English,Digit
One,1
Two,2
Three,3")
N <- nrow(theData)

You need to make sure 'theData' is defined before using it so put
everything requiring
it in one file or use the Collate: directive in the DESCRIPTION file.



Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Mon, Dec 12, 2016 at 12:34 PM, Witold E Wolski <wewolski at gmail.com>
wrote:

> I have narrowed down the problem.
> The error
> Error : 'AminoAcids' is not an exported object from 'namespace:bibliospec'
> Error : unable to load R code in package 'bibliospec'
>
> occurs only if I try to access the data using bibliospec::AminoAcids
>
> within the initialize method of an R reference class.
> It does work, as far as I tested everywhere else. In other methods of
> a reference class as well as in free functions.
> It also does not work in the initialization list to the initialize
> function.
> So I also can't do something like
> initialize = function(aminoAcids=bibliospec::AminoAcids){
>
>
> I guess this is an R FEATURE.
>
> But then where and how is the best practice to initialize class
> members with default values?
>
> Thank you.
>
>
>
>
>
> On 12 December 2016 at 15:45, Witold E Wolski <wewolski at gmail.com> wrote:
> > I am wrting a package called bibliospec.
> > I have a dataset in data/AminoAcids.tsv and would like to be able to
> > access it with
> >
> > bibliospec::AminoAcids
> >
> > from within my package code.
> >
> > R CMD build gives me the error:
> > Error : 'AminoAcids' is not an exported object from
> 'namespace:bibliospec'
> >
> > I am able to access the data in package code with
> > data(AminoAcids)
> > AminoAcids
> >
> > but this will give me a NOTE with R CMD check
> >
> > Also, after loading the packagepackage I am able to access the data with
> > bibliospec::AminoAcids
> >
> > But I can't access it from the package bibliospec code.
> > So why can't I access bibliospec::AminoAcids from within package code?
> >
> > Help appreciated
> >
> > Witold
> > --
> > Witold Eryk Wolski
>
>
>
> --
> Witold Eryk Wolski
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From rampaletienne at gmail.com  Thu Dec 22 11:28:05 2016
From: rampaletienne at gmail.com (Rampal Etienne)
Date: Thu, 22 Dec 2016 11:28:05 +0100
Subject: [R-pkg-devel] lfftw3 error
Message-ID: <0d068bd7-b623-23af-3bec-8d895eeac469@gmail.com>

When trying to build a package with RStudio (newest R-devel and Rtools 
installed, and all packages updated), I get the following error.

C:/Rtools/mingw_64/bin/../lib/gcc/x86_64-w64-mingw32/4.9.3/../../../../x86_64-w64-mingw32/bin/ld.exe: 
cannot find -lfftw3 collect2.exe: error: ld returned 1 exit status no 
DLL was created

I suppose lfftw3 should be included in Rtools or in the package? If not, 
how do I add this, under Windows?

Kind regards,

Rampal Etienne


From rampaletienne at gmail.com  Thu Dec 22 14:33:24 2016
From: rampaletienne at gmail.com (Rampal Etienne)
Date: Thu, 22 Dec 2016 14:33:24 +0100
Subject: [R-pkg-devel] lfftw3 error
In-Reply-To: <0d068bd7-b623-23af-3bec-8d895eeac469@gmail.com>
References: <0d068bd7-b623-23af-3bec-8d895eeac469@gmail.com>
Message-ID: <4659feab-2bb1-e39d-91f1-bc640da58379@gmail.com>

Problem solved:

1. I installed the fftw library dlls from http://www.fftw.org/

2. I told the package where to find this library in the makevars.win file.

Regards,

Rampal


On 22-Dec-16 11:28, Rampal Etienne wrote:
> When trying to build a package with RStudio (newest R-devel and Rtools 
> installed, and all packages updated), I get the following error.
>
> C:/Rtools/mingw_64/bin/../lib/gcc/x86_64-w64-mingw32/4.9.3/../../../../x86_64-w64-mingw32/bin/ld.exe: 
> cannot find -lfftw3 collect2.exe: error: ld returned 1 exit status no 
> DLL was created
>
> I suppose lfftw3 should be included in Rtools or in the package? If 
> not, how do I add this, under Windows?
>
> Kind regards,
>
> Rampal Etienne


	[[alternative HTML version deleted]]


From glennmschultz at me.com  Thu Dec 22 19:55:52 2016
From: glennmschultz at me.com (Glenn Schultz)
Date: Thu, 22 Dec 2016 18:55:52 +0000 (GMT)
Subject: [R-pkg-devel] Including Rcpp in an existing package
Message-ID: <0ed45ef2-6062-4fed-ad2b-21ecd19d8cef@me.com>

All,
My package was not initially built with the rcpp use in mind. ?I have to include C++ source code for a particular project so I will have edit the description file add src files, etc. ?by hand. ?I an going over the rcpp documentation now and reviewing the R documentation on extensions as well. ?Is there anything in particular that I should keep in mind while doing this or is this relatively straightforward.

Best,
Glenn

From murdoch.duncan at gmail.com  Thu Dec 22 20:15:37 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 22 Dec 2016 14:15:37 -0500
Subject: [R-pkg-devel] Including Rcpp in an existing package
In-Reply-To: <0ed45ef2-6062-4fed-ad2b-21ecd19d8cef@me.com>
References: <0ed45ef2-6062-4fed-ad2b-21ecd19d8cef@me.com>
Message-ID: <71df77fd-6787-3a83-e235-0f26ec3da10d@gmail.com>

On 22/12/2016 1:55 PM, Glenn Schultz wrote:
> All,
> My package was not initially built with the rcpp use in mind.  I have to include C++ source code for a particular project so I will have edit the description file add src files, etc.  by hand.  I an going over the rcpp documentation now and reviewing the R documentation on extensions as well.  Is there anything in particular that I should keep in mind while doing this or is this relatively straightforward.

It should be pretty straightforward.  There are lots of examples of 
packages that do it (not all of which are simple); see the list of 
"reverse XXXX" on https://CRAN.R-project.org/package=Rcpp (where XXXX is 
Depends, Imports, Suggests, or LinkingTo).

Duncan Murdoch


From bbolker at gmail.com  Thu Dec 22 20:22:36 2016
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 22 Dec 2016 14:22:36 -0500
Subject: [R-pkg-devel] Including Rcpp in an existing package
In-Reply-To: <71df77fd-6787-3a83-e235-0f26ec3da10d@gmail.com>
References: <0ed45ef2-6062-4fed-ad2b-21ecd19d8cef@me.com>
	<71df77fd-6787-3a83-e235-0f26ec3da10d@gmail.com>
Message-ID: <09c11c2c-8c9f-3177-69c4-1bb240e0ad9d@gmail.com>


 A mistake that I have made repeatedly is forgetting to add an
appropriate UseDynLib() call to the NAMESPACE file.

On 16-12-22 02:15 PM, Duncan Murdoch wrote:
> On 22/12/2016 1:55 PM, Glenn Schultz wrote:
>> All,
>> My package was not initially built with the rcpp use in mind.  I have
>> to include C++ source code for a particular project so I will have
>> edit the description file add src files, etc.  by hand.  I an going
>> over the rcpp documentation now and reviewing the R documentation on
>> extensions as well.  Is there anything in particular that I should
>> keep in mind while doing this or is this relatively straightforward.
> 
> It should be pretty straightforward.  There are lots of examples of
> packages that do it (not all of which are simple); see the list of
> "reverse XXXX" on https://CRAN.R-project.org/package=Rcpp (where XXXX is
> Depends, Imports, Suggests, or LinkingTo).
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From edd at debian.org  Thu Dec 22 20:35:26 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 22 Dec 2016 13:35:26 -0600
Subject: [R-pkg-devel] Including Rcpp in an existing package
In-Reply-To: <71df77fd-6787-3a83-e235-0f26ec3da10d@gmail.com>
References: <0ed45ef2-6062-4fed-ad2b-21ecd19d8cef@me.com>
	<71df77fd-6787-3a83-e235-0f26ec3da10d@gmail.com>
Message-ID: <22620.11006.756237.535726@max.nulle.part>


On 22 December 2016 at 14:15, Duncan Murdoch wrote:
| On 22/12/2016 1:55 PM, Glenn Schultz wrote:
| > All,
| > My package was not initially built with the rcpp use in mind.  I have to include C++ source code for a particular project so I will have edit the description file add src files, etc.  by hand.  I an going over the rcpp documentation now and reviewing the R documentation on extensions as well.  Is there anything in particular that I should keep in mind while doing this or is this relatively straightforward.
| 
| It should be pretty straightforward.  There are lots of examples of 
| packages that do it (not all of which are simple); see the list of 
| "reverse XXXX" on https://CRAN.R-project.org/package=Rcpp (where XXXX is 
| Depends, Imports, Suggests, or LinkingTo).

Exactly. I also (still) hand-edit a chronological list at

    http://dirk.eddelbuettel.com/code/rcpp.cranusers.html

which contains a mix of 'fresh packages' (starting from scratch with Rcpp)
and 'converted packages' (which is what you are after). Sadly the latter set
is not indexed, so you have 'know' when a packages was pre-existing when it
made the list.

On 22 December 2016 at 14:22, Ben Bolker wrote:
| 
|  A mistake that I have made repeatedly is forgetting to add an
| appropriate UseDynLib() call to the NAMESPACE file.

Exactly, as well (though really an issue about going from no src/ to having
src).

For the issue here I recommend creating two _minimal_ packages via, say,

    setwd("/tmp")                          # alter as neded
    package.skeleton("fooR")
    Rcpp.package.skeleton("fooRcpp")

and the study where/how they differ.  And maybe try to convert fooR into
fooRwithRcpp.

There is a dedicated list for Rcpp questions too.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From glennmschultz at me.com  Fri Dec 23 03:51:57 2016
From: glennmschultz at me.com (Glenn Schultz)
Date: Fri, 23 Dec 2016 02:51:57 +0000 (GMT)
Subject: [R-pkg-devel] Including Rcpp in an existing package
Message-ID: <2a7eaf36-0e62-44d7-bd15-c69c2728a92f@me.com>

Hello All,

Thank-you all for your responses it was very helpful. ?I have one last question. ?I was planning on branching a new version of my package to allow the use of rcpp. ?

My question is, Can?I just set up my package to be rcpp ready (for lack of a better term) without testing?C++ code in the request directories??Are there adverse consequences? ?

I can see from the project I am working one that one may choose to implement certain processes (interest rate model or prepayment models) implemented in C++ code. ?So I am beginning to think if the package is rcpp ready at the source it would make things easier for users seeking to customize those inputs in the future and build bespoke versions of the package or is this approach a bad idea?

Best,
Glenn?


On Dec 22, 2016, at 01:35 PM, Dirk Eddelbuettel <edd at debian.org> wrote:


On 22 December 2016 at 14:15, Duncan Murdoch wrote:
| On 22/12/2016 1:55 PM, Glenn Schultz wrote:
| > All,
| > My package was not initially built with the rcpp use in mind. I have to include C++ source code for a particular project so I will have edit the description file add src files, etc. by hand. I an going over the rcpp documentation now and reviewing the R documentation on extensions as well. Is there anything in particular that I should keep in mind while doing this or is this relatively straightforward.
| 
| It should be pretty straightforward. There are lots of examples of 
| packages that do it (not all of which are simple); see the list of 
| "reverse XXXX" on https://CRAN.R-project.org/package=Rcpp (where XXXX is 
| Depends, Imports, Suggests, or LinkingTo).

Exactly. I also (still) hand-edit a chronological list at

http://dirk.eddelbuettel.com/code/rcpp.cranusers.html

which contains a mix of 'fresh packages' (starting from scratch with Rcpp)
and 'converted packages' (which is what you are after). Sadly the latter set
is not indexed, so you have 'know' when a packages was pre-existing when it
made the list.

On 22 December 2016 at 14:22, Ben Bolker wrote:
| 
| A mistake that I have made repeatedly is forgetting to add an
| appropriate UseDynLib() call to the NAMESPACE file.

Exactly, as well (though really an issue about going from no src/ to having
src).

For the issue here I recommend creating two _minimal_ packages via, say,

setwd("/tmp") # alter as neded
package.skeleton("fooR")
Rcpp.package.skeleton("fooRcpp")

and the study where/how they differ. And maybe try to convert fooR into
fooRwithRcpp.

There is a dedicated list for Rcpp questions too.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org

From markus.mueller.1.g at googlemail.com  Fri Dec 23 17:32:23 2016
From: markus.mueller.1.g at googlemail.com (=?UTF-8?Q?Markus_M=C3=BCller?=)
Date: Fri, 23 Dec 2016 17:32:23 +0100
Subject: [R-pkg-devel] Fwd: Please help with unexplainable check --as-cran
 warning for Rd file with \usage{\S4method{[[<-}{M1}(x, i, value)}
In-Reply-To: <CAOAQ5spVsODhXZrZc2gEpsp7-njumTCB62NsTg3XJyq67W_gCA@mail.gmail.com>
References: <CAOAQ5spVsODhXZrZc2gEpsp7-njumTCB62NsTg3XJyq67W_gCA@mail.gmail.com>
Message-ID: <CAOAQ5sp8mqKjaFiWOBb==DccVBdPv5FvUxPNsGVDJu6NW+s+Lg@mail.gmail.com>

Hi


I have build a small example package to reproduce the issue.
The usage lines with S4method work well for all other methods including
overloaded operators (In my example package I  put [[ as an example)


The actual warning only occurs for the method overloading "[[<-"










** checking Rd \usage sections ... WARNINGBad \usage lines found in
documentation object '[[<-,M1-method':  <unescaped
bksl>S4method{[[<-}{M1}(x,  i,  value)Functions with \usage entries need to
have the appropriate \aliasentries, and all their arguments documented.The
\usage entries must correspond to syntactically valid R code.*

The example code for this operator works.

The funny thing is that when I comment the usage line in the Rd file the
warning vanishes.
Although as a programmer I know that usually "the library isn't broken"
(but rather my code)  this almost seems like it ;-)
At least I have no clue what to do to get a proper usage line.

the pkg.tar.bz2 contains the whole package directory before building.
The built package is OverloadedIndexedAssignment_0.1.tar.gz
along with the check dir and the log.

Cheers and Thanks in advance
-------------- next part --------------
A non-text attachment was scrubbed...
Name: OverloadedIndexedAssingment_0.1.tar.gz
Type: application/x-gzip
Size: 1351 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20161223/853f12c6/attachment.gz>

From georgi.boshnakov at manchester.ac.uk  Sat Dec 24 11:20:14 2016
From: georgi.boshnakov at manchester.ac.uk (Georgi Boshnakov)
Date: Sat, 24 Dec 2016 10:20:14 +0000
Subject: [R-pkg-devel] Fwd: Please help with unexplainable check
 --as-cran warning for Rd file with \usage{\S4method{[[<-}{M1}(x, i, value)}
In-Reply-To: <CAOAQ5sp8mqKjaFiWOBb==DccVBdPv5FvUxPNsGVDJu6NW+s+Lg@mail.gmail.com>
References: <CAOAQ5spVsODhXZrZc2gEpsp7-njumTCB62NsTg3XJyq67W_gCA@mail.gmail.com>
	<CAOAQ5sp8mqKjaFiWOBb==DccVBdPv5FvUxPNsGVDJu6NW+s+Lg@mail.gmail.com>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E018B01CC44@MBXP01.ds.man.ac.uk>

Hi,

The usage line should look like this:

\S4method{[[}{M1}(x, i) <- value

Notice that the first argument of \S4method is '[[' not '[[<-' and the assignment is explicit.

-----------

The clue is that you get the error only for the replacement version. A little digging in R-exts.pdf unearths the 
Following:

       "An S4 replacement method is documented in the same way as an S3 one: see the description
       of \method in Section 2.1.1 [Documenting functions] ..."

Following the link we find:

    'Similarly, one can use \method{generic}{class}(arglist) <- value
      to indicate the usage of an S3 replacement method for the generic replacement 
     function "generic<-" for objects inheriting from class "class".'

Guessing that we need to replace '\method' with '\S4method' for S4 methods gives the answer given at the start of the email.


Kind regards,
Georgi Boshnakov





-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Markus M?ller
Sent: 23 December 2016 16:32
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Fwd: Please help with unexplainable check --as-cran warning for Rd file with \usage{\S4method{[[<-}{M1}(x, i, value)}

Hi


I have build a small example package to reproduce the issue.
The usage lines with S4method work well for all other methods including overloaded operators (In my example package I  put [[ as an example)


The actual warning only occurs for the method overloading "[[<-"










** checking Rd \usage sections ... WARNINGBad \usage lines found in documentation object '[[<-,M1-method':  <unescaped
bksl>S4method{[[<-}{M1}(x,  i,  value)Functions with \usage entries need 
bksl>to
have the appropriate \aliasentries, and all their arguments documented.The \usage entries must correspond to syntactically valid R code.*

The example code for this operator works.

The funny thing is that when I comment the usage line in the Rd file the warning vanishes.
Although as a programmer I know that usually "the library isn't broken"
(but rather my code)  this almost seems like it ;-) At least I have no clue what to do to get a proper usage line.

the pkg.tar.bz2 contains the whole package directory before building.
The built package is OverloadedIndexedAssignment_0.1.tar.gz
along with the check dir and the log.

Cheers and Thanks in advance

From roy.mendelssohn at noaa.gov  Thu Dec 29 19:16:21 2016
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Thu, 29 Dec 2016 10:16:21 -0800
Subject: [R-pkg-devel] warning from win_build
Message-ID: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>

Hi All:

I am working on a new submission of my xtractomatic package  (the main change being the use of https).  I develop on a Mac.  When I run on the Mac:

devtools::check()

I get no errors, notes, or warnings.  However, when I run devtools::build_win(), the response I get back isL


> * checking for unstated dependencies in vignettes ... OK
> * checking package vignettes in 'inst/doc' ... OK
> * checking re-building of vignette outputs ... WARNING
> Error in re-building vignettes:
>   ...
> Quitting from lines 248-261 (Usingxtractomatic.Rmd) 
> Error: processing vignette 'Usingxtractomatic.Rmd' failed with diagnostics:
> (converted from warning) Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
>   Consider 'structure(list(), *)' instead.
> Execution halted
> 

So this error is from my Vignette.  The offending lines appear to  be:

> ```{r topotagPlot, fig.align = 'center', fig.width = 6, fig.height = 4, warning = FALSE}
> require("ggplot2")
> alldata <- cbind(tagData, topo)
> alldata$lon <- alldata$lon - 360
> z <- ggplot(alldata, aes(x = lon,y = lat)) + 
>    geom_point(aes(colour = mean), size = 2.) + 
>   scale_shape_manual(values = c(19, 1))
> z + geom_polygon(data = w, aes(x = long, y = lat, group = group), fill = "grey80") + 
>   theme_bw() + 
>   scale_colour_gradient("Depth") + 
>   coord_fixed(1.3, xlim = xlim, ylim = ylim) + ggtitle("Bathymetry at marlin tag locations")
> 
> ```
> 


Now the vignette builds fine on my machine,  and  I can run it by "hand"  (as an R Notebook, executing each chunk) and it works also.  Looking at the offending code chunk,  I can honestly say I have no idea what the error message is referring to.    When I run by hand,  I have checked that both tagData and topo are properly defined.  But is that the problem,  is the error message from the  cbind?

Thanks for any help.

-Roy


**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From bbolker at gmail.com  Thu Dec 29 19:20:59 2016
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 29 Dec 2016 13:20:59 -0500
Subject: [R-pkg-devel] warning from win_build
In-Reply-To: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
References: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
Message-ID: <ebbb3cf0-efd8-8e41-5851-42e1d356d6fc@gmail.com>


  I think this is a ggplot2-related issue.  Matt Dowle posted about it:

http://blog.h2o.ai/2016/12/behind-the-scenes-of-cran/


On 16-12-29 01:16 PM, Roy Mendelssohn - NOAA Federal wrote:
> Hi All:
> 
> I am working on a new submission of my xtractomatic package  (the
> main change being the use of https).  I develop on a Mac.  When I run
> on the Mac:
> 
> devtools::check()
> 
> I get no errors, notes, or warnings.  However, when I run
> devtools::build_win(), the response I get back isL
> 
> 
>> * checking for unstated dependencies in vignettes ... OK * checking
>> package vignettes in 'inst/doc' ... OK * checking re-building of
>> vignette outputs ... WARNING Error in re-building vignettes: ... 
>> Quitting from lines 248-261 (Usingxtractomatic.Rmd) Error:
>> processing vignette 'Usingxtractomatic.Rmd' failed with
>> diagnostics: (converted from warning) Calling 'structure(NULL, *)'
>> is deprecated, as NULL cannot have attributes. Consider
>> 'structure(list(), *)' instead. Execution halted
>> 
> 
> So this error is from my Vignette.  The offending lines appear to
> be:
> 
>> ```{r topotagPlot, fig.align = 'center', fig.width = 6, fig.height
>> = 4, warning = FALSE} require("ggplot2") alldata <- cbind(tagData,
>> topo) alldata$lon <- alldata$lon - 360 z <- ggplot(alldata, aes(x =
>> lon,y = lat)) + geom_point(aes(colour = mean), size = 2.) + 
>> scale_shape_manual(values = c(19, 1)) z + geom_polygon(data = w,
>> aes(x = long, y = lat, group = group), fill = "grey80") + 
>> theme_bw() + scale_colour_gradient("Depth") + coord_fixed(1.3, xlim
>> = xlim, ylim = ylim) + ggtitle("Bathymetry at marlin tag
>> locations")
>> 
>> ```
>> 
> 
> 
> Now the vignette builds fine on my machine,  and  I can run it by
> "hand"  (as an R Notebook, executing each chunk) and it works also.
> Looking at the offending code chunk,  I can honestly say I have no
> idea what the error message is referring to.    When I run by hand,
> I have checked that both tagData and topo are properly defined.  But
> is that the problem,  is the error message from the  cbind?
> 
> Thanks for any help.
> 
> -Roy
> 
> 
> ********************** "The contents of this message do not reflect
> any position of the U.S. Government or NOAA." ********************** 
> Roy Mendelssohn Supervisory Operations Research Analyst NOAA/NMFS 
> Environmental Research Division Southwest Fisheries Science Center 
> ***Note new street address*** 110 McAllister Way Santa Cruz, CA
> 95060 Phone: (831)-420-3666 Fax: (831) 420-3980 e-mail:
> Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
> 
> "Old age and treachery will overcome youth and skill." "From those
> who have been given much, much will be expected" "the arc of the
> moral universe is long, but it bends toward justice" -MLK Jr.
> 
> ______________________________________________ 
> R-package-devel at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From bbolker at gmail.com  Thu Dec 29 19:24:20 2016
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 29 Dec 2016 13:24:20 -0500
Subject: [R-pkg-devel] warning from win_build
In-Reply-To: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
References: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
Message-ID: <cc637a0a-a960-0418-79b4-6d36154d3663@gmail.com>

  Sorry, correction/clarification to my last post: it's *not* a bug in
ggplot2, rather apparently (?) it's something in base R that has broken
tests in both data.table and ggplot2. (Since your code calls ggplot,
though, it's presumably in there somewhere, and (?) not your problem.)

  cheers
    Ben



On 16-12-29 01:16 PM, Roy Mendelssohn - NOAA Federal wrote:
> Hi All:
> 
> I am working on a new submission of my xtractomatic package  (the
> main change being the use of https).  I develop on a Mac.  When I run
> on the Mac:
> 
> devtools::check()
> 
> I get no errors, notes, or warnings.  However, when I run
> devtools::build_win(), the response I get back isL
> 
> 
>> * checking for unstated dependencies in vignettes ... OK * checking
>> package vignettes in 'inst/doc' ... OK * checking re-building of
>> vignette outputs ... WARNING Error in re-building vignettes: ... 
>> Quitting from lines 248-261 (Usingxtractomatic.Rmd) Error:
>> processing vignette 'Usingxtractomatic.Rmd' failed with
>> diagnostics: (converted from warning) Calling 'structure(NULL, *)'
>> is deprecated, as NULL cannot have attributes. Consider
>> 'structure(list(), *)' instead. Execution halted
>> 
> 
> So this error is from my Vignette.  The offending lines appear to
> be:
> 
>> ```{r topotagPlot, fig.align = 'center', fig.width = 6, fig.height
>> = 4, warning = FALSE} require("ggplot2") alldata <- cbind(tagData,
>> topo) alldata$lon <- alldata$lon - 360 z <- ggplot(alldata, aes(x =
>> lon,y = lat)) + geom_point(aes(colour = mean), size = 2.) + 
>> scale_shape_manual(values = c(19, 1)) z + geom_polygon(data = w,
>> aes(x = long, y = lat, group = group), fill = "grey80") + 
>> theme_bw() + scale_colour_gradient("Depth") + coord_fixed(1.3, xlim
>> = xlim, ylim = ylim) + ggtitle("Bathymetry at marlin tag
>> locations")
>> 
>> ```
>> 
> 
> 
> Now the vignette builds fine on my machine,  and  I can run it by
> "hand"  (as an R Notebook, executing each chunk) and it works also.
> Looking at the offending code chunk,  I can honestly say I have no
> idea what the error message is referring to.    When I run by hand,
> I have checked that both tagData and topo are properly defined.  But
> is that the problem,  is the error message from the  cbind?
> 
> Thanks for any help.
> 
> -Roy
> 
> 
> ********************** "The contents of this message do not reflect
> any position of the U.S. Government or NOAA." ********************** 
> Roy Mendelssohn Supervisory Operations Research Analyst NOAA/NMFS 
> Environmental Research Division Southwest Fisheries Science Center 
> ***Note new street address*** 110 McAllister Way Santa Cruz, CA
> 95060 Phone: (831)-420-3666 Fax: (831) 420-3980 e-mail:
> Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
> 
> "Old age and treachery will overcome youth and skill." "From those
> who have been given much, much will be expected" "the arc of the
> moral universe is long, but it bends toward justice" -MLK Jr.
> 
> ______________________________________________ 
> R-package-devel at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From roy.mendelssohn at noaa.gov  Thu Dec 29 19:36:01 2016
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Thu, 29 Dec 2016 10:36:01 -0800
Subject: [R-pkg-devel] warning from win_build
In-Reply-To: <cc637a0a-a960-0418-79b4-6d36154d3663@gmail.com>
References: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
	<cc637a0a-a960-0418-79b4-6d36154d3663@gmail.com>
Message-ID: <020AE881-87DB-413C-8EC2-BA9A44EA7C77@noaa.gov>

Thanks, that is a big help because I had no idea what the error was referring to,.  Can I put this in my comments to cran and that will be sufficient?  Normally any warning is sufficient for rejection?

I just want to make certain the updated submission goes a cleanly as possible.

-Roy



> On Dec 29, 2016, at 10:24 AM, Ben Bolker <bbolker at gmail.com> wrote:
> 
>  Sorry, correction/clarification to my last post: it's *not* a bug in
> ggplot2, rather apparently (?) it's something in base R that has broken
> tests in both data.table and ggplot2. (Since your code calls ggplot,
> though, it's presumably in there somewhere, and (?) not your problem.)
> 
>  cheers
>    Ben
> 
> 
> 
> On 16-12-29 01:16 PM, Roy Mendelssohn - NOAA Federal wrote:
>> Hi All:
>> 
>> I am working on a new submission of my xtractomatic package  (the
>> main change being the use of https).  I develop on a Mac.  When I run
>> on the Mac:
>> 
>> devtools::check()
>> 
>> I get no errors, notes, or warnings.  However, when I run
>> devtools::build_win(), the response I get back isL
>> 
>> 
>>> * checking for unstated dependencies in vignettes ... OK * checking
>>> package vignettes in 'inst/doc' ... OK * checking re-building of
>>> vignette outputs ... WARNING Error in re-building vignettes: ... 
>>> Quitting from lines 248-261 (Usingxtractomatic.Rmd) Error:
>>> processing vignette 'Usingxtractomatic.Rmd' failed with
>>> diagnostics: (converted from warning) Calling 'structure(NULL, *)'
>>> is deprecated, as NULL cannot have attributes. Consider
>>> 'structure(list(), *)' instead. Execution halted
>>> 
>> 
>> So this error is from my Vignette.  The offending lines appear to
>> be:
>> 
>>> ```{r topotagPlot, fig.align = 'center', fig.width = 6, fig.height
>>> = 4, warning = FALSE} require("ggplot2") alldata <- cbind(tagData,
>>> topo) alldata$lon <- alldata$lon - 360 z <- ggplot(alldata, aes(x =
>>> lon,y = lat)) + geom_point(aes(colour = mean), size = 2.) + 
>>> scale_shape_manual(values = c(19, 1)) z + geom_polygon(data = w,
>>> aes(x = long, y = lat, group = group), fill = "grey80") + 
>>> theme_bw() + scale_colour_gradient("Depth") + coord_fixed(1.3, xlim
>>> = xlim, ylim = ylim) + ggtitle("Bathymetry at marlin tag
>>> locations")
>>> 
>>> ```
>>> 
>> 
>> 
>> Now the vignette builds fine on my machine,  and  I can run it by
>> "hand"  (as an R Notebook, executing each chunk) and it works also.
>> Looking at the offending code chunk,  I can honestly say I have no
>> idea what the error message is referring to.    When I run by hand,
>> I have checked that both tagData and topo are properly defined.  But
>> is that the problem,  is the error message from the  cbind?
>> 
>> Thanks for any help.
>> 
>> -Roy
>> 
>> 
>> ********************** "The contents of this message do not reflect
>> any position of the U.S. Government or NOAA." ********************** 
>> Roy Mendelssohn Supervisory Operations Research Analyst NOAA/NMFS 
>> Environmental Research Division Southwest Fisheries Science Center 
>> ***Note new street address*** 110 McAllister Way Santa Cruz, CA
>> 95060 Phone: (831)-420-3666 Fax: (831) 420-3980 e-mail:
>> Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>> 
>> "Old age and treachery will overcome youth and skill." "From those
>> who have been given much, much will be expected" "the arc of the
>> moral universe is long, but it bends toward justice" -MLK Jr.
>> 
>> ______________________________________________ 
>> R-package-devel at r-project.org mailing list 
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> 
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From murdoch.duncan at gmail.com  Thu Dec 29 19:38:17 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 29 Dec 2016 13:38:17 -0500
Subject: [R-pkg-devel] warning from win_build
In-Reply-To: <cc637a0a-a960-0418-79b4-6d36154d3663@gmail.com>
References: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
	<cc637a0a-a960-0418-79b4-6d36154d3663@gmail.com>
Message-ID: <15940c35-9f28-5de7-c781-a6c6bca899f2@gmail.com>

On 29/12/2016 1:24 PM, Ben Bolker wrote:
>   Sorry, correction/clarification to my last post: it's *not* a bug in
> ggplot2, rather apparently (?) it's something in base R that has broken
> tests in both data.table and ggplot2. (Since your code calls ggplot,
> though, it's presumably in there somewhere, and (?) not your problem.)

The NEWS item is here:

http://developer.r-project.org/blosxom.cgi/R-devel/2016/12/28#n2016-12-28

The issue is discussed in a bit more detail on R-devel (subject "[Rd] 
Unexpected I(NULL) output") and 
<https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=17198>.

Overall it seems like a good idea:  some code (perhaps in ggplot2, I 
haven't tried to track it down) appears to be trying to set attributes 
on NULL.  This will silently fail in versions of R prior to R-devel rev 
71841, and will fail with a warning in that version or later.  (Since 
the change to R-devel is very recent, it may change again.)

Duncan Murdoch

>
>   cheers
>     Ben
>
>
>
> On 16-12-29 01:16 PM, Roy Mendelssohn - NOAA Federal wrote:
>> Hi All:
>>
>> I am working on a new submission of my xtractomatic package  (the
>> main change being the use of https).  I develop on a Mac.  When I run
>> on the Mac:
>>
>> devtools::check()
>>
>> I get no errors, notes, or warnings.  However, when I run
>> devtools::build_win(), the response I get back isL
>>
>>
>>> * checking for unstated dependencies in vignettes ... OK * checking
>>> package vignettes in 'inst/doc' ... OK * checking re-building of
>>> vignette outputs ... WARNING Error in re-building vignettes: ...
>>> Quitting from lines 248-261 (Usingxtractomatic.Rmd) Error:
>>> processing vignette 'Usingxtractomatic.Rmd' failed with
>>> diagnostics: (converted from warning) Calling 'structure(NULL, *)'
>>> is deprecated, as NULL cannot have attributes. Consider
>>> 'structure(list(), *)' instead. Execution halted
>>>
>>
>> So this error is from my Vignette.  The offending lines appear to
>> be:
>>
>>> ```{r topotagPlot, fig.align = 'center', fig.width = 6, fig.height
>>> = 4, warning = FALSE} require("ggplot2") alldata <- cbind(tagData,
>>> topo) alldata$lon <- alldata$lon - 360 z <- ggplot(alldata, aes(x =
>>> lon,y = lat)) + geom_point(aes(colour = mean), size = 2.) +
>>> scale_shape_manual(values = c(19, 1)) z + geom_polygon(data = w,
>>> aes(x = long, y = lat, group = group), fill = "grey80") +
>>> theme_bw() + scale_colour_gradient("Depth") + coord_fixed(1.3, xlim
>>> = xlim, ylim = ylim) + ggtitle("Bathymetry at marlin tag
>>> locations")
>>>
>>> ```
>>>
>>
>>
>> Now the vignette builds fine on my machine,  and  I can run it by
>> "hand"  (as an R Notebook, executing each chunk) and it works also.
>> Looking at the offending code chunk,  I can honestly say I have no
>> idea what the error message is referring to.    When I run by hand,
>> I have checked that both tagData and topo are properly defined.  But
>> is that the problem,  is the error message from the  cbind?
>>
>> Thanks for any help.
>>
>> -Roy
>>
>>
>> ********************** "The contents of this message do not reflect
>> any position of the U.S. Government or NOAA." **********************
>> Roy Mendelssohn Supervisory Operations Research Analyst NOAA/NMFS
>> Environmental Research Division Southwest Fisheries Science Center
>> ***Note new street address*** 110 McAllister Way Santa Cruz, CA
>> 95060 Phone: (831)-420-3666 Fax: (831) 420-3980 e-mail:
>> Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>
>> "Old age and treachery will overcome youth and skill." "From those
>> who have been given much, much will be expected" "the arc of the
>> moral universe is long, but it bends toward justice" -MLK Jr.
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From roy.mendelssohn at noaa.gov  Thu Dec 29 19:44:34 2016
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Thu, 29 Dec 2016 10:44:34 -0800
Subject: [R-pkg-devel] warning from win_build
In-Reply-To: <15940c35-9f28-5de7-c781-a6c6bca899f2@gmail.com>
References: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
	<cc637a0a-a960-0418-79b4-6d36154d3663@gmail.com>
	<15940c35-9f28-5de7-c781-a6c6bca899f2@gmail.com>
Message-ID: <509D0656-2FB9-4A0C-B8D1-AF21F3F77D70@noaa.gov>

Thanks,  but as I said,  my next question is how best to proceed with CRAN.  I do not want to waste peoples' time with a submission that I know before hand will be rejected.   Can I submit with this warning?

-Roy


> On Dec 29, 2016, at 10:38 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 29/12/2016 1:24 PM, Ben Bolker wrote:
>>  Sorry, correction/clarification to my last post: it's *not* a bug in
>> ggplot2, rather apparently (?) it's something in base R that has broken
>> tests in both data.table and ggplot2. (Since your code calls ggplot,
>> though, it's presumably in there somewhere, and (?) not your problem.)
> 
> The NEWS item is here:
> 
> http://developer.r-project.org/blosxom.cgi/R-devel/2016/12/28#n2016-12-28
> 
> The issue is discussed in a bit more detail on R-devel (subject "[Rd] Unexpected I(NULL) output") and <https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=17198>.
> 
> Overall it seems like a good idea:  some code (perhaps in ggplot2, I haven't tried to track it down) appears to be trying to set attributes on NULL.  This will silently fail in versions of R prior to R-devel rev 71841, and will fail with a warning in that version or later.  (Since the change to R-devel is very recent, it may change again.)
> 
> Duncan Murdoch
> 
>> 
>>  cheers
>>    Ben
>> 
>> 
>> 
>> On 16-12-29 01:16 PM, Roy Mendelssohn - NOAA Federal wrote:
>>> Hi All:
>>> 
>>> I am working on a new submission of my xtractomatic package  (the
>>> main change being the use of https).  I develop on a Mac.  When I run
>>> on the Mac:
>>> 
>>> devtools::check()
>>> 
>>> I get no errors, notes, or warnings.  However, when I run
>>> devtools::build_win(), the response I get back isL
>>> 
>>> 
>>>> * checking for unstated dependencies in vignettes ... OK * checking
>>>> package vignettes in 'inst/doc' ... OK * checking re-building of
>>>> vignette outputs ... WARNING Error in re-building vignettes: ...
>>>> Quitting from lines 248-261 (Usingxtractomatic.Rmd) Error:
>>>> processing vignette 'Usingxtractomatic.Rmd' failed with
>>>> diagnostics: (converted from warning) Calling 'structure(NULL, *)'
>>>> is deprecated, as NULL cannot have attributes. Consider
>>>> 'structure(list(), *)' instead. Execution halted
>>>> 
>>> 
>>> So this error is from my Vignette.  The offending lines appear to
>>> be:
>>> 
>>>> ```{r topotagPlot, fig.align = 'center', fig.width = 6, fig.height
>>>> = 4, warning = FALSE} require("ggplot2") alldata <- cbind(tagData,
>>>> topo) alldata$lon <- alldata$lon - 360 z <- ggplot(alldata, aes(x =
>>>> lon,y = lat)) + geom_point(aes(colour = mean), size = 2.) +
>>>> scale_shape_manual(values = c(19, 1)) z + geom_polygon(data = w,
>>>> aes(x = long, y = lat, group = group), fill = "grey80") +
>>>> theme_bw() + scale_colour_gradient("Depth") + coord_fixed(1.3, xlim
>>>> = xlim, ylim = ylim) + ggtitle("Bathymetry at marlin tag
>>>> locations")
>>>> 
>>>> ```
>>>> 
>>> 
>>> 
>>> Now the vignette builds fine on my machine,  and  I can run it by
>>> "hand"  (as an R Notebook, executing each chunk) and it works also.
>>> Looking at the offending code chunk,  I can honestly say I have no
>>> idea what the error message is referring to.    When I run by hand,
>>> I have checked that both tagData and topo are properly defined.  But
>>> is that the problem,  is the error message from the  cbind?
>>> 
>>> Thanks for any help.
>>> 
>>> -Roy
>>> 
>>> 
>>> ********************** "The contents of this message do not reflect
>>> any position of the U.S. Government or NOAA." **********************
>>> Roy Mendelssohn Supervisory Operations Research Analyst NOAA/NMFS
>>> Environmental Research Division Southwest Fisheries Science Center
>>> ***Note new street address*** 110 McAllister Way Santa Cruz, CA
>>> 95060 Phone: (831)-420-3666 Fax: (831) 420-3980 e-mail:
>>> Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>> 
>>> "Old age and treachery will overcome youth and skill." "From those
>>> who have been given much, much will be expected" "the arc of the
>>> moral universe is long, but it bends toward justice" -MLK Jr.
>>> 
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>> 
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> 
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From murdoch.duncan at gmail.com  Thu Dec 29 20:40:23 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 29 Dec 2016 14:40:23 -0500
Subject: [R-pkg-devel] warning from win_build
In-Reply-To: <509D0656-2FB9-4A0C-B8D1-AF21F3F77D70@noaa.gov>
References: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
	<cc637a0a-a960-0418-79b4-6d36154d3663@gmail.com>
	<15940c35-9f28-5de7-c781-a6c6bca899f2@gmail.com>
	<509D0656-2FB9-4A0C-B8D1-AF21F3F77D70@noaa.gov>
Message-ID: <15360f17-1c22-7395-16e6-22b23d7d209d@gmail.com>

On 29/12/2016 1:44 PM, Roy Mendelssohn - NOAA Federal wrote:
> Thanks,  but as I said,  my next question is how best to proceed with CRAN.  I do not want to waste peoples' time with a submission that I know before hand will be rejected.   Can I submit with this warning?

I'd recommend waiting a few days.  If you really want to submit soon, 
you can figure out which is the offending command, and wrap it in 
something that suppresses the warning (e.g. suppressWarnings(), assuming 
the conversion to an error happens later).

I don't think your package would be accepted if the vignette won't build 
on R-devel.

Duncan Murdoch

> -Roy
>
>
>> On Dec 29, 2016, at 10:38 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> On 29/12/2016 1:24 PM, Ben Bolker wrote:
>>>  Sorry, correction/clarification to my last post: it's *not* a bug in
>>> ggplot2, rather apparently (?) it's something in base R that has broken
>>> tests in both data.table and ggplot2. (Since your code calls ggplot,
>>> though, it's presumably in there somewhere, and (?) not your problem.)
>>
>> The NEWS item is here:
>>
>> http://developer.r-project.org/blosxom.cgi/R-devel/2016/12/28#n2016-12-28
>>
>> The issue is discussed in a bit more detail on R-devel (subject "[Rd] Unexpected I(NULL) output") and <https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=17198>.
>>
>> Overall it seems like a good idea:  some code (perhaps in ggplot2, I haven't tried to track it down) appears to be trying to set attributes on NULL.  This will silently fail in versions of R prior to R-devel rev 71841, and will fail with a warning in that version or later.  (Since the change to R-devel is very recent, it may change again.)
>>
>> Duncan Murdoch
>>
>>>
>>>  cheers
>>>    Ben
>>>
>>>
>>>
>>> On 16-12-29 01:16 PM, Roy Mendelssohn - NOAA Federal wrote:
>>>> Hi All:
>>>>
>>>> I am working on a new submission of my xtractomatic package  (the
>>>> main change being the use of https).  I develop on a Mac.  When I run
>>>> on the Mac:
>>>>
>>>> devtools::check()
>>>>
>>>> I get no errors, notes, or warnings.  However, when I run
>>>> devtools::build_win(), the response I get back isL
>>>>
>>>>
>>>>> * checking for unstated dependencies in vignettes ... OK * checking
>>>>> package vignettes in 'inst/doc' ... OK * checking re-building of
>>>>> vignette outputs ... WARNING Error in re-building vignettes: ...
>>>>> Quitting from lines 248-261 (Usingxtractomatic.Rmd) Error:
>>>>> processing vignette 'Usingxtractomatic.Rmd' failed with
>>>>> diagnostics: (converted from warning) Calling 'structure(NULL, *)'
>>>>> is deprecated, as NULL cannot have attributes. Consider
>>>>> 'structure(list(), *)' instead. Execution halted
>>>>>
>>>>
>>>> So this error is from my Vignette.  The offending lines appear to
>>>> be:
>>>>
>>>>> ```{r topotagPlot, fig.align = 'center', fig.width = 6, fig.height
>>>>> = 4, warning = FALSE} require("ggplot2") alldata <- cbind(tagData,
>>>>> topo) alldata$lon <- alldata$lon - 360 z <- ggplot(alldata, aes(x =
>>>>> lon,y = lat)) + geom_point(aes(colour = mean), size = 2.) +
>>>>> scale_shape_manual(values = c(19, 1)) z + geom_polygon(data = w,
>>>>> aes(x = long, y = lat, group = group), fill = "grey80") +
>>>>> theme_bw() + scale_colour_gradient("Depth") + coord_fixed(1.3, xlim
>>>>> = xlim, ylim = ylim) + ggtitle("Bathymetry at marlin tag
>>>>> locations")
>>>>>
>>>>> ```
>>>>>
>>>>
>>>>
>>>> Now the vignette builds fine on my machine,  and  I can run it by
>>>> "hand"  (as an R Notebook, executing each chunk) and it works also.
>>>> Looking at the offending code chunk,  I can honestly say I have no
>>>> idea what the error message is referring to.    When I run by hand,
>>>> I have checked that both tagData and topo are properly defined.  But
>>>> is that the problem,  is the error message from the  cbind?
>>>>
>>>> Thanks for any help.
>>>>
>>>> -Roy
>>>>
>>>>
>>>> ********************** "The contents of this message do not reflect
>>>> any position of the U.S. Government or NOAA." **********************
>>>> Roy Mendelssohn Supervisory Operations Research Analyst NOAA/NMFS
>>>> Environmental Research Division Southwest Fisheries Science Center
>>>> ***Note new street address*** 110 McAllister Way Santa Cruz, CA
>>>> 95060 Phone: (831)-420-3666 Fax: (831) 420-3980 e-mail:
>>>> Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>>>
>>>> "Old age and treachery will overcome youth and skill." "From those
>>>> who have been given much, much will be expected" "the arc of the
>>>> moral universe is long, but it bends toward justice" -MLK Jr.
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>


From roy.mendelssohn at noaa.gov  Thu Dec 29 20:44:10 2016
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Thu, 29 Dec 2016 11:44:10 -0800
Subject: [R-pkg-devel] warning from win_build
In-Reply-To: <15360f17-1c22-7395-16e6-22b23d7d209d@gmail.com>
References: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
	<cc637a0a-a960-0418-79b4-6d36154d3663@gmail.com>
	<15940c35-9f28-5de7-c781-a6c6bca899f2@gmail.com>
	<509D0656-2FB9-4A0C-B8D1-AF21F3F77D70@noaa.gov>
	<15360f17-1c22-7395-16e6-22b23d7d209d@gmail.com>
Message-ID: <A6C36163-A2A5-4B5C-A2EF-FB64F3094503@noaa.gov>

Thanks.  I can wait.  I will also see if I can figure out a work around in the meantime.  Is the submission to winbuild automated?  That is really the only way I have to check, but I don't want to keep on checking if someone's time is being wasted by that.  If automated,  the I don't mind making repeated submissions.

Thanks again,

-Roy



> On Dec 29, 2016, at 11:40 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 29/12/2016 1:44 PM, Roy Mendelssohn - NOAA Federal wrote:
>> Thanks,  but as I said,  my next question is how best to proceed with CRAN.  I do not want to waste peoples' time with a submission that I know before hand will be rejected.   Can I submit with this warning?
> 
> I'd recommend waiting a few days.  If you really want to submit soon, you can figure out which is the offending command, and wrap it in something that suppresses the warning (e.g. suppressWarnings(), assuming the conversion to an error happens later).
> 
> I don't think your package would be accepted if the vignette won't build on R-devel.
> 
> Duncan Murdoch
> 
>> -Roy
>> 
>> 
>>> On Dec 29, 2016, at 10:38 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>> 
>>> On 29/12/2016 1:24 PM, Ben Bolker wrote:
>>>> Sorry, correction/clarification to my last post: it's *not* a bug in
>>>> ggplot2, rather apparently (?) it's something in base R that has broken
>>>> tests in both data.table and ggplot2. (Since your code calls ggplot,
>>>> though, it's presumably in there somewhere, and (?) not your problem.)
>>> 
>>> The NEWS item is here:
>>> 
>>> http://developer.r-project.org/blosxom.cgi/R-devel/2016/12/28#n2016-12-28
>>> 
>>> The issue is discussed in a bit more detail on R-devel (subject "[Rd] Unexpected I(NULL) output") and <https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=17198>.
>>> 
>>> Overall it seems like a good idea:  some code (perhaps in ggplot2, I haven't tried to track it down) appears to be trying to set attributes on NULL.  This will silently fail in versions of R prior to R-devel rev 71841, and will fail with a warning in that version or later.  (Since the change to R-devel is very recent, it may change again.)
>>> 
>>> Duncan Murdoch
>>> 
>>>> 
>>>> cheers
>>>>   Ben
>>>> 
>>>> 
>>>> 
>>>> On 16-12-29 01:16 PM, Roy Mendelssohn - NOAA Federal wrote:
>>>>> Hi All:
>>>>> 
>>>>> I am working on a new submission of my xtractomatic package  (the
>>>>> main change being the use of https).  I develop on a Mac.  When I run
>>>>> on the Mac:
>>>>> 
>>>>> devtools::check()
>>>>> 
>>>>> I get no errors, notes, or warnings.  However, when I run
>>>>> devtools::build_win(), the response I get back isL
>>>>> 
>>>>> 
>>>>>> * checking for unstated dependencies in vignettes ... OK * checking
>>>>>> package vignettes in 'inst/doc' ... OK * checking re-building of
>>>>>> vignette outputs ... WARNING Error in re-building vignettes: ...
>>>>>> Quitting from lines 248-261 (Usingxtractomatic.Rmd) Error:
>>>>>> processing vignette 'Usingxtractomatic.Rmd' failed with
>>>>>> diagnostics: (converted from warning) Calling 'structure(NULL, *)'
>>>>>> is deprecated, as NULL cannot have attributes. Consider
>>>>>> 'structure(list(), *)' instead. Execution halted
>>>>>> 
>>>>> 
>>>>> So this error is from my Vignette.  The offending lines appear to
>>>>> be:
>>>>> 
>>>>>> ```{r topotagPlot, fig.align = 'center', fig.width = 6, fig.height
>>>>>> = 4, warning = FALSE} require("ggplot2") alldata <- cbind(tagData,
>>>>>> topo) alldata$lon <- alldata$lon - 360 z <- ggplot(alldata, aes(x =
>>>>>> lon,y = lat)) + geom_point(aes(colour = mean), size = 2.) +
>>>>>> scale_shape_manual(values = c(19, 1)) z + geom_polygon(data = w,
>>>>>> aes(x = long, y = lat, group = group), fill = "grey80") +
>>>>>> theme_bw() + scale_colour_gradient("Depth") + coord_fixed(1.3, xlim
>>>>>> = xlim, ylim = ylim) + ggtitle("Bathymetry at marlin tag
>>>>>> locations")
>>>>>> 
>>>>>> ```
>>>>>> 
>>>>> 
>>>>> 
>>>>> Now the vignette builds fine on my machine,  and  I can run it by
>>>>> "hand"  (as an R Notebook, executing each chunk) and it works also.
>>>>> Looking at the offending code chunk,  I can honestly say I have no
>>>>> idea what the error message is referring to.    When I run by hand,
>>>>> I have checked that both tagData and topo are properly defined.  But
>>>>> is that the problem,  is the error message from the  cbind?
>>>>> 
>>>>> Thanks for any help.
>>>>> 
>>>>> -Roy
>>>>> 
>>>>> 
>>>>> ********************** "The contents of this message do not reflect
>>>>> any position of the U.S. Government or NOAA." **********************
>>>>> Roy Mendelssohn Supervisory Operations Research Analyst NOAA/NMFS
>>>>> Environmental Research Division Southwest Fisheries Science Center
>>>>> ***Note new street address*** 110 McAllister Way Santa Cruz, CA
>>>>> 95060 Phone: (831)-420-3666 Fax: (831) 420-3980 e-mail:
>>>>> Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>>>> 
>>>>> "Old age and treachery will overcome youth and skill." "From those
>>>>> who have been given much, much will be expected" "the arc of the
>>>>> moral universe is long, but it bends toward justice" -MLK Jr.
>>>>> 
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>> 
>>>> 
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>> 
>>> 
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> 
>> **********************
>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>> **********************
>> Roy Mendelssohn
>> Supervisory Operations Research Analyst
>> NOAA/NMFS
>> Environmental Research Division
>> Southwest Fisheries Science Center
>> ***Note new street address***
>> 110 McAllister Way
>> Santa Cruz, CA 95060
>> Phone: (831)-420-3666
>> Fax: (831) 420-3980
>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>> 
>> "Old age and treachery will overcome youth and skill."
>> "From those who have been given much, much will be expected"
>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>> 
> 

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From roy.mendelssohn at noaa.gov  Thu Dec 29 20:58:11 2016
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Thu, 29 Dec 2016 11:58:11 -0800
Subject: [R-pkg-devel] warning from win_build
In-Reply-To: <A6C36163-A2A5-4B5C-A2EF-FB64F3094503@noaa.gov>
References: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
	<cc637a0a-a960-0418-79b4-6d36154d3663@gmail.com>
	<15940c35-9f28-5de7-c781-a6c6bca899f2@gmail.com>
	<509D0656-2FB9-4A0C-B8D1-AF21F3F77D70@noaa.gov>
	<15360f17-1c22-7395-16e6-22b23d7d209d@gmail.com>
	<A6C36163-A2A5-4B5C-A2EF-FB64F3094503@noaa.gov>
Message-ID: <F2B134E8-8998-47E3-AA9D-90407EA828E3@noaa.gov>

HI All:

If any cares,  the offending line is in the  ggplot2  file utilities.r where it has:

> #' A waiver object.
> #'
> #' A waiver is a "flag" object, similar to \code{NULL}, that indicates the
> #' calling function should just use the default value.  It is used in certain
> #' functions to distinguish between displaying nothing (\code{NULL}) and
> #' displaying a default value calculated elsewhere (\code{waiver()})
> #'
> #' @export
> #' @keywords internal
> waiver <- function() structure(NULL, class = "waiver")
> 
> is.waive <- function(x) inherits(x, "waiver")

If you then do a multi-file search on "waive" you find that it is used all throughout the code base, so anytime waiver() is called, so is the NULL structure.

-Roy




> 
> On Dec 29, 2016, at 11:44 AM, Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
> 
> Thanks.  I can wait.  I will also see if I can figure out a work around in the meantime.  Is the submission to winbuild automated?  That is really the only way I have to check, but I don't want to keep on checking if someone's time is being wasted by that.  If automated,  the I don't mind making repeated submissions.
> 
> Thanks again,
> 
> -Roy
> 
> 
> 
>> On Dec 29, 2016, at 11:40 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>> 
>> On 29/12/2016 1:44 PM, Roy Mendelssohn - NOAA Federal wrote:
>>> Thanks,  but as I said,  my next question is how best to proceed with CRAN.  I do not want to waste peoples' time with a submission that I know before hand will be rejected.   Can I submit with this warning?
>> 
>> I'd recommend waiting a few days.  If you really want to submit soon, you can figure out which is the offending command, and wrap it in something that suppresses the warning (e.g. suppressWarnings(), assuming the conversion to an error happens later).
>> 
>> I don't think your package would be accepted if the vignette won't build on R-devel.
>> 
>> Duncan Murdoch
>> 
>>> -Roy
>>> 
>>> 
>>>> On Dec 29, 2016, at 10:38 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>> 
>>>> On 29/12/2016 1:24 PM, Ben Bolker wrote:
>>>>> Sorry, correction/clarification to my last post: it's *not* a bug in
>>>>> ggplot2, rather apparently (?) it's something in base R that has broken
>>>>> tests in both data.table and ggplot2. (Since your code calls ggplot,
>>>>> though, it's presumably in there somewhere, and (?) not your problem.)
>>>> 
>>>> The NEWS item is here:
>>>> 
>>>> http://developer.r-project.org/blosxom.cgi/R-devel/2016/12/28#n2016-12-28
>>>> 
>>>> The issue is discussed in a bit more detail on R-devel (subject "[Rd] Unexpected I(NULL) output") and <https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=17198>.
>>>> 
>>>> Overall it seems like a good idea:  some code (perhaps in ggplot2, I haven't tried to track it down) appears to be trying to set attributes on NULL.  This will silently fail in versions of R prior to R-devel rev 71841, and will fail with a warning in that version or later.  (Since the change to R-devel is very recent, it may change again.)
>>>> 
>>>> Duncan Murdoch
>>>> 
>>>>> 
>>>>> cheers
>>>>>  Ben
>>>>> 
>>>>> 
>>>>> 
>>>>> On 16-12-29 01:16 PM, Roy Mendelssohn - NOAA Federal wrote:
>>>>>> Hi All:
>>>>>> 
>>>>>> I am working on a new submission of my xtractomatic package  (the
>>>>>> main change being the use of https).  I develop on a Mac.  When I run
>>>>>> on the Mac:
>>>>>> 
>>>>>> devtools::check()
>>>>>> 
>>>>>> I get no errors, notes, or warnings.  However, when I run
>>>>>> devtools::build_win(), the response I get back isL
>>>>>> 
>>>>>> 
>>>>>>> * checking for unstated dependencies in vignettes ... OK * checking
>>>>>>> package vignettes in 'inst/doc' ... OK * checking re-building of
>>>>>>> vignette outputs ... WARNING Error in re-building vignettes: ...
>>>>>>> Quitting from lines 248-261 (Usingxtractomatic.Rmd) Error:
>>>>>>> processing vignette 'Usingxtractomatic.Rmd' failed with
>>>>>>> diagnostics: (converted from warning) Calling 'structure(NULL, *)'
>>>>>>> is deprecated, as NULL cannot have attributes. Consider
>>>>>>> 'structure(list(), *)' instead. Execution halted
>>>>>>> 
>>>>>> 
>>>>>> So this error is from my Vignette.  The offending lines appear to
>>>>>> be:
>>>>>> 
>>>>>>> ```{r topotagPlot, fig.align = 'center', fig.width = 6, fig.height
>>>>>>> = 4, warning = FALSE} require("ggplot2") alldata <- cbind(tagData,
>>>>>>> topo) alldata$lon <- alldata$lon - 360 z <- ggplot(alldata, aes(x =
>>>>>>> lon,y = lat)) + geom_point(aes(colour = mean), size = 2.) +
>>>>>>> scale_shape_manual(values = c(19, 1)) z + geom_polygon(data = w,
>>>>>>> aes(x = long, y = lat, group = group), fill = "grey80") +
>>>>>>> theme_bw() + scale_colour_gradient("Depth") + coord_fixed(1.3, xlim
>>>>>>> = xlim, ylim = ylim) + ggtitle("Bathymetry at marlin tag
>>>>>>> locations")
>>>>>>> 
>>>>>>> ```
>>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> Now the vignette builds fine on my machine,  and  I can run it by
>>>>>> "hand"  (as an R Notebook, executing each chunk) and it works also.
>>>>>> Looking at the offending code chunk,  I can honestly say I have no
>>>>>> idea what the error message is referring to.    When I run by hand,
>>>>>> I have checked that both tagData and topo are properly defined.  But
>>>>>> is that the problem,  is the error message from the  cbind?
>>>>>> 
>>>>>> Thanks for any help.
>>>>>> 
>>>>>> -Roy
>>>>>> 
>>>>>> 
>>>>>> ********************** "The contents of this message do not reflect
>>>>>> any position of the U.S. Government or NOAA." **********************
>>>>>> Roy Mendelssohn Supervisory Operations Research Analyst NOAA/NMFS
>>>>>> Environmental Research Division Southwest Fisheries Science Center
>>>>>> ***Note new street address*** 110 McAllister Way Santa Cruz, CA
>>>>>> 95060 Phone: (831)-420-3666 Fax: (831) 420-3980 e-mail:
>>>>>> Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>>>>> 
>>>>>> "Old age and treachery will overcome youth and skill." "From those
>>>>>> who have been given much, much will be expected" "the arc of the
>>>>>> moral universe is long, but it bends toward justice" -MLK Jr.
>>>>>> 
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>> 
>>>>> 
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>> 
>>>> 
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>> 
>>> **********************
>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>> **********************
>>> Roy Mendelssohn
>>> Supervisory Operations Research Analyst
>>> NOAA/NMFS
>>> Environmental Research Division
>>> Southwest Fisheries Science Center
>>> ***Note new street address***
>>> 110 McAllister Way
>>> Santa Cruz, CA 95060
>>> Phone: (831)-420-3666
>>> Fax: (831) 420-3980
>>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>> 
>>> "Old age and treachery will overcome youth and skill."
>>> "From those who have been given much, much will be expected"
>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>> 
>> 
> 
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
> 
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected" 
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> 

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From murdoch.duncan at gmail.com  Fri Dec 30 00:50:05 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 29 Dec 2016 18:50:05 -0500
Subject: [R-pkg-devel] warning from win_build
In-Reply-To: <F2B134E8-8998-47E3-AA9D-90407EA828E3@noaa.gov>
References: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
	<cc637a0a-a960-0418-79b4-6d36154d3663@gmail.com>
	<15940c35-9f28-5de7-c781-a6c6bca899f2@gmail.com>
	<509D0656-2FB9-4A0C-B8D1-AF21F3F77D70@noaa.gov>
	<15360f17-1c22-7395-16e6-22b23d7d209d@gmail.com>
	<A6C36163-A2A5-4B5C-A2EF-FB64F3094503@noaa.gov>
	<F2B134E8-8998-47E3-AA9D-90407EA828E3@noaa.gov>
Message-ID: <8b6958b4-2d4a-d633-61f0-0361a574ea84@gmail.com>

On 29/12/2016 2:58 PM, Roy Mendelssohn - NOAA Federal wrote:
> HI All:
>
> If any cares,  the offending line is in the  ggplot2  file utilities.r where it has:
>
>> #' A waiver object.
>> #'
>> #' A waiver is a "flag" object, similar to \code{NULL}, that indicates the
>> #' calling function should just use the default value.  It is used in certain
>> #' functions to distinguish between displaying nothing (\code{NULL}) and
>> #' displaying a default value calculated elsewhere (\code{waiver()})
>> #'
>> #' @export
>> #' @keywords internal
>> waiver <- function() structure(NULL, class = "waiver")
>>
>> is.waive <- function(x) inherits(x, "waiver")
>
> If you then do a multi-file search on "waive" you find that it is used all throughout the code base, so anytime waiver() is called, so is the NULL structure.

That usage will work:  though waiver() tries to put a class on NULL, 
structure() puts it on a length-zero list instead.  R-devel's complaint 
is unnecessary here, but could be avoided with the code change

waiver <- function() structure(list(), class = "waiver")

I've cc'd Hadley to let him know.

Duncan Murdoch


>
> -Roy
>
>
>
>
>>
>> On Dec 29, 2016, at 11:44 AM, Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
>>
>> Thanks.  I can wait.  I will also see if I can figure out a work around in the meantime.  Is the submission to winbuild automated?  That is really the only way I have to check, but I don't want to keep on checking if someone's time is being wasted by that.  If automated,  the I don't mind making repeated submissions.
>>
>> Thanks again,
>>
>> -Roy
>>
>>
>>
>>> On Dec 29, 2016, at 11:40 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>
>>> On 29/12/2016 1:44 PM, Roy Mendelssohn - NOAA Federal wrote:
>>>> Thanks,  but as I said,  my next question is how best to proceed with CRAN.  I do not want to waste peoples' time with a submission that I know before hand will be rejected.   Can I submit with this warning?
>>>
>>> I'd recommend waiting a few days.  If you really want to submit soon, you can figure out which is the offending command, and wrap it in something that suppresses the warning (e.g. suppressWarnings(), assuming the conversion to an error happens later).
>>>
>>> I don't think your package would be accepted if the vignette won't build on R-devel.
>>>
>>> Duncan Murdoch
>>>
>>>> -Roy
>>>>
>>>>
>>>>> On Dec 29, 2016, at 10:38 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>>>
>>>>> On 29/12/2016 1:24 PM, Ben Bolker wrote:
>>>>>> Sorry, correction/clarification to my last post: it's *not* a bug in
>>>>>> ggplot2, rather apparently (?) it's something in base R that has broken
>>>>>> tests in both data.table and ggplot2. (Since your code calls ggplot,
>>>>>> though, it's presumably in there somewhere, and (?) not your problem.)
>>>>>
>>>>> The NEWS item is here:
>>>>>
>>>>> http://developer.r-project.org/blosxom.cgi/R-devel/2016/12/28#n2016-12-28
>>>>>
>>>>> The issue is discussed in a bit more detail on R-devel (subject "[Rd] Unexpected I(NULL) output") and <https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=17198>.
>>>>>
>>>>> Overall it seems like a good idea:  some code (perhaps in ggplot2, I haven't tried to track it down) appears to be trying to set attributes on NULL.  This will silently fail in versions of R prior to R-devel rev 71841, and will fail with a warning in that version or later.  (Since the change to R-devel is very recent, it may change again.)
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>> cheers
>>>>>>  Ben
>>>>>>
>>>>>>
>>>>>>
>>>>>> On 16-12-29 01:16 PM, Roy Mendelssohn - NOAA Federal wrote:
>>>>>>> Hi All:
>>>>>>>
>>>>>>> I am working on a new submission of my xtractomatic package  (the
>>>>>>> main change being the use of https).  I develop on a Mac.  When I run
>>>>>>> on the Mac:
>>>>>>>
>>>>>>> devtools::check()
>>>>>>>
>>>>>>> I get no errors, notes, or warnings.  However, when I run
>>>>>>> devtools::build_win(), the response I get back isL
>>>>>>>
>>>>>>>
>>>>>>>> * checking for unstated dependencies in vignettes ... OK * checking
>>>>>>>> package vignettes in 'inst/doc' ... OK * checking re-building of
>>>>>>>> vignette outputs ... WARNING Error in re-building vignettes: ...
>>>>>>>> Quitting from lines 248-261 (Usingxtractomatic.Rmd) Error:
>>>>>>>> processing vignette 'Usingxtractomatic.Rmd' failed with
>>>>>>>> diagnostics: (converted from warning) Calling 'structure(NULL, *)'
>>>>>>>> is deprecated, as NULL cannot have attributes. Consider
>>>>>>>> 'structure(list(), *)' instead. Execution halted
>>>>>>>>
>>>>>>>
>>>>>>> So this error is from my Vignette.  The offending lines appear to
>>>>>>> be:
>>>>>>>
>>>>>>>> ```{r topotagPlot, fig.align = 'center', fig.width = 6, fig.height
>>>>>>>> = 4, warning = FALSE} require("ggplot2") alldata <- cbind(tagData,
>>>>>>>> topo) alldata$lon <- alldata$lon - 360 z <- ggplot(alldata, aes(x =
>>>>>>>> lon,y = lat)) + geom_point(aes(colour = mean), size = 2.) +
>>>>>>>> scale_shape_manual(values = c(19, 1)) z + geom_polygon(data = w,
>>>>>>>> aes(x = long, y = lat, group = group), fill = "grey80") +
>>>>>>>> theme_bw() + scale_colour_gradient("Depth") + coord_fixed(1.3, xlim
>>>>>>>> = xlim, ylim = ylim) + ggtitle("Bathymetry at marlin tag
>>>>>>>> locations")
>>>>>>>>
>>>>>>>> ```
>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> Now the vignette builds fine on my machine,  and  I can run it by
>>>>>>> "hand"  (as an R Notebook, executing each chunk) and it works also.
>>>>>>> Looking at the offending code chunk,  I can honestly say I have no
>>>>>>> idea what the error message is referring to.    When I run by hand,
>>>>>>> I have checked that both tagData and topo are properly defined.  But
>>>>>>> is that the problem,  is the error message from the  cbind?
>>>>>>>
>>>>>>> Thanks for any help.
>>>>>>>
>>>>>>> -Roy
>>>>>>>
>>>>>>>
>>>>>>> ********************** "The contents of this message do not reflect
>>>>>>> any position of the U.S. Government or NOAA." **********************
>>>>>>> Roy Mendelssohn Supervisory Operations Research Analyst NOAA/NMFS
>>>>>>> Environmental Research Division Southwest Fisheries Science Center
>>>>>>> ***Note new street address*** 110 McAllister Way Santa Cruz, CA
>>>>>>> 95060 Phone: (831)-420-3666 Fax: (831) 420-3980 e-mail:
>>>>>>> Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>>>>>>
>>>>>>> "Old age and treachery will overcome youth and skill." "From those
>>>>>>> who have been given much, much will be expected" "the arc of the
>>>>>>> moral universe is long, but it bends toward justice" -MLK Jr.
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>> **********************
>>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>>> **********************
>>>> Roy Mendelssohn
>>>> Supervisory Operations Research Analyst
>>>> NOAA/NMFS
>>>> Environmental Research Division
>>>> Southwest Fisheries Science Center
>>>> ***Note new street address***
>>>> 110 McAllister Way
>>>> Santa Cruz, CA 95060
>>>> Phone: (831)-420-3666
>>>> Fax: (831) 420-3980
>>>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>>>
>>>> "Old age and treachery will overcome youth and skill."
>>>> "From those who have been given much, much will be expected"
>>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>>>
>>>
>>
>> **********************
>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>> **********************
>> Roy Mendelssohn
>> Supervisory Operations Research Analyst
>> NOAA/NMFS
>> Environmental Research Division
>> Southwest Fisheries Science Center
>> ***Note new street address***
>> 110 McAllister Way
>> Santa Cruz, CA 95060
>> Phone: (831)-420-3666
>> Fax: (831) 420-3980
>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>
>> "Old age and treachery will overcome youth and skill."
>> "From those who have been given much, much will be expected"
>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>
>
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>


From murdoch.duncan at gmail.com  Fri Dec 30 22:49:54 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 30 Dec 2016 16:49:54 -0500
Subject: [R-pkg-devel] warning from win_build
In-Reply-To: <8b6958b4-2d4a-d633-61f0-0361a574ea84@gmail.com>
References: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
	<cc637a0a-a960-0418-79b4-6d36154d3663@gmail.com>
	<15940c35-9f28-5de7-c781-a6c6bca899f2@gmail.com>
	<509D0656-2FB9-4A0C-B8D1-AF21F3F77D70@noaa.gov>
	<15360f17-1c22-7395-16e6-22b23d7d209d@gmail.com>
	<A6C36163-A2A5-4B5C-A2EF-FB64F3094503@noaa.gov>
	<F2B134E8-8998-47E3-AA9D-90407EA828E3@noaa.gov>
	<8b6958b4-2d4a-d633-61f0-0361a574ea84@gmail.com>
Message-ID: <0a35e8b6-656f-ec63-f888-1c6268dd810b@gmail.com>

On 29/12/2016 6:50 PM, Duncan Murdoch wrote:
> On 29/12/2016 2:58 PM, Roy Mendelssohn - NOAA Federal wrote:
>> HI All:
>>
>> If any cares,  the offending line is in the  ggplot2  file utilities.r where it has:
>>
>>> #' A waiver object.
>>> #'
>>> #' A waiver is a "flag" object, similar to \code{NULL}, that indicates the
>>> #' calling function should just use the default value.  It is used in certain
>>> #' functions to distinguish between displaying nothing (\code{NULL}) and
>>> #' displaying a default value calculated elsewhere (\code{waiver()})
>>> #'
>>> #' @export
>>> #' @keywords internal
>>> waiver <- function() structure(NULL, class = "waiver")
>>>
>>> is.waive <- function(x) inherits(x, "waiver")
>>
>> If you then do a multi-file search on "waive" you find that it is used all throughout the code base, so anytime waiver() is called, so is the NULL structure.
>
> That usage will work:  though waiver() tries to put a class on NULL,
> structure() puts it on a length-zero list instead.  R-devel's complaint
> is unnecessary here, but could be avoided with the code change
>
> waiver <- function() structure(list(), class = "waiver")
>
> I've cc'd Hadley to let him know.

Hadley submitted a patch, which is on CRAN now (version 2.2.1).  It will 
take a little while to propagate to the mirrors, but things should be 
fine in your package once you update ggplot2.

Duncan Murdoch

>
> Duncan Murdoch
>
>
>>
>> -Roy
>>
>>
>>
>>
>>>
>>> On Dec 29, 2016, at 11:44 AM, Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
>>>
>>> Thanks.  I can wait.  I will also see if I can figure out a work around in the meantime.  Is the submission to winbuild automated?  That is really the only way I have to check, but I don't want to keep on checking if someone's time is being wasted by that.  If automated,  the I don't mind making repeated submissions.
>>>
>>> Thanks again,
>>>
>>> -Roy
>>>
>>>
>>>
>>>> On Dec 29, 2016, at 11:40 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>>
>>>> On 29/12/2016 1:44 PM, Roy Mendelssohn - NOAA Federal wrote:
>>>>> Thanks,  but as I said,  my next question is how best to proceed with CRAN.  I do not want to waste peoples' time with a submission that I know before hand will be rejected.   Can I submit with this warning?
>>>>
>>>> I'd recommend waiting a few days.  If you really want to submit soon, you can figure out which is the offending command, and wrap it in something that suppresses the warning (e.g. suppressWarnings(), assuming the conversion to an error happens later).
>>>>
>>>> I don't think your package would be accepted if the vignette won't build on R-devel.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>> -Roy
>>>>>
>>>>>
>>>>>> On Dec 29, 2016, at 10:38 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>>>>
>>>>>> On 29/12/2016 1:24 PM, Ben Bolker wrote:
>>>>>>> Sorry, correction/clarification to my last post: it's *not* a bug in
>>>>>>> ggplot2, rather apparently (?) it's something in base R that has broken
>>>>>>> tests in both data.table and ggplot2. (Since your code calls ggplot,
>>>>>>> though, it's presumably in there somewhere, and (?) not your problem.)
>>>>>>
>>>>>> The NEWS item is here:
>>>>>>
>>>>>> http://developer.r-project.org/blosxom.cgi/R-devel/2016/12/28#n2016-12-28
>>>>>>
>>>>>> The issue is discussed in a bit more detail on R-devel (subject "[Rd] Unexpected I(NULL) output") and <https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=17198>.
>>>>>>
>>>>>> Overall it seems like a good idea:  some code (perhaps in ggplot2, I haven't tried to track it down) appears to be trying to set attributes on NULL.  This will silently fail in versions of R prior to R-devel rev 71841, and will fail with a warning in that version or later.  (Since the change to R-devel is very recent, it may change again.)
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> cheers
>>>>>>>  Ben
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> On 16-12-29 01:16 PM, Roy Mendelssohn - NOAA Federal wrote:
>>>>>>>> Hi All:
>>>>>>>>
>>>>>>>> I am working on a new submission of my xtractomatic package  (the
>>>>>>>> main change being the use of https).  I develop on a Mac.  When I run
>>>>>>>> on the Mac:
>>>>>>>>
>>>>>>>> devtools::check()
>>>>>>>>
>>>>>>>> I get no errors, notes, or warnings.  However, when I run
>>>>>>>> devtools::build_win(), the response I get back isL
>>>>>>>>
>>>>>>>>
>>>>>>>>> * checking for unstated dependencies in vignettes ... OK * checking
>>>>>>>>> package vignettes in 'inst/doc' ... OK * checking re-building of
>>>>>>>>> vignette outputs ... WARNING Error in re-building vignettes: ...
>>>>>>>>> Quitting from lines 248-261 (Usingxtractomatic.Rmd) Error:
>>>>>>>>> processing vignette 'Usingxtractomatic.Rmd' failed with
>>>>>>>>> diagnostics: (converted from warning) Calling 'structure(NULL, *)'
>>>>>>>>> is deprecated, as NULL cannot have attributes. Consider
>>>>>>>>> 'structure(list(), *)' instead. Execution halted
>>>>>>>>>
>>>>>>>>
>>>>>>>> So this error is from my Vignette.  The offending lines appear to
>>>>>>>> be:
>>>>>>>>
>>>>>>>>> ```{r topotagPlot, fig.align = 'center', fig.width = 6, fig.height
>>>>>>>>> = 4, warning = FALSE} require("ggplot2") alldata <- cbind(tagData,
>>>>>>>>> topo) alldata$lon <- alldata$lon - 360 z <- ggplot(alldata, aes(x =
>>>>>>>>> lon,y = lat)) + geom_point(aes(colour = mean), size = 2.) +
>>>>>>>>> scale_shape_manual(values = c(19, 1)) z + geom_polygon(data = w,
>>>>>>>>> aes(x = long, y = lat, group = group), fill = "grey80") +
>>>>>>>>> theme_bw() + scale_colour_gradient("Depth") + coord_fixed(1.3, xlim
>>>>>>>>> = xlim, ylim = ylim) + ggtitle("Bathymetry at marlin tag
>>>>>>>>> locations")
>>>>>>>>>
>>>>>>>>> ```
>>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>> Now the vignette builds fine on my machine,  and  I can run it by
>>>>>>>> "hand"  (as an R Notebook, executing each chunk) and it works also.
>>>>>>>> Looking at the offending code chunk,  I can honestly say I have no
>>>>>>>> idea what the error message is referring to.    When I run by hand,
>>>>>>>> I have checked that both tagData and topo are properly defined.  But
>>>>>>>> is that the problem,  is the error message from the  cbind?
>>>>>>>>
>>>>>>>> Thanks for any help.
>>>>>>>>
>>>>>>>> -Roy
>>>>>>>>
>>>>>>>>
>>>>>>>> ********************** "The contents of this message do not reflect
>>>>>>>> any position of the U.S. Government or NOAA." **********************
>>>>>>>> Roy Mendelssohn Supervisory Operations Research Analyst NOAA/NMFS
>>>>>>>> Environmental Research Division Southwest Fisheries Science Center
>>>>>>>> ***Note new street address*** 110 McAllister Way Santa Cruz, CA
>>>>>>>> 95060 Phone: (831)-420-3666 Fax: (831) 420-3980 e-mail:
>>>>>>>> Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>>>>>>>
>>>>>>>> "Old age and treachery will overcome youth and skill." "From those
>>>>>>>> who have been given much, much will be expected" "the arc of the
>>>>>>>> moral universe is long, but it bends toward justice" -MLK Jr.
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>>>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>
>>>>> **********************
>>>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>>>> **********************
>>>>> Roy Mendelssohn
>>>>> Supervisory Operations Research Analyst
>>>>> NOAA/NMFS
>>>>> Environmental Research Division
>>>>> Southwest Fisheries Science Center
>>>>> ***Note new street address***
>>>>> 110 McAllister Way
>>>>> Santa Cruz, CA 95060
>>>>> Phone: (831)-420-3666
>>>>> Fax: (831) 420-3980
>>>>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>>>>
>>>>> "Old age and treachery will overcome youth and skill."
>>>>> "From those who have been given much, much will be expected"
>>>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>>>>
>>>>
>>>
>>> **********************
>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>> **********************
>>> Roy Mendelssohn
>>> Supervisory Operations Research Analyst
>>> NOAA/NMFS
>>> Environmental Research Division
>>> Southwest Fisheries Science Center
>>> ***Note new street address***
>>> 110 McAllister Way
>>> Santa Cruz, CA 95060
>>> Phone: (831)-420-3666
>>> Fax: (831) 420-3980
>>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>>
>>> "Old age and treachery will overcome youth and skill."
>>> "From those who have been given much, much will be expected"
>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>>
>>
>> **********************
>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>> **********************
>> Roy Mendelssohn
>> Supervisory Operations Research Analyst
>> NOAA/NMFS
>> Environmental Research Division
>> Southwest Fisheries Science Center
>> ***Note new street address***
>> 110 McAllister Way
>> Santa Cruz, CA 95060
>> Phone: (831)-420-3666
>> Fax: (831) 420-3980
>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>
>> "Old age and treachery will overcome youth and skill."
>> "From those who have been given much, much will be expected"
>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>
>


From roy.mendelssohn at noaa.gov  Fri Dec 30 22:54:59 2016
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Fri, 30 Dec 2016 13:54:59 -0800
Subject: [R-pkg-devel] warning from win_build
In-Reply-To: <0a35e8b6-656f-ec63-f888-1c6268dd810b@gmail.com>
References: <D6A7C6C2-F8FE-4D45-95F2-4C8264F28908@noaa.gov>
	<cc637a0a-a960-0418-79b4-6d36154d3663@gmail.com>
	<15940c35-9f28-5de7-c781-a6c6bca899f2@gmail.com>
	<509D0656-2FB9-4A0C-B8D1-AF21F3F77D70@noaa.gov>
	<15360f17-1c22-7395-16e6-22b23d7d209d@gmail.com>
	<A6C36163-A2A5-4B5C-A2EF-FB64F3094503@noaa.gov>
	<F2B134E8-8998-47E3-AA9D-90407EA828E3@noaa.gov>
	<8b6958b4-2d4a-d633-61f0-0361a574ea84@gmail.com>
	<0a35e8b6-656f-ec63-f888-1c6268dd810b@gmail.com>
Message-ID: <E7F2F247-8298-48C2-AF0E-F36FB23D7A95@noaa.gov>

Thanks to all.  

I will give it several days to work it's way through.  In my case,  I need for it to be on build_win.

Happy new year,

-Roy


> On Dec 30, 2016, at 1:49 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 29/12/2016 6:50 PM, Duncan Murdoch wrote:
>> On 29/12/2016 2:58 PM, Roy Mendelssohn - NOAA Federal wrote:
>>> HI All:
>>> 
>>> If any cares,  the offending line is in the  ggplot2  file utilities.r where it has:
>>> 
>>>> #' A waiver object.
>>>> #'
>>>> #' A waiver is a "flag" object, similar to \code{NULL}, that indicates the
>>>> #' calling function should just use the default value.  It is used in certain
>>>> #' functions to distinguish between displaying nothing (\code{NULL}) and
>>>> #' displaying a default value calculated elsewhere (\code{waiver()})
>>>> #'
>>>> #' @export
>>>> #' @keywords internal
>>>> waiver <- function() structure(NULL, class = "waiver")
>>>> 
>>>> is.waive <- function(x) inherits(x, "waiver")
>>> 
>>> If you then do a multi-file search on "waive" you find that it is used all throughout the code base, so anytime waiver() is called, so is the NULL structure.
>> 
>> That usage will work:  though waiver() tries to put a class on NULL,
>> structure() puts it on a length-zero list instead.  R-devel's complaint
>> is unnecessary here, but could be avoided with the code change
>> 
>> waiver <- function() structure(list(), class = "waiver")
>> 
>> I've cc'd Hadley to let him know.
> 
> Hadley submitted a patch, which is on CRAN now (version 2.2.1).  It will take a little while to propagate to the mirrors, but things should be fine in your package once you update ggplot2.
> 
> Duncan Murdoch
> 
>> 
>> Duncan Murdoch
>> 
>> 
>>> 
>>> -Roy
>>> 
>>> 
>>> 
>>> 
>>>> 
>>>> On Dec 29, 2016, at 11:44 AM, Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
>>>> 
>>>> Thanks.  I can wait.  I will also see if I can figure out a work around in the meantime.  Is the submission to winbuild automated?  That is really the only way I have to check, but I don't want to keep on checking if someone's time is being wasted by that.  If automated,  the I don't mind making repeated submissions.
>>>> 
>>>> Thanks again,
>>>> 
>>>> -Roy
>>>> 
>>>> 
>>>> 
>>>>> On Dec 29, 2016, at 11:40 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>>> 
>>>>> On 29/12/2016 1:44 PM, Roy Mendelssohn - NOAA Federal wrote:
>>>>>> Thanks,  but as I said,  my next question is how best to proceed with CRAN.  I do not want to waste peoples' time with a submission that I know before hand will be rejected.   Can I submit with this warning?
>>>>> 
>>>>> I'd recommend waiting a few days.  If you really want to submit soon, you can figure out which is the offending command, and wrap it in something that suppresses the warning (e.g. suppressWarnings(), assuming the conversion to an error happens later).
>>>>> 
>>>>> I don't think your package would be accepted if the vignette won't build on R-devel.
>>>>> 
>>>>> Duncan Murdoch
>>>>> 
>>>>>> -Roy
>>>>>> 
>>>>>> 
>>>>>>> On Dec 29, 2016, at 10:38 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>>>>> 
>>>>>>> On 29/12/2016 1:24 PM, Ben Bolker wrote:
>>>>>>>> Sorry, correction/clarification to my last post: it's *not* a bug in
>>>>>>>> ggplot2, rather apparently (?) it's something in base R that has broken
>>>>>>>> tests in both data.table and ggplot2. (Since your code calls ggplot,
>>>>>>>> though, it's presumably in there somewhere, and (?) not your problem.)
>>>>>>> 
>>>>>>> The NEWS item is here:
>>>>>>> 
>>>>>>> http://developer.r-project.org/blosxom.cgi/R-devel/2016/12/28#n2016-12-28
>>>>>>> 
>>>>>>> The issue is discussed in a bit more detail on R-devel (subject "[Rd] Unexpected I(NULL) output") and <https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=17198>.
>>>>>>> 
>>>>>>> Overall it seems like a good idea:  some code (perhaps in ggplot2, I haven't tried to track it down) appears to be trying to set attributes on NULL.  This will silently fail in versions of R prior to R-devel rev 71841, and will fail with a warning in that version or later.  (Since the change to R-devel is very recent, it may change again.)
>>>>>>> 
>>>>>>> Duncan Murdoch
>>>>>>> 
>>>>>>>> 
>>>>>>>> cheers
>>>>>>>> Ben
>>>>>>>> 
>>>>>>>> 
>>>>>>>> 
>>>>>>>> On 16-12-29 01:16 PM, Roy Mendelssohn - NOAA Federal wrote:
>>>>>>>>> Hi All:
>>>>>>>>> 
>>>>>>>>> I am working on a new submission of my xtractomatic package  (the
>>>>>>>>> main change being the use of https).  I develop on a Mac.  When I run
>>>>>>>>> on the Mac:
>>>>>>>>> 
>>>>>>>>> devtools::check()
>>>>>>>>> 
>>>>>>>>> I get no errors, notes, or warnings.  However, when I run
>>>>>>>>> devtools::build_win(), the response I get back isL
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>>> * checking for unstated dependencies in vignettes ... OK * checking
>>>>>>>>>> package vignettes in 'inst/doc' ... OK * checking re-building of
>>>>>>>>>> vignette outputs ... WARNING Error in re-building vignettes: ...
>>>>>>>>>> Quitting from lines 248-261 (Usingxtractomatic.Rmd) Error:
>>>>>>>>>> processing vignette 'Usingxtractomatic.Rmd' failed with
>>>>>>>>>> diagnostics: (converted from warning) Calling 'structure(NULL, *)'
>>>>>>>>>> is deprecated, as NULL cannot have attributes. Consider
>>>>>>>>>> 'structure(list(), *)' instead. Execution halted
>>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> So this error is from my Vignette.  The offending lines appear to
>>>>>>>>> be:
>>>>>>>>> 
>>>>>>>>>> ```{r topotagPlot, fig.align = 'center', fig.width = 6, fig.height
>>>>>>>>>> = 4, warning = FALSE} require("ggplot2") alldata <- cbind(tagData,
>>>>>>>>>> topo) alldata$lon <- alldata$lon - 360 z <- ggplot(alldata, aes(x =
>>>>>>>>>> lon,y = lat)) + geom_point(aes(colour = mean), size = 2.) +
>>>>>>>>>> scale_shape_manual(values = c(19, 1)) z + geom_polygon(data = w,
>>>>>>>>>> aes(x = long, y = lat, group = group), fill = "grey80") +
>>>>>>>>>> theme_bw() + scale_colour_gradient("Depth") + coord_fixed(1.3, xlim
>>>>>>>>>> = xlim, ylim = ylim) + ggtitle("Bathymetry at marlin tag
>>>>>>>>>> locations")
>>>>>>>>>> 
>>>>>>>>>> ```
>>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> Now the vignette builds fine on my machine,  and  I can run it by
>>>>>>>>> "hand"  (as an R Notebook, executing each chunk) and it works also.
>>>>>>>>> Looking at the offending code chunk,  I can honestly say I have no
>>>>>>>>> idea what the error message is referring to.    When I run by hand,
>>>>>>>>> I have checked that both tagData and topo are properly defined.  But
>>>>>>>>> is that the problem,  is the error message from the  cbind?
>>>>>>>>> 
>>>>>>>>> Thanks for any help.
>>>>>>>>> 
>>>>>>>>> -Roy
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> ********************** "The contents of this message do not reflect
>>>>>>>>> any position of the U.S. Government or NOAA." **********************
>>>>>>>>> Roy Mendelssohn Supervisory Operations Research Analyst NOAA/NMFS
>>>>>>>>> Environmental Research Division Southwest Fisheries Science Center
>>>>>>>>> ***Note new street address*** 110 McAllister Way Santa Cruz, CA
>>>>>>>>> 95060 Phone: (831)-420-3666 Fax: (831) 420-3980 e-mail:
>>>>>>>>> Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>>>>>>>> 
>>>>>>>>> "Old age and treachery will overcome youth and skill." "From those
>>>>>>>>> who have been given much, much will be expected" "the arc of the
>>>>>>>>> moral universe is long, but it bends toward justice" -MLK Jr.
>>>>>>>>> 
>>>>>>>>> ______________________________________________
>>>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>>>> 
>>>>>>>> 
>>>>>>>> ______________________________________________
>>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>>> 
>>>>>>> 
>>>>>>> ______________________________________________
>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>> 
>>>>>> **********************
>>>>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>>>>> **********************
>>>>>> Roy Mendelssohn
>>>>>> Supervisory Operations Research Analyst
>>>>>> NOAA/NMFS
>>>>>> Environmental Research Division
>>>>>> Southwest Fisheries Science Center
>>>>>> ***Note new street address***
>>>>>> 110 McAllister Way
>>>>>> Santa Cruz, CA 95060
>>>>>> Phone: (831)-420-3666
>>>>>> Fax: (831) 420-3980
>>>>>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>>>>> 
>>>>>> "Old age and treachery will overcome youth and skill."
>>>>>> "From those who have been given much, much will be expected"
>>>>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>>>>> 
>>>>> 
>>>> 
>>>> **********************
>>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>>> **********************
>>>> Roy Mendelssohn
>>>> Supervisory Operations Research Analyst
>>>> NOAA/NMFS
>>>> Environmental Research Division
>>>> Southwest Fisheries Science Center
>>>> ***Note new street address***
>>>> 110 McAllister Way
>>>> Santa Cruz, CA 95060
>>>> Phone: (831)-420-3666
>>>> Fax: (831) 420-3980
>>>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>>> 
>>>> "Old age and treachery will overcome youth and skill."
>>>> "From those who have been given much, much will be expected"
>>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>>> 
>>> 
>>> **********************
>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>> **********************
>>> Roy Mendelssohn
>>> Supervisory Operations Research Analyst
>>> NOAA/NMFS
>>> Environmental Research Division
>>> Southwest Fisheries Science Center
>>> ***Note new street address***
>>> 110 McAllister Way
>>> Santa Cruz, CA 95060
>>> Phone: (831)-420-3666
>>> Fax: (831) 420-3980
>>> e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/
>>> 
>>> "Old age and treachery will overcome youth and skill."
>>> "From those who have been given much, much will be expected"
>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


