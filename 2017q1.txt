From glennmschultz at me.com  Sun Jan  8 19:32:19 2017
From: glennmschultz at me.com (Glenn Schultz)
Date: Sun, 08 Jan 2017 18:32:19 +0000 (GMT)
Subject: [R-pkg-devel] Initialize Method
Message-ID: <78c19f38-0018-4220-973c-adb631cbcf1a@me.com>

All,

My package is S4 an I would like to strongly type the input to the constructor function. ?I understand from reading help etc that the call to new should be in a function and the method initialize is only used when one would like to customize the call to new or when the inputs are different from the slots.

I cannot seem to get the method initialize to work. ?Below is a minimal example. ?My class works, my getter works, my constructor function works but I cannot get the initialize to strongly type the inputs. ?Any help to understand this would be greatly appreciated

Best,
Glenn

setClass("TestClass",
slots = c(
FirstNum = "numeric",
SeconNum = "numeric",
))

setGeneric("FirstNum", function(object)
standardGeneric("FirstNum"))

setMethod("FirstNum", signature("TestClass"),
function(object){object at FirstNum})

TestClass <- function(data1, data2, data3){
FirstNum = data1 * data2
SeconNum = data1/data2 * data3
new("TestClass",
FirstNum = FirstNum,
SeconNum = SeconNum)
}

setMethod("initialize", "TestClass",
"Can I use initialize to type the inputs data1, data2, and data3.
If the function TestClass does heavy lifting can I use TestClass in
the method initialize ? ?If so, how?"
})?


From georgi.boshnakov at manchester.ac.uk  Sun Jan  8 20:39:08 2017
From: georgi.boshnakov at manchester.ac.uk (Georgi Boshnakov)
Date: Sun, 8 Jan 2017 19:39:08 +0000
Subject: [R-pkg-devel] Initialize Method
In-Reply-To: <78c19f38-0018-4220-973c-adb631cbcf1a@me.com>
References: <78c19f38-0018-4220-973c-adb631cbcf1a@me.com>
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E018B01E0D1@MBXP01.ds.man.ac.uk>

Hi,

The short answer is that initialize() dispatches only on its first argument  but the required effect can be achieved in a number of ways:

(1) Write a method for initialize() and put suitable checks  at its  start, e.g. if(!is(data1, "numeric"), stop()) .
Sometimes you may wish to say  ' data1 <- as(data1, "numeric")' for greater flexibility. Note that if you simply assign the argument to a slot, R will raise an error if the value is not suitable anyway. Package "methods" provides a lot of power here, see the documentation as to how to use   callNextMethod(), for example, if your needs are complicated.

 
(2) Declare your constructor as a generic function and write as many methods as you need. Each of these methods will do some preparatory work and call new("TestClass",...) to create the objects. Your  constructor may have any name, although a user-friendly convention is for it to have the name of the class. Note that in your example:

setMethod("initialize", "TestClass", ... })

"TestClass" is the name of the class, not the function TestClass() that you created. 

You can do both: write a method for initialize() which is invoked whenever new("TestClass", ...) is called and also write a constructor TestClass() for users' convenience.  In my experience it is best to keep methods for initialize() relatively simple and do "heavy lifting" in a separate constructor. 

Note that in any case it is a good idea to take care that your method for initialize() does not invalidate calls to new() without further arguments, e.g. new("TestClass"). 

Cheers,
Georgi

-----Original Message-----
From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On Behalf Of Glenn Schultz
Sent: 08 January 2017 18:32
To: R Package Development
Subject: [R-pkg-devel] Initialize Method

All,

My package is S4 an I would like to strongly type the input to the constructor function. ?I understand from reading help etc that the call to new should be in a function and the method initialize is only used when one would like to customize the call to new or when the inputs are different from the slots.

I cannot seem to get the method initialize to work. ?Below is a minimal example. ?My class works, my getter works, my constructor function works but I cannot get the initialize to strongly type the inputs. ?Any help to understand this would be greatly appreciated

Best,
Glenn

setClass("TestClass",
slots = c(
FirstNum = "numeric",
SeconNum = "numeric",
))

setGeneric("FirstNum", function(object)
standardGeneric("FirstNum"))

setMethod("FirstNum", signature("TestClass"),
function(object){object at FirstNum})

TestClass <- function(data1, data2, data3){ FirstNum = data1 * data2 SeconNum = data1/data2 * data3 new("TestClass", FirstNum = FirstNum, SeconNum = SeconNum) }

setMethod("initialize", "TestClass",
"Can I use initialize to type the inputs data1, data2, and data3.
If the function TestClass does heavy lifting can I use TestClass in the method initialize ? ?If so, how?"
})?

______________________________________________
R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel

From analekta at gmail.com  Tue Jan 10 11:55:02 2017
From: analekta at gmail.com (Costas Tsirogiannis)
Date: Tue, 10 Jan 2017 11:55:02 +0100
Subject: [R-pkg-devel] Weird MAKEFLAGS bug
Message-ID: <CAEBhQo0j72AfZA6xbOkfjDFb5udJ6Bc6wZy1_gvxCk_w8-Q1oQ@mail.gmail.com>

Greetings and thanks for previously offered solutions,

I am developing a package that makes use of C++ code, and I want to compile
this code for testing reasons with the "R CMD SHLIB" command. Using Ubuntu
and gcc 5.4, and because for certain reasons I have to use the c++0x
standard, I try the following command:

> MAKEFLAGS='CXXFLAGS=-std=c++0x -lpthread -O2' R CMD SHLIB MyMainCode.cpp

For some weird reason, flag -O2 is not recognized properly and I get the
following error message:

> make: *** unknown output-sync type '2'.  Stop.

If I try -O3, I get "unknown output-sync type '3' ", and so on. Everything
works fine if I drop this optimization flag. Could you suggest a workaround
for that?

thanks in advance,

--Constantinos

	[[alternative HTML version deleted]]


From edd at debian.org  Tue Jan 10 12:39:32 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 10 Jan 2017 05:39:32 -0600
Subject: [R-pkg-devel] Weird MAKEFLAGS bug
In-Reply-To: <CAEBhQo0j72AfZA6xbOkfjDFb5udJ6Bc6wZy1_gvxCk_w8-Q1oQ@mail.gmail.com>
References: <CAEBhQo0j72AfZA6xbOkfjDFb5udJ6Bc6wZy1_gvxCk_w8-Q1oQ@mail.gmail.com>
Message-ID: <22644.51188.310621.857723@max.nulle.part>


On 10 January 2017 at 11:55, Costas Tsirogiannis wrote:
| Greetings and thanks for previously offered solutions,
| 
| I am developing a package that makes use of C++ code, and I want to compile
| this code for testing reasons with the "R CMD SHLIB" command. Using Ubuntu
| and gcc 5.4, and because for certain reasons I have to use the c++0x
| standard, I try the following command:
| 
| > MAKEFLAGS='CXXFLAGS=-std=c++0x -lpthread -O2' R CMD SHLIB MyMainCode.cpp
| 
| For some weird reason, flag -O2 is not recognized properly and I get the
| following error message:
| 
| > make: *** unknown output-sync type '2'.  Stop.
| 
| If I try -O3, I get "unknown output-sync type '3' ", and so on. Everything
| works fine if I drop this optimization flag. Could you suggest a workaround
| for that?

Sounds weird. Wonder if something else could go on here.

But in general, using ~/.R/Makevars is better.  Try that.

edd at max:~$ grep FLAGS ~/.R/Makevars | grep -v "^#"
CFLAGS +=              -O3 -Wall -pipe -pedantic -std=gnu99 
CXXFLAGS +=           -O3 -Wall -pipe -Wno-unused -pedantic 
FFLAGS += -O3 -g0 -Wall -pipe
FCFLAGS += -O3 -g0 -Wall -pipe
CXX1XFLAGS=-O3 -Wall -pipe -Wno-unused -pedantic 
FLAGS=-Wall -O3
DYLIB_LDFLAGS = -Wl,-S -shared -fopenmp# $(CFLAGS) $(CPICFLAGS)
SHLIB_CXXLDFLAGS = -Wl,-S -shared
SHLIB_CXX1XLDFLAGS = -Wl,-S -shared
SHLIB_FCLDFLAGS = -Wl,-S -shared
SHLIB_LDFLAGS = -Wl,-S -shared# $(CFLAGS) $(CPICFLAGS)
edd at max:~$ 

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From analekta at gmail.com  Tue Jan 10 21:39:35 2017
From: analekta at gmail.com (Costas Tsirogiannis)
Date: Tue, 10 Jan 2017 21:39:35 +0100
Subject: [R-pkg-devel] Weird MAKEFLAGS bug
In-Reply-To: <22644.51188.310621.857723@max.nulle.part>
References: <CAEBhQo0j72AfZA6xbOkfjDFb5udJ6Bc6wZy1_gvxCk_w8-Q1oQ@mail.gmail.com>
	<22644.51188.310621.857723@max.nulle.part>
Message-ID: <CAEBhQo3pJEDGkZKucn31adfpivHOTNuKwTvNvKXNLTAMOq86Bw@mail.gmail.com>

Thanks a lot, indeed it worked using the Makevars file. I still do not
understand why the command-line input fails but so be it.

One more quick question: if I include the Makevars file in my package code
then the requested flags are used every time somebody installs my package
in his system. However, -O2 is a gcc-specific flag so it won't work for
every compiler. Is there a simple way to declare another optimization flag
in Makevars, that works for all compilers?

Thanks for all the help,

--Constantinos

On 10 January 2017 at 12:39, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 10 January 2017 at 11:55, Costas Tsirogiannis wrote:
> | Greetings and thanks for previously offered solutions,
> |
> | I am developing a package that makes use of C++ code, and I want to
> compile
> | this code for testing reasons with the "R CMD SHLIB" command. Using
> Ubuntu
> | and gcc 5.4, and because for certain reasons I have to use the c++0x
> | standard, I try the following command:
> |
> | > MAKEFLAGS='CXXFLAGS=-std=c++0x -lpthread -O2' R CMD SHLIB
> MyMainCode.cpp
> |
> | For some weird reason, flag -O2 is not recognized properly and I get the
> | following error message:
> |
> | > make: *** unknown output-sync type '2'.  Stop.
> |
> | If I try -O3, I get "unknown output-sync type '3' ", and so on.
> Everything
> | works fine if I drop this optimization flag. Could you suggest a
> workaround
> | for that?
>
> Sounds weird. Wonder if something else could go on here.
>
> But in general, using ~/.R/Makevars is better.  Try that.
>
> edd at max:~$ grep FLAGS ~/.R/Makevars | grep -v "^#"
> CFLAGS +=              -O3 -Wall -pipe -pedantic -std=gnu99
> CXXFLAGS +=           -O3 -Wall -pipe -Wno-unused -pedantic
> FFLAGS += -O3 -g0 -Wall -pipe
> FCFLAGS += -O3 -g0 -Wall -pipe
> CXX1XFLAGS=-O3 -Wall -pipe -Wno-unused -pedantic
> FLAGS=-Wall -O3
> DYLIB_LDFLAGS = -Wl,-S -shared -fopenmp# $(CFLAGS) $(CPICFLAGS)
> SHLIB_CXXLDFLAGS = -Wl,-S -shared
> SHLIB_CXX1XLDFLAGS = -Wl,-S -shared
> SHLIB_FCLDFLAGS = -Wl,-S -shared
> SHLIB_LDFLAGS = -Wl,-S -shared# $(CFLAGS) $(CPICFLAGS)
> edd at max:~$
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From wdunlap at tibco.com  Tue Jan 10 22:37:06 2017
From: wdunlap at tibco.com (William Dunlap)
Date: Tue, 10 Jan 2017 13:37:06 -0800
Subject: [R-pkg-devel] Weird MAKEFLAGS bug
In-Reply-To: <CAEBhQo3pJEDGkZKucn31adfpivHOTNuKwTvNvKXNLTAMOq86Bw@mail.gmail.com>
References: <CAEBhQo0j72AfZA6xbOkfjDFb5udJ6Bc6wZy1_gvxCk_w8-Q1oQ@mail.gmail.com>
	<22644.51188.310621.857723@max.nulle.part>
	<CAEBhQo3pJEDGkZKucn31adfpivHOTNuKwTvNvKXNLTAMOq86Bw@mail.gmail.com>
Message-ID: <CAF8bMcYJ2oevR3HLYXWzEZaT7hE07ASzWHCtGn5kqiYkTsEujQ@mail.gmail.com>

    MAKEFLAGS='CXXFLAGS=-std=c++0x -O2' R CMD SHLIB

passes two items, 'CXXFLAGS=-std=c++0x' and '-O2', not the single item
'CXXFLAG=-std=c++0x -O2', to make.  Suitably recent versions of GNU
make take the make argument -O2 to control the 'output-sync'.
Bill Dunlap
TIBCO Software
wdunlap tibco.com


On Tue, Jan 10, 2017 at 12:39 PM, Costas Tsirogiannis
<analekta at gmail.com> wrote:
> Thanks a lot, indeed it worked using the Makevars file. I still do not
> understand why the command-line input fails but so be it.
>
> One more quick question: if I include the Makevars file in my package code
> then the requested flags are used every time somebody installs my package
> in his system. However, -O2 is a gcc-specific flag so it won't work for
> every compiler. Is there a simple way to declare another optimization flag
> in Makevars, that works for all compilers?
>
> Thanks for all the help,
>
> --Constantinos
>
> On 10 January 2017 at 12:39, Dirk Eddelbuettel <edd at debian.org> wrote:
>
>>
>> On 10 January 2017 at 11:55, Costas Tsirogiannis wrote:
>> | Greetings and thanks for previously offered solutions,
>> |
>> | I am developing a package that makes use of C++ code, and I want to
>> compile
>> | this code for testing reasons with the "R CMD SHLIB" command. Using
>> Ubuntu
>> | and gcc 5.4, and because for certain reasons I have to use the c++0x
>> | standard, I try the following command:
>> |
>> | > MAKEFLAGS='CXXFLAGS=-std=c++0x -lpthread -O2' R CMD SHLIB
>> MyMainCode.cpp
>> |
>> | For some weird reason, flag -O2 is not recognized properly and I get the
>> | following error message:
>> |
>> | > make: *** unknown output-sync type '2'.  Stop.
>> |
>> | If I try -O3, I get "unknown output-sync type '3' ", and so on.
>> Everything
>> | works fine if I drop this optimization flag. Could you suggest a
>> workaround
>> | for that?
>>
>> Sounds weird. Wonder if something else could go on here.
>>
>> But in general, using ~/.R/Makevars is better.  Try that.
>>
>> edd at max:~$ grep FLAGS ~/.R/Makevars | grep -v "^#"
>> CFLAGS +=              -O3 -Wall -pipe -pedantic -std=gnu99
>> CXXFLAGS +=           -O3 -Wall -pipe -Wno-unused -pedantic
>> FFLAGS += -O3 -g0 -Wall -pipe
>> FCFLAGS += -O3 -g0 -Wall -pipe
>> CXX1XFLAGS=-O3 -Wall -pipe -Wno-unused -pedantic
>> FLAGS=-Wall -O3
>> DYLIB_LDFLAGS = -Wl,-S -shared -fopenmp# $(CFLAGS) $(CPICFLAGS)
>> SHLIB_CXXLDFLAGS = -Wl,-S -shared
>> SHLIB_CXX1XLDFLAGS = -Wl,-S -shared
>> SHLIB_FCLDFLAGS = -Wl,-S -shared
>> SHLIB_LDFLAGS = -Wl,-S -shared# $(CFLAGS) $(CPICFLAGS)
>> edd at max:~$
>>
>> Dirk
>>
>> --
>> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From kasperdanielhansen at gmail.com  Wed Jan 11 16:03:03 2017
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Wed, 11 Jan 2017 10:03:03 -0500
Subject: [R-pkg-devel] Weird MAKEFLAGS bug
In-Reply-To: <CAEBhQo3pJEDGkZKucn31adfpivHOTNuKwTvNvKXNLTAMOq86Bw@mail.gmail.com>
References: <CAEBhQo0j72AfZA6xbOkfjDFb5udJ6Bc6wZy1_gvxCk_w8-Q1oQ@mail.gmail.com>
	<22644.51188.310621.857723@max.nulle.part>
	<CAEBhQo3pJEDGkZKucn31adfpivHOTNuKwTvNvKXNLTAMOq86Bw@mail.gmail.com>
Message-ID: <CAC2h7uvwNfz9QZrMsUEcEJ-E-wcy67vN8VLYTMLb5SkpJraUwQ@mail.gmail.com>

For a package, you should not mess with the optimization flag unless you
are disabling high optimization because it produces wrong code.  If people
want to use higher optimization flags, they'll compile with higher flags.

On Tue, Jan 10, 2017 at 3:39 PM, Costas Tsirogiannis <analekta at gmail.com>
wrote:

> Thanks a lot, indeed it worked using the Makevars file. I still do not
> understand why the command-line input fails but so be it.
>
> One more quick question: if I include the Makevars file in my package code
> then the requested flags are used every time somebody installs my package
> in his system. However, -O2 is a gcc-specific flag so it won't work for
> every compiler. Is there a simple way to declare another optimization flag
> in Makevars, that works for all compilers?
>
> Thanks for all the help,
>
> --Constantinos
>
> On 10 January 2017 at 12:39, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> >
> > On 10 January 2017 at 11:55, Costas Tsirogiannis wrote:
> > | Greetings and thanks for previously offered solutions,
> > |
> > | I am developing a package that makes use of C++ code, and I want to
> > compile
> > | this code for testing reasons with the "R CMD SHLIB" command. Using
> > Ubuntu
> > | and gcc 5.4, and because for certain reasons I have to use the c++0x
> > | standard, I try the following command:
> > |
> > | > MAKEFLAGS='CXXFLAGS=-std=c++0x -lpthread -O2' R CMD SHLIB
> > MyMainCode.cpp
> > |
> > | For some weird reason, flag -O2 is not recognized properly and I get
> the
> > | following error message:
> > |
> > | > make: *** unknown output-sync type '2'.  Stop.
> > |
> > | If I try -O3, I get "unknown output-sync type '3' ", and so on.
> > Everything
> > | works fine if I drop this optimization flag. Could you suggest a
> > workaround
> > | for that?
> >
> > Sounds weird. Wonder if something else could go on here.
> >
> > But in general, using ~/.R/Makevars is better.  Try that.
> >
> > edd at max:~$ grep FLAGS ~/.R/Makevars | grep -v "^#"
> > CFLAGS +=              -O3 -Wall -pipe -pedantic -std=gnu99
> > CXXFLAGS +=           -O3 -Wall -pipe -Wno-unused -pedantic
> > FFLAGS += -O3 -g0 -Wall -pipe
> > FCFLAGS += -O3 -g0 -Wall -pipe
> > CXX1XFLAGS=-O3 -Wall -pipe -Wno-unused -pedantic
> > FLAGS=-Wall -O3
> > DYLIB_LDFLAGS = -Wl,-S -shared -fopenmp# $(CFLAGS) $(CPICFLAGS)
> > SHLIB_CXXLDFLAGS = -Wl,-S -shared
> > SHLIB_CXX1XLDFLAGS = -Wl,-S -shared
> > SHLIB_FCLDFLAGS = -Wl,-S -shared
> > SHLIB_LDFLAGS = -Wl,-S -shared# $(CFLAGS) $(CPICFLAGS)
> > edd at max:~$
> >
> > Dirk
> >
> > --
> > http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From profjcnash at gmail.com  Mon Jan 16 15:57:26 2017
From: profjcnash at gmail.com (ProfJCNash)
Date: Mon, 16 Jan 2017 09:57:26 -0500
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of R packages.
Message-ID: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>

Navigating the Jungle of R Packages

The R ecosystem has many packages in various collections,
especially CRAN, Bioconductor, and GitHub. While this
richness of choice speaks to the popularity and
importance of R, the large number of contributed packages
makes it difficult for users to find appropriate tools for
their work.

A session on this subject has been approved for UseR! in
Brussels. The tentative structure is three short
introductory presentations, followed by discussion or
planning work to improve the tools available to help
users find the best R package and function for their needs.

The currently proposed topics are

- wrapper packages that allow diverse tools that perform
  similar functions to be accessed by unified calls

- collaborative mechanisms to create and update Task Views

- search and sort tools to find packages.

At the time of writing we have tentative presenters for
the topics, but welcome others. We hope these presentations
at useR! 2017 will be part of a larger discussion that will
contribute to an increased team effort after the conference
to improve the the support for R users in these areas.


John Nash, Julia Silge, Spencer Graves


From maechler at stat.math.ethz.ch  Mon Jan 16 16:01:47 2017
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 16 Jan 2017 16:01:47 +0100
Subject: [R-pkg-devel] multiple bibentry()s in CITATION
In-Reply-To: <ACD1644AA6C67E4FBD0C350625508EC836572E5C@FHSDB2D11-2.csu.mcmaster.ca>
References: <ACD1644AA6C67E4FBD0C350625508EC836572E5C@FHSDB2D11-2.csu.mcmaster.ca>
Message-ID: <22652.57435.512098.137246@stat.math.ethz.ch>

>>>>> Fox, John <jfox at mcmaster.ca>
>>>>>     on Fri, 2 Sep 2016 15:42:46 +0000 writes:

(which is more than 4 months ago)

    > Dear list members,
    > I've noticed that citation(package="pkg") generates both a text citation and a BiBTeX entry when the CITATION file contains a single call to bibentry() or citEntry(), but that only text citations are shown if there are multiple calls to bibentry() or citEntry(). 

    > Is this behaviour intentional? In my opinion, it's useful always to show the BiBTeX (although it's available through toBibtex(citation(package="pkg")) ).

    > The Writing R Extensions manual says, "A CITATION file will contain *calls* [my emphasis] to function bibentry."

    > Thanks,
    > John

and you did not get a reply....
I had wanted but forgotten about it ... two parts :

1)  On November 24, 2012,  I had improved R with an option to get this
    so this has been a "hidden gem" ;-) for a while in R:

> options(citation.bibtex.max = Inf)
> citation(package = "Rcmdr")

To cite the 'Rcmdr' package in publications use:

  Fox, J., and Bouchet-Valat, M. (2017). Rcmdr: R Commander. R package version 2.3-2.

A BibTeX entry for LaTeX users is

  @Manual{,
    title = {{Rcmdr: R Commander}},
    author = {John Fox and Milan Bouchet-Valat},
    year = {2017},
    note = {R package version 2.3-2},
    url = {http://socserv.socsci.mcmaster.ca/jfox/Misc/Rcmdr/},
  }

  Fox, J. (2017). Using the R Commander: A Point-and-Click Interface or R. Boca Raton FL:
  Chapman and Hall/CRC Press.

A BibTeX entry for LaTeX users is

  @Book{,
    title = {Using the {R Commander}: A Point-and-Click Interface for {R}},
    author = {John Fox},
    year = {2017},
    publisher = {Chapman and Hall/CRC Press},
    address = {Boca Raton {FL}},
    url = {http://socserv.mcmaster.ca/jfox/Books/RCommander/},
  }

  Fox, J. (2005). The R Commander: A Basic Statistics Graphical User Interface to R.
  Journal of Statistical Software, 14(9): 1--42.

A BibTeX entry for LaTeX users is

  @Article{,
    title = {The {R} {C}ommander: A Basic Statistics Graphical User Interface to {R}},
    author = {John Fox},
    year = {2005},
    journal = {Journal of Statistical Software},
    volume = {14},
    number = {9},
    pages = {1--42},
    url = {http://www.jstatsoft.org/v14/i09},
  }

>
----------------

This all works "obviously" (;-) via utils:::format.bibentry ()
and even when I had made the number one an argument to that
function with a default you can set via options(),  I had
wondered a bit  why the cutoff should by default be at one.

E.g., it looks strange that by *adding* a 2nd reference, you get
shorter citation output.... and to me it would seem more coherent
to have the default rather be 'Inf' instead of '1',  i.e. always
showing both text and bibtex.

There is quite a difference though: For our copula package, e.g.,

> options(citation.bibtex.max = 1); citation(package = "copula")

To cite the R package copula in publications use:

  Marius Hofert, Ivan Kojadinovic, Martin Maechler and Jun Yan (2017). copula:
  Multivariate Dependence with Copulas. R package version 0.999-16 URL
  https://CRAN.R-project.org/package=copula

  Jun Yan (2007). Enjoy the Joy of Copulas: With a Package copula. Journal of Statistical
  Software, 21(4), 1-21. URLhttp://www.jstatsoft.org/v21/i04/.

  Ivan Kojadinovic, Jun Yan (2010). Modeling Multivariate Distributions with Continuous
  Margins Using the copula R Package. Journal of Statistical Software, 34(9), 1-20. URL
  http://www.jstatsoft.org/v34/i09/.

  Marius Hofert, Martin Maechler (2011). Nested Archimedean Copulas Meet R: The nacopula
  Package. Journal of Statistical Software, 39(9), 1-20. URL
  http://www.jstatsoft.org/v39/i09/.

>

This is relatively compact (18 lines)
whereas it gives  67 lines of output when the option is set to
something >= 4.

Other opinions?
What do you think, would it be worth the compatibility break to
change the default from '1' to 'Inf' ?

Best regards,
Martin


From jfox at mcmaster.ca  Mon Jan 16 16:44:05 2017
From: jfox at mcmaster.ca (Fox, John)
Date: Mon, 16 Jan 2017 15:44:05 +0000
Subject: [R-pkg-devel] multiple bibentry()s in CITATION
In-Reply-To: <22652.57435.512098.137246@stat.math.ethz.ch>
References: <ACD1644AA6C67E4FBD0C350625508EC836572E5C@FHSDB2D11-2.csu.mcmaster.ca>
	<22652.57435.512098.137246@stat.math.ethz.ch>
Message-ID: <ACD1644AA6C67E4FBD0C350625508EC8365C289F@FHSDB2D11-2.csu.mcmaster.ca>

Dear Martin,

Thanks for addressing this question, if belatedly!

After a little bit of thought, perhaps a default somewhere between 1 and Inf makes sense, along with an additional argument to citation: citation(package="pkg", bibtex.max=n), with default bibtex.max= getOption("citation.bibtex.max"), where the citation.bibtex.max option is initially set to something like 4. If the number of available citations exceeds bibtex.max, then a message like "there are additional BiBTeX citations, enter 'citation(package="pkg", bibtex.max=Inf)' to see all of them."

Best,
 John

> -----Original Message-----
> From: Martin Maechler [mailto:maechler at stat.math.ethz.ch]
> Sent: Monday, January 16, 2017 10:02 AM
> To: Fox, John <jfox at mcmaster.ca>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] multiple bibentry()s in CITATION
> 
> >>>>> Fox, John <jfox at mcmaster.ca>
> >>>>>     on Fri, 2 Sep 2016 15:42:46 +0000 writes:
> 
> (which is more than 4 months ago)
> 
>     > Dear list members,
>     > I've noticed that citation(package="pkg") generates both a text
> citation and a BiBTeX entry when the CITATION file contains a single
> call to bibentry() or citEntry(), but that only text citations are shown
> if there are multiple calls to bibentry() or citEntry().
> 
>     > Is this behaviour intentional? In my opinion, it's useful always
> to show the BiBTeX (although it's available through
> toBibtex(citation(package="pkg")) ).
> 
>     > The Writing R Extensions manual says, "A CITATION file will
> contain *calls* [my emphasis] to function bibentry."
> 
>     > Thanks,
>     > John
> 
> and you did not get a reply....
> I had wanted but forgotten about it ... two parts :
> 
> 1)  On November 24, 2012,  I had improved R with an option to get this
>     so this has been a "hidden gem" ;-) for a while in R:
> 
> > options(citation.bibtex.max = Inf)
> > citation(package = "Rcmdr")
> 
> To cite the 'Rcmdr' package in publications use:
> 
>   Fox, J., and Bouchet-Valat, M. (2017). Rcmdr: R Commander. R package
> version 2.3-2.
> 
> A BibTeX entry for LaTeX users is
> 
>   @Manual{,
>     title = {{Rcmdr: R Commander}},
>     author = {John Fox and Milan Bouchet-Valat},
>     year = {2017},
>     note = {R package version 2.3-2},
>     url = {http://socserv.socsci.mcmaster.ca/jfox/Misc/Rcmdr/},
>   }
> 
>   Fox, J. (2017). Using the R Commander: A Point-and-Click Interface or
> R. Boca Raton FL:
>   Chapman and Hall/CRC Press.
> 
> A BibTeX entry for LaTeX users is
> 
>   @Book{,
>     title = {Using the {R Commander}: A Point-and-Click Interface for
> {R}},
>     author = {John Fox},
>     year = {2017},
>     publisher = {Chapman and Hall/CRC Press},
>     address = {Boca Raton {FL}},
>     url = {http://socserv.mcmaster.ca/jfox/Books/RCommander/},
>   }
> 
>   Fox, J. (2005). The R Commander: A Basic Statistics Graphical User
> Interface to R.
>   Journal of Statistical Software, 14(9): 1--42.
> 
> A BibTeX entry for LaTeX users is
> 
>   @Article{,
>     title = {The {R} {C}ommander: A Basic Statistics Graphical User
> Interface to {R}},
>     author = {John Fox},
>     year = {2005},
>     journal = {Journal of Statistical Software},
>     volume = {14},
>     number = {9},
>     pages = {1--42},
>     url = {http://www.jstatsoft.org/v14/i09},
>   }
> 
> >
> ----------------
> 
> This all works "obviously" (;-) via utils:::format.bibentry () and even
> when I had made the number one an argument to that function with a
> default you can set via options(),  I had wondered a bit  why the cutoff
> should by default be at one.
> 
> E.g., it looks strange that by *adding* a 2nd reference, you get shorter
> citation output.... and to me it would seem more coherent to have the
> default rather be 'Inf' instead of '1',  i.e. always showing both text
> and bibtex.
> 
> There is quite a difference though: For our copula package, e.g.,
> 
> > options(citation.bibtex.max = 1); citation(package = "copula")
> 
> To cite the R package copula in publications use:
> 
>   Marius Hofert, Ivan Kojadinovic, Martin Maechler and Jun Yan (2017).
> copula:
>   Multivariate Dependence with Copulas. R package version 0.999-16 URL
>   https://CRAN.R-project.org/package=copula
> 
>   Jun Yan (2007). Enjoy the Joy of Copulas: With a Package copula.
> Journal of Statistical
>   Software, 21(4), 1-21. URLhttp://www.jstatsoft.org/v21/i04/.
> 
>   Ivan Kojadinovic, Jun Yan (2010). Modeling Multivariate Distributions
> with Continuous
>   Margins Using the copula R Package. Journal of Statistical Software,
> 34(9), 1-20. URL
>   http://www.jstatsoft.org/v34/i09/.
> 
>   Marius Hofert, Martin Maechler (2011). Nested Archimedean Copulas Meet
> R: The nacopula
>   Package. Journal of Statistical Software, 39(9), 1-20. URL
>   http://www.jstatsoft.org/v39/i09/.
> 
> >
> 
> This is relatively compact (18 lines)
> whereas it gives  67 lines of output when the option is set to something
> >= 4.
> 
> Other opinions?
> What do you think, would it be worth the compatibility break to change
> the default from '1' to 'Inf' ?
> 
> Best regards,
> Martin


From annu.mcs.du.2015 at gmail.com  Tue Jan 17 12:45:45 2017
From: annu.mcs.du.2015 at gmail.com (Annu Joshi)
Date: Tue, 17 Jan 2017 17:15:45 +0530
Subject: [R-pkg-devel] Creating a new package dependent on Igraph
Message-ID: <CACD0KfPbxMC6NLEBH4PH3hfDpVrV2YXpt1dZSncPr4oDyy-22A@mail.gmail.com>

Hello all,
I have implemented few graph decomposition algorithm for R using Igraph's C
API. I would like to know how can I resolve the dependencies on igraph
while creating my own package.

Thanks
Annu Joshi

	[[alternative HTML version deleted]]


From r at catwhisker.org  Wed Jan 18 01:05:16 2017
From: r at catwhisker.org (David Wolfskill)
Date: Tue, 17 Jan 2017 16:05:16 -0800
Subject: [R-pkg-devel] Problem compiling openssl package (FreeBSD stable/11)
Message-ID: <20170118000516.GA33566@albert.catwhisker.org>

I tried to install the RPresto package, which depends on the openssl
package; the latter failed to build:

...
** testing if installed package can be loaded
* DONE (curl)
* installing *source* package ?openssl? ...
** package ?openssl? successfully unpacked and MD5 sums checked
Using PKG_CFLAGS=
Using PKG_LIBS=-lssl -lcrypto
** libs
rm -f aes.o base64.o bignum.o cert.o compatibility.o diffie.o envelope.o error.o hash.o info.o keygen.o keys.o onload.o openssh.o password.o pem.o pkcs12.o pkcs7.o rand.o rsa.o signing.o ssl.o stream.o write.o openssl.so
gcc49 -std=gnu99 -I/usr/local/lib/R/include -DNDEBUG  -DLIBICONV_PLUG -I/usr/local/include -isystem /usr/local/include    -fpic  -O2 -pipe  -DLIBICONV_PLUG -fstack-protector -Wl,-rpath=/usr/local/lib/gcc49 -isystem /usr/local/include -fno-strict-aliasing -flto -c aes.c -o aes.o
gcc49 -std=gnu99 -I/usr/local/lib/R/include -DNDEBUG  -DLIBICONV_PLUG -I/usr/local/include -isystem /usr/local/include    -fpic  -O2 -pipe  -DLIBICONV_PLUG -fstack-protector -Wl,-rpath=/usr/local/lib/gcc49 -isystem /usr/local/include -fno-strict-aliasing -flto -c base64.c -o base64.o
...
gcc49 -std=gnu99 -I/usr/local/lib/R/include -DNDEBUG  -DLIBICONV_PLUG -I/usr/local/include -isystem /usr/local/include    -fpic  -O2 -pipe  -DLIBICONV_PLUG -fstack-protector -Wl,-rpath=/usr/local/lib/gcc49 -isystem /usr/local/include -fno-strict-aliasing -flto -c signing.c -o signing.o
gcc49 -std=gnu99 -I/usr/local/lib/R/include -DNDEBUG  -DLIBICONV_PLUG -I/usr/local/include -isystem /usr/local/include    -fpic  -O2 -pipe  -DLIBICONV_PLUG -fstack-protector -Wl,-rpath=/usr/local/lib/gcc49 -isystem /usr/local/include -fno-strict-aliasing -flto -c ssl.c -o ssl.o
ssl.c: In function 'R_download_cert':
ssl.c:41:21: error: 'PF_UNSPEC' undeclared (first use in this function)
   hints.ai_family = PF_UNSPEC;
                     ^
ssl.c:41:21: note: each undeclared identifier is reported only once for each function it appears in
*** Error code 1

Stop.
make: stopped in /tmp/Rtmp8Zo3h3/R.INSTALLa229324f8adb/openssl/src
ERROR: compilation failed for package ?openssl?
* removing ?/local/amd64/local/lib/R/library/openssl?
* installing *source* package ?R6? ...
** package ?R6? successfully unpacked and MD5 sums checked
....


Information about the system (as of today):

g1-252(11.0-S)[6] uname -a
FreeBSD g1-252.catwhisker.org 11.0-STABLE FreeBSD 11.0-STABLE #225  r312339M/312341:1100509: Tue Jan 17 04:23:47 PST 2017     root at g1-252.catwhisker.org:/common/S1/obj/usr/src/sys/CANARY  amd64
g1-252(11.0-S)[7] pkg info math/R | head -2
R-3.3.2_7
Name           : R
g1-252(11.0-S)[8] echo version | openssl
OpenSSL> OpenSSL 1.0.2j-freebsd  26 Sep 2016
OpenSSL> g1-252(11.0-S)[9] 

> R.Version()
$platform
[1] "amd64-portbld-freebsd11.0"

$arch
[1] "amd64"

$os
[1] "freebsd11.0"

$system
[1] "amd64, freebsd11.0"

$status
[1] ""

$major
[1] "3"

$minor
[1] "3.2"

$year
[1] "2016"

$month
[1] "10"

$day
[1] "31"

$`svn rev`
[1] "71607"

$language
[1] "R"

$version.string
[1] "R version 3.3.2 (2016-10-31)"

$nickname
[1] "Sincere Pumpkin Patch"


(I update the OS & installed 3rd-party software daily on this machine.)

How may I help make this work?  (I'm happy to test....)

Thanks!

Peace,
david
-- 
David H. Wolfskill				r at catwhisker.org
How could one possibly "respect" a misogynist, racist, bullying con-man??!?

See http://www.catwhisker.org/~david/publickey.gpg for my public key.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 603 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20170117/562aeaf2/attachment.bin>

From berryboessenkool at hotmail.com  Wed Jan 18 11:31:55 2017
From: berryboessenkool at hotmail.com (Berry Boessenkool)
Date: Wed, 18 Jan 2017 10:31:55 +0000
Subject: [R-pkg-devel] package API change
Message-ID: <DB5PR0401MB19907304E9434D1558B5101FD57F0@DB5PR0401MB1990.eurprd04.prod.outlook.com>


What's good practice to inform users about an API change?


The package in question is extremeStat. Apparently, people actually use it.

I don't have a userbase like Hadley, but I do receive emails with feature requests and code change suggestions.

Since the change is rather big (going from version 0.6.0 to 1.3.0 reflects that), some existing scripts may break.

(functions + arguments renamed/removed/restructured; computing functions don't plot anymore, separate plotting functions now do).


I'm considering a package startup message which would be included for a few months.


What do you think?

Any better options / things to consider?


Thanks ahead,

Berry

https://github.com/brry/extremeStat



	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Wed Jan 18 13:22:29 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 18 Jan 2017 07:22:29 -0500
Subject: [R-pkg-devel] package API change
In-Reply-To: <DB5PR0401MB19907304E9434D1558B5101FD57F0@DB5PR0401MB1990.eurprd04.prod.outlook.com>
References: <DB5PR0401MB19907304E9434D1558B5101FD57F0@DB5PR0401MB1990.eurprd04.prod.outlook.com>
Message-ID: <969fb660-2176-1498-5b5c-c17c172630f5@gmail.com>

On 18/01/2017 5:31 AM, Berry Boessenkool wrote:
>
> What's good practice to inform users about an API change?
>
>
> The package in question is extremeStat. Apparently, people actually use it.
>
> I don't have a userbase like Hadley, but I do receive emails with feature requests and code change suggestions.
>
> Since the change is rather big (going from version 0.6.0 to 1.3.0 reflects that), some existing scripts may break.
>
> (functions + arguments renamed/removed/restructured; computing functions don't plot anymore, separate plotting functions now do).
>
>
> I'm considering a package startup message which would be included for a few months.
>
>
> What do you think?
>
> Any better options / things to consider?

The easiest way for users is if you don't make incompatible changes to 
functions, you just add new functions that have your desired changes in 
them, and tell users that the old versions will eventually go away.  (Or 
just re-implement the old ones using the new ones.)

You can call the .Deprecated() function from the old ones to warn users 
every time they are used.

Duncan Murdoch


From thierry.onkelinx at inbo.be  Wed Jan 18 13:49:03 2017
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Wed, 18 Jan 2017 13:49:03 +0100
Subject: [R-pkg-devel] package API change
In-Reply-To: <969fb660-2176-1498-5b5c-c17c172630f5@gmail.com>
References: <DB5PR0401MB19907304E9434D1558B5101FD57F0@DB5PR0401MB1990.eurprd04.prod.outlook.com>
	<969fb660-2176-1498-5b5c-c17c172630f5@gmail.com>
Message-ID: <CAJuCY5zWZra2-J5+W0e_xf=CvFnwwj2LBfk+ejQETCO=4yh6yA@mail.gmail.com>

Another solution is to start a new package. This is what Hadley did with
the ggplot package (https://cran.r-project.org/src/contrib/Archive/ggplot/).
The new version (ggplot2) would break existing code. Users were informed
that the old package is not longer maintained. So the user has the choice
between using the old version which still works but no longer maintained or
the switched to the new version which is maintained but will break existing
code.

Best regards,

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

2017-01-18 13:22 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:

> On 18/01/2017 5:31 AM, Berry Boessenkool wrote:
>
>>
>> What's good practice to inform users about an API change?
>>
>>
>> The package in question is extremeStat. Apparently, people actually use
>> it.
>>
>> I don't have a userbase like Hadley, but I do receive emails with feature
>> requests and code change suggestions.
>>
>> Since the change is rather big (going from version 0.6.0 to 1.3.0
>> reflects that), some existing scripts may break.
>>
>> (functions + arguments renamed/removed/restructured; computing functions
>> don't plot anymore, separate plotting functions now do).
>>
>>
>> I'm considering a package startup message which would be included for a
>> few months.
>>
>>
>> What do you think?
>>
>> Any better options / things to consider?
>>
>
> The easiest way for users is if you don't make incompatible changes to
> functions, you just add new functions that have your desired changes in
> them, and tell users that the old versions will eventually go away.  (Or
> just re-implement the old ones using the new ones.)
>
> You can call the .Deprecated() function from the old ones to warn users
> every time they are used.
>
> Duncan Murdoch
>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From klh64 at cornell.edu  Wed Jan 18 13:04:12 2017
From: klh64 at cornell.edu (Kate Hartmann)
Date: Wed, 18 Jan 2017 13:04:12 +0100
Subject: [R-pkg-devel] R CMD Check: package dependencies
Message-ID: <CAKseMPXxddbbW5M+fapD3dKJEqnsyUx=6H3qPtRR_RKwoRn6+Q@mail.gmail.com>

Hello:



I am working on uploading my first R package to CRAN and running into a
problem with package dependencies with R CMD check using win-builder (I am
not having this problem on my mac).  I am getting:



?Package required but not available: ?grasp2db??



Best I can tell this is because ?grasp2b? is an ?annotation package? and
although win-builder includes all CRAN packages it only includes
Bioconductor ?software? packages.  One of the functions in my package
requires ?grasp2db? otherwise I would do my best to move it to ?suggests?
rather than ?imports?.



Any advice you might have would be very much appreciated.



Thanks,



Kate

	[[alternative HTML version deleted]]


From edd at debian.org  Wed Jan 18 14:55:53 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 18 Jan 2017 07:55:53 -0600
Subject: [R-pkg-devel] package API change
In-Reply-To: <CAJuCY5zWZra2-J5+W0e_xf=CvFnwwj2LBfk+ejQETCO=4yh6yA@mail.gmail.com>
References: <DB5PR0401MB19907304E9434D1558B5101FD57F0@DB5PR0401MB1990.eurprd04.prod.outlook.com>
	<969fb660-2176-1498-5b5c-c17c172630f5@gmail.com>
	<CAJuCY5zWZra2-J5+W0e_xf=CvFnwwj2LBfk+ejQETCO=4yh6yA@mail.gmail.com>
Message-ID: <22655.29673.645584.11238@max.nulle.part>


On 18 January 2017 at 13:49, Thierry Onkelinx wrote:
| Another solution is to start a new package. This is what Hadley did with
| the ggplot package (https://cran.r-project.org/src/contrib/Archive/ggplot/).
| The new version (ggplot2) would break existing code. Users were informed
| that the old package is not longer maintained. So the user has the choice
| between using the old version which still works but no longer maintained or
| the switched to the new version which is maintained but will break existing
| code.

AFAIK that practice of package inflation is outlawed by CRAN Policy now:

     * Changes to CRAN packages causing significant disruption to other
       packages must be agreed with the CRAN maintainers well in advance of
       any publicity. Introduction of packages providing back-compatibility
       versions of already available packages is not allowed.

R itself has mechanisms for this: .Deprecated was already mentioned.

Many other packages "warn now", phase in new code and then offer a toggle
(maybe via options()) to get the old behaviour.

As package authors, we have a "contract" with our users. Sure, we can break
it willy-nilly (and the informal reputation mechanism may make us pay for
this) or we can try to hold the contract and accomodate.

It's programming.  There is always another layer we can insert.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From ligges at statistik.tu-dortmund.de  Wed Jan 18 16:23:39 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 18 Jan 2017 16:23:39 +0100
Subject: [R-pkg-devel] R CMD Check: package dependencies
In-Reply-To: <CAKseMPXxddbbW5M+fapD3dKJEqnsyUx=6H3qPtRR_RKwoRn6+Q@mail.gmail.com>
References: <CAKseMPXxddbbW5M+fapD3dKJEqnsyUx=6H3qPtRR_RKwoRn6+Q@mail.gmail.com>
Message-ID: <56adb264-0c6f-7646-4b36-ac234b5ae695@statistik.tu-dortmund.de>



On 18.01.2017 13:04, Kate Hartmann wrote:
> Hello:
>
>
>
> I am working on uploading my first R package to CRAN and running into a
> problem with package dependencies with R CMD check using win-builder (I am
> not having this problem on my mac).  I am getting:
>
>
>
> ?Package required but not available: ?grasp2db??
>
>
>
> Best I can tell this is because ?grasp2b? is an ?annotation package? and
> although win-builder includes all CRAN packages it only includes
> Bioconductor ?software? packages.  One of the functions in my package
> requires ?grasp2db? otherwise I would do my best to move it to ?suggests?
> rather than ?imports?.
>
>
>
> Any advice you might have would be very much appreciated.


I think moving it to suggests is a good idea if only a very small part 
of your package needs it. But as it is small in size, I have no problem 
on installing it on winbuilder.

Best,
Uwe Ligges


>
>
> Thanks,
>
>
>
> Kate
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From r at catwhisker.org  Wed Jan 18 20:01:32 2017
From: r at catwhisker.org (David Wolfskill)
Date: Wed, 18 Jan 2017 11:01:32 -0800
Subject: [R-pkg-devel] Problem compiling openssl package (FreeBSD
 stable/11)
In-Reply-To: <20170118000516.GA33566@albert.catwhisker.org>
References: <20170118000516.GA33566@albert.catwhisker.org>
Message-ID: <20170118190132.GL1167@albert.catwhisker.org>

On Tue, Jan 17, 2017 at 04:05:16PM -0800, David Wolfskill wrote:
> [The R "openssl" package didn't build under FreeBSD for me....]
> ...
> gcc49 -std=gnu99 -I/usr/local/lib/R/include -DNDEBUG  -DLIBICONV_PLUG -I/usr/local/include -isystem /usr/local/include    -fpic  -O2 -pipe  -DLIBICONV_PLUG -fstack-protector -Wl,-rpath=/usr/local/lib/gcc49 -isystem /usr/local/include -fno-strict-aliasing -flto -c ssl.c -o ssl.o
> ssl.c: In function 'R_download_cert':
> ssl.c:41:21: error: 'PF_UNSPEC' undeclared (first use in this function)
>    hints.ai_family = PF_UNSPEC;
>                      ^
> ssl.c:41:21: note: each undeclared identifier is reported only once for each function it appears in
> *** Error code 1
> ....

It turns out that in FreeBSD (possibly also in other BSD-derived
environments), PF_UNSPEC is defined (in /usr/include/sys/socket.h), but
only if "__BSD_VISIBLE" is true:

g1-252(11.0-S)[3] grep -nwC 6 PF_UNSPEC /usr/include/sys/socket.h
323-#include <sys/_sockaddr_storage.h>
324-
325-#if __BSD_VISIBLE
326-/*
327- * Protocol families, same as address families for now.
328- */
329:#define     PF_UNSPEC       AF_UNSPEC
330-#define     PF_LOCAL        AF_LOCAL
331-#define     PF_UNIX         PF_LOCAL        /* backward compatibility */
332-#define     PF_INET         AF_INET
333-#define     PF_IMPLINK      AF_IMPLINK
334-#define     PF_PUP          AF_PUP
335-#define     PF_CHAOS        AF_CHAOS
g1-252(11.0-S)[4] 


And while PF_UNSPEC is referenced in the sources for the R openssl
package, __BSD_VISIBLE is not:

g1-252(11.0-S)[33] dirs
~/R/Rtmp4VjFtY/dhw/openssl 
g1-252(11.0-S)[34] grep -nrw PF_UNSPEC .
./src/ssl.c:41:  hints.ai_family = PF_UNSPEC;
g1-252(11.0-S)[35] grep -nrw __BSD_VISIBLE .
g1-252(11.0-S)[36] 


And it appears that the local sources are ephemeral, so I can't
readily patch those sources to see if I can get it to work (as the
patched sources wouldn't be used) -- unless I miss the mark....

Any suggestions for how I might proceed?

Thanks!

Peace,
david
-- 
David H. Wolfskill				r at catwhisker.org
How could one possibly "respect" a misogynist, racist, bullying con-man??!?

See http://www.catwhisker.org/~david/publickey.gpg for my public key.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 603 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20170118/055707aa/attachment.bin>

From edd at debian.org  Wed Jan 18 20:27:24 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 18 Jan 2017 13:27:24 -0600
Subject: [R-pkg-devel] Problem compiling openssl package (FreeBSD
 stable/11)
In-Reply-To: <20170118190132.GL1167@albert.catwhisker.org>
References: <20170118000516.GA33566@albert.catwhisker.org>
	<20170118190132.GL1167@albert.catwhisker.org>
Message-ID: <22655.49564.761468.759011@max.nulle.part>


On 18 January 2017 at 11:01, David Wolfskill wrote:
| On Tue, Jan 17, 2017 at 04:05:16PM -0800, David Wolfskill wrote:
| > [The R "openssl" package didn't build under FreeBSD for me....]
| > ...
| > gcc49 -std=gnu99 -I/usr/local/lib/R/include -DNDEBUG  -DLIBICONV_PLUG -I/usr/local/include -isystem /usr/local/include    -fpic  -O2 -pipe  -DLIBICONV_PLUG -fstack-protector -Wl,-rpath=/usr/local/lib/gcc49 -isystem /usr/local/include -fno-strict-aliasing -flto -c ssl.c -o ssl.o
| > ssl.c: In function 'R_download_cert':
| > ssl.c:41:21: error: 'PF_UNSPEC' undeclared (first use in this function)
| >    hints.ai_family = PF_UNSPEC;
| >                      ^
| > ssl.c:41:21: note: each undeclared identifier is reported only once for each function it appears in
| > *** Error code 1
| > ....
| 
| It turns out that in FreeBSD (possibly also in other BSD-derived
| environments), PF_UNSPEC is defined (in /usr/include/sys/socket.h), but
| only if "__BSD_VISIBLE" is true:

[good detective work omitted]

| And it appears that the local sources are ephemeral, so I can't
| readily patch those sources to see if I can get it to work (as the
| patched sources wouldn't be used) -- unless I miss the mark....
| 
| Any suggestions for how I might proceed?

I don't follow. Can you not use 'diff' and 'patch'?  I am so old that I have

   tar xvzf foo_1.2.3.tar.gz
   mv foo foo.orig
   tar xvzf foo_1.2.3.tar.gz
   cd foo
   /* now do your work */
   cd .. && diff -ru foo.orig foo > foo.patch

fairly deeply engrained in muscle memory.  And R itself is in pretty tip-top
shape and will listen to 'configure; make; make install'.  You probably can
even skip make install as you are "just" fighting a failure to build.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From r at catwhisker.org  Wed Jan 18 20:36:02 2017
From: r at catwhisker.org (David Wolfskill)
Date: Wed, 18 Jan 2017 11:36:02 -0800
Subject: [R-pkg-devel] Problem compiling openssl package (FreeBSD
 stable/11)
In-Reply-To: <22655.49564.761468.759011@max.nulle.part>
References: <20170118000516.GA33566@albert.catwhisker.org>
	<20170118190132.GL1167@albert.catwhisker.org>
	<22655.49564.761468.759011@max.nulle.part>
Message-ID: <20170118193602.GM1167@albert.catwhisker.org>

On Wed, Jan 18, 2017 at 01:27:24PM -0600, Dirk Eddelbuettel wrote:
>  ...
> | It turns out that in FreeBSD (possibly also in other BSD-derived
> | environments), PF_UNSPEC is defined (in /usr/include/sys/socket.h), but
> | only if "__BSD_VISIBLE" is true:
> 
> [good detective work omitted]

:-)

> | And it appears that the local sources are ephemeral, so I can't
> | readily patch those sources to see if I can get it to work (as the
> | patched sources wouldn't be used) -- unless I miss the mark....
> | 
> | Any suggestions for how I might proceed?
> 
> I don't follow. Can you not use 'diff' and 'patch'?  I am so old that I have
> 
>    tar xvzf foo_1.2.3.tar.gz
>    mv foo foo.orig
>    tar xvzf foo_1.2.3.tar.gz
>    cd foo
>    /* now do your work */
>    cd .. && diff -ru foo.orig foo > foo.patch
> 
> fairly deeply engrained in muscle memory.  And R itself is in pretty tip-top
> shape and will listen to 'configure; make; make install'.  You probably can
> even skip make install as you are "just" fighting a failure to build.
> ....

Oh, I can use the commands; I had been treating install.packages() as
rather more of a "black box" -- once I discovered that on exiting R, the
claimed location for the downloaded packages had vanished, I got a bit
"gun-shy." :-}

(I haven't actually created any packages in R....)

Thanks!

Peace,
david
-- 
David H. Wolfskill				r at catwhisker.org
How could one possibly "respect" a misogynist, racist, bullying con-man??!?

See http://www.catwhisker.org/~david/publickey.gpg for my public key.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 603 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20170118/cbc93d59/attachment.bin>

From pgilbert902 at gmail.com  Wed Jan 18 22:54:17 2017
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Wed, 18 Jan 2017 16:54:17 -0500
Subject: [R-pkg-devel] package API change
In-Reply-To: <22655.29673.645584.11238@max.nulle.part>
References: <DB5PR0401MB19907304E9434D1558B5101FD57F0@DB5PR0401MB1990.eurprd04.prod.outlook.com>
	<969fb660-2176-1498-5b5c-c17c172630f5@gmail.com>
	<CAJuCY5zWZra2-J5+W0e_xf=CvFnwwj2LBfk+ejQETCO=4yh6yA@mail.gmail.com>
	<22655.29673.645584.11238@max.nulle.part>
Message-ID: <b2143861-d871-e165-fd07-5d3d8526d819@gmail.com>



On 01/18/2017 08:55 AM, Dirk Eddelbuettel wrote:
>
> On 18 January 2017 at 13:49, Thierry Onkelinx wrote:
> | Another solution is to start a new package. This is what Hadley did with
> | the ggplot package (https://cran.r-project.org/src/contrib/Archive/ggplot/).
> | The new version (ggplot2) would break existing code. Users were informed
> | that the old package is not longer maintained. So the user has the choice
> | between using the old version which still works but no longer maintained or
> | the switched to the new version which is maintained but will break existing
> | code.
>
> AFAIK that practice of package inflation is outlawed by CRAN Policy now:
>
>      * Changes to CRAN packages causing significant disruption to other
>        packages must be agreed with the CRAN maintainers well in advance of
>        any publicity. Introduction of packages providing back-compatibility
>        versions of already available packages is not allowed.
>
Perhaps CRAN maintainers could provide some clarification on this policy 
statement. I do not read it with the same interpretation as Dirk. My 
interpretation is that a package which is back-compatibility can be left 
in place and a new package with a new name can be introduced for going 
forward. What is not allowed is using the old package name going 
forward, or rather, the complementary part of introducing a new package 
name for the back-compatibility version. Dirk's reply suggests his 
interpretation is that any back-compatibility version is not allowed.

Paul

> R itself has mechanisms for this: .Deprecated was already mentioned.
>
> Many other packages "warn now", phase in new code and then offer a toggle
> (maybe via options()) to get the old behaviour.
>
> As package authors, we have a "contract" with our users. Sure, we can break
> it willy-nilly (and the informal reputation mechanism may make us pay for
> this) or we can try to hold the contract and accomodate.
>
> It's programming.  There is always another layer we can insert.
>
> Dirk
>


From r at catwhisker.org  Thu Jan 19 01:44:16 2017
From: r at catwhisker.org (David Wolfskill)
Date: Wed, 18 Jan 2017 16:44:16 -0800
Subject: [R-pkg-devel] Problem compiling openssl package (FreeBSD
 stable/11)
In-Reply-To: <22655.49564.761468.759011@max.nulle.part>
References: <20170118000516.GA33566@albert.catwhisker.org>
	<20170118190132.GL1167@albert.catwhisker.org>
	<22655.49564.761468.759011@max.nulle.part>
Message-ID: <20170119004416.GO1167@albert.catwhisker.org>

On Wed, Jan 18, 2017 at 01:27:24PM -0600, Dirk Eddelbuettel wrote:
>  ... 
> | And it appears that the local sources are ephemeral, so I can't
> | readily patch those sources to see if I can get it to work (as the
> | patched sources wouldn't be used) -- unless I miss the mark....
> | 
> | Any suggestions for how I might proceed?
> 
> I don't follow. Can you not use 'diff' and 'patch'?  I am so old that I have
> 
>    tar xvzf foo_1.2.3.tar.gz
>    mv foo foo.orig
>    tar xvzf foo_1.2.3.tar.gz
>    cd foo
>    /* now do your work */
>    cd .. && diff -ru foo.orig foo > foo.patch
> 
> fairly deeply engrained in muscle memory.  And R itself is in pretty tip-top
> shape and will listen to 'configure; make; make install'.  You probably can
> even skip make install as you are "just" fighting a failure to build.
> ....

OK; thanks (again!) for your hints. :-)

I was able puzzle through things enough to determine that re-invoking
install.packages() as

	install.packages("~/R/Rtmp4VjFtY/dhw/openssl", repos = NULL)

(in my case) would allow me to work with my copy of the sources; some
experimentation^Whacking later, I determined that the patch:

--- src/ssl.c.orig      2016-12-30 13:26:04.000000000 -0800
+++ src/ssl.c   2017-01-18 16:31:02.301226000 -0800
@@ -2,6 +2,9 @@
 #if !defined(_WIN32) && !defined(__sun) && !defined(_POSIX_C_SOURCE)
 #define _POSIX_C_SOURCE 200112L
 #endif
+#if defined(__FreeBSD__)
+#define __BSD_VISIBLE           1
+#endif
 
 #include <Rinternals.h>
 #include <stdlib.h>

appears to allow the build (& install) to complete successfully.

I have managed to report this to the openssl package author.

Thanks again!

Peace,
david
-- 
David H. Wolfskill				r at catwhisker.org
How could one possibly "respect" a misogynist, racist, bullying con-man??!?

See http://www.catwhisker.org/~david/publickey.gpg for my public key.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 603 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20170118/a8d189dd/attachment.bin>

From edd at debian.org  Thu Jan 19 16:02:12 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 19 Jan 2017 09:02:12 -0600
Subject: [R-pkg-devel] Problem compiling openssl package (FreeBSD
 stable/11)
In-Reply-To: <20170119004416.GO1167@albert.catwhisker.org>
References: <20170118000516.GA33566@albert.catwhisker.org>
	<20170118190132.GL1167@albert.catwhisker.org>
	<22655.49564.761468.759011@max.nulle.part>
	<20170119004416.GO1167@albert.catwhisker.org>
Message-ID: <22656.54516.294401.5718@max.nulle.part>


On 18 January 2017 at 16:44, David Wolfskill wrote:
| OK; thanks (again!) for your hints. :-)
| 
| I was able puzzle through things enough to determine that re-invoking
| install.packages() as
| 
| 	install.packages("~/R/Rtmp4VjFtY/dhw/openssl", repos = NULL)
| 
| (in my case) would allow me to work with my copy of the sources; some
| experimentation^Whacking later,

Glad you have something, you still made your life harder than you should
have.  The _canonical_ and _documented_ way (and yes, there is basically an
entire manual dedicated to this which came with your version of R) is to

    R CMD build foo/
    R CMD check foo_1.2.3.tar.gz
    R CMD INSTALL foo_1.2.3.tar.gz

Working from sources works, cleaning up every once in a while and working
from pristine source is recommended for a reason.

Don't mean to call you out here, mostly leaving it for the next person
refusing to read the manual and ending up here by other means.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From r at catwhisker.org  Thu Jan 19 16:06:49 2017
From: r at catwhisker.org (David Wolfskill)
Date: Thu, 19 Jan 2017 07:06:49 -0800
Subject: [R-pkg-devel] Problem compiling openssl package (FreeBSD
 stable/11)
In-Reply-To: <22656.54516.294401.5718@max.nulle.part>
References: <20170118000516.GA33566@albert.catwhisker.org>
	<20170118190132.GL1167@albert.catwhisker.org>
	<22655.49564.761468.759011@max.nulle.part>
	<20170119004416.GO1167@albert.catwhisker.org>
	<22656.54516.294401.5718@max.nulle.part>
Message-ID: <20170119150649.GO1167@albert.catwhisker.org>

On Thu, Jan 19, 2017 at 09:02:12AM -0600, Dirk Eddelbuettel wrote:
> ... 
> | I was able puzzle through things enough to determine that re-invoking
> | install.packages() as
> | 
> | 	install.packages("~/R/Rtmp4VjFtY/dhw/openssl", repos = NULL)
> | 
> | (in my case) would allow me to work with my copy of the sources; some
> | experimentation^Whacking later,
> 
> Glad you have something, you still made your life harder than you should
> have.  The _canonical_ and _documented_ way (and yes, there is basically an
> entire manual dedicated to this which came with your version of R) is to
> 
>     R CMD build foo/
>     R CMD check foo_1.2.3.tar.gz
>     R CMD INSTALL foo_1.2.3.tar.gz

Ah; OK; thanks! :-)

> Working from sources works, cleaning up every once in a while and working
> from pristine source is recommended for a reason.

I can understand that, certainly.

> Don't mean to call you out here, mostly leaving it for the next person
> refusing to read the manual and ending up here by other means.

Fair enough -- and thank you! :-)

(I like to think that ignorance is curable....)

Peace,
david
-- 
David H. Wolfskill				r at catwhisker.org
How could one possibly "respect" a misogynist, racist, bullying con-man??!?

See http://www.catwhisker.org/~david/publickey.gpg for my public key.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 603 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20170119/047ec01f/attachment.bin>

From leegi001 at umn.edu  Tue Jan 24 22:11:08 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Tue, 24 Jan 2017 15:11:08 -0600
Subject: [R-pkg-devel] Fwd: R-package-devel@R-project.org: RANDR
In-Reply-To: <mailman.1467.1485247847.4316.r-package-devel@r-project.org>
References: <mailman.1467.1485247847.4316.r-package-devel@r-project.org>
Message-ID: <CAOeg=_8UZuaP2iBMTeT3Y2-L2=wS9GjOKYCd=La2bRjeU5y3-w@mail.gmail.com>

I'm cleaning up the problems in my build, but there are a few I do not
understand, like this one.  What is this telling me?

--------------------

* checking for unstated dependencies in examples ...Warning in grep("^Xlib:
*extension \"RANDR\" missing on display", out, invert = TRUE,  :

  input string 4 is invalid in this locale

Error in grep("^Xlib: *extension \"RANDR\" missing on display", out, invert
= TRUE,  :

  attempt to set index 4/4 in SET_STRING_ELT

Execution halted

--------------------
?Thank you for your assistance,
?
Cathy Lee Gierke

	[[alternative HTML version deleted]]


From sjt at fb.com  Tue Jan 24 22:26:21 2017
From: sjt at fb.com (Sean Taylor)
Date: Tue, 24 Jan 2017 21:26:21 +0000
Subject: [R-pkg-devel] Multiple architectures on Windows
In-Reply-To: <83ABF34C-BB91-4021-9FD4-F2D6786F77CF@contoso.com>
References: <83ABF34C-BB91-4021-9FD4-F2D6786F77CF@contoso.com>
Message-ID: <2AB3ECE8-9F5B-4EFA-809F-2AD0F79D6517@fb.com>

I am testing a package on Windows for submission for CRAN but having trouble getting it to work on i386 and x64 platforms simultaneously.

At install time, the package runs a install.libs.R to generate an RData file.  This file contains compiled code (they are cached Stan models generated from the rstan package) that is architecture specific.

When I check the package on Windows, it will always fail to load the RData file on whatever architecture it was not installed with (e.g. if I install with x64, it will fail to load on i386).  This suggests to me that the install step is not running for both architectures as it should, or that they are being written to the same place and one is overwriting the other.

Is there a way to configure the package to force it to run install.libs.R to generate these RData files separately under both architectures?  The problem as far as I can tell is that the `R_ARCH` global variable is always empty in install.libs.R, so under both i386 and x86 runs, the RData files are being written to the same place.  My destination directory is set using the following line: `dest <- file.path(R_PACKAGE_DIR, paste0('libs', R_ARCH))`.

Things I have tried to force this behavior:

-          Adding `Biarch: true` to the DESCRIPTION file.

-          Adding a configure.win file.

Thanks for any help you can offer!  I am happy to share the package file itself if you find that useful.

Sean Taylor
sjt at fb.com

References:
My install.libs.R: https://gist.github.com/seanjtaylor/17f3d3df9adade9d201973e32c8cc362
Install/Check output with no package configuration: https://gist.github.com/seanjtaylor/4a5c26aec9662c2c606e61e24d0d1ebf
Install/Check output with `Biarch: true`:  https://gist.github.com/seanjtaylor/da5b51298e3ac38825a09d1c01435ade
Install/Check output with configure.win file: https://gist.github.com/seanjtaylor/925902ba4093ab4eb1ef748d677a63c7
Install/Check output with `Biarch: true` AND configure.win file: https://gist.github.com/seanjtaylor/8382f28ead1ccd6b5e2e9c5cc036f4ad


	[[alternative HTML version deleted]]


From edd at debian.org  Tue Jan 24 23:20:30 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 24 Jan 2017 16:20:30 -0600
Subject: [R-pkg-devel] Multiple architectures on Windows
In-Reply-To: <2AB3ECE8-9F5B-4EFA-809F-2AD0F79D6517@fb.com>
References: <83ABF34C-BB91-4021-9FD4-F2D6786F77CF@contoso.com>
	<2AB3ECE8-9F5B-4EFA-809F-2AD0F79D6517@fb.com>
Message-ID: <22663.54062.822954.456585@max.nulle.part>


Sean,

You could look at the packages Rblpapi and x13binary both of which do
something a little nonstandard, but arch dependent.  You can either 'hit it'
in the configure or the make step.  I can detail if needed.

x13binary is smaller. It just pulls the Census binary in, for Windows that is
precompiled.  Here is its configure.win:

-----------------------------------------------------------------------------
#!/bin/sh
cwd=$(pwd)
cd inst

r_script="${R_HOME}/bin${R_ARCH_BIN}/Rscript"
set_internet2=`"${r_script}" -e "cat(ifelse(compareVersion(paste(R.Version()['major'], R.Version()['minor'], sep = '.'), '3.2.2') > 0, '', 'setInternet2();'))"`

"${r_script}" -e "${set_internet2} download.file('https://github.com/x13org/x13prebuilt/raw/master/v1.1.26/windows/x13ashtml.zip', 'x13ashtml.zip', quiet = TRUE, mode = \"wb\")"
unzip -u x13ashtml.zip
cp x13ashtml/x13ashtml.exe bin
rm x13ashtml.zip
rm -R x13ashtml
cd ${cwd}

exit 0
-----------------------------------------------------------------------------


Similarly, here is src/Makevars.win for Rblpapi -- it needs a library we
fetch from Bloomberg (in configure.win) but unpack as needed:

-----------------------------------------------------------------------------
## -*- mode: Makefile; tab-width: 8 -*-
##
##  Makefile.win -- Windows build system
##
##  Copyright (C) 2015  Whit Armstrong and Dirk Eddelbuettel
##
##  This file is part of Rblpapi
##
##  Rblpapi is free software: you can redistribute it and/or modify
##  it under the terms of the GNU General Public License as published by
##  the Free Software Foundation, either version 2 of the License, or
##  (at your option) any later version.
##
##  Rblpapi is distributed in the hope that it will be useful,
##  but WITHOUT ANY WARRANTY; without even the implied warranty of
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
##  GNU General Public License for more details.
##
##  You should have received a copy of the GNU General Public License
##  along with Rblpapi.  If not, see <http://www.gnu.org/licenses/>.


## Distinguish between 32 and 64 bit windows
ifeq "$(WIN)" "64"
    FLV = x64
else
    FLV = i386
endif

## Standard compiler / linker flags including windows flavor
CXX_STD = CXX11
PKG_CPPFLAGS = -I../inst/include -I.
PKG_LIBS = -lblpapi3_${WIN} -L${FLV}


## SHLIB target is built by R, blpLibrary is a target we use to expand the tar.gz
all:    	blpLibrary $(SHLIB)

## target to ensure tar.gz files get unpacked
## the opening '@' ensures operations are executed 'quietly'
## in order to see commands as they happens add a 'v' to the tar and cp commands
## curl has '-k' flag to suppress certificate warnings
blpLibrary:
		@if [ ! -d ../inst ]; then mkdir -p ../inst; fi
		@if [ ! -d ../blp/win/${FLV} ]; then mkdir -p ../blp/win/${FLV}; fi
		@if [ ! -f ../blp/win/${FLV}/blpHeaders.tar.gz ]; then curl -s -k -L -O https://github.com/Rblp/blp/raw/master/headers/windows/blpHeaders.tar.gz; mv blpHeaders.tar.gz ../blp/win/${FLV}; tar xfz ../blp/win/${FLV}/blpHeaders.tar.gz -C ../inst; fi
		@if [ ! -f ../blp/win/${FLV}/blpLibrary.tar.gz ]; then curl -s -k -L -O https://github.com/Rblp/blp/raw/master/win${WIN}/blpLibrary.tar.gz; mv blpLibrary.tar.gz ../blp/win/${FLV}; tar xfz ../blp/win/${FLV}/blpLibrary.tar.gz; fi
		@if [ ! -d ${FLV} ]; then mkdir -p ${FLV}; fi
		@cp blpapi3_${WIN}.dll ${FLV}
		@if [ ! -d ../inst/libs/${FLV} ]; then mkdir -p ../inst/libs/${FLV}; fi
		@cp blpapi3_${WIN}.dll ../inst/libs/${FLV}

## Ensure the blpLibrary target is always executed
.Phony:		blpLibrary

-----------------------------------------------------------------------------

Hth,  Dirk


-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd at debian.org  Tue Jan 24 23:28:54 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 24 Jan 2017 16:28:54 -0600
Subject: [R-pkg-devel] Fwd: R-package-devel@R-project.org: RANDR
In-Reply-To: <CAOeg=_8UZuaP2iBMTeT3Y2-L2=wS9GjOKYCd=La2bRjeU5y3-w@mail.gmail.com>
References: <mailman.1467.1485247847.4316.r-package-devel@r-project.org>
	<CAOeg=_8UZuaP2iBMTeT3Y2-L2=wS9GjOKYCd=La2bRjeU5y3-w@mail.gmail.com>
Message-ID: <22663.54566.999860.772625@max.nulle.part>


On 24 January 2017 at 15:11, Cathy Lee Gierke wrote:
| I'm cleaning up the problems in my build, but there are a few I do not
| understand, like this one.  What is this telling me?
| 
| --------------------
| 
| * checking for unstated dependencies in examples ...Warning in grep("^Xlib:
| *extension \"RANDR\" missing on display", out, invert = TRUE,  :
| 
|   input string 4 is invalid in this locale
| 
| Error in grep("^Xlib: *extension \"RANDR\" missing on display", out, invert
| = TRUE,  :
| 
|   attempt to set index 4/4 in SET_STRING_ELT
| 
| Execution halted
| 
| --------------------
| ?Thank you for your assistance,

Those are X11 error messages. How are your running your test? Anything
unusual like a remote connection suppressing display extension such as RANDR
which are usually available at the workstation itself.

In any case, this may have nothing to do with you package per se but as did
not share code or how you ran the tests it is hard to say more.

Best, Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From leegi001 at umn.edu  Tue Jan 24 23:41:24 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Tue, 24 Jan 2017 16:41:24 -0600
Subject: [R-pkg-devel] Fwd: R-package-devel@R-project.org: RANDR
In-Reply-To: <22663.54566.999860.772625@max.nulle.part>
References: <mailman.1467.1485247847.4316.r-package-devel@r-project.org>
	<CAOeg=_8UZuaP2iBMTeT3Y2-L2=wS9GjOKYCd=La2bRjeU5y3-w@mail.gmail.com>
	<22663.54566.999860.772625@max.nulle.part>
Message-ID: <CAOeg=_-TumWq3FKKR5fdPBitRrML8Z5x=-G=9TdXMwrPKqJe6Q@mail.gmail.com>

Thank you Dirk.

When you say test, I think you mean the examples in the documentation.
Which I likely do have wrong, because I'm not sure how to make a data file
available to the example..... but that may be a different issue.

I don't know what RANDR is.  I am opening several alternate output files:
 pdf, rtf txt.  Would that impact it?  Here is the example call to my
package, if that helps:

 \examples{
                  #---------------------   Vignette3      visualization

                  filePath<-"~/file/path/Installing CAT/Vignette3"
 # use for mac
                  #filePath<-"c:\\file\\path\\Installing CAT\\Vignette3"
  # use for PC
                  fileName<-file.path(filePath,'activity stress c57--stress
copy2-part.txt')
                  file2Name<-file.path(filePath,'good-6d-2m-part.txt')

                  CatCall(TimeCol=c(1,2), timeFormat=?\%d/\%m/\%y
\%H:\%M:\%S?,lum=NA, valCols=5, sumCols=c(), Avg=FALSE, export=TRUE,
sizePts=2, binPts=1, Span = 0, Increment=0, k=5, yLab=NA, modulo=1440,
Rverbose=0, RmaxGap=3000, Skip=0, header=TRUE, Smoothing=T,
Actogram=T,AutoCorr=T,CrossCorr=T,Console=F,Graphics="pdf", Darkness1=0,
LagPcnt=1, tz="GMT",
fileName=fileName,file2=list(Name=file2Name,TimeCol=c(1,2),
timeFormat="\%d/\%m/\%y \%H:\%M:\%S", lum=NA, valCols=5,
sumCols=c(),sizePts=2, binPts=1,Darkness=0))
                  }

Can I tell you anything that would be more helpful?

Cathy Lee Gierke


*?Darkness cannot drive out darkness: only light can do that. Hate cannot
drive out hate: only love can do that.? *
*?The arc of the moral universe is long, but it bends towards justice.?*
*?Nothing in the world is more dangerous than sincere ignorance and
conscientious stupidity.? *
*?Never forget that everything Hitler did in Germany was legal.?   *
*?Forgiveness is not an occasional act, it is a constant attitude.? *
*?Injustice anywhere is a threat to justice everywhere.?  *

? Martin Luther King Jr.

<http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>

On Tue, Jan 24, 2017 at 4:28 PM, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 24 January 2017 at 15:11, Cathy Lee Gierke wrote:
> | I'm cleaning up the problems in my build, but there are a few I do not
> | understand, like this one.  What is this telling me?
> |
> | --------------------
> |
> | * checking for unstated dependencies in examples ...Warning in
> grep("^Xlib:
> | *extension \"RANDR\" missing on display", out, invert = TRUE,  :
> |
> |   input string 4 is invalid in this locale
> |
> | Error in grep("^Xlib: *extension \"RANDR\" missing on display", out,
> invert
> | = TRUE,  :
> |
> |   attempt to set index 4/4 in SET_STRING_ELT
> |
> | Execution halted
> |
> | --------------------
> | ?Thank you for your assistance,
>
> Those are X11 error messages. How are your running your test? Anything
> unusual like a remote connection suppressing display extension such as
> RANDR
> which are usually available at the workstation itself.
>
> In any case, this may have nothing to do with you package per se but as did
> not share code or how you ran the tests it is hard to say more.
>
> Best, Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From roy.mendelssohn at noaa.gov  Tue Jan 24 23:46:33 2017
From: roy.mendelssohn at noaa.gov (Roy Mendelssohn - NOAA Federal)
Date: Tue, 24 Jan 2017 14:46:33 -0800
Subject: [R-pkg-devel] Fwd: R-package-devel@R-project.org: RANDR
In-Reply-To: <CAOeg=_-TumWq3FKKR5fdPBitRrML8Z5x=-G=9TdXMwrPKqJe6Q@mail.gmail.com>
References: <mailman.1467.1485247847.4316.r-package-devel@r-project.org>
	<CAOeg=_8UZuaP2iBMTeT3Y2-L2=wS9GjOKYCd=La2bRjeU5y3-w@mail.gmail.com>
	<22663.54566.999860.772625@max.nulle.part>
	<CAOeg=_-TumWq3FKKR5fdPBitRrML8Z5x=-G=9TdXMwrPKqJe6Q@mail.gmail.com>
Message-ID: <F056F693-6BC7-4855-BC69-9036DACA8E01@noaa.gov>

Hi Cathy:
> On Jan 24, 2017, at 2:41 PM, Cathy Lee Gierke <leegi001 at umn.edu> wrote:
> 
> Which I likely do have wrong, because I'm not sure how to make a data file
> available to the example..... but that may be a different issue.

See:

http://r-pkgs.had.co.nz/data.html

In fact read through the entire thing.  it will make you like much easier if and when you go to submit your package.

-Roy


**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: http://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From csardi.gabor at gmail.com  Wed Jan 25 17:31:43 2017
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Wed, 25 Jan 2017 16:31:43 +0000
Subject: [R-pkg-devel] Creating a new package dependent on Igraph
In-Reply-To: <CACD0KfPbxMC6NLEBH4PH3hfDpVrV2YXpt1dZSncPr4oDyy-22A@mail.gmail.com>
References: <CACD0KfPbxMC6NLEBH4PH3hfDpVrV2YXpt1dZSncPr4oDyy-22A@mail.gmail.com>
Message-ID: <CABtg=KmVotvfmwuK64dP4CroSu+cGPb+eGiEv1Qj3VXgnmOZbg@mail.gmail.com>

Hi Annu,

unfortunately this is not easily possible AFAIK. The igraph R package has
no public C-level API.
Basically all you can do currently is copying all igraph source code into
your own package. There is already another package on CRAN that does this.

Gabor

On Tue, Jan 17, 2017 at 11:45 AM, Annu Joshi <annu.mcs.du.2015 at gmail.com>
wrote:

> Hello all,
> I have implemented few graph decomposition algorithm for R using Igraph's C
> API. I would like to know how can I resolve the dependencies on igraph
> while creating my own package.
>
> Thanks
> Annu Joshi
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From Brooke.Anderson at colostate.edu  Wed Jan 25 19:17:28 2017
From: Brooke.Anderson at colostate.edu (Anderson,Brooke)
Date: Wed, 25 Jan 2017 18:17:28 +0000
Subject: [R-pkg-devel] Process for building vignettes during a CRAN package
	submission
Message-ID: <DM2PR0701MB10193B6B5AB1E4531F5ECE4EE6740@DM2PR0701MB1019.namprd07.prod.outlook.com>

I am creating a package with a 'Suggests' dependency on a second package hosted in a drat repository on GitHub. I have listed the second package in 'Suggests' of the DESCRIPTION file for the first package and listed the drat repository in 'Additional_repositories'. I have made all code in the vignette and examples conditional on the availability of the second repository using `requireNamespace`, with the `quietly` option set to TRUE, so code is skipped if the package is built on a system that does not have the second package loaded. This package is passing all CRAN checks on my computer and only gets a single NOTE on win-builder about "Suggests or Enhances not in mainstream repositories", so I'm happy with the package set-up in terms of passing checks.


My one concern is what the vignette that users who install the package from CRAN will look like. If I build the vignette on my computer, with the second package installed, the vignette looks as I would like it to for users, since all the examples are run. However, if the vignette is built on a system without the second package installed, the vignette is pretty boring since most examples are skipped. I have a question about the CRAN submission process related to vignette building that will help me clarify this concern.


Based on reading through "Writing R Extensions", this is what I think happens with a vignette and its code during the CRAN submission process:


1. Before submitting the package to CRAN, the package maintainer builds and checks the package locally. When the package is built locally, any vignettes are built in pdf and / or html files. These files are stored in the package's `\inst\doc` directory. This directory (`inst\doc`) is packaged with other package elements else in the .tar.gz file. Everything in .tar.gz is sent to CRAN.

2. When the package is sent to CRAN, CRAN tries running all of the code in the examples and vignette. However, CRAN does not rebuild the vignette.

3. Once the package is on CRAN, CRAN regularly checks the package. To do this, CRAN tries running all of the code in the examples and vignette. However, again, CRAN does not rebuild the vignette. Instead, the vignette that is sent out to users continues to be the one built by the package maintainer when he or she first submitted the package .tar.gz to CRAN.


Have I understood this process, particularly #2, correctly? Or will CRAN rebuild the vignette during the submission process and replace the .html or .pdf version of the vignette that is passed to users who install the package from CRAN?

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Thu Jan 26 11:00:55 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 26 Jan 2017 11:00:55 +0100
Subject: [R-pkg-devel] Process for building vignettes during a CRAN
 package submission
In-Reply-To: <DM2PR0701MB10193B6B5AB1E4531F5ECE4EE6740@DM2PR0701MB1019.namprd07.prod.outlook.com>
References: <DM2PR0701MB10193B6B5AB1E4531F5ECE4EE6740@DM2PR0701MB1019.namprd07.prod.outlook.com>
Message-ID: <7d42aae6-a32d-5958-9074-6b18c9d904ed@statistik.tu-dortmund.de>



On 25.01.2017 19:17, Anderson,Brooke wrote:
> I am creating a package with a 'Suggests' dependency on a second package hosted in a drat repository on GitHub. I have listed the second package in 'Suggests' of the DESCRIPTION file for the first package and listed the drat repository in 'Additional_repositories'. I have made all code in the vignette and examples conditional on the availability of the second repository using `requireNamespace`, with the `quietly` option set to TRUE, so code is skipped if the package is built on a system that does not have the second package loaded. This package is passing all CRAN checks on my computer and only gets a single NOTE on win-builder about "Suggests or Enhances not in mainstream repositories", so I'm happy with the package set-up in terms of passing checks.
>
>
> My one concern is what the vignette that users who install the package from CRAN will look like. If I build the vignette on my computer, with the second package installed, the vignette looks as I would like it to for users, since all the examples are run. However, if the vignette is built on a system without the second package installed, the vignette is pretty boring since most examples are skipped. I have a question about the CRAN submission process related to vignette building that will help me clarify this concern.
>
>
> Based on reading through "Writing R Extensions", this is what I think happens with a vignette and its code during the CRAN submission process:
>
>
> 1. Before submitting the package to CRAN, the package maintainer builds and checks the package locally. When the package is built locally, any vignettes are built in pdf and / or html files. These files are stored in the package's `\inst\doc` directory. This directory (`inst\doc`) is packaged with other package elements else in the .tar.gz file. Everything in .tar.gz is sent to CRAN.
>
> 2. When the package is sent to CRAN, CRAN tries running all of the code in the examples and vignette. However, CRAN does not rebuild the vignette.
>
> 3. Once the package is on CRAN, CRAN regularly checks the package. To do this, CRAN tries running all of the code in the examples and vignette. However, again, CRAN does not rebuild the vignette. Instead, the vignette that is sent out to users continues to be the one built by the package maintainer when he or she first submitted the package .tar.gz to CRAN.
>
>
> Have I understood this process, particularly #2, correctly? Or will CRAN rebuild the vignette during the submission process and replace the .html or .pdf version of the vignette that is passed to users who install the package from CRAN?


Correct, the vignette that is shipped is the one you built locally.
CRAN tests if it can be rebuilt.

Best,
Uwe Ligges



> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From murdoch.duncan at gmail.com  Fri Jan 27 22:39:09 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 27 Jan 2017 16:39:09 -0500
Subject: [R-pkg-devel] Fwd: R-package-devel@R-project.org: RANDR
In-Reply-To: <22663.54566.999860.772625@max.nulle.part>
References: <mailman.1467.1485247847.4316.r-package-devel@r-project.org>
	<CAOeg=_8UZuaP2iBMTeT3Y2-L2=wS9GjOKYCd=La2bRjeU5y3-w@mail.gmail.com>
	<22663.54566.999860.772625@max.nulle.part>
Message-ID: <f05f1cd0-d4a9-6a10-23eb-b565c02c954f@gmail.com>

On 24/01/2017 5:28 PM, Dirk Eddelbuettel wrote:
>
> On 24 January 2017 at 15:11, Cathy Lee Gierke wrote:
> | I'm cleaning up the problems in my build, but there are a few I do not
> | understand, like this one.  What is this telling me?
> |
> | --------------------
> |
> | * checking for unstated dependencies in examples ...Warning in grep("^Xlib:
> | *extension \"RANDR\" missing on display", out, invert = TRUE,  :
> |
> |   input string 4 is invalid in this locale
> |
> | Error in grep("^Xlib: *extension \"RANDR\" missing on display", out, invert
> | = TRUE,  :
> |
> |   attempt to set index 4/4 in SET_STRING_ELT
> |
> | Execution halted
> |
> | --------------------
> | ?Thank you for your assistance,
>
> Those are X11 error messages. How are your running your test? Anything
> unusual like a remote connection suppressing display extension such as RANDR
> which are usually available at the workstation itself.
>
> In any case, this may have nothing to do with you package per se but as did
> not share code or how you ran the tests it is hard to say more.

This one turned out to be two things:  a bad character in a help file 
(the first message kind of hints at that), and a bug in the old version 
of R that Cathy was using.  Messages in current versions are clearer.

Duncan Murdoch


From d.scott at auckland.ac.nz  Sun Jan 29 13:40:52 2017
From: d.scott at auckland.ac.nz (David Scott)
Date: Mon, 30 Jan 2017 01:40:52 +1300
Subject: [R-pkg-devel] Encoding problem
Message-ID: <228e3a6b-a3bd-fabe-60e7-7ada0ea87414@auckland.ac.nz>

I am trying to add a vignette to xtable showing how to incorporate some 
Chinese characters following an enquiry from a user.

I can create the vignette satisfactorily just processing the knitr file 
normally, with the resulting pdf displaying Chinese characters in the R 
code and also as headings when I produce a table. However when I try to 
build the package with the vignette included, I get:

* creating vignettes ...Warning: running command 
'"C:/PROGRA~1/R/R-33~1.2/bin/x64/Rscript" --vanilla
  ERROR
Error: Vignette 'ChineseCharacters.Rnw' is non-ASCII but has no declared 
encoding
Execution halted
make: *** [build] Error 1

I updated R to 3.3.2 and Rtools to 33 before running the build.

The vignette starts as follows:

%\VignetteIndexEntry{xtable Chinese Characters}
%\VignetteDepends{xtable}
%\VignetteKeywords{LaTeX, HTML, table}
%\VignettePackage{xtable}
% !Rnw weave = knitr
% \VignetteEngine{knitr::knitr}
%!\VignetteEncoding{UTF-8}
%**************************************************************************
\documentclass{ctexart}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{array}
\usepackage{hyperref}
\usepackage{inputenx}

The section of the file which is not ASCII is:

<<preparedata>>=
### Prepare data
library(knitr)
library(xtable)

tbl <- data.frame(positivePairs = 0, negativePairs = 0,
                   avePositiveSpread = NA,
                   aveNegativeSpread = NA,
                   PnL = 435, sumPnL = 144358.7)
names(tbl) <- c("????????", "????????", "????????????????",
                 "????????????????", "????????", "????????")
@

I am a bit of a novice at encodings, and know nothing about Chinese 
characters so any advice is welcome.

David Scott



-- 
_________________________________________________________________
David Scott	Department of Statistics
		The University of Auckland, PB 92019
		Auckland 1142,    NEW ZEALAND
Phone: +64 9 923 5055, or +64 9 373 7599 ext 85055
Email:	d.scott at auckland.ac.nz,  Fax: +64 9 373 7018

Volunteer Arena Manager:
Orienteering Sprint Final at University of Auckland
World Masters Games 2017


From thierry.onkelinx at inbo.be  Mon Jan 30 16:10:03 2017
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Mon, 30 Jan 2017 16:10:03 +0100
Subject: [R-pkg-devel] Encoding problem
In-Reply-To: <228e3a6b-a3bd-fabe-60e7-7ada0ea87414@auckland.ac.nz>
References: <228e3a6b-a3bd-fabe-60e7-7ada0ea87414@auckland.ac.nz>
Message-ID: <CAJuCY5xy33jfMN-g=N=SH8-fdPcBinMv46duiqSFhBiZXSwoZg@mail.gmail.com>

Dear David,

Have you tried removing the exclamation mark in %!\VignetteEncoding{UTF-8}?
I think it should be %\VignetteEncoding{UTF-8}

Best regards,

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

2017-01-29 13:40 GMT+01:00 David Scott <d.scott at auckland.ac.nz>:

> I am trying to add a vignette to xtable showing how to incorporate some
> Chinese characters following an enquiry from a user.
>
> I can create the vignette satisfactorily just processing the knitr file
> normally, with the resulting pdf displaying Chinese characters in the R
> code and also as headings when I produce a table. However when I try to
> build the package with the vignette included, I get:
>
> * creating vignettes ...Warning: running command
> '"C:/PROGRA~1/R/R-33~1.2/bin/x64/Rscript" --vanilla
>  ERROR
> Error: Vignette 'ChineseCharacters.Rnw' is non-ASCII but has no declared
> encoding
> Execution halted
> make: *** [build] Error 1
>
> I updated R to 3.3.2 and Rtools to 33 before running the build.
>
> The vignette starts as follows:
>
> %\VignetteIndexEntry{xtable Chinese Characters}
> %\VignetteDepends{xtable}
> %\VignetteKeywords{LaTeX, HTML, table}
> %\VignettePackage{xtable}
> % !Rnw weave = knitr
> % \VignetteEngine{knitr::knitr}
> %!\VignetteEncoding{UTF-8}
> %***********************************************************
> ***************
> \documentclass{ctexart}
> \usepackage{longtable}
> \usepackage{booktabs}
> \usepackage{array}
> \usepackage{hyperref}
> \usepackage{inputenx}
>
> The section of the file which is not ASCII is:
>
> <<preparedata>>=
> ### Prepare data
> library(knitr)
> library(xtable)
>
> tbl <- data.frame(positivePairs = 0, negativePairs = 0,
>                   avePositiveSpread = NA,
>                   aveNegativeSpread = NA,
>                   PnL = 435, sumPnL = 144358.7)
> names(tbl) <- c("????????", "????????", "????????????????",
>                 "????????????????", "????????", "????????")
> @
>
> I am a bit of a novice at encodings, and know nothing about Chinese
> characters so any advice is welcome.
>
> David Scott
>
>
>
> --
> _________________________________________________________________
> David Scott     Department of Statistics
>                 The University of Auckland, PB 92019
>                 Auckland 1142,    NEW ZEALAND
> Phone: +64 9 923 5055, or +64 9 373 7599 ext 85055
> Email:  d.scott at auckland.ac.nz,  Fax: +64 9 373 7018
>
> Volunteer Arena Manager:
> Orienteering Sprint Final at University of Auckland
> World Masters Games 2017
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From leegi001 at umn.edu  Mon Jan 30 16:45:35 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Mon, 30 Jan 2017 09:45:35 -0600
Subject: [R-pkg-devel] Description Meta Information Note
Message-ID: <CAOeg=_8q3hH-d0qzG65aVU4tE36A_8qefN8prqaQs3Xi7QuOmg@mail.gmail.com>

I'm getting a Note that I don't understand....and I think it may be the
cause of other errors later....  I have copied all of the output up to the
error for context.  The error line is at the end.  It seems to say that I
have not done a Build before doing the Check, but I did....

x-134-84-0-217:~ user$ cd '/Users/user/CATkit'

x-134-84-0-217:CATkit user$ *R CMD build CATkit*

* checking for file ?CATkit/DESCRIPTION? ... OK

* preparing ?CATkit?:

* checking DESCRIPTION meta-information ... OK

* checking for LF line-endings in source and make files

* checking for empty or unneeded directories

* building ?CATkit_2.06.tar.gz?


x-134-84-0-217:CATkit user$ *R CMD check CATkit*

* using log directory ?/Users/user/CATkit/CATkit.Rcheck?

* using R version 3.3.2 (2016-10-31)

* using platform: x86_64-apple-darwin13.4.0 (64-bit)

* using session charset: UTF-8

* checking for file ?CATkit/DESCRIPTION? ... OK

* checking extension type ... Package

* this is package ?CATkit? version ?2.06?

* checking package namespace information ... OK

* checking package dependencies ... OK

* checking if this is a source package ... OK

* checking if there is a namespace ... OK

* checking for executable files ... OK

* checking for hidden files and directories ... NOTE

Found the following hidden files and directories:

  .DS_Store

  inst/.DS_Store

  inst/extdata/.DS_Store

  inst/extdata/.Rapp.history

  man/.DS_Store

These were most likely included in error. See section ?Package

structure? in the ?Writing R Extensions? manual.

* checking for portable file names ... OK

* checking for sufficient/correct file permissions ... OK

* checking whether package ?CATkit? can be installed ... OK

* checking installed package size ... OK

* checking package directory ... OK

** checking DESCRIPTION meta-information ... NOTE*

*Checking should be performed on sources prepared by ?R CMD build?.*
?Thanks,
?
Cathy Lee Gierke


<http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>

	[[alternative HTML version deleted]]


From brian at braverock.com  Mon Jan 30 17:05:30 2017
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 30 Jan 2017 10:05:30 -0600
Subject: [R-pkg-devel] Description Meta Information Note
In-Reply-To: <CAOeg=_8q3hH-d0qzG65aVU4tE36A_8qefN8prqaQs3Xi7QuOmg@mail.gmail.com>
References: <CAOeg=_8q3hH-d0qzG65aVU4tE36A_8qefN8prqaQs3Xi7QuOmg@mail.gmail.com>
Message-ID: <1485792330.3192.1.camel@braverock.com>

On Mon, 2017-01-30 at 09:45 -0600, Cathy Lee Gierke wrote:
> ?building ?CATkit_2.06.tar.gz?

R CMD build creates a tarball

> x-134-84-0-217:CATkit user$ *R CMD check CATkit*

but you are checknig the directory, not the tarball.

do 

R CMD check CATkit_2.06.tar.gz

instead.

Regards,

Brian


From leegi001 at umn.edu  Mon Jan 30 17:39:00 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Mon, 30 Jan 2017 10:39:00 -0600
Subject: [R-pkg-devel] =?utf-8?q?no_visible_global_function_definition_for?=
	=?utf-8?b?IOKAmHBhcuKAmQ==?=
Message-ID: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>

Yes, that seemed to get rid of the NOTE....but it doesn't seem to make much
difference other than that.  i.e., it seems to process the same using
CATkit vs CATkit_2.06.tar.gz!

Here is the main error that I am getting.  I just upgraded to the latest R
version, fyi.

Everything was fine, a few minor warnings...now this.  Description and
namespace are proper.  These pkgs should all be part of the R base, aren't
they? Anyone know why I should get these errors?  Thanks!

* checking R code for possible problems ... NOTE

Actogram: no visible global function definition for ?par?

Actogram: no visible global function definition for ?barplot?

Actogram: no visible global function definition for ?box?

Actogram: no visible global function definition for ?text?

Actogram: no visible global function definition for ?mtext?

Actogram: no visible binding for global variable ?end?

AutoCorr: no visible global function definition for ?par?

AutoCorr: no visible global function definition for ?layout?

AutoCorr: no visible global function definition for ?acf?

AutoCorr: no visible global function definition for ?abline?

AutoCorr: no visible global function definition for ?title?

AutoCorr: no visible global function definition for ?mtext?

AutoCorr: no visible global function definition for ?var?

AutoCorr: no visible binding for global variable ?end?

CATCosinor: no visible global function definition for ?par?

CATCosinor: no visible global function definition for ?pdf?

CATCosinor: no visible global function definition for ?jpeg?

CATCosinor: no visible global function definition for ?png?

CATCosinor: no visible global function definition for ?tiff?

......... A zillion more for every function I have......

periCosinor: no visible global function definition for ?par?

periCosinor: no visible global function definition for ?fft?

Undefined global functions or variables:

  TukeyHSD abline acf aov as.raster axis barplot box boxplot ccf

  coefficients dev.cur dev.off drop1 end fft gray heat.colors image

  jpeg layout legend lines median model.tables mtext na.action na.omit

  palette par pdf pf plot plot.new png points rainbow rasterImage

  read.table str strwidth tail terrain.colors text tiff title ts var

  write.table

Consider adding

  importFrom("grDevices", "as.raster", "dev.cur", "dev.off", "gray",

             "heat.colors", "jpeg", "palette", "pdf", "png", "rainbow",

             "terrain.colors", "tiff")

  importFrom("graphics", "abline", "axis", "barplot", "box", "boxplot",

             "image", "layout", "legend", "lines", "mtext", "par",

             "plot", "plot.new", "points", "rasterImage", "strwidth",

             "text", "title")

  importFrom("stats", "TukeyHSD", "acf", "aov", "ccf", "coefficients",

             "drop1", "end", "fft", "median", "model.tables",

             "na.action", "na.omit", "pf", "ts", "var")

  importFrom("utils", "read.table", "str", "tail", "write.table")

to your NAMESPACE file.

Cathy Lee Gierke


*?Darkness cannot drive out darkness: only light can do that. Hate cannot
drive out hate: only love can do that.? *
*?The arc of the moral universe is long, but it bends towards justice.?*
*?Nothing in the world is more dangerous than sincere ignorance and
conscientious stupidity.? *
*?Never forget that everything Hitler did in Germany was legal.?   *
*?Forgiveness is not an occasional act, it is a constant attitude.? *
*?Injustice anywhere is a threat to justice everywhere.?  *

? Martin Luther King Jr.

<http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>

On Mon, Jan 30, 2017 at 10:05 AM, Brian G. Peterson <brian at braverock.com>
wrote:

> On Mon, 2017-01-30 at 09:45 -0600, Cathy Lee Gierke wrote:
> >  building ?CATkit_2.06.tar.gz?
>
> R CMD build creates a tarball
>
> > x-134-84-0-217:CATkit user$ *R CMD check CATkit*
>
> but you are checknig the directory, not the tarball.
>
> do
>
> R CMD check CATkit_2.06.tar.gz
>
> instead.
>
> Regards,
>
> Brian
>

	[[alternative HTML version deleted]]


From edd at debian.org  Mon Jan 30 17:52:09 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 30 Jan 2017 10:52:09 -0600
Subject: [R-pkg-devel]
	=?utf-8?q?no_visible_global_function_definition_for?=
	=?utf-8?b?IOKAmHBhcuKAmQ==?=
In-Reply-To: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
References: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
Message-ID: <22671.28473.107064.290558@max.nulle.part>


On 30 January 2017 at 10:39, Cathy Lee Gierke wrote:
| Everything was fine, a few minor warnings...now this.  Description and
| namespace are proper.  These pkgs should all be part of the R base, aren't
| they? Anyone know why I should get these errors?  Thanks!

Just read what it says and do that:

| Consider adding
| 
|   importFrom("grDevices", "as.raster", "dev.cur", "dev.off", "gray",
|              "heat.colors", "jpeg", "palette", "pdf", "png", "rainbow",
|              "terrain.colors", "tiff")
|   importFrom("graphics", "abline", "axis", "barplot", "box", "boxplot",
|              "image", "layout", "legend", "lines", "mtext", "par",
|              "plot", "plot.new", "points", "rasterImage", "strwidth",
|              "text", "title")
|   importFrom("stats", "TukeyHSD", "acf", "aov", "ccf", "coefficients",
|              "drop1", "end", "fft", "median", "model.tables",
|              "na.action", "na.omit", "pf", "ts", "var")
|   importFrom("utils", "read.table", "str", "tail", "write.table")
| 
| to your NAMESPACE file.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From brian at braverock.com  Mon Jan 30 17:52:12 2017
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 30 Jan 2017 10:52:12 -0600
Subject: [R-pkg-devel]
 =?utf-8?q?no_visible_global_function_definition_for?=
 =?utf-8?b?IOKAmHBhcuKAmQ==?=
In-Reply-To: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
References: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
Message-ID: <1485795132.3192.3.camel@braverock.com>

The error you reference below is pretty clear, I think.
You need to add imports for all the functions you're using from other
packages.??
See: https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Speci
fying-imports-and-exports
Regards,
Brian


On Mon, 2017-01-30 at 10:39 -0600, Cathy Lee Gierke wrote:
> Yes, that seemed to get rid of the NOTE....but it doesn't seem to
> make much difference other than that. ?i.e., it seems to process the
> same using CATkit vs?CATkit_2.06.tar.gz!
> 
> Here is the main error that I am getting.? I just upgraded to the
> latest R version, fyi.
> 
> Everything was fine, a few minor warnings...now this.? Description
> and namespace are proper.? These pkgs should all be part of the R
> base, aren't they? Anyone know why I should get these errors??
> Thanks!
> 
> * checking R code for possible problems ... NOTE
> Actogram: no visible global function definition for ?par?
> Actogram: no visible global function definition for ?barplot?
> Actogram: no visible global function definition for ?box?
> Actogram: no visible global function definition for ?text?
> Actogram: no visible global function definition for ?mtext?
> Actogram: no visible binding for global variable ?end?
> AutoCorr: no visible global function definition for ?par?
> AutoCorr: no visible global function definition for ?layout?
> AutoCorr: no visible global function definition for ?acf?
> AutoCorr: no visible global function definition for ?abline?
> AutoCorr: no visible global function definition for ?title?
> AutoCorr: no visible global function definition for ?mtext?
> AutoCorr: no visible global function definition for ?var?
> AutoCorr: no visible binding for global variable ?end?
> CATCosinor: no visible global function definition for ?par?
> CATCosinor: no visible global function definition for ?pdf?
> CATCosinor: no visible global function definition for ?jpeg?
> CATCosinor: no visible global function definition for ?png?
> CATCosinor: no visible global function definition for ?tiff?
> ......... A zillion more for every function I have......
> periCosinor: no visible global function definition for ?par?
> periCosinor: no visible global function definition for ?fft?
> Undefined global functions or variables:
> ? TukeyHSD abline acf aov as.raster axis barplot box boxplot ccf
> ? coefficients dev.cur dev.off drop1 end fft gray heat.colors image
> ? jpeg layout legend lines median model.tables mtext na.action
> na.omit
> ? palette par pdf pf plot plot.new png points rainbow rasterImage
> ? read.table str strwidth tail terrain.colors text tiff title ts var
> ? write.table
> Consider adding
> ? importFrom("grDevices", "as.raster", "dev.cur", "dev.off", "gray",
> ?? ? ? ? ? ? "heat.colors", "jpeg", "palette", "pdf", "png",
> "rainbow",
> ?? ? ? ? ? ? "terrain.colors", "tiff")
> ? importFrom("graphics", "abline", "axis", "barplot", "box",
> "boxplot",
> ?? ? ? ? ? ? "image", "layout", "legend", "lines", "mtext", "par",
> ?? ? ? ? ? ? "plot", "plot.new", "points", "rasterImage", "strwidth",
> ?? ? ? ? ? ? "text", "title")
> ? importFrom("stats", "TukeyHSD", "acf", "aov", "ccf",
> "coefficients",
> ?? ? ? ? ? ? "drop1", "end", "fft", "median", "model.tables",
> ?? ? ? ? ? ? "na.action", "na.omit", "pf", "ts", "var")
> ? importFrom("utils", "read.table", "str", "tail", "write.table")
> to your NAMESPACE file.
> 
> Cathy Lee Gierke? ? ??
> ?Darkness cannot drive out darkness: only light can do that. Hate
> cannot drive out hate: only love can do that.??
> 
> ?The arc of the moral universe is long, but it bends towards
> justice.?
> ?Nothing in the world is more dangerous than sincere ignorance and
> conscientious stupidity.??
> ?Never forget that everything Hitler did in Germany was legal.? ??
> ?Forgiveness is not an occasional act, it is a constant attitude.??
> ?Injustice anywhere is a threat to justice everywhere.? ?
> 
> ??
> ? ?
> ????Martin Luther King Jr.
> 
> 
> 
> On Mon, Jan 30, 2017 at 10:05 AM, Brian G. Peterson <brian at braverock.
> com> wrote:
> > On Mon, 2017-01-30 at 09:45 -0600, Cathy Lee Gierke wrote:
> > 
> > > ?building ?CATkit_2.06.tar.gz?
> > 
> > 
> > 
> > R CMD build creates a tarball
> > 
> > 
> > 
> > > x-134-84-0-217:CATkit user$ *R CMD check CATkit*
> > 
> > 
> > 
> > but you are checknig the directory, not the tarball.
> > 
> > 
> > 
> > do
> > 
> > 
> > 
> > R CMD check CATkit_2.06.tar.gz
> > 
> > 
> > 
> > instead.
> > 
> > 
> > 
> > Regards,
> > 
> > 
> > 
> > Brian
> > 
> > 
--?
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock

	[[alternative HTML version deleted]]


From leegi001 at umn.edu  Mon Jan 30 18:04:59 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Mon, 30 Jan 2017 11:04:59 -0600
Subject: [R-pkg-devel]
	=?utf-8?q?no_visible_global_function_definition_for?=
	=?utf-8?b?IOKAmHBhcuKAmQ==?=
In-Reply-To: <1485795132.3192.3.camel@braverock.com>
References: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
	<1485795132.3192.3.camel@braverock.com>
Message-ID: <CAOeg=_9AtDMjUWcKmttZJp_zfC_cFs0QsKxaDdM7sQSaRrwnMA@mail.gmail.com>

That is the obvious solution, but it doesn't seem correct:  I have pdf
included in the description, and namespace files, yet it is being called
out.  Additionally, aren't most of these pkgs in the packages included by
default?

And up until yesterday, I didn't have any of these problems.  I've been
compiling and running this for several years.  But now I want to release to
CRAN, so I've been fixing minor issues....and suddenly this mass of Notes.

Thank you,

Cathy Lee Gierke


*?Darkness cannot drive out darkness: only light can do that. Hate cannot
drive out hate: only love can do that.? *
*?The arc of the moral universe is long, but it bends towards justice.?*
*?Nothing in the world is more dangerous than sincere ignorance and
conscientious stupidity.? *
*?Never forget that everything Hitler did in Germany was legal.?   *
*?Forgiveness is not an occasional act, it is a constant attitude.? *
*?Injustice anywhere is a threat to justice everywhere.?  *

? Martin Luther King Jr.

<http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>

On Mon, Jan 30, 2017 at 10:52 AM, Brian G. Peterson <brian at braverock.com>
wrote:

> The error you reference below is pretty clear, I think.
>
> You need to add imports for all the functions you're using from other
> packages.
>
> See: https://cran.r-project.org/doc/manuals/r-release/R-exts.
> html#Specifying-imports-and-exports
>
> Regards,
>
> Brian
>
>
> --
> Brian G. Petersonhttp://braverock.com/brian/
> Ph: 773-459-4973 <(773)%20459-4973>
> IM: bgpbraverock
>
>
> On Mon, 2017-01-30 at 10:39 -0600, Cathy Lee Gierke wrote:
>
> Yes, that seemed to get rid of the NOTE....but it doesn't seem to make
> much difference other than that.  i.e., it seems to process the same using
> CATkit vs CATkit_2.06.tar.gz!
>
> Here is the main error that I am getting.  I just upgraded to the latest R
> version, fyi.
>
> Everything was fine, a few minor warnings...now this.  Description and
> namespace are proper.  These pkgs should all be part of the R base, aren't
> they? Anyone know why I should get these errors?  Thanks!
>
> * checking R code for possible problems ... NOTE
>
> Actogram: no visible global function definition for ?par?
>
> Actogram: no visible global function definition for ?barplot?
>
> Actogram: no visible global function definition for ?box?
>
> Actogram: no visible global function definition for ?text?
>
> Actogram: no visible global function definition for ?mtext?
>
> Actogram: no visible binding for global variable ?end?
>
> AutoCorr: no visible global function definition for ?par?
>
> AutoCorr: no visible global function definition for ?layout?
>
> AutoCorr: no visible global function definition for ?acf?
>
> AutoCorr: no visible global function definition for ?abline?
>
> AutoCorr: no visible global function definition for ?title?
>
> AutoCorr: no visible global function definition for ?mtext?
>
> AutoCorr: no visible global function definition for ?var?
>
> AutoCorr: no visible binding for global variable ?end?
>
> CATCosinor: no visible global function definition for ?par?
>
> CATCosinor: no visible global function definition for ?pdf?
>
> CATCosinor: no visible global function definition for ?jpeg?
>
> CATCosinor: no visible global function definition for ?png?
>
> CATCosinor: no visible global function definition for ?tiff?
>
> ......... A zillion more for every function I have......
>
> periCosinor: no visible global function definition for ?par?
>
> periCosinor: no visible global function definition for ?fft?
>
> Undefined global functions or variables:
>
>   TukeyHSD abline acf aov as.raster axis barplot box boxplot ccf
>
>   coefficients dev.cur dev.off drop1 end fft gray heat.colors image
>
>   jpeg layout legend lines median model.tables mtext na.action na.omit
>
>   palette par pdf pf plot plot.new png points rainbow rasterImage
>
>   read.table str strwidth tail terrain.colors text tiff title ts var
>
>   write.table
>
> Consider adding
>
>   importFrom("grDevices", "as.raster", "dev.cur", "dev.off", "gray",
>
>              "heat.colors", "jpeg", "palette", "pdf", "png", "rainbow",
>
>              "terrain.colors", "tiff")
>
>   importFrom("graphics", "abline", "axis", "barplot", "box", "boxplot",
>
>              "image", "layout", "legend", "lines", "mtext", "par",
>
>              "plot", "plot.new", "points", "rasterImage", "strwidth",
>
>              "text", "title")
>
>   importFrom("stats", "TukeyHSD", "acf", "aov", "ccf", "coefficients",
>
>              "drop1", "end", "fft", "median", "model.tables",
>
>              "na.action", "na.omit", "pf", "ts", "var")
>
>   importFrom("utils", "read.table", "str", "tail", "write.table")
>
> to your NAMESPACE file.
>
> Cathy Lee Gierke
>
>
> *?Darkness cannot drive out darkness: only light can do that. Hate cannot
> drive out hate: only love can do that.? *
> *?The arc of the moral universe is long, but it bends towards justice.?*
> *?Nothing in the world is more dangerous than sincere ignorance and
> conscientious stupidity.? *
> *?Never forget that everything Hitler did in Germany was legal.?   *
> *?Forgiveness is not an occasional act, it is a constant attitude.? *
> *?Injustice anywhere is a threat to justice everywhere.?  *
>
> ? Martin Luther King Jr.
>
> <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
>
> On Mon, Jan 30, 2017 at 10:05 AM, Brian G. Peterson <brian at braverock.com>
> wrote:
>
> On Mon, 2017-01-30 at 09:45 -0600, Cathy Lee Gierke wrote:
> >  building ?CATkit_2.06.tar.gz?
>
> R CMD build creates a tarball
>
> > x-134-84-0-217:CATkit user$ *R CMD check CATkit*
>
> but you are checknig the directory, not the tarball.
>
> do
>
> R CMD check CATkit_2.06.tar.gz
>
> instead.
>
> Regards,
>
> Brian
>
>
>

	[[alternative HTML version deleted]]


From brian at braverock.com  Mon Jan 30 18:21:21 2017
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 30 Jan 2017 11:21:21 -0600
Subject: [R-pkg-devel]
 =?utf-8?q?no_visible_global_function_definition_for?=
 =?utf-8?b?IOKAmHBhcuKAmQ==?=
In-Reply-To: <CAOeg=_9AtDMjUWcKmttZJp_zfC_cFs0QsKxaDdM7sQSaRrwnMA@mail.gmail.com>
References: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
	<1485795132.3192.3.camel@braverock.com>
	<CAOeg=_9AtDMjUWcKmttZJp_zfC_cFs0QsKxaDdM7sQSaRrwnMA@mail.gmail.com>
Message-ID: <1485796881.3192.4.camel@braverock.com>

See the link in my email below.??It says:
"Packages implicitly import the base namespace. Variables exported from
other packages with namespaces need to be imported explicitly using the
directives?import?and?importFrom."

Regards,

Brian

On Mon, 2017-01-30 at 11:04 -0600, Cathy Lee Gierke wrote:
> That is the obvious solution, but it doesn't seem correct: ?I have
> pdf included in the description, and namespace files, yet it is being
> called out.? Additionally, aren't most of these pkgs in the packages
> included by default?
> 
> And up until yesterday, I didn't have any of these problems.? I've
> been compiling and running this for several years.? But now I want to
> release to CRAN, so I've been fixing minor issues....and suddenly
> this mass of Notes. ?
> 
> Thank you,
> 
> Cathy Lee Gierke
> ? ? ??
> ?Darkness cannot drive out darkness: only light can do that. Hate
> cannot drive out hate: only love can do that.??
> 
> ?The arc of the moral universe is long, but it bends towards
> justice.?
> ?Nothing in the world is more dangerous than sincere ignorance and
> conscientious stupidity.??
> ?Never forget that everything Hitler did in Germany was legal.? ??
> ?Forgiveness is not an occasional act, it is a constant attitude.??
> ?Injustice anywhere is a threat to justice everywhere.? ?
> 
> ? Martin Luther King Jr.
> 
> 
> On Mon, Jan 30, 2017 at 10:52 AM, Brian G. Peterson <brian at braverock.
> com> wrote:
> > The error you reference below is pretty clear, I think.
> > 
> > You need to add imports for all the functions you're using from
> > other packages.?
> > 
> > See: https://cran.r-project.org/doc/manuals/r-release/R-exts.html#S
> > pecifying-imports-and-exports
> > 
> > Regards,
> > 
> > Brian
> > 
> > 
> > --?
> > Brian G. Peterson
> > http://braverock.com/brian/
> > Ph: 773-459-4973
> > IM: bgpbraverock
> > 
> > On Mon, 2017-01-30 at 10:39 -0600, Cathy Lee Gierke wrote:
> > > Yes, that seemed to get rid of the NOTE....but it doesn't seem to
> > > make much difference other than that. ?i.e., it seems to process
> > > the same using CATkit vs?CATkit_2.06.tar.gz!
> > > 
> > > Here is the main error that I am getting.? I just upgraded to the
> > > latest R version, fyi.
> > > 
> > > Everything was fine, a few minor warnings...now this.?
> > > Description and namespace are proper.? These pkgs should all be
> > > part of the R base, aren't they? Anyone know why I should get
> > > these errors?? Thanks!
> > > 
> > > * checking R code for possible problems ... NOTE
> > > Actogram: no visible global function definition for ?par?
> > > Actogram: no visible global function definition for ?barplot?
> > > Actogram: no visible global function definition for ?box?
> > > Actogram: no visible global function definition for ?text?
> > > Actogram: no visible global function definition for ?mtext?
> > > Actogram: no visible binding for global variable ?end?
> > > AutoCorr: no visible global function definition for ?par?
> > > AutoCorr: no visible global function definition for ?layout?
> > > AutoCorr: no visible global function definition for ?acf?
> > > AutoCorr: no visible global function definition for ?abline?
> > > AutoCorr: no visible global function definition for ?title?
> > > AutoCorr: no visible global function definition for ?mtext?
> > > AutoCorr: no visible global function definition for ?var?
> > > AutoCorr: no visible binding for global variable ?end?
> > > CATCosinor: no visible global function definition for ?par?
> > > CATCosinor: no visible global function definition for ?pdf?
> > > CATCosinor: no visible global function definition for ?jpeg?
> > > CATCosinor: no visible global function definition for ?png?
> > > CATCosinor: no visible global function definition for ?tiff?
> > > ......... A zillion more for every function I have......
> > > periCosinor: no visible global function definition for ?par?
> > > periCosinor: no visible global function definition for ?fft?
> > > Undefined global functions or variables:
> > > ? TukeyHSD abline acf aov as.raster axis barplot box boxplot ccf
> > > ? coefficients dev.cur dev.off drop1 end fft gray heat.colors
> > > image
> > > ? jpeg layout legend lines median model.tables mtext na.action
> > > na.omit
> > > ? palette par pdf pf plot plot.new png points rainbow rasterImage
> > > ? read.table str strwidth tail terrain.colors text tiff title ts
> > > var
> > > ? write.table
> > > Consider adding
> > > ? importFrom("grDevices", "as.raster", "dev.cur", "dev.off",
> > > "gray",
> > > ?? ? ? ? ? ? "heat.colors", "jpeg", "palette", "pdf", "png",
> > > "rainbow",
> > > ?? ? ? ? ? ? "terrain.colors", "tiff")
> > > ? importFrom("graphics", "abline", "axis", "barplot", "box",
> > > "boxplot",
> > > ?? ? ? ? ? ? "image", "layout", "legend", "lines", "mtext",
> > > "par",
> > > ?? ? ? ? ? ? "plot", "plot.new", "points", "rasterImage",
> > > "strwidth",
> > > ?? ? ? ? ? ? "text", "title")
> > > ? importFrom("stats", "TukeyHSD", "acf", "aov", "ccf",
> > > "coefficients",
> > > ?? ? ? ? ? ? "drop1", "end", "fft", "median", "model.tables",
> > > ?? ? ? ? ? ? "na.action", "na.omit", "pf", "ts", "var")
> > > ? importFrom("utils", "read.table", "str", "tail", "write.table")
> > > to your NAMESPACE file.
> > > 
> > > 
> > > Cathy Lee Gierke
> > > ? ? ??
> > > ?Darkness cannot drive out darkness: only light can do that. Hate
> > > cannot drive out hate: only love can do that.??
> > > 
> > > ?The arc of the moral universe is long, but it bends towards
> > > justice.?
> > > ?Nothing in the world is more dangerous than sincere ignorance
> > > and conscientious stupidity.??
> > > ?Never forget that everything Hitler did in Germany was legal.?
> > > ??
> > > ?Forgiveness is not an occasional act, it is a constant
> > > attitude.??
> > > ?Injustice anywhere is a threat to justice everywhere.? ?
> > > 
> > > ? Martin Luther King Jr.
> > > 
> > > 
> > > On Mon, Jan 30, 2017 at 10:05 AM, Brian G. Peterson <brian at braver
> > > ock.com> wrote:
> > > > On Mon, 2017-01-30 at 09:45 -0600, Cathy Lee Gierke wrote:
> > > > > ?building ?CATkit_2.06.tar.gz?
> > > > 
> > > > R CMD build creates a tarball
> > > > 
> > > > > x-134-84-0-217:CATkit user$ *R CMD check CATkit*
> > > > 
> > > > but you are checknig the directory, not the tarball.
> > > > 
> > > > do
> > > > 
> > > > R CMD check CATkit_2.06.tar.gz
> > > > 
> > > > instead.
> > > > 
> > > > Regards,
> > > > 
> > > > Brian
> > > >


From kasperdanielhansen at gmail.com  Mon Jan 30 18:53:55 2017
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Mon, 30 Jan 2017 12:53:55 -0500
Subject: [R-pkg-devel]
	=?utf-8?q?no_visible_global_function_definition_for?=
	=?utf-8?b?IOKAmHBhcuKAmQ==?=
In-Reply-To: <CAOeg=_9AtDMjUWcKmttZJp_zfC_cFs0QsKxaDdM7sQSaRrwnMA@mail.gmail.com>
References: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
	<1485795132.3192.3.camel@braverock.com>
	<CAOeg=_9AtDMjUWcKmttZJp_zfC_cFs0QsKxaDdM7sQSaRrwnMA@mail.gmail.com>
Message-ID: <CAC2h7uvv0aCXrkN1LMZxL5Zn2C0ChQ0KgH8=5yUUuG3KKsN02g@mail.gmail.com>

On Mon, Jan 30, 2017 at 12:04 PM, Cathy Lee Gierke <leegi001 at umn.edu> wrote:

> That is the obvious solution, but it doesn't seem correct:  I have pdf
> included in the description, and namespace files, yet it is being called
> out.  Additionally, aren't most of these pkgs in the packages included by
> default?
>

No, they are not. Read the documentation and see the error

And up until yesterday, I didn't have any of these problems.  I've been
> compiling and running this for several years.  But now I want to release to
> CRAN, so I've been fixing minor issues....and suddenly this mass of Notes.
>

I have no idea what you did previously to ignore this. But the
behaviour/error you see is always caused by an incomplete NAMESPACE; its
very common.

Perhaps follow the advice from all the other replies.

Best,
Kasper



> Thank you,
>
> Cathy Lee Gierke
>
>
> *?Darkness cannot drive out darkness: only light can do that. Hate cannot
> drive out hate: only love can do that.? *
> *?The arc of the moral universe is long, but it bends towards justice.?*
> *?Nothing in the world is more dangerous than sincere ignorance and
> conscientious stupidity.? *
> *?Never forget that everything Hitler did in Germany was legal.?   *
> *?Forgiveness is not an occasional act, it is a constant attitude.? *
> *?Injustice anywhere is a threat to justice everywhere.?  *
>
> ? Martin Luther King Jr.
>
> <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
>
> On Mon, Jan 30, 2017 at 10:52 AM, Brian G. Peterson <brian at braverock.com>
> wrote:
>
> > The error you reference below is pretty clear, I think.
> >
> > You need to add imports for all the functions you're using from other
> > packages.
> >
> > See: https://cran.r-project.org/doc/manuals/r-release/R-exts.
> > html#Specifying-imports-and-exports
> >
> > Regards,
> >
> > Brian
> >
> >
> > --
> > Brian G. Petersonhttp://braverock.com/brian/
> > Ph: 773-459-4973 <(773)%20459-4973>
> > IM: bgpbraverock
> >
> >
> > On Mon, 2017-01-30 at 10:39 -0600, Cathy Lee Gierke wrote:
> >
> > Yes, that seemed to get rid of the NOTE....but it doesn't seem to make
> > much difference other than that.  i.e., it seems to process the same
> using
> > CATkit vs CATkit_2.06.tar.gz!
> >
> > Here is the main error that I am getting.  I just upgraded to the latest
> R
> > version, fyi.
> >
> > Everything was fine, a few minor warnings...now this.  Description and
> > namespace are proper.  These pkgs should all be part of the R base,
> aren't
> > they? Anyone know why I should get these errors?  Thanks!
> >
> > * checking R code for possible problems ... NOTE
> >
> > Actogram: no visible global function definition for ?par?
> >
> > Actogram: no visible global function definition for ?barplot?
> >
> > Actogram: no visible global function definition for ?box?
> >
> > Actogram: no visible global function definition for ?text?
> >
> > Actogram: no visible global function definition for ?mtext?
> >
> > Actogram: no visible binding for global variable ?end?
> >
> > AutoCorr: no visible global function definition for ?par?
> >
> > AutoCorr: no visible global function definition for ?layout?
> >
> > AutoCorr: no visible global function definition for ?acf?
> >
> > AutoCorr: no visible global function definition for ?abline?
> >
> > AutoCorr: no visible global function definition for ?title?
> >
> > AutoCorr: no visible global function definition for ?mtext?
> >
> > AutoCorr: no visible global function definition for ?var?
> >
> > AutoCorr: no visible binding for global variable ?end?
> >
> > CATCosinor: no visible global function definition for ?par?
> >
> > CATCosinor: no visible global function definition for ?pdf?
> >
> > CATCosinor: no visible global function definition for ?jpeg?
> >
> > CATCosinor: no visible global function definition for ?png?
> >
> > CATCosinor: no visible global function definition for ?tiff?
> >
> > ......... A zillion more for every function I have......
> >
> > periCosinor: no visible global function definition for ?par?
> >
> > periCosinor: no visible global function definition for ?fft?
> >
> > Undefined global functions or variables:
> >
> >   TukeyHSD abline acf aov as.raster axis barplot box boxplot ccf
> >
> >   coefficients dev.cur dev.off drop1 end fft gray heat.colors image
> >
> >   jpeg layout legend lines median model.tables mtext na.action na.omit
> >
> >   palette par pdf pf plot plot.new png points rainbow rasterImage
> >
> >   read.table str strwidth tail terrain.colors text tiff title ts var
> >
> >   write.table
> >
> > Consider adding
> >
> >   importFrom("grDevices", "as.raster", "dev.cur", "dev.off", "gray",
> >
> >              "heat.colors", "jpeg", "palette", "pdf", "png", "rainbow",
> >
> >              "terrain.colors", "tiff")
> >
> >   importFrom("graphics", "abline", "axis", "barplot", "box", "boxplot",
> >
> >              "image", "layout", "legend", "lines", "mtext", "par",
> >
> >              "plot", "plot.new", "points", "rasterImage", "strwidth",
> >
> >              "text", "title")
> >
> >   importFrom("stats", "TukeyHSD", "acf", "aov", "ccf", "coefficients",
> >
> >              "drop1", "end", "fft", "median", "model.tables",
> >
> >              "na.action", "na.omit", "pf", "ts", "var")
> >
> >   importFrom("utils", "read.table", "str", "tail", "write.table")
> >
> > to your NAMESPACE file.
> >
> > Cathy Lee Gierke
> >
> >
> > *?Darkness cannot drive out darkness: only light can do that. Hate cannot
> > drive out hate: only love can do that.? *
> > *?The arc of the moral universe is long, but it bends towards justice.?*
> > *?Nothing in the world is more dangerous than sincere ignorance and
> > conscientious stupidity.? *
> > *?Never forget that everything Hitler did in Germany was legal.?   *
> > *?Forgiveness is not an occasional act, it is a constant attitude.? *
> > *?Injustice anywhere is a threat to justice everywhere.?  *
> >
> > ? Martin Luther King Jr.
> >
> > <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
> >
> > On Mon, Jan 30, 2017 at 10:05 AM, Brian G. Peterson <brian at braverock.com
> >
> > wrote:
> >
> > On Mon, 2017-01-30 at 09:45 -0600, Cathy Lee Gierke wrote:
> > >  building ?CATkit_2.06.tar.gz?
> >
> > R CMD build creates a tarball
> >
> > > x-134-84-0-217:CATkit user$ *R CMD check CATkit*
> >
> > but you are checknig the directory, not the tarball.
> >
> > do
> >
> > R CMD check CATkit_2.06.tar.gz
> >
> > instead.
> >
> > Regards,
> >
> > Brian
> >
> >
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From kevinushey at gmail.com  Mon Jan 30 18:58:05 2017
From: kevinushey at gmail.com (Kevin Ushey)
Date: Mon, 30 Jan 2017 09:58:05 -0800
Subject: [R-pkg-devel]
	=?utf-8?q?no_visible_global_function_definition_for?=
	=?utf-8?b?IOKAmHBhcuKAmQ==?=
In-Reply-To: <1485796881.3192.4.camel@braverock.com>
References: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
	<1485795132.3192.3.camel@braverock.com>
	<CAOeg=_9AtDMjUWcKmttZJp_zfC_cFs0QsKxaDdM7sQSaRrwnMA@mail.gmail.com>
	<1485796881.3192.4.camel@braverock.com>
Message-ID: <CAJXgQP0+iDKq1Z1P-E3Y9NGiRv2X3YYFareK0VD9peNszjJE+w@mail.gmail.com>

Most importantly, this _is_ a recent-ish change in R CMD check. Previously,
R CMD check did not warn about missing imports from 'base' R packages (that
is, R packages distributed with R, having priority 'base'); now it
correctly does. While packages with priority 'base' are loaded by default
in most R installations, it's possible for the user to customize that
behavior, and so packages that don't import the functions they use from
these packages will break if they are detached (or their order on the
search path is changed).

The correct thing to do is indeed import any functions from any R packages
you use, base or otherwise. The simplest fix, if you don't want to
selectively import such a large range of functions, is to simply add e.g.

    import(utils)
    import(stats)
    ... etc ...

to your NAMESPACE file.

Best,
Kevin

On Mon, Jan 30, 2017 at 9:21 AM, Brian G. Peterson <brian at braverock.com>
wrote:

> See the link in my email below.  It says:
> "Packages implicitly import the base namespace. Variables exported from
> other packages with namespaces need to be imported explicitly using the
> directives import and importFrom."
>
> Regards,
>
> Brian
>
> On Mon, 2017-01-30 at 11:04 -0600, Cathy Lee Gierke wrote:
> > That is the obvious solution, but it doesn't seem correct:  I have
> > pdf included in the description, and namespace files, yet it is being
> > called out.  Additionally, aren't most of these pkgs in the packages
> > included by default?
> >
> > And up until yesterday, I didn't have any of these problems.  I've
> > been compiling and running this for several years.  But now I want to
> > release to CRAN, so I've been fixing minor issues....and suddenly
> > this mass of Notes.
> >
> > Thank you,
> >
> > Cathy Lee Gierke
> >
> > ?Darkness cannot drive out darkness: only light can do that. Hate
> > cannot drive out hate: only love can do that.?
> >
> > ?The arc of the moral universe is long, but it bends towards
> > justice.?
> > ?Nothing in the world is more dangerous than sincere ignorance and
> > conscientious stupidity.?
> > ?Never forget that everything Hitler did in Germany was legal.?
> > ?Forgiveness is not an occasional act, it is a constant attitude.?
> > ?Injustice anywhere is a threat to justice everywhere.?
> >
> > ? Martin Luther King Jr.
> >
> >
> > On Mon, Jan 30, 2017 at 10:52 AM, Brian G. Peterson <brian at braverock.
> > com> wrote:
> > > The error you reference below is pretty clear, I think.
> > >
> > > You need to add imports for all the functions you're using from
> > > other packages.
> > >
> > > See: https://cran.r-project.org/doc/manuals/r-release/R-exts.html#S
> > > pecifying-imports-and-exports
> > >
> > > Regards,
> > >
> > > Brian
> > >
> > >
> > > --
> > > Brian G. Peterson
> > > http://braverock.com/brian/
> > > Ph: 773-459-4973
> > > IM: bgpbraverock
> > >
> > > On Mon, 2017-01-30 at 10:39 -0600, Cathy Lee Gierke wrote:
> > > > Yes, that seemed to get rid of the NOTE....but it doesn't seem to
> > > > make much difference other than that.  i.e., it seems to process
> > > > the same using CATkit vs CATkit_2.06.tar.gz!
> > > >
> > > > Here is the main error that I am getting.  I just upgraded to the
> > > > latest R version, fyi.
> > > >
> > > > Everything was fine, a few minor warnings...now this.
> > > > Description and namespace are proper.  These pkgs should all be
> > > > part of the R base, aren't they? Anyone know why I should get
> > > > these errors?  Thanks!
> > > >
> > > > * checking R code for possible problems ... NOTE
> > > > Actogram: no visible global function definition for ?par?
> > > > Actogram: no visible global function definition for ?barplot?
> > > > Actogram: no visible global function definition for ?box?
> > > > Actogram: no visible global function definition for ?text?
> > > > Actogram: no visible global function definition for ?mtext?
> > > > Actogram: no visible binding for global variable ?end?
> > > > AutoCorr: no visible global function definition for ?par?
> > > > AutoCorr: no visible global function definition for ?layout?
> > > > AutoCorr: no visible global function definition for ?acf?
> > > > AutoCorr: no visible global function definition for ?abline?
> > > > AutoCorr: no visible global function definition for ?title?
> > > > AutoCorr: no visible global function definition for ?mtext?
> > > > AutoCorr: no visible global function definition for ?var?
> > > > AutoCorr: no visible binding for global variable ?end?
> > > > CATCosinor: no visible global function definition for ?par?
> > > > CATCosinor: no visible global function definition for ?pdf?
> > > > CATCosinor: no visible global function definition for ?jpeg?
> > > > CATCosinor: no visible global function definition for ?png?
> > > > CATCosinor: no visible global function definition for ?tiff?
> > > > ......... A zillion more for every function I have......
> > > > periCosinor: no visible global function definition for ?par?
> > > > periCosinor: no visible global function definition for ?fft?
> > > > Undefined global functions or variables:
> > > >   TukeyHSD abline acf aov as.raster axis barplot box boxplot ccf
> > > >   coefficients dev.cur dev.off drop1 end fft gray heat.colors
> > > > image
> > > >   jpeg layout legend lines median model.tables mtext na.action
> > > > na.omit
> > > >   palette par pdf pf plot plot.new png points rainbow rasterImage
> > > >   read.table str strwidth tail terrain.colors text tiff title ts
> > > > var
> > > >   write.table
> > > > Consider adding
> > > >   importFrom("grDevices", "as.raster", "dev.cur", "dev.off",
> > > > "gray",
> > > >              "heat.colors", "jpeg", "palette", "pdf", "png",
> > > > "rainbow",
> > > >              "terrain.colors", "tiff")
> > > >   importFrom("graphics", "abline", "axis", "barplot", "box",
> > > > "boxplot",
> > > >              "image", "layout", "legend", "lines", "mtext",
> > > > "par",
> > > >              "plot", "plot.new", "points", "rasterImage",
> > > > "strwidth",
> > > >              "text", "title")
> > > >   importFrom("stats", "TukeyHSD", "acf", "aov", "ccf",
> > > > "coefficients",
> > > >              "drop1", "end", "fft", "median", "model.tables",
> > > >              "na.action", "na.omit", "pf", "ts", "var")
> > > >   importFrom("utils", "read.table", "str", "tail", "write.table")
> > > > to your NAMESPACE file.
> > > >
> > > >
> > > > Cathy Lee Gierke
> > > >
> > > > ?Darkness cannot drive out darkness: only light can do that. Hate
> > > > cannot drive out hate: only love can do that.?
> > > >
> > > > ?The arc of the moral universe is long, but it bends towards
> > > > justice.?
> > > > ?Nothing in the world is more dangerous than sincere ignorance
> > > > and conscientious stupidity.?
> > > > ?Never forget that everything Hitler did in Germany was legal.?
> > > >
> > > > ?Forgiveness is not an occasional act, it is a constant
> > > > attitude.?
> > > > ?Injustice anywhere is a threat to justice everywhere.?
> > > >
> > > > ? Martin Luther King Jr.
> > > >
> > > >
> > > > On Mon, Jan 30, 2017 at 10:05 AM, Brian G. Peterson <brian at braver
> > > > ock.com> wrote:
> > > > > On Mon, 2017-01-30 at 09:45 -0600, Cathy Lee Gierke wrote:
> > > > > >  building ?CATkit_2.06.tar.gz?
> > > > >
> > > > > R CMD build creates a tarball
> > > > >
> > > > > > x-134-84-0-217:CATkit user$ *R CMD check CATkit*
> > > > >
> > > > > but you are checknig the directory, not the tarball.
> > > > >
> > > > > do
> > > > >
> > > > > R CMD check CATkit_2.06.tar.gz
> > > > >
> > > > > instead.
> > > > >
> > > > > Regards,
> > > > >
> > > > > Brian
> > > > >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Mon Jan 30 19:00:34 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 30 Jan 2017 13:00:34 -0500
Subject: [R-pkg-devel]
 =?utf-8?q?no_visible_global_function_definition_for?=
 =?utf-8?b?IOKAmHBhcuKAmQ==?=
In-Reply-To: <CAOeg=_9AtDMjUWcKmttZJp_zfC_cFs0QsKxaDdM7sQSaRrwnMA@mail.gmail.com>
References: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
	<1485795132.3192.3.camel@braverock.com>
	<CAOeg=_9AtDMjUWcKmttZJp_zfC_cFs0QsKxaDdM7sQSaRrwnMA@mail.gmail.com>
Message-ID: <a29fe44c-c7ae-5662-9570-581ea7a73b54@gmail.com>

On 30/01/2017 12:04 PM, Cathy Lee Gierke wrote:
> That is the obvious solution, but it doesn't seem correct:  I have pdf
> included in the description, and namespace files, yet it is being called
> out.  Additionally, aren't most of these pkgs in the packages included by
> default?
>
> And up until yesterday, I didn't have any of these problems.  I've been
> compiling and running this for several years.  But now I want to release to
> CRAN, so I've been fixing minor issues....and suddenly this mass of Notes.

For several years R would allow functions from base packages to be 
assumed to be on the search list, but it no longer does so (and hasn't 
since R 3.3.0).  This is a good thing:  if your user says library(foo), 
and the foo package happens to export a pdf() function, your package may 
end up using that one, even though you really mean grDevices::pdf().  If 
you explicitly import pdf() from grDevices, that won't happen.

Duncan Murdoch

>
> Thank you,
>
> Cathy Lee Gierke
>
>
> *?Darkness cannot drive out darkness: only light can do that. Hate cannot
> drive out hate: only love can do that.? *
> *?The arc of the moral universe is long, but it bends towards justice.?*
> *?Nothing in the world is more dangerous than sincere ignorance and
> conscientious stupidity.? *
> *?Never forget that everything Hitler did in Germany was legal.?   *
> *?Forgiveness is not an occasional act, it is a constant attitude.? *
> *?Injustice anywhere is a threat to justice everywhere.?  *
>
> ? Martin Luther King Jr.
>
> <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
>
> On Mon, Jan 30, 2017 at 10:52 AM, Brian G. Peterson <brian at braverock.com>
> wrote:
>
>> The error you reference below is pretty clear, I think.
>>
>> You need to add imports for all the functions you're using from other
>> packages.
>>
>> See: https://cran.r-project.org/doc/manuals/r-release/R-exts.
>> html#Specifying-imports-and-exports
>>
>> Regards,
>>
>> Brian
>>
>>
>> --
>> Brian G. Petersonhttp://braverock.com/brian/
>> Ph: 773-459-4973 <(773)%20459-4973>
>> IM: bgpbraverock
>>
>>
>> On Mon, 2017-01-30 at 10:39 -0600, Cathy Lee Gierke wrote:
>>
>> Yes, that seemed to get rid of the NOTE....but it doesn't seem to make
>> much difference other than that.  i.e., it seems to process the same using
>> CATkit vs CATkit_2.06.tar.gz!
>>
>> Here is the main error that I am getting.  I just upgraded to the latest R
>> version, fyi.
>>
>> Everything was fine, a few minor warnings...now this.  Description and
>> namespace are proper.  These pkgs should all be part of the R base, aren't
>> they? Anyone know why I should get these errors?  Thanks!
>>
>> * checking R code for possible problems ... NOTE
>>
>> Actogram: no visible global function definition for ?par?
>>
>> Actogram: no visible global function definition for ?barplot?
>>
>> Actogram: no visible global function definition for ?box?
>>
>> Actogram: no visible global function definition for ?text?
>>
>> Actogram: no visible global function definition for ?mtext?
>>
>> Actogram: no visible binding for global variable ?end?
>>
>> AutoCorr: no visible global function definition for ?par?
>>
>> AutoCorr: no visible global function definition for ?layout?
>>
>> AutoCorr: no visible global function definition for ?acf?
>>
>> AutoCorr: no visible global function definition for ?abline?
>>
>> AutoCorr: no visible global function definition for ?title?
>>
>> AutoCorr: no visible global function definition for ?mtext?
>>
>> AutoCorr: no visible global function definition for ?var?
>>
>> AutoCorr: no visible binding for global variable ?end?
>>
>> CATCosinor: no visible global function definition for ?par?
>>
>> CATCosinor: no visible global function definition for ?pdf?
>>
>> CATCosinor: no visible global function definition for ?jpeg?
>>
>> CATCosinor: no visible global function definition for ?png?
>>
>> CATCosinor: no visible global function definition for ?tiff?
>>
>> ......... A zillion more for every function I have......
>>
>> periCosinor: no visible global function definition for ?par?
>>
>> periCosinor: no visible global function definition for ?fft?
>>
>> Undefined global functions or variables:
>>
>>   TukeyHSD abline acf aov as.raster axis barplot box boxplot ccf
>>
>>   coefficients dev.cur dev.off drop1 end fft gray heat.colors image
>>
>>   jpeg layout legend lines median model.tables mtext na.action na.omit
>>
>>   palette par pdf pf plot plot.new png points rainbow rasterImage
>>
>>   read.table str strwidth tail terrain.colors text tiff title ts var
>>
>>   write.table
>>
>> Consider adding
>>
>>   importFrom("grDevices", "as.raster", "dev.cur", "dev.off", "gray",
>>
>>              "heat.colors", "jpeg", "palette", "pdf", "png", "rainbow",
>>
>>              "terrain.colors", "tiff")
>>
>>   importFrom("graphics", "abline", "axis", "barplot", "box", "boxplot",
>>
>>              "image", "layout", "legend", "lines", "mtext", "par",
>>
>>              "plot", "plot.new", "points", "rasterImage", "strwidth",
>>
>>              "text", "title")
>>
>>   importFrom("stats", "TukeyHSD", "acf", "aov", "ccf", "coefficients",
>>
>>              "drop1", "end", "fft", "median", "model.tables",
>>
>>              "na.action", "na.omit", "pf", "ts", "var")
>>
>>   importFrom("utils", "read.table", "str", "tail", "write.table")
>>
>> to your NAMESPACE file.
>>
>> Cathy Lee Gierke
>>
>>
>> *?Darkness cannot drive out darkness: only light can do that. Hate cannot
>> drive out hate: only love can do that.? *
>> *?The arc of the moral universe is long, but it bends towards justice.?*
>> *?Nothing in the world is more dangerous than sincere ignorance and
>> conscientious stupidity.? *
>> *?Never forget that everything Hitler did in Germany was legal.?   *
>> *?Forgiveness is not an occasional act, it is a constant attitude.? *
>> *?Injustice anywhere is a threat to justice everywhere.?  *
>>
>> ? Martin Luther King Jr.
>>
>> <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
>>
>> On Mon, Jan 30, 2017 at 10:05 AM, Brian G. Peterson <brian at braverock.com>
>> wrote:
>>
>> On Mon, 2017-01-30 at 09:45 -0600, Cathy Lee Gierke wrote:
>>>  building ?CATkit_2.06.tar.gz?
>>
>> R CMD build creates a tarball
>>
>>> x-134-84-0-217:CATkit user$ *R CMD check CATkit*
>>
>> but you are checknig the directory, not the tarball.
>>
>> do
>>
>> R CMD check CATkit_2.06.tar.gz
>>
>> instead.
>>
>> Regards,
>>
>> Brian
>>
>>
>>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From leegi001 at umn.edu  Mon Jan 30 19:01:22 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Mon, 30 Jan 2017 21:01:22 +0300
Subject: [R-pkg-devel]
 =?utf-8?q?no_visible_global_function_definition_for?=
 =?utf-8?b?IOKAmHBhcuKAmQ==?=
In-Reply-To: <CAJXgQP0+iDKq1Z1P-E3Y9NGiRv2X3YYFareK0VD9peNszjJE+w@mail.gmail.com>
References: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
	<1485795132.3192.3.camel@braverock.com>
	<CAOeg=_9AtDMjUWcKmttZJp_zfC_cFs0QsKxaDdM7sQSaRrwnMA@mail.gmail.com>
	<1485796881.3192.4.camel@braverock.com>
	<CAJXgQP0+iDKq1Z1P-E3Y9NGiRv2X3YYFareK0VD9peNszjJE+w@mail.gmail.com>
Message-ID: <DA4505EE-4738-41F4-9616-C9E9F716F3A1@umn.edu>

Thank you. That will be why I didn't see them previously. Helps my sanity ;-)

Sent from my iPhone

> On Jan 30, 2017, at 8:58 PM, Kevin Ushey <kevinushey at gmail.com> wrote:
> 
> Most importantly, this _is_ a recent-ish change in R CMD check. Previously, R CMD check did not warn about missing imports from 'base' R packages (that is, R packages distributed with R, having priority 'base'); now it correctly does. While packages with priority 'base' are loaded by default in most R installations, it's possible for the user to customize that behavior, and so packages that don't import the functions they use from these packages will break if they are detached (or their order on the search path is changed).
> 
> The correct thing to do is indeed import any functions from any R packages you use, base or otherwise. The simplest fix, if you don't want to selectively import such a large range of functions, is to simply add e.g.
> 
>     import(utils)
>     import(stats)
>     ... etc ...
> 
> to your NAMESPACE file.
> 
> Best,
> Kevin
> 
>> On Mon, Jan 30, 2017 at 9:21 AM, Brian G. Peterson <brian at braverock.com> wrote:
>> See the link in my email below.  It says:
>> "Packages implicitly import the base namespace. Variables exported from
>> other packages with namespaces need to be imported explicitly using the
>> directives import and importFrom."
>> 
>> Regards,
>> 
>> Brian
>> 
>> On Mon, 2017-01-30 at 11:04 -0600, Cathy Lee Gierke wrote:
>> > That is the obvious solution, but it doesn't seem correct:  I have
>> > pdf included in the description, and namespace files, yet it is being
>> > called out.  Additionally, aren't most of these pkgs in the packages
>> > included by default?
>> >
>> > And up until yesterday, I didn't have any of these problems.  I've
>> > been compiling and running this for several years.  But now I want to
>> > release to CRAN, so I've been fixing minor issues....and suddenly
>> > this mass of Notes.  
>> >
>> > Thank you,
>> >
>> > Cathy Lee Gierke
>> >       
>> > ?Darkness cannot drive out darkness: only light can do that. Hate
>> > cannot drive out hate: only love can do that.? 
>> >
>> > ?The arc of the moral universe is long, but it bends towards
>> > justice.?
>> > ?Nothing in the world is more dangerous than sincere ignorance and
>> > conscientious stupidity.? 
>> > ?Never forget that everything Hitler did in Germany was legal.?   
>> > ?Forgiveness is not an occasional act, it is a constant attitude.? 
>> > ?Injustice anywhere is a threat to justice everywhere.?  
>> >
>> > ? Martin Luther King Jr.
>> >
>> >
>> > On Mon, Jan 30, 2017 at 10:52 AM, Brian G. Peterson <brian at braverock.
>> > com> wrote:
>> > > The error you reference below is pretty clear, I think.
>> > >
>> > > You need to add imports for all the functions you're using from
>> > > other packages. 
>> > >
>> > > See: https://cran.r-project.org/doc/manuals/r-release/R-exts.html#S
>> > > pecifying-imports-and-exports
>> > >
>> > > Regards,
>> > >
>> > > Brian
>> > >
>> > >
>> > > -- 
>> > > Brian G. Peterson
>> > > http://braverock.com/brian/
>> > > Ph: 773-459-4973
>> > > IM: bgpbraverock
>> > >
>> > > On Mon, 2017-01-30 at 10:39 -0600, Cathy Lee Gierke wrote:
>> > > > Yes, that seemed to get rid of the NOTE....but it doesn't seem to
>> > > > make much difference other than that.  i.e., it seems to process
>> > > > the same using CATkit vs CATkit_2.06.tar.gz!
>> > > >
>> > > > Here is the main error that I am getting.  I just upgraded to the
>> > > > latest R version, fyi.
>> > > >
>> > > > Everything was fine, a few minor warnings...now this. 
>> > > > Description and namespace are proper.  These pkgs should all be
>> > > > part of the R base, aren't they? Anyone know why I should get
>> > > > these errors?  Thanks!
>> > > >
>> > > > * checking R code for possible problems ... NOTE
>> > > > Actogram: no visible global function definition for ?par?
>> > > > Actogram: no visible global function definition for ?barplot?
>> > > > Actogram: no visible global function definition for ?box?
>> > > > Actogram: no visible global function definition for ?text?
>> > > > Actogram: no visible global function definition for ?mtext?
>> > > > Actogram: no visible binding for global variable ?end?
>> > > > AutoCorr: no visible global function definition for ?par?
>> > > > AutoCorr: no visible global function definition for ?layout?
>> > > > AutoCorr: no visible global function definition for ?acf?
>> > > > AutoCorr: no visible global function definition for ?abline?
>> > > > AutoCorr: no visible global function definition for ?title?
>> > > > AutoCorr: no visible global function definition for ?mtext?
>> > > > AutoCorr: no visible global function definition for ?var?
>> > > > AutoCorr: no visible binding for global variable ?end?
>> > > > CATCosinor: no visible global function definition for ?par?
>> > > > CATCosinor: no visible global function definition for ?pdf?
>> > > > CATCosinor: no visible global function definition for ?jpeg?
>> > > > CATCosinor: no visible global function definition for ?png?
>> > > > CATCosinor: no visible global function definition for ?tiff?
>> > > > ......... A zillion more for every function I have......
>> > > > periCosinor: no visible global function definition for ?par?
>> > > > periCosinor: no visible global function definition for ?fft?
>> > > > Undefined global functions or variables:
>> > > >   TukeyHSD abline acf aov as.raster axis barplot box boxplot ccf
>> > > >   coefficients dev.cur dev.off drop1 end fft gray heat.colors
>> > > > image
>> > > >   jpeg layout legend lines median model.tables mtext na.action
>> > > > na.omit
>> > > >   palette par pdf pf plot plot.new png points rainbow rasterImage
>> > > >   read.table str strwidth tail terrain.colors text tiff title ts
>> > > > var
>> > > >   write.table
>> > > > Consider adding
>> > > >   importFrom("grDevices", "as.raster", "dev.cur", "dev.off",
>> > > > "gray",
>> > > >              "heat.colors", "jpeg", "palette", "pdf", "png",
>> > > > "rainbow",
>> > > >              "terrain.colors", "tiff")
>> > > >   importFrom("graphics", "abline", "axis", "barplot", "box",
>> > > > "boxplot",
>> > > >              "image", "layout", "legend", "lines", "mtext",
>> > > > "par",
>> > > >              "plot", "plot.new", "points", "rasterImage",
>> > > > "strwidth",
>> > > >              "text", "title")
>> > > >   importFrom("stats", "TukeyHSD", "acf", "aov", "ccf",
>> > > > "coefficients",
>> > > >              "drop1", "end", "fft", "median", "model.tables",
>> > > >              "na.action", "na.omit", "pf", "ts", "var")
>> > > >   importFrom("utils", "read.table", "str", "tail", "write.table")
>> > > > to your NAMESPACE file.
>> > > >
>> > > >
>> > > > Cathy Lee Gierke
>> > > >       
>> > > > ?Darkness cannot drive out darkness: only light can do that. Hate
>> > > > cannot drive out hate: only love can do that.? 
>> > > >
>> > > > ?The arc of the moral universe is long, but it bends towards
>> > > > justice.?
>> > > > ?Nothing in the world is more dangerous than sincere ignorance
>> > > > and conscientious stupidity.? 
>> > > > ?Never forget that everything Hitler did in Germany was legal.?
>> > > >   
>> > > > ?Forgiveness is not an occasional act, it is a constant
>> > > > attitude.? 
>> > > > ?Injustice anywhere is a threat to justice everywhere.?  
>> > > >
>> > > > ? Martin Luther King Jr.
>> > > >
>> > > >
>> > > > On Mon, Jan 30, 2017 at 10:05 AM, Brian G. Peterson <brian at braver
>> > > > ock.com> wrote:
>> > > > > On Mon, 2017-01-30 at 09:45 -0600, Cathy Lee Gierke wrote:
>> > > > > >  building ?CATkit_2.06.tar.gz?
>> > > > >
>> > > > > R CMD build creates a tarball
>> > > > >
>> > > > > > x-134-84-0-217:CATkit user$ *R CMD check CATkit*
>> > > > >
>> > > > > but you are checknig the directory, not the tarball.
>> > > > >
>> > > > > do
>> > > > >
>> > > > > R CMD check CATkit_2.06.tar.gz
>> > > > >
>> > > > > instead.
>> > > > >
>> > > > > Regards,
>> > > > >
>> > > > > Brian
>> > > > >
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 

	[[alternative HTML version deleted]]


From d.scott at auckland.ac.nz  Tue Jan 31 02:59:24 2017
From: d.scott at auckland.ac.nz (David Scott)
Date: Tue, 31 Jan 2017 14:59:24 +1300
Subject: [R-pkg-devel] Encoding problem
In-Reply-To: <CAJuCY5xy33jfMN-g=N=SH8-fdPcBinMv46duiqSFhBiZXSwoZg@mail.gmail.com>
References: <228e3a6b-a3bd-fabe-60e7-7ada0ea87414@auckland.ac.nz>
	<CAJuCY5xy33jfMN-g=N=SH8-fdPcBinMv46duiqSFhBiZXSwoZg@mail.gmail.com>
Message-ID: <29e8d074-122b-db69-5959-0dc27c4a7773@auckland.ac.nz>

Thanks Thierry, that indeed was the problem.

I am not sure who to advise to correct the documentation in Writing R 
Extensions though because I was following the instructions there:

"... the encoding may be declared using a comment like

%!\VignetteEncoding{UTF-8}

If the encoding is UTF-8, this can also be declared using the declaration

%!\SweaveUTF8"


The same instruction appears in all the versions of WRE that I checked, 
HTML and PDF, R-release, R-patched and R-devel.

I have copied in Duncan and Martin in the expectation they might ensure 
a correction.

David

On 31/01/2017 4:10 a.m., Thierry Onkelinx wrote:
> Dear David,
>
> Have you tried removing the exclamation mark in 
> %!\VignetteEncoding{UTF-8}? I think it should be %\VignetteEncoding{UTF-8}
>
> Best regards,
>
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature 
> and Forest
> team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> Kliniekstraat 25
> 1070 Anderlecht
> Belgium
>
> To call in the statistician after the experiment is done may be no 
> more than asking him to perform a post-mortem examination: he may be 
> able to say what the experiment died of. ~ Sir Ronald Aylmer Fisher
> The plural of anecdote is not data. ~ Roger Brinner
> The combination of some data and an aching desire for an answer does 
> not ensure that a reasonable answer can be extracted from a given body 
> of data. ~ John Tukey
>
> 2017-01-29 13:40 GMT+01:00 David Scott <d.scott at auckland.ac.nz 
> <mailto:d.scott at auckland.ac.nz>>:
>
>     I am trying to add a vignette to xtable showing how to incorporate
>     some Chinese characters following an enquiry from a user.
>
>     I can create the vignette satisfactorily just processing the knitr
>     file normally, with the resulting pdf displaying Chinese
>     characters in the R code and also as headings when I produce a
>     table. However when I try to build the package with the vignette
>     included, I get:
>
>     * creating vignettes ...Warning: running command
>     '"C:/PROGRA~1/R/R-33~1.2/bin/x64/Rscript" --vanilla
>      ERROR
>     Error: Vignette 'ChineseCharacters.Rnw' is non-ASCII but has no
>     declared encoding
>     Execution halted
>     make: *** [build] Error 1
>
>     I updated R to 3.3.2 and Rtools to 33 before running the build.
>
>     The vignette starts as follows:
>
>     %\VignetteIndexEntry{xtable Chinese Characters}
>     %\VignetteDepends{xtable}
>     %\VignetteKeywords{LaTeX, HTML, table}
>     %\VignettePackage{xtable}
>     % !Rnw weave = knitr
>     % \VignetteEngine{knitr::knitr}
>     %!\VignetteEncoding{UTF-8}
>     %**************************************************************************
>     \documentclass{ctexart}
>     \usepackage{longtable}
>     \usepackage{booktabs}
>     \usepackage{array}
>     \usepackage{hyperref}
>     \usepackage{inputenx}
>
>     The section of the file which is not ASCII is:
>
>     <<preparedata>>=
>     ### Prepare data
>     library(knitr)
>     library(xtable)
>
>     tbl <- data.frame(positivePairs = 0, negativePairs = 0,
>                       avePositiveSpread = NA,
>                       aveNegativeSpread = NA,
>                       PnL = 435, sumPnL = 144358.7)
>     names(tbl) <- c("????????", "????????", "????????????????",
>                     "????????????????", "????????", "????????")
>     @
>
>     I am a bit of a novice at encodings, and know nothing about
>     Chinese characters so any advice is welcome.
>
>     David Scott
>
>
>
>     -- 
>     _________________________________________________________________
>     David Scott     Department of Statistics
>                     The University of Auckland, PB 92019
>                     Auckland 1142,    NEW ZEALAND
>     Phone: +64 9 923 5055 <tel:%2B64%209%20923%205055>, or +64 9 373
>     7599 ext 85055 <tel:%2B64%209%20373%207599%20ext%2085055>
>     Email: d.scott at auckland.ac.nz <mailto:d.scott at auckland.ac.nz>,
>     Fax: +64 9 373 7018 <tel:%2B64%209%20373%207018>
>
>     Volunteer Arena Manager:
>     Orienteering Sprint Final at University of Auckland
>     World Masters Games 2017
>
>     ______________________________________________
>     R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>
>

-- 
_________________________________________________________________
David Scott	Department of Statistics
		The University of Auckland, PB 92019
		Auckland 1142,    NEW ZEALAND
Phone: +64 9 923 5055, or +64 9 373 7599 ext 85055
Email:	d.scott at auckland.ac.nz,  Fax: +64 9 373 7018

Volunteer Arena Manager:
Orienteering Sprint Final at University of Auckland
World Masters Games 2017



	[[alternative HTML version deleted]]


From edd at debian.org  Tue Jan 31 03:50:19 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 30 Jan 2017 20:50:19 -0600
Subject: [R-pkg-devel]
	=?utf-8?q?no_visible_global_function_definition_for?=
	=?utf-8?b?IOKAmHBhcuKAmQ==?=
In-Reply-To: <CAJXgQP0+iDKq1Z1P-E3Y9NGiRv2X3YYFareK0VD9peNszjJE+w@mail.gmail.com>
References: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
	<1485795132.3192.3.camel@braverock.com>
	<CAOeg=_9AtDMjUWcKmttZJp_zfC_cFs0QsKxaDdM7sQSaRrwnMA@mail.gmail.com>
	<1485796881.3192.4.camel@braverock.com>
	<CAJXgQP0+iDKq1Z1P-E3Y9NGiRv2X3YYFareK0VD9peNszjJE+w@mail.gmail.com>
Message-ID: <22671.64363.579181.74264@max.nulle.part>


On 30 January 2017 at 09:58, Kevin Ushey wrote:
| The correct thing to do is indeed import any functions from any R packages
| you use, base or otherwise. The simplest fix, if you don't want to
| selectively import such a large range of functions, is to simply add e.g.
| 
|     import(utils)
|     import(stats)
|     ... etc ...
| 
| to your NAMESPACE file.

Or do what R CMD check suggested and import the ones used, rather than all.

Which is what I had quoted earlier:

| Consider adding
| 
|   importFrom("grDevices", "as.raster", "dev.cur", "dev.off", "gray",
|              "heat.colors", "jpeg", "palette", "pdf", "png", "rainbow",
|              "terrain.colors", "tiff")
|   importFrom("graphics", "abline", "axis", "barplot", "box", "boxplot",
|              "image", "layout", "legend", "lines", "mtext", "par",
|              "plot", "plot.new", "points", "rasterImage", "strwidth",
|              "text", "title")
|   importFrom("stats", "TukeyHSD", "acf", "aov", "ccf", "coefficients",
|              "drop1", "end", "fft", "median", "model.tables",
|              "na.action", "na.omit", "pf", "ts", "var")
|   importFrom("utils", "read.table", "str", "tail", "write.table")
| 
| to your NAMESPACE file.

I find this preferable and quite appreciate that R CMD check provides it.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From maechler at stat.math.ethz.ch  Tue Jan 31 09:17:47 2017
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 31 Jan 2017 09:17:47 +0100
Subject: [R-pkg-devel]
	=?utf-8?q?no_visible_global_function_definition_for?=
	=?utf-8?b?IOKAmHBhcuKAmQ==?=
In-Reply-To: <22671.64363.579181.74264@max.nulle.part>
References: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
	<1485795132.3192.3.camel@braverock.com>
	<CAOeg=_9AtDMjUWcKmttZJp_zfC_cFs0QsKxaDdM7sQSaRrwnMA@mail.gmail.com>
	<1485796881.3192.4.camel@braverock.com>
	<CAJXgQP0+iDKq1Z1P-E3Y9NGiRv2X3YYFareK0VD9peNszjJE+w@mail.gmail.com>
	<22671.64363.579181.74264@max.nulle.part>
Message-ID: <22672.18475.360132.463433@stat.math.ethz.ch>

>>>>> Dirk Eddelbuettel <edd at debian.org>
>>>>>     on Mon, 30 Jan 2017 20:50:19 -0600 writes:

    > On 30 January 2017 at 09:58, Kevin Ushey wrote:
    > | The correct thing to do is indeed import any functions from any R packages
    > | you use, base or otherwise. The simplest fix, if you don't want to
    > | selectively import such a large range of functions, is to simply add e.g.
    > | 
    > |     import(utils)
    > |     import(stats)
    > |     ... etc ...
    > | 
    > | to your NAMESPACE file.

    > Or do what R CMD check suggested and import the ones used, rather than all.

    > Which is what I had quoted earlier:

    > | Consider adding
    > | 
    > |   importFrom("grDevices", "as.raster", "dev.cur", "dev.off", "gray",
    > |              "heat.colors", "jpeg", "palette", "pdf", "png", "rainbow",
    > |              "terrain.colors", "tiff")
    > |   importFrom("graphics", "abline", "axis", "barplot", "box", "boxplot",
    > |              "image", "layout", "legend", "lines", "mtext", "par",
    > |              "plot", "plot.new", "points", "rasterImage", "strwidth",
    > |              "text", "title")
    > |   importFrom("stats", "TukeyHSD", "acf", "aov", "ccf", "coefficients",
    > |              "drop1", "end", "fft", "median", "model.tables",
    > |              "na.action", "na.omit", "pf", "ts", "var")
    > |   importFrom("utils", "read.table", "str", "tail", "write.table")
    > | 
    > | to your NAMESPACE file.

    > I find this preferable and quite appreciate that R CMD check provides it.
    > Dirk

yes, and that is not only Dirk :

It *is* highly preferable and recommended, also in *the*
reference manual ("Writing R Extensions", aka WRE) for reasons
of
  - efficiency,
  - modularity and "self-documentation"
  - much better control against accidental name clashes,

There are very few exceptions where importing a whole namespace
makes sense and the above base packages are typically never part
of these exceptions.

Martin Maechler
ETH Zurich and R Core


From leegi001 at umn.edu  Tue Jan 31 09:26:32 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Tue, 31 Jan 2017 02:26:32 -0600
Subject: [R-pkg-devel]
	=?utf-8?q?no_visible_global_function_definition_for?=
	=?utf-8?b?IOKAmHBhcuKAmQ==?=
In-Reply-To: <22672.18475.360132.463433@stat.math.ethz.ch>
References: <CAOeg=_8Uv2haf1Qp2k-qw8B-2EwngguxF3oAYesyUvGU7PUA+Q@mail.gmail.com>
	<1485795132.3192.3.camel@braverock.com>
	<CAOeg=_9AtDMjUWcKmttZJp_zfC_cFs0QsKxaDdM7sQSaRrwnMA@mail.gmail.com>
	<1485796881.3192.4.camel@braverock.com>
	<CAJXgQP0+iDKq1Z1P-E3Y9NGiRv2X3YYFareK0VD9peNszjJE+w@mail.gmail.com>
	<22671.64363.579181.74264@max.nulle.part>
	<22672.18475.360132.463433@stat.math.ethz.ch>
Message-ID: <CAOeg=_8WiZRZDZr0tfDq2JnPNBhfw-uCt=FBiykPB1dsDuqHFg@mail.gmail.com>

Thank you.  Makes sense.  It is *very* helpful to have R CMD check provide
that.

Cathy Lee Gierke


*?Darkness cannot drive out darkness: only light can do that. Hate cannot
drive out hate: only love can do that.? *
*?The arc of the moral universe is long, but it bends towards justice.?*
*?Nothing in the world is more dangerous than sincere ignorance and
conscientious stupidity.? *
*?Never forget that everything Hitler did in Germany was legal.?   *
*?Forgiveness is not an occasional act, it is a constant attitude.? *
*?Injustice anywhere is a threat to justice everywhere.?  *

? Martin Luther King Jr.

<http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>

On Tue, Jan 31, 2017 at 2:17 AM, Martin Maechler <maechler at stat.math.ethz.ch
> wrote:

> >>>>> Dirk Eddelbuettel <edd at debian.org>
> >>>>>     on Mon, 30 Jan 2017 20:50:19 -0600 writes:
>
>     > On 30 January 2017 at 09:58, Kevin Ushey wrote:
>     > | The correct thing to do is indeed import any functions from any R
> packages
>     > | you use, base or otherwise. The simplest fix, if you don't want to
>     > | selectively import such a large range of functions, is to simply
> add e.g.
>     > |
>     > |     import(utils)
>     > |     import(stats)
>     > |     ... etc ...
>     > |
>     > | to your NAMESPACE file.
>
>     > Or do what R CMD check suggested and import the ones used, rather
> than all.
>
>     > Which is what I had quoted earlier:
>
>     > | Consider adding
>     > |
>     > |   importFrom("grDevices", "as.raster", "dev.cur", "dev.off",
> "gray",
>     > |              "heat.colors", "jpeg", "palette", "pdf", "png",
> "rainbow",
>     > |              "terrain.colors", "tiff")
>     > |   importFrom("graphics", "abline", "axis", "barplot", "box",
> "boxplot",
>     > |              "image", "layout", "legend", "lines", "mtext", "par",
>     > |              "plot", "plot.new", "points", "rasterImage",
> "strwidth",
>     > |              "text", "title")
>     > |   importFrom("stats", "TukeyHSD", "acf", "aov", "ccf",
> "coefficients",
>     > |              "drop1", "end", "fft", "median", "model.tables",
>     > |              "na.action", "na.omit", "pf", "ts", "var")
>     > |   importFrom("utils", "read.table", "str", "tail", "write.table")
>     > |
>     > | to your NAMESPACE file.
>
>     > I find this preferable and quite appreciate that R CMD check
> provides it.
>     > Dirk
>
> yes, and that is not only Dirk :
>
> It *is* highly preferable and recommended, also in *the*
> reference manual ("Writing R Extensions", aka WRE) for reasons
> of
>   - efficiency,
>   - modularity and "self-documentation"
>   - much better control against accidental name clashes,
>
> There are very few exceptions where importing a whole namespace
> makes sense and the above base packages are typically never part
> of these exceptions.
>
> Martin Maechler
> ETH Zurich and R Core
>

	[[alternative HTML version deleted]]


From patrick.schratz at gmail.com  Tue Jan 31 13:45:26 2017
From: patrick.schratz at gmail.com (Patrick Schratz)
Date: Tue, 31 Jan 2017 13:45:26 +0100
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
Message-ID: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>

Hello,

when running R CMD check / devtools::check, section "running tests..." is
not finishing (40 min+).

*Checking tests only works:*

*==> Sourcing R files in 'tests' directory*

*testthat results
================================================================*
*OK: 7 SKIPPED: 0 FAILED: 0*

*Tests complete*


As well as running tests line-by-line.

How can I debug my tests to discover the problem during R CMD check?

*Tests are using parallelization (foreach + doParallel)*

Best, Patrick

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Thu Feb  2 00:01:00 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 2 Feb 2017 00:01:00 +0100
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
Message-ID: <5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>

Check whether the parallel cluster is closed. Can it be that the cluster 
is still open and the check process waits for them to complete?

Best,
Uwe Ligges



On 31.01.2017 13:45, Patrick Schratz wrote:
> Hello,
>
> when running R CMD check / devtools::check, section "running tests..." is
> not finishing (40 min+).
>
> *Checking tests only works:*
>
> *==> Sourcing R files in 'tests' directory*
>
> *testthat results
> ================================================================*
> *OK: 7 SKIPPED: 0 FAILED: 0*
>
> *Tests complete*
>
>
> As well as running tests line-by-line.
>
> How can I debug my tests to discover the problem during R CMD check?
>
> *Tests are using parallelization (foreach + doParallel)*
>
> Best, Patrick
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From glennmschultz at me.com  Fri Feb  3 18:36:33 2017
From: glennmschultz at me.com (Glenn Schultz)
Date: Fri, 03 Feb 2017 17:36:33 +0000 (GMT)
Subject: [R-pkg-devel] TryCatch messages
Message-ID: <960ae3d5-5326-4dbb-b5a8-e3dd04d86691@me.com>

All,
I have my tryCatch working on my function and rather than crashing I get the error message below. ?However, I would just like price must be entered as a character?without the information to the right of the : Can this information be suppressed?

Thanks,
Glenn

<simpleError in MortgageCashFlow(bond.id = FNAR7401, original.bal = 1e+06, settlement.date = "08-18-2016", ? ? price = 100, PrepaymentAssumption = PrepaymentModel(bond.id = FNAR7401, ? ? ? ? TermStructure = TermStructure(rates.data = Curve, method = "dl"), ? ? ? ? MortgageRate = MtgRate(), ModelTune = ModelTune(MBS(MBS.id = "3138W5GK8")), ? ? ? ? Burnout = Burnout(MBS(MBS.id = "3138W5GK8")), PrepaymentAssumption = "MODEL")): price must be entered as a character>

From wdunlap at tibco.com  Fri Feb  3 19:39:11 2017
From: wdunlap at tibco.com (William Dunlap)
Date: Fri, 3 Feb 2017 10:39:11 -0800
Subject: [R-pkg-devel] TryCatch messages
In-Reply-To: <960ae3d5-5326-4dbb-b5a8-e3dd04d86691@me.com>
References: <960ae3d5-5326-4dbb-b5a8-e3dd04d86691@me.com>
Message-ID: <CAF8bMcYGGqkcX4NK0VaBcZFPgT4FpD2QnWD0Mnxf__vPUq0VKQ@mail.gmail.com>

Use conditonMessage() to extract the message from an error, warning,
message, or other 'condition'

For more, see Hadley Wickham's book, "Advanced R":

  http://adv-r.had.co.nz/Exceptions-Debugging.html
  http://adv-r.had.co.nz/beyond-exception-handling.html

Bill Dunlap
TIBCO Software
wdunlap tibco.com


On Fri, Feb 3, 2017 at 9:36 AM, Glenn Schultz <glennmschultz at me.com> wrote:
> All,
> I have my tryCatch working on my function and rather than crashing I get the
> error message below.  However, I would just like price must be entered as a
> character without the information to the right of the : Can this information
> be suppressed?
>
> Thanks,
> Glenn
>
> <simpleError in MortgageCashFlow(bond.id = FNAR7401, original.bal = 1e+06,
> settlement.date = "08-18-2016",     price = 100, PrepaymentAssumption =
> PrepaymentModel(bond.id = FNAR7401,         TermStructure =
> TermStructure(rates.data = Curve, method = "dl"),         MortgageRate =
> MtgRate(), ModelTune = ModelTune(MBS(MBS.id = "3138W5GK8")),         Burnout
> = Burnout(MBS(MBS.id = "3138W5GK8")), PrepaymentAssumption = "MODEL")):
> price must be entered as a character>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From patrick.schratz at gmail.com  Sun Feb  5 12:54:27 2017
From: patrick.schratz at gmail.com (Patrick Schratz)
Date: Sun, 5 Feb 2017 12:54:27 +0100
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
Message-ID: <CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>

Dear Uwe,

thanks for the hint. My cluster is closed after the `foreach`call using
`stopCluster()`.

Before, I?ll do the following to init the cluster:

*cl <- makeCluster(par.args$par.units, outfile = out.progress)*
*registerDoParallel(cl, cores = par.args$par.units)*

*foreach()*

*stopCluster(cl)*

Do you know of any other package which is using foreach in combination with
tests and is hosted on Github? So I could compare settings.

Best, Patrick

2017-02-02 0:01 GMT+01:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:

> Check whether the parallel cluster is closed. Can it be that the cluster
> is still open and the check process waits for them to complete?
>
> Best,
> Uwe Ligges
>
>
>
> On 31.01.2017 13:45, Patrick Schratz wrote:
>
>> Hello,
>>
>> when running R CMD check / devtools::check, section "running tests..." is
>> not finishing (40 min+).
>>
>> *Checking tests only works:*
>>
>> *==> Sourcing R files in 'tests' directory*
>>
>> *testthat results
>> ================================================================*
>> *OK: 7 SKIPPED: 0 FAILED: 0*
>>
>> *Tests complete*
>>
>>
>> As well as running tests line-by-line.
>>
>> How can I debug my tests to discover the problem during R CMD check?
>>
>> *Tests are using parallelization (foreach + doParallel)*
>>
>> Best, Patrick
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>>

	[[alternative HTML version deleted]]


From leegi001 at umn.edu  Sun Feb  5 14:20:22 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Sun, 5 Feb 2017 07:20:22 -0600
Subject: [R-pkg-devel] While using R CMD check: LaTex error: File
	`inconsolata.sty' not found
Message-ID: <CAOeg=_9AADF8TfQME63Yyrj94DUDy9ob3KSAF=zJy1W+Lx17xQ@mail.gmail.com>

I cannot find any recent solution to this problem, and older ones do not
seem to work.

I just installed the small version of MacTeX called BasicTeX, to allow my
package to build PDFs.   http://tug.org/mactex/morepackages.html

Everything worked, except I get the error  "LaTex error: File
`inconsolata.sty' not found".  I tried to install inconsolata.sty as
suggested here,
https://stat.ethz.ch/pipermail/r-help//2013-July/356743.html but
get an error saying zi4 is not there when following the Read.Me install
instructions:

Mac OS X: Method A (recommended): type

>sudo mkdir -p /usr/local/texlive/texmf-local/web2c
>sudo cp -Rfp * /usr/local/texlive/texmf-local
>sudo echo Map zi4.map >> /usr/local/texlive/texmf-local/web2c/updmap.cfg
>sudo mktexlsr
......

kpsewhich zi4.sty returns nothing

kpsewhich inconsolata.sty returns nothing

So they must not be installed.  Any idea how to fix this?

Thanks much,
Cathy Lee Gierke


*?Darkness cannot drive out darkness: only light can do that. Hate cannot
drive out hate: only love can do that.? *
*?The arc of the moral universe is long, but it bends towards justice.?*
*?Nothing in the world is more dangerous than sincere ignorance and
conscientious stupidity.? *
*?Never forget that everything Hitler did in Germany was legal.?   *
*?Forgiveness is not an occasional act, it is a constant attitude.? *
*?Injustice anywhere is a threat to justice everywhere.?  *

? Martin Luther King Jr.

<http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>

	[[alternative HTML version deleted]]


From henrik.bengtsson at gmail.com  Sun Feb  5 15:04:41 2017
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Sun, 5 Feb 2017 06:04:41 -0800
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
	<CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
Message-ID: <CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>

Use

  registerDoParallel(cl)

The number of parallel workers is already contained in the 'cl'
object, so don't
specify 'cores'!  (If you do that, I suspect you create yet another cluster
(a multicore one) which is used but never closed)

registerDoParallel() should ideally give an error in your case. Author
BCC:ed.

Henrik

On Feb 5, 2017 03:56, "Patrick Schratz" <patrick.schratz at gmail.com> wrote:

> Dear Uwe,
>
> thanks for the hint. My cluster is closed after the `foreach`call using
> `stopCluster()`.
>
> Before, I?ll do the following to init the cluster:
>
> *cl <- makeCluster(par.args$par.units, outfile = out.progress)*
> *registerDoParallel(cl, cores = par.args$par.units)*
>
> *foreach()*
>
> *stopCluster(cl)*
>
> Do you know of any other package which is using foreach in combination with
> tests and is hosted on Github? So I could compare settings.
>
> Best, Patrick
>
> 2017-02-02 0:01 GMT+01:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>
> > Check whether the parallel cluster is closed. Can it be that the cluster
> > is still open and the check process waits for them to complete?
> >
> > Best,
> > Uwe Ligges
> >
> >
> >
> > On 31.01.2017 13:45, Patrick Schratz wrote:
> >
> >> Hello,
> >>
> >> when running R CMD check / devtools::check, section "running tests..."
> is
> >> not finishing (40 min+).
> >>
> >> *Checking tests only works:*
> >>
> >> *==> Sourcing R files in 'tests' directory*
> >>
> >> *testthat results
> >> ================================================================*
> >> *OK: 7 SKIPPED: 0 FAILED: 0*
> >>
> >> *Tests complete*
> >>
> >>
> >> As well as running tests line-by-line.
> >>
> >> How can I debug my tests to discover the problem during R CMD check?
> >>
> >> *Tests are using parallelization (foreach + doParallel)*
> >>
> >> Best, Patrick
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From patrick.schratz at gmail.com  Sun Feb  5 16:07:25 2017
From: patrick.schratz at gmail.com (Patrick Schratz)
Date: Sun, 5 Feb 2017 16:07:25 +0100
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
	<CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
	<CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>
Message-ID: <CAE=-a0SHH0BybwJToJg5kcnhPbM5dQCiiUUsSZeyy8+AaZnQzA@mail.gmail.com>

Thanks for the hint, Hendrik!
However, this change did not make a difference :/

I tried to use all cluster closing functions I came across but tests are
still running infinite..

*cl <- makeCluster(par.args$par.units, outfile = out.progress)*

*registerDoParallel(cl)*

*foreach()*

*parallel::stopCluster(cl)*
*doParallel::registerDoSEQ()*
*doParallel::stopImplicitCluster()*

2017-02-05 15:04 GMT+01:00 Henrik Bengtsson <henrik.bengtsson at gmail.com>:

> Use
>
>   registerDoParallel(cl)
>
> The number of parallel workers is already contained in the 'cl' object, so
> don't specify 'cores'!  (If you do that, I suspect you create yet another
> cluster (a multicore one) which is used but never closed)
>
> registerDoParallel() should ideally give an error in your case. Author
> BCC:ed.
>
> Henrik
>
> On Feb 5, 2017 03:56, "Patrick Schratz" <patrick.schratz at gmail.com> wrote:
>
>> Dear Uwe,
>>
>> thanks for the hint. My cluster is closed after the `foreach`call using
>> `stopCluster()`.
>>
>> Before, I?ll do the following to init the cluster:
>>
>> *cl <- makeCluster(par.args$par.units, outfile = out.progress)*
>> *registerDoParallel(cl, cores = par.args$par.units)*
>>
>> *foreach()*
>>
>> *stopCluster(cl)*
>>
>>
>> Do you know of any other package which is using foreach in combination
>> with
>> tests and is hosted on Github? So I could compare settings.
>>
>> Best, Patrick
>>
>> 2017-02-02 0:01 GMT+01:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>>
>> > Check whether the parallel cluster is closed. Can it be that the cluster
>> > is still open and the check process waits for them to complete?
>> >
>> > Best,
>> > Uwe Ligges
>> >
>> >
>> >
>> > On 31.01.2017 13:45, Patrick Schratz wrote:
>> >
>> >> Hello,
>> >>
>> >> when running R CMD check / devtools::check, section "running tests..."
>> is
>> >> not finishing (40 min+).
>> >>
>> >> *Checking tests only works:*
>> >>
>> >> *==> Sourcing R files in 'tests' directory*
>> >>
>> >> *testthat results
>> >> ================================================================*
>> >> *OK: 7 SKIPPED: 0 FAILED: 0*
>> >>
>> >> *Tests complete*
>> >>
>> >>
>> >> As well as running tests line-by-line.
>> >>
>> >> How can I debug my tests to discover the problem during R CMD check?
>> >>
>> >> *Tests are using parallelization (foreach + doParallel)*
>> >>
>> >> Best, Patrick
>> >>
>> >>         [[alternative HTML version deleted]]
>> >>
>> >> ______________________________________________
>> >> R-package-devel at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >>
>> >>
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>

	[[alternative HTML version deleted]]


From kasperdanielhansen at gmail.com  Sun Feb  5 19:27:48 2017
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Sun, 5 Feb 2017 13:27:48 -0500
Subject: [R-pkg-devel] While using R CMD check: LaTex error: File
 `inconsolata.sty' not found
In-Reply-To: <CAOeg=_9AADF8TfQME63Yyrj94DUDy9ob3KSAF=zJy1W+Lx17xQ@mail.gmail.com>
References: <CAOeg=_9AADF8TfQME63Yyrj94DUDy9ob3KSAF=zJy1W+Lx17xQ@mail.gmail.com>
Message-ID: <CAC2h7utWsedMfO_JugU=A_3iU1kFp-gtv9nXq2VOPiivbTq=1Q@mail.gmail.com>

If you installed MacTex basic, you should have the command line utility
  tlmgr
available. On my system it is in
  /Library/TeX/texbin/tlmgr
and you may need to add this to your path. Using this, it is simple to
install additional packages, by
  tlmgr install inconsolata
You probably need to add a sudo to this, so the full command becomes
  sudo tlmgr install inconsolata

(depending on how old MacTex is compared to recent releases, you _may_ need
to update tlmgr itself first.  I think it will be something like
  tlmgr update --self
but the program will tell you about this when you run it)

Best,
Kasper

On Sun, Feb 5, 2017 at 8:20 AM, Cathy Lee Gierke <leegi001 at umn.edu> wrote:

> I cannot find any recent solution to this problem, and older ones do not
> seem to work.
>
> I just installed the small version of MacTeX called BasicTeX, to allow my
> package to build PDFs.   http://tug.org/mactex/morepackages.html
>
> Everything worked, except I get the error  "LaTex error: File
> `inconsolata.sty' not found".  I tried to install inconsolata.sty as
> suggested here,
> https://stat.ethz.ch/pipermail/r-help//2013-July/356743.html but
> get an error saying zi4 is not there when following the Read.Me install
> instructions:
>
> Mac OS X: Method A (recommended): type
>
> >sudo mkdir -p /usr/local/texlive/texmf-local/web2c
> >sudo cp -Rfp * /usr/local/texlive/texmf-local
> >sudo echo Map zi4.map >> /usr/local/texlive/texmf-local/web2c/updmap.cfg
> >sudo mktexlsr
> ......
>
> kpsewhich zi4.sty returns nothing
>
> kpsewhich inconsolata.sty returns nothing
>
> So they must not be installed.  Any idea how to fix this?
>
> Thanks much,
> Cathy Lee Gierke
>
>
> *?Darkness cannot drive out darkness: only light can do that. Hate cannot
> drive out hate: only love can do that.? *
> *?The arc of the moral universe is long, but it bends towards justice.?*
> *?Nothing in the world is more dangerous than sincere ignorance and
> conscientious stupidity.? *
> *?Never forget that everything Hitler did in Germany was legal.?   *
> *?Forgiveness is not an occasional act, it is a constant attitude.? *
> *?Injustice anywhere is a threat to justice everywhere.?  *
>
> ? Martin Luther King Jr.
>
> <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From patrick.schratz at gmail.com  Sun Feb  5 20:28:44 2017
From: patrick.schratz at gmail.com (Patrick Schratz)
Date: Sun, 5 Feb 2017 20:28:44 +0100
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CAE=-a0SHH0BybwJToJg5kcnhPbM5dQCiiUUsSZeyy8+AaZnQzA@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
	<CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
	<CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>
	<CAE=-a0SHH0BybwJToJg5kcnhPbM5dQCiiUUsSZeyy8+AaZnQzA@mail.gmail.com>
Message-ID: <CAE=-a0QQYoMSS-DVMkcTC6UBVgPpO9iFgZKhsMVck_TyNB=p5g@mail.gmail.com>

@gaborcsardi solved it :) See here:
https://github.com/hadley/testthat/issues/567#issuecomment-277536577


2017-02-05 16:07 GMT+01:00 Patrick Schratz <patrick.schratz at gmail.com>:

> Thanks for the hint, Hendrik!
> However, this change did not make a difference :/
>
> I tried to use all cluster closing functions I came across but tests are
> still running infinite..
>
> *cl <- makeCluster(par.args$par.units, outfile = out.progress)*
>
> *registerDoParallel(cl)*
>
> *foreach()*
>
> *parallel::stopCluster(cl)*
> *doParallel::registerDoSEQ()*
> *doParallel::stopImplicitCluster()*
>
> 2017-02-05 15:04 GMT+01:00 Henrik Bengtsson <henrik.bengtsson at gmail.com>:
>
>> Use
>>
>>   registerDoParallel(cl)
>>
>> The number of parallel workers is already contained in the 'cl' object,
>> so don't specify 'cores'!  (If you do that, I suspect you create yet
>> another cluster (a multicore one) which is used but never closed)
>>
>> registerDoParallel() should ideally give an error in your case. Author
>> BCC:ed.
>>
>> Henrik
>>
>> On Feb 5, 2017 03:56, "Patrick Schratz" <patrick.schratz at gmail.com>
>> wrote:
>>
>>> Dear Uwe,
>>>
>>> thanks for the hint. My cluster is closed after the `foreach`call using
>>> `stopCluster()`.
>>>
>>> Before, I?ll do the following to init the cluster:
>>>
>>> *cl <- makeCluster(par.args$par.units, outfile = out.progress)*
>>> *registerDoParallel(cl, cores = par.args$par.units)*
>>>
>>> *foreach()*
>>>
>>> *stopCluster(cl)*
>>>
>>>
>>> Do you know of any other package which is using foreach in combination
>>> with
>>> tests and is hosted on Github? So I could compare settings.
>>>
>>> Best, Patrick
>>>
>>> 2017-02-02 0:01 GMT+01:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>>>
>>> > Check whether the parallel cluster is closed. Can it be that the
>>> cluster
>>> > is still open and the check process waits for them to complete?
>>> >
>>> > Best,
>>> > Uwe Ligges
>>> >
>>> >
>>> >
>>> > On 31.01.2017 13:45, Patrick Schratz wrote:
>>> >
>>> >> Hello,
>>> >>
>>> >> when running R CMD check / devtools::check, section "running
>>> tests..." is
>>> >> not finishing (40 min+).
>>> >>
>>> >> *Checking tests only works:*
>>> >>
>>> >> *==> Sourcing R files in 'tests' directory*
>>> >>
>>> >> *testthat results
>>> >> ================================================================*
>>> >> *OK: 7 SKIPPED: 0 FAILED: 0*
>>> >>
>>> >> *Tests complete*
>>> >>
>>> >>
>>> >> As well as running tests line-by-line.
>>> >>
>>> >> How can I debug my tests to discover the problem during R CMD check?
>>> >>
>>> >> *Tests are using parallelization (foreach + doParallel)*
>>> >>
>>> >> Best, Patrick
>>> >>
>>> >>         [[alternative HTML version deleted]]
>>> >>
>>> >> ______________________________________________
>>> >> R-package-devel at r-project.org mailing list
>>> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>> >>
>>> >>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>

	[[alternative HTML version deleted]]


From avraham.adler at gmail.com  Sun Feb  5 21:25:11 2017
From: avraham.adler at gmail.com (Avraham Adler)
Date: Sun, 5 Feb 2017 15:25:11 -0500
Subject: [R-pkg-devel] Delaporte: Test Errors on Sun Sparc
Message-ID: <CAL6gwn+3TjdXziEA53WXVRVhyceHDbNTncNG=dKV9BgGEdaJUQ@mail.gmail.com>

I recently changed the back-end compiled code for the Delaporte
package from C++ to Fortran/C, and after some birthing pains (and a
lot of patience shown by CRAN), it's fully functional _except_ on
sparc-sun-solaris2.10 [1]. There, 10 of the 44 tests return errors.
I've done enough research to know that there may be endian issues
involved, but I do not know how to address them.

Interestingly, some of the errors look as if they are caused by
returning the "ones-complement" (if that is a word, meaning returning
1 - x instead of x) in some cases. See tests 3, 4, 6, and 7 for
examples. In the next version (which won't be posted to CRAN for at
least a month 8-) ), I've expanded the number of tests from 44 to (at
least) 86 to try to more cleanly isolate possible failures, but I
don't have access to a sparc-based Sun server, nor is there one on
Rhub and win-builder, so I cannot test it.

Has anyone seen anything similar or does this ring any bells?

Thank you,

Avi

[1] <https://www.r-project.org/nosvn/R.check/r-patched-solaris-sparc/Delaporte-00check.html>


From leegi001 at umn.edu  Sun Feb  5 21:25:20 2017
From: leegi001 at umn.edu (Cathy Lee Gierke)
Date: Sun, 5 Feb 2017 14:25:20 -0600
Subject: [R-pkg-devel] While using R CMD check: LaTex error: File
 `inconsolata.sty' not found
In-Reply-To: <CAC2h7utWsedMfO_JugU=A_3iU1kFp-gtv9nXq2VOPiivbTq=1Q@mail.gmail.com>
References: <CAOeg=_9AADF8TfQME63Yyrj94DUDy9ob3KSAF=zJy1W+Lx17xQ@mail.gmail.com>
	<CAC2h7utWsedMfO_JugU=A_3iU1kFp-gtv9nXq2VOPiivbTq=1Q@mail.gmail.com>
Message-ID: <CAOeg=_8d2+voGAijZRPzoQgK556V_7uO-owabhjyTrK7asfRNQ@mail.gmail.com>

Hey, it worked!!!!!!  Thanks!

I had tried sudo tlmgr install collection-fontsrecommended earlier, but it
didn't install what I needed....

? Martin Luther King Jr.

<http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>

On Sun, Feb 5, 2017 at 12:27 PM, Kasper Daniel Hansen <
kasperdanielhansen at gmail.com> wrote:

> If you installed MacTex basic, you should have the command line utility
>   tlmgr
> available. On my system it is in
>   /Library/TeX/texbin/tlmgr
> and you may need to add this to your path. Using this, it is simple to
> install additional packages, by
>   tlmgr install inconsolata
> You probably need to add a sudo to this, so the full command becomes
>   sudo tlmgr install inconsolata
>
> (depending on how old MacTex is compared to recent releases, you _may_
> need to update tlmgr itself first.  I think it will be something like
>   tlmgr update --self
> but the program will tell you about this when you run it)
>
> Best,
> Kasper
>
> On Sun, Feb 5, 2017 at 8:20 AM, Cathy Lee Gierke <leegi001 at umn.edu> wrote:
>
>> I cannot find any recent solution to this problem, and older ones do not
>> seem to work.
>>
>> I just installed the small version of MacTeX called BasicTeX, to allow my
>> package to build PDFs.   http://tug.org/mactex/morepackages.html
>>
>> Everything worked, except I get the error  "LaTex error: File
>> `inconsolata.sty' not found".  I tried to install inconsolata.sty as
>> suggested here,
>> https://stat.ethz.ch/pipermail/r-help//2013-July/356743.html but
>> get an error saying zi4 is not there when following the Read.Me install
>> instructions:
>>
>> Mac OS X: Method A (recommended): type
>>
>> >sudo mkdir -p /usr/local/texlive/texmf-local/web2c
>> >sudo cp -Rfp * /usr/local/texlive/texmf-local
>> >sudo echo Map zi4.map >> /usr/local/texlive/texmf-local/web2c/updmap.cfg
>> >sudo mktexlsr
>> ......
>>
>> kpsewhich zi4.sty returns nothing
>>
>> kpsewhich inconsolata.sty returns nothing
>>
>> So they must not be installed.  Any idea how to fix this?
>>
>> Thanks much,
>> Cathy Lee Gierke
>>
>>
>> *?Darkness cannot drive out darkness: only light can do that. Hate cannot
>> drive out hate: only love can do that.? *
>> *?The arc of the moral universe is long, but it bends towards justice.?*
>> *?Nothing in the world is more dangerous than sincere ignorance and
>> conscientious stupidity.? *
>> *?Never forget that everything Hitler did in Germany was legal.?   *
>> *?Forgiveness is not an occasional act, it is a constant attitude.? *
>> *?Injustice anywhere is a threat to justice everywhere.?  *
>>
>> ? Martin Luther King Jr.
>>
>> <http://www.goodreads.com/author/show/23924.Martin_Luther_King_Jr_>
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>
>

	[[alternative HTML version deleted]]


From mark.vanderloo at gmail.com  Mon Feb  6 00:07:16 2017
From: mark.vanderloo at gmail.com (Mark van der Loo)
Date: Sun, 05 Feb 2017 23:07:16 +0000
Subject: [R-pkg-devel] Delaporte: Test Errors on Sun Sparc
In-Reply-To: <CAL6gwn+3TjdXziEA53WXVRVhyceHDbNTncNG=dKV9BgGEdaJUQ@mail.gmail.com>
References: <CAL6gwn+3TjdXziEA53WXVRVhyceHDbNTncNG=dKV9BgGEdaJUQ@mail.gmail.com>
Message-ID: <CAOKDuOgfo-+gEfrF4gcX9u4KbSt957Zaq+abdc=heydG0H+81w@mail.gmail.com>

Avraham,

I can't help you out directly but Jeroen Ooms has a VM image with Solaris &
R available: https://github.com/jeroenooms/solarisvm

best,
Mark



Op zo 5 feb. 2017 om 21:27 schreef Avraham Adler <avraham.adler at gmail.com>:

> I recently changed the back-end compiled code for the Delaporte
> package from C++ to Fortran/C, and after some birthing pains (and a
> lot of patience shown by CRAN), it's fully functional _except_ on
> sparc-sun-solaris2.10 [1]. There, 10 of the 44 tests return errors.
> I've done enough research to know that there may be endian issues
> involved, but I do not know how to address them.
>
> Interestingly, some of the errors look as if they are caused by
> returning the "ones-complement" (if that is a word, meaning returning
> 1 - x instead of x) in some cases. See tests 3, 4, 6, and 7 for
> examples. In the next version (which won't be posted to CRAN for at
> least a month 8-) ), I've expanded the number of tests from 44 to (at
> least) 86 to try to more cleanly isolate possible failures, but I
> don't have access to a sparc-based Sun server, nor is there one on
> Rhub and win-builder, so I cannot test it.
>
> Has anyone seen anything similar or does this ring any bells?
>
> Thank you,
>
> Avi
>
> [1] <
> https://www.r-project.org/nosvn/R.check/r-patched-solaris-sparc/Delaporte-00check.html
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From henrik.bengtsson at gmail.com  Mon Feb  6 03:17:12 2017
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Sun, 5 Feb 2017 18:17:12 -0800
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CAE=-a0QQYoMSS-DVMkcTC6UBVgPpO9iFgZKhsMVck_TyNB=p5g@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
	<CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
	<CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>
	<CAE=-a0SHH0BybwJToJg5kcnhPbM5dQCiiUUsSZeyy8+AaZnQzA@mail.gmail.com>
	<CAE=-a0QQYoMSS-DVMkcTC6UBVgPpO9iFgZKhsMVck_TyNB=p5g@mail.gmail.com>
Message-ID: <CAFDcVCQqnM8UW_=16m4woo-QV8j95zUamnE2YdTBGUxqKJPs_A@mail.gmail.com>

In case someone else bumps into this later and finds this thread; can
you confirm that this was a problem specific to using the testthat
package for running the tests?

/Henrik

On Sun, Feb 5, 2017 at 11:28 AM, Patrick Schratz
<patrick.schratz at gmail.com> wrote:
> @gaborcsardi solved it :) See here:
> https://github.com/hadley/testthat/issues/567#issuecomment-277536577
>
>
> 2017-02-05 16:07 GMT+01:00 Patrick Schratz <patrick.schratz at gmail.com>:
>>
>> Thanks for the hint, Hendrik!
>> However, this change did not make a difference :/
>>
>> I tried to use all cluster closing functions I came across but tests are
>> still running infinite..
>>
>> cl <- makeCluster(par.args$par.units, outfile = out.progress)
>> registerDoParallel(cl)
>>
>> foreach()
>>
>> parallel::stopCluster(cl)
>> doParallel::registerDoSEQ()
>> doParallel::stopImplicitCluster()
>>
>> 2017-02-05 15:04 GMT+01:00 Henrik Bengtsson <henrik.bengtsson at gmail.com>:
>>>
>>> Use
>>>
>>>   registerDoParallel(cl)
>>>
>>> The number of parallel workers is already contained in the 'cl' object,
>>> so don't specify 'cores'!  (If you do that, I suspect you create yet another
>>> cluster (a multicore one) which is used but never closed)
>>>
>>> registerDoParallel() should ideally give an error in your case. Author
>>> BCC:ed.
>>>
>>> Henrik
>>>
>>> On Feb 5, 2017 03:56, "Patrick Schratz" <patrick.schratz at gmail.com>
>>> wrote:
>>>>
>>>> Dear Uwe,
>>>>
>>>> thanks for the hint. My cluster is closed after the `foreach`call using
>>>> `stopCluster()`.
>>>>
>>>> Before, I?ll do the following to init the cluster:
>>>>
>>>> *cl <- makeCluster(par.args$par.units, outfile = out.progress)*
>>>> *registerDoParallel(cl, cores = par.args$par.units)*
>>>>
>>>> *foreach()*
>>>>
>>>> *stopCluster(cl)*
>>>>
>>>>
>>>> Do you know of any other package which is using foreach in combination
>>>> with
>>>> tests and is hosted on Github? So I could compare settings.
>>>>
>>>> Best, Patrick
>>>>
>>>> 2017-02-02 0:01 GMT+01:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>>>>
>>>> > Check whether the parallel cluster is closed. Can it be that the
>>>> > cluster
>>>> > is still open and the check process waits for them to complete?
>>>> >
>>>> > Best,
>>>> > Uwe Ligges
>>>> >
>>>> >
>>>> >
>>>> > On 31.01.2017 13:45, Patrick Schratz wrote:
>>>> >
>>>> >> Hello,
>>>> >>
>>>> >> when running R CMD check / devtools::check, section "running
>>>> >> tests..." is
>>>> >> not finishing (40 min+).
>>>> >>
>>>> >> *Checking tests only works:*
>>>> >>
>>>> >> *==> Sourcing R files in 'tests' directory*
>>>> >>
>>>> >> *testthat results
>>>> >> ================================================================*
>>>> >> *OK: 7 SKIPPED: 0 FAILED: 0*
>>>> >>
>>>> >> *Tests complete*
>>>> >>
>>>> >>
>>>> >> As well as running tests line-by-line.
>>>> >>
>>>> >> How can I debug my tests to discover the problem during R CMD check?
>>>> >>
>>>> >> *Tests are using parallelization (foreach + doParallel)*
>>>> >>
>>>> >> Best, Patrick
>>>> >>
>>>> >>         [[alternative HTML version deleted]]
>>>> >>
>>>> >> ______________________________________________
>>>> >> R-package-devel at r-project.org mailing list
>>>> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>> >>
>>>> >>
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>>
>


From csardi.gabor at gmail.com  Mon Feb  6 09:41:37 2017
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Mon, 6 Feb 2017 08:41:37 +0000
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CAFDcVCQqnM8UW_=16m4woo-QV8j95zUamnE2YdTBGUxqKJPs_A@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
	<CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
	<CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>
	<CAE=-a0SHH0BybwJToJg5kcnhPbM5dQCiiUUsSZeyy8+AaZnQzA@mail.gmail.com>
	<CAE=-a0QQYoMSS-DVMkcTC6UBVgPpO9iFgZKhsMVck_TyNB=p5g@mail.gmail.com>
	<CAFDcVCQqnM8UW_=16m4woo-QV8j95zUamnE2YdTBGUxqKJPs_A@mail.gmail.com>
Message-ID: <CABtg=KmumAfuXt0WEYXCo5LZHNN-=NwamETV9VVD0o=yg_p0tw@mail.gmail.com>

I don't think it is specific for testthat. R CMD check sets R_TESTS when it
runs the tests, so the separate R process it starts can have some special
startup options.

The problem happens if you start another R process from your R test, and
then R_TESTS confuses this process. (I am not sure how exactly.)

A lot of packages have to work around this:
https://github.com/search?q=user%3Acran+R_TESTS&type=Code

Most of these use testthat, but not all of them.

Gabor

On Mon, Feb 6, 2017 at 2:17 AM, Henrik Bengtsson <henrik.bengtsson at gmail.com
> wrote:

> In case someone else bumps into this later and finds this thread; can
> you confirm that this was a problem specific to using the testthat
> package for running the tests?
>
> /Henrik
>
> On Sun, Feb 5, 2017 at 11:28 AM, Patrick Schratz
> <patrick.schratz at gmail.com> wrote:
> > @gaborcsardi solved it :) See here:
> > https://github.com/hadley/testthat/issues/567#issuecomment-277536577
> >
> >
> > 2017-02-05 16:07 GMT+01:00 Patrick Schratz <patrick.schratz at gmail.com>:
> >>
> >> Thanks for the hint, Hendrik!
> >> However, this change did not make a difference :/
> >>
> >> I tried to use all cluster closing functions I came across but tests are
> >> still running infinite..
> >>
> >> cl <- makeCluster(par.args$par.units, outfile = out.progress)
> >> registerDoParallel(cl)
> >>
> >> foreach()
> >>
> >> parallel::stopCluster(cl)
> >> doParallel::registerDoSEQ()
> >> doParallel::stopImplicitCluster()
> >>
> >> 2017-02-05 15:04 GMT+01:00 Henrik Bengtsson <henrik.bengtsson at gmail.com
> >:
> >>>
> >>> Use
> >>>
> >>>   registerDoParallel(cl)
> >>>
> >>> The number of parallel workers is already contained in the 'cl' object,
> >>> so don't specify 'cores'!  (If you do that, I suspect you create yet
> another
> >>> cluster (a multicore one) which is used but never closed)
> >>>
> >>> registerDoParallel() should ideally give an error in your case. Author
> >>> BCC:ed.
> >>>
> >>> Henrik
> >>>
> >>> On Feb 5, 2017 03:56, "Patrick Schratz" <patrick.schratz at gmail.com>
> >>> wrote:
> >>>>
> >>>> Dear Uwe,
> >>>>
> >>>> thanks for the hint. My cluster is closed after the `foreach`call
> using
> >>>> `stopCluster()`.
> >>>>
> >>>> Before, I?ll do the following to init the cluster:
> >>>>
> >>>> *cl <- makeCluster(par.args$par.units, outfile = out.progress)*
> >>>> *registerDoParallel(cl, cores = par.args$par.units)*
> >>>>
> >>>> *foreach()*
> >>>>
> >>>> *stopCluster(cl)*
> >>>>
> >>>>
> >>>> Do you know of any other package which is using foreach in combination
> >>>> with
> >>>> tests and is hosted on Github? So I could compare settings.
> >>>>
> >>>> Best, Patrick
> >>>>
> >>>> 2017-02-02 0:01 GMT+01:00 Uwe Ligges <ligges at statistik.tu-dortmund.de
> >:
> >>>>
> >>>> > Check whether the parallel cluster is closed. Can it be that the
> >>>> > cluster
> >>>> > is still open and the check process waits for them to complete?
> >>>> >
> >>>> > Best,
> >>>> > Uwe Ligges
> >>>> >
> >>>> >
> >>>> >
> >>>> > On 31.01.2017 13:45, Patrick Schratz wrote:
> >>>> >
> >>>> >> Hello,
> >>>> >>
> >>>> >> when running R CMD check / devtools::check, section "running
> >>>> >> tests..." is
> >>>> >> not finishing (40 min+).
> >>>> >>
> >>>> >> *Checking tests only works:*
> >>>> >>
> >>>> >> *==> Sourcing R files in 'tests' directory*
> >>>> >>
> >>>> >> *testthat results
> >>>> >> ================================================================*
> >>>> >> *OK: 7 SKIPPED: 0 FAILED: 0*
> >>>> >>
> >>>> >> *Tests complete*
> >>>> >>
> >>>> >>
> >>>> >> As well as running tests line-by-line.
> >>>> >>
> >>>> >> How can I debug my tests to discover the problem during R CMD
> check?
> >>>> >>
> >>>> >> *Tests are using parallelization (foreach + doParallel)*
> >>>> >>
> >>>> >> Best, Patrick
> >>>> >>
> >>>> >>         [[alternative HTML version deleted]]
> >>>> >>
> >>>> >> ______________________________________________
> >>>> >> R-package-devel at r-project.org mailing list
> >>>> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>> >>
> >>>> >>
> >>>>
> >>>>         [[alternative HTML version deleted]]
> >>>>
> >>>> ______________________________________________
> >>>> R-package-devel at r-project.org mailing list
> >>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >>
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From d.luedecke at uke.de  Mon Feb  6 12:09:43 2017
From: d.luedecke at uke.de (=?UTF-8?Q?Daniel_L=c3=bcdecke?=)
Date: Mon, 6 Feb 2017 12:09:43 +0100
Subject: [R-pkg-devel] Error in pkg Check Results
Message-ID: <2c657f13-ee35-3bd4-76f3-8cf081fa1932@uke.de>

Before submitting a package-update, I visit the check-results-page, as 
requested by CRAN. For my sjstats-package, there is an error on 
r-patched-solaris for package version 0.8.0:

https://www.r-project.org/nosvn/R.check/r-patched-solaris-x86/sjstats-00check.html

it says:

Waiting for profiling to be done...

  *** caught segfault ***
address f, cause 'memory not mapped'

Is this an issue with R on linux, or can this issue be solved by me as 
package-maintainer?

Best
Daniel
--

_____________________________________________________________________

Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
Vorstandsmitglieder: Prof. Dr. Burkhard G?ke (Vorsitzender), Prof. Dr. Dr. Uwe Koch-Gromus, Joachim Pr?l?, Rainer Schoppik
_____________________________________________________________________

SAVE PAPER - THINK BEFORE PRINTING

From ligges at statistik.tu-dortmund.de  Mon Feb  6 12:19:10 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 6 Feb 2017 12:19:10 +0100
Subject: [R-pkg-devel] Error in pkg Check Results
In-Reply-To: <2c657f13-ee35-3bd4-76f3-8cf081fa1932@uke.de>
References: <2c657f13-ee35-3bd4-76f3-8cf081fa1932@uke.de>
Message-ID: <d6981fc2-e9b2-b498-b4a3-ff34dfff9e97@statistik.tu-dortmund.de>



On 06.02.2017 12:09, Daniel L?decke wrote:
> Before submitting a package-update, I visit the check-results-page, as
> requested by CRAN. For my sjstats-package, there is an error on
> r-patched-solaris for package version 0.8.0:
>
> https://www.r-project.org/nosvn/R.check/r-patched-solaris-x86/sjstats-00check.html
>
>
> it says:
>
> Waiting for profiling to be done...
>
>  *** caught segfault ***
> address f, cause 'memory not mapped'
>
> Is this an issue with R on linux, or can this issue be solved by me as
> package-maintainer?
>


Well, this is on Solaris, not Linux, most likely it is an issue on your end.

Best,
Uwe Ligges




> Best
> Daniel
> --
>
> _____________________________________________________________________
>
> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen
> Rechts; Gerichtsstand: Hamburg | www.uke.de
> Vorstandsmitglieder: Prof. Dr. Burkhard G?ke (Vorsitzender), Prof. Dr.
> Dr. Uwe Koch-Gromus, Joachim Pr?l?, Rainer Schoppik
> _____________________________________________________________________
>
> SAVE PAPER - THINK BEFORE PRINTING
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From d.luedecke at uke.de  Mon Feb  6 12:24:07 2017
From: d.luedecke at uke.de (=?UTF-8?Q?Daniel_L=c3=bcdecke?=)
Date: Mon, 6 Feb 2017 12:24:07 +0100
Subject: [R-pkg-devel] Error in pkg Check Results
In-Reply-To: <d6981fc2-e9b2-b498-b4a3-ff34dfff9e97@statistik.tu-dortmund.de>
References: <2c657f13-ee35-3bd4-76f3-8cf081fa1932@uke.de>
	<d6981fc2-e9b2-b498-b4a3-ff34dfff9e97@statistik.tu-dortmund.de>
Message-ID: <c5ed0501-c6c5-571e-1555-61274173abf5@uke.de>

 > Well, this is on Solaris, not Linux, most likely it is an issue on your

Yes, I recognized this just after sending the mail I'm just curious why 
this does only happen on Solaris, and not other machines. According to 
the traceback, this error seems to occur when computing CI for glm:

Traceback:
  1: glm.fit(x = Xi, y = Y, weights = W, etastart = LP, offset = o, 
family = fam, control = fitted$control)
  2: profile.glm(object, which = parm, alpha = (1 - level)/4, trace = trace)
  3: profile(object, which = parm, alpha = (1 - level)/4, trace = trace)
  4: confint.glm(fit)
  5: stats::confint(fit)
  6: odds_to_rr(fit)

At a first look, this seems to be something I can't do much about, but I 
want to be sure to do my best to avoid errors on the various R OS platforms.

Best
Daniel

Am 06.02.2017 um 12:19 schrieb Uwe Ligges:
>
>
> On 06.02.2017 12:09, Daniel L?decke wrote:
>> Before submitting a package-update, I visit the check-results-page, as
>> requested by CRAN. For my sjstats-package, there is an error on
>> r-patched-solaris for package version 0.8.0:
>>
>> https://www.r-project.org/nosvn/R.check/r-patched-solaris-x86/sjstats-00check.html
>>
>>
>>
>> it says:
>>
>> Waiting for profiling to be done...
>>
>>  *** caught segfault ***
>> address f, cause 'memory not mapped'
>>
>> Is this an issue with R on linux, or can this issue be solved by me as
>> package-maintainer?
>>
>
>
> Well, this is on Solaris, not Linux, most likely it is an issue on your
> end.
>
> Best,
> Uwe Ligges
>
>
>
>
>> Best
>> Daniel
>> --
>>
>> _____________________________________________________________________
>>
>> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen
>> Rechts; Gerichtsstand: Hamburg | www.uke.de
>> Vorstandsmitglieder: Prof. Dr. Burkhard G?ke (Vorsitzender), Prof. Dr.
>> Dr. Uwe Koch-Gromus, Joachim Pr?l?, Rainer Schoppik
>> _____________________________________________________________________
>>
>> SAVE PAPER - THINK BEFORE PRINTING
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

-- 
Daniel L?decke, Dr. phil.

Universit?tsklinikum Hamburg-Eppendorf
Zentrum f?r Psychosoziale Medizin
Institut f?r Medizinische Soziologie
W37, 8. Stock
Martinistr. 52
D-20246 Hamburg

Tel: +49 (0)1515 2494757
Tel: +49 (0)40 7410 52878

www.uke.de/kliniken-institute/institute/medizinische-soziologie
--

_____________________________________________________________________

Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
Vorstandsmitglieder: Prof. Dr. Burkhard G?ke (Vorsitzender), Prof. Dr. Dr. Uwe Koch-Gromus, Joachim Pr?l?, Rainer Schoppik
_____________________________________________________________________

SAVE PAPER - THINK BEFORE PRINTING

From henrik.bengtsson at gmail.com  Tue Feb  7 21:16:38 2017
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Tue, 7 Feb 2017 12:16:38 -0800
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CABtg=KmumAfuXt0WEYXCo5LZHNN-=NwamETV9VVD0o=yg_p0tw@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
	<CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
	<CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>
	<CAE=-a0SHH0BybwJToJg5kcnhPbM5dQCiiUUsSZeyy8+AaZnQzA@mail.gmail.com>
	<CAE=-a0QQYoMSS-DVMkcTC6UBVgPpO9iFgZKhsMVck_TyNB=p5g@mail.gmail.com>
	<CAFDcVCQqnM8UW_=16m4woo-QV8j95zUamnE2YdTBGUxqKJPs_A@mail.gmail.com>
	<CABtg=KmumAfuXt0WEYXCo5LZHNN-=NwamETV9VVD0o=yg_p0tw@mail.gmail.com>
Message-ID: <CAFDcVCTE+Rw0M5n=D3NSHS8b-GurTi2dPCZztm2UDA4mSzXCNQ@mail.gmail.com>

On Mon, Feb 6, 2017 at 12:41 AM, G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
> I don't think it is specific for testthat. R CMD check sets R_TESTS when it
> runs the tests, so the separate R process it starts can have some special
> startup options.
>
> The problem happens if you start another R process from your R test, and
> then R_TESTS confuses this process. (I am not sure how exactly.)

I wasn't aware of R_TESTS.  Looking at the R source code, if set, will
cause the base package to source that file _before_ and .Rprofile
scripts; it basically calls source(Sys.getenv("R_TESTS")).

Next, R CMD check runs each of the test script using
R_TESTS=startup.Rs, where startup.Rs:

    file.copy(file.path(R.home("share"), "R", "tests-startup.R"), "startup.Rs")
    if (use_gct) cat("gctorture(TRUE)" , file = "startup.Rs", append = TRUE)

Looking at the tests-startup.R file that comes with my R 3.3.2 on
Ubuntu 16.04, it seems pretty harmless:

## A custom startup file for tests
## Run as if a system Rprofile, so no packages, no assignments
options(useFancyQuotes = FALSE)

So, to me it's not clear how this could make a difference in Patrick
case.   By disabling this, i.e. Sys.setenv(R_TESTS=""), I don't see
how it affects running parallel+foreach+doParallel.  Maybe because one
of those packages are relying on fancy quotes in some protocol,
passing command-line arguments or ... something.  I would be curious
to see what file.path(R.home("share"), "R", "tests-startup.R")
contains on the system where the problem occurs.

>
> A lot of packages have to work around this:
> https://github.com/search?q=user%3Acran+R_TESTS&type=Code

I wonder if those are mostly there because of cut'n'paste behavior.

>
> Most of these use testthat, but not all of them.

My interest in this issue is because I haven't yet experienced this
myself and I run lots and lots of package tests in future that
utilizes the parallel package.  In doFuture I do similar tests, which
is on top of the foreach package.   I don't use testthat and I also
don't use doParallel in my testing.

/Henrik

>
> Gabor
>
> On Mon, Feb 6, 2017 at 2:17 AM, Henrik Bengtsson
> <henrik.bengtsson at gmail.com> wrote:
>>
>> In case someone else bumps into this later and finds this thread; can
>> you confirm that this was a problem specific to using the testthat
>> package for running the tests?
>>
>> /Henrik
>>
>> On Sun, Feb 5, 2017 at 11:28 AM, Patrick Schratz
>> <patrick.schratz at gmail.com> wrote:
>> > @gaborcsardi solved it :) See here:
>> > https://github.com/hadley/testthat/issues/567#issuecomment-277536577
>> >
>> >
>> > 2017-02-05 16:07 GMT+01:00 Patrick Schratz <patrick.schratz at gmail.com>:
>> >>
>> >> Thanks for the hint, Hendrik!
>> >> However, this change did not make a difference :/
>> >>
>> >> I tried to use all cluster closing functions I came across but tests
>> >> are
>> >> still running infinite..
>> >>
>> >> cl <- makeCluster(par.args$par.units, outfile = out.progress)
>> >> registerDoParallel(cl)
>> >>
>> >> foreach()
>> >>
>> >> parallel::stopCluster(cl)
>> >> doParallel::registerDoSEQ()
>> >> doParallel::stopImplicitCluster()
>> >>
>> >> 2017-02-05 15:04 GMT+01:00 Henrik Bengtsson
>> >> <henrik.bengtsson at gmail.com>:
>> >>>
>> >>> Use
>> >>>
>> >>>   registerDoParallel(cl)
>> >>>
>> >>> The number of parallel workers is already contained in the 'cl'
>> >>> object,
>> >>> so don't specify 'cores'!  (If you do that, I suspect you create yet
>> >>> another
>> >>> cluster (a multicore one) which is used but never closed)
>> >>>
>> >>> registerDoParallel() should ideally give an error in your case. Author
>> >>> BCC:ed.
>> >>>
>> >>> Henrik
>> >>>
>> >>> On Feb 5, 2017 03:56, "Patrick Schratz" <patrick.schratz at gmail.com>
>> >>> wrote:
>> >>>>
>> >>>> Dear Uwe,
>> >>>>
>> >>>> thanks for the hint. My cluster is closed after the `foreach`call
>> >>>> using
>> >>>> `stopCluster()`.
>> >>>>
>> >>>> Before, I?ll do the following to init the cluster:
>> >>>>
>> >>>> *cl <- makeCluster(par.args$par.units, outfile = out.progress)*
>> >>>> *registerDoParallel(cl, cores = par.args$par.units)*
>> >>>>
>> >>>> *foreach()*
>> >>>>
>> >>>> *stopCluster(cl)*
>> >>>>
>> >>>>
>> >>>> Do you know of any other package which is using foreach in
>> >>>> combination
>> >>>> with
>> >>>> tests and is hosted on Github? So I could compare settings.
>> >>>>
>> >>>> Best, Patrick
>> >>>>
>> >>>> 2017-02-02 0:01 GMT+01:00 Uwe Ligges
>> >>>> <ligges at statistik.tu-dortmund.de>:
>> >>>>
>> >>>> > Check whether the parallel cluster is closed. Can it be that the
>> >>>> > cluster
>> >>>> > is still open and the check process waits for them to complete?
>> >>>> >
>> >>>> > Best,
>> >>>> > Uwe Ligges
>> >>>> >
>> >>>> >
>> >>>> >
>> >>>> > On 31.01.2017 13:45, Patrick Schratz wrote:
>> >>>> >
>> >>>> >> Hello,
>> >>>> >>
>> >>>> >> when running R CMD check / devtools::check, section "running
>> >>>> >> tests..." is
>> >>>> >> not finishing (40 min+).
>> >>>> >>
>> >>>> >> *Checking tests only works:*
>> >>>> >>
>> >>>> >> *==> Sourcing R files in 'tests' directory*
>> >>>> >>
>> >>>> >> *testthat results
>> >>>> >> ================================================================*
>> >>>> >> *OK: 7 SKIPPED: 0 FAILED: 0*
>> >>>> >>
>> >>>> >> *Tests complete*
>> >>>> >>
>> >>>> >>
>> >>>> >> As well as running tests line-by-line.
>> >>>> >>
>> >>>> >> How can I debug my tests to discover the problem during R CMD
>> >>>> >> check?
>> >>>> >>
>> >>>> >> *Tests are using parallelization (foreach + doParallel)*
>> >>>> >>
>> >>>> >> Best, Patrick
>> >>>> >>
>> >>>> >>         [[alternative HTML version deleted]]
>> >>>> >>
>> >>>> >> ______________________________________________
>> >>>> >> R-package-devel at r-project.org mailing list
>> >>>> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >>>> >>
>> >>>> >>
>> >>>>
>> >>>>         [[alternative HTML version deleted]]
>> >>>>
>> >>>> ______________________________________________
>> >>>> R-package-devel at r-project.org mailing list
>> >>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >>
>> >>
>> >
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>


From h.wickham at gmail.com  Tue Feb  7 22:19:01 2017
From: h.wickham at gmail.com (Hadley Wickham)
Date: Tue, 7 Feb 2017 15:19:01 -0600
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CAFDcVCTE+Rw0M5n=D3NSHS8b-GurTi2dPCZztm2UDA4mSzXCNQ@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
	<CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
	<CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>
	<CAE=-a0SHH0BybwJToJg5kcnhPbM5dQCiiUUsSZeyy8+AaZnQzA@mail.gmail.com>
	<CAE=-a0QQYoMSS-DVMkcTC6UBVgPpO9iFgZKhsMVck_TyNB=p5g@mail.gmail.com>
	<CAFDcVCQqnM8UW_=16m4woo-QV8j95zUamnE2YdTBGUxqKJPs_A@mail.gmail.com>
	<CABtg=KmumAfuXt0WEYXCo5LZHNN-=NwamETV9VVD0o=yg_p0tw@mail.gmail.com>
	<CAFDcVCTE+Rw0M5n=D3NSHS8b-GurTi2dPCZztm2UDA4mSzXCNQ@mail.gmail.com>
Message-ID: <CABdHhvFC79eRJ+8TDED7FQ1mD-dFwHPHPxdO28TfjXzMET6ZyA@mail.gmail.com>

>> A lot of packages have to work around this:
>> https://github.com/search?q=user%3Acran+R_TESTS&type=Code
>
> I wonder if those are mostly there because of cut'n'paste behavior.

It's not something I've ever advocated; I didn't realise there were so
many people unsetting it. (devtools does it for you)

>> Most of these use testthat, but not all of them.
>
> My interest in this issue is because I haven't yet experienced this
> myself and I run lots and lots of package tests in future that
> utilizes the parallel package.  In doFuture I do similar tests, which
> is on top of the foreach package.   I don't use testthat and I also
> don't use doParallel in my testing.

The motivation for unsetting in in devtools is to avoid problems when
you run R CMD check from inside another R CMD check. I think it
affects some behaviour deep inside R, not just fancy quoting.

Hadley

-- 
http://hadley.nz


From csardi.gabor at gmail.com  Tue Feb  7 22:34:38 2017
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Tue, 7 Feb 2017 21:34:38 +0000
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CAFDcVCTE+Rw0M5n=D3NSHS8b-GurTi2dPCZztm2UDA4mSzXCNQ@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
	<CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
	<CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>
	<CAE=-a0SHH0BybwJToJg5kcnhPbM5dQCiiUUsSZeyy8+AaZnQzA@mail.gmail.com>
	<CAE=-a0QQYoMSS-DVMkcTC6UBVgPpO9iFgZKhsMVck_TyNB=p5g@mail.gmail.com>
	<CAFDcVCQqnM8UW_=16m4woo-QV8j95zUamnE2YdTBGUxqKJPs_A@mail.gmail.com>
	<CABtg=KmumAfuXt0WEYXCo5LZHNN-=NwamETV9VVD0o=yg_p0tw@mail.gmail.com>
	<CAFDcVCTE+Rw0M5n=D3NSHS8b-GurTi2dPCZztm2UDA4mSzXCNQ@mail.gmail.com>
Message-ID: <CABtg=KnQnFmoj4dzurM7+iSV5q92xgboT3CtuE4CXape06n0DQ@mail.gmail.com>

On Tue, Feb 7, 2017 at 8:16 PM, Henrik Bengtsson <henrik.bengtsson at gmail.com
> wrote:
[...]

> I wonder if those are mostly there because of cut'n'paste behavior.
>

I don't know. What I know is that I have seen it in about 5 of my packages,
and I have also helped about 5 people that were stumbled upon it with their
own packages.

So it is definitely real. I also think that the workaround is fine. (Please
FIXME if not.) When Sys.unsetenv() is evaluated, it has already had its
effect.

G.

[...]

	[[alternative HTML version deleted]]


From csardi.gabor at gmail.com  Tue Feb  7 23:10:46 2017
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Tue, 7 Feb 2017 22:10:46 +0000
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CAFDcVCTE+Rw0M5n=D3NSHS8b-GurTi2dPCZztm2UDA4mSzXCNQ@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
	<CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
	<CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>
	<CAE=-a0SHH0BybwJToJg5kcnhPbM5dQCiiUUsSZeyy8+AaZnQzA@mail.gmail.com>
	<CAE=-a0QQYoMSS-DVMkcTC6UBVgPpO9iFgZKhsMVck_TyNB=p5g@mail.gmail.com>
	<CAFDcVCQqnM8UW_=16m4woo-QV8j95zUamnE2YdTBGUxqKJPs_A@mail.gmail.com>
	<CABtg=KmumAfuXt0WEYXCo5LZHNN-=NwamETV9VVD0o=yg_p0tw@mail.gmail.com>
	<CAFDcVCTE+Rw0M5n=D3NSHS8b-GurTi2dPCZztm2UDA4mSzXCNQ@mail.gmail.com>
Message-ID: <CABtg=Km=_03=9HheoT4ZZaQBR+rM8zVVucvO84jon5LJ+6-yNw@mail.gmail.com>

On Tue, Feb 7, 2017 at 8:16 PM, Henrik Bengtsson <henrik.bengtsson at gmail.com
> wrote:
[...]

>
> So, to me it's not clear how this could make a difference in Patrick
> case.   By disabling this, i.e. Sys.setenv(R_TESTS=""), I don't see
> how it affects running parallel+foreach+doParallel.  Maybe because one
> of those packages are relying on fancy quotes in some protocol,
> passing command-line arguments or ... something.  I would be curious
> to see what file.path(R.home("share"), "R", "tests-startup.R")
> contains on the system where the problem occurs.
>

I investigated a bit, and the problem (or at least one problem) is that the
R subprocess will try
to source() startup.Rs from the working directory, and that file might not
be there.
For testthat, the tests run in tests/testthat, and it is typically not
there.

For other regular tests, RUnit, etc. AFAIK the tests run in tests/ and
startup.Rs is
there. Unless the tests change the working directory, in which case it is
not.
So another workaround is to put an empty startup.Rs file there.

Maybe there are other problems as well, but just putting an empty
startup.Rs file at the appropriate
location fixed all cases I tried.

The parallel case above in this thread is a bit unusual I think, because
usually there
is no freeze, the R subprocess just aborts, and this typically causes a
testthat (or other) test
failure.

Nevertheless, putting an empty startup.Rs file in tests/testthat fixes the
testParallel
package as well.

G


>
> >
> > A lot of packages have to work around this:
> > https://github.com/search?q=user%3Acran+R_TESTS&type=Code
>
> I wonder if those are mostly there because of cut'n'paste behavior.
>
> >
> > Most of these use testthat, but not all of them.
>
> My interest in this issue is because I haven't yet experienced this
> myself and I run lots and lots of package tests in future that
> utilizes the parallel package.  In doFuture I do similar tests, which
> is on top of the foreach package.   I don't use testthat and I also
> don't use doParallel in my testing.
>
> /Henrik
>
> >
> > Gabor
> >
> > On Mon, Feb 6, 2017 at 2:17 AM, Henrik Bengtsson
> > <henrik.bengtsson at gmail.com> wrote:
> >>
> >> In case someone else bumps into this later and finds this thread; can
> >> you confirm that this was a problem specific to using the testthat
> >> package for running the tests?
> >>
> >> /Henrik
> >>
> >> On Sun, Feb 5, 2017 at 11:28 AM, Patrick Schratz
> >> <patrick.schratz at gmail.com> wrote:
> >> > @gaborcsardi solved it :) See here:
> >> > https://github.com/hadley/testthat/issues/567#issuecomment-277536577
> >> >
> >> >
> >> > 2017-02-05 16:07 GMT+01:00 Patrick Schratz <patrick.schratz at gmail.com
> >:
> >> >>
> >> >> Thanks for the hint, Hendrik!
> >> >> However, this change did not make a difference :/
> >> >>
> >> >> I tried to use all cluster closing functions I came across but tests
> >> >> are
> >> >> still running infinite..
> >> >>
> >> >> cl <- makeCluster(par.args$par.units, outfile = out.progress)
> >> >> registerDoParallel(cl)
> >> >>
> >> >> foreach()
> >> >>
> >> >> parallel::stopCluster(cl)
> >> >> doParallel::registerDoSEQ()
> >> >> doParallel::stopImplicitCluster()
> >> >>
> >> >> 2017-02-05 15:04 GMT+01:00 Henrik Bengtsson
> >> >> <henrik.bengtsson at gmail.com>:
> >> >>>
> >> >>> Use
> >> >>>
> >> >>>   registerDoParallel(cl)
> >> >>>
> >> >>> The number of parallel workers is already contained in the 'cl'
> >> >>> object,
> >> >>> so don't specify 'cores'!  (If you do that, I suspect you create yet
> >> >>> another
> >> >>> cluster (a multicore one) which is used but never closed)
> >> >>>
> >> >>> registerDoParallel() should ideally give an error in your case.
> Author
> >> >>> BCC:ed.
> >> >>>
> >> >>> Henrik
> >> >>>
> >> >>> On Feb 5, 2017 03:56, "Patrick Schratz" <patrick.schratz at gmail.com>
> >> >>> wrote:
> >> >>>>
> >> >>>> Dear Uwe,
> >> >>>>
> >> >>>> thanks for the hint. My cluster is closed after the `foreach`call
> >> >>>> using
> >> >>>> `stopCluster()`.
> >> >>>>
> >> >>>> Before, I?ll do the following to init the cluster:
> >> >>>>
> >> >>>> *cl <- makeCluster(par.args$par.units, outfile = out.progress)*
> >> >>>> *registerDoParallel(cl, cores = par.args$par.units)*
> >> >>>>
> >> >>>> *foreach()*
> >> >>>>
> >> >>>> *stopCluster(cl)*
> >> >>>>
> >> >>>>
> >> >>>> Do you know of any other package which is using foreach in
> >> >>>> combination
> >> >>>> with
> >> >>>> tests and is hosted on Github? So I could compare settings.
> >> >>>>
> >> >>>> Best, Patrick
> >> >>>>
> >> >>>> 2017-02-02 0:01 GMT+01:00 Uwe Ligges
> >> >>>> <ligges at statistik.tu-dortmund.de>:
> >> >>>>
> >> >>>> > Check whether the parallel cluster is closed. Can it be that the
> >> >>>> > cluster
> >> >>>> > is still open and the check process waits for them to complete?
> >> >>>> >
> >> >>>> > Best,
> >> >>>> > Uwe Ligges
> >> >>>> >
> >> >>>> >
> >> >>>> >
> >> >>>> > On 31.01.2017 13:45, Patrick Schratz wrote:
> >> >>>> >
> >> >>>> >> Hello,
> >> >>>> >>
> >> >>>> >> when running R CMD check / devtools::check, section "running
> >> >>>> >> tests..." is
> >> >>>> >> not finishing (40 min+).
> >> >>>> >>
> >> >>>> >> *Checking tests only works:*
> >> >>>> >>
> >> >>>> >> *==> Sourcing R files in 'tests' directory*
> >> >>>> >>
> >> >>>> >> *testthat results
> >> >>>> >> ============================================================
> ====*
> >> >>>> >> *OK: 7 SKIPPED: 0 FAILED: 0*
> >> >>>> >>
> >> >>>> >> *Tests complete*
> >> >>>> >>
> >> >>>> >>
> >> >>>> >> As well as running tests line-by-line.
> >> >>>> >>
> >> >>>> >> How can I debug my tests to discover the problem during R CMD
> >> >>>> >> check?
> >> >>>> >>
> >> >>>> >> *Tests are using parallelization (foreach + doParallel)*
> >> >>>> >>
> >> >>>> >> Best, Patrick
> >> >>>> >>
> >> >>>> >>         [[alternative HTML version deleted]]
> >> >>>> >>
> >> >>>> >> ______________________________________________
> >> >>>> >> R-package-devel at r-project.org mailing list
> >> >>>> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >> >>>> >>
> >> >>>> >>
> >> >>>>
> >> >>>>         [[alternative HTML version deleted]]
> >> >>>>
> >> >>>> ______________________________________________
> >> >>>> R-package-devel at r-project.org mailing list
> >> >>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >> >>
> >> >>
> >> >
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
> >
>

	[[alternative HTML version deleted]]


From patrick.schratz at gmail.com  Tue Feb  7 23:16:28 2017
From: patrick.schratz at gmail.com (Patrick Schratz)
Date: Tue, 7 Feb 2017 23:16:28 +0100
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CAFDcVCTE+Rw0M5n=D3NSHS8b-GurTi2dPCZztm2UDA4mSzXCNQ@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
	<CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
	<CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>
	<CAE=-a0SHH0BybwJToJg5kcnhPbM5dQCiiUUsSZeyy8+AaZnQzA@mail.gmail.com>
	<CAE=-a0QQYoMSS-DVMkcTC6UBVgPpO9iFgZKhsMVck_TyNB=p5g@mail.gmail.com>
	<CAFDcVCQqnM8UW_=16m4woo-QV8j95zUamnE2YdTBGUxqKJPs_A@mail.gmail.com>
	<CABtg=KmumAfuXt0WEYXCo5LZHNN-=NwamETV9VVD0o=yg_p0tw@mail.gmail.com>
	<CAFDcVCTE+Rw0M5n=D3NSHS8b-GurTi2dPCZztm2UDA4mSzXCNQ@mail.gmail.com>
Message-ID: <CAE=-a0Tuv0v28aOV-QL2H4Znxf2TTnojxmrk8LcHQ7Nybv+SHw@mail.gmail.com>

>
> I would be curious
> to see what file.path(R.home("share"), "R", "tests-startup.R")
> contains on the system where the problem occurs.


Contents of mine on macOS are the same as on your Ubuntu:

## A custom startup file for tests
## Run as if a system Rprofile, so no packages, no assignments
options(useFancyQuotes = FALSE)

By disabling this, i.e. Sys.setenv(R_TESTS="")


Note that the fix from Gabor is Sys.unsetenv("R_TESTS"). What?s the
difference between both?

My interest in this issue is because I haven't yet experienced this
> myself and I run lots and lots of package tests in future that
> utilizes the parallel package.


So if you use `foreach` and `parallel`, the major difference points to
`doParallel`. If I get my tests running by avoiding `doParallel`, we would
have some kind of evidence.
Any source on how to quickly substitute my `doParallel` code using
`parallel`? I know its just a few lines, but thats how it always starts..;)

2017-02-07 21:16 GMT+01:00 Henrik Bengtsson <henrik.bengtsson at gmail.com>:

> On Mon, Feb 6, 2017 at 12:41 AM, G?bor Cs?rdi <csardi.gabor at gmail.com>
> wrote:
> > I don't think it is specific for testthat. R CMD check sets R_TESTS when
> it
> > runs the tests, so the separate R process it starts can have some special
> > startup options.
> >
> > The problem happens if you start another R process from your R test, and
> > then R_TESTS confuses this process. (I am not sure how exactly.)
>
> I wasn't aware of R_TESTS.  Looking at the R source code, if set, will
> cause the base package to source that file _before_ and .Rprofile
> scripts; it basically calls source(Sys.getenv("R_TESTS")).
>
> Next, R CMD check runs each of the test script using
> R_TESTS=startup.Rs, where startup.Rs:
>
>     file.copy(file.path(R.home("share"), "R", "tests-startup.R"),
> "startup.Rs")
>     if (use_gct) cat("gctorture(TRUE)" , file = "startup.Rs", append =
> TRUE)
>
> Looking at the tests-startup.R file that comes with my R 3.3.2 on
> Ubuntu 16.04, it seems pretty harmless:
>
> ## A custom startup file for tests
> ## Run as if a system Rprofile, so no packages, no assignments
> options(useFancyQuotes = FALSE)
>
> So, to me it's not clear how this could make a difference in Patrick
> case.   By disabling this, i.e. Sys.setenv(R_TESTS=""), I don't see
> how it affects running parallel+foreach+doParallel.  Maybe because one
> of those packages are relying on fancy quotes in some protocol,
> passing command-line arguments or ... something.  I would be curious
> to see what file.path(R.home("share"), "R", "tests-startup.R")
> contains on the system where the problem occurs.
>
> >
> > A lot of packages have to work around this:
> > https://github.com/search?q=user%3Acran+R_TESTS&type=Code
>
> I wonder if those are mostly there because of cut'n'paste behavior.
>
> >
> > Most of these use testthat, but not all of them.
>
> My interest in this issue is because I haven't yet experienced this
> myself and I run lots and lots of package tests in future that
> utilizes the parallel package.  In doFuture I do similar tests, which
> is on top of the foreach package.   I don't use testthat and I also
> don't use doParallel in my testing.
>
> /Henrik
>
> >
> > Gabor
> >
> > On Mon, Feb 6, 2017 at 2:17 AM, Henrik Bengtsson
> > <henrik.bengtsson at gmail.com> wrote:
> >>
> >> In case someone else bumps into this later and finds this thread; can
> >> you confirm that this was a problem specific to using the testthat
> >> package for running the tests?
> >>
> >> /Henrik
> >>
> >> On Sun, Feb 5, 2017 at 11:28 AM, Patrick Schratz
> >> <patrick.schratz at gmail.com> wrote:
> >> > @gaborcsardi solved it :) See here:
> >> > https://github.com/hadley/testthat/issues/567#issuecomment-277536577
> >> >
> >> >
> >> > 2017-02-05 16:07 GMT+01:00 Patrick Schratz <patrick.schratz at gmail.com
> >:
> >> >>
> >> >> Thanks for the hint, Hendrik!
> >> >> However, this change did not make a difference :/
> >> >>
> >> >> I tried to use all cluster closing functions I came across but tests
> >> >> are
> >> >> still running infinite..
> >> >>
> >> >> cl <- makeCluster(par.args$par.units, outfile = out.progress)
> >> >> registerDoParallel(cl)
> >> >>
> >> >> foreach()
> >> >>
> >> >> parallel::stopCluster(cl)
> >> >> doParallel::registerDoSEQ()
> >> >> doParallel::stopImplicitCluster()
> >> >>
> >> >> 2017-02-05 15:04 GMT+01:00 Henrik Bengtsson
> >> >> <henrik.bengtsson at gmail.com>:
> >> >>>
> >> >>> Use
> >> >>>
> >> >>>   registerDoParallel(cl)
> >> >>>
> >> >>> The number of parallel workers is already contained in the 'cl'
> >> >>> object,
> >> >>> so don't specify 'cores'!  (If you do that, I suspect you create yet
> >> >>> another
> >> >>> cluster (a multicore one) which is used but never closed)
> >> >>>
> >> >>> registerDoParallel() should ideally give an error in your case.
> Author
> >> >>> BCC:ed.
> >> >>>
> >> >>> Henrik
> >> >>>
> >> >>> On Feb 5, 2017 03:56, "Patrick Schratz" <patrick.schratz at gmail.com>
> >> >>> wrote:
> >> >>>>
> >> >>>> Dear Uwe,
> >> >>>>
> >> >>>> thanks for the hint. My cluster is closed after the `foreach`call
> >> >>>> using
> >> >>>> `stopCluster()`.
> >> >>>>
> >> >>>> Before, I?ll do the following to init the cluster:
> >> >>>>
> >> >>>> *cl <- makeCluster(par.args$par.units, outfile = out.progress)*
> >> >>>> *registerDoParallel(cl, cores = par.args$par.units)*
> >> >>>>
> >> >>>> *foreach()*
> >> >>>>
> >> >>>> *stopCluster(cl)*
> >> >>>>
> >> >>>>
> >> >>>> Do you know of any other package which is using foreach in
> >> >>>> combination
> >> >>>> with
> >> >>>> tests and is hosted on Github? So I could compare settings.
> >> >>>>
> >> >>>> Best, Patrick
> >> >>>>
> >> >>>> 2017-02-02 0:01 GMT+01:00 Uwe Ligges
> >> >>>> <ligges at statistik.tu-dortmund.de>:
> >> >>>>
> >> >>>> > Check whether the parallel cluster is closed. Can it be that the
> >> >>>> > cluster
> >> >>>> > is still open and the check process waits for them to complete?
> >> >>>> >
> >> >>>> > Best,
> >> >>>> > Uwe Ligges
> >> >>>> >
> >> >>>> >
> >> >>>> >
> >> >>>> > On 31.01.2017 13:45, Patrick Schratz wrote:
> >> >>>> >
> >> >>>> >> Hello,
> >> >>>> >>
> >> >>>> >> when running R CMD check / devtools::check, section "running
> >> >>>> >> tests..." is
> >> >>>> >> not finishing (40 min+).
> >> >>>> >>
> >> >>>> >> *Checking tests only works:*
> >> >>>> >>
> >> >>>> >> *==> Sourcing R files in 'tests' directory*
> >> >>>> >>
> >> >>>> >> *testthat results
> >> >>>> >> ============================================================
> ====*
> >> >>>> >> *OK: 7 SKIPPED: 0 FAILED: 0*
> >> >>>> >>
> >> >>>> >> *Tests complete*
> >> >>>> >>
> >> >>>> >>
> >> >>>> >> As well as running tests line-by-line.
> >> >>>> >>
> >> >>>> >> How can I debug my tests to discover the problem during R CMD
> >> >>>> >> check?
> >> >>>> >>
> >> >>>> >> *Tests are using parallelization (foreach + doParallel)*
> >> >>>> >>
> >> >>>> >> Best, Patrick
> >> >>>> >>
> >> >>>> >>         [[alternative HTML version deleted]]
> >> >>>> >>
> >> >>>> >> ______________________________________________
> >> >>>> >> R-package-devel at r-project.org mailing list
> >> >>>> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >> >>>> >>
> >> >>>> >>
> >> >>>>
> >> >>>>         [[alternative HTML version deleted]]
> >> >>>>
> >> >>>> ______________________________________________
> >> >>>> R-package-devel at r-project.org mailing list
> >> >>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >> >>
> >> >>
> >> >
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
> >
>

	[[alternative HTML version deleted]]


From patrick.schratz at gmail.com  Tue Feb  7 23:26:14 2017
From: patrick.schratz at gmail.com (Patrick Schratz)
Date: Tue, 7 Feb 2017 23:26:14 +0100
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CABtg=Km=_03=9HheoT4ZZaQBR+rM8zVVucvO84jon5LJ+6-yNw@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
	<CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
	<CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>
	<CAE=-a0SHH0BybwJToJg5kcnhPbM5dQCiiUUsSZeyy8+AaZnQzA@mail.gmail.com>
	<CAE=-a0QQYoMSS-DVMkcTC6UBVgPpO9iFgZKhsMVck_TyNB=p5g@mail.gmail.com>
	<CAFDcVCQqnM8UW_=16m4woo-QV8j95zUamnE2YdTBGUxqKJPs_A@mail.gmail.com>
	<CABtg=KmumAfuXt0WEYXCo5LZHNN-=NwamETV9VVD0o=yg_p0tw@mail.gmail.com>
	<CAFDcVCTE+Rw0M5n=D3NSHS8b-GurTi2dPCZztm2UDA4mSzXCNQ@mail.gmail.com>
	<CABtg=Km=_03=9HheoT4ZZaQBR+rM8zVVucvO84jon5LJ+6-yNw@mail.gmail.com>
Message-ID: <CAE=-a0SqeneyuR=6vFnLBw1=6m8=9Dw9nnroCGVg+Pxr4WjBfA@mail.gmail.com>

>
> Nevertheless, putting an empty startup.Rs file in tests/testthat fixes the
> testParallel
> package as well.


Works for me as well!

2017-02-07 23:10 GMT+01:00 G?bor Cs?rdi <csardi.gabor at gmail.com>:

> On Tue, Feb 7, 2017 at 8:16 PM, Henrik Bengtsson <
> henrik.bengtsson at gmail.com> wrote:
> [...]
>
>>
>> So, to me it's not clear how this could make a difference in Patrick
>> case.   By disabling this, i.e. Sys.setenv(R_TESTS=""), I don't see
>> how it affects running parallel+foreach+doParallel.  Maybe because one
>> of those packages are relying on fancy quotes in some protocol,
>> passing command-line arguments or ... something.  I would be curious
>> to see what file.path(R.home("share"), "R", "tests-startup.R")
>> contains on the system where the problem occurs.
>>
>
> I investigated a bit, and the problem (or at least one problem) is that
> the R subprocess will try
> to source() startup.Rs from the working directory, and that file might not
> be there.
> For testthat, the tests run in tests/testthat, and it is typically not
> there.
>
> For other regular tests, RUnit, etc. AFAIK the tests run in tests/ and
> startup.Rs is
> there. Unless the tests change the working directory, in which case it is
> not.
> So another workaround is to put an empty startup.Rs file there.
>
> Maybe there are other problems as well, but just putting an empty
> startup.Rs file at the appropriate
> location fixed all cases I tried.
>
> The parallel case above in this thread is a bit unusual I think, because
> usually there
> is no freeze, the R subprocess just aborts, and this typically causes a
> testthat (or other) test
> failure.
>
> Nevertheless, putting an empty startup.Rs file in tests/testthat fixes the
> testParallel
> package as well.
>
> G
>
>
>>
>> >
>> > A lot of packages have to work around this:
>> > https://github.com/search?q=user%3Acran+R_TESTS&type=Code
>>
>> I wonder if those are mostly there because of cut'n'paste behavior.
>>
>> >
>> > Most of these use testthat, but not all of them.
>>
>> My interest in this issue is because I haven't yet experienced this
>> myself and I run lots and lots of package tests in future that
>> utilizes the parallel package.  In doFuture I do similar tests, which
>> is on top of the foreach package.   I don't use testthat and I also
>> don't use doParallel in my testing.
>>
>> /Henrik
>>
>> >
>> > Gabor
>> >
>> > On Mon, Feb 6, 2017 at 2:17 AM, Henrik Bengtsson
>> > <henrik.bengtsson at gmail.com> wrote:
>> >>
>> >> In case someone else bumps into this later and finds this thread; can
>> >> you confirm that this was a problem specific to using the testthat
>> >> package for running the tests?
>> >>
>> >> /Henrik
>> >>
>> >> On Sun, Feb 5, 2017 at 11:28 AM, Patrick Schratz
>> >> <patrick.schratz at gmail.com> wrote:
>> >> > @gaborcsardi solved it :) See here:
>> >> > https://github.com/hadley/testthat/issues/567#issuecomment-277536577
>> >> >
>> >> >
>> >> > 2017-02-05 16:07 GMT+01:00 Patrick Schratz <
>> patrick.schratz at gmail.com>:
>> >> >>
>> >> >> Thanks for the hint, Hendrik!
>> >> >> However, this change did not make a difference :/
>> >> >>
>> >> >> I tried to use all cluster closing functions I came across but tests
>> >> >> are
>> >> >> still running infinite..
>> >> >>
>> >> >> cl <- makeCluster(par.args$par.units, outfile = out.progress)
>> >> >> registerDoParallel(cl)
>> >> >>
>> >> >> foreach()
>> >> >>
>> >> >> parallel::stopCluster(cl)
>> >> >> doParallel::registerDoSEQ()
>> >> >> doParallel::stopImplicitCluster()
>> >> >>
>> >> >> 2017-02-05 15:04 GMT+01:00 Henrik Bengtsson
>> >> >> <henrik.bengtsson at gmail.com>:
>> >> >>>
>> >> >>> Use
>> >> >>>
>> >> >>>   registerDoParallel(cl)
>> >> >>>
>> >> >>> The number of parallel workers is already contained in the 'cl'
>> >> >>> object,
>> >> >>> so don't specify 'cores'!  (If you do that, I suspect you create
>> yet
>> >> >>> another
>> >> >>> cluster (a multicore one) which is used but never closed)
>> >> >>>
>> >> >>> registerDoParallel() should ideally give an error in your case.
>> Author
>> >> >>> BCC:ed.
>> >> >>>
>> >> >>> Henrik
>> >> >>>
>> >> >>> On Feb 5, 2017 03:56, "Patrick Schratz" <patrick.schratz at gmail.com
>> >
>> >> >>> wrote:
>> >> >>>>
>> >> >>>> Dear Uwe,
>> >> >>>>
>> >> >>>> thanks for the hint. My cluster is closed after the `foreach`call
>> >> >>>> using
>> >> >>>> `stopCluster()`.
>> >> >>>>
>> >> >>>> Before, I?ll do the following to init the cluster:
>> >> >>>>
>> >> >>>> *cl <- makeCluster(par.args$par.units, outfile = out.progress)*
>> >> >>>> *registerDoParallel(cl, cores = par.args$par.units)*
>> >> >>>>
>> >> >>>> *foreach()*
>> >> >>>>
>> >> >>>> *stopCluster(cl)*
>> >> >>>>
>> >> >>>>
>> >> >>>> Do you know of any other package which is using foreach in
>> >> >>>> combination
>> >> >>>> with
>> >> >>>> tests and is hosted on Github? So I could compare settings.
>> >> >>>>
>> >> >>>> Best, Patrick
>> >> >>>>
>> >> >>>> 2017-02-02 0:01 GMT+01:00 Uwe Ligges
>> >> >>>> <ligges at statistik.tu-dortmund.de>:
>> >> >>>>
>> >> >>>> > Check whether the parallel cluster is closed. Can it be that the
>> >> >>>> > cluster
>> >> >>>> > is still open and the check process waits for them to complete?
>> >> >>>> >
>> >> >>>> > Best,
>> >> >>>> > Uwe Ligges
>> >> >>>> >
>> >> >>>> >
>> >> >>>> >
>> >> >>>> > On 31.01.2017 13:45, Patrick Schratz wrote:
>> >> >>>> >
>> >> >>>> >> Hello,
>> >> >>>> >>
>> >> >>>> >> when running R CMD check / devtools::check, section "running
>> >> >>>> >> tests..." is
>> >> >>>> >> not finishing (40 min+).
>> >> >>>> >>
>> >> >>>> >> *Checking tests only works:*
>> >> >>>> >>
>> >> >>>> >> *==> Sourcing R files in 'tests' directory*
>> >> >>>> >>
>> >> >>>> >> *testthat results
>> >> >>>> >> ============================================================
>> ====*
>> >> >>>> >> *OK: 7 SKIPPED: 0 FAILED: 0*
>> >> >>>> >>
>> >> >>>> >> *Tests complete*
>> >> >>>> >>
>> >> >>>> >>
>> >> >>>> >> As well as running tests line-by-line.
>> >> >>>> >>
>> >> >>>> >> How can I debug my tests to discover the problem during R CMD
>> >> >>>> >> check?
>> >> >>>> >>
>> >> >>>> >> *Tests are using parallelization (foreach + doParallel)*
>> >> >>>> >>
>> >> >>>> >> Best, Patrick
>> >> >>>> >>
>> >> >>>> >>         [[alternative HTML version deleted]]
>> >> >>>> >>
>> >> >>>> >> ______________________________________________
>> >> >>>> >> R-package-devel at r-project.org mailing list
>> >> >>>> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >> >>>> >>
>> >> >>>> >>
>> >> >>>>
>> >> >>>>         [[alternative HTML version deleted]]
>> >> >>>>
>> >> >>>> ______________________________________________
>> >> >>>> R-package-devel at r-project.org mailing list
>> >> >>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >> >>
>> >> >>
>> >> >
>> >>
>> >> ______________________________________________
>> >> R-package-devel at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >
>> >
>>
>
>

	[[alternative HTML version deleted]]


From henrik.bengtsson at gmail.com  Tue Feb  7 23:44:18 2017
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Tue, 7 Feb 2017 14:44:18 -0800
Subject: [R-pkg-devel] R CMD Check: Tests running infinite
In-Reply-To: <CABtg=Km=_03=9HheoT4ZZaQBR+rM8zVVucvO84jon5LJ+6-yNw@mail.gmail.com>
References: <CAE=-a0QfAd5GwsmVNJH03UHkJHtvhiWMuSE0G1YK_Z5Y8vWoEA@mail.gmail.com>
	<5d982a02-7517-ae28-c2fb-67f286ff45c7@statistik.tu-dortmund.de>
	<CAE=-a0TF7gg6V97KFHm_xYF9gVtPJad9TqxeX+AdsBtHZq72yQ@mail.gmail.com>
	<CAFDcVCTmzSAez4XwmPLh76065CSyyKVNQxYp2jVaLuytCe6_cQ@mail.gmail.com>
	<CAE=-a0SHH0BybwJToJg5kcnhPbM5dQCiiUUsSZeyy8+AaZnQzA@mail.gmail.com>
	<CAE=-a0QQYoMSS-DVMkcTC6UBVgPpO9iFgZKhsMVck_TyNB=p5g@mail.gmail.com>
	<CAFDcVCQqnM8UW_=16m4woo-QV8j95zUamnE2YdTBGUxqKJPs_A@mail.gmail.com>
	<CABtg=KmumAfuXt0WEYXCo5LZHNN-=NwamETV9VVD0o=yg_p0tw@mail.gmail.com>
	<CAFDcVCTE+Rw0M5n=D3NSHS8b-GurTi2dPCZztm2UDA4mSzXCNQ@mail.gmail.com>
	<CABtg=Km=_03=9HheoT4ZZaQBR+rM8zVVucvO84jon5LJ+6-yNw@mail.gmail.com>
Message-ID: <CAFDcVCTo3Pd-WbKWyXYqpc9a3ziC_90Wwi2b5qXLVKj=3LSvLQ@mail.gmail.com>

On Tue, Feb 7, 2017 at 2:10 PM, G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
> On Tue, Feb 7, 2017 at 8:16 PM, Henrik Bengtsson
> <henrik.bengtsson at gmail.com> wrote:
> [...]
>>
>>
>> So, to me it's not clear how this could make a difference in Patrick
>> case.   By disabling this, i.e. Sys.setenv(R_TESTS=""), I don't see
>> how it affects running parallel+foreach+doParallel.  Maybe because one
>> of those packages are relying on fancy quotes in some protocol,
>> passing command-line arguments or ... something.  I would be curious
>> to see what file.path(R.home("share"), "R", "tests-startup.R")
>> contains on the system where the problem occurs.
>
>
> I investigated a bit, and the problem (or at least one problem) is that the
> R subprocess will try
> to source() startup.Rs from the working directory, and that file might not
> be there.
> For testthat, the tests run in tests/testthat, and it is typically not
> there.

Ah... that makes sence, because R CMD check passes/sets
R_TESTS=startup.Rs specifying only a relative pathname.  From runone()
part of src/library/tools/R/testing.R:

        if (WINDOWS) {
            Sys.setenv(LANGUAGE="C")
            Sys.setenv(R_TESTS="startup.Rs")
        } else
            cmd <- paste("LANGUAGE=C", "R_TESTS=startup.Rs", cmd)

Maybe a more robust version would be to use something like:

        if (WINDOWS) {
            Sys.setenv(LANGUAGE="C")
            Sys.setenv(R_TESTS=normalizePath("startup.Rs"))
        } else
            cmd <- paste("LANGUAGE=C", paste0("R_TESTS=",
normalizePath("startup.Rs")), cmd)

On the other hand, if it should be assumed that the test is run in the
same directory as startup.Rs, then testthat, and other test frameworks
that don't run under tests/, could copy startup.Rs as:

   local({
      fn <- Sys.getenv("R_TESTS")
      if (nzchar(fn) && file_test("-f", pn <- file.path("..", fn)))
file.copy(pn, fn)
   })


@Patrick,

>> By disabling this, i.e. Sys.setenv(R_TESTS="")
>
> Note that the fix from Gabor is Sys.unsetenv("R_TESTS"). What?s the difference between both?

My bad; Sys.unsetenv("R_TESTS") is the *correct* way to unset an env
variable.  My approach sets it to an empty string, which also happens
to work because the test to source the file or not is based on
nzchar(Sys.setenv("R_TESTS")) == TRUE.

/Henrik

>
> For other regular tests, RUnit, etc. AFAIK the tests run in tests/ and
> startup.Rs is
> there. Unless the tests change the working directory, in which case it is
> not.
> So another workaround is to put an empty startup.Rs file there.
>
> Maybe there are other problems as well, but just putting an empty startup.Rs
> file at the appropriate
> location fixed all cases I tried.
>
> The parallel case above in this thread is a bit unusual I think, because
> usually there
> is no freeze, the R subprocess just aborts, and this typically causes a
> testthat (or other) test
> failure.
>
> Nevertheless, putting an empty startup.Rs file in tests/testthat fixes the
> testParallel
> package as well.
>
> G
>
>>
>>
>> >
>> > A lot of packages have to work around this:
>> > https://github.com/search?q=user%3Acran+R_TESTS&type=Code
>>
>> I wonder if those are mostly there because of cut'n'paste behavior.
>>
>> >
>> > Most of these use testthat, but not all of them.
>>
>> My interest in this issue is because I haven't yet experienced this
>> myself and I run lots and lots of package tests in future that
>> utilizes the parallel package.  In doFuture I do similar tests, which
>> is on top of the foreach package.   I don't use testthat and I also
>> don't use doParallel in my testing.
>>
>> /Henrik
>>
>> >
>> > Gabor
>> >
>> > On Mon, Feb 6, 2017 at 2:17 AM, Henrik Bengtsson
>> > <henrik.bengtsson at gmail.com> wrote:
>> >>
>> >> In case someone else bumps into this later and finds this thread; can
>> >> you confirm that this was a problem specific to using the testthat
>> >> package for running the tests?
>> >>
>> >> /Henrik
>> >>
>> >> On Sun, Feb 5, 2017 at 11:28 AM, Patrick Schratz
>> >> <patrick.schratz at gmail.com> wrote:
>> >> > @gaborcsardi solved it :) See here:
>> >> > https://github.com/hadley/testthat/issues/567#issuecomment-277536577
>> >> >
>> >> >
>> >> > 2017-02-05 16:07 GMT+01:00 Patrick Schratz
>> >> > <patrick.schratz at gmail.com>:
>> >> >>
>> >> >> Thanks for the hint, Hendrik!
>> >> >> However, this change did not make a difference :/
>> >> >>
>> >> >> I tried to use all cluster closing functions I came across but tests
>> >> >> are
>> >> >> still running infinite..
>> >> >>
>> >> >> cl <- makeCluster(par.args$par.units, outfile = out.progress)
>> >> >> registerDoParallel(cl)
>> >> >>
>> >> >> foreach()
>> >> >>
>> >> >> parallel::stopCluster(cl)
>> >> >> doParallel::registerDoSEQ()
>> >> >> doParallel::stopImplicitCluster()
>> >> >>
>> >> >> 2017-02-05 15:04 GMT+01:00 Henrik Bengtsson
>> >> >> <henrik.bengtsson at gmail.com>:
>> >> >>>
>> >> >>> Use
>> >> >>>
>> >> >>>   registerDoParallel(cl)
>> >> >>>
>> >> >>> The number of parallel workers is already contained in the 'cl'
>> >> >>> object,
>> >> >>> so don't specify 'cores'!  (If you do that, I suspect you create
>> >> >>> yet
>> >> >>> another
>> >> >>> cluster (a multicore one) which is used but never closed)
>> >> >>>
>> >> >>> registerDoParallel() should ideally give an error in your case.
>> >> >>> Author
>> >> >>> BCC:ed.
>> >> >>>
>> >> >>> Henrik
>> >> >>>
>> >> >>> On Feb 5, 2017 03:56, "Patrick Schratz" <patrick.schratz at gmail.com>
>> >> >>> wrote:
>> >> >>>>
>> >> >>>> Dear Uwe,
>> >> >>>>
>> >> >>>> thanks for the hint. My cluster is closed after the `foreach`call
>> >> >>>> using
>> >> >>>> `stopCluster()`.
>> >> >>>>
>> >> >>>> Before, I?ll do the following to init the cluster:
>> >> >>>>
>> >> >>>> *cl <- makeCluster(par.args$par.units, outfile = out.progress)*
>> >> >>>> *registerDoParallel(cl, cores = par.args$par.units)*
>> >> >>>>
>> >> >>>> *foreach()*
>> >> >>>>
>> >> >>>> *stopCluster(cl)*
>> >> >>>>
>> >> >>>>
>> >> >>>> Do you know of any other package which is using foreach in
>> >> >>>> combination
>> >> >>>> with
>> >> >>>> tests and is hosted on Github? So I could compare settings.
>> >> >>>>
>> >> >>>> Best, Patrick
>> >> >>>>
>> >> >>>> 2017-02-02 0:01 GMT+01:00 Uwe Ligges
>> >> >>>> <ligges at statistik.tu-dortmund.de>:
>> >> >>>>
>> >> >>>> > Check whether the parallel cluster is closed. Can it be that the
>> >> >>>> > cluster
>> >> >>>> > is still open and the check process waits for them to complete?
>> >> >>>> >
>> >> >>>> > Best,
>> >> >>>> > Uwe Ligges
>> >> >>>> >
>> >> >>>> >
>> >> >>>> >
>> >> >>>> > On 31.01.2017 13:45, Patrick Schratz wrote:
>> >> >>>> >
>> >> >>>> >> Hello,
>> >> >>>> >>
>> >> >>>> >> when running R CMD check / devtools::check, section "running
>> >> >>>> >> tests..." is
>> >> >>>> >> not finishing (40 min+).
>> >> >>>> >>
>> >> >>>> >> *Checking tests only works:*
>> >> >>>> >>
>> >> >>>> >> *==> Sourcing R files in 'tests' directory*
>> >> >>>> >>
>> >> >>>> >> *testthat results
>> >> >>>> >>
>> >> >>>> >> ================================================================*
>> >> >>>> >> *OK: 7 SKIPPED: 0 FAILED: 0*
>> >> >>>> >>
>> >> >>>> >> *Tests complete*
>> >> >>>> >>
>> >> >>>> >>
>> >> >>>> >> As well as running tests line-by-line.
>> >> >>>> >>
>> >> >>>> >> How can I debug my tests to discover the problem during R CMD
>> >> >>>> >> check?
>> >> >>>> >>
>> >> >>>> >> *Tests are using parallelization (foreach + doParallel)*
>> >> >>>> >>
>> >> >>>> >> Best, Patrick
>> >> >>>> >>
>> >> >>>> >>         [[alternative HTML version deleted]]
>> >> >>>> >>
>> >> >>>> >> ______________________________________________
>> >> >>>> >> R-package-devel at r-project.org mailing list
>> >> >>>> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >> >>>> >>
>> >> >>>> >>
>> >> >>>>
>> >> >>>>         [[alternative HTML version deleted]]
>> >> >>>>
>> >> >>>> ______________________________________________
>> >> >>>> R-package-devel at r-project.org mailing list
>> >> >>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >> >>
>> >> >>
>> >> >
>> >>
>> >> ______________________________________________
>> >> R-package-devel at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >
>> >
>
>


From jon at thon.cc  Fri Feb 10 03:19:13 2017
From: jon at thon.cc (Jonathon Love)
Date: Fri, 10 Feb 2017 13:19:13 +1100
Subject: [R-pkg-devel] =?utf-8?b?z4ksIM6xLCDOtywgwrIgaW4gLlJkIGZpbGVz?=
Message-ID: <2e349a17-60fc-dc33-303a-7e52282beb7c@thon.love>

hi,

i'm trying to include some greek characters in my package documentation, 
but am having difficulty getting it to work on windows. it works find on 
macOS, linux, but throws errors on windows:

https://win-builder.r-project.org/guwReC6lhQaU/00check.log

so far i have tried:

?
\u03C9
\omega
\eqn{\omega}
\symbol{"03C9}
\enc{?}{omega}

i have `Encoding: UTF-8` specified in my DESCRIPTION

i have read:

https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Encoding-issues
https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Encoding
https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Insertions

any tips on how to get these symbols into documentation on windows? i'd 
even by happy with it just saying 'omega' on windows (which is what i 
thought \enc{}{} was supposed to do).

apparently i'm missing something.

with thanks

jonathon


From ligges at statistik.tu-dortmund.de  Fri Feb 10 13:40:07 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 10 Feb 2017 13:40:07 +0100
Subject: [R-pkg-devel] =?utf-8?b?z4ksIM6xLCDOtywgwrIgaW4gLlJkIGZpbGVz?=
In-Reply-To: <2e349a17-60fc-dc33-303a-7e52282beb7c@thon.love>
References: <2e349a17-60fc-dc33-303a-7e52282beb7c@thon.love>
Message-ID: <6c58073a-080d-fa6e-4d51-697d80abf99f@statistik.tu-dortmund.de>



On 10.02.2017 03:19, Jonathon Love wrote:
> hi,
>
> i'm trying to include some greek characters in my package documentation,
> but am having difficulty getting it to work on windows. it works find on
> macOS, linux, but throws errors on windows:
>
> https://win-builder.r-project.org/guwReC6lhQaU/00check.log
>
> so far i have tried:
>
> ?
> \u03C9
> \omega
> \eqn{\omega}
> \symbol{"03C9}
> \enc{?}{omega}



The latter is right in principle, but two issues:

1- you use it in an .R file which should no assume a special encoding. I 
do not use roxygen2, hence don't know how it can work at all, I'd simply 
do it in the Rd file directly.

2- Thge LaTeX version on winbuilder cannot deal with an UTF-8 omega 
symbol. Hence I'd rather write
\eqn{\omega}{omega}
or to square it:
\eqn{\omega^2}{omega^2}

Best,
Uwe Ligges






>
> i have `Encoding: UTF-8` specified in my DESCRIPTION
>
> i have read:
>
> https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Encoding-issues
> https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Encoding
> https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Insertions
>
> any tips on how to get these symbols into documentation on windows? i'd
> even by happy with it just saying 'omega' on windows (which is what i
> thought \enc{}{} was supposed to do).
>
> apparently i'm missing something.
>
> with thanks
>
> jonathon
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From jon at thon.cc  Fri Feb 10 14:52:33 2017
From: jon at thon.cc (Jonathon Love)
Date: Sat, 11 Feb 2017 00:52:33 +1100
Subject: [R-pkg-devel] =?utf-8?b?z4ksIM6xLCDOtywgwrIgaW4gLlJkIGZpbGVz?=
In-Reply-To: <6c58073a-080d-fa6e-4d51-697d80abf99f@statistik.tu-dortmund.de>
References: <2e349a17-60fc-dc33-303a-7e52282beb7c@thon.love>
	<6c58073a-080d-fa6e-4d51-697d80abf99f@statistik.tu-dortmund.de>
Message-ID: <d32e1a06-4fcf-82eb-2739-04799aaa7e31@thon.love>

hi uwe,


On 10/2/17 23:40, Uwe Ligges wrote:
>
>
> On 10.02.2017 03:19, Jonathon Love wrote:
>> hi,
>>
>> i'm trying to include some greek characters in my package documentation,
>> but am having difficulty getting it to work on windows. it works find on
>> macOS, linux, but throws errors on windows:
>>
>> https://win-builder.r-project.org/guwReC6lhQaU/00check.log
>>
>> so far i have tried:
>>
>> ?
>> \u03C9
>> \omega
>> \eqn{\omega}
>> \symbol{"03C9}
>> \enc{?}{omega}
>
>
>
> The latter is right in principle, but two issues:
>
> 1- you use it in an .R file which should no assume a special encoding. 
> I do not use roxygen2, hence don't know how it can work at all, I'd 
> simply do it in the Rd file directly.
>
> 2- Thge LaTeX version on winbuilder cannot deal with an UTF-8 omega 
> symbol. Hence I'd rather write
> \eqn{\omega}{omega}
> or to square it:
> \eqn{\omega^2}{omega^2}

thanks for explaining this

unfortunately this doesn't work with the html or plain-text help (i 
assume it does work with the PDF manuals). in the html/plain text help, 
it always puts the plain ascii 'omega', rather than the actual symbol.

so it's seeming like it's not possible to have special chars in the html 
or plain-text help, without upsetting the winbuilder?

if i have to use the plain ascii 'omega', 'eta', 'alpha', it won't be 
the end of the world.

with thanks

jonathon


From ligges at statistik.tu-dortmund.de  Fri Feb 10 15:17:41 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 10 Feb 2017 15:17:41 +0100
Subject: [R-pkg-devel] =?utf-8?b?z4ksIM6xLCDOtywgwrIgaW4gLlJkIGZpbGVz?=
In-Reply-To: <d32e1a06-4fcf-82eb-2739-04799aaa7e31@thon.love>
References: <2e349a17-60fc-dc33-303a-7e52282beb7c@thon.love>
	<6c58073a-080d-fa6e-4d51-697d80abf99f@statistik.tu-dortmund.de>
	<d32e1a06-4fcf-82eb-2739-04799aaa7e31@thon.love>
Message-ID: <6ff55589-429d-da6e-096a-9b9267ac60dd@statistik.tu-dortmund.de>



On 10.02.2017 14:52, Jonathon Love wrote:
> hi uwe,
>
>
> On 10/2/17 23:40, Uwe Ligges wrote:
>>
>>
>> On 10.02.2017 03:19, Jonathon Love wrote:
>>> hi,
>>>
>>> i'm trying to include some greek characters in my package documentation,
>>> but am having difficulty getting it to work on windows. it works find on
>>> macOS, linux, but throws errors on windows:
>>>
>>> https://win-builder.r-project.org/guwReC6lhQaU/00check.log
>>>
>>> so far i have tried:
>>>
>>> ?
>>> \u03C9
>>> \omega
>>> \eqn{\omega}
>>> \symbol{"03C9}
>>> \enc{?}{omega}
>>
>>
>>
>> The latter is right in principle, but two issues:
>>
>> 1- you use it in an .R file which should no assume a special encoding.
>> I do not use roxygen2, hence don't know how it can work at all, I'd
>> simply do it in the Rd file directly.
>>
>> 2- Thge LaTeX version on winbuilder cannot deal with an UTF-8 omega
>> symbol. Hence I'd rather write
>> \eqn{\omega}{omega}
>> or to square it:
>> \eqn{\omega^2}{omega^2}
>
> thanks for explaining this
>
> unfortunately this doesn't work with the html or plain-text help (i
> assume it does work with the PDF manuals). in the html/plain text help,
> it always puts the plain ascii 'omega', rather than the actual symbol.

Right, that was intended.

>
> so it's seeming like it's not possible to have special chars in the html
> or plain-text help, without upsetting the winbuilder?

You can try to insert \enc{}{} versions, but then in the Rd files, that 
is not related to winbiulder only but R in general.
And you have to exclude LaTeX as the UTF-8 symbol for omega cannot be 
handled by all LaTeX versions, apparently.

Best,
Uwe


> if i have to use the plain ascii 'omega', 'eta', 'alpha', it won't be
> the end of the world.
>
> with thanks
>
> jonathon
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From lists at dewey.myzen.co.uk  Fri Feb 10 15:29:15 2017
From: lists at dewey.myzen.co.uk (Michael Dewey)
Date: Fri, 10 Feb 2017 14:29:15 +0000
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of R
	packages.
In-Reply-To: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
References: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
Message-ID: <eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>

Dear all

That seems an interesting session. I am the maintainer of one of the 
CRAN Task Views (MetaAnalysis) and will attend unless I am successful in 
the draw for Wimbledon tickets.

Just in case I strike lucky one question I would have raised from the 
floor if I were there would have been "Does anyone read the Task 
Views?". Since I started mine I have received only a couple of 
suggestions for additions including a very abrupt one about a package 
which had been included for months but whose author clearly did not read 
before writing. So I would ask whether we need to focus much energy on 
the Task Views.

So, maybe see you there, maybe not.

On 16/01/2017 14:57, ProfJCNash wrote:
> Navigating the Jungle of R Packages
>
> The R ecosystem has many packages in various collections,
> especially CRAN, Bioconductor, and GitHub. While this
> richness of choice speaks to the popularity and
> importance of R, the large number of contributed packages
> makes it difficult for users to find appropriate tools for
> their work.
>
> A session on this subject has been approved for UseR! in
> Brussels. The tentative structure is three short
> introductory presentations, followed by discussion or
> planning work to improve the tools available to help
> users find the best R package and function for their needs.
>
> The currently proposed topics are
>
> - wrapper packages that allow diverse tools that perform
>   similar functions to be accessed by unified calls
>
> - collaborative mechanisms to create and update Task Views
>
> - search and sort tools to find packages.
>
> At the time of writing we have tentative presenters for
> the topics, but welcome others. We hope these presentations
> at useR! 2017 will be part of a larger discussion that will
> contribute to an increased team effort after the conference
> to improve the the support for R users in these areas.
>
>
> John Nash, Julia Silge, Spencer Graves
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

-- 
Michael
http://www.dewey.myzen.co.uk/home.html


From murdoch.duncan at gmail.com  Fri Feb 10 15:44:45 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 10 Feb 2017 09:44:45 -0500
Subject: [R-pkg-devel] =?utf-8?b?z4ksIM6xLCDOtywgwrIgaW4gLlJkIGZpbGVz?=
In-Reply-To: <d32e1a06-4fcf-82eb-2739-04799aaa7e31@thon.love>
References: <2e349a17-60fc-dc33-303a-7e52282beb7c@thon.love>
	<6c58073a-080d-fa6e-4d51-697d80abf99f@statistik.tu-dortmund.de>
	<d32e1a06-4fcf-82eb-2739-04799aaa7e31@thon.love>
Message-ID: <743bb11d-1823-03c8-d2bd-85716e431ee5@gmail.com>

On 10/02/2017 8:52 AM, Jonathon Love wrote:
> hi uwe,
>
>
> On 10/2/17 23:40, Uwe Ligges wrote:
>>
>>
>> On 10.02.2017 03:19, Jonathon Love wrote:
>>> hi,
>>>
>>> i'm trying to include some greek characters in my package documentation,
>>> but am having difficulty getting it to work on windows. it works find on
>>> macOS, linux, but throws errors on windows:
>>>
>>> https://win-builder.r-project.org/guwReC6lhQaU/00check.log
>>>
>>> so far i have tried:
>>>
>>> ?
>>> \u03C9
>>> \omega
>>> \eqn{\omega}
>>> \symbol{"03C9}
>>> \enc{?}{omega}
>>
>>
>>
>> The latter is right in principle, but two issues:
>>
>> 1- you use it in an .R file which should no assume a special encoding.
>> I do not use roxygen2, hence don't know how it can work at all, I'd
>> simply do it in the Rd file directly.
>>
>> 2- Thge LaTeX version on winbuilder cannot deal with an UTF-8 omega
>> symbol. Hence I'd rather write
>> \eqn{\omega}{omega}
>> or to square it:
>> \eqn{\omega^2}{omega^2}
>
> thanks for explaining this
>
> unfortunately this doesn't work with the html or plain-text help (i
> assume it does work with the PDF manuals). in the html/plain text help,
> it always puts the plain ascii 'omega', rather than the actual symbol.
>
> so it's seeming like it's not possible to have special chars in the html
> or plain-text help, without upsetting the winbuilder?
>
> if i have to use the plain ascii 'omega', 'eta', 'alpha', it won't be
> the end of the world.
>

I suspect you are making things harder for yourself by using Roxygen2. 
As Uwe and the manual say, .R files need to be plain ASCII to be 
portable.  You can include Unicode escapes in strings.

Perhaps Roxygen2 has some way to process Unicode escapes in comments; 
you'll have to ask its authors.  If you include raw UTF-8 characters in 
the comments, they'll be processed differently in UTF-8 locales versus 
others.  So you might get away with doing this if Roxygen2 always runs 
in a UTF-8 locale, but on Windows you will see problems.

Duncan Murdoch


From profjcnash at gmail.com  Fri Feb 10 15:56:20 2017
From: profjcnash at gmail.com (J C Nash)
Date: Fri, 10 Feb 2017 09:56:20 -0500
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of R
	packages.
In-Reply-To: <eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>
References: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
	<eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>
Message-ID: <12e26e51-f455-8084-77dd-3c7bd08b35f7@gmail.com>

We'd be more than happy to have you contribute directly. The goal is not just an
information session, but to get some movement to ways to make the package collection(s)
easier to use effectively. Note to selves: "effectively" is important -- we could make
things easy by only recommending a few packages.

Best, JN


On 2017-02-10 09:29 AM, Michael Dewey wrote:
> Dear all
>
> That seems an interesting session. I am the maintainer of one of the CRAN Task Views (MetaAnalysis) and will attend
> unless I am successful in the draw for Wimbledon tickets.
>
> Just in case I strike lucky one question I would have raised from the floor if I were there would have been "Does anyone
> read the Task Views?". Since I started mine I have received only a couple of suggestions for additions including a very
> abrupt one about a package which had been included for months but whose author clearly did not read before writing. So I
> would ask whether we need to focus much energy on the Task Views.
>
> So, maybe see you there, maybe not.
>
> On 16/01/2017 14:57, ProfJCNash wrote:
>> Navigating the Jungle of R Packages
>>
>> The R ecosystem has many packages in various collections,
>> especially CRAN, Bioconductor, and GitHub. While this
>> richness of choice speaks to the popularity and
>> importance of R, the large number of contributed packages
>> makes it difficult for users to find appropriate tools for
>> their work.
>>
>> A session on this subject has been approved for UseR! in
>> Brussels. The tentative structure is three short
>> introductory presentations, followed by discussion or
>> planning work to improve the tools available to help
>> users find the best R package and function for their needs.
>>
>> The currently proposed topics are
>>
>> - wrapper packages that allow diverse tools that perform
>>   similar functions to be accessed by unified calls
>>
>> - collaborative mechanisms to create and update Task Views
>>
>> - search and sort tools to find packages.
>>
>> At the time of writing we have tentative presenters for
>> the topics, but welcome others. We hope these presentations
>> at useR! 2017 will be part of a larger discussion that will
>> contribute to an increased team effort after the conference
>> to improve the the support for R users in these areas.
>>
>>
>> John Nash, Julia Silge, Spencer Graves
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>


From bbolker at gmail.com  Fri Feb 10 17:51:31 2017
From: bbolker at gmail.com (Ben Bolker)
Date: Fri, 10 Feb 2017 11:51:31 -0500
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of R
	packages.
In-Reply-To: <12e26e51-f455-8084-77dd-3c7bd08b35f7@gmail.com>
References: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
	<eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>
	<12e26e51-f455-8084-77dd-3c7bd08b35f7@gmail.com>
Message-ID: <CABghstTv2GCKS9w4xHBs78sjs2Q5oV_+fhee79EEopUBm5yriA@mail.gmail.com>

  I definitely read the task views and advise others to do so.  I
don't know how representative my little corner of the world is,
though.

  I have an embryonic task view on mixed models at
https://github.com/bbolker/mixedmodels-misc/blob/master/MixedModels.ctv
but the perfect is the enemy of the good ...


On Fri, Feb 10, 2017 at 9:56 AM, J C Nash <profjcnash at gmail.com> wrote:
> We'd be more than happy to have you contribute directly. The goal is not
> just an
> information session, but to get some movement to ways to make the package
> collection(s)
> easier to use effectively. Note to selves: "effectively" is important -- we
> could make
> things easy by only recommending a few packages.
>
> Best, JN
>
>
> On 2017-02-10 09:29 AM, Michael Dewey wrote:
>>
>> Dear all
>>
>> That seems an interesting session. I am the maintainer of one of the CRAN
>> Task Views (MetaAnalysis) and will attend
>> unless I am successful in the draw for Wimbledon tickets.
>>
>> Just in case I strike lucky one question I would have raised from the
>> floor if I were there would have been "Does anyone
>> read the Task Views?". Since I started mine I have received only a couple
>> of suggestions for additions including a very
>> abrupt one about a package which had been included for months but whose
>> author clearly did not read before writing. So I
>> would ask whether we need to focus much energy on the Task Views.
>>
>> So, maybe see you there, maybe not.
>>
>>
>> On 16/01/2017 14:57, ProfJCNash wrote:
>>>
>>> Navigating the Jungle of R Packages
>>>
>>> The R ecosystem has many packages in various collections,
>>> especially CRAN, Bioconductor, and GitHub. While this
>>> richness of choice speaks to the popularity and
>>> importance of R, the large number of contributed packages
>>> makes it difficult for users to find appropriate tools for
>>> their work.
>>>
>>> A session on this subject has been approved for UseR! in
>>> Brussels. The tentative structure is three short
>>> introductory presentations, followed by discussion or
>>> planning work to improve the tools available to help
>>> users find the best R package and function for their needs.
>>>
>>> The currently proposed topics are
>>>
>>> - wrapper packages that allow diverse tools that perform
>>>   similar functions to be accessed by unified calls
>>>
>>> - collaborative mechanisms to create and update Task Views
>>>
>>> - search and sort tools to find packages.
>>>
>>> At the time of writing we have tentative presenters for
>>> the topics, but welcome others. We hope these presentations
>>> at useR! 2017 will be part of a larger discussion that will
>>> contribute to an increased team effort after the conference
>>> to improve the the support for R users in these areas.
>>>
>>>
>>> John Nash, Julia Silge, Spencer Graves
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From drjimlemon at gmail.com  Fri Feb 10 23:26:59 2017
From: drjimlemon at gmail.com (Jim Lemon)
Date: Sat, 11 Feb 2017 09:26:59 +1100
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of R
	packages.
In-Reply-To: <CABghstTv2GCKS9w4xHBs78sjs2Q5oV_+fhee79EEopUBm5yriA@mail.gmail.com>
References: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
	<eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>
	<12e26e51-f455-8084-77dd-3c7bd08b35f7@gmail.com>
	<CABghstTv2GCKS9w4xHBs78sjs2Q5oV_+fhee79EEopUBm5yriA@mail.gmail.com>
Message-ID: <CA+8X3fWXLWiVbTOP9-J9Amm+QYCqp+nKAgUBtbyFTo1TVXUNNg@mail.gmail.com>

This discussion started me thinking about searching for a function or
package, as many questions on the R help list indicate the that poster
couldn't find (or hasn't searched for) what they want. I don't think I
have ever used task views. If I haven't got a clue where to look for
something, I use Google. I can't recall an occasion when I didn't get
an answer, even if it was that what I wanted didn't exist. Perhaps we
should ask why Google is so good at answering uninformed questions, in
particular about R. I'm not the only person on the help list who
advises the clueless to try Google.

Jim


On Sat, Feb 11, 2017 at 3:51 AM, Ben Bolker <bbolker at gmail.com> wrote:
>   I definitely read the task views and advise others to do so.  I
> don't know how representative my little corner of the world is,
> though.
>
>   I have an embryonic task view on mixed models at
> https://github.com/bbolker/mixedmodels-misc/blob/master/MixedModels.ctv
> but the perfect is the enemy of the good ...
>
>
> On Fri, Feb 10, 2017 at 9:56 AM, J C Nash <profjcnash at gmail.com> wrote:
>> We'd be more than happy to have you contribute directly. The goal is not
>> just an
>> information session, but to get some movement to ways to make the package
>> collection(s)
>> easier to use effectively. Note to selves: "effectively" is important -- we
>> could make
>> things easy by only recommending a few packages.
>>
>> Best, JN
>>
>>
>> On 2017-02-10 09:29 AM, Michael Dewey wrote:
>>>
>>> Dear all
>>>
>>> That seems an interesting session. I am the maintainer of one of the CRAN
>>> Task Views (MetaAnalysis) and will attend
>>> unless I am successful in the draw for Wimbledon tickets.
>>>
>>> Just in case I strike lucky one question I would have raised from the
>>> floor if I were there would have been "Does anyone
>>> read the Task Views?". Since I started mine I have received only a couple
>>> of suggestions for additions including a very
>>> abrupt one about a package which had been included for months but whose
>>> author clearly did not read before writing. So I
>>> would ask whether we need to focus much energy on the Task Views.
>>>
>>> So, maybe see you there, maybe not.
>>>
>>>
>>> On 16/01/2017 14:57, ProfJCNash wrote:
>>>>
>>>> Navigating the Jungle of R Packages
>>>>
>>>> The R ecosystem has many packages in various collections,
>>>> especially CRAN, Bioconductor, and GitHub. While this
>>>> richness of choice speaks to the popularity and
>>>> importance of R, the large number of contributed packages
>>>> makes it difficult for users to find appropriate tools for
>>>> their work.
>>>>
>>>> A session on this subject has been approved for UseR! in
>>>> Brussels. The tentative structure is three short
>>>> introductory presentations, followed by discussion or
>>>> planning work to improve the tools available to help
>>>> users find the best R package and function for their needs.
>>>>
>>>> The currently proposed topics are
>>>>
>>>> - wrapper packages that allow diverse tools that perform
>>>>   similar functions to be accessed by unified calls
>>>>
>>>> - collaborative mechanisms to create and update Task Views
>>>>
>>>> - search and sort tools to find packages.
>>>>
>>>> At the time of writing we have tentative presenters for
>>>> the topics, but welcome others. We hope these presentations
>>>> at useR! 2017 will be part of a larger discussion that will
>>>> contribute to an increased team effort after the conference
>>>> to improve the the support for R users in these areas.
>>>>
>>>>
>>>> John Nash, Julia Silge, Spencer Graves
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From jon at thon.cc  Fri Feb 10 23:28:07 2017
From: jon at thon.cc (Jonathon Love)
Date: Sat, 11 Feb 2017 09:28:07 +1100
Subject: [R-pkg-devel] =?utf-8?b?z4ksIM6xLCDOtywgwrIgaW4gLlJkIGZpbGVz?=
In-Reply-To: <743bb11d-1823-03c8-d2bd-85716e431ee5@gmail.com>
References: <2e349a17-60fc-dc33-303a-7e52282beb7c@thon.love>
	<6c58073a-080d-fa6e-4d51-697d80abf99f@statistik.tu-dortmund.de>
	<d32e1a06-4fcf-82eb-2739-04799aaa7e31@thon.love>
	<743bb11d-1823-03c8-d2bd-85716e431ee5@gmail.com>
Message-ID: <d83d595e-a53c-7533-5ca1-deb1542187f4@thon.love>

hi duncan,


On 11/2/17 01:44, Duncan Murdoch wrote:
> On 10/02/2017 8:52 AM, Jonathon Love wrote:
>> hi uwe,
>>
>>
>> On 10/2/17 23:40, Uwe Ligges wrote:
>>>
>>>
>>> On 10.02.2017 03:19, Jonathon Love wrote:
>>>> hi,
>>>>
>>>> i'm trying to include some greek characters in my package 
>>>> documentation,
>>>> but am having difficulty getting it to work on windows. it works 
>>>> find on
>>>> macOS, linux, but throws errors on windows:
>>>>
>>>> https://win-builder.r-project.org/guwReC6lhQaU/00check.log
>>>>
>>>> so far i have tried:
>>>>
>>>> ?
>>>> \u03C9
>>>> \omega
>>>> \eqn{\omega}
>>>> \symbol{"03C9}
>>>> \enc{?}{omega}
>>>
>>>
>>>
>>> The latter is right in principle, but two issues:
>>>
>>> 1- you use it in an .R file which should no assume a special encoding.
>>> I do not use roxygen2, hence don't know how it can work at all, I'd
>>> simply do it in the Rd file directly.
>>>
>>> 2- Thge LaTeX version on winbuilder cannot deal with an UTF-8 omega
>>> symbol. Hence I'd rather write
>>> \eqn{\omega}{omega}
>>> or to square it:
>>> \eqn{\omega^2}{omega^2}
>>
>> thanks for explaining this
>>
>> unfortunately this doesn't work with the html or plain-text help (i
>> assume it does work with the PDF manuals). in the html/plain text help,
>> it always puts the plain ascii 'omega', rather than the actual symbol.
>>
>> so it's seeming like it's not possible to have special chars in the html
>> or plain-text help, without upsetting the winbuilder?
>>
>> if i have to use the plain ascii 'omega', 'eta', 'alpha', it won't be
>> the end of the world.
>>
>
> I suspect you are making things harder for yourself by using Roxygen2. 
> As Uwe and the manual say, .R files need to be plain ASCII to be 
> portable.  You can include Unicode escapes in strings.

yup, although if the encoding of the comments in the .R files are 
completely misunderstood by system, it shouldn't make any difference to 
the resultant package. Or is there a way that it could interfere?

of course, the CRAN checks are unlikely to appreciate this subtlety, so 
i guess i'm on the hook there.

> Perhaps Roxygen2 has some way to process Unicode escapes in comments; 
> you'll have to ask its authors.  If you include raw UTF-8 characters 
> in the comments, they'll be processed differently in UTF-8 locales 
> versus others.  So you might get away with doing this if Roxygen2 
> always runs in a UTF-8 locale, but on Windows you will see problems.

yup, i'd reached these conclusions - but always helpful to have someone 
else spell things out.

with thanks

jonathon


From marc_schwartz at me.com  Sat Feb 11 00:44:23 2017
From: marc_schwartz at me.com (Marc Schwartz)
Date: Fri, 10 Feb 2017 17:44:23 -0600
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of
	R	packages.
In-Reply-To: <CA+8X3fWXLWiVbTOP9-J9Amm+QYCqp+nKAgUBtbyFTo1TVXUNNg@mail.gmail.com>
References: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
	<eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>
	<12e26e51-f455-8084-77dd-3c7bd08b35f7@gmail.com>
	<CABghstTv2GCKS9w4xHBs78sjs2Q5oV_+fhee79EEopUBm5yriA@mail.gmail.com>
	<CA+8X3fWXLWiVbTOP9-J9Amm+QYCqp+nKAgUBtbyFTo1TVXUNNg@mail.gmail.com>
Message-ID: <82F36050-B52C-4B88-97A3-62CF5592D2A7@me.com>

Hi All,

A few points:

1. With respect to the CRAN Task Views, they are arguably buried a bit in the menus and that may contribute to low traffic. There is no direct link from the R Home page, albeit, there is a link on the main CRAN page, which is not prominent. I wonder if it might be reasonable for the main R web site maintainers to consider putting a link to the Task Views just below the CRAN link in the Download section or, perhaps better, in the Documentation section.

2. A group of us, led by Frank Harrell, who met during the DSC meeting out at Stanford last summer after the useR! meeting worked on modifying the online content for getting "Help with R" on the main R site home page. We added a brief section on the Task Views in the "R Help on the Internet" section to at least incrementally raise awareness:

  https://www.r-project.org/help.html

3. I see that Spencer's name is listed below and would presume that his 'sos' package would be featured in such a presentation? We also mention 'sos' on the above help page.

4. I would echo Jim's comments below regarding the use of Google, but I would add the use of http://www.rseek.org, which does have a tab for 'packages' on the results page when doing keyword searches. rseek.org is my first resource when searching for functionality in packages or posts to the lists.


Regards,

Marc Schwartz


> On Feb 10, 2017, at 4:26 PM, Jim Lemon <drjimlemon at gmail.com> wrote:
> 
> This discussion started me thinking about searching for a function or
> package, as many questions on the R help list indicate the that poster
> couldn't find (or hasn't searched for) what they want. I don't think I
> have ever used task views. If I haven't got a clue where to look for
> something, I use Google. I can't recall an occasion when I didn't get
> an answer, even if it was that what I wanted didn't exist. Perhaps we
> should ask why Google is so good at answering uninformed questions, in
> particular about R. I'm not the only person on the help list who
> advises the clueless to try Google.
> 
> Jim
> 
> 
> On Sat, Feb 11, 2017 at 3:51 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>  I definitely read the task views and advise others to do so.  I
>> don't know how representative my little corner of the world is,
>> though.
>> 
>>  I have an embryonic task view on mixed models at
>> https://github.com/bbolker/mixedmodels-misc/blob/master/MixedModels.ctv
>> but the perfect is the enemy of the good ...
>> 
>> 
>> On Fri, Feb 10, 2017 at 9:56 AM, J C Nash <profjcnash at gmail.com> wrote:
>>> We'd be more than happy to have you contribute directly. The goal is not
>>> just an
>>> information session, but to get some movement to ways to make the package
>>> collection(s)
>>> easier to use effectively. Note to selves: "effectively" is important -- we
>>> could make
>>> things easy by only recommending a few packages.
>>> 
>>> Best, JN
>>> 
>>> 
>>> On 2017-02-10 09:29 AM, Michael Dewey wrote:
>>>> 
>>>> Dear all
>>>> 
>>>> That seems an interesting session. I am the maintainer of one of the CRAN
>>>> Task Views (MetaAnalysis) and will attend
>>>> unless I am successful in the draw for Wimbledon tickets.
>>>> 
>>>> Just in case I strike lucky one question I would have raised from the
>>>> floor if I were there would have been "Does anyone
>>>> read the Task Views?". Since I started mine I have received only a couple
>>>> of suggestions for additions including a very
>>>> abrupt one about a package which had been included for months but whose
>>>> author clearly did not read before writing. So I
>>>> would ask whether we need to focus much energy on the Task Views.
>>>> 
>>>> So, maybe see you there, maybe not.
>>>> 
>>>> 
>>>> On 16/01/2017 14:57, ProfJCNash wrote:
>>>>> 
>>>>> Navigating the Jungle of R Packages
>>>>> 
>>>>> The R ecosystem has many packages in various collections,
>>>>> especially CRAN, Bioconductor, and GitHub. While this
>>>>> richness of choice speaks to the popularity and
>>>>> importance of R, the large number of contributed packages
>>>>> makes it difficult for users to find appropriate tools for
>>>>> their work.
>>>>> 
>>>>> A session on this subject has been approved for UseR! in
>>>>> Brussels. The tentative structure is three short
>>>>> introductory presentations, followed by discussion or
>>>>> planning work to improve the tools available to help
>>>>> users find the best R package and function for their needs.
>>>>> 
>>>>> The currently proposed topics are
>>>>> 
>>>>> - wrapper packages that allow diverse tools that perform
>>>>>  similar functions to be accessed by unified calls
>>>>> 
>>>>> - collaborative mechanisms to create and update Task Views
>>>>> 
>>>>> - search and sort tools to find packages.
>>>>> 
>>>>> At the time of writing we have tentative presenters for
>>>>> the topics, but welcome others. We hope these presentations
>>>>> at useR! 2017 will be part of a larger discussion that will
>>>>> contribute to an increased team effort after the conference
>>>>> to improve the the support for R users in these areas.
>>>>> 
>>>>> 
>>>>> John Nash, Julia Silge, Spencer Graves


From murdoch.duncan at gmail.com  Sat Feb 11 01:28:42 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 10 Feb 2017 19:28:42 -0500
Subject: [R-pkg-devel] =?utf-8?b?z4ksIM6xLCDOtywgwrIgaW4gLlJkIGZpbGVz?=
In-Reply-To: <d83d595e-a53c-7533-5ca1-deb1542187f4@thon.love>
References: <2e349a17-60fc-dc33-303a-7e52282beb7c@thon.love>
	<6c58073a-080d-fa6e-4d51-697d80abf99f@statistik.tu-dortmund.de>
	<d32e1a06-4fcf-82eb-2739-04799aaa7e31@thon.love>
	<743bb11d-1823-03c8-d2bd-85716e431ee5@gmail.com>
	<d83d595e-a53c-7533-5ca1-deb1542187f4@thon.love>
Message-ID: <982b60be-d70f-3c96-60f6-208cedbd1177@gmail.com>

On 10/02/2017 5:28 PM, Jonathon Love wrote:
> hi duncan,
>
>
> On 11/2/17 01:44, Duncan Murdoch wrote:
>> On 10/02/2017 8:52 AM, Jonathon Love wrote:
>>> hi uwe,
>>>
>>>
>>> On 10/2/17 23:40, Uwe Ligges wrote:
>>>>
>>>>
>>>> On 10.02.2017 03:19, Jonathon Love wrote:
>>>>> hi,
>>>>>
>>>>> i'm trying to include some greek characters in my package
>>>>> documentation,
>>>>> but am having difficulty getting it to work on windows. it works
>>>>> find on
>>>>> macOS, linux, but throws errors on windows:
>>>>>
>>>>> https://win-builder.r-project.org/guwReC6lhQaU/00check.log
>>>>>
>>>>> so far i have tried:
>>>>>
>>>>> ?
>>>>> \u03C9
>>>>> \omega
>>>>> \eqn{\omega}
>>>>> \symbol{"03C9}
>>>>> \enc{?}{omega}
>>>>
>>>>
>>>>
>>>> The latter is right in principle, but two issues:
>>>>
>>>> 1- you use it in an .R file which should no assume a special encoding.
>>>> I do not use roxygen2, hence don't know how it can work at all, I'd
>>>> simply do it in the Rd file directly.
>>>>
>>>> 2- Thge LaTeX version on winbuilder cannot deal with an UTF-8 omega
>>>> symbol. Hence I'd rather write
>>>> \eqn{\omega}{omega}
>>>> or to square it:
>>>> \eqn{\omega^2}{omega^2}
>>>
>>> thanks for explaining this
>>>
>>> unfortunately this doesn't work with the html or plain-text help (i
>>> assume it does work with the PDF manuals). in the html/plain text help,
>>> it always puts the plain ascii 'omega', rather than the actual symbol.
>>>
>>> so it's seeming like it's not possible to have special chars in the html
>>> or plain-text help, without upsetting the winbuilder?
>>>
>>> if i have to use the plain ascii 'omega', 'eta', 'alpha', it won't be
>>> the end of the world.
>>>
>>
>> I suspect you are making things harder for yourself by using Roxygen2.
>> As Uwe and the manual say, .R files need to be plain ASCII to be
>> portable.  You can include Unicode escapes in strings.
>
> yup, although if the encoding of the comments in the .R files are
> completely misunderstood by system, it shouldn't make any difference to
> the resultant package. Or is there a way that it could interfere?

Roxygen2 will take the comments and write out .Rd files.  Those files 
need to be written in ASCII, or the declared encoding of the package, 
not of the locale where Roxygen2 was run.  (R and CRAN know nothing 
about Roxygen2, they just look at the Rd files as though they were 
written by you.)

So I think it should be possible for all of this to work:  If you write 
your comments in UTF-8 and declare that as the encoding of the package, 
then Roxygen2 should read the .R files as UTF-8 files, and write out 
UTF-8 Rd files, regardless of the locale.  But encodings of strings go 
through several translations internally in R, so there may be some step 
there that loses the original intent.  And Roxygen2 may be just ignoring 
encodings, which would almost certainly go badly.

Duncan Murdoch

>
> of course, the CRAN checks are unlikely to appreciate this subtlety, so
> i guess i'm on the hook there.
>
>> Perhaps Roxygen2 has some way to process Unicode escapes in comments;
>> you'll have to ask its authors.  If you include raw UTF-8 characters
>> in the comments, they'll be processed differently in UTF-8 locales
>> versus others.  So you might get away with doing this if Roxygen2
>> always runs in a UTF-8 locale, but on Windows you will see problems.
>
> yup, i'd reached these conclusions - but always helpful to have someone
> else spell things out.
>
> with thanks
>
> jonathon
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From jon at thon.cc  Sat Feb 11 01:35:53 2017
From: jon at thon.cc (Jonathon Love)
Date: Sat, 11 Feb 2017 11:35:53 +1100
Subject: [R-pkg-devel] =?utf-8?b?z4ksIM6xLCDOtywgwrIgaW4gLlJkIGZpbGVz?=
In-Reply-To: <982b60be-d70f-3c96-60f6-208cedbd1177@gmail.com>
References: <2e349a17-60fc-dc33-303a-7e52282beb7c@thon.love>
	<6c58073a-080d-fa6e-4d51-697d80abf99f@statistik.tu-dortmund.de>
	<d32e1a06-4fcf-82eb-2739-04799aaa7e31@thon.love>
	<743bb11d-1823-03c8-d2bd-85716e431ee5@gmail.com>
	<d83d595e-a53c-7533-5ca1-deb1542187f4@thon.love>
	<982b60be-d70f-3c96-60f6-208cedbd1177@gmail.com>
Message-ID: <87adfeb6-949d-44d8-4cba-c89d81e41d65@thon.love>

hi duncan,
>> yup, although if the encoding of the comments in the .R files are
>> completely misunderstood by system, it shouldn't make any difference to
>> the resultant package. Or is there a way that it could interfere?
>
> Roxygen2 will take the comments and write out .Rd files.  Those files 
> need to be written in ASCII, or the declared encoding of the package, 
> not of the locale where Roxygen2 was run.  (R and CRAN know nothing 
> about Roxygen2, they just look at the Rd files as though they were 
> written by you.)
>
> So I think it should be possible for all of this to work:  If you 
> write your comments in UTF-8 and declare that as the encoding of the 
> package, then Roxygen2 should read the .R files as UTF-8 files, and 
> write out UTF-8 Rd files, regardless of the locale. But encodings of 
> strings go through several translations internally in R, so there may 
> be some step there that loses the original intent.  And Roxygen2 may 
> be just ignoring encodings, which would almost certainly go badly.

yup, this all works as you describe. the only wrinkle is that the CRAN 
checks on windows don't like non-ascii characters appearing in the .R 
files (which they would if one puts special chars in one's roxygen 
annotations).

cheers

jonathon


From jon at thon.cc  Sat Feb 11 01:48:26 2017
From: jon at thon.cc (Jonathon Love)
Date: Sat, 11 Feb 2017 11:48:26 +1100
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of R
	packages.
In-Reply-To: <85416e12-e8c5-5f76-90f7-21b203925c35@thon.love>
References: <85416e12-e8c5-5f76-90f7-21b203925c35@thon.love>
Message-ID: <a27e31f5-0f99-d0de-a4d8-2a6f499d1794@thon.love>

hi,

first up let me apologise for breaking the thread. i subscribed to this 
list after the initial email went out.

i'm not completely sure if the original post was to prompt a discussion 
here, but now there's a discussion, i'm jumping in!

i'm a psychologist, and one of the challenges is the number of packages 
required to do what is "standard practice", and getting them all to work 
together.

to do an ANOVA (the bread and butter of psych research) with all it's 
assumption checks, contrasts, corrections, etc. requires in the order of 
seven packages.

our solution to this is to create an "uber" package, which makes use of 
all these things behind a single function call (with many arguments), 
which is what our jmv package is:

https://www.jamovi.org/jmv/

we represent an extreme, we even handle plots, but there are other 
examples of more intermediate solutions: afex, psych, etc.

i appreciate this is somewhat at odds with (what i perceive to be) the R 
ethos, which is giving people very fine control over the intermediate 
parts of one's analysis, but it is another approach to making it easier 
for people to find appropriate tools for their field.

for me, the key is being "goal-centred", "what is a person in my field 
trying to achieve?" rather than "analysis-centred"; "this package 
provides analysis X" ... but i appreciate this is likely an unpopular 
position.

i'll definitely be attending this session at use!R, and happy to espouse 
more unpopular views

cheers

jonathon


> Navigating the Jungle of R Packages
>
> The R ecosystem has many packages in various collections,
> especially CRAN, Bioconductor, and GitHub. While this
> richness of choice speaks to the popularity and
> importance of R, the large number of contributed packages
> makes it difficult for users to find appropriate tools for
> their work.
>
> A session on this subject has been approved for UseR! in
> Brussels. The tentative structure is three short
> introductory presentations, followed by discussion or
> planning work to improve the tools available to help
> users find the best R package and function for their needs.
>
> The currently proposed topics are
>
> - wrapper packages that allow diverse tools that perform
>   similar functions to be accessed by unified calls
>
> - collaborative mechanisms to create and update Task Views
>
> - search and sort tools to find packages.
>
> At the time of writing we have tentative presenters for
> the topics, but welcome others. We hope these presentations
> at useR! 2017 will be part of a larger discussion that will
> contribute to an increased team effort after the conference
> to improve the the support for R users in these areas.
>
>
> John Nash, Julia Silge, Spencer Graves
>


From profjcnash at gmail.com  Sat Feb 11 14:21:16 2017
From: profjcnash at gmail.com (J C Nash)
Date: Sat, 11 Feb 2017 08:21:16 -0500
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of R
	packages.
In-Reply-To: <a27e31f5-0f99-d0de-a4d8-2a6f499d1794@thon.love>
References: <85416e12-e8c5-5f76-90f7-21b203925c35@thon.love>
	<a27e31f5-0f99-d0de-a4d8-2a6f499d1794@thon.love>
Message-ID: <1a0b9af7-e6bd-5be6-c8a9-712351ddb968@gmail.com>

Thanks for this. Besides stirring the pot by suggesting this suggestion, my own approach has been to try to do this with 
optimr/optimrx for "optimization" (actually function minimization with possibly bounds). Hans Werner Borchers has been 
charging ahead with a global optimization wrapper gloptim, but it is early days.

Jonathan: since you are planning to attend, perhaps we can collaborate to include jmv as another example. One issue is 
that there are almost certainly many anova tools, but unlike optimizers where one wants to compare performance, I 
believe anova will be about comparing possibly incompatible features. If interested, get in tough offline.

Best, JN

On 2017-02-10 07:48 PM, Jonathon Love wrote:
> hi,
>
> first up let me apologise for breaking the thread. i subscribed to this list after the initial email went out.
>
> i'm not completely sure if the original post was to prompt a discussion here, but now there's a discussion, i'm jumping in!
>
> i'm a psychologist, and one of the challenges is the number of packages required to do what is "standard practice", and
> getting them all to work together.
>
> to do an ANOVA (the bread and butter of psych research) with all it's assumption checks, contrasts, corrections, etc.
> requires in the order of seven packages.
>
> our solution to this is to create an "uber" package, which makes use of all these things behind a single function call
> (with many arguments), which is what our jmv package is:
>
> https://www.jamovi.org/jmv/
>
> we represent an extreme, we even handle plots, but there are other examples of more intermediate solutions: afex, psych,
> etc.
>
> i appreciate this is somewhat at odds with (what i perceive to be) the R ethos, which is giving people very fine control
> over the intermediate parts of one's analysis, but it is another approach to making it easier for people to find
> appropriate tools for their field.
>
> for me, the key is being "goal-centred", "what is a person in my field trying to achieve?" rather than
> "analysis-centred"; "this package provides analysis X" ... but i appreciate this is likely an unpopular position.
>
> i'll definitely be attending this session at use!R, and happy to espouse more unpopular views
>
> cheers
>
> jonathon
>
>
>> Navigating the Jungle of R Packages
>>
>> The R ecosystem has many packages in various collections,
>> especially CRAN, Bioconductor, and GitHub. While this
>> richness of choice speaks to the popularity and
>> importance of R, the large number of contributed packages
>> makes it difficult for users to find appropriate tools for
>> their work.
>>
>> A session on this subject has been approved for UseR! in
>> Brussels. The tentative structure is three short
>> introductory presentations, followed by discussion or
>> planning work to improve the tools available to help
>> users find the best R package and function for their needs.
>>
>> The currently proposed topics are
>>
>> - wrapper packages that allow diverse tools that perform
>>   similar functions to be accessed by unified calls
>>
>> - collaborative mechanisms to create and update Task Views
>>
>> - search and sort tools to find packages.
>>
>> At the time of writing we have tentative presenters for
>> the topics, but welcome others. We hope these presentations
>> at useR! 2017 will be part of a larger discussion that will
>> contribute to an increased team effort after the conference
>> to improve the the support for R users in these areas.
>>
>>
>> John Nash, Julia Silge, Spencer Graves
>>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From profjcnash at gmail.com  Sat Feb 11 14:39:16 2017
From: profjcnash at gmail.com (J C Nash)
Date: Sat, 11 Feb 2017 08:39:16 -0500
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of R
	packages.
In-Reply-To: <CA+8X3fWXLWiVbTOP9-J9Amm+QYCqp+nKAgUBtbyFTo1TVXUNNg@mail.gmail.com>
References: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
	<eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>
	<12e26e51-f455-8084-77dd-3c7bd08b35f7@gmail.com>
	<CABghstTv2GCKS9w4xHBs78sjs2Q5oV_+fhee79EEopUBm5yriA@mail.gmail.com>
	<CA+8X3fWXLWiVbTOP9-J9Amm+QYCqp+nKAgUBtbyFTo1TVXUNNg@mail.gmail.com>
Message-ID: <efbc28dd-12e5-1466-acf5-b895e94c7b8e@gmail.com>

Certainly Google can be useful, but it can also be infuriatingly time-wasting when one needs to sort out related tools 
that do slightly different things. Then good, up-to-date task views are important, and wrappers such as I and some 
others are trying to develop can be a way to ease the chore of applying the tools or changing between related ones where 
there isn't enough information on which is best.

Perhaps Jim, Spencer, and I (others welcome!) can come up with some small examples to show where Google / sos / other 
search tools and the task views (Julia?) can be illustrated to provide guidance. After all, the purpose of the UseR! 
session is to try to develop improved ways to access R's packages.

Cheers, John Nash

On 2017-02-10 05:26 PM, Jim Lemon wrote:
> This discussion started me thinking about searching for a function or
> package, as many questions on the R help list indicate the that poster
> couldn't find (or hasn't searched for) what they want. I don't think I
> have ever used task views. If I haven't got a clue where to look for
> something, I use Google. I can't recall an occasion when I didn't get
> an answer, even if it was that what I wanted didn't exist. Perhaps we
> should ask why Google is so good at answering uninformed questions, in
> particular about R. I'm not the only person on the help list who
> advises the clueless to try Google.
>
> Jim
>
>
> On Sat, Feb 11, 2017 at 3:51 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>   I definitely read the task views and advise others to do so.  I
>> don't know how representative my little corner of the world is,
>> though.
>>
>>   I have an embryonic task view on mixed models at
>> https://github.com/bbolker/mixedmodels-misc/blob/master/MixedModels.ctv
>> but the perfect is the enemy of the good ...
>>
>>
>> On Fri, Feb 10, 2017 at 9:56 AM, J C Nash <profjcnash at gmail.com> wrote:
>>> We'd be more than happy to have you contribute directly. The goal is not
>>> just an
>>> information session, but to get some movement to ways to make the package
>>> collection(s)
>>> easier to use effectively. Note to selves: "effectively" is important -- we
>>> could make
>>> things easy by only recommending a few packages.
>>>
>>> Best, JN
>>>
>>>
>>> On 2017-02-10 09:29 AM, Michael Dewey wrote:
>>>>
>>>> Dear all
>>>>
>>>> That seems an interesting session. I am the maintainer of one of the CRAN
>>>> Task Views (MetaAnalysis) and will attend
>>>> unless I am successful in the draw for Wimbledon tickets.
>>>>
>>>> Just in case I strike lucky one question I would have raised from the
>>>> floor if I were there would have been "Does anyone
>>>> read the Task Views?". Since I started mine I have received only a couple
>>>> of suggestions for additions including a very
>>>> abrupt one about a package which had been included for months but whose
>>>> author clearly did not read before writing. So I
>>>> would ask whether we need to focus much energy on the Task Views.
>>>>
>>>> So, maybe see you there, maybe not.
>>>>
>>>>
>>>> On 16/01/2017 14:57, ProfJCNash wrote:
>>>>>
>>>>> Navigating the Jungle of R Packages
>>>>>
>>>>> The R ecosystem has many packages in various collections,
>>>>> especially CRAN, Bioconductor, and GitHub. While this
>>>>> richness of choice speaks to the popularity and
>>>>> importance of R, the large number of contributed packages
>>>>> makes it difficult for users to find appropriate tools for
>>>>> their work.
>>>>>
>>>>> A session on this subject has been approved for UseR! in
>>>>> Brussels. The tentative structure is three short
>>>>> introductory presentations, followed by discussion or
>>>>> planning work to improve the tools available to help
>>>>> users find the best R package and function for their needs.
>>>>>
>>>>> The currently proposed topics are
>>>>>
>>>>> - wrapper packages that allow diverse tools that perform
>>>>>   similar functions to be accessed by unified calls
>>>>>
>>>>> - collaborative mechanisms to create and update Task Views
>>>>>
>>>>> - search and sort tools to find packages.
>>>>>
>>>>> At the time of writing we have tentative presenters for
>>>>> the topics, but welcome others. We hope these presentations
>>>>> at useR! 2017 will be part of a larger discussion that will
>>>>> contribute to an increased team effort after the conference
>>>>> to improve the the support for R users in these areas.
>>>>>
>>>>>
>>>>> John Nash, Julia Silge, Spencer Graves
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From kamvarz at science.oregonstate.edu  Sat Feb 11 18:40:05 2017
From: kamvarz at science.oregonstate.edu (Zhian Kamvar)
Date: Sat, 11 Feb 2017 11:40:05 -0600
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of R
	packages.
In-Reply-To: <efbc28dd-12e5-1466-acf5-b895e94c7b8e@gmail.com>
References: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
	<eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>
	<12e26e51-f455-8084-77dd-3c7bd08b35f7@gmail.com>
	<CABghstTv2GCKS9w4xHBs78sjs2Q5oV_+fhee79EEopUBm5yriA@mail.gmail.com>
	<CA+8X3fWXLWiVbTOP9-J9Amm+QYCqp+nKAgUBtbyFTo1TVXUNNg@mail.gmail.com>
	<efbc28dd-12e5-1466-acf5-b895e94c7b8e@gmail.com>
Message-ID: <EFE7FD29-B232-42E6-8DBE-7BD5AD868090@science.oregonstate.edu>

Hello,

Jumping in here because those of us in the population genetics community have semi-recently tried to tackle some of these issues of giving users a clear sense of how R packages can work together in an analysis [0]. 
We created a website [1] that hosts vignettes openly contributed and curated by those in the population genetics community directly to a GitHub repository [2]. 

In our community we saw that the Task Views were good for getting a sense of what packages were out there and their general applications, but it was not clear as to how the packages interoperated or even where to start. Vignettes on the other hand, provide great examples of how to get started, but only focus on a single package. The website takes a hybrid approach between Task Views, package vignettes, and user forums as the resources on the site are community submitted and reproducible via continuous integration with an up-to-date docker container [3]. 

I just thought y'all might be interested in hearing how we have attempted to address these issues.

Cheers,
Zhian N. Kamvar

[0]: https://github.com/NESCent/r-popgen-hackathon <https://github.com/NESCent/r-popgen-hackathon>
[1]: http://popgen.nescent.org/ <http://popgen.nescent.org/>
[2]: https://github.com/NESCent/popgenInfo#readme <https://github.com/NESCent/popgenInfo#readme>
[3]: https://hub.docker.com/r/hlapp/rpopgen/ <https://hub.docker.com/r/hlapp/rpopgen/>

> On Feb 11, 2017, at 07:39 , J C Nash <profjcnash at gmail.com> wrote:
> 
> Certainly Google can be useful, but it can also be infuriatingly time-wasting when one needs to sort out related tools that do slightly different things. Then good, up-to-date task views are important, and wrappers such as I and some others are trying to develop can be a way to ease the chore of applying the tools or changing between related ones where there isn't enough information on which is best.
> 
> Perhaps Jim, Spencer, and I (others welcome!) can come up with some small examples to show where Google / sos / other search tools and the task views (Julia?) can be illustrated to provide guidance. After all, the purpose of the UseR! session is to try to develop improved ways to access R's packages.
> 
> Cheers, John Nash
> 
> On 2017-02-10 05:26 PM, Jim Lemon wrote:
>> This discussion started me thinking about searching for a function or
>> package, as many questions on the R help list indicate the that poster
>> couldn't find (or hasn't searched for) what they want. I don't think I
>> have ever used task views. If I haven't got a clue where to look for
>> something, I use Google. I can't recall an occasion when I didn't get
>> an answer, even if it was that what I wanted didn't exist. Perhaps we
>> should ask why Google is so good at answering uninformed questions, in
>> particular about R. I'm not the only person on the help list who
>> advises the clueless to try Google.
>> 
>> Jim
>> 
>> 
>> On Sat, Feb 11, 2017 at 3:51 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>>  I definitely read the task views and advise others to do so.  I
>>> don't know how representative my little corner of the world is,
>>> though.
>>> 
>>>  I have an embryonic task view on mixed models at
>>> https://github.com/bbolker/mixedmodels-misc/blob/master/MixedModels.ctv
>>> but the perfect is the enemy of the good ...
>>> 
>>> 
>>> On Fri, Feb 10, 2017 at 9:56 AM, J C Nash <profjcnash at gmail.com> wrote:
>>>> We'd be more than happy to have you contribute directly. The goal is not
>>>> just an
>>>> information session, but to get some movement to ways to make the package
>>>> collection(s)
>>>> easier to use effectively. Note to selves: "effectively" is important -- we
>>>> could make
>>>> things easy by only recommending a few packages.
>>>> 
>>>> Best, JN
>>>> 
>>>> 
>>>> On 2017-02-10 09:29 AM, Michael Dewey wrote:
>>>>> 
>>>>> Dear all
>>>>> 
>>>>> That seems an interesting session. I am the maintainer of one of the CRAN
>>>>> Task Views (MetaAnalysis) and will attend
>>>>> unless I am successful in the draw for Wimbledon tickets.
>>>>> 
>>>>> Just in case I strike lucky one question I would have raised from the
>>>>> floor if I were there would have been "Does anyone
>>>>> read the Task Views?". Since I started mine I have received only a couple
>>>>> of suggestions for additions including a very
>>>>> abrupt one about a package which had been included for months but whose
>>>>> author clearly did not read before writing. So I
>>>>> would ask whether we need to focus much energy on the Task Views.
>>>>> 
>>>>> So, maybe see you there, maybe not.
>>>>> 
>>>>> 
>>>>> On 16/01/2017 14:57, ProfJCNash wrote:
>>>>>> 
>>>>>> Navigating the Jungle of R Packages
>>>>>> 
>>>>>> The R ecosystem has many packages in various collections,
>>>>>> especially CRAN, Bioconductor, and GitHub. While this
>>>>>> richness of choice speaks to the popularity and
>>>>>> importance of R, the large number of contributed packages
>>>>>> makes it difficult for users to find appropriate tools for
>>>>>> their work.
>>>>>> 
>>>>>> A session on this subject has been approved for UseR! in
>>>>>> Brussels. The tentative structure is three short
>>>>>> introductory presentations, followed by discussion or
>>>>>> planning work to improve the tools available to help
>>>>>> users find the best R package and function for their needs.
>>>>>> 
>>>>>> The currently proposed topics are
>>>>>> 
>>>>>> - wrapper packages that allow diverse tools that perform
>>>>>>  similar functions to be accessed by unified calls
>>>>>> 
>>>>>> - collaborative mechanisms to create and update Task Views
>>>>>> 
>>>>>> - search and sort tools to find packages.
>>>>>> 
>>>>>> At the time of writing we have tentative presenters for
>>>>>> the topics, but welcome others. We hope these presentations
>>>>>> at useR! 2017 will be part of a larger discussion that will
>>>>>> contribute to an increased team effort after the conference
>>>>>> to improve the the support for R users in these areas.
>>>>>> 
>>>>>> 
>>>>>> John Nash, Julia Silge, Spencer Graves
>>>>>> 
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>> 
>>>>> 
>>>> 
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>> 
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> 
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From bbolker at gmail.com  Sat Feb 11 22:41:27 2017
From: bbolker at gmail.com (Ben Bolker)
Date: Sat, 11 Feb 2017 16:41:27 -0500
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of R
	packages.
In-Reply-To: <ed6e8282-ef67-5d33-2ec5-635d7288a0a4@prodsyse.com>
References: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
	<eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>
	<12e26e51-f455-8084-77dd-3c7bd08b35f7@gmail.com>
	<CABghstTv2GCKS9w4xHBs78sjs2Q5oV_+fhee79EEopUBm5yriA@mail.gmail.com>
	<ed6e8282-ef67-5d33-2ec5-635d7288a0a4@prodsyse.com>
Message-ID: <46f65b5d-965a-0ec8-9372-516da4c4f92e@gmail.com>


  I don't have a problem with this, but there are a few challenges.

 - continuity: there used to be an R wiki, but it eventually disappeared
(http://wiki.r-project.org now redirects to the main www.r-project.org page)
 - actual contributions: I never got much feedback or contributions to
http://glmm.wikidot.com/glmmFAQ (which is now moved to
https://github.com/bbolker/mixedmodels-misc/blob/master/glmmFAQ.rmd ).
If individual task view maintainers wanted to post their stuff on
GitHub, it would make it easy for *some* users (those with a bit more
technical facility) to raise issues and submit pull requests ...)


On 17-02-11 12:09 PM, Spencer Graves wrote:
> Hi, Ben et al.:
> 
> 
>       What do you think about converting the Task Views into a wiki?
> 
> 
>       The Wikimedia rules do pretty well in inviting anyone to
> contribute material, ensuring that it is noteworthy and high quality,
> and managing any conflicts -- and no one person has to be responsible
> for any specific thing.
> 
> 
>       Spencer Graves
> 
> 
> On 2017-02-10 10:51 AM, Ben Bolker wrote:
>>    I definitely read the task views and advise others to do so.  I
>> don't know how representative my little corner of the world is,
>> though.
>>
>>    I have an embryonic task view on mixed models at
>> https://github.com/bbolker/mixedmodels-misc/blob/master/MixedModels.ctv
>> but the perfect is the enemy of the good ...
>>
>>
>> On Fri, Feb 10, 2017 at 9:56 AM, J C Nash <profjcnash at gmail.com> wrote:
>>> We'd be more than happy to have you contribute directly. The goal is not
>>> just an
>>> information session, but to get some movement to ways to make the
>>> package
>>> collection(s)
>>> easier to use effectively. Note to selves: "effectively" is important
>>> -- we
>>> could make
>>> things easy by only recommending a few packages.
>>>
>>> Best, JN
>>>
>>>
>>> On 2017-02-10 09:29 AM, Michael Dewey wrote:
>>>> Dear all
>>>>
>>>> That seems an interesting session. I am the maintainer of one of the
>>>> CRAN
>>>> Task Views (MetaAnalysis) and will attend
>>>> unless I am successful in the draw for Wimbledon tickets.
>>>>
>>>> Just in case I strike lucky one question I would have raised from the
>>>> floor if I were there would have been "Does anyone
>>>> read the Task Views?". Since I started mine I have received only a
>>>> couple
>>>> of suggestions for additions including a very
>>>> abrupt one about a package which had been included for months but whose
>>>> author clearly did not read before writing. So I
>>>> would ask whether we need to focus much energy on the Task Views.
>>>>
>>>> So, maybe see you there, maybe not.
>>>>
>>>>
>>>> On 16/01/2017 14:57, ProfJCNash wrote:
>>>>> Navigating the Jungle of R Packages
>>>>>
>>>>> The R ecosystem has many packages in various collections,
>>>>> especially CRAN, Bioconductor, and GitHub. While this
>>>>> richness of choice speaks to the popularity and
>>>>> importance of R, the large number of contributed packages
>>>>> makes it difficult for users to find appropriate tools for
>>>>> their work.
>>>>>
>>>>> A session on this subject has been approved for UseR! in
>>>>> Brussels. The tentative structure is three short
>>>>> introductory presentations, followed by discussion or
>>>>> planning work to improve the tools available to help
>>>>> users find the best R package and function for their needs.
>>>>>
>>>>> The currently proposed topics are
>>>>>
>>>>> - wrapper packages that allow diverse tools that perform
>>>>>    similar functions to be accessed by unified calls
>>>>>
>>>>> - collaborative mechanisms to create and update Task Views
>>>>>
>>>>> - search and sort tools to find packages.
>>>>>
>>>>> At the time of writing we have tentative presenters for
>>>>> the topics, but welcome others. We hope these presentations
>>>>> at useR! 2017 will be part of a larger discussion that will
>>>>> contribute to an increased team effort after the conference
>>>>> to improve the the support for R users in these areas.
>>>>>
>>>>>
>>>>> John Nash, Julia Silge, Spencer Graves
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From edd at debian.org  Sat Feb 11 23:22:56 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 11 Feb 2017 16:22:56 -0600
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of
	R	packages.
In-Reply-To: <46f65b5d-965a-0ec8-9372-516da4c4f92e@gmail.com>
References: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
	<eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>
	<12e26e51-f455-8084-77dd-3c7bd08b35f7@gmail.com>
	<CABghstTv2GCKS9w4xHBs78sjs2Q5oV_+fhee79EEopUBm5yriA@mail.gmail.com>
	<ed6e8282-ef67-5d33-2ec5-635d7288a0a4@prodsyse.com>
	<46f65b5d-965a-0ec8-9372-516da4c4f92e@gmail.com>
Message-ID: <22687.36544.566395.251865@max.eddelbuettel.com>


On 11 February 2017 at 16:41, Ben Bolker wrote:
|   I don't have a problem with this, but there are a few challenges.
| 
|  - continuity: there used to be an R wiki, but it eventually disappeared
| (http://wiki.r-project.org now redirects to the main www.r-project.org page)

Quite right.

|  - actual contributions: I never got much feedback or contributions to
| http://glmm.wikidot.com/glmmFAQ (which is now moved to
| https://github.com/bbolker/mixedmodels-misc/blob/master/glmmFAQ.rmd ).
| If individual task view maintainers wanted to post their stuff on
| GitHub, it would make it easy for *some* users (those with a bit more
| technical facility) to raise issues and submit pull requests ...)

I fear it's not a panacea.

Some folks thought that GH was a free lunch, moved early and provided some
scripts.  I followed a few years ago, yet still get most suggestions and
contributions by email. The last PR I got was even wrong (as in: to the
output .md file, rather than the source .ctv file).  Still, I like having it
on GH as the (autoconverted) README.md is pretty readable. [2]

But let's add some empirics to this. Almost ten years, following useR! 2007
in Ames a few of us blogged about [1] the (with apologies to Patricia
Hightsmith) "amazing Mr Ripley".  You (!!) actually proposed a three liner to
tabulate SVN logs. Well, some things never change, and the Task View package
is still on SVN.  So without further ado:

  setwd("~/svn/ctv/pkg")
  con <- pipe("svn log")
  x <- readLines(con)
  close(con)
  rx <- x[grep("^r",x)]   # next three lines courtesy of Ben Bolker, circa 2007
  who <- gsub(" ","",sapply(strsplit(rx,"\\|"),"[",2))
  twho <- table(who)
  twho[order(-twho)]

and that shows that Achim is doing the bulk of the work, with many
maintainers updating around twice to three times a year.  

  who
       azeileis           edd       dutangc         pmair      rsbivand 
           1356           224           118            80            69 
       gsimpson         gruen           kmm      thothorn     stefan7th 
             59            51            50            47            44 
        hyndman         fwild    hwborchers         edzer         templ 
             39            34            31            29            28 
       bcomeara     mmaechler        sorenh      ugroempi     bwhitcher 
             27            25            24            21            20 
       mdsumner       khornik          kuhn   schamber789      petzoldt 
             15            14            14             9             5 
     "Matthias"          jfox      karlines  thomasleeper kevinjaunatre 
              4             3             3             3             2 
        nikko18      gmontana 
              2             1

Dirk

[1] One link is http://dirk.eddelbuettel.com/blog/2007/08/11#ripley_commit_analysis
[2] My two are at
      https://github.com/eddelbuettel/ctv-finance
      https://github.com/eddelbuettel/ctv-hpc

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From drjimlemon at gmail.com  Sun Feb 12 08:07:59 2017
From: drjimlemon at gmail.com (Jim Lemon)
Date: Sun, 12 Feb 2017 18:07:59 +1100
Subject: [R-pkg-devel] UseR! Session: Making R easier to use (was:
 Navigating the jungle of R packages)
In-Reply-To: <b272207f-3f51-1d03-2991-a09413114f7a@prodsyse.com>
References: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
	<eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>
	<12e26e51-f455-8084-77dd-3c7bd08b35f7@gmail.com>
	<CABghstTv2GCKS9w4xHBs78sjs2Q5oV_+fhee79EEopUBm5yriA@mail.gmail.com>
	<CA+8X3fWXLWiVbTOP9-J9Amm+QYCqp+nKAgUBtbyFTo1TVXUNNg@mail.gmail.com>
	<efbc28dd-12e5-1466-acf5-b895e94c7b8e@gmail.com>
	<b272207f-3f51-1d03-2991-a09413114f7a@prodsyse.com>
Message-ID: <CA+8X3fXCK2fcbWO-YO_FORyhXu+e7ZW1SD9od+7Y8=2WzszTmQ@mail.gmail.com>

Hi all,
My point circles around the keyword "clueless". The difference between
a person who is trying to find out about logistic regression (and may
not even be familiar with that term) and one who is trying to test the
assumption of proportional odds in an ordered logistic regression is
often that the former will find a satisfactory`answer in a Google
search while the latter already knows what to look for and will know
the appropriate terms to search in task views. This is not to
disparage the clueless, though task views may seem like an enormous
maze to them. They may well migrate from the Google search to task
views or even writing their own functions with unanticipated celerity
once they have gotten their initial leads.

Jim


On Sun, Feb 12, 2017 at 4:27 AM, Spencer Graves
<spencer.graves at prodsyse.com> wrote:
>
> On 2017-02-11 7:39 AM, J C Nash wrote:
>>
>> Certainly Google can be useful, but it can also be infuriatingly
>> time-wasting when one needs to sort out related tools that do slightly
>> different things. Then good, up-to-date task views are important, and
>> wrappers such as I and some others are trying to develop can be a way to
>> ease the chore of applying the tools or changing between related ones where
>> there isn't enough information on which is best.
>>
>> Perhaps Jim, Spencer, and I (others welcome!) can come up with some small
>> examples to show where Google / sos / other search tools and the task views
>> (Julia?) can be illustrated to provide guidance. After all, the purpose of
>> the UseR! session is to try to develop improved ways to access R's packages.
>
>
>
>       The sos vignette discusses searching for "Petal.Length" and "spline",
> combining different searches, and writing the result to an Excel workbook
> with sheets for a package summary, the individual help pages found, and
> documentation of the actual search.
>
>
>       With luck, this session may catalyze the formation of a committee with
> a vision for how to improve what we have and the commitment to do it.
>
>
>       Spencer
>
>
> p.s.  Someone complained that R was not a jungle.  I'm therefore proposing
> we consider changing the name of the session to something like "Making R
> easier to use".  John Nash thought the jungle analogy was good, because CRAN
> and a jungle are both resource rich but navigation poor.
>
>>
>> Cheers, John Nash
>>
>> On 2017-02-10 05:26 PM, Jim Lemon wrote:
>>>
>>> This discussion started me thinking about searching for a function or
>>> package, as many questions on the R help list indicate the that poster
>>> couldn't find (or hasn't searched for) what they want. I don't think I
>>> have ever used task views. If I haven't got a clue where to look for
>>> something, I use Google. I can't recall an occasion when I didn't get
>>> an answer, even if it was that what I wanted didn't exist. Perhaps we
>>> should ask why Google is so good at answering uninformed questions, in
>>> particular about R. I'm not the only person on the help list who
>>> advises the clueless to try Google.
>>>
>>> Jim
>>>
>>>
>>> On Sat, Feb 11, 2017 at 3:51 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>>>
>>>>   I definitely read the task views and advise others to do so.  I
>>>> don't know how representative my little corner of the world is,
>>>> though.
>>>>
>>>>   I have an embryonic task view on mixed models at
>>>> https://github.com/bbolker/mixedmodels-misc/blob/master/MixedModels.ctv
>>>> but the perfect is the enemy of the good ...
>>>>
>>>>
>>>> On Fri, Feb 10, 2017 at 9:56 AM, J C Nash <profjcnash at gmail.com> wrote:
>>>>>
>>>>> We'd be more than happy to have you contribute directly. The goal is
>>>>> not
>>>>> just an
>>>>> information session, but to get some movement to ways to make the
>>>>> package
>>>>> collection(s)
>>>>> easier to use effectively. Note to selves: "effectively" is important
>>>>> -- we
>>>>> could make
>>>>> things easy by only recommending a few packages.
>>>>>
>>>>> Best, JN
>>>>>
>>>>>
>>>>> On 2017-02-10 09:29 AM, Michael Dewey wrote:
>>>>>>
>>>>>>
>>>>>> Dear all
>>>>>>
>>>>>> That seems an interesting session. I am the maintainer of one of the
>>>>>> CRAN
>>>>>> Task Views (MetaAnalysis) and will attend
>>>>>> unless I am successful in the draw for Wimbledon tickets.
>>>>>>
>>>>>> Just in case I strike lucky one question I would have raised from the
>>>>>> floor if I were there would have been "Does anyone
>>>>>> read the Task Views?". Since I started mine I have received only a
>>>>>> couple
>>>>>> of suggestions for additions including a very
>>>>>> abrupt one about a package which had been included for months but
>>>>>> whose
>>>>>> author clearly did not read before writing. So I
>>>>>> would ask whether we need to focus much energy on the Task Views.
>>>>>>
>>>>>> So, maybe see you there, maybe not.
>>>>>>
>>>>>>
>>>>>> On 16/01/2017 14:57, ProfJCNash wrote:
>>>>>>>
>>>>>>>
>>>>>>> Navigating the Jungle of R Packages
>>>>>>>
>>>>>>> The R ecosystem has many packages in various collections,
>>>>>>> especially CRAN, Bioconductor, and GitHub. While this
>>>>>>> richness of choice speaks to the popularity and
>>>>>>> importance of R, the large number of contributed packages
>>>>>>> makes it difficult for users to find appropriate tools for
>>>>>>> their work.
>>>>>>>
>>>>>>> A session on this subject has been approved for UseR! in
>>>>>>> Brussels. The tentative structure is three short
>>>>>>> introductory presentations, followed by discussion or
>>>>>>> planning work to improve the tools available to help
>>>>>>> users find the best R package and function for their needs.
>>>>>>>
>>>>>>> The currently proposed topics are
>>>>>>>
>>>>>>> - wrapper packages that allow diverse tools that perform
>>>>>>>   similar functions to be accessed by unified calls
>>>>>>>
>>>>>>> - collaborative mechanisms to create and update Task Views
>>>>>>>
>>>>>>> - search and sort tools to find packages.
>>>>>>>
>>>>>>> At the time of writing we have tentative presenters for
>>>>>>> the topics, but welcome others. We hope these presentations
>>>>>>> at useR! 2017 will be part of a larger discussion that will
>>>>>>> contribute to an increased team effort after the conference
>>>>>>> to improve the the support for R users in these areas.
>>>>>>>
>>>>>>>
>>>>>>> John Nash, Julia Silge, Spencer Graves
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>>
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>


From spencer.graves at effectivedefense.org  Sun Feb 12 10:52:31 2017
From: spencer.graves at effectivedefense.org (Spencer Graves)
Date: Sun, 12 Feb 2017 03:52:31 -0600
Subject: [R-pkg-devel] UseR! Session: Making R easier to use (was:
 Navigating the jungle of R packages)
In-Reply-To: <efbc28dd-12e5-1466-acf5-b895e94c7b8e@gmail.com>
References: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
	<eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>
	<12e26e51-f455-8084-77dd-3c7bd08b35f7@gmail.com>
	<CABghstTv2GCKS9w4xHBs78sjs2Q5oV_+fhee79EEopUBm5yriA@mail.gmail.com>
	<CA+8X3fWXLWiVbTOP9-J9Amm+QYCqp+nKAgUBtbyFTo1TVXUNNg@mail.gmail.com>
	<efbc28dd-12e5-1466-acf5-b895e94c7b8e@gmail.com>
Message-ID: <40852df6-7e68-36d3-9594-4cbd4daa62b9@effectivedefense.org>


On 2017-02-11 7:39 AM, J C Nash wrote:
> Certainly Google can be useful, but it can also be infuriatingly
> time-wasting when one needs to sort out related tools that do slightly
> different things. Then good, up-to-date task views are important, and
> wrappers such as I and some others are trying to develop can be a way
> to ease the chore of applying the tools or changing between related
> ones where there isn't enough information on which is best.
>
> Perhaps Jim, Spencer, and I (others welcome!) can come up with some
> small examples to show where Google / sos / other search tools and the
> task views (Julia?) can be illustrated to provide guidance. After all,
> the purpose of the UseR! session is to try to develop improved ways to
> access R's packages.


       The sos vignette discusses searching for "Petal.Length" and 
"spline", combining different searches, and writing the result to an 
Excel workbook with sheets for a package summary, the individual help 
pages found, and documentation of the actual search.


       With luck, this session may catalyze the formation of a committee 
with a vision for how to improve what we have and the commitment to do it.


       Spencer


p.s.  Someone complained that R was not a jungle.  I'm therefore 
proposing we consider changing the name of the session to something like 
"Making R easier to use".  John Nash thought the jungle analogy was 
good, because CRAN and a jungle are both resource rich but navigation poor.

>
> Cheers, John Nash
>
> On 2017-02-10 05:26 PM, Jim Lemon wrote:
>> This discussion started me thinking about searching for a function or
>> package, as many questions on the R help list indicate the that poster
>> couldn't find (or hasn't searched for) what they want. I don't think I
>> have ever used task views. If I haven't got a clue where to look for
>> something, I use Google. I can't recall an occasion when I didn't get
>> an answer, even if it was that what I wanted didn't exist. Perhaps we
>> should ask why Google is so good at answering uninformed questions, in
>> particular about R. I'm not the only person on the help list who
>> advises the clueless to try Google.
>>
>> Jim
>>
>>
>> On Sat, Feb 11, 2017 at 3:51 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>>   I definitely read the task views and advise others to do so.  I
>>> don't know how representative my little corner of the world is,
>>> though.
>>>
>>>   I have an embryonic task view on mixed models at
>>> https://github.com/bbolker/mixedmodels-misc/blob/master/MixedModels.ctv
>>> but the perfect is the enemy of the good ...


       What do you think about converting the Task Views into a wiki?


       The Wikimedia rules do pretty well in inviting anyone to 
contribute material, quickly and easily deleting obvious vandalism,
managing conflicts, and ensuring that the resulting articles are 
noteworthy and high quality -- and no one person has to be responsible 
for any specific thing.


       Spencer Graves
>>>
>>>
>>> On Fri, Feb 10, 2017 at 9:56 AM, J C Nash <profjcnash at gmail.com> wrote:
>>>> We'd be more than happy to have you contribute directly. The goal
>>>> is not
>>>> just an
>>>> information session, but to get some movement to ways to make the
>>>> package
>>>> collection(s)
>>>> easier to use effectively. Note to selves: "effectively" is
>>>> important -- we
>>>> could make
>>>> things easy by only recommending a few packages.
>>>>
>>>> Best, JN
>>>>
>>>>
>>>> On 2017-02-10 09:29 AM, Michael Dewey wrote:
>>>>>
>>>>> Dear all
>>>>>
>>>>> That seems an interesting session. I am the maintainer of one of
>>>>> the CRAN
>>>>> Task Views (MetaAnalysis) and will attend
>>>>> unless I am successful in the draw for Wimbledon tickets.
>>>>>
>>>>> Just in case I strike lucky one question I would have raised from the
>>>>> floor if I were there would have been "Does anyone
>>>>> read the Task Views?". Since I started mine I have received only a
>>>>> couple
>>>>> of suggestions for additions including a very
>>>>> abrupt one about a package which had been included for months but
>>>>> whose
>>>>> author clearly did not read before writing. So I
>>>>> would ask whether we need to focus much energy on the Task Views.
>>>>>
>>>>> So, maybe see you there, maybe not.
>>>>>
>>>>>
>>>>> On 16/01/2017 14:57, ProfJCNash wrote:
>>>>>>
>>>>>> Navigating the Jungle of R Packages
>>>>>>
>>>>>> The R ecosystem has many packages in various collections,
>>>>>> especially CRAN, Bioconductor, and GitHub. While this
>>>>>> richness of choice speaks to the popularity and
>>>>>> importance of R, the large number of contributed packages
>>>>>> makes it difficult for users to find appropriate tools for
>>>>>> their work.
>>>>>>
>>>>>> A session on this subject has been approved for UseR! in
>>>>>> Brussels. The tentative structure is three short
>>>>>> introductory presentations, followed by discussion or
>>>>>> planning work to improve the tools available to help
>>>>>> users find the best R package and function for their needs.
>>>>>>
>>>>>> The currently proposed topics are
>>>>>>
>>>>>> - wrapper packages that allow diverse tools that perform
>>>>>>   similar functions to be accessed by unified calls
>>>>>>
>>>>>> - collaborative mechanisms to create and update Task Views
>>>>>>
>>>>>> - search and sort tools to find packages.
>>>>>>
>>>>>> At the time of writing we have tentative presenters for
>>>>>> the topics, but welcome others. We hope these presentations
>>>>>> at useR! 2017 will be part of a larger discussion that will
>>>>>> contribute to an increased team effort after the conference
>>>>>> to improve the the support for R users in these areas.
>>>>>>
>>>>>>
>>>>>> John Nash, Julia Silge, Spencer Graves
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>


From mark.vanderloo at gmail.com  Sun Feb 12 23:37:31 2017
From: mark.vanderloo at gmail.com (Mark van der Loo)
Date: Sun, 12 Feb 2017 22:37:31 +0000
Subject: [R-pkg-devel] UseR! Session: Making R easier to use (was:
 Navigating the jungle of R packages)
In-Reply-To: <40852df6-7e68-36d3-9594-4cbd4daa62b9@effectivedefense.org>
References: <fca01177-c477-7b86-031f-aa0879da8da7@gmail.com>
	<eee80285-e351-e555-b37c-beb66a4ae659@dewey.myzen.co.uk>
	<12e26e51-f455-8084-77dd-3c7bd08b35f7@gmail.com>
	<CABghstTv2GCKS9w4xHBs78sjs2Q5oV_+fhee79EEopUBm5yriA@mail.gmail.com>
	<CA+8X3fWXLWiVbTOP9-J9Amm+QYCqp+nKAgUBtbyFTo1TVXUNNg@mail.gmail.com>
	<efbc28dd-12e5-1466-acf5-b895e94c7b8e@gmail.com>
	<40852df6-7e68-36d3-9594-4cbd4daa62b9@effectivedefense.org>
Message-ID: <CAOKDuOhaDfEGRu-i2JCvmDbaXaKPj6VOuhYJB0EbVXn+T1PTUw@mail.gmail.com>

Fwiw, there's also something called the awesome lists (
https://github.com/sindresorhus/awesome, and see the R list here:
https://github.com/qinwf/awesome-R), which is basically a kind of task
views for any language, and controlled via git pull requests.

Not sure if this would be a good alternative, but judging by the nr of gh
stars the awesome lists seem pretty popular.

Personally, I almost always use Google/Google scholar when I need
something. I use task views/awesome lists mainly when I get interested in
some field and want to have a quick browse to see what's there. Once in a
while I also need duckduckgo to escape the bubble.

-M

On Sun, Feb 12, 2017, 23:17 Spencer Graves <
spencer.graves at effectivedefense.org> wrote:

>
> On 2017-02-11 7:39 AM, J C Nash wrote:
> > Certainly Google can be useful, but it can also be infuriatingly
> > time-wasting when one needs to sort out related tools that do slightly
> > different things. Then good, up-to-date task views are important, and
> > wrappers such as I and some others are trying to develop can be a way
> > to ease the chore of applying the tools or changing between related
> > ones where there isn't enough information on which is best.
> >
> > Perhaps Jim, Spencer, and I (others welcome!) can come up with some
> > small examples to show where Google / sos / other search tools and the
> > task views (Julia?) can be illustrated to provide guidance. After all,
> > the purpose of the UseR! session is to try to develop improved ways to
> > access R's packages.
>
>
>        The sos vignette discusses searching for "Petal.Length" and
> "spline", combining different searches, and writing the result to an
> Excel workbook with sheets for a package summary, the individual help
> pages found, and documentation of the actual search.
>
>
>        With luck, this session may catalyze the formation of a committee
> with a vision for how to improve what we have and the commitment to do it.
>
>
>        Spencer
>
>
> p.s.  Someone complained that R was not a jungle.  I'm therefore
> proposing we consider changing the name of the session to something like
> "Making R easier to use".  John Nash thought the jungle analogy was
> good, because CRAN and a jungle are both resource rich but navigation poor.
>
> >
> > Cheers, John Nash
> >
> > On 2017-02-10 05:26 PM, Jim Lemon wrote:
> >> This discussion started me thinking about searching for a function or
> >> package, as many questions on the R help list indicate the that poster
> >> couldn't find (or hasn't searched for) what they want. I don't think I
> >> have ever used task views. If I haven't got a clue where to look for
> >> something, I use Google. I can't recall an occasion when I didn't get
> >> an answer, even if it was that what I wanted didn't exist. Perhaps we
> >> should ask why Google is so good at answering uninformed questions, in
> >> particular about R. I'm not the only person on the help list who
> >> advises the clueless to try Google.
> >>
> >> Jim
> >>
> >>
> >> On Sat, Feb 11, 2017 at 3:51 AM, Ben Bolker <bbolker at gmail.com> wrote:
> >>>   I definitely read the task views and advise others to do so.  I
> >>> don't know how representative my little corner of the world is,
> >>> though.
> >>>
> >>>   I have an embryonic task view on mixed models at
> >>>
> https://github.com/bbolker/mixedmodels-misc/blob/master/MixedModels.ctv
> >>> but the perfect is the enemy of the good ...
>
>
>        What do you think about converting the Task Views into a wiki?
>
>
>        The Wikimedia rules do pretty well in inviting anyone to
> contribute material, quickly and easily deleting obvious vandalism,
> managing conflicts, and ensuring that the resulting articles are
> noteworthy and high quality -- and no one person has to be responsible
> for any specific thing.
>
>
>        Spencer Graves
> >>>
> >>>
> >>> On Fri, Feb 10, 2017 at 9:56 AM, J C Nash <profjcnash at gmail.com>
> wrote:
> >>>> We'd be more than happy to have you contribute directly. The goal
> >>>> is not
> >>>> just an
> >>>> information session, but to get some movement to ways to make the
> >>>> package
> >>>> collection(s)
> >>>> easier to use effectively. Note to selves: "effectively" is
> >>>> important -- we
> >>>> could make
> >>>> things easy by only recommending a few packages.
> >>>>
> >>>> Best, JN
> >>>>
> >>>>
> >>>> On 2017-02-10 09:29 AM, Michael Dewey wrote:
> >>>>>
> >>>>> Dear all
> >>>>>
> >>>>> That seems an interesting session. I am the maintainer of one of
> >>>>> the CRAN
> >>>>> Task Views (MetaAnalysis) and will attend
> >>>>> unless I am successful in the draw for Wimbledon tickets.
> >>>>>
> >>>>> Just in case I strike lucky one question I would have raised from the
> >>>>> floor if I were there would have been "Does anyone
> >>>>> read the Task Views?". Since I started mine I have received only a
> >>>>> couple
> >>>>> of suggestions for additions including a very
> >>>>> abrupt one about a package which had been included for months but
> >>>>> whose
> >>>>> author clearly did not read before writing. So I
> >>>>> would ask whether we need to focus much energy on the Task Views.
> >>>>>
> >>>>> So, maybe see you there, maybe not.
> >>>>>
> >>>>>
> >>>>> On 16/01/2017 14:57, ProfJCNash wrote:
> >>>>>>
> >>>>>> Navigating the Jungle of R Packages
> >>>>>>
> >>>>>> The R ecosystem has many packages in various collections,
> >>>>>> especially CRAN, Bioconductor, and GitHub. While this
> >>>>>> richness of choice speaks to the popularity and
> >>>>>> importance of R, the large number of contributed packages
> >>>>>> makes it difficult for users to find appropriate tools for
> >>>>>> their work.
> >>>>>>
> >>>>>> A session on this subject has been approved for UseR! in
> >>>>>> Brussels. The tentative structure is three short
> >>>>>> introductory presentations, followed by discussion or
> >>>>>> planning work to improve the tools available to help
> >>>>>> users find the best R package and function for their needs.
> >>>>>>
> >>>>>> The currently proposed topics are
> >>>>>>
> >>>>>> - wrapper packages that allow diverse tools that perform
> >>>>>>   similar functions to be accessed by unified calls
> >>>>>>
> >>>>>> - collaborative mechanisms to create and update Task Views
> >>>>>>
> >>>>>> - search and sort tools to find packages.
> >>>>>>
> >>>>>> At the time of writing we have tentative presenters for
> >>>>>> the topics, but welcome others. We hope these presentations
> >>>>>> at useR! 2017 will be part of a larger discussion that will
> >>>>>> contribute to an increased team effort after the conference
> >>>>>> to improve the the support for R users in these areas.
> >>>>>>
> >>>>>>
> >>>>>> John Nash, Julia Silge, Spencer Graves
> >>>>>>
> >>>>>> ______________________________________________
> >>>>>> R-package-devel at r-project.org mailing list
> >>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>>>>
> >>>>>
> >>>>
> >>>> ______________________________________________
> >>>> R-package-devel at r-project.org mailing list
> >>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>
> >>> ______________________________________________
> >>> R-package-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From tkeitt at utexas.edu  Mon Feb 13 16:05:06 2017
From: tkeitt at utexas.edu (Tim Keitt)
Date: Mon, 13 Feb 2017 09:05:06 -0600
Subject: [R-pkg-devel] AppVeyor with LinkingTo: field
Message-ID: <CANnL8gq4Y_HWjbaK5QqWC=mED3yoeRUDM4as6J7y8QpfgYdJ_w@mail.gmail.com>

My tests are failing on AppVeyor because BH is not available. How do I
force AppVeyor to install the package? It is in the LinkingTo: field, but
my tests call sourceCpp and it fails there. The Cpp code has the "depends"
directive for BH. It is either not being installed or is absent from the
test environment. Thought I would try to modify .appveyor.yml and force a
BH install. What's the trick?

THK

http://www.keittlab.org/

	[[alternative HTML version deleted]]


From csardi.gabor at gmail.com  Mon Feb 13 16:11:51 2017
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Mon, 13 Feb 2017 15:11:51 +0000
Subject: [R-pkg-devel] AppVeyor with LinkingTo: field
In-Reply-To: <CANnL8gq4Y_HWjbaK5QqWC=mED3yoeRUDM4as6J7y8QpfgYdJ_w@mail.gmail.com>
References: <CANnL8gq4Y_HWjbaK5QqWC=mED3yoeRUDM4as6J7y8QpfgYdJ_w@mail.gmail.com>
Message-ID: <CABtg=Km84e33iP-MVaFXjORmc0=4j4kaT4Ku_Z-9pPSSg9sz2A@mail.gmail.com>

You need to put it in 'Imports' as well. Whatever is in LinkingTo, must be
in Imports.

Gabor

On Mon, Feb 13, 2017 at 3:05 PM, Tim Keitt <tkeitt at utexas.edu> wrote:

> My tests are failing on AppVeyor because BH is not available. How do I
> force AppVeyor to install the package? It is in the LinkingTo: field, but
> my tests call sourceCpp and it fails there. The Cpp code has the "depends"
> directive for BH. It is either not being installed or is absent from the
> test environment. Thought I would try to modify .appveyor.yml and force a
> BH install. What's the trick?
>
> THK
>
> http://www.keittlab.org/
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd at debian.org  Mon Feb 13 16:19:49 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 13 Feb 2017 09:19:49 -0600
Subject: [R-pkg-devel] AppVeyor with LinkingTo: field
In-Reply-To: <CANnL8gq4Y_HWjbaK5QqWC=mED3yoeRUDM4as6J7y8QpfgYdJ_w@mail.gmail.com>
References: <CANnL8gq4Y_HWjbaK5QqWC=mED3yoeRUDM4as6J7y8QpfgYdJ_w@mail.gmail.com>
Message-ID: <22689.52885.877283.25792@max.eddelbuettel.com>


On 13 February 2017 at 09:05, Tim Keitt wrote:
| My tests are failing on AppVeyor because BH is not available. How do I
| force AppVeyor to install the package? It is in the LinkingTo: field, but
| my tests call sourceCpp and it fails there. The Cpp code has the "depends"
| directive for BH. It is either not being installed or is absent from the
| test environment. Thought I would try to modify .appveyor.yml and force a
| BH install. What's the trick?

It is a design shortcoming in R's dependency mechanism.  A 'LinkingTo:' used
this way is a 'Build-Depends' but not recognised by the code doing the
installations for you which installs only (run-time) Depends.

I don't use AppVeyor, and when I use Travis with my maintained fork of the
initial scheme [1], I install packages explicitly.  I like having that control,
and that is one of the reason I use that scheme.

Dirk

[1] http://eddelbuettel.github.io/r-travis/

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From tkeitt at utexas.edu  Mon Feb 13 17:31:24 2017
From: tkeitt at utexas.edu (Tim Keitt)
Date: Mon, 13 Feb 2017 10:31:24 -0600
Subject: [R-pkg-devel] AppVeyor with LinkingTo: field
In-Reply-To: <CABtg=Km84e33iP-MVaFXjORmc0=4j4kaT4Ku_Z-9pPSSg9sz2A@mail.gmail.com>
References: <CANnL8gq4Y_HWjbaK5QqWC=mED3yoeRUDM4as6J7y8QpfgYdJ_w@mail.gmail.com>
	<CABtg=Km84e33iP-MVaFXjORmc0=4j4kaT4Ku_Z-9pPSSg9sz2A@mail.gmail.com>
Message-ID: <CANnL8gp-0BnShSURbYp8Mp8meQhFLih4dRiVx7JpPvTMpv-p5g@mail.gmail.com>

On Mon, Feb 13, 2017 at 9:11 AM, G?bor Cs?rdi <csardi.gabor at gmail.com>
wrote:

> You need to put it in 'Imports' as well. Whatever is in LinkingTo, must be
> in Imports.
>

That did the trick. Thanks.

I am almost there -- only failing on devel in Travis CI. It failing at the
"R CMD build" phase.

* installing *source* package ?odeintr? ...
> ** libs
> I/home/travis/R-bin/lib/R/include -DNDEBUG -I"../inst/include"
> -I"/home/travis/R/Library/Rcpp/include"
> -I"/home/travis/R/Library/BH/include" -I/home/travis/R-bin/include      -c
> RcppExports.cpp -o RcppExports.o
> /bin/bash: I/home/travis/R-bin/lib/R/include: No such file or directory
> make: [RcppExports.o] Error 127 (ignored)


I think my PKG_CPPFLAGS or some such is not right. Is there something about
the devel branch of R I am missing?

THK

http://www.keittlab.org/

	[[alternative HTML version deleted]]


From tkeitt at utexas.edu  Mon Feb 13 17:31:56 2017
From: tkeitt at utexas.edu (Tim Keitt)
Date: Mon, 13 Feb 2017 10:31:56 -0600
Subject: [R-pkg-devel] AppVeyor with LinkingTo: field
In-Reply-To: <22689.52885.877283.25792@max.eddelbuettel.com>
References: <CANnL8gq4Y_HWjbaK5QqWC=mED3yoeRUDM4as6J7y8QpfgYdJ_w@mail.gmail.com>
	<22689.52885.877283.25792@max.eddelbuettel.com>
Message-ID: <CANnL8grOWtGN9kEAaWdGi2UA5iqRn=+jcgF1d1HJxToj3NNeMA@mail.gmail.com>

On Mon, Feb 13, 2017 at 9:19 AM, Dirk Eddelbuettel <edd at debian.org> wrote:

> [1] http://eddelbuettel.github.io/r-travis/
>

This looks useful. I'll have to investigate.

THK

http://www.keittlab.org/

	[[alternative HTML version deleted]]


From edd at debian.org  Mon Feb 13 17:36:25 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 13 Feb 2017 10:36:25 -0600
Subject: [R-pkg-devel] AppVeyor with LinkingTo: field
In-Reply-To: <CABtg=Km84e33iP-MVaFXjORmc0=4j4kaT4Ku_Z-9pPSSg9sz2A@mail.gmail.com>
References: <CANnL8gq4Y_HWjbaK5QqWC=mED3yoeRUDM4as6J7y8QpfgYdJ_w@mail.gmail.com>
	<CABtg=Km84e33iP-MVaFXjORmc0=4j4kaT4Ku_Z-9pPSSg9sz2A@mail.gmail.com>
Message-ID: <22689.57481.289853.856556@max.eddelbuettel.com>


(off-list)

On 13 February 2017 at 15:11, G?bor Cs?rdi wrote:
| You need to put it in 'Imports' as well. Whatever is in LinkingTo, must be
| in Imports.

Not true.

So if you could not tic
edd at max:~/git$ cat anytime/DESCRIPTION
Package: anytime
Type: Package
Title: Anything to 'POSIXct' or 'Date' Converter
Version: 0.2.1
Date: 2017-02-09
Author: Dirk Eddelbuettel
Maintainer: Dirk Eddelbuettel <edd at debian.org>
Description: Convert input in any one of character, integer, numeric, factor,
 or ordered type into 'POSIXct' (or 'Date') objects, using one of a number of
 predefined formats, and relying on Boost facilities for date and time parsing.
URL: http://dirk.eddelbuettel.com/code/anytime.html
BugReports: https://github.com/eddelbuettel/anytime/issues
License: GPL (>= 2)
Encoding: UTF-8
Depends: R (>= 3.2.0)
Imports: Rcpp (>= 0.12.9)
LinkingTo: Rcpp (>= 0.12.9), BH
Suggests: gettz
RoxygenNote: 6.0.0
edd at max:~/git$ 

Has LinkingTo:, does not have Imports:.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From tkeitt at utexas.edu  Mon Feb 13 17:44:32 2017
From: tkeitt at utexas.edu (Tim Keitt)
Date: Mon, 13 Feb 2017 10:44:32 -0600
Subject: [R-pkg-devel] AppVeyor with LinkingTo: field
In-Reply-To: <22689.57481.289853.856556@max.eddelbuettel.com>
References: <CANnL8gq4Y_HWjbaK5QqWC=mED3yoeRUDM4as6J7y8QpfgYdJ_w@mail.gmail.com>
	<CABtg=Km84e33iP-MVaFXjORmc0=4j4kaT4Ku_Z-9pPSSg9sz2A@mail.gmail.com>
	<22689.57481.289853.856556@max.eddelbuettel.com>
Message-ID: <CANnL8gqfbv30jjnSj8=Bv4dK-1xcDMLCeYbv=mzvFqpt4NoUmg@mail.gmail.com>

On Mon, Feb 13, 2017 at 10:36 AM, Dirk Eddelbuettel <edd at debian.org> wrote:

> Not true.
>

It seems to be a work-around for Travis, but as you say not a general
packaging requirement.

THK

http://www.keittlab.org/

	[[alternative HTML version deleted]]


From tkeitt at utexas.edu  Mon Feb 13 17:48:21 2017
From: tkeitt at utexas.edu (Tim Keitt)
Date: Mon, 13 Feb 2017 10:48:21 -0600
Subject: [R-pkg-devel] AppVeyor with LinkingTo: field
In-Reply-To: <CANnL8gp-0BnShSURbYp8Mp8meQhFLih4dRiVx7JpPvTMpv-p5g@mail.gmail.com>
References: <CANnL8gq4Y_HWjbaK5QqWC=mED3yoeRUDM4as6J7y8QpfgYdJ_w@mail.gmail.com>
	<CABtg=Km84e33iP-MVaFXjORmc0=4j4kaT4Ku_Z-9pPSSg9sz2A@mail.gmail.com>
	<CANnL8gp-0BnShSURbYp8Mp8meQhFLih4dRiVx7JpPvTMpv-p5g@mail.gmail.com>
Message-ID: <CANnL8gq29LNWz_-Lk-+H9MBt-y2eY8vcYETZ4t9FTv4C9zWRKw@mail.gmail.com>

On Mon, Feb 13, 2017 at 10:31 AM, Tim Keitt <tkeitt at utexas.edu> wrote:

> I am almost there -- only failing on devel in Travis CI. It failing at the
> "R CMD build" phase.
>
> * installing *source* package ?odeintr? ...
>> ** libs
>> I/home/travis/R-bin/lib/R/include -DNDEBUG -I"../inst/include"
>> -I"/home/travis/R/Library/Rcpp/include" -I"/home/travis/R/Library/BH/include"
>> -I/home/travis/R-bin/include      -c RcppExports.cpp -o RcppExports.o
>> /bin/bash: I/home/travis/R-bin/lib/R/include: No such file or directory
>> make: [RcppExports.o] Error 127 (ignored)
>
>
> I think my PKG_CPPFLAGS or some such is not right. Is there something
> about the devel branch of R I am missing?
>

Known Travis bug.

Finally everything works!

THK

http://www.keittlab.org/

	[[alternative HTML version deleted]]


From csardi.gabor at gmail.com  Mon Feb 13 17:49:26 2017
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Mon, 13 Feb 2017 16:49:26 +0000
Subject: [R-pkg-devel] AppVeyor with LinkingTo: field
In-Reply-To: <22689.57481.289853.856556@max.eddelbuettel.com>
References: <CANnL8gq4Y_HWjbaK5QqWC=mED3yoeRUDM4as6J7y8QpfgYdJ_w@mail.gmail.com>
	<CABtg=Km84e33iP-MVaFXjORmc0=4j4kaT4Ku_Z-9pPSSg9sz2A@mail.gmail.com>
	<22689.57481.289853.856556@max.eddelbuettel.com>
Message-ID: <CABtg=K=+rm-pj8zWDeehW0tYyiMPzHG3zxQHdunCoQa8JiYVGg@mail.gmail.com>

Indeed, I am sorry, misremembered.

G.

On Mon, Feb 13, 2017 at 4:36 PM, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> (off-list)
>
> On 13 February 2017 at 15:11, G?bor Cs?rdi wrote:
> | You need to put it in 'Imports' as well. Whatever is in LinkingTo, must
> be
> | in Imports.
>
> Not true.
>
> So if you could not tic
> edd at max:~/git$ cat anytime/DESCRIPTION
> Package: anytime
> Type: Package
> Title: Anything to 'POSIXct' or 'Date' Converter
> Version: 0.2.1
> Date: 2017-02-09
> Author: Dirk Eddelbuettel
> Maintainer: Dirk Eddelbuettel <edd at debian.org>
> Description: Convert input in any one of character, integer, numeric,
> factor,
>  or ordered type into 'POSIXct' (or 'Date') objects, using one of a number
> of
>  predefined formats, and relying on Boost facilities for date and time
> parsing.
> URL: http://dirk.eddelbuettel.com/code/anytime.html
> BugReports: https://github.com/eddelbuettel/anytime/issues
> License: GPL (>= 2)
> Encoding: UTF-8
> Depends: R (>= 3.2.0)
> Imports: Rcpp (>= 0.12.9)
> LinkingTo: Rcpp (>= 0.12.9), BH
> Suggests: gettz
> RoxygenNote: 6.0.0
> edd at max:~/git$
>
> Has LinkingTo:, does not have Imports:.
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From avraham.adler at gmail.com  Thu Feb 16 03:22:22 2017
From: avraham.adler at gmail.com (Avraham Adler)
Date: Wed, 15 Feb 2017 21:22:22 -0500
Subject: [R-pkg-devel] Packages which use Fortran call "rwarn" for warnings?
Message-ID: <CAL6gwnKdTChEks0d=Gs8nPf+fZN6gjQxett9uA2gFxxe3yzorg@mail.gmail.com>

Hello.

Would anyone know of a package which uses the rwarn subroutine, as
described in Writing R extensions 6.2.1, for error handling from
Fortran? I'm experimenting with it and getting overwhelmed with stack
errors and crashes, and could benefit from seeing it used properly.

Thank you,

Avi


From rubak at math.aau.dk  Thu Feb 16 06:08:09 2017
From: rubak at math.aau.dk (Ege Rubak)
Date: Thu, 16 Feb 2017 13:08:09 +0800
Subject: [R-pkg-devel] Packages which use Fortran call "rwarn" for
 warnings?
In-Reply-To: <CAL6gwnKdTChEks0d=Gs8nPf+fZN6gjQxett9uA2gFxxe3yzorg@mail.gmail.com>
References: <CAL6gwnKdTChEks0d=Gs8nPf+fZN6gjQxett9uA2gFxxe3yzorg@mail.gmail.com>
Message-ID: <9c946475-7d6d-6271-49ce-b1f1ced1e592@math.aau.dk>

A quick search on METACRAN on GitHub gives quite a few results:
https://github.com/search?q=org%3Acran+rwarn&type=Code

The first couple of package hits:
rodeo
rootSolve
geoBayes

Good luck!
/Ege

On 02/16/2017 10:22 AM, Avraham Adler wrote:
> Hello.
>
> Would anyone know of a package which uses the rwarn subroutine, as
> described in Writing R extensions 6.2.1, for error handling from
> Fortran? I'm experimenting with it and getting overwhelmed with stack
> errors and crashes, and could benefit from seeing it used properly.
>
> Thank you,
>
> Avi
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From profjcnash at gmail.com  Thu Feb 16 16:03:23 2017
From: profjcnash at gmail.com (J C Nash)
Date: Thu, 16 Feb 2017 10:03:23 -0500
Subject: [R-pkg-devel] UseR! Session: Navigating the jungle of R packages
In-Reply-To: <CA+mbi1e3NWorMo1BdTRoqEeAp0r+Pr-0Oj7PgykOTuw6=KRxAA@mail.gmail.com>
References: <16479325-1A6C-4471-BAC0-2E62DF9990D0@me.com>
	<f5f4341a-d15a-9760-2934-351f73d5c875@gmail.com>
	<d4fdbb80-f8a5-758d-2a6d-520968c2d956@effectivedefense.org>
	<bbe636e7-f86e-80dc-5094-275805c281a8@gmail.com>
	<4A636E73-17A6-4948-AA5A-29BDABDEA7CE@me.com>
	<8412b870-573f-59ee-c01b-2210b8652e96@gmail.com>
	<CA+mbi1e3NWorMo1BdTRoqEeAp0r+Pr-0Oj7PgykOTuw6=KRxAA@mail.gmail.com>
Message-ID: <8c025af3-92a8-b174-bc77-606ec959ee1b@gmail.com>

As a way to organize discussion for the session AND for the hopefully derivative development, I have set up a Github project

     https://github.com/nashjc/Rnavpkg

In particular, I've started a small wiki therein, and especially have built a page "Ideas and people" where I have tried 
to summarize succinctly the comments so far. I'm absolutely sure I've missed some contributions and got some ideas bent, 
and ask your indulgence and assistance. I'll be happy to give access to edit/improve things (and freely admit the Github 
process is a bit new to me, being used to svn on R-forge).

Julia has suggested rmdshower for preparing slide presentations (which clearly can be collaboratively developed on 
Rnavpkg). I also note that one can use RStudio File/New/File/Presentation, though I haven't checked how these render to 
other than html.

Cheers, John Nash


From lsilvestri at ztsdb.org  Thu Feb 16 17:52:56 2017
From: lsilvestri at ztsdb.org (Leonardo Silvestri)
Date: Thu, 16 Feb 2017 11:52:56 -0500
Subject: [R-pkg-devel] Is a double dispatch possible with two S3 classes?
Message-ID: <cfa4351c-772e-bf79-2ec6-8e1e6442c8e4@ztsdb.org>

Hello,

I have stumbled upon an S3 class dispatch issue which is easily solved 
using S4 classes, but I'd like to know if there is a way to solve it 
without changing the type of class used.

The problem is as follows. There is an S3 class 'foo' which is defined 
in a package over which I don't have control. Then there is an S3 class 
'bar' derived from 'foo' in a package that can be modified.

Here is some code for 'foo':

as.foo <- function(x) {
   oldClass(x) <- "foo"
   x
}

print.foo <- function(x, ...) print(paste(x, "foo"))

"-.foo" <- function(e1, e2) "-.foo was called"


And here is some code for 'bar':

as.bar <- function(x) {
   oldClass(x) <- c("bar", "foo")
   x
}

print.bar <- function(x, ...) print(paste(x, "bar"))


Now the '-' operator must be defined in such a way that the behaviour is 
different depending on the operand classes, and in particular 
'bar'-'bar' needs to be different from 'bar'-'foo'. If I define the 
following function:

"-.bar" <- function(e1, e2) "-.bar was called"

then I get the following results.

as.foo(1) - as.foo(2)     # uses '-.foo'
as.bar(1) - as.bar(2)     # uses '-.bar'
as.bar(1) - as.foo(2)     # uses '-.default' and issues
                           # Incompatible methods warning
as.foo(1) - as.bar(2)     # uses '-.default' and issues
                           # Incompatible methods warning

So that seems like a dead end.

If, overcoming an instinctive shudder of disgust, I redefine '-.foo' in 
the "bar" package, I have checked that correctness is at the mercy of 
the order of loading of the packages, even though the "bar" package 
imports the "foo" package. So that doesn't seem to work either.

Before committing to making 'bar' an S4 class, does anyone know if there 
is another option that would allow 'bar' to remain an S3 class?

Thanks,
Leo


From murdoch.duncan at gmail.com  Thu Feb 16 20:34:46 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 16 Feb 2017 14:34:46 -0500
Subject: [R-pkg-devel] Is a double dispatch possible with two S3 classes?
In-Reply-To: <cfa4351c-772e-bf79-2ec6-8e1e6442c8e4@ztsdb.org>
References: <cfa4351c-772e-bf79-2ec6-8e1e6442c8e4@ztsdb.org>
Message-ID: <b6338f82-d45b-961b-e225-664e7c5ccaf5@gmail.com>

On 16/02/2017 11:52 AM, Leonardo Silvestri wrote:
> Hello,
>
> I have stumbled upon an S3 class dispatch issue which is easily solved
> using S4 classes, but I'd like to know if there is a way to solve it
> without changing the type of class used.
>
> The problem is as follows. There is an S3 class 'foo' which is defined
> in a package over which I don't have control. Then there is an S3 class
> 'bar' derived from 'foo' in a package that can be modified.
>
> Here is some code for 'foo':
>
> as.foo <- function(x) {
>    oldClass(x) <- "foo"
>    x
> }
>
> print.foo <- function(x, ...) print(paste(x, "foo"))
>
> "-.foo" <- function(e1, e2) "-.foo was called"
>
>
> And here is some code for 'bar':
>
> as.bar <- function(x) {
>    oldClass(x) <- c("bar", "foo")
>    x
> }
>
> print.bar <- function(x, ...) print(paste(x, "bar"))
>
>
> Now the '-' operator must be defined in such a way that the behaviour is
> different depending on the operand classes, and in particular
> 'bar'-'bar' needs to be different from 'bar'-'foo'. If I define the
> following function:
>
> "-.bar" <- function(e1, e2) "-.bar was called"
>
> then I get the following results.
>
> as.foo(1) - as.foo(2)     # uses '-.foo'
> as.bar(1) - as.bar(2)     # uses '-.bar'
> as.bar(1) - as.foo(2)     # uses '-.default' and issues
>                            # Incompatible methods warning
> as.foo(1) - as.bar(2)     # uses '-.default' and issues
>                            # Incompatible methods warning
>
> So that seems like a dead end.
>
> If, overcoming an instinctive shudder of disgust, I redefine '-.foo' in
> the "bar" package, I have checked that correctness is at the mercy of
> the order of loading of the packages, even though the "bar" package
> imports the "foo" package. So that doesn't seem to work either.
>
> Before committing to making 'bar' an S4 class, does anyone know if there
> is another option that would allow 'bar' to remain an S3 class?

I don't think so, though you could conceivably check whether things will 
work when bar is loaded, and fail with a message saying "bar must be 
loaded first!" or whatever.

Duncan Murdoch


From jpbrooks at vcu.edu  Thu Feb 16 23:28:04 2017
From: jpbrooks at vcu.edu (J. Paul Brooks)
Date: Thu, 16 Feb 2017 17:28:04 -0500
Subject: [R-pkg-devel] registering native routines and references as R
	objects
Message-ID: <CAKBmF1A+H3dMcBu4KaDo8AJRQYjg7=_ByEUrVh4g215aHmGLSw@mail.gmail.com>

I am working on an update to my package pcaL1.  Using win-builder, I
get a note including "Found no calls to 'R_registerRoutines',
'R_useDynamicSymbols'".  However, in my submission, I have a file
src/init.c that includes the contents at the bottom of this email to
register .C() routines.  Why can't win-builder find the calls to these
functions?

Also, when I include "useDynLib(pcaL1, .registration=TRUE,
.fixes="C_")" in NAMESPACE so that I can refer to the routines as R
objects, I get a warning that the objects C_* are not documented.  Is
it okay to ignore this warning?  It appears that the package stats
does not document such objects.

The contents of src/init.c:

#include "type.h"
#include <stdlib.h>
#include <R_ext/Rdynload.h>
#include <R_ext/Visibility.h>

void l1pcahp (double *points_XT, int *dataDim, double *threshold,
double *initV, double *PCs);
void l1pcastar (double *points_XT, int *dataDim, int *q, double *PCs);
void l1pca (double *points_XT, int *dataDim, int *q, double
*tolerance, int *iterations, double *initV, double *PCs, double
*Scores);
void l1projection (double *points_XT, int *dataDim, int *q, double
*PCs, double *projPoints, double *alphas);
void pcal1 (double *points_XT, int *dataDim, int *q, double *PCs, int
*initMethod, double *initV);
void pcalp (double *points_XT, int *dataDim, int *q, double *p, double
*PCs, int *initMethod, int *solMethod, double *initV, double *epsilon,
double *lratio);
void sharpel1pca (double *points_XT, int *dataDim, int *q, double
*PCs, double *objectives);

#define C_DEF(name, n) {#name, (DL_FUNC) &name, n}

static const R_CMethodDef cMethods[] = {
  C_DEF(l1pcahp, 5),
  C_DEF(l1pcastar, 4),
  C_DEF(l1pca, 8),
  C_DEF(l1projection, 6),
  C_DEF(pcal1, 6),
  C_DEF(pcalp, 10),
  C_DEF(sharpel1pca, 5),
  {NULL, NULL, 0}
};

void attribute_visible R_init_pcaL1(DllInfo *info)
{
  R_registerRoutines(info, cMethods, NULL, NULL, NULL);
  R_useDynamicSymbols(info, FALSE);
  R_forceSymbols(info, TRUE);
}


From lsilvestri at ztsdb.org  Sat Feb 18 07:43:51 2017
From: lsilvestri at ztsdb.org (Leonardo Silvestri)
Date: Sat, 18 Feb 2017 01:43:51 -0500
Subject: [R-pkg-devel] Is a double dispatch possible with two S3 classes?
In-Reply-To: <b6338f82-d45b-961b-e225-664e7c5ccaf5@gmail.com>
References: <cfa4351c-772e-bf79-2ec6-8e1e6442c8e4@ztsdb.org>
	<b6338f82-d45b-961b-e225-664e7c5ccaf5@gmail.com>
Message-ID: <32682138-0079-92d5-e3e1-c85927896674@ztsdb.org>

On 02/16/2017 02:34 PM, Duncan Murdoch wrote:
> On 16/02/2017 11:52 AM, Leonardo Silvestri wrote:
>> Hello,
>>
>> I have stumbled upon an S3 class dispatch issue which is easily solved
>> using S4 classes, but I'd like to know if there is a way to solve it
>> without changing the type of class used.
>>
>> The problem is as follows. There is an S3 class 'foo' which is defined
>> in a package over which I don't have control. Then there is an S3 class
>> 'bar' derived from 'foo' in a package that can be modified.
>>
>> Here is some code for 'foo':
>>
>> as.foo <- function(x) {
>>    oldClass(x) <- "foo"
>>    x
>> }
>>
>> print.foo <- function(x, ...) print(paste(x, "foo"))
>>
>> "-.foo" <- function(e1, e2) "-.foo was called"
>>
>>
>> And here is some code for 'bar':
>>
>> as.bar <- function(x) {
>>    oldClass(x) <- c("bar", "foo")
>>    x
>> }
>>
>> print.bar <- function(x, ...) print(paste(x, "bar"))
>>
>>
>> Now the '-' operator must be defined in such a way that the behaviour is
>> different depending on the operand classes, and in particular
>> 'bar'-'bar' needs to be different from 'bar'-'foo'. If I define the
>> following function:
>>
>> "-.bar" <- function(e1, e2) "-.bar was called"
>>
>> then I get the following results.
>>
>> as.foo(1) - as.foo(2)     # uses '-.foo'
>> as.bar(1) - as.bar(2)     # uses '-.bar'
>> as.bar(1) - as.foo(2)     # uses '-.default' and issues
>>                            # Incompatible methods warning
>> as.foo(1) - as.bar(2)     # uses '-.default' and issues
>>                            # Incompatible methods warning
>>
>> So that seems like a dead end.
>>
>> If, overcoming an instinctive shudder of disgust, I redefine '-.foo' in
>> the "bar" package, I have checked that correctness is at the mercy of
>> the order of loading of the packages, even though the "bar" package
>> imports the "foo" package. So that doesn't seem to work either.
>>
>> Before committing to making 'bar' an S4 class, does anyone know if there
>> is another option that would allow 'bar' to remain an S3 class?
>
> I don't think so, though you could conceivably check whether things will
> work when bar is loaded, and fail with a message saying "bar must be
> loaded first!" or whatever.
>
> Duncan Murdoch
>

Thanks for the answer. Yes, that would be a possibility (using 'foo' in 
'Depends' rather than 'Imports' does guarantee the loading order). One 
downside though is that two packages can't play at that game 
simultaneously...

Leo


From jens.oehlschlaegel at truecluster.com  Wed Feb 22 19:44:18 2017
From: jens.oehlschlaegel at truecluster.com (=?UTF-8?Q?=22Jens_Oehlschl=C3=A4gel=22?=)
Date: Wed, 22 Feb 2017 19:44:18 +0100
Subject: [R-pkg-devel] Is a double dispatch possible with two S3 classes?
In-Reply-To: <cfa4351c-772e-bf79-2ec6-8e1e6442c8e4@ztsdb.org>
References: <cfa4351c-772e-bf79-2ec6-8e1e6442c8e4@ztsdb.org>
Message-ID: <trinity-a4c64459-a75c-47f7-9173-a0ab06a4bd57-1487789058764@3capp-webde-bs42>

Leonardo,

I had a similar problem when I tried to implement reasonable behaviour for logical operators for classes .bit and .bitwhich in package 'bit'.

Part of your problem is that R refuses to dispatch to any of two incompatible classes and instead falls back to a meaningless default. 

In theory, *this* problem *should* be solved in S3 by having a common super-class 'foobar' for class(foo) <- c('foo','foobar') and  class(bar) <- c('bar','foobar'), but again, R does refuses to dispatch on the common super-class (it directly tries to dispatch on the most special subclasses it finds and does not check for a common class in the class hierarchy). 

However, it appears that by having a common sub-class 'foobar' for class(foo) <- c('foobar','foo') and  class(bar) <- c('foobar','bar') we can get a common dispatch and hence get control. I plan for my next release of package 'bit' a common subclass 'booltype' to which R can dispatch without conflict. If you can convince the author of 'foo' to use class(foo) <- c('foobar','foo') and base his dispatch on 'foo', then you can dispatch on 'foobar' with no conflict and use NextMethod to invoke his code for the foo-foo case, and your code for the other cases. If the author refuses for some reason, you can still provide a wrapper to convert class 'foo' into class c('foobar','foo'), or do more nasty things like patching his class generator, but at least you don't need to patch his methods! 

I admit, using a physical subclass as a logical superclass is ugly: instead of declaring 'apples' and 'oranges' as special cases of 'fruits', we tell R that 'a fruit is an apple' and that 'a fruit is an orange', such that R dispatches to fruit-code for any combination of apples and oranges. Well ... the good thing is that NextMethod can invoke the original apple-code or orange-code, and we only need to write apple-orange-code and orange-apple-code to handle the new combinations. 

@R-devel: any comments or suggestions?

HTH


Jens?Oehlschl?gel


P.S. Example code and output follows


# If we try to have 'foo' and 'bar' as specializations of of a superclass 'foobar'

f <- "fooobj"
oldClass(f) <- c('foo','foobar')
"+.foo" <- function(e1,e2){
  paste(e1,'+foo+',e2)
}

b <- "barobj"
oldClass(b) <- c('bar','foobar')
"+.bar" <- function(e1,e2){
  paste(e1,'+bar+',e2)
}

"+.foobar" <- function(e1,e2){
  if (inherits(e1,"foo") && inherits(e2,"bar"))
    paste(e1,'+foobar+',e2)
  else if (inherits(e1,"bar") && inherits(e2,"foo"))
    paste(e1,'+barfoo+',e2)
  else stop("should not be invoked for foo+foo or bar+bar (but it does)")
}

# Yes, this works
f + f
b + b
# but here R does not even dispatch on the common superclass 'foobar'
f + b
b + f


# However, it seems that we can trick R to do the right thing pretending that 'foobar' is a subclass of both, 'foo' and 'bar'

oldClass(f) <- c('foobar','foo')
"+.foo" <- function(e1,e2){
  paste(e1,'+foo+',e2)
}

b <- "barobj"
oldClass(b) <- c('foobar','bar')
"+.bar" <- function(e1,e2){
  paste(e1,'+bar+',e2)
}

"+.foobar" <- function(e1,e2){
  if (inherits(e1,"foo") && inherits(e2,"bar"))
    paste(e1,'+foobar+',e2)
  else if (inherits(e1,"bar") && inherits(e2,"foo"))
    paste(e1,'+barfoo+',e2)
  else NextMethod(e1,e2)  # make sure we dispatch to foo+foo and bar+bar
}

# This works
f + f
b + b
# but R does not even dispatch on the common ground 'foobar'
f + b
b + f



> # If we try to have 'foo' and 'bar' as specializations of of a superclass 'foobar'
> 
> f <- "fooobj"
> oldClass(f) <- c('foo','foobar')
> "+.foo" <- function(e1,e2){
+   paste(e1,'+foo+',e2)
+ }
> 
> b <- "barobj"
> oldClass(b) <- c('bar','foobar')
> "+.bar" <- function(e1,e2){
+   paste(e1,'+bar+',e2)
+ }
> 
> "+.foobar" <- function(e1,e2){
+   if (inherits(e1,"foo") && inherits(e2,"bar"))
+     paste(e1,'+foobar+',e2)
+   else if (inherits(e1,"bar") && inherits(e2,"foo"))
+     paste(e1,'+barfoo+',e2)
+   else stop("should not be invoked for foo+foo or bar+bar (but it does)")
+ }
> 
> # Yes, this works
> f + f
[1] "fooobj +foo+ fooobj"
> b + b
[1] "barobj +bar+ barobj"
> # but here R does not even dispatch on the common superclass 'foobar'
> f + b
Fehler in f + b : nicht-numerisches Argument f?r bin?ren Operator
Zus?tzlich: Warnmeldung:
Inkompatible Methoden ("+.foo", "+.bar") f?r "+" 
> b + f
Fehler in b + f : nicht-numerisches Argument f?r bin?ren Operator
Zus?tzlich: Warnmeldung:
Inkompatible Methoden ("+.bar", "+.foo") f?r "+" 
> 
> 
> # However, it seems that we can trick R to do the right thing pretending that 'foobar' is a subclass of both, 'foo' and 'bar'
> 
> oldClass(f) <- c('foobar','foo')
> "+.foo" <- function(e1,e2){
+   paste(e1,'+foo+',e2)
+ }
> 
> b <- "barobj"
> oldClass(b) <- c('foobar','bar')
> "+.bar" <- function(e1,e2){
+   paste(e1,'+bar+',e2)
+ }
> 
> "+.foobar" <- function(e1,e2){
+   if (inherits(e1,"foo") && inherits(e2,"bar"))
+     paste(e1,'+foobar+',e2)
+   else if (inherits(e1,"bar") && inherits(e2,"foo"))
+     paste(e1,'+barfoo+',e2)
+   else NextMethod(e1,e2)  # make sure we dispatch to foo+foo and bar+bar
+ }
> 
> # This works
> f + f
[1] "fooobj +foo+ fooobj"
> b + b
[1] "barobj +bar+ barobj"
> # but R does not even dispatch on the common ground 'foobar'
> f + b
[1] "fooobj +foobar+ barobj"
> b + f
[1] "barobj +barfoo+ fooobj"

?

Gesendet:?Donnerstag, 16. Februar 2017 um 17:52 Uhr
Von:?"Leonardo Silvestri" <lsilvestri at ztsdb.org>
An:?r-package-devel at r-project.org
Betreff:?[R-pkg-devel] Is a double dispatch possible with two S3 classes?
Hello,

I have stumbled upon an S3 class dispatch issue which is easily solved
using S4 classes, but I'd like to know if there is a way to solve it
without changing the type of class used.

The problem is as follows. There is an S3 class 'foo' which is defined
in a package over which I don't have control. Then there is an S3 class
'bar' derived from 'foo' in a package that can be modified.

Here is some code for 'foo':

as.foo <- function(x) {
oldClass(x) <- "foo"
x
}

print.foo <- function(x, ...) print(paste(x, "foo"))

"-.foo" <- function(e1, e2) "-.foo was called"


And here is some code for 'bar':

as.bar <- function(x) {
oldClass(x) <- c("bar", "foo")
x
}

print.bar <- function(x, ...) print(paste(x, "bar"))


Now the '-' operator must be defined in such a way that the behaviour is
different depending on the operand classes, and in particular
'bar'-'bar' needs to be different from 'bar'-'foo'. If I define the
following function:

"-.bar" <- function(e1, e2) "-.bar was called"

then I get the following results.

as.foo(1) - as.foo(2) # uses '-.foo'
as.bar(1) - as.bar(2) # uses '-.bar'
as.bar(1) - as.foo(2) # uses '-.default' and issues
# Incompatible methods warning
as.foo(1) - as.bar(2) # uses '-.default' and issues
# Incompatible methods warning

So that seems like a dead end.

If, overcoming an instinctive shudder of disgust, I redefine '-.foo' in
the "bar" package, I have checked that correctness is at the mercy of
the order of loading of the packages, even though the "bar" package
imports the "foo" package. So that doesn't seem to work either.

Before committing to making 'bar' an S4 class, does anyone know if there
is another option that would allow 'bar' to remain an S3 class?

Thanks,
Leo

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


From lsilvestri at ztsdb.org  Fri Feb 24 03:59:26 2017
From: lsilvestri at ztsdb.org (Leonardo Silvestri)
Date: Thu, 23 Feb 2017 21:59:26 -0500
Subject: [R-pkg-devel] Is a double dispatch possible with two S3 classes?
In-Reply-To: <trinity-a4c64459-a75c-47f7-9173-a0ab06a4bd57-1487789058764@3capp-webde-bs42>
References: <cfa4351c-772e-bf79-2ec6-8e1e6442c8e4@ztsdb.org>
	<trinity-a4c64459-a75c-47f7-9173-a0ab06a4bd57-1487789058764@3capp-webde-bs42>
Message-ID: <f71b76e6-6523-828e-ee2c-44b1837ebab0@ztsdb.org>

Jens,

Thanks for this detailed alternative. It's neat and works as you 
describe, but it does fall a little short of what S4 dispatch can do. In 
particular if a second package besides 'bar', say 'baz', needs to define 
operations 'foo + baz' or 'baz' + 'foo' it can't define 'baz::+.foobar' 
without breaking 'bar::+.foobar'...

Leo


On 02/22/2017 01:44 PM, "Jens Oehlschl?gel" wrote:
> Leonardo,
>
> I had a similar problem when I tried to implement reasonable behaviour for logical operators for classes .bit and .bitwhich in package 'bit'.
>
> Part of your problem is that R refuses to dispatch to any of two incompatible classes and instead falls back to a meaningless default.
>
> In theory, *this* problem *should* be solved in S3 by having a common super-class 'foobar' for class(foo) <- c('foo','foobar') and  class(bar) <- c('bar','foobar'), but again, R does refuses to dispatch on the common super-class (it directly tries to dispatch on the most special subclasses it finds and does not check for a common class in the class hierarchy).
>
> However, it appears that by having a common sub-class 'foobar' for class(foo) <- c('foobar','foo') and  class(bar) <- c('foobar','bar') we can get a common dispatch and hence get control. I plan for my next release of package 'bit' a common subclass 'booltype' to which R can dispatch without conflict. If you can convince the author of 'foo' to use class(foo) <- c('foobar','foo') and base his dispatch on 'foo', then you can dispatch on 'foobar' with no conflict and use NextMethod to invoke his code for the foo-foo case, and your code for the other cases. If the author refuses for some reason, you can still provide a wrapper to convert class 'foo' into class c('foobar','foo'), or do more nasty things like patching his class generator, but at least you don't need to patch his methods!
>
> I admit, using a physical subclass as a logical superclass is ugly: instead of declaring 'apples' and 'oranges' as special cases of 'fruits', we tell R that 'a fruit is an apple' and that 'a fruit is an orange', such that R dispatches to fruit-code for any combination of apples and oranges. Well ... the good thing is that NextMethod can invoke the original apple-code or orange-code, and we only need to write apple-orange-code and orange-apple-code to handle the new combinations.
>
> @R-devel: any comments or suggestions?
>
> HTH
>
>
> Jens Oehlschl?gel
>
>
> P.S. Example code and output follows
>
>
> # If we try to have 'foo' and 'bar' as specializations of of a superclass 'foobar'
>
> f <- "fooobj"
> oldClass(f) <- c('foo','foobar')
> "+.foo" <- function(e1,e2){
>   paste(e1,'+foo+',e2)
> }
>
> b <- "barobj"
> oldClass(b) <- c('bar','foobar')
> "+.bar" <- function(e1,e2){
>   paste(e1,'+bar+',e2)
> }
>
> "+.foobar" <- function(e1,e2){
>   if (inherits(e1,"foo") && inherits(e2,"bar"))
>     paste(e1,'+foobar+',e2)
>   else if (inherits(e1,"bar") && inherits(e2,"foo"))
>     paste(e1,'+barfoo+',e2)
>   else stop("should not be invoked for foo+foo or bar+bar (but it does)")
> }
>
> # Yes, this works
> f + f
> b + b
> # but here R does not even dispatch on the common superclass 'foobar'
> f + b
> b + f
>
>
> # However, it seems that we can trick R to do the right thing pretending that 'foobar' is a subclass of both, 'foo' and 'bar'
>
> oldClass(f) <- c('foobar','foo')
> "+.foo" <- function(e1,e2){
>   paste(e1,'+foo+',e2)
> }
>
> b <- "barobj"
> oldClass(b) <- c('foobar','bar')
> "+.bar" <- function(e1,e2){
>   paste(e1,'+bar+',e2)
> }
>
> "+.foobar" <- function(e1,e2){
>   if (inherits(e1,"foo") && inherits(e2,"bar"))
>     paste(e1,'+foobar+',e2)
>   else if (inherits(e1,"bar") && inherits(e2,"foo"))
>     paste(e1,'+barfoo+',e2)
>   else NextMethod(e1,e2)  # make sure we dispatch to foo+foo and bar+bar
> }
>
> # This works
> f + f
> b + b
> # but R does not even dispatch on the common ground 'foobar'
> f + b
> b + f
>
>
>
>> # If we try to have 'foo' and 'bar' as specializations of of a superclass 'foobar'
>>
>> f <- "fooobj"
>> oldClass(f) <- c('foo','foobar')
>> "+.foo" <- function(e1,e2){
> +   paste(e1,'+foo+',e2)
> + }
>>
>> b <- "barobj"
>> oldClass(b) <- c('bar','foobar')
>> "+.bar" <- function(e1,e2){
> +   paste(e1,'+bar+',e2)
> + }
>>
>> "+.foobar" <- function(e1,e2){
> +   if (inherits(e1,"foo") && inherits(e2,"bar"))
> +     paste(e1,'+foobar+',e2)
> +   else if (inherits(e1,"bar") && inherits(e2,"foo"))
> +     paste(e1,'+barfoo+',e2)
> +   else stop("should not be invoked for foo+foo or bar+bar (but it does)")
> + }
>>
>> # Yes, this works
>> f + f
> [1] "fooobj +foo+ fooobj"
>> b + b
> [1] "barobj +bar+ barobj"
>> # but here R does not even dispatch on the common superclass 'foobar'
>> f + b
> Fehler in f + b : nicht-numerisches Argument f?r bin?ren Operator
> Zus?tzlich: Warnmeldung:
> Inkompatible Methoden ("+.foo", "+.bar") f?r "+"
>> b + f
> Fehler in b + f : nicht-numerisches Argument f?r bin?ren Operator
> Zus?tzlich: Warnmeldung:
> Inkompatible Methoden ("+.bar", "+.foo") f?r "+"
>>
>>
>> # However, it seems that we can trick R to do the right thing pretending that 'foobar' is a subclass of both, 'foo' and 'bar'
>>
>> oldClass(f) <- c('foobar','foo')
>> "+.foo" <- function(e1,e2){
> +   paste(e1,'+foo+',e2)
> + }
>>
>> b <- "barobj"
>> oldClass(b) <- c('foobar','bar')
>> "+.bar" <- function(e1,e2){
> +   paste(e1,'+bar+',e2)
> + }
>>
>> "+.foobar" <- function(e1,e2){
> +   if (inherits(e1,"foo") && inherits(e2,"bar"))
> +     paste(e1,'+foobar+',e2)
> +   else if (inherits(e1,"bar") && inherits(e2,"foo"))
> +     paste(e1,'+barfoo+',e2)
> +   else NextMethod(e1,e2)  # make sure we dispatch to foo+foo and bar+bar
> + }
>>
>> # This works
>> f + f
> [1] "fooobj +foo+ fooobj"
>> b + b
> [1] "barobj +bar+ barobj"
>> # but R does not even dispatch on the common ground 'foobar'
>> f + b
> [1] "fooobj +foobar+ barobj"
>> b + f
> [1] "barobj +barfoo+ fooobj"
>
>
>
> Gesendet: Donnerstag, 16. Februar 2017 um 17:52 Uhr
> Von: "Leonardo Silvestri" <lsilvestri at ztsdb.org>
> An: r-package-devel at r-project.org
> Betreff: [R-pkg-devel] Is a double dispatch possible with two S3 classes?
> Hello,
>
> I have stumbled upon an S3 class dispatch issue which is easily solved
> using S4 classes, but I'd like to know if there is a way to solve it
> without changing the type of class used.
>
> The problem is as follows. There is an S3 class 'foo' which is defined
> in a package over which I don't have control. Then there is an S3 class
> 'bar' derived from 'foo' in a package that can be modified.
>
> Here is some code for 'foo':
>
> as.foo <- function(x) {
> oldClass(x) <- "foo"
> x
> }
>
> print.foo <- function(x, ...) print(paste(x, "foo"))
>
> "-.foo" <- function(e1, e2) "-.foo was called"
>
>
> And here is some code for 'bar':
>
> as.bar <- function(x) {
> oldClass(x) <- c("bar", "foo")
> x
> }
>
> print.bar <- function(x, ...) print(paste(x, "bar"))
>
>
> Now the '-' operator must be defined in such a way that the behaviour is
> different depending on the operand classes, and in particular
> 'bar'-'bar' needs to be different from 'bar'-'foo'. If I define the
> following function:
>
> "-.bar" <- function(e1, e2) "-.bar was called"
>
> then I get the following results.
>
> as.foo(1) - as.foo(2) # uses '-.foo'
> as.bar(1) - as.bar(2) # uses '-.bar'
> as.bar(1) - as.foo(2) # uses '-.default' and issues
> # Incompatible methods warning
> as.foo(1) - as.bar(2) # uses '-.default' and issues
> # Incompatible methods warning
>
> So that seems like a dead end.
>
> If, overcoming an instinctive shudder of disgust, I redefine '-.foo' in
> the "bar" package, I have checked that correctness is at the mercy of
> the order of loading of the packages, even though the "bar" package
> imports the "foo" package. So that doesn't seem to work either.
>
> Before committing to making 'bar' an S4 class, does anyone know if there
> is another option that would allow 'bar' to remain an S3 class?
>
> Thanks,
> Leo
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From yutani.ini at gmail.com  Sat Feb 25 04:41:28 2017
From: yutani.ini at gmail.com (Hiroaki Yutani)
Date: Sat, 25 Feb 2017 12:41:28 +0900
Subject: [R-pkg-devel] The license of a vignette and its translation
Message-ID: <CALyqOb_G_n_-om=VUuTvXALiFiiZPfG8K4SMER6B8Dd2ogGCCA@mail.gmail.com>

Hi,

To spread the power of great R packages, I and my friends are trying to
translate vignettes of several packages into our local language (Japanese).
But, I'm not fully confident that I understand their licenses well. Are the
following understanding right?

1) Since a vignette is the part of a package, the license written in
DESCRIPTION will be applied also on the vignette.
2) If the license of a package is of FOSS, we are free to translate these
vignettes.
3) If the license is GPL-2/3, we are supposed to license the translated
documents as GPL-2/3 as well.

And, one more question, are there any chance a vignette has a different
license than the other part of the package?

(These questions are not really about package development, so I'm sorry if
this mailing list is not the right place to ask...)

Peace,
Hiroaki Yutani

	[[alternative HTML version deleted]]


From glennmschultz at me.com  Sat Feb 25 15:50:20 2017
From: glennmschultz at me.com (Glenn Schultz)
Date: Sat, 25 Feb 2017 14:50:20 +0000 (GMT)
Subject: [R-pkg-devel] tryCatch defensive programming guidance
Message-ID: <a7d53832-8fc0-4cbf-972b-f8e5b0bcc3a4@me.com>

All,

I have the following to create a class PriceTypes. ?I use try catch on the function and it gives me the error

price <- tryCatch(PriceTypes(price = "100")
,error = function(e) print(e)
,warning = function(w) print(w))

<simpleError in PriceTypes(price = "100"): tail value is missing>
>

I read the section on tryCatch and withCallingHandlers as well the manual but I am still not clear as to how to use tryCatch in the function below I tried
PriceTypes <- TryCatch(
??????????????????????????????????????????function(){}
??????????????????????????????????????????), function(e) print(error)

but this is obviously wrong as it did not work. ?My question can I use tryCatch in the function itself or only when I invoke the function.

Best Regards,
Glenn

#' An S4 class representating bond price
#' 
#' This class is used to create and pass the price types reported to 
#' investors and used in analytics. For example price is often reported as
#' decimal or fractions 32nds to investors but price basis (price/100) is
#' used to calculate proceeds and compute metrics like yield, duration, and
#' partial durations.
#' @slot PriceDecimal A numeric value the price using decimal notation
#' @slot Price32nds A character the price using 32nds notation
#' @slot PriceBasis A numeric value price decimal notation in units of 100
#' @slot PriceDecimalString A character the price using decimal notation
#' @exportClass PriceTypes
setClass("PriceTypes",
representation(
PriceDecimal = "numeric",
Price32nds = "character",
PriceBasis = "numeric",
PriceDecimalString = "character")
)

setGeneric("PriceTypes", function(price = numeric())
{standardGeneric("PriceTypes")})

#' A standard generic function get the slot PriceDecimal
#' 
#' @param object an S4 object
#' @export PriceDecimal
setGeneric("PriceDecimal", function(object)
{standardGeneric("PriceDecimal")})

#' A standard generic function to set the slot PriceDecimal
#' 
#' @param object an S4 object
#' @param value the replacement value of the slot
#' @export PriceDecimal<-
setGeneric("PriceDecimal<-", function(object, value)
{standardGeneric("PriceDecimal<-")})

#' A standard generic function to get the slot Price32nds
#' 
#' @param object an S4 object
#' @export Price32nds
setGeneric("Price32nds", function(object)
{standardGeneric("Price32nds")})

#' A standard generic function to set the slot Price32nds
#' 
#' @param object an S4 object
#' @param value the replacement value of the slot
#' @export Price32nds<-
setGeneric("Price32nds<-", function(object, value)
{setGeneric("Price32nds")})

#' A standard generic to get the slot PriceBasis
#' 
#' @param object an S4 object
#' @export PriceBasis
setGeneric("PriceBasis", function(object)
{standardGeneric("PriceBasis")})

#' A standard generic to set the slot PriceBasis
#' 
#' @param object A S4 object of type PriceTypes
#' @param value the replacement value of the slot
#' @export PriceBasis<-
setGeneric("PriceBasis<-", function(object, value)
{standardGeneric("PriceBasis<-")})

#' A standard generic to get the slot PriceDecimalString
#' 
#' @param object A S4 object of the type PriceTypes
#' @export
setGeneric("PriceDecimalString", function(object)
{setGeneric("PriceDecimalString")})

#' A standard generic to set the slot PriceDecimalString
#' 
#' @param object A S4 object of the type PriceTypes
#' @param value The replacement value of the slot
#' @export
setGeneric("PriceDecimalString<-", function(object, value)
{setGeneric("PriceDecimalString<-")})

setMethod("initialize",
signature("PriceTypes"),
function(.Object,
PriceDecimal = numeric(),
Price32nds = "character",
PriceBasis = numeric(),
PriceDecimalString = "character",
...){
callNextMethod(.Object,
PriceDecimal = PriceDecimal,
Price32nds = Price32nds,
PriceBasis = PriceBasis,
PriceDecimalString = PriceDecimalString,
...)
})
#' A method to extract PriceDecimal from slot of class PriceTypes
#' 
#' @param object an S4 object of the type PriceTypes
#' @exportMethod PriceDecimal
setMethod("PriceDecimal", signature("PriceTypes"),
function(object){object at PriceDecimal})

#' A method to set PriceDecimal in slot of class PriceTypes
#' 
#' @param object an S4 object of the typre PriceTypes
#' @param value the replacement value of the slot
#' @exportMethod PriceDecimal<-
setReplaceMethod("PriceDecimal", signature("PriceTypes"),
function(object, value){
object at PriceDecimal <- value
return(object)
})

#' A method to extract Price32nds from slot of class PriceTypes
#' 
#' @param object an S4 object of the type PriceTypes
#' @exportMethod Price32nds
setMethod("Price32nds", signature("PriceTypes"),
function(object){object at Price32nds})

#' A method to set Price32nds in slot of class PriceTypes
#' 
#' @param object an S4 object of the type PriceTypes
#' @param value the replacement value of the slot
setReplaceMethod("Price32nds", signature("PriceTypes"),
function(object, value){
object at Price32nds <- value
return(object)
})

#' A method to extract PriceBasis from slot of class PriceTypres
#' 
#' @param object an S4 object of the type PriceType
#' @exportMethod PriceBasis
setMethod("PriceBasis", signature("PriceTypes"),
function(object){object at PriceBasis})

#' a method to set PriceBasis from slot of class PriceTypes
#' 
#' @param object an S4 object of the type PriceTypes
#' @param value the replacement value of the slot
#' @exportMethod PriceBasis<-
setReplaceMethod("PriceBasis", signature("PriceTypes"),
function(object, value){
object at PriceBasis <- value
return(object)
})

#' A method to extract PriceDecimalString from slot of class PriceTypes
#' 
#' @param object an S4 object of type PriceTypes
#' @exportMethod PriceDecimalString
setMethod("PriceDecimalString", signature("PriceTypes"),
function(object){object at PriceDecimalString})

#' A method to set PriceDecimalString from slot of class PriceTypes
#' 
#' @param object an S4 object of type PriceTypes
#' @param value the replacement value of the slot
#' @exportMethod PriceDecimalString<-
setReplaceMethod("PriceDecimalString", signature("PriceTypes"),
function(object, value){
object at PriceDecimalString <- value
return(object)})

#' PriceTypes is a constructor function for the class PriceTypes
#' 
#' @param price character the price in either 
#' decimal notation (example "100.125") or 32nds notation (example "100-4")
#' @export PriceTypes
PriceTypes <- function(price){
PriceBasis = 100
Units = 32

if(mode(price) != "character") stop ("price must be a character")
if(is.na(strsplit(price, "\\.|\\-")[[1]][2]) == TRUE) stop (
"tail value is missing")

Convertto32nds <- function(Price = "character"){
#convert price to numeric value
Price = as.numeric(Price)
tail32nds = round(x = (Price - floor(x = Price)) * 32, digits = 4)
Price = paste(as.character(floor(x=Price)),
"-",
as.character(tail32nds),
sep = "")
return(Price)
}

ConverttoDecimal <- function(Price = "character", Units = numeric()){
SplitPrice = strsplit(as.character(Price), "-")
handle = as.numeric(SplitPrice[[1]][1])
TailDecimal = signif(as.numeric(SplitPrice[[1]][2])/Units,8)
TailDecimal = gsub("(^|[^0-9])0+", "\\1", TailDecimal, perl = TRUE)
Price = paste(as.character(handle),
as.character(TailDecimal),sep="")
return(Price)
}

ConverttoString <- function(PriceDecimal = numeric()){
sprintf("%.8f", PriceDecimal)
}

# Convert Price when entered as a decimal value
if(grepl(".", as.character(price), fixed = TRUE) == TRUE){
Price_Decimal = format(as.numeric(price), nsmall =2)
Price_32nds = Convertto32nds(Price = price)
Price_Basis = as.numeric(price) / PriceBasis
Price_Decimal_String = ConverttoString(
PriceDecimal = as.numeric(Price_Decimal))
}

if(grepl("-", as.character(price), fixed = TRUE) == TRUE){
Price_Decimal = ConverttoDecimal(Price = price, Units = Units)
Price_32nds = price
Price_Basis = as.numeric(Price_Decimal)/PriceBasis
Price_Decimal_String = ConverttoString(
PriceDecimal = as.numeric(Price_Decimal))
}

new("PriceTypes",
PriceDecimal = as.numeric(Price_Decimal),
Price32nds = Price_32nds,
PriceBasis = as.numeric(Price_Basis),
PriceDecimalString = Price_Decimal_String
)
}

From brodie.gaslam at yahoo.com  Sun Feb 26 21:52:09 2017
From: brodie.gaslam at yahoo.com (brodie gaslam)
Date: Sun, 26 Feb 2017 20:52:09 +0000 (UTC)
Subject: A package that traces base functions
References: <1471276754.1338948.1488142329167.ref@mail.yahoo.com>
Message-ID: <1471276754.1338948.1488142329167@mail.yahoo.com>

Apologies, this is a cross post from 'R-devel', where I sent this message a few months ago when I did not realize there was an 'r-package-devel' list.? So here it is again in the correct list:

I'm working on a package that implements a REPL.? A typical interaction with the package might look like:
> launch_REPL()REPL> 1 + 1[1] 2REPL> QDo you wish to save results? [y/n]REPL> ygoodbye ...>
This is very similar to what happens when in `browser()`: the REPL evaluates arbitrary R user expressions and offers some additional commands.
In order to implement functionality required for the REPL I must trace some functions in the base package.? The trace is removed `on.exit()` from the REPL, so the functions are only modified while the `launch_REPL` function is evaluating.? Unfortunately this is against the letter of the law (as per CRAN policy):
> A package must not tamper with the code already loaded into R: anyattempt to change code in the standard and recommended packages whichship with R is prohibited.
Is there any chance that this very limited (only during my function evaluation) modification of base functions with `trace` could be considered to meet the spirit of the law, if not the letter?? Package users would be duly notified this is happening.
Alternatively, if this is not allowed, would it be acceptable to ship the functionality turned off by default with a user option to enable it (documented with warnings about how this is non-standard behavior, etc.)?

Regards,
Brodie Gaslam.
PS: More details for those who care: the REPL among other things implements an environment that has for parent `as.environment(2)` so that objects in the global environment are not visible while in the REPL, but otherwise the full search path is.? Anytime the search path changes I need to update the REPL environment to re-point to `as.environment(2)`, which means I need to know when the search path changes.? I do this by tracing `library`/`attach`/`detach` and triggering a side effect that updates the REPL environment parent any time those are called.? The search path itself is untouched.? I cannot just parse user expressions searching for those functions as the user can use any arbitrary expressions, including sourcing files that contain the `library`, etc. calls.? 
	[[alternative HTML version deleted]]


From patrick.schratz at gmail.com  Tue Feb 28 16:44:48 2017
From: patrick.schratz at gmail.com (Patrick Schratz)
Date: Tue, 28 Feb 2017 16:44:48 +0100
Subject: [R-pkg-devel] .bib file in vignette not found during R CMD check
Message-ID: <CAE=-a0Ryo5zQ72VZqMftN9r0_NSZYHgEdgqNTCs5pWaHzytkMA@mail.gmail.com>

When building the vignette using R CMD Build or
`devtools::build_vignette()` everything works fine.

However, during R CMD check I get the following

** checking running R code from vignettes ...*
*   ?sperrorest-vignette.Rmd? using ?UTF-8? ... OK*
* NONE*
** checking re-building of vignette outputs ... WARNING*
*Error in re-building vignettes:*
*  ...*
*pandoc-citeproc: Could not find Biblio.bib*
*CallStack (from HasCallStack):*
*  error, called at src/Text/CSL/Pandoc.hs:224:39 in
pandoc-citeproc-0.10.4.1-EdjBizYp62fCPHef3CymGR:Text.CSL.Pandoc*
*pandoc: Error running filter /usr/local/bin/pandoc-citeproc*
*Filter returned error status 1*
*Error: processing vignette 'sperrorest-vignette.Rmd' failed with
diagnostics:*
*pandoc document conversion failed with error 83*
*Execution halted*

The .bib file is lying in `/vignettes`. There is a similar question on SO
<http://stackoverflow.com/questions/41126556/any-way-of-attaching-csl-bib-files-by-using-knitcitations-package>
but
the answer does not address the problem.
When using full paths everything is fine. However, I cannot use full paths
when submitting to CRAN.

If you want to check on your own, please use the `dev` branch;
https://github.com/pat-s/sperrorest/tree/dev

pandoc-citeproc: stable 0.10.4.1 (bottled), HEAD
pandoc: stable 1.19.2.1 (bottled), HEAD

Best, Patrick

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Tue Feb 28 18:57:09 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 28 Feb 2017 12:57:09 -0500
Subject: [R-pkg-devel] .bib file in vignette not found during R CMD check
In-Reply-To: <CAE=-a0Ryo5zQ72VZqMftN9r0_NSZYHgEdgqNTCs5pWaHzytkMA@mail.gmail.com>
References: <CAE=-a0Ryo5zQ72VZqMftN9r0_NSZYHgEdgqNTCs5pWaHzytkMA@mail.gmail.com>
Message-ID: <37116146-1f19-825b-daf1-9f3becd50734@gmail.com>

On 28/02/2017 10:44 AM, Patrick Schratz wrote:
> When building the vignette using R CMD Build or
> `devtools::build_vignette()` everything works fine.
>
> However, during R CMD check I get the following
>
> ** checking running R code from vignettes ...*
> *   ?sperrorest-vignette.Rmd? using ?UTF-8? ... OK*
> * NONE*
> ** checking re-building of vignette outputs ... WARNING*
> *Error in re-building vignettes:*
> *  ...*
> *pandoc-citeproc: Could not find Biblio.bib*
> *CallStack (from HasCallStack):*
> *  error, called at src/Text/CSL/Pandoc.hs:224:39 in
> pandoc-citeproc-0.10.4.1-EdjBizYp62fCPHef3CymGR:Text.CSL.Pandoc*
> *pandoc: Error running filter /usr/local/bin/pandoc-citeproc*
> *Filter returned error status 1*
> *Error: processing vignette 'sperrorest-vignette.Rmd' failed with
> diagnostics:*
> *pandoc document conversion failed with error 83*
> *Execution halted*
>
> The .bib file is lying in `/vignettes`. There is a similar question on SO
> <http://stackoverflow.com/questions/41126556/any-way-of-attaching-csl-bib-files-by-using-knitcitations-package>
> but
> the answer does not address the problem.
> When using full paths everything is fine. However, I cannot use full paths
> when submitting to CRAN.
>
> If you want to check on your own, please use the `dev` branch;
> https://github.com/pat-s/sperrorest/tree/dev
>
> pandoc-citeproc: stable 0.10.4.1 (bottled), HEAD
> pandoc: stable 1.19.2.1 (bottled), HEAD

Your .Rbuildignore file says not to include Biblio.bib.  Don't do that.

Duncan Murdoch


From h.wickham at gmail.com  Tue Feb 28 23:00:08 2017
From: h.wickham at gmail.com (Hadley Wickham)
Date: Tue, 28 Feb 2017 16:00:08 -0600
Subject: [R-pkg-devel] .bib file in vignette not found during R CMD check
In-Reply-To: <37116146-1f19-825b-daf1-9f3becd50734@gmail.com>
References: <CAE=-a0Ryo5zQ72VZqMftN9r0_NSZYHgEdgqNTCs5pWaHzytkMA@mail.gmail.com>
	<37116146-1f19-825b-daf1-9f3becd50734@gmail.com>
Message-ID: <CABdHhvEo9if__FdHORCUZWLPsKnM7guW9q1sv0nSeJnpKExfgw@mail.gmail.com>

I wonder if it would be useful for R CMD build to list the files it
ignores? A misspecified .Rbuildignore seems to be reasonable for a
high proportion of weird errors where you have no idea what's going
wrong.

Hadley

On Tue, Feb 28, 2017 at 11:57 AM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 28/02/2017 10:44 AM, Patrick Schratz wrote:
>>
>> When building the vignette using R CMD Build or
>> `devtools::build_vignette()` everything works fine.
>>
>> However, during R CMD check I get the following
>>
>> ** checking running R code from vignettes ...*
>> *   ?sperrorest-vignette.Rmd? using ?UTF-8? ... OK*
>> * NONE*
>> ** checking re-building of vignette outputs ... WARNING*
>> *Error in re-building vignettes:*
>> *  ...*
>> *pandoc-citeproc: Could not find Biblio.bib*
>> *CallStack (from HasCallStack):*
>> *  error, called at src/Text/CSL/Pandoc.hs:224:39 in
>> pandoc-citeproc-0.10.4.1-EdjBizYp62fCPHef3CymGR:Text.CSL.Pandoc*
>> *pandoc: Error running filter /usr/local/bin/pandoc-citeproc*
>> *Filter returned error status 1*
>> *Error: processing vignette 'sperrorest-vignette.Rmd' failed with
>> diagnostics:*
>> *pandoc document conversion failed with error 83*
>> *Execution halted*
>>
>> The .bib file is lying in `/vignettes`. There is a similar question on SO
>>
>> <http://stackoverflow.com/questions/41126556/any-way-of-attaching-csl-bib-files-by-using-knitcitations-package>
>> but
>> the answer does not address the problem.
>> When using full paths everything is fine. However, I cannot use full paths
>> when submitting to CRAN.
>>
>> If you want to check on your own, please use the `dev` branch;
>> https://github.com/pat-s/sperrorest/tree/dev
>>
>> pandoc-citeproc: stable 0.10.4.1 (bottled), HEAD
>> pandoc: stable 1.19.2.1 (bottled), HEAD
>
>
> Your .Rbuildignore file says not to include Biblio.bib.  Don't do that.
>
> Duncan Murdoch
>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
http://hadley.nz


From patrick.schratz at gmail.com  Tue Feb 28 23:17:40 2017
From: patrick.schratz at gmail.com (Patrick Schratz)
Date: Tue, 28 Feb 2017 23:17:40 +0100
Subject: [R-pkg-devel] .bib file in vignette not found during R CMD check
In-Reply-To: <37116146-1f19-825b-daf1-9f3becd50734@gmail.com>
References: <CAE=-a0Ryo5zQ72VZqMftN9r0_NSZYHgEdgqNTCs5pWaHzytkMA@mail.gmail.com>
	<37116146-1f19-825b-daf1-9f3becd50734@gmail.com>
Message-ID: <CAE=-a0SCMBciOVkw0sa=OjgO-3kafbzfT=g460fY4UQVu8dfwg@mail.gmail.com>

Thanks Duncan, that was the problem! Although the Rbuildignore entry
pointed to the main dir and my .bib file was lying under vignettes/...
That Rbuildignore entry was a leftover when my .bib file was initially
lying in the top directory and hence was throwing notes during R CMD check.

Afterwards I used full paths in the vignette to specify the .bib location.
This approach works fine until you submit to CRAN which of course cannot
deal with full paths (and you forget about that you used a full path when
releasing).

@hadley
Could be useful as most often you do not think of possible leftover entries
in Rbuildignore...

2017-02-28 18:57 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:

> On 28/02/2017 10:44 AM, Patrick Schratz wrote:
>
>> When building the vignette using R CMD Build or
>> `devtools::build_vignette()` everything works fine.
>>
>> However, during R CMD check I get the following
>>
>> ** checking running R code from vignettes ...*
>> *   ?sperrorest-vignette.Rmd? using ?UTF-8? ... OK*
>> * NONE*
>> ** checking re-building of vignette outputs ... WARNING*
>> *Error in re-building vignettes:*
>> *  ...*
>> *pandoc-citeproc: Could not find Biblio.bib*
>> *CallStack (from HasCallStack):*
>> *  error, called at src/Text/CSL/Pandoc.hs:224:39 in
>> pandoc-citeproc-0.10.4.1-EdjBizYp62fCPHef3CymGR:Text.CSL.Pandoc*
>> *pandoc: Error running filter /usr/local/bin/pandoc-citeproc*
>> *Filter returned error status 1*
>> *Error: processing vignette 'sperrorest-vignette.Rmd' failed with
>> diagnostics:*
>> *pandoc document conversion failed with error 83*
>> *Execution halted*
>>
>> The .bib file is lying in `/vignettes`. There is a similar question on SO
>> <http://stackoverflow.com/questions/41126556/any-way-of-atta
>> ching-csl-bib-files-by-using-knitcitations-package>
>> but
>> the answer does not address the problem.
>> When using full paths everything is fine. However, I cannot use full paths
>> when submitting to CRAN.
>>
>> If you want to check on your own, please use the `dev` branch;
>> https://github.com/pat-s/sperrorest/tree/dev
>>
>> pandoc-citeproc: stable 0.10.4.1 (bottled), HEAD
>> pandoc: stable 1.19.2.1 (bottled), HEAD
>>
>
> Your .Rbuildignore file says not to include Biblio.bib.  Don't do that.
>
> Duncan Murdoch
>
>

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Tue Feb 28 23:47:25 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 28 Feb 2017 17:47:25 -0500
Subject: [R-pkg-devel] .bib file in vignette not found during R CMD check
In-Reply-To: <CAE=-a0SCMBciOVkw0sa=OjgO-3kafbzfT=g460fY4UQVu8dfwg@mail.gmail.com>
References: <CAE=-a0Ryo5zQ72VZqMftN9r0_NSZYHgEdgqNTCs5pWaHzytkMA@mail.gmail.com>
	<37116146-1f19-825b-daf1-9f3becd50734@gmail.com>
	<CAE=-a0SCMBciOVkw0sa=OjgO-3kafbzfT=g460fY4UQVu8dfwg@mail.gmail.com>
Message-ID: <e7b9f3eb-8010-de2d-819a-b9945d786d42@gmail.com>

On 28/02/2017 5:17 PM, Patrick Schratz wrote:
> Thanks Duncan, that was the problem! Although the Rbuildignore entry
> pointed to the main dir

No, it contains patterns, not paths, and is matched "case-insensitively 
against the file and directory names relative to the top-level package 
source directory".  Put ^ at the beginning if you want to refer to the 
main dir.

Hadley, reporting what gets omitted might be a good suggestion, but it 
might report too much in a package with compiled code (the .o files will 
generally be omitted; rgl has 51 of those in src...).

Duncan Murdoch

and my .bib file was lying under vignettes/...
> That Rbuildignore entry was a leftover when my .bib file was initially
> lying in the top directory and hence was throwing notes during R CMD check.
>
> Afterwards I used full paths in the vignette to specify the .bib
> location. This approach works fine until you submit to CRAN which of
> course cannot deal with full paths (and you forget about that you used a
> full path when releasing).
>
> @hadley
> Could be useful as most often you do not think of possible leftover
> entries in Rbuildignore...
>
> 2017-02-28 18:57 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com
> <mailto:murdoch.duncan at gmail.com>>:
>
>     On 28/02/2017 10:44 AM, Patrick Schratz wrote:
>
>         When building the vignette using R CMD Build or
>         `devtools::build_vignette()` everything works fine.
>
>         However, during R CMD check I get the following
>
>         ** checking running R code from vignettes ...*
>         *   ?sperrorest-vignette.Rmd? using ?UTF-8? ... OK*
>         * NONE*
>         ** checking re-building of vignette outputs ... WARNING*
>         *Error in re-building vignettes:*
>         *  ...*
>         *pandoc-citeproc: Could not find Biblio.bib*
>         *CallStack (from HasCallStack):*
>         *  error, called at src/Text/CSL/Pandoc.hs:224:39 in
>         pandoc-citeproc-0.10.4.1-EdjBizYp62fCPHef3CymGR:Text.CSL.Pandoc*
>         *pandoc: Error running filter /usr/local/bin/pandoc-citeproc*
>         *Filter returned error status 1*
>         *Error: processing vignette 'sperrorest-vignette.Rmd' failed with
>         diagnostics:*
>         *pandoc document conversion failed with error 83*
>         *Execution halted*
>
>         The .bib file is lying in `/vignettes`. There is a similar
>         question on SO
>         <http://stackoverflow.com/questions/41126556/any-way-of-attaching-csl-bib-files-by-using-knitcitations-package
>         <http://stackoverflow.com/questions/41126556/any-way-of-attaching-csl-bib-files-by-using-knitcitations-package>>
>         but
>         the answer does not address the problem.
>         When using full paths everything is fine. However, I cannot use
>         full paths
>         when submitting to CRAN.
>
>         If you want to check on your own, please use the `dev` branch;
>         https://github.com/pat-s/sperrorest/tree/dev
>         <https://github.com/pat-s/sperrorest/tree/dev>
>
>         pandoc-citeproc: stable 0.10.4.1 (bottled), HEAD
>         pandoc: stable 1.19.2.1 (bottled), HEAD
>
>
>     Your .Rbuildignore file says not to include Biblio.bib.  Don't do that.
>
>     Duncan Murdoch
>
>


From henrik.bengtsson at gmail.com  Wed Mar  1 08:17:17 2017
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Tue, 28 Feb 2017 23:17:17 -0800
Subject: [R-pkg-devel] .bib file in vignette not found during R CMD check
In-Reply-To: <e7b9f3eb-8010-de2d-819a-b9945d786d42@gmail.com>
References: <CAE=-a0Ryo5zQ72VZqMftN9r0_NSZYHgEdgqNTCs5pWaHzytkMA@mail.gmail.com>
	<37116146-1f19-825b-daf1-9f3becd50734@gmail.com>
	<CAE=-a0SCMBciOVkw0sa=OjgO-3kafbzfT=g460fY4UQVu8dfwg@mail.gmail.com>
	<e7b9f3eb-8010-de2d-819a-b9945d786d42@gmail.com>
Message-ID: <CAFDcVCSsYDPz4zR8Bxy6A5nEuTaC-Ko7sskei3GksFrDEo=wjg@mail.gmail.com>

On Tue, Feb 28, 2017 at 2:47 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 28/02/2017 5:17 PM, Patrick Schratz wrote:
>>
>> Thanks Duncan, that was the problem! Although the Rbuildignore entry
>> pointed to the main dir
>
>
> No, it contains patterns, not paths, and is matched "case-insensitively
> against the file and directory names relative to the top-level package
> source directory".  Put ^ at the beginning if you want to refer to the main
> dir.
>
> Hadley, reporting what gets omitted might be a good suggestion, but it might
> report too much in a package with compiled code (the .o files will generally
> be omitted; rgl has 51 of those in src...).

I like this idea.  It could be done such that R CMD build lists the
files omitted based solely on the content of .Rbuildignore, which I
assume is also what Hadley meant.  This way *.o files wouldn't be
listed since they're omitted by the built-in rules of R CMD build
itself.

/Henrik

>
> Duncan Murdoch
>
> and my .bib file was lying under vignettes/...
>>
>> That Rbuildignore entry was a leftover when my .bib file was initially
>> lying in the top directory and hence was throwing notes during R CMD
>> check.
>>
>> Afterwards I used full paths in the vignette to specify the .bib
>> location. This approach works fine until you submit to CRAN which of
>> course cannot deal with full paths (and you forget about that you used a
>> full path when releasing).
>>
>> @hadley
>> Could be useful as most often you do not think of possible leftover
>> entries in Rbuildignore...
>>
>> 2017-02-28 18:57 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com
>> <mailto:murdoch.duncan at gmail.com>>:
>>
>>     On 28/02/2017 10:44 AM, Patrick Schratz wrote:
>>
>>         When building the vignette using R CMD Build or
>>         `devtools::build_vignette()` everything works fine.
>>
>>         However, during R CMD check I get the following
>>
>>         ** checking running R code from vignettes ...*
>>         *   ?sperrorest-vignette.Rmd? using ?UTF-8? ... OK*
>>         * NONE*
>>         ** checking re-building of vignette outputs ... WARNING*
>>         *Error in re-building vignettes:*
>>         *  ...*
>>         *pandoc-citeproc: Could not find Biblio.bib*
>>         *CallStack (from HasCallStack):*
>>         *  error, called at src/Text/CSL/Pandoc.hs:224:39 in
>>         pandoc-citeproc-0.10.4.1-EdjBizYp62fCPHef3CymGR:Text.CSL.Pandoc*
>>         *pandoc: Error running filter /usr/local/bin/pandoc-citeproc*
>>         *Filter returned error status 1*
>>         *Error: processing vignette 'sperrorest-vignette.Rmd' failed with
>>         diagnostics:*
>>         *pandoc document conversion failed with error 83*
>>         *Execution halted*
>>
>>         The .bib file is lying in `/vignettes`. There is a similar
>>         question on SO
>>
>> <http://stackoverflow.com/questions/41126556/any-way-of-attaching-csl-bib-files-by-using-knitcitations-package
>>
>> <http://stackoverflow.com/questions/41126556/any-way-of-attaching-csl-bib-files-by-using-knitcitations-package>>
>>         but
>>         the answer does not address the problem.
>>         When using full paths everything is fine. However, I cannot use
>>         full paths
>>         when submitting to CRAN.
>>
>>         If you want to check on your own, please use the `dev` branch;
>>         https://github.com/pat-s/sperrorest/tree/dev
>>         <https://github.com/pat-s/sperrorest/tree/dev>
>>
>>         pandoc-citeproc: stable 0.10.4.1 (bottled), HEAD
>>         pandoc: stable 1.19.2.1 (bottled), HEAD
>>
>>
>>     Your .Rbuildignore file says not to include Biblio.bib.  Don't do
>> that.
>>
>>     Duncan Murdoch
>>
>>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch.duncan at gmail.com  Wed Mar  1 11:14:59 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 1 Mar 2017 05:14:59 -0500
Subject: [R-pkg-devel] .bib file in vignette not found during R CMD check
In-Reply-To: <CAFDcVCSsYDPz4zR8Bxy6A5nEuTaC-Ko7sskei3GksFrDEo=wjg@mail.gmail.com>
References: <CAE=-a0Ryo5zQ72VZqMftN9r0_NSZYHgEdgqNTCs5pWaHzytkMA@mail.gmail.com>
	<37116146-1f19-825b-daf1-9f3becd50734@gmail.com>
	<CAE=-a0SCMBciOVkw0sa=OjgO-3kafbzfT=g460fY4UQVu8dfwg@mail.gmail.com>
	<e7b9f3eb-8010-de2d-819a-b9945d786d42@gmail.com>
	<CAFDcVCSsYDPz4zR8Bxy6A5nEuTaC-Ko7sskei3GksFrDEo=wjg@mail.gmail.com>
Message-ID: <4af3fec5-c505-f995-d4e4-3b4ccd05d138@gmail.com>

On 01/03/2017 2:17 AM, Henrik Bengtsson wrote:
> On Tue, Feb 28, 2017 at 2:47 PM, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
>> On 28/02/2017 5:17 PM, Patrick Schratz wrote:
>>>
>>> Thanks Duncan, that was the problem! Although the Rbuildignore entry
>>> pointed to the main dir
>>
>>
>> No, it contains patterns, not paths, and is matched "case-insensitively
>> against the file and directory names relative to the top-level package
>> source directory".  Put ^ at the beginning if you want to refer to the main
>> dir.
>>
>> Hadley, reporting what gets omitted might be a good suggestion, but it might
>> report too much in a package with compiled code (the .o files will generally
>> be omitted; rgl has 51 of those in src...).
>
> I like this idea.  It could be done such that R CMD build lists the
> files omitted based solely on the content of .Rbuildignore, which I
> assume is also what Hadley meant.  This way *.o files wouldn't be
> listed since they're omitted by the built-in rules of R CMD build
> itself.

That makes sense.  Want to submit a patch?

Duncan Murdoch


From berryboessenkool at hotmail.com  Wed Mar  1 15:52:10 2017
From: berryboessenkool at hotmail.com (Berry Boessenkool)
Date: Wed, 1 Mar 2017 14:52:10 +0000
Subject: [R-pkg-devel] tryCatch defensive programming guidance
In-Reply-To: <a7d53832-8fc0-4cbf-972b-f8e5b0bcc3a4@me.com>
References: <a7d53832-8fc0-4cbf-972b-f8e5b0bcc3a4@me.com>
Message-ID: <AM2PR04MB0802C81ECD80AF3A8D5556BCD5290@AM2PR04MB0802.eurprd04.prod.outlook.com>


Hi Glenn,


Better late than never:

couldn't you simply use try?


result <- try(  log("a")  )


The printing is horrible: people will think an error occured (but the function didn't stop!)

I tend to use it like this (which may be totally unintended):



res <- try(log("a"), silent=TRUE)
if(inherits(res, "try-error"))
{
 message("log failed: ",res,". Now continuing with res=0.")
 res <- 0
}




See here for my version that captures errors/warnings/messages with call tracing:

https://www.rdocumentation.org/packages/berryFunctions/topics/tryStack


Regards,

Berry


________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Glenn Schultz <glennmschultz at me.com>
Sent: Saturday, February 25, 2017 15:50
To: R Package Development
Subject: [R-pkg-devel] tryCatch defensive programming guidance

All,

I have the following to create a class PriceTypes.  I use try catch on the function and it gives me the error

price <- tryCatch(PriceTypes(price = "100")
,error = function(e) print(e)
,warning = function(w) print(w))

<simpleError in PriceTypes(price = "100"): tail value is missing>
>

I read the section on tryCatch and withCallingHandlers as well the manual but I am still not clear as to how to use tryCatch in the function below I tried
PriceTypes <- TryCatch(
                                          function(){}
                                          ), function(e) print(error)

but this is obviously wrong as it did not work.  My question can I use tryCatch in the function itself or only when I invoke the function.

Best Regards,
Glenn

#' An S4 class representating bond price
#'
#' This class is used to create and pass the price types reported to
#' investors and used in analytics. For example price is often reported as
#' decimal or fractions 32nds to investors but price basis (price/100) is
#' used to calculate proceeds and compute metrics like yield, duration, and
#' partial durations.
#' @slot PriceDecimal A numeric value the price using decimal notation
#' @slot Price32nds A character the price using 32nds notation
#' @slot PriceBasis A numeric value price decimal notation in units of 100
#' @slot PriceDecimalString A character the price using decimal notation
#' @exportClass PriceTypes
setClass("PriceTypes",
representation(
PriceDecimal = "numeric",
Price32nds = "character",
PriceBasis = "numeric",
PriceDecimalString = "character")
)

setGeneric("PriceTypes", function(price = numeric())
{standardGeneric("PriceTypes")})

#' A standard generic function get the slot PriceDecimal
#'
#' @param object an S4 object
#' @export PriceDecimal
setGeneric("PriceDecimal", function(object)
{standardGeneric("PriceDecimal")})

#' A standard generic function to set the slot PriceDecimal
#'
#' @param object an S4 object
#' @param value the replacement value of the slot
#' @export PriceDecimal<-
setGeneric("PriceDecimal<-", function(object, value)
{standardGeneric("PriceDecimal<-")})

#' A standard generic function to get the slot Price32nds
#'
#' @param object an S4 object
#' @export Price32nds
setGeneric("Price32nds", function(object)
{standardGeneric("Price32nds")})

#' A standard generic function to set the slot Price32nds
#'
#' @param object an S4 object
#' @param value the replacement value of the slot
#' @export Price32nds<-
setGeneric("Price32nds<-", function(object, value)
{setGeneric("Price32nds")})

#' A standard generic to get the slot PriceBasis
#'
#' @param object an S4 object
#' @export PriceBasis
setGeneric("PriceBasis", function(object)
{standardGeneric("PriceBasis")})

#' A standard generic to set the slot PriceBasis
#'
#' @param object A S4 object of type PriceTypes
#' @param value the replacement value of the slot
#' @export PriceBasis<-
setGeneric("PriceBasis<-", function(object, value)
{standardGeneric("PriceBasis<-")})

#' A standard generic to get the slot PriceDecimalString
#'
#' @param object A S4 object of the type PriceTypes
#' @export
setGeneric("PriceDecimalString", function(object)
{setGeneric("PriceDecimalString")})

#' A standard generic to set the slot PriceDecimalString
#'
#' @param object A S4 object of the type PriceTypes
#' @param value The replacement value of the slot
#' @export
setGeneric("PriceDecimalString<-", function(object, value)
{setGeneric("PriceDecimalString<-")})

setMethod("initialize",
signature("PriceTypes"),
function(.Object,
PriceDecimal = numeric(),
Price32nds = "character",
PriceBasis = numeric(),
PriceDecimalString = "character",
...){
callNextMethod(.Object,
PriceDecimal = PriceDecimal,
Price32nds = Price32nds,
PriceBasis = PriceBasis,
PriceDecimalString = PriceDecimalString,
...)
})
#' A method to extract PriceDecimal from slot of class PriceTypes
#'
#' @param object an S4 object of the type PriceTypes
#' @exportMethod PriceDecimal
setMethod("PriceDecimal", signature("PriceTypes"),
function(object){object at PriceDecimal})

#' A method to set PriceDecimal in slot of class PriceTypes
#'
#' @param object an S4 object of the typre PriceTypes
#' @param value the replacement value of the slot
#' @exportMethod PriceDecimal<-
setReplaceMethod("PriceDecimal", signature("PriceTypes"),
function(object, value){
object at PriceDecimal <- value
return(object)
})

#' A method to extract Price32nds from slot of class PriceTypes
#'
#' @param object an S4 object of the type PriceTypes
#' @exportMethod Price32nds
setMethod("Price32nds", signature("PriceTypes"),
function(object){object at Price32nds})

#' A method to set Price32nds in slot of class PriceTypes
#'
#' @param object an S4 object of the type PriceTypes
#' @param value the replacement value of the slot
setReplaceMethod("Price32nds", signature("PriceTypes"),
function(object, value){
object at Price32nds <- value
return(object)
})

#' A method to extract PriceBasis from slot of class PriceTypres
#'
#' @param object an S4 object of the type PriceType
#' @exportMethod PriceBasis
setMethod("PriceBasis", signature("PriceTypes"),
function(object){object at PriceBasis})

#' a method to set PriceBasis from slot of class PriceTypes
#'
#' @param object an S4 object of the type PriceTypes
#' @param value the replacement value of the slot
#' @exportMethod PriceBasis<-
setReplaceMethod("PriceBasis", signature("PriceTypes"),
function(object, value){
object at PriceBasis <- value
return(object)
})

#' A method to extract PriceDecimalString from slot of class PriceTypes
#'
#' @param object an S4 object of type PriceTypes
#' @exportMethod PriceDecimalString
setMethod("PriceDecimalString", signature("PriceTypes"),
function(object){object at PriceDecimalString})

#' A method to set PriceDecimalString from slot of class PriceTypes
#'
#' @param object an S4 object of type PriceTypes
#' @param value the replacement value of the slot
#' @exportMethod PriceDecimalString<-
setReplaceMethod("PriceDecimalString", signature("PriceTypes"),
function(object, value){
object at PriceDecimalString <- value
return(object)})

#' PriceTypes is a constructor function for the class PriceTypes
#'
#' @param price character the price in either
#' decimal notation (example "100.125") or 32nds notation (example "100-4")
#' @export PriceTypes
PriceTypes <- function(price){
PriceBasis = 100
Units = 32

if(mode(price) != "character") stop ("price must be a character")
if(is.na(strsplit(price, "\\.|\\-")[[1]][2]) == TRUE) stop (
"tail value is missing")

Convertto32nds <- function(Price = "character"){
#convert price to numeric value
Price = as.numeric(Price)
tail32nds = round(x = (Price - floor(x = Price)) * 32, digits = 4)
Price = paste(as.character(floor(x=Price)),
"-",
as.character(tail32nds),
sep = "")
return(Price)
}

ConverttoDecimal <- function(Price = "character", Units = numeric()){
SplitPrice = strsplit(as.character(Price), "-")
handle = as.numeric(SplitPrice[[1]][1])
TailDecimal = signif(as.numeric(SplitPrice[[1]][2])/Units,8)
TailDecimal = gsub("(^|[^0-9])0+", "\\1", TailDecimal, perl = TRUE)
Price = paste(as.character(handle),
as.character(TailDecimal),sep="")
return(Price)
}

ConverttoString <- function(PriceDecimal = numeric()){
sprintf("%.8f", PriceDecimal)
}

# Convert Price when entered as a decimal value
if(grepl(".", as.character(price), fixed = TRUE) == TRUE){
Price_Decimal = format(as.numeric(price), nsmall =2)
Price_32nds = Convertto32nds(Price = price)
Price_Basis = as.numeric(price) / PriceBasis
Price_Decimal_String = ConverttoString(
PriceDecimal = as.numeric(Price_Decimal))
}

if(grepl("-", as.character(price), fixed = TRUE) == TRUE){
Price_Decimal = ConverttoDecimal(Price = price, Units = Units)
Price_32nds = price
Price_Basis = as.numeric(Price_Decimal)/PriceBasis
Price_Decimal_String = ConverttoString(
PriceDecimal = as.numeric(Price_Decimal))
}

new("PriceTypes",
PriceDecimal = as.numeric(Price_Decimal),
Price32nds = Price_32nds,
PriceBasis = as.numeric(Price_Basis),
PriceDecimalString = Price_Decimal_String
)
}
______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Wed Mar  1 22:01:16 2017
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 1 Mar 2017 22:01:16 +0100
Subject: [R-pkg-devel] tryCatch defensive programming guidance
In-Reply-To: <AM2PR04MB0802C81ECD80AF3A8D5556BCD5290@AM2PR04MB0802.eurprd04.prod.outlook.com>
References: <a7d53832-8fc0-4cbf-972b-f8e5b0bcc3a4@me.com>
	<AM2PR04MB0802C81ECD80AF3A8D5556BCD5290@AM2PR04MB0802.eurprd04.prod.outlook.com>
Message-ID: <22711.13980.76816.479044@stat.math.ethz.ch>

>>>>> Berry Boessenkool <berryboessenkool at hotmail.com>
>>>>>     on Wed, 1 Mar 2017 14:52:10 +0000 writes:

    > Hi Glenn,


    > Better late than never:
    > couldn't you simply use try?

    > result <- try( log("a") )

    > The printing is horrible: people will think an error
    > occured (but the function didn't stop!)

    > I tend to use it like this (which may be totally
    > unintended):


    > res <- try(log("a"), silent=TRUE)
    > if(inherits(res, "try-error"))
    > {
    >   message("log failed: ",res,". Now continuing with res=0.")
    >  res <- 0
    > }

but if you ever looked:  try() is just a wrapper to tryCatch()
and using try(*, silent=TRUE)  is even closer to a pretty simple tryCatch(.)

Historically,  tryCatch() did not exist, but try() did.
So much of "old code" still has try() calls in it.

I consider try() as convenience function for interactive use but
would always use tryCatch() for new code in my packages.


    > See here for my version that captures errors/warnings/messages with call tracing:

    > https://www.rdocumentation.org/packages/berryFunctions/topics/tryStack

I'd recommend you switch to tryCatch(): It is more flexible and
more directly "configurable" than try() -- which also got some historical
flexibility by the "hack" (not functional programming)
of depending on  getOption("show.error.messages")  in the
default case  silent = FALSE  {needed to suppress other
packages' using  try(.) 's printing of error messages as if
*error*s inspite of the fact that they were caught.

.... and back to the OP:

I think that's your only small problem that you chose
  error = function(e) print(e)

because that prints "as if" you had an error.

Martin


    > Regards,

    > Berry


    > ________________________________
    > From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Glenn Schultz <glennmschultz at me.com>
    > Sent: Saturday, February 25, 2017 15:50
    > To: R Package Development
    > Subject: [R-pkg-devel] tryCatch defensive programming guidance

    > All,

    > I have the following to create a class PriceTypes.  I use try catch on the function and it gives me the error

    > price <- tryCatch(PriceTypes(price = "100")
    > ,error = function(e) print(e)
    > ,warning = function(w) print(w))

    > <simpleError in PriceTypes(price = "100"): tail value is missing>
    >> 

    > I read the section on tryCatch and withCallingHandlers as well the manual but I am still not clear as to how to use tryCatch in the function below I tried
    > PriceTypes <- TryCatch(
    > function(){}
    > ), function(e) print(error)

    > but this is obviously wrong as it did not work.  My question can I use tryCatch in the function itself or only when I invoke the function.

    > Best Regards,
    > Glenn

    > #' An S4 class representating bond price
    > #'
    > #' This class is used to create and pass the price types reported to
    > #' investors and used in analytics. For example price is often reported as
    > #' decimal or fractions 32nds to investors but price basis (price/100) is
    > #' used to calculate proceeds and compute metrics like yield, duration, and
    > #' partial durations.
    > #' @slot PriceDecimal A numeric value the price using decimal notation
    > #' @slot Price32nds A character the price using 32nds notation
    > #' @slot PriceBasis A numeric value price decimal notation in units of 100
    > #' @slot PriceDecimalString A character the price using decimal notation
    > #' @exportClass PriceTypes
    > setClass("PriceTypes",
    > representation(
    > PriceDecimal = "numeric",
    > Price32nds = "character",
    > PriceBasis = "numeric",
    > PriceDecimalString = "character")
    > )

    > setGeneric("PriceTypes", function(price = numeric())
    > {standardGeneric("PriceTypes")})

    > #' A standard generic function get the slot PriceDecimal
    > #'
    > #' @param object an S4 object
    > #' @export PriceDecimal
    > setGeneric("PriceDecimal", function(object)
    > {standardGeneric("PriceDecimal")})

    > #' A standard generic function to set the slot PriceDecimal
    > #'
    > #' @param object an S4 object
    > #' @param value the replacement value of the slot
    > #' @export PriceDecimal<-
    > setGeneric("PriceDecimal<-", function(object, value)
    > {standardGeneric("PriceDecimal<-")})

    > #' A standard generic function to get the slot Price32nds
    > #'
    > #' @param object an S4 object
    > #' @export Price32nds
    > setGeneric("Price32nds", function(object)
    > {standardGeneric("Price32nds")})

    > #' A standard generic function to set the slot Price32nds
    > #'
    > #' @param object an S4 object
    > #' @param value the replacement value of the slot
    > #' @export Price32nds<-
    > setGeneric("Price32nds<-", function(object, value)
    > {setGeneric("Price32nds")})

    > #' A standard generic to get the slot PriceBasis
    > #'
    > #' @param object an S4 object
    > #' @export PriceBasis
    > setGeneric("PriceBasis", function(object)
    > {standardGeneric("PriceBasis")})

    > #' A standard generic to set the slot PriceBasis
    > #'
    > #' @param object A S4 object of type PriceTypes
    > #' @param value the replacement value of the slot
    > #' @export PriceBasis<-
    > setGeneric("PriceBasis<-", function(object, value)
    > {standardGeneric("PriceBasis<-")})

    > #' A standard generic to get the slot PriceDecimalString
    > #'
    > #' @param object A S4 object of the type PriceTypes
    > #' @export
    > setGeneric("PriceDecimalString", function(object)
    > {setGeneric("PriceDecimalString")})

    > #' A standard generic to set the slot PriceDecimalString
    > #'
    > #' @param object A S4 object of the type PriceTypes
    > #' @param value The replacement value of the slot
    > #' @export
    > setGeneric("PriceDecimalString<-", function(object, value)
    > {setGeneric("PriceDecimalString<-")})

    > setMethod("initialize",
    > signature("PriceTypes"),
    > function(.Object,
    > PriceDecimal = numeric(),
    > Price32nds = "character",
    > PriceBasis = numeric(),
    > PriceDecimalString = "character",
    > ...){
    > callNextMethod(.Object,
    > PriceDecimal = PriceDecimal,
    > Price32nds = Price32nds,
    > PriceBasis = PriceBasis,
    > PriceDecimalString = PriceDecimalString,
    > ...)
    > })
    > #' A method to extract PriceDecimal from slot of class PriceTypes
    > #'
    > #' @param object an S4 object of the type PriceTypes
    > #' @exportMethod PriceDecimal
    > setMethod("PriceDecimal", signature("PriceTypes"),
    > function(object){object at PriceDecimal})

    > #' A method to set PriceDecimal in slot of class PriceTypes
    > #'
    > #' @param object an S4 object of the typre PriceTypes
    > #' @param value the replacement value of the slot
    > #' @exportMethod PriceDecimal<-
    > setReplaceMethod("PriceDecimal", signature("PriceTypes"),
    > function(object, value){
    > object at PriceDecimal <- value
    > return(object)
    > })

    > #' A method to extract Price32nds from slot of class PriceTypes
    > #'
    > #' @param object an S4 object of the type PriceTypes
    > #' @exportMethod Price32nds
    > setMethod("Price32nds", signature("PriceTypes"),
    > function(object){object at Price32nds})

    > #' A method to set Price32nds in slot of class PriceTypes
    > #'
    > #' @param object an S4 object of the type PriceTypes
    > #' @param value the replacement value of the slot
    > setReplaceMethod("Price32nds", signature("PriceTypes"),
    > function(object, value){
    > object at Price32nds <- value
    > return(object)
    > })

    > #' A method to extract PriceBasis from slot of class PriceTypres
    > #'
    > #' @param object an S4 object of the type PriceType
    > #' @exportMethod PriceBasis
    > setMethod("PriceBasis", signature("PriceTypes"),
    > function(object){object at PriceBasis})

    > #' a method to set PriceBasis from slot of class PriceTypes
    > #'
    > #' @param object an S4 object of the type PriceTypes
    > #' @param value the replacement value of the slot
    > #' @exportMethod PriceBasis<-
    > setReplaceMethod("PriceBasis", signature("PriceTypes"),
    > function(object, value){
    > object at PriceBasis <- value
    > return(object)
    > })

    > #' A method to extract PriceDecimalString from slot of class PriceTypes
    > #'
    > #' @param object an S4 object of type PriceTypes
    > #' @exportMethod PriceDecimalString
    > setMethod("PriceDecimalString", signature("PriceTypes"),
    > function(object){object at PriceDecimalString})

    > #' A method to set PriceDecimalString from slot of class PriceTypes
    > #'
    > #' @param object an S4 object of type PriceTypes
    > #' @param value the replacement value of the slot
    > #' @exportMethod PriceDecimalString<-
    > setReplaceMethod("PriceDecimalString", signature("PriceTypes"),
    > function(object, value){
    > object at PriceDecimalString <- value
    > return(object)})

    > #' PriceTypes is a constructor function for the class PriceTypes
    > #'
    > #' @param price character the price in either
    > #' decimal notation (example "100.125") or 32nds notation (example "100-4")
    > #' @export PriceTypes
    > PriceTypes <- function(price){
    > PriceBasis = 100
    > Units = 32

    > if(mode(price) != "character") stop ("price must be a character")
    > if(is.na(strsplit(price, "\\.|\\-")[[1]][2]) == TRUE) stop (
    > "tail value is missing")

    > Convertto32nds <- function(Price = "character"){
    > #convert price to numeric value
    > Price = as.numeric(Price)
    > tail32nds = round(x = (Price - floor(x = Price)) * 32, digits = 4)
    > Price = paste(as.character(floor(x=Price)),
    > "-",
    > as.character(tail32nds),
    > sep = "")
    > return(Price)
    > }

    > ConverttoDecimal <- function(Price = "character", Units = numeric()){
    > SplitPrice = strsplit(as.character(Price), "-")
    > handle = as.numeric(SplitPrice[[1]][1])
    > TailDecimal = signif(as.numeric(SplitPrice[[1]][2])/Units,8)
    > TailDecimal = gsub("(^|[^0-9])0+", "\\1", TailDecimal, perl = TRUE)
    > Price = paste(as.character(handle),
    > as.character(TailDecimal),sep="")
    > return(Price)
    > }

    > ConverttoString <- function(PriceDecimal = numeric()){
    > sprintf("%.8f", PriceDecimal)
    > }

    > # Convert Price when entered as a decimal value
    > if(grepl(".", as.character(price), fixed = TRUE) == TRUE){
    > Price_Decimal = format(as.numeric(price), nsmall =2)
    > Price_32nds = Convertto32nds(Price = price)
    > Price_Basis = as.numeric(price) / PriceBasis
    > Price_Decimal_String = ConverttoString(
    > PriceDecimal = as.numeric(Price_Decimal))
    > }

    > if(grepl("-", as.character(price), fixed = TRUE) == TRUE){
    > Price_Decimal = ConverttoDecimal(Price = price, Units = Units)
    > Price_32nds = price
    > Price_Basis = as.numeric(Price_Decimal)/PriceBasis
    > Price_Decimal_String = ConverttoString(
    > PriceDecimal = as.numeric(Price_Decimal))
    > }

    > new("PriceTypes",
    > PriceDecimal = as.numeric(Price_Decimal),
    > Price32nds = Price_32nds,
    > PriceBasis = as.numeric(Price_Basis),
    > PriceDecimalString = Price_Decimal_String
    > )
    > }


From kent.russell at timelyportfolio.com  Thu Mar  2 14:52:42 2017
From: kent.russell at timelyportfolio.com (Kenton Russell)
Date: Thu, 2 Mar 2017 07:52:42 -0600
Subject: [R-pkg-devel] BSD_3 without organization
Message-ID: <CAASsyqFyrhb7BMNO58WSN2TXpbR3B8A8Ta5dK_+OvWASFcs69A@mail.gmail.com>

In my recent submission to update d3r
https://cran.r-project.org/web/packages/d3r/index.html, CRAN reviewer
states.

"
License components with restrictions and base license permitting such:
  BSD_3_clause + file LICENSE
File 'LICENSE':
  YEAR: 2017
  COPYRIGHT HOLDER: Kenton Russell

No ORGANIZATION field for the 3_clause?
"

I chose BSD_3 to match d3.js license.  I see many instances of R and JS
packages under BSD_3 with no ORGANIZATION.  Is there a requirement that
ORGANIZATION be populated, or is this optional?

Thanks to everyone for their help and all the work on R!

-- 
Kent

	[[alternative HTML version deleted]]


From thierry.onkelinx at inbo.be  Mon Mar  6 11:17:23 2017
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Mon, 6 Mar 2017 11:17:23 +0100
Subject: [R-pkg-devel] best way the handle errors conditionally
Message-ID: <CAJuCY5y2C0Ljj1Cz0BWbGx7GGPY2BThqpUx91_MWTyb6Gx80YA@mail.gmail.com>

Dear all,

I'd like your advice on handling errors conditionally within a function.
Imagine a function that does several database operations. The user has the
option to run them inside a transaction. So the code has somewhere near the
top:

if (transaction) {
    DBI::dbBegin(conn)
}

At the end of the function there is a command which commits the transaction.

if (transaction) {
    DBI::dbCommit(conn)
}

If something goes wrong, one reverses the database operations by issuing
the DBI::dbRollback(conn) command. The first option for issuing that is to
use tryCatch(). The drawback is that the set of command can be a few
hundred lines, which harms readability when wrapping them into a tryCatch().

 tryCatch(
   {potentially long set of commands},
    error = function(e){
      if (transaction) {
        dbRollback(conn)
      }
      stop(e)
    }
)

Another options I've found is to set options(error = function(){}) I assume
that this has a permanent effect on the current R session? So I should
reset that as a part of the error handling?

What would be recommended: tryCatch() or options(error = ...)? Or are there
more / better solutions?

Best regards,


ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Mon Mar  6 13:18:47 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 6 Mar 2017 07:18:47 -0500
Subject: [R-pkg-devel] best way the handle errors conditionally
In-Reply-To: <CAJuCY5y2C0Ljj1Cz0BWbGx7GGPY2BThqpUx91_MWTyb6Gx80YA@mail.gmail.com>
References: <CAJuCY5y2C0Ljj1Cz0BWbGx7GGPY2BThqpUx91_MWTyb6Gx80YA@mail.gmail.com>
Message-ID: <ab4a938a-3b50-ecf9-3692-aa7a5708267e@gmail.com>

On 06/03/2017 5:17 AM, Thierry Onkelinx wrote:
> Dear all,
>
> I'd like your advice on handling errors conditionally within a function.
> Imagine a function that does several database operations. The user has the
> option to run them inside a transaction. So the code has somewhere near the
> top:
>
> if (transaction) {
>     DBI::dbBegin(conn)
> }
>
> At the end of the function there is a command which commits the transaction.
>
> if (transaction) {
>     DBI::dbCommit(conn)
> }
>
> If something goes wrong, one reverses the database operations by issuing
> the DBI::dbRollback(conn) command. The first option for issuing that is to
> use tryCatch(). The drawback is that the set of command can be a few
> hundred lines, which harms readability when wrapping them into a tryCatch().

You could put the long set of commands into their own function, perhaps 
locally defined within the main function.  For example,

longset <- function() { ... }
if (transaction) {
     DBI::dbBegin(conn)
}
tryCatch(
   longset()
   error = function(e){
      if (transaction) {
        dbRollback(conn)
      }
      stop(e)
    }
)

Duncan Murdoch


From brian at braverock.com  Mon Mar  6 13:58:44 2017
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 06 Mar 2017 06:58:44 -0600
Subject: [R-pkg-devel] best way the handle errors conditionally
In-Reply-To: <CAJuCY5y2C0Ljj1Cz0BWbGx7GGPY2BThqpUx91_MWTyb6Gx80YA@mail.gmail.com>
References: <CAJuCY5y2C0Ljj1Cz0BWbGx7GGPY2BThqpUx91_MWTyb6Gx80YA@mail.gmail.com>
Message-ID: <1488805124.3468.16.camel@braverock.com>

On Mon, 2017-03-06 at 11:17 +0100, Thierry Onkelinx wrote:
> I'd like your advice on handling errors conditionally within a
> function. Imagine a function that does several database operations.
> The user has the option to run them inside a transaction. So the code
> has somewhere near the top:
> 
> if (transaction) {
> ????DBI::dbBegin(conn)
> }
> 
> At the end of the function there is a command which commits the
> transaction.
> 
> if (transaction) {
> ????DBI::dbCommit(conn)
> }
> 
> If something goes wrong, one reverses the database operations by
> issuing the DBI::dbRollback(conn) command. The first option for
> issuing that is to use tryCatch(). The drawback is that the set of
> command can be a few hundred lines, which harms readability when
> wrapping them into a tryCatch().
> 
> ?tryCatch(
> ???{potentially long set of commands},
> ????error = function(e){
> ??????if (transaction) {
> ????????dbRollback(conn)
> ??????}
> ??????stop(e)
> ????}
> )
> 
> Another options I've found is to set options(error = function(){}) I
> assume that this has a permanent effect on the current R session? So
> I should reset that as a part of the error handling?
> 
> What would be recommended: tryCatch() or options(error = ...)? Or are
> there more / better solutions?

Specifically to DBI and SQL transaction support, you should consider
using dbWithTransaction(), which is designed to do exactly what you're
asking for here, with dbBegin, dbCommit, and dbRollback.

For tryCatch in this mode, which doesn't seem to be the best pattern,
I'd probably suggest wrapping complicated series of commands in
functions, and calling those within one or more tryCatch constructs. 
You would probably want to break it up so that you could call
dbRollback earlier than the very end of a long sequence of commands.

Regards,

Brian


From georgi.boshnakov at manchester.ac.uk  Fri Mar 10 17:06:49 2017
From: georgi.boshnakov at manchester.ac.uk (Georgi Boshnakov)
Date: Fri, 10 Mar 2017 16:06:49 +0000
Subject: [R-pkg-devel] package listed in RdMacros field in file DESCRIPTION
 not installed by travis
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E018F5D9C60@MBXP02.ds.man.ac.uk>

Hi,

Background context: 

Field RdMacros was introduced in file DESCRIPTION to allow users to import LaTeX-like macros from other packages.
The idea is to put a line 

RdMacros: XXX

and then use macros from package XXX in the documentation of your package. 
Package XXX does not need to be list in Imposts/Depends/Suggests.

A user of my package Rdpack reported a problem he encountered on travis, 
see https://travis-ci.org/ISAAKiel/mortAAR/builds/209313379 and the excerps from our correspondence below.
(The warning in that report is misleading, package Rdpack is not installed by the build system.)

My guess is that that build system checks the Imposts/Depends/Suggests fields but not RdMacros
but I don't use such systems (yet) and hope to hear from others. 

A small package that can be used to test this is  available at
http://www.maths.manchester.ac.uk/~gb/testRdMacro_0.0.2.tar.gz
(and this is the source: http://www.maths.manchester.ac.uk/~gb/testRdMacro_src.tar.gz).


Thanks,
Georgi

>>>> -----Original Message-----
>>>> From: 
>>>> Sent: 09 March 2017 13:04
>>>> To: Georgi Boshnakov
>>>> Subject: Re: Rdpack
>>>>
>>>> Thank you or the fast reply!
>>>>
>>>> I tried to just add "RdMacros: Rdpack" and got the following warning:
>>>> https://travis-ci.org/ISAAKiel/mortAAR/builds/209313379
>>>>
>>>> Temporarily I fixed the travis build by adding Rdpack to the r package dependencies in the travis matrix:
>>>> https://github.com/ISAAKiel/mortAAR/commit/40b6fcfce7e93dd5eba667b5
>>>> b
>>>> 0
>>>> 8
>>>> eec71cebb6f09
>>>>
>>>> But that's not a sufficient solution for any other build environment. I guess it would be necessary to add Rdpack to the dependency lists in the DESCRIPTION file.
>>>>
>>>> Clemens
>>>>
>>>>
>>>>
>>>>
>>>> On 03/09/2017 01:33 PM, Georgi Boshnakov wrote:
>>>>> Dear Clemens,
>>>>>
>>>>> It is sufficient to add the following line to file DESCRIPTION:
>>>>>
>>>>> RdMacros: Rdpack
>>>>>
>>>>> I think that it should suffice but let me know if not. 
>>>>> Have you checked the package's vignette? 
>>>>> I am attaching it. If you have seen it, I probably should make this more clear. 
>>>>>
>>>>> Thank you for using my package. Any reports/suggestions are welcome.
>>>>>
>>>>> Kind regards,
>>>>> Georgi
>>>>>
>>>>>
>>>>> -----Original Message-----
>>>>> From: 
>>>>> Sent: 09 March 2017 12:21
>>>>> To: Georgi Boshnakov
>>>>> Subject: Rdpack
>>>>>
>>>>> Dear Mr. Boshnakov,
>>>>>
>>>>> I would like to use your R package Rdpack to automatically add citations to the roxygen2 documentation of a package (https://github.com/ISAAKiel/mortAAR). The setup with the RdMacro works fine locally, but how could I submit this to CRAN? I somehow have to add Rdpack to the dependencies of the package, I guess?
>>>>>
>>>>> Thanks,
>>>>> Clemens
>>>>>
>>>>>
>>>>>
>



From annu.mcs.du.2015 at gmail.com  Mon Mar 13 18:16:02 2017
From: annu.mcs.du.2015 at gmail.com (Annu Joshi)
Date: Mon, 13 Mar 2017 22:46:02 +0530
Subject: [R-pkg-devel] Creating a new package dependent on Igraph
Message-ID: <CACD0KfPBDGhy6Qz+=ZJN_xsjRXbPT9gcACXsyzHC-jy6kvBjxg@mail.gmail.com>

Hello all,

We have created a new package called dgraph which contains all the igraph
codebase along with our graph decomposition functions.
We have overwritten the Namespace and exported only our functions.So, the
user will not be able to access the functions of igraph through our package
dgraph.
The prototype of our functions follow this skeleton:
dgraph_our-function-name
Hence our package contain both Igraph and Dgraph code.

The package was working fine when the functions were only returning a
vector of numbers i.e. the truss value of the edges of the graph. But it
seems to be broken when we return a vector of igraph graph objects. We have
traced the problem to be in R_Igraph_To_SEXP .

But this functionality was working when imlemented in our local igraph
package.

Can you advise where we are going wrong. We can share the package if you
want to have a look.

Thanks

	[[alternative HTML version deleted]]


From davidhughjones at gmail.com  Tue Mar 14 03:46:35 2017
From: davidhughjones at gmail.com (David Hugh-Jones)
Date: Tue, 14 Mar 2017 02:46:35 +0000
Subject: [R-pkg-devel] Extending an S3 method,
	but putting the package in Suggests?
Message-ID: <CAARY7kgHC47NyfFF-YdP4giGoqYmZX74+mGzhkQkuH8g-wj5OQ@mail.gmail.com>

Hi,

Cross-posted from SO:
http://stackoverflow.com/questions/42776058/extending-an-s3-generic-from-an-optional-package

I have a package which provides an as.FlexTable method for its objects,
extending the S3 generic from the ReporteRs package. So, my NAMESPACE file,
generated by roxygen, has lines:

importFrom(ReporteRs,as.FlexTable)
...
S3method(as.FlexTable,huxtable)
...
export(as.FlexTable)

I don't much want to put ReporteRs in Imports: in the DESCRIPTION file,
because it involves a big external dependency on Java. But, when I put it
into Suggests:, R CMD check gives me errors like "Namespace dependency not
required".

Is there anyway I can extend the generic without making a hard dependency?

Cheers,
David

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Tue Mar 14 10:06:17 2017
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 14 Mar 2017 10:06:17 +0100
Subject: [R-pkg-devel] Extending an S3 method,
	but putting the package in Suggests?
In-Reply-To: <CAARY7kgHC47NyfFF-YdP4giGoqYmZX74+mGzhkQkuH8g-wj5OQ@mail.gmail.com>
References: <CAARY7kgHC47NyfFF-YdP4giGoqYmZX74+mGzhkQkuH8g-wj5OQ@mail.gmail.com>
Message-ID: <22727.45705.536123.846879@stat.math.ethz.ch>

>>>>> David Hugh-Jones <davidhughjones at gmail.com>
>>>>>     on Tue, 14 Mar 2017 02:46:35 +0000 writes:
>>>>> David Hugh-Jones <davidhughjones at gmail.com>
>>>>>     on Tue, 14 Mar 2017 02:46:35 +0000 writes:

    > Hi,
    > Cross-posted from SO:
    > http://stackoverflow.com/questions/42776058/extending-an-s3-generic-from-an-optional-package

  ((sent my answer there as well))

    > I have a package which provides an as.FlexTable method for its objects,
    > extending the S3 generic from the ReporteRs package. So, my NAMESPACE file,
    > generated by roxygen, has lines:

    > importFrom(ReporteRs,as.FlexTable)
    > ...
    > S3method(as.FlexTable,huxtable)
    > ...
    > export(as.FlexTable)

    > I don't much want to put ReporteRs in Imports: in the DESCRIPTION file,
    > because it involves a big external dependency on Java. But, when I put it
    > into Suggests:, R CMD check gives me errors like "Namespace dependency not
    > required".

    > Is there anyway I can extend the generic without making a hard dependency?

No.  Importing is a hard dependency..
Some people do not import formally but use  '<pkgNamespace>::<obj>'
instead, *and* conditionalize their code on the availability of
that namespace.
I don't recommend that at all, and particularly not for
extending a generic.

I recommend you talk with the maintainer of 'ReporteRs':
1) You could use a common (yet-to-create) very small package say 'flexS3generics'
   which provides S3 generics (and S4 if ..) you want to use
   both, and then both you and her/him import from that mini package.
   You'd be both authors of that package.

2) If your package is much smaller (in its footprint, incl
   dependencies) than 'ReporteRs' she/he may agree to import the
   S3 generic from your package instead of the other way around.

Both are clean solutions,
and both need some time-coordination when releasing to CRAN,
'1)' being easier: Once the 'flexS3generics' is released to
CRAN, change (both) your package(s) to
importFrom(flexS3generics,*) but these changes and CRAN
submissions are then independent of each other.


    > Cheers,
    > David


From davidhughjones at gmail.com  Tue Mar 14 10:13:17 2017
From: davidhughjones at gmail.com (David Hugh-Jones)
Date: Tue, 14 Mar 2017 09:13:17 +0000
Subject: [R-pkg-devel] Extending an S3 method,
	but putting the package in Suggests?
In-Reply-To: <22727.45705.536123.846879@stat.math.ethz.ch>
References: <CAARY7kgHC47NyfFF-YdP4giGoqYmZX74+mGzhkQkuH8g-wj5OQ@mail.gmail.com>
	<22727.45705.536123.846879@stat.math.ethz.ch>
Message-ID: <CAARY7kgvz7xxBJG_F0XHcopaQKyduNiCehr_gLnuH4k9-+YsbA@mail.gmail.com>

Thank you for this info and the suggestion!
David

On Tue, 14 Mar 2017 at 09:06, Martin Maechler <maechler at stat.math.ethz.ch>
wrote:

> >>>>> David Hugh-Jones <davidhughjones at gmail.com>
> >>>>>     on Tue, 14 Mar 2017 02:46:35 +0000 writes:
> >>>>> David Hugh-Jones <davidhughjones at gmail.com>
> >>>>>     on Tue, 14 Mar 2017 02:46:35 +0000 writes:
>
>     > Hi,
>     > Cross-posted from SO:
>     >
> http://stackoverflow.com/questions/42776058/extending-an-s3-generic-from-an-optional-package
>
>   ((sent my answer there as well))
>
>     > I have a package which provides an as.FlexTable method for its
> objects,
>     > extending the S3 generic from the ReporteRs package. So, my
> NAMESPACE file,
>     > generated by roxygen, has lines:
>
>     > importFrom(ReporteRs,as.FlexTable)
>     > ...
>     > S3method(as.FlexTable,huxtable)
>     > ...
>     > export(as.FlexTable)
>
>     > I don't much want to put ReporteRs in Imports: in the DESCRIPTION
> file,
>     > because it involves a big external dependency on Java. But, when I
> put it
>     > into Suggests:, R CMD check gives me errors like "Namespace
> dependency not
>     > required".
>
>     > Is there anyway I can extend the generic without making a hard
> dependency?
>
> No.  Importing is a hard dependency..
> Some people do not import formally but use  '<pkgNamespace>::<obj>'
> instead, *and* conditionalize their code on the availability of
> that namespace.
> I don't recommend that at all, and particularly not for
> extending a generic.
>
> I recommend you talk with the maintainer of 'ReporteRs':
> 1) You could use a common (yet-to-create) very small package say
> 'flexS3generics'
>    which provides S3 generics (and S4 if ..) you want to use
>    both, and then both you and her/him import from that mini package.
>    You'd be both authors of that package.
>
> 2) If your package is much smaller (in its footprint, incl
>    dependencies) than 'ReporteRs' she/he may agree to import the
>    S3 generic from your package instead of the other way around.
>
> Both are clean solutions,
> and both need some time-coordination when releasing to CRAN,
> '1)' being easier: Once the 'flexS3generics' is released to
> CRAN, change (both) your package(s) to
> importFrom(flexS3generics,*) but these changes and CRAN
> submissions are then independent of each other.
>
>
>     > Cheers,
>     > David
>
> --
Sent from Gmail Mobile

	[[alternative HTML version deleted]]


From davidhughjones at gmail.com  Tue Mar 14 10:26:49 2017
From: davidhughjones at gmail.com (David Hugh-Jones)
Date: Tue, 14 Mar 2017 09:26:49 +0000
Subject: [R-pkg-devel] Extending an S3 method,
	but putting the package in Suggests?
In-Reply-To: <22727.45705.536123.846879@stat.math.ethz.ch>
References: <CAARY7kgHC47NyfFF-YdP4giGoqYmZX74+mGzhkQkuH8g-wj5OQ@mail.gmail.com>
	<22727.45705.536123.846879@stat.math.ethz.ch>
Message-ID: <CAARY7kim7HFDu7K9NcZpEtiRGwVvRixqY6Z6O6so_T9A3_3Raw@mail.gmail.com>

 Just out of interest, what would happen if I used the hacky solution of
simply  exporting my own method like:

as.FlexTable <- function(x, ...) UseMethod("as.FlexTable")

 I am fairly sure you will tell me that fire and brimstone will rain down?
But it sure seems simple  compared to writing another package and getting
it on CRAN...

David

On Tue, 14 Mar 2017 at 09:06, Martin Maechler <maechler at stat.math.ethz.ch>
wrote:

> >>>>> David Hugh-Jones <davidhughjones at gmail.com>
> >>>>>     on Tue, 14 Mar 2017 02:46:35 +0000 writes:
> >>>>> David Hugh-Jones <davidhughjones at gmail.com>
> >>>>>     on Tue, 14 Mar 2017 02:46:35 +0000 writes:
>
>     > Hi,
>     > Cross-posted from SO:
>     >
> http://stackoverflow.com/questions/42776058/extending-an-s3-generic-from-an-optional-package
>
>   ((sent my answer there as well))
>
>     > I have a package which provides an as.FlexTable method for its
> objects,
>     > extending the S3 generic from the ReporteRs package. So, my
> NAMESPACE file,
>     > generated by roxygen, has lines:
>
>     > importFrom(ReporteRs,as.FlexTable)
>     > ...
>     > S3method(as.FlexTable,huxtable)
>     > ...
>     > export(as.FlexTable)
>
>     > I don't much want to put ReporteRs in Imports: in the DESCRIPTION
> file,
>     > because it involves a big external dependency on Java. But, when I
> put it
>     > into Suggests:, R CMD check gives me errors like "Namespace
> dependency not
>     > required".
>
>     > Is there anyway I can extend the generic without making a hard
> dependency?
>
> No.  Importing is a hard dependency..
> Some people do not import formally but use  '<pkgNamespace>::<obj>'
> instead, *and* conditionalize their code on the availability of
> that namespace.
> I don't recommend that at all, and particularly not for
> extending a generic.
>
> I recommend you talk with the maintainer of 'ReporteRs':
> 1) You could use a common (yet-to-create) very small package say
> 'flexS3generics'
>    which provides S3 generics (and S4 if ..) you want to use
>    both, and then both you and her/him import from that mini package.
>    You'd be both authors of that package.
>
> 2) If your package is much smaller (in its footprint, incl
>    dependencies) than 'ReporteRs' she/he may agree to import the
>    S3 generic from your package instead of the other way around.
>
> Both are clean solutions,
> and both need some time-coordination when releasing to CRAN,
> '1)' being easier: Once the 'flexS3generics' is released to
> CRAN, change (both) your package(s) to
> importFrom(flexS3generics,*) but these changes and CRAN
> submissions are then independent of each other.
>
>
>     > Cheers,
>     > David
>
> --
Sent from Gmail Mobile

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Tue Mar 14 17:35:19 2017
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 14 Mar 2017 17:35:19 +0100
Subject: [R-pkg-devel] Extending an S3 method,
	but putting the package in Suggests?
In-Reply-To: <CAARY7kim7HFDu7K9NcZpEtiRGwVvRixqY6Z6O6so_T9A3_3Raw@mail.gmail.com>
References: <CAARY7kgHC47NyfFF-YdP4giGoqYmZX74+mGzhkQkuH8g-wj5OQ@mail.gmail.com>
	<22727.45705.536123.846879@stat.math.ethz.ch>
	<CAARY7kim7HFDu7K9NcZpEtiRGwVvRixqY6Z6O6so_T9A3_3Raw@mail.gmail.com>
Message-ID: <22728.7111.388415.473336@stat.math.ethz.ch>

>>>>> David Hugh-Jones <davidhughjones at gmail.com>
>>>>>     on Tue, 14 Mar 2017 09:26:49 +0000 writes:

    > Just out of interest, what would happen if I used the hacky solution of
    > simply  exporting my own method like:

    > as.FlexTable <- function(x, ...) UseMethod("as.FlexTable")

    > I am fairly sure you will tell me that fire and brimstone will rain down?
    > But it sure seems simple  compared to writing another package and getting
    > it on CRAN...

no fire etc, but pretty close ;-)

You will have two (internal) methods tables for as.FlexTable,
one in ReporteRs, one in your package, and from a user point of
view there's a deep abyss in functionality between working with

  require(ReporteRs); require(huxtable)

and working with

  require(huxtable); require(ReporteRs)

This is undesirable and error prone and can be resolved by
correct imports as those mentioned.

Martin

    > David

    > On Tue, 14 Mar 2017 at 09:06, Martin Maechler <maechler at stat.math.ethz.ch>
    > wrote:

    >> >>>>> David Hugh-Jones <davidhughjones at gmail.com>
    >> >>>>>     on Tue, 14 Mar 2017 02:46:35 +0000 writes:
    >> >>>>> David Hugh-Jones <davidhughjones at gmail.com>
    >> >>>>>     on Tue, 14 Mar 2017 02:46:35 +0000 writes:
    >> 
    >> > Hi,
    >> > Cross-posted from SO:
    >> >
    >> http://stackoverflow.com/questions/42776058/extending-an-s3-generic-from-an-optional-package
    >> 
    >> ((sent my answer there as well))
    >> 
    >> > I have a package which provides an as.FlexTable method for its
    >> objects,
    >> > extending the S3 generic from the ReporteRs package. So, my
    >> NAMESPACE file,
    >> > generated by roxygen, has lines:
    >> 
    >> > importFrom(ReporteRs,as.FlexTable)
    >> > ...
    >> > S3method(as.FlexTable,huxtable)
    >> > ...
    >> > export(as.FlexTable)
    >> 
    >> > I don't much want to put ReporteRs in Imports: in the DESCRIPTION
    >> file,
    >> > because it involves a big external dependency on Java. But, when I
    >> put it
    >> > into Suggests:, R CMD check gives me errors like "Namespace
    >> dependency not
    >> > required".
    >> 
    >> > Is there anyway I can extend the generic without making a hard
    >> dependency?
    >> 
    >> No.  Importing is a hard dependency..
    >> Some people do not import formally but use  '<pkgNamespace>::<obj>'
    >> instead, *and* conditionalize their code on the availability of
    >> that namespace.
    >> I don't recommend that at all, and particularly not for
    >> extending a generic.
    >> 
    >> I recommend you talk with the maintainer of 'ReporteRs':
    >> 1) You could use a common (yet-to-create) very small package say
    >> 'flexS3generics'
    >> which provides S3 generics (and S4 if ..) you want to use
    >> both, and then both you and her/him import from that mini package.
    >> You'd be both authors of that package.
    >> 
    >> 2) If your package is much smaller (in its footprint, incl
    >> dependencies) than 'ReporteRs' she/he may agree to import the
    >> S3 generic from your package instead of the other way around.
    >> 
    >> Both are clean solutions,
    >> and both need some time-coordination when releasing to CRAN,
    >> '1)' being easier: Once the 'flexS3generics' is released to
    >> CRAN, change (both) your package(s) to
    >> importFrom(flexS3generics,*) but these changes and CRAN
    >> submissions are then independent of each other.
    >> 
    >> 
    >> > Cheers,
    >> > David
    >> 
    >> --
    > Sent from Gmail Mobile

    > [[alternative HTML version deleted]]


From davidhughjones at gmail.com  Tue Mar 14 18:30:12 2017
From: davidhughjones at gmail.com (David Hugh-Jones)
Date: Tue, 14 Mar 2017 17:30:12 +0000
Subject: [R-pkg-devel] Extending an S3 method,
	but putting the package in Suggests?
In-Reply-To: <22728.7111.388415.473336@stat.math.ethz.ch>
References: <CAARY7kgHC47NyfFF-YdP4giGoqYmZX74+mGzhkQkuH8g-wj5OQ@mail.gmail.com>
	<22727.45705.536123.846879@stat.math.ethz.ch>
	<CAARY7kim7HFDu7K9NcZpEtiRGwVvRixqY6Z6O6so_T9A3_3Raw@mail.gmail.com>
	<22728.7111.388415.473336@stat.math.ethz.ch>
Message-ID: <CAARY7kj=fC+_V0VGVWTjxVNMs_hhtoaa+gRHiT2j97vurYC9-A@mail.gmail.com>

Hi Martin,

Thanks. I figured that out after trying it myself, so I didn't do that.
OTOH, a whole new package just so I can extend a method... I feel that life
is too short. So, I cut the Gordian knot and just wrote as_FlexTable
instead of as.FlexTable, and skipped the whole inheritance issue.

Cheers,

David


On 14 March 2017 at 16:35, Martin Maechler <maechler at stat.math.ethz.ch>
wrote:

> >>>>> David Hugh-Jones <davidhughjones at gmail.com>
> >>>>>     on Tue, 14 Mar 2017 09:26:49 +0000 writes:
>
>     > Just out of interest, what would happen if I used the hacky solution
> of
>     > simply  exporting my own method like:
>
>     > as.FlexTable <- function(x, ...) UseMethod("as.FlexTable")
>
>     > I am fairly sure you will tell me that fire and brimstone will rain
> down?
>     > But it sure seems simple  compared to writing another package and
> getting
>     > it on CRAN...
>
> no fire etc, but pretty close ;-)
>
> You will have two (internal) methods tables for as.FlexTable,
> one in ReporteRs, one in your package, and from a user point of
> view there's a deep abyss in functionality between working with
>
>   require(ReporteRs); require(huxtable)
>
> and working with
>
>   require(huxtable); require(ReporteRs)
>
> This is undesirable and error prone and can be resolved by
> correct imports as those mentioned.
>
> Martin
>
>     > David
>
>     > On Tue, 14 Mar 2017 at 09:06, Martin Maechler <
> maechler at stat.math.ethz.ch>
>     > wrote:
>
>     >> >>>>> David Hugh-Jones <davidhughjones at gmail.com>
>     >> >>>>>     on Tue, 14 Mar 2017 02:46:35 +0000 writes:
>     >> >>>>> David Hugh-Jones <davidhughjones at gmail.com>
>     >> >>>>>     on Tue, 14 Mar 2017 02:46:35 +0000 writes:
>     >>
>     >> > Hi,
>     >> > Cross-posted from SO:
>     >> >
>     >> http://stackoverflow.com/questions/42776058/extending-
> an-s3-generic-from-an-optional-package
>     >>
>     >> ((sent my answer there as well))
>     >>
>     >> > I have a package which provides an as.FlexTable method for its
>     >> objects,
>     >> > extending the S3 generic from the ReporteRs package. So, my
>     >> NAMESPACE file,
>     >> > generated by roxygen, has lines:
>     >>
>     >> > importFrom(ReporteRs,as.FlexTable)
>     >> > ...
>     >> > S3method(as.FlexTable,huxtable)
>     >> > ...
>     >> > export(as.FlexTable)
>     >>
>     >> > I don't much want to put ReporteRs in Imports: in the DESCRIPTION
>     >> file,
>     >> > because it involves a big external dependency on Java. But, when I
>     >> put it
>     >> > into Suggests:, R CMD check gives me errors like "Namespace
>     >> dependency not
>     >> > required".
>     >>
>     >> > Is there anyway I can extend the generic without making a hard
>     >> dependency?
>     >>
>     >> No.  Importing is a hard dependency..
>     >> Some people do not import formally but use  '<pkgNamespace>::<obj>'
>     >> instead, *and* conditionalize their code on the availability of
>     >> that namespace.
>     >> I don't recommend that at all, and particularly not for
>     >> extending a generic.
>     >>
>     >> I recommend you talk with the maintainer of 'ReporteRs':
>     >> 1) You could use a common (yet-to-create) very small package say
>     >> 'flexS3generics'
>     >> which provides S3 generics (and S4 if ..) you want to use
>     >> both, and then both you and her/him import from that mini package.
>     >> You'd be both authors of that package.
>     >>
>     >> 2) If your package is much smaller (in its footprint, incl
>     >> dependencies) than 'ReporteRs' she/he may agree to import the
>     >> S3 generic from your package instead of the other way around.
>     >>
>     >> Both are clean solutions,
>     >> and both need some time-coordination when releasing to CRAN,
>     >> '1)' being easier: Once the 'flexS3generics' is released to
>     >> CRAN, change (both) your package(s) to
>     >> importFrom(flexS3generics,*) but these changes and CRAN
>     >> submissions are then independent of each other.
>     >>
>     >>
>     >> > Cheers,
>     >> > David
>     >>
>     >> --
>     > Sent from Gmail Mobile
>
>     > [[alternative HTML version deleted]]
>
>

	[[alternative HTML version deleted]]


From cdetermanjr at gmail.com  Wed Mar 15 14:54:00 2017
From: cdetermanjr at gmail.com (Charles Determan)
Date: Wed, 15 Mar 2017 08:54:00 -0500
Subject: [R-pkg-devel] Makevars.win cppflags
Message-ID: <CAKxd1KMddWaqvc14OaspYivFF0JV3CpCw10T4jXz3B5a7gtyLw@mail.gmail.com>

I am working on an R package that contains some CUDA code.  As such, it
needs to use the 'nvcc' compiler.  I then need to use some of the R header
files such as R.h.  On a linux machine, I can handle this with my configure
script using autotools that will replace @R_INCL@ with AC_SUBST(R_INCL).
However, AFAIK, I cannot do this on a Windows machine.  I am trying to
write the Makevars.win file to create the appropriate variables that I can
pass to the nvcc compiler.  Here is an excerpt:

R_INCL=`$(shell ${R_HOME}/bin/R CMD config --cppflags)`

CU_INCL = -I../inst/include $(R_INCL)

%.o: %.cu $(cu_sources)
$(NVCC) $(CU_ARCH) $(CU_ARGS) $(CU_INCL) $< -c


However, I keep getting a truncated output from the --cppflags output.  If
I run from the commandline R CMD config --cppflags I get:

-IC:/Users/cdeterman/Documents/R/R-3.3.2/include
-IC:/Users/cdeterman/Documents/R/R-3.3.2/include/x64

but when run in the build/install I get

-IC:/Users/CDETER~1/DOCUME~1/R/R-33~1.2/include
-IC:/Users/CDETER~1/DOCUME~1/R/R-33~1.2/include/x64

and the compliation fails saying that the
-IC:/Users/CDETER~1/DOCUME~1/R/R-33~1.2/include is not found whereas the
full path is found.

Any assistance is appreciated.

Regards,
Charles

	[[alternative HTML version deleted]]


From edd at debian.org  Wed Mar 15 15:18:33 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 15 Mar 2017 09:18:33 -0500
Subject: [R-pkg-devel] Makevars.win cppflags
In-Reply-To: <CAKxd1KMddWaqvc14OaspYivFF0JV3CpCw10T4jXz3B5a7gtyLw@mail.gmail.com>
References: <CAKxd1KMddWaqvc14OaspYivFF0JV3CpCw10T4jXz3B5a7gtyLw@mail.gmail.com>
Message-ID: <22729.19769.31878.249649@max.eddelbuettel.com>


On 15 March 2017 at 08:54, Charles Determan wrote:
| I am working on an R package that contains some CUDA code.  As such, it
| needs to use the 'nvcc' compiler.  I then need to use some of the R header
| files such as R.h.  On a linux machine, I can handle this with my configure
| script using autotools that will replace @R_INCL@ with AC_SUBST(R_INCL).
| However, AFAIK, I cannot do this on a Windows machine.  I am trying to

You can use configure.win ... which may be a R script. See eg

    https://github.com/x13org/x13binary/blob/master/configure.win

where we simply copy exterior resources in. (Long story having to do with the
US Census bureau shipping a binary of something someone would these years or
decades construct as a library but I digress...)

In essence you have another layer of control and code _before_ you get
src/Makevars.win. 

| write the Makevars.win file to create the appropriate variables that I can
| pass to the nvcc compiler.  Here is an excerpt:
| 
| R_INCL=`$(shell ${R_HOME}/bin/R CMD config --cppflags)`
| 
| CU_INCL = -I../inst/include $(R_INCL)
| 
| %.o: %.cu $(cu_sources)
| $(NVCC) $(CU_ARCH) $(CU_ARGS) $(CU_INCL) $< -c
| 
| 
| However, I keep getting a truncated output from the --cppflags output.  If
| I run from the commandline R CMD config --cppflags I get:
| 
| -IC:/Users/cdeterman/Documents/R/R-3.3.2/include
| -IC:/Users/cdeterman/Documents/R/R-3.3.2/include/x64
| 
| but when run in the build/install I get
| 
| -IC:/Users/CDETER~1/DOCUME~1/R/R-33~1.2/include
| -IC:/Users/CDETER~1/DOCUME~1/R/R-33~1.2/include/x64
| 
| and the compliation fails saying that the
| -IC:/Users/CDETER~1/DOCUME~1/R/R-33~1.2/include is not found whereas the
| full path is found.
| 
| Any assistance is appreciated.

I am no expert on the various braindeadednesses of that platform but these
two paths should be equivalent. If they are not something else may go on, but
you can also try to invoke a tool to 'expand' the shortened path.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From avraham.adler at gmail.com  Wed Mar 15 15:40:00 2017
From: avraham.adler at gmail.com (Avraham Adler)
Date: Wed, 15 Mar 2017 10:40:00 -0400
Subject: [R-pkg-devel] Solaris SPARC, Fortran, and logical errors?
Message-ID: <CAL6gwnLk3tNDgbfSv9hOa8snOj+VXV1g3FjkSAzLKosq_cm2Rg@mail.gmail.com>

Hello.

The Delaporte package works properly on all R-core platforms except
Solaris SPARC, where it  compiles properly but fails a number of its
tests [1]. Not having access to a SPARC testbed, I'm limited in what
kind of diagnostics I can do. One thing I have noticed is that a lot
of the failures occur when I am passing non-default logicals (like
lower tail or log). For example, the first failure at that link is
when "log = true" is supposed to be passed, but the SPARC answers are
the unlogged values. Of the 22 failed tests, 12 of them pass logicals.

I'll bring an example of how it is coded below, and if anyone
recognizes where SPARC specifically goes wrong, I'd appreciate. I
guess, if I absolutely had to, I could convert the logical to an
integer in C and pass the integer to Fortran which should work even
for SPARC, but I'd prefer not to if I could help it.

Thank you,

Avi

[1] https://cran.r-project.org/web/checks/check_results_Delaporte.html

*****Example Code*****

R code:

ddelap <- function(x, alpha, beta, lambda, log = FALSE){
  if(!is.double(x)) {storage.mode(x) <- 'double'}
  if(!is.double(alpha)) {storage.mode(alpha) <- 'double'}
  if(!is.double(beta)) {storage.mode(beta) <- 'double'}
  if(!is.double(lambda)) {storage.mode(lambda) <- 'double'}
  if(any(x > floor(x))) {
    warning("Non-integers passed to ddelap. These will have 0 probability.")
  }
  .Call(ddelap_C, x, alpha, beta, lambda, log)
}

C code:

void ddelap_f(double *x, int nx, double *a, int na, double *b, int nb,
double *l, int nl,
              int *lg, double *ret);

extern SEXP ddelap_C(SEXP x, SEXP alpha, SEXP beta, SEXP lambda, SEXP lg){
  const int nx = LENGTH(x);
  const int na = LENGTH(alpha);
  const int nb = LENGTH(beta);
  const int nl = LENGTH(lambda);
  SEXP ret;
  PROTECT(ret = allocVector(REALSXP, nx));
  ddelap_f(REAL(x), nx, REAL(alpha), na, REAL(beta), nb, REAL(lambda),
nl, LOGICAL(lg), REAL(ret));
  UNPROTECT(1);
  return(ret);
}

Fortran: (not posting ddelap_f_s as that doesn't handle the logging)

    subroutine ddelap_f(x, nx, a, na, b, nb, l, nl, lg, pmfv) bind(C,
name="ddelap_f")

    integer(kind = c_int), intent(in), value         :: nx, na, nb, nl
    ! Sizes
    real(kind = c_double), intent(in), dimension(nx) :: x
    ! Observations
    real(kind = c_double), intent(out), dimension(nx):: pmfv
    ! Result
    real(kind = c_double), intent(in)                :: a(na), b(nb),
l(nl)! Parameters
    logical(kind = c_bool), intent(in)               :: lg
    ! Log flag
    integer                                          :: i
    ! Integer

        !$omp parallel do default(shared) private(i)
        do i = 1, nx
            if (x(i) > floor(x(i))) then
                pmfv(i) = ZERO
            else
                pmfv(i) = ddelap_f_s(x(i), a(mod(i - 1, na) + 1), &
                                     b(mod(i - 1, nb) + 1), l(mod(i -
1, nl) + 1))
            end if
        end do
        !$omp end parallel do

        if (lg) then
            pmfv = log(pmfv)
        end if

    end subroutine ddelap_f


From profjcnash at gmail.com  Wed Mar 15 16:09:19 2017
From: profjcnash at gmail.com (J C Nash)
Date: Wed, 15 Mar 2017 11:09:19 -0400
Subject: [R-pkg-devel] Solaris SPARC, Fortran, and logical errors?
In-Reply-To: <CAL6gwnLk3tNDgbfSv9hOa8snOj+VXV1g3FjkSAzLKosq_cm2Rg@mail.gmail.com>
References: <CAL6gwnLk3tNDgbfSv9hOa8snOj+VXV1g3FjkSAzLKosq_cm2Rg@mail.gmail.com>
Message-ID: <ba08662e-6811-f78f-d9ab-8b680ad961e8@gmail.com>

Possibly tangential, but has there been any effort to set up a Sparc testbed? It
seems we could use a network-available (virtual?) machine, since this platform is
often the unfortunate one. Unless, of course, there's a sunset date.

For information, I mentioned SPARC at our local linux group, and apparently there
are a couple of folk who have them running, but I didn't find out the state of the
OS etc.

JN


On 2017-03-15 10:40 AM, Avraham Adler wrote:
> Hello.
>
> The Delaporte package works properly on all R-core platforms except
> Solaris SPARC, where it  compiles properly but fails a number of its
> tests [1]. Not having access to a SPARC testbed, I'm limited in what
> kind of diagnostics I can do. One thing I have noticed is that a lot
> of the failures occur when I am passing non-default logicals (like
> lower tail or log). For example, the first failure at that link is
> when "log = true" is supposed to be passed, but the SPARC answers are
> the unlogged values. Of the 22 failed tests, 12 of them pass logicals.
>
> I'll bring an example of how it is coded below, and if anyone
> recognizes where SPARC specifically goes wrong, I'd appreciate. I
> guess, if I absolutely had to, I could convert the logical to an
> integer in C and pass the integer to Fortran which should work even
> for SPARC, but I'd prefer not to if I could help it.
>
> Thank you,
>
> Avi
>
> [1] https://cran.r-project.org/web/checks/check_results_Delaporte.html
>
> *****Example Code*****
>
> R code:
>
> ddelap <- function(x, alpha, beta, lambda, log = FALSE){
>   if(!is.double(x)) {storage.mode(x) <- 'double'}
>   if(!is.double(alpha)) {storage.mode(alpha) <- 'double'}
>   if(!is.double(beta)) {storage.mode(beta) <- 'double'}
>   if(!is.double(lambda)) {storage.mode(lambda) <- 'double'}
>   if(any(x > floor(x))) {
>     warning("Non-integers passed to ddelap. These will have 0 probability.")
>   }
>   .Call(ddelap_C, x, alpha, beta, lambda, log)
> }
>
> C code:
>
> void ddelap_f(double *x, int nx, double *a, int na, double *b, int nb,
> double *l, int nl,
>               int *lg, double *ret);
>
> extern SEXP ddelap_C(SEXP x, SEXP alpha, SEXP beta, SEXP lambda, SEXP lg){
>   const int nx = LENGTH(x);
>   const int na = LENGTH(alpha);
>   const int nb = LENGTH(beta);
>   const int nl = LENGTH(lambda);
>   SEXP ret;
>   PROTECT(ret = allocVector(REALSXP, nx));
>   ddelap_f(REAL(x), nx, REAL(alpha), na, REAL(beta), nb, REAL(lambda),
> nl, LOGICAL(lg), REAL(ret));
>   UNPROTECT(1);
>   return(ret);
> }
>
> Fortran: (not posting ddelap_f_s as that doesn't handle the logging)
>
>     subroutine ddelap_f(x, nx, a, na, b, nb, l, nl, lg, pmfv) bind(C,
> name="ddelap_f")
>
>     integer(kind = c_int), intent(in), value         :: nx, na, nb, nl
>     ! Sizes
>     real(kind = c_double), intent(in), dimension(nx) :: x
>     ! Observations
>     real(kind = c_double), intent(out), dimension(nx):: pmfv
>     ! Result
>     real(kind = c_double), intent(in)                :: a(na), b(nb),
> l(nl)! Parameters
>     logical(kind = c_bool), intent(in)               :: lg
>     ! Log flag
>     integer                                          :: i
>     ! Integer
>
>         !$omp parallel do default(shared) private(i)
>         do i = 1, nx
>             if (x(i) > floor(x(i))) then
>                 pmfv(i) = ZERO
>             else
>                 pmfv(i) = ddelap_f_s(x(i), a(mod(i - 1, na) + 1), &
>                                      b(mod(i - 1, nb) + 1), l(mod(i -
> 1, nl) + 1))
>             end if
>         end do
>         !$omp end parallel do
>
>         if (lg) then
>             pmfv = log(pmfv)
>         end if
>
>     end subroutine ddelap_f
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From wdunlap at tibco.com  Wed Mar 15 17:19:59 2017
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 15 Mar 2017 09:19:59 -0700
Subject: [R-pkg-devel] Solaris SPARC, Fortran, and logical errors?
In-Reply-To: <CAL6gwnLk3tNDgbfSv9hOa8snOj+VXV1g3FjkSAzLKosq_cm2Rg@mail.gmail.com>
References: <CAL6gwnLk3tNDgbfSv9hOa8snOj+VXV1g3FjkSAzLKosq_cm2Rg@mail.gmail.com>
Message-ID: <CAF8bMcZGJ6BOhcz3crzX1BEuoePyQvNe7An0oNBhV5Wcgontxw@mail.gmail.com>

I don't know about the current Sparc Fortran compilers, but over the
years have learned not to try to pass logicals and character strings
between C and Fortran.  I have seen Fortran compilers that treated
integer -1 (all bits 1) as .true. and anything else as .false. and I
have see ones that looked only at bit 7, counting from the right, to
determine the value.

I recommend changing your Fortran code to accept an integer instead of
a logical for boolean inputs and outputs.

Bill Dunlap
TIBCO Software
wdunlap tibco.com


On Wed, Mar 15, 2017 at 7:40 AM, Avraham Adler <avraham.adler at gmail.com> wrote:
> Hello.
>
> The Delaporte package works properly on all R-core platforms except
> Solaris SPARC, where it  compiles properly but fails a number of its
> tests [1]. Not having access to a SPARC testbed, I'm limited in what
> kind of diagnostics I can do. One thing I have noticed is that a lot
> of the failures occur when I am passing non-default logicals (like
> lower tail or log). For example, the first failure at that link is
> when "log = true" is supposed to be passed, but the SPARC answers are
> the unlogged values. Of the 22 failed tests, 12 of them pass logicals.
>
> I'll bring an example of how it is coded below, and if anyone
> recognizes where SPARC specifically goes wrong, I'd appreciate. I
> guess, if I absolutely had to, I could convert the logical to an
> integer in C and pass the integer to Fortran which should work even
> for SPARC, but I'd prefer not to if I could help it.
>
> Thank you,
>
> Avi
>
> [1] https://cran.r-project.org/web/checks/check_results_Delaporte.html
>
> *****Example Code*****
>
> R code:
>
> ddelap <- function(x, alpha, beta, lambda, log = FALSE){
>   if(!is.double(x)) {storage.mode(x) <- 'double'}
>   if(!is.double(alpha)) {storage.mode(alpha) <- 'double'}
>   if(!is.double(beta)) {storage.mode(beta) <- 'double'}
>   if(!is.double(lambda)) {storage.mode(lambda) <- 'double'}
>   if(any(x > floor(x))) {
>     warning("Non-integers passed to ddelap. These will have 0 probability.")
>   }
>   .Call(ddelap_C, x, alpha, beta, lambda, log)
> }
>
> C code:
>
> void ddelap_f(double *x, int nx, double *a, int na, double *b, int nb,
> double *l, int nl,
>               int *lg, double *ret);
>
> extern SEXP ddelap_C(SEXP x, SEXP alpha, SEXP beta, SEXP lambda, SEXP lg){
>   const int nx = LENGTH(x);
>   const int na = LENGTH(alpha);
>   const int nb = LENGTH(beta);
>   const int nl = LENGTH(lambda);
>   SEXP ret;
>   PROTECT(ret = allocVector(REALSXP, nx));
>   ddelap_f(REAL(x), nx, REAL(alpha), na, REAL(beta), nb, REAL(lambda),
> nl, LOGICAL(lg), REAL(ret));
>   UNPROTECT(1);
>   return(ret);
> }
>
> Fortran: (not posting ddelap_f_s as that doesn't handle the logging)
>
>     subroutine ddelap_f(x, nx, a, na, b, nb, l, nl, lg, pmfv) bind(C,
> name="ddelap_f")
>
>     integer(kind = c_int), intent(in), value         :: nx, na, nb, nl
>     ! Sizes
>     real(kind = c_double), intent(in), dimension(nx) :: x
>     ! Observations
>     real(kind = c_double), intent(out), dimension(nx):: pmfv
>     ! Result
>     real(kind = c_double), intent(in)                :: a(na), b(nb),
> l(nl)! Parameters
>     logical(kind = c_bool), intent(in)               :: lg
>     ! Log flag
>     integer                                          :: i
>     ! Integer
>
>         !$omp parallel do default(shared) private(i)
>         do i = 1, nx
>             if (x(i) > floor(x(i))) then
>                 pmfv(i) = ZERO
>             else
>                 pmfv(i) = ddelap_f_s(x(i), a(mod(i - 1, na) + 1), &
>                                      b(mod(i - 1, nb) + 1), l(mod(i -
> 1, nl) + 1))
>             end if
>         end do
>         !$omp end parallel do
>
>         if (lg) then
>             pmfv = log(pmfv)
>         end if
>
>     end subroutine ddelap_f
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From bbolker at gmail.com  Wed Mar 15 18:30:52 2017
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 15 Mar 2017 13:30:52 -0400
Subject: [R-pkg-devel] Solaris SPARC, Fortran, and logical errors?
In-Reply-To: <ba08662e-6811-f78f-d9ab-8b680ad961e8@gmail.com>
References: <CAL6gwnLk3tNDgbfSv9hOa8snOj+VXV1g3FjkSAzLKosq_cm2Rg@mail.gmail.com>
	<ba08662e-6811-f78f-d9ab-8b680ad961e8@gmail.com>
Message-ID: <f14a0d71-233a-0b70-4117-2469192bbed0@gmail.com>



On 17-03-15 11:09 AM, J C Nash wrote:
> Possibly tangential, but has there been any effort to set up a Sparc
> testbed? It
> seems we could use a network-available (virtual?) machine, since this
> platform is
> often the unfortunate one. Unless, of course, there's a sunset date.
> 
> For information, I mentioned SPARC at our local linux group, and
> apparently there
> are a couple of folk who have them running, but I didn't find out the
> state of the
> OS etc.
> 
> JN

  The virtual machine platforms I know of (admittedly not a complete
list!) only support Solaris on x86, e.g.

https://community.oracle.com/thread/2569292



> 
> 
> On 2017-03-15 10:40 AM, Avraham Adler wrote:
>> Hello.
>>
>> The Delaporte package works properly on all R-core platforms except
>> Solaris SPARC, where it  compiles properly but fails a number of its
>> tests [1]. Not having access to a SPARC testbed, I'm limited in what
>> kind of diagnostics I can do. One thing I have noticed is that a lot
>> of the failures occur when I am passing non-default logicals (like
>> lower tail or log). For example, the first failure at that link is
>> when "log = true" is supposed to be passed, but the SPARC answers are
>> the unlogged values. Of the 22 failed tests, 12 of them pass logicals.
>>
>> I'll bring an example of how it is coded below, and if anyone
>> recognizes where SPARC specifically goes wrong, I'd appreciate. I
>> guess, if I absolutely had to, I could convert the logical to an
>> integer in C and pass the integer to Fortran which should work even
>> for SPARC, but I'd prefer not to if I could help it.
>>
>> Thank you,
>>
>> Avi
>>
>> [1] https://cran.r-project.org/web/checks/check_results_Delaporte.html
>>
>> *****Example Code*****
>>
>> R code:
>>
>> ddelap <- function(x, alpha, beta, lambda, log = FALSE){
>>   if(!is.double(x)) {storage.mode(x) <- 'double'}
>>   if(!is.double(alpha)) {storage.mode(alpha) <- 'double'}
>>   if(!is.double(beta)) {storage.mode(beta) <- 'double'}
>>   if(!is.double(lambda)) {storage.mode(lambda) <- 'double'}
>>   if(any(x > floor(x))) {
>>     warning("Non-integers passed to ddelap. These will have 0
>> probability.")
>>   }
>>   .Call(ddelap_C, x, alpha, beta, lambda, log)
>> }
>>
>> C code:
>>
>> void ddelap_f(double *x, int nx, double *a, int na, double *b, int nb,
>> double *l, int nl,
>>               int *lg, double *ret);
>>
>> extern SEXP ddelap_C(SEXP x, SEXP alpha, SEXP beta, SEXP lambda, SEXP
>> lg){
>>   const int nx = LENGTH(x);
>>   const int na = LENGTH(alpha);
>>   const int nb = LENGTH(beta);
>>   const int nl = LENGTH(lambda);
>>   SEXP ret;
>>   PROTECT(ret = allocVector(REALSXP, nx));
>>   ddelap_f(REAL(x), nx, REAL(alpha), na, REAL(beta), nb, REAL(lambda),
>> nl, LOGICAL(lg), REAL(ret));
>>   UNPROTECT(1);
>>   return(ret);
>> }
>>
>> Fortran: (not posting ddelap_f_s as that doesn't handle the logging)
>>
>>     subroutine ddelap_f(x, nx, a, na, b, nb, l, nl, lg, pmfv) bind(C,
>> name="ddelap_f")
>>
>>     integer(kind = c_int), intent(in), value         :: nx, na, nb, nl
>>     ! Sizes
>>     real(kind = c_double), intent(in), dimension(nx) :: x
>>     ! Observations
>>     real(kind = c_double), intent(out), dimension(nx):: pmfv
>>     ! Result
>>     real(kind = c_double), intent(in)                :: a(na), b(nb),
>> l(nl)! Parameters
>>     logical(kind = c_bool), intent(in)               :: lg
>>     ! Log flag
>>     integer                                          :: i
>>     ! Integer
>>
>>         !$omp parallel do default(shared) private(i)
>>         do i = 1, nx
>>             if (x(i) > floor(x(i))) then
>>                 pmfv(i) = ZERO
>>             else
>>                 pmfv(i) = ddelap_f_s(x(i), a(mod(i - 1, na) + 1), &
>>                                      b(mod(i - 1, nb) + 1), l(mod(i -
>> 1, nl) + 1))
>>             end if
>>         end do
>>         !$omp end parallel do
>>
>>         if (lg) then
>>             pmfv = log(pmfv)
>>         end if
>>
>>     end subroutine ddelap_f
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From avraham.adler at gmail.com  Wed Mar 15 19:31:21 2017
From: avraham.adler at gmail.com (Avraham Adler)
Date: Wed, 15 Mar 2017 14:31:21 -0400
Subject: [R-pkg-devel] Solaris SPARC, Fortran, and logical errors?
In-Reply-To: <CAF8bMcZGJ6BOhcz3crzX1BEuoePyQvNe7An0oNBhV5Wcgontxw@mail.gmail.com>
References: <CAL6gwnLk3tNDgbfSv9hOa8snOj+VXV1g3FjkSAzLKosq_cm2Rg@mail.gmail.com>
	<CAF8bMcZGJ6BOhcz3crzX1BEuoePyQvNe7An0oNBhV5Wcgontxw@mail.gmail.com>
Message-ID: <CAL6gwnJKLjgjRDZ7J2psYbGhr+4pvW+Xo_upv8u+f2KiJfvV1Q@mail.gmail.com>

On Wed, Mar 15, 2017 at 12:19 PM, William Dunlap <wdunlap at tibco.com> wrote:
> I don't know about the current Sparc Fortran compilers, but over the
> years have learned not to try to pass logicals and character strings
> between C and Fortran.  I have seen Fortran compilers that treated
> integer -1 (all bits 1) as .true. and anything else as .false. and I
> have see ones that looked only at bit 7, counting from the right, to
> determine the value.
>
> I recommend changing your Fortran code to accept an integer instead of
> a logical for boolean inputs and outputs.


I was using the iso_c_bindings in Fortran 2003, but I guess they are
not part of the SPARC compiler. I will probably end up doing that.
Thank you.

Avi


From avraham.adler at gmail.com  Wed Mar 15 19:32:17 2017
From: avraham.adler at gmail.com (Avraham Adler)
Date: Wed, 15 Mar 2017 14:32:17 -0400
Subject: [R-pkg-devel] Solaris SPARC, Fortran, and logical errors?
In-Reply-To: <ba08662e-6811-f78f-d9ab-8b680ad961e8@gmail.com>
References: <CAL6gwnLk3tNDgbfSv9hOa8snOj+VXV1g3FjkSAzLKosq_cm2Rg@mail.gmail.com>
	<ba08662e-6811-f78f-d9ab-8b680ad961e8@gmail.com>
Message-ID: <CAL6gwn+e6imWO-HemHry7oK+onbCNBShtNXJCJoSbLeusztaTQ@mail.gmail.com>

On Wed, Mar 15, 2017 at 11:09 AM, J C Nash <profjcnash at gmail.com> wrote:
> Possibly tangential, but has there been any effort to set up a Sparc
> testbed? It
> seems we could use a network-available (virtual?) machine, since this
> platform is
> often the unfortunate one. Unless, of course, there's a sunset date.
>

Is this something that can be linked to the rhub suite of testbeds at
github? That would be fantastic.

Avi


From ligges at statistik.tu-dortmund.de  Thu Mar 16 11:49:49 2017
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 16 Mar 2017 11:49:49 +0100
Subject: [R-pkg-devel] Solaris SPARC, Fortran, and logical errors?
In-Reply-To: <f14a0d71-233a-0b70-4117-2469192bbed0@gmail.com>
References: <CAL6gwnLk3tNDgbfSv9hOa8snOj+VXV1g3FjkSAzLKosq_cm2Rg@mail.gmail.com>
	<ba08662e-6811-f78f-d9ab-8b680ad961e8@gmail.com>
	<f14a0d71-233a-0b70-4117-2469192bbed0@gmail.com>
Message-ID: <962252bc-9f8b-eb9f-4a43-87860babaca2@statistik.tu-dortmund.de>



On 15.03.2017 18:30, Ben Bolker wrote:
>
>
> On 17-03-15 11:09 AM, J C Nash wrote:
>> Possibly tangential, but has there been any effort to set up a Sparc
>> testbed? It
>> seems we could use a network-available (virtual?) machine, since this
>> platform is
>> often the unfortunate one. Unless, of course, there's a sunset date.
>>
>> For information, I mentioned SPARC at our local linux group, and
>> apparently there
>> are a couple of folk who have them running, but I didn't find out the
>> state of the
>> OS etc.
>>
>> JN
>
>   The virtual machine platforms I know of (admittedly not a complete
> list!) only support Solaris on x86, e.g.

Yes, you cannot emulate a Sparc in an efficient way on an amd64 platform.

I take the opportunity to repeat why testing on *Sparc Solaris* gives 
many benefits:

- this way we cover big- and little-endian platforms (i.e. for future 
stability so that it works on what appear to be still esoteric such as 
ARM based architectures or so)
- we cover one of the commercial unixes, i.e. we see
   + how stuff works on the the typically rather old toolchains
   + and what happens in on gnu/gcc-setups and how much GNUisms are used

Best,
Uwe Ligges


>
> https://community.oracle.com/thread/2569292
>
>
>
>>
>>
>> On 2017-03-15 10:40 AM, Avraham Adler wrote:
>>> Hello.
>>>
>>> The Delaporte package works properly on all R-core platforms except
>>> Solaris SPARC, where it  compiles properly but fails a number of its
>>> tests [1]. Not having access to a SPARC testbed, I'm limited in what
>>> kind of diagnostics I can do. One thing I have noticed is that a lot
>>> of the failures occur when I am passing non-default logicals (like
>>> lower tail or log). For example, the first failure at that link is
>>> when "log = true" is supposed to be passed, but the SPARC answers are
>>> the unlogged values. Of the 22 failed tests, 12 of them pass logicals.
>>>
>>> I'll bring an example of how it is coded below, and if anyone
>>> recognizes where SPARC specifically goes wrong, I'd appreciate. I
>>> guess, if I absolutely had to, I could convert the logical to an
>>> integer in C and pass the integer to Fortran which should work even
>>> for SPARC, but I'd prefer not to if I could help it.
>>>
>>> Thank you,
>>>
>>> Avi
>>>
>>> [1] https://cran.r-project.org/web/checks/check_results_Delaporte.html
>>>
>>> *****Example Code*****
>>>
>>> R code:
>>>
>>> ddelap <- function(x, alpha, beta, lambda, log = FALSE){
>>>   if(!is.double(x)) {storage.mode(x) <- 'double'}
>>>   if(!is.double(alpha)) {storage.mode(alpha) <- 'double'}
>>>   if(!is.double(beta)) {storage.mode(beta) <- 'double'}
>>>   if(!is.double(lambda)) {storage.mode(lambda) <- 'double'}
>>>   if(any(x > floor(x))) {
>>>     warning("Non-integers passed to ddelap. These will have 0
>>> probability.")
>>>   }
>>>   .Call(ddelap_C, x, alpha, beta, lambda, log)
>>> }
>>>
>>> C code:
>>>
>>> void ddelap_f(double *x, int nx, double *a, int na, double *b, int nb,
>>> double *l, int nl,
>>>               int *lg, double *ret);
>>>
>>> extern SEXP ddelap_C(SEXP x, SEXP alpha, SEXP beta, SEXP lambda, SEXP
>>> lg){
>>>   const int nx = LENGTH(x);
>>>   const int na = LENGTH(alpha);
>>>   const int nb = LENGTH(beta);
>>>   const int nl = LENGTH(lambda);
>>>   SEXP ret;
>>>   PROTECT(ret = allocVector(REALSXP, nx));
>>>   ddelap_f(REAL(x), nx, REAL(alpha), na, REAL(beta), nb, REAL(lambda),
>>> nl, LOGICAL(lg), REAL(ret));
>>>   UNPROTECT(1);
>>>   return(ret);
>>> }
>>>
>>> Fortran: (not posting ddelap_f_s as that doesn't handle the logging)
>>>
>>>     subroutine ddelap_f(x, nx, a, na, b, nb, l, nl, lg, pmfv) bind(C,
>>> name="ddelap_f")
>>>
>>>     integer(kind = c_int), intent(in), value         :: nx, na, nb, nl
>>>     ! Sizes
>>>     real(kind = c_double), intent(in), dimension(nx) :: x
>>>     ! Observations
>>>     real(kind = c_double), intent(out), dimension(nx):: pmfv
>>>     ! Result
>>>     real(kind = c_double), intent(in)                :: a(na), b(nb),
>>> l(nl)! Parameters
>>>     logical(kind = c_bool), intent(in)               :: lg
>>>     ! Log flag
>>>     integer                                          :: i
>>>     ! Integer
>>>
>>>         !$omp parallel do default(shared) private(i)
>>>         do i = 1, nx
>>>             if (x(i) > floor(x(i))) then
>>>                 pmfv(i) = ZERO
>>>             else
>>>                 pmfv(i) = ddelap_f_s(x(i), a(mod(i - 1, na) + 1), &
>>>                                      b(mod(i - 1, nb) + 1), l(mod(i -
>>> 1, nl) + 1))
>>>             end if
>>>         end do
>>>         !$omp end parallel do
>>>
>>>         if (lg) then
>>>             pmfv = log(pmfv)
>>>         end if
>>>
>>>     end subroutine ddelap_f
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From bbolker at gmail.com  Thu Mar 16 13:20:25 2017
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 16 Mar 2017 08:20:25 -0400
Subject: [R-pkg-devel] Solaris SPARC, Fortran, and logical errors?
In-Reply-To: <962252bc-9f8b-eb9f-4a43-87860babaca2@statistik.tu-dortmund.de>
References: <CAL6gwnLk3tNDgbfSv9hOa8snOj+VXV1g3FjkSAzLKosq_cm2Rg@mail.gmail.com>
	<ba08662e-6811-f78f-d9ab-8b680ad961e8@gmail.com>
	<f14a0d71-233a-0b70-4117-2469192bbed0@gmail.com>
	<962252bc-9f8b-eb9f-4a43-87860babaca2@statistik.tu-dortmund.de>
Message-ID: <CABghstSsZLaZ6QeSJJjG-xWDpvFvt4_rC+bNLD1r4E4twPin_w@mail.gmail.com>

I completely agree that testing on SPARC Solaris is valuable, however
much of a nuisance it is.  But I also agree that it would be great if
we could find a way to provide a publicly accessible SPARC Solaris
testing framework.

On Thu, Mar 16, 2017 at 6:49 AM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
>
>
> On 15.03.2017 18:30, Ben Bolker wrote:
>>
>>
>>
>> On 17-03-15 11:09 AM, J C Nash wrote:
>>>
>>> Possibly tangential, but has there been any effort to set up a Sparc
>>> testbed? It
>>> seems we could use a network-available (virtual?) machine, since this
>>> platform is
>>> often the unfortunate one. Unless, of course, there's a sunset date.
>>>
>>> For information, I mentioned SPARC at our local linux group, and
>>> apparently there
>>> are a couple of folk who have them running, but I didn't find out the
>>> state of the
>>> OS etc.
>>>
>>> JN
>>
>>
>>   The virtual machine platforms I know of (admittedly not a complete
>> list!) only support Solaris on x86, e.g.
>
>
> Yes, you cannot emulate a Sparc in an efficient way on an amd64 platform.
>
> I take the opportunity to repeat why testing on *Sparc Solaris* gives many
> benefits:
>
> - this way we cover big- and little-endian platforms (i.e. for future
> stability so that it works on what appear to be still esoteric such as ARM
> based architectures or so)
> - we cover one of the commercial unixes, i.e. we see
>   + how stuff works on the the typically rather old toolchains
>   + and what happens in on gnu/gcc-setups and how much GNUisms are used
>
> Best,
> Uwe Ligges
>
>
>
>>
>> https://community.oracle.com/thread/2569292
>>
>>
>>
>>>
>>>
>>> On 2017-03-15 10:40 AM, Avraham Adler wrote:
>>>>
>>>> Hello.
>>>>
>>>> The Delaporte package works properly on all R-core platforms except
>>>> Solaris SPARC, where it  compiles properly but fails a number of its
>>>> tests [1]. Not having access to a SPARC testbed, I'm limited in what
>>>> kind of diagnostics I can do. One thing I have noticed is that a lot
>>>> of the failures occur when I am passing non-default logicals (like
>>>> lower tail or log). For example, the first failure at that link is
>>>> when "log = true" is supposed to be passed, but the SPARC answers are
>>>> the unlogged values. Of the 22 failed tests, 12 of them pass logicals.
>>>>
>>>> I'll bring an example of how it is coded below, and if anyone
>>>> recognizes where SPARC specifically goes wrong, I'd appreciate. I
>>>> guess, if I absolutely had to, I could convert the logical to an
>>>> integer in C and pass the integer to Fortran which should work even
>>>> for SPARC, but I'd prefer not to if I could help it.
>>>>
>>>> Thank you,
>>>>
>>>> Avi
>>>>
>>>> [1] https://cran.r-project.org/web/checks/check_results_Delaporte.html
>>>>
>>>> *****Example Code*****
>>>>
>>>> R code:
>>>>
>>>> ddelap <- function(x, alpha, beta, lambda, log = FALSE){
>>>>   if(!is.double(x)) {storage.mode(x) <- 'double'}
>>>>   if(!is.double(alpha)) {storage.mode(alpha) <- 'double'}
>>>>   if(!is.double(beta)) {storage.mode(beta) <- 'double'}
>>>>   if(!is.double(lambda)) {storage.mode(lambda) <- 'double'}
>>>>   if(any(x > floor(x))) {
>>>>     warning("Non-integers passed to ddelap. These will have 0
>>>> probability.")
>>>>   }
>>>>   .Call(ddelap_C, x, alpha, beta, lambda, log)
>>>> }
>>>>
>>>> C code:
>>>>
>>>> void ddelap_f(double *x, int nx, double *a, int na, double *b, int nb,
>>>> double *l, int nl,
>>>>               int *lg, double *ret);
>>>>
>>>> extern SEXP ddelap_C(SEXP x, SEXP alpha, SEXP beta, SEXP lambda, SEXP
>>>> lg){
>>>>   const int nx = LENGTH(x);
>>>>   const int na = LENGTH(alpha);
>>>>   const int nb = LENGTH(beta);
>>>>   const int nl = LENGTH(lambda);
>>>>   SEXP ret;
>>>>   PROTECT(ret = allocVector(REALSXP, nx));
>>>>   ddelap_f(REAL(x), nx, REAL(alpha), na, REAL(beta), nb, REAL(lambda),
>>>> nl, LOGICAL(lg), REAL(ret));
>>>>   UNPROTECT(1);
>>>>   return(ret);
>>>> }
>>>>
>>>> Fortran: (not posting ddelap_f_s as that doesn't handle the logging)
>>>>
>>>>     subroutine ddelap_f(x, nx, a, na, b, nb, l, nl, lg, pmfv) bind(C,
>>>> name="ddelap_f")
>>>>
>>>>     integer(kind = c_int), intent(in), value         :: nx, na, nb, nl
>>>>     ! Sizes
>>>>     real(kind = c_double), intent(in), dimension(nx) :: x
>>>>     ! Observations
>>>>     real(kind = c_double), intent(out), dimension(nx):: pmfv
>>>>     ! Result
>>>>     real(kind = c_double), intent(in)                :: a(na), b(nb),
>>>> l(nl)! Parameters
>>>>     logical(kind = c_bool), intent(in)               :: lg
>>>>     ! Log flag
>>>>     integer                                          :: i
>>>>     ! Integer
>>>>
>>>>         !$omp parallel do default(shared) private(i)
>>>>         do i = 1, nx
>>>>             if (x(i) > floor(x(i))) then
>>>>                 pmfv(i) = ZERO
>>>>             else
>>>>                 pmfv(i) = ddelap_f_s(x(i), a(mod(i - 1, na) + 1), &
>>>>                                      b(mod(i - 1, nb) + 1), l(mod(i -
>>>> 1, nl) + 1))
>>>>             end if
>>>>         end do
>>>>         !$omp end parallel do
>>>>
>>>>         if (lg) then
>>>>             pmfv = log(pmfv)
>>>>         end if
>>>>
>>>>     end subroutine ddelap_f
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>


From profjcnash at gmail.com  Thu Mar 16 15:12:39 2017
From: profjcnash at gmail.com (J C Nash)
Date: Thu, 16 Mar 2017 10:12:39 -0400
Subject: [R-pkg-devel] Solaris SPARC, Fortran, and logical errors?
In-Reply-To: <CABghstSsZLaZ6QeSJJjG-xWDpvFvt4_rC+bNLD1r4E4twPin_w@mail.gmail.com>
References: <CAL6gwnLk3tNDgbfSv9hOa8snOj+VXV1g3FjkSAzLKosq_cm2Rg@mail.gmail.com>
	<ba08662e-6811-f78f-d9ab-8b680ad961e8@gmail.com>
	<f14a0d71-233a-0b70-4117-2469192bbed0@gmail.com>
	<962252bc-9f8b-eb9f-4a43-87860babaca2@statistik.tu-dortmund.de>
	<CABghstSsZLaZ6QeSJJjG-xWDpvFvt4_rC+bNLD1r4E4twPin_w@mail.gmail.com>
Message-ID: <f8583e4c-b287-c622-b5b1-a38a7fd84a5d@gmail.com>

FWIW it appears that QEMU has an admittedly slow implementation that supports
some architectures beyond x86/amd64 and that there is recent activity. See

http://wiki.qemu-project.org/Documentation/Platforms/SPARC

An alternative might be to persuade Oracle to provide a Sparc-builder, since they
advertise Oracle R Technologies at
http://www.oracle.com/technetwork/database/database-technologies/r/r-technologies/r-offerings-1566363.html

but dates on that page are from 2014. Perhaps someone has contacts at Oracle and could at least raise
the possibility.

JN



On 2017-03-16 08:20 AM, Ben Bolker wrote:
> I completely agree that testing on SPARC Solaris is valuable, however
> much of a nuisance it is.  But I also agree that it would be great if
> we could find a way to provide a publicly accessible SPARC Solaris
> testing framework.
>
> On Thu, Mar 16, 2017 at 6:49 AM, Uwe Ligges
> <ligges at statistik.tu-dortmund.de> wrote:
>>
>>
>> On 15.03.2017 18:30, Ben Bolker wrote:
>>>
>>>
>>>
>>> On 17-03-15 11:09 AM, J C Nash wrote:
>>>>
>>>> Possibly tangential, but has there been any effort to set up a Sparc
>>>> testbed? It
>>>> seems we could use a network-available (virtual?) machine, since this
>>>> platform is
>>>> often the unfortunate one. Unless, of course, there's a sunset date.
>>>>
>>>> For information, I mentioned SPARC at our local linux group, and
>>>> apparently there
>>>> are a couple of folk who have them running, but I didn't find out the
>>>> state of the
>>>> OS etc.
>>>>
>>>> JN
>>>
>>>
>>>   The virtual machine platforms I know of (admittedly not a complete
>>> list!) only support Solaris on x86, e.g.
>>
>>
>> Yes, you cannot emulate a Sparc in an efficient way on an amd64 platform.
>>
>> I take the opportunity to repeat why testing on *Sparc Solaris* gives many
>> benefits:
>>
>> - this way we cover big- and little-endian platforms (i.e. for future
>> stability so that it works on what appear to be still esoteric such as ARM
>> based architectures or so)
>> - we cover one of the commercial unixes, i.e. we see
>>   + how stuff works on the the typically rather old toolchains
>>   + and what happens in on gnu/gcc-setups and how much GNUisms are used
>>
>> Best,
>> Uwe Ligges
>>
>>
>>
>>>
>>> https://community.oracle.com/thread/2569292
>>>
>>>
>>>
>>>>
>>>>
>>>> On 2017-03-15 10:40 AM, Avraham Adler wrote:
>>>>>
>>>>> Hello.
>>>>>
>>>>> The Delaporte package works properly on all R-core platforms except
>>>>> Solaris SPARC, where it  compiles properly but fails a number of its
>>>>> tests [1]. Not having access to a SPARC testbed, I'm limited in what
>>>>> kind of diagnostics I can do. One thing I have noticed is that a lot
>>>>> of the failures occur when I am passing non-default logicals (like
>>>>> lower tail or log). For example, the first failure at that link is
>>>>> when "log = true" is supposed to be passed, but the SPARC answers are
>>>>> the unlogged values. Of the 22 failed tests, 12 of them pass logicals.
>>>>>
>>>>> I'll bring an example of how it is coded below, and if anyone
>>>>> recognizes where SPARC specifically goes wrong, I'd appreciate. I
>>>>> guess, if I absolutely had to, I could convert the logical to an
>>>>> integer in C and pass the integer to Fortran which should work even
>>>>> for SPARC, but I'd prefer not to if I could help it.
>>>>>
>>>>> Thank you,
>>>>>
>>>>> Avi
>>>>>
>>>>> [1] https://cran.r-project.org/web/checks/check_results_Delaporte.html
>>>>>
>>>>> *****Example Code*****
>>>>>
>>>>> R code:
>>>>>
>>>>> ddelap <- function(x, alpha, beta, lambda, log = FALSE){
>>>>>   if(!is.double(x)) {storage.mode(x) <- 'double'}
>>>>>   if(!is.double(alpha)) {storage.mode(alpha) <- 'double'}
>>>>>   if(!is.double(beta)) {storage.mode(beta) <- 'double'}
>>>>>   if(!is.double(lambda)) {storage.mode(lambda) <- 'double'}
>>>>>   if(any(x > floor(x))) {
>>>>>     warning("Non-integers passed to ddelap. These will have 0
>>>>> probability.")
>>>>>   }
>>>>>   .Call(ddelap_C, x, alpha, beta, lambda, log)
>>>>> }
>>>>>
>>>>> C code:
>>>>>
>>>>> void ddelap_f(double *x, int nx, double *a, int na, double *b, int nb,
>>>>> double *l, int nl,
>>>>>               int *lg, double *ret);
>>>>>
>>>>> extern SEXP ddelap_C(SEXP x, SEXP alpha, SEXP beta, SEXP lambda, SEXP
>>>>> lg){
>>>>>   const int nx = LENGTH(x);
>>>>>   const int na = LENGTH(alpha);
>>>>>   const int nb = LENGTH(beta);
>>>>>   const int nl = LENGTH(lambda);
>>>>>   SEXP ret;
>>>>>   PROTECT(ret = allocVector(REALSXP, nx));
>>>>>   ddelap_f(REAL(x), nx, REAL(alpha), na, REAL(beta), nb, REAL(lambda),
>>>>> nl, LOGICAL(lg), REAL(ret));
>>>>>   UNPROTECT(1);
>>>>>   return(ret);
>>>>> }
>>>>>
>>>>> Fortran: (not posting ddelap_f_s as that doesn't handle the logging)
>>>>>
>>>>>     subroutine ddelap_f(x, nx, a, na, b, nb, l, nl, lg, pmfv) bind(C,
>>>>> name="ddelap_f")
>>>>>
>>>>>     integer(kind = c_int), intent(in), value         :: nx, na, nb, nl
>>>>>     ! Sizes
>>>>>     real(kind = c_double), intent(in), dimension(nx) :: x
>>>>>     ! Observations
>>>>>     real(kind = c_double), intent(out), dimension(nx):: pmfv
>>>>>     ! Result
>>>>>     real(kind = c_double), intent(in)                :: a(na), b(nb),
>>>>> l(nl)! Parameters
>>>>>     logical(kind = c_bool), intent(in)               :: lg
>>>>>     ! Log flag
>>>>>     integer                                          :: i
>>>>>     ! Integer
>>>>>
>>>>>         !$omp parallel do default(shared) private(i)
>>>>>         do i = 1, nx
>>>>>             if (x(i) > floor(x(i))) then
>>>>>                 pmfv(i) = ZERO
>>>>>             else
>>>>>                 pmfv(i) = ddelap_f_s(x(i), a(mod(i - 1, na) + 1), &
>>>>>                                      b(mod(i - 1, nb) + 1), l(mod(i -
>>>>> 1, nl) + 1))
>>>>>             end if
>>>>>         end do
>>>>>         !$omp end parallel do
>>>>>
>>>>>         if (lg) then
>>>>>             pmfv = log(pmfv)
>>>>>         end if
>>>>>
>>>>>     end subroutine ddelap_f
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From cdetermanjr at gmail.com  Thu Mar 16 16:00:40 2017
From: cdetermanjr at gmail.com (Charles Determan)
Date: Thu, 16 Mar 2017 10:00:40 -0500
Subject: [R-pkg-devel] Windows specific compiler for CUDA builds
Message-ID: <CAKxd1KPx5oecBH-KjtZooLxbozaisvMHE-icZs3T5FZY0Svv0w@mail.gmail.com>

Greetings,

Not sure if this should be on the Rcpp list but it isn't strictly related
to Rcpp but to package building involving Rcpp so I am posting it here.

I am often working on GPU packages that use either OpenCL or CUDA.  OpenCL
is nice because it doesn't require a special additional compiler and I can
build it across platforms with relative ease.  With CUDA, it requires the
'nvcc' compiler.  This is where my problem comes in.  On Windows the 'nvcc'
requires the use of the 'cl' compiler within Visual Studio and the
resulting object files, AFAIK, cannot be linked to object files created by
g++ (via Rtools).  Everything works great on Linux (where the same compiler
is used for everything) but on a Windows system this is causing a lot of
headaches.

So, at the moment, my conclusion is that it is simply not possible to build
a CUDA package that can be installed on a Windows system.  To my knowledge,
no CUDA based R package has a Windows installation functional (please state
otherwise if I am wrong).

My only thought would be if it would be possible to have the Windows build
use 'cl' for the entire build process.  Perhaps that would allow all the
files to be linked together and create the necessary shared object at the
end?  Obviously the preference is to use Rtools but until NVIDIA updates
their special compiler to support MinGW tools I don't think that is
possible.

Any insight would be appreciated,

Charles

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Thu Mar 16 16:41:57 2017
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 16 Mar 2017 11:41:57 -0400
Subject: [R-pkg-devel] Windows specific compiler for CUDA builds
In-Reply-To: <CAKxd1KPx5oecBH-KjtZooLxbozaisvMHE-icZs3T5FZY0Svv0w@mail.gmail.com>
References: <CAKxd1KPx5oecBH-KjtZooLxbozaisvMHE-icZs3T5FZY0Svv0w@mail.gmail.com>
Message-ID: <9e3be79b-ff84-f81c-d72f-2609b3f59f2b@gmail.com>

On 16/03/2017 11:00 AM, Charles Determan wrote:
> Greetings,
>
> Not sure if this should be on the Rcpp list but it isn't strictly related
> to Rcpp but to package building involving Rcpp so I am posting it here.
>
> I am often working on GPU packages that use either OpenCL or CUDA.  OpenCL
> is nice because it doesn't require a special additional compiler and I can
> build it across platforms with relative ease.  With CUDA, it requires the
> 'nvcc' compiler.  This is where my problem comes in.  On Windows the 'nvcc'
> requires the use of the 'cl' compiler within Visual Studio and the
> resulting object files, AFAIK, cannot be linked to object files created by
> g++ (via Rtools).  Everything works great on Linux (where the same compiler
> is used for everything) but on a Windows system this is causing a lot of
> headaches.
>
> So, at the moment, my conclusion is that it is simply not possible to build
> a CUDA package that can be installed on a Windows system.  To my knowledge,
> no CUDA based R package has a Windows installation functional (please state
> otherwise if I am wrong).
>
> My only thought would be if it would be possible to have the Windows build
> use 'cl' for the entire build process.  Perhaps that would allow all the
> files to be linked together and create the necessary shared object at the
> end?  Obviously the preference is to use Rtools but until NVIDIA updates
> their special compiler to support MinGW tools I don't think that is
> possible.

In principle it should be possible to use cl.  In practice, it will 
require someone to work out the details of doing it and to maintain it 
(by testing R-devel regularly to make sure changes there don't cause 
trouble for it).  There aren't a lot of people who know how to do that 
(e.g. I don't).  If you are willing to volunteer to do this (or can 
recruit someone to do it), go ahead.  Assuming you do a good job, we can 
put your patches into the base code.

Duncan Murdoch


From cdetermanjr at gmail.com  Thu Mar 16 18:48:03 2017
From: cdetermanjr at gmail.com (Charles Determan)
Date: Thu, 16 Mar 2017 12:48:03 -0500
Subject: [R-pkg-devel] Windows specific compiler for CUDA builds
In-Reply-To: <9e3be79b-ff84-f81c-d72f-2609b3f59f2b@gmail.com>
References: <CAKxd1KPx5oecBH-KjtZooLxbozaisvMHE-icZs3T5FZY0Svv0w@mail.gmail.com>
	<9e3be79b-ff84-f81c-d72f-2609b3f59f2b@gmail.com>
Message-ID: <CAKxd1KN5imupRxoHg3+Nz5DaLNxK0QQTgEjb74sMb+ookqeC-w@mail.gmail.com>

Thanks Duncan,

You say there aren't a lot of people that no how to do that.  Do you know
of anyone who would?  I assume Dirk would be a likely person given the use
of Rtools with Rcpp.  I am happy to try and work at this as I have a vested
interest in getting CUDA packages to become functional on Windows systems
but I need somewhere to begin.  Basically I'm just looking how to switch
out the MinGW g++ with the VS cl compiler.  On a Linux system I can create
a .R/Makevars file to switch the CXX variable but I don't know how on
Windows.

Charles

On Thu, Mar 16, 2017 at 10:41 AM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 16/03/2017 11:00 AM, Charles Determan wrote:
>
>> Greetings,
>>
>> Not sure if this should be on the Rcpp list but it isn't strictly related
>> to Rcpp but to package building involving Rcpp so I am posting it here.
>>
>> I am often working on GPU packages that use either OpenCL or CUDA.  OpenCL
>> is nice because it doesn't require a special additional compiler and I can
>> build it across platforms with relative ease.  With CUDA, it requires the
>> 'nvcc' compiler.  This is where my problem comes in.  On Windows the
>> 'nvcc'
>> requires the use of the 'cl' compiler within Visual Studio and the
>> resulting object files, AFAIK, cannot be linked to object files created by
>> g++ (via Rtools).  Everything works great on Linux (where the same
>> compiler
>> is used for everything) but on a Windows system this is causing a lot of
>> headaches.
>>
>> So, at the moment, my conclusion is that it is simply not possible to
>> build
>> a CUDA package that can be installed on a Windows system.  To my
>> knowledge,
>> no CUDA based R package has a Windows installation functional (please
>> state
>> otherwise if I am wrong).
>>
>> My only thought would be if it would be possible to have the Windows build
>> use 'cl' for the entire build process.  Perhaps that would allow all the
>> files to be linked together and create the necessary shared object at the
>> end?  Obviously the preference is to use Rtools but until NVIDIA updates
>> their special compiler to support MinGW tools I don't think that is
>> possible.
>>
>
> In principle it should be possible to use cl.  In practice, it will
> require someone to work out the details of doing it and to maintain it (by
> testing R-devel regularly to make sure changes there don't cause trouble
> for it).  There aren't a lot of people who know how to do that (e.g. I
> don't).  If you are willing to volunteer to do this (or can recruit someone
> to do it), go ahead.  Assuming you do a good job, we can put your patches
> into the base code.
>
> Duncan Murdoch
>
>
>
>

	[[alternative HTML version deleted]]


From pavel at uow.edu.au  Thu Mar 16 22:11:05 2017
From: pavel at uow.edu.au (Pavel Krivitsky)
Date: Thu, 16 Mar 2017 21:11:05 +0000
Subject: [R-pkg-devel] R CMD check warning about .inc files.
Message-ID: <1489698663.1974.30.camel@uow.edu.au>

Dear All,

Since some C header files in a package I maintain have identical macro
definitions (which have a different meanings, since other macro
definitions differ), I tried to reduce code duplication to split the
common macros into their own files, which don't get #included directly
by any C files. To give a minimal example, in the following two header
files,

BEGIN foo1.h

#define BAR 1
#define BAZ(x) ((x)+BAR)

END foo1.h

BEGIN foo2.h

#define BAR 2
#define BAZ(x) ((x)+BAR)

END foo2.h

BAZ() macro has redundant definition. I'd like to get rid of the code
duplication with the following three files:

BEGIN foo1.h

#define BAR 1
#include "foo_common.inc"

END foo1.h

BEGIN foo2.h

#define BAR 2
#include "foo_common.inc"

END foo2.h

BEGIN foo_common.inc

#define BAZ(x) ((x)+BAR)

END foo_common.inc

However, I get an R CMD check warning of the form

Subdirectory ?src? contains:
? foo_common.inc

Is there a way to tell R CMD check that .inc files are OK? Or, should I
use a different extension? I don't want to use .c, because those files
only contain macros and not anything that compiles to object code, and
I don't want to use .h, because these are not meant to be included as
header files by any C code.

					Thank you in advance,
					Pavel

-- 
Pavel Krivitsky
Lecturer in Statistics
National Institute of Applied Statistics Research Australia (NIASRA)
School of Mathematics and Applied Statistics | Building 39C Room 154
University of Wollongong NSW 2522 Australia
T +61 2 4221 3713
Web (NIASRA): http://niasra.uow.edu.au/index.html
Web (Personal): http://www.krivitsky.net/research
ORCID: 0000-0002-9101-3362

NOTICE: This email is intended for the addressee named and may contain
confidential information. If you are not the intended recipient, please
delete it and notify the sender. Please consider the environment before
printing this email.

From csardi.gabor at gmail.com  Thu Mar 16 22:31:26 2017
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 16 Mar 2017 21:31:26 +0000
Subject: [R-pkg-devel] R CMD check warning about .inc files.
In-Reply-To: <1489698663.1974.30.camel@uow.edu.au>
References: <1489698663.1974.30.camel@uow.edu.au>
Message-ID: <CABtg=KmTrLA_WA3u0Z8B50FEN5Qn3rVc+Sew6GGLh8N4aeN38Q@mail.gmail.com>

I different extension is fine I think. I use .pmt (poor man's
templates) for something very similar.

Gabor

On Thu, Mar 16, 2017 at 9:11 PM, Pavel Krivitsky <pavel at uow.edu.au> wrote:
> Dear All,
>
> Since some C header files in a package I maintain have identical macro
> definitions (which have a different meanings, since other macro
> definitions differ), I tried to reduce code duplication to split the
> common macros into their own files, which don't get #included directly
> by any C files. To give a minimal example, in the following two header
> files,
>
> BEGIN foo1.h
>
> #define BAR 1
> #define BAZ(x) ((x)+BAR)
>
> END foo1.h
>
> BEGIN foo2.h
>
> #define BAR 2
> #define BAZ(x) ((x)+BAR)
>
> END foo2.h
>
> BAZ() macro has redundant definition. I'd like to get rid of the code
> duplication with the following three files:
>
> BEGIN foo1.h
>
> #define BAR 1
> #include "foo_common.inc"
>
> END foo1.h
>
> BEGIN foo2.h
>
> #define BAR 2
> #include "foo_common.inc"
>
> END foo2.h
>
> BEGIN foo_common.inc
>
> #define BAZ(x) ((x)+BAR)
>
> END foo_common.inc
>
> However, I get an R CMD check warning of the form
>
> Subdirectory ?src? contains:
>   foo_common.inc
>
> Is there a way to tell R CMD check that .inc files are OK? Or, should I
> use a different extension? I don't want to use .c, because those files
> only contain macros and not anything that compiles to object code, and
> I don't want to use .h, because these are not meant to be included as
> header files by any C code.
>
>                                         Thank you in advance,
>                                         Pavel
>
> --
> Pavel Krivitsky
> Lecturer in Statistics
> National Institute of Applied Statistics Research Australia (NIASRA)
> School of Mathematics and Applied Statistics | Building 39C Room 154
> University of Wollongong NSW 2522 Australia
> T +61 2 4221 3713
> Web (NIASRA): http://niasra.uow.edu.au/index.html
> Web (Personal): http://www.krivitsky.net/research
> ORCID: 0000-0002-9101-3362
>
> NOTICE: This email is intended for the addressee named and may contain
> confidential information. If you are not the intended recipient, please
> delete it and notify the sender. Please consider the environment before
> printing this email.
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From pavel at uow.edu.au  Thu Mar 16 23:12:28 2017
From: pavel at uow.edu.au (Pavel Krivitsky)
Date: Thu, 16 Mar 2017 22:12:28 +0000
Subject: [R-pkg-devel] R CMD check warning about .inc files.
In-Reply-To: <CABtg=KmTrLA_WA3u0Z8B50FEN5Qn3rVc+Sew6GGLh8N4aeN38Q@mail.gmail.com>
References: <1489698663.1974.30.camel@uow.edu.au>
	<CABtg=KmTrLA_WA3u0Z8B50FEN5Qn3rVc+Sew6GGLh8N4aeN38Q@mail.gmail.com>
Message-ID: <1489702346.1974.31.camel@uow.edu.au>

On Thu, 2017-03-16 at 21:31 +0000, G?bor Cs?rdi wrote:
> I different extension is fine I think. I use .pmt (poor man's
> templates) for something very similar.

No, both .pmt and .inc produce an R CMD check warning. (The package
itself compiles correctly in either case.)

					Pavel

> 
> Gabor
> 
> On Thu, Mar 16, 2017 at 9:11 PM, Pavel Krivitsky <pavel at uow.edu.au>
> wrote:
> > Dear All,
> > 
> > Since some C header files in a package I maintain have identical
> > macro
> > definitions (which have a different meanings, since other macro
> > definitions differ), I tried to reduce code duplication to split
> > the
> > common macros into their own files, which don't get #included
> > directly
> > by any C files. To give a minimal example, in the following two
> > header
> > files,
> > 
> > BEGIN foo1.h
> > 
> > #define BAR 1
> > #define BAZ(x) ((x)+BAR)
> > 
> > END foo1.h
> > 
> > BEGIN foo2.h
> > 
> > #define BAR 2
> > #define BAZ(x) ((x)+BAR)
> > 
> > END foo2.h
> > 
> > BAZ() macro has redundant definition. I'd like to get rid of the
> > code
> > duplication with the following three files:
> > 
> > BEGIN foo1.h
> > 
> > #define BAR 1
> > #include "foo_common.inc"
> > 
> > END foo1.h
> > 
> > BEGIN foo2.h
> > 
> > #define BAR 2
> > #include "foo_common.inc"
> > 
> > END foo2.h
> > 
> > BEGIN foo_common.inc
> > 
> > #define BAZ(x) ((x)+BAR)
> > 
> > END foo_common.inc
> > 
> > However, I get an R CMD check warning of the form
> > 
> > Subdirectory ?src? contains:
> > ? foo_common.inc
> > 
> > Is there a way to tell R CMD check that .inc files are OK? Or,
> > should I
> > use a different extension? I don't want to use .c, because those
> > files
> > only contain macros and not anything that compiles to object code,
> > and
> > I don't want to use .h, because these are not meant to be included
> > as
> > header files by any C code.
> > 
> > ????????????????????????????????????????Thank you in advance,
> > ????????????????????????????????????????Pavel
> > 
> > --
> > Pavel Krivitsky
> > Lecturer in Statistics
> > National Institute of Applied Statistics Research Australia
> > (NIASRA)
> > School of Mathematics and Applied Statistics | Building 39C Room
> > 154
> > University of Wollongong NSW 2522 Australia
> > T +61 2 4221 3713
> > Web (NIASRA): http://niasra.uow.edu.au/index.html
> > Web (Personal): http://www.krivitsky.net/research
> > ORCID: 0000-0002-9101-3362
> > 
> > NOTICE: This email is intended for the addressee named and may
> > contain
> > confidential information. If you are not the intended recipient,
> > please
> > delete it and notify the sender. Please consider the environment
> > before
> > printing this email.
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> 
-- 
Pavel Krivitsky
Lecturer in Statistics
National Institute of Applied Statistics Research Australia (NIASRA)
School of Mathematics and Applied Statistics | Building 39C Room 154
University of Wollongong NSW 2522 Australia
T +61 2 4221 3713
Web (NIASRA): http://niasra.uow.edu.au/index.html
Web (Personal): http://www.krivitsky.net/research
ORCID: 0000-0002-9101-3362

NOTICE: This email is intended for the addressee named and may contain
confidential information. If you are not the intended recipient, please
delete it and notify the sender. Please consider the environment before
printing this email.

From csardi.gabor at gmail.com  Thu Mar 16 23:17:03 2017
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 16 Mar 2017 22:17:03 +0000
Subject: [R-pkg-devel] R CMD check warning about .inc files.
In-Reply-To: <1489702346.1974.31.camel@uow.edu.au>
References: <1489698663.1974.30.camel@uow.edu.au>
	<CABtg=KmTrLA_WA3u0Z8B50FEN5Qn3rVc+Sew6GGLh8N4aeN38Q@mail.gmail.com>
	<1489702346.1974.31.camel@uow.edu.au>
Message-ID: <CABtg=Kkp1nNXffjGGaBtncsveJO4yY=JsNp6i2GmJEVybi=UDg@mail.gmail.com>

On Thu, Mar 16, 2017 at 10:12 PM, Pavel Krivitsky <pavel at uow.edu.au> wrote:
> On Thu, 2017-03-16 at 21:31 +0000, G?bor Cs?rdi wrote:
>> I different extension is fine I think. I use .pmt (poor man's
>> templates) for something very similar.
>
> No, both .pmt and .inc produce an R CMD check warning. (The package
> itself compiles correctly in either case.)

Interesting. Where are these files? igraph has had .pmt files in src/
for >10 years, and I never had any problems with them. They do not
show up in recent checks, either:
https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-clang/igraph-00check.html

Maybe you have them in a different directory?

Gabor

[...]


From miguelmo at gmail.com  Mon Mar 20 08:47:45 2017
From: miguelmo at gmail.com (=?UTF-8?Q?Miguel_Men=C3=A9ndez?=)
Date: Mon, 20 Mar 2017 08:47:45 +0100
Subject: [R-pkg-devel] NOTE with unusual but theoretically allowed person
	roles
Message-ID: <CAFWjzg60XMkNS3EY8zOpKTXmKH++fKtPCw7BzTO7ti7+CjC7vQ@mail.gmail.com>

While checking a package as cran with R 3.3.2 (Windows 8 and Ubuntu 16.04),
I am getting a NOTE about person roles which are unusual but theoretically
allowed.


In the DESCRIPTION file I set:

Authors at R: c(
  person("First", "Person", email = "me at mail.com", role = c("aut", "cre")),
  person("Second", "Person", role = c("dtc", "csl")))
Author: First Person [aut, cre],
  Second Person [dtc, csl]


Then I get a NOTE:

Author field differs from that derived from Authors at R
  Author:    'First Person [aut, cre], Second Person [dtc, csl]'
  Authors at R: 'First Person [aut, cre], Second Person [dtc]'

If I delete the role 'csl', the note dissapears.

It seems that R code is not allowing the role 'csl' (Consultant), although
it is in the MARC Code List for Relators (https://www.loc.gov/marc/rela
tors/relaterm.html)

If I run the code in the console, apparently Authors at R and Authors fit, so
I don't understand the NOTE:

> c(person("First", "Person", email = "me at mail.com", role = c("aut",
"cre")),
      person("Second", "Person", role = c("dtc", "csl")))
[1] "First Person <me at mail.com> [aut, cre]"
[2] "Second Person [dtc, csl]"


I get more confused when I run the same code in r-fiddle.org and I get a
different output:
Invalid role specification: 'dtc'.
[1] "First Person <me at mail.com> [aut, cre]"
[2] "Second Person [csl]"


I have tried with other roles not included as suggested in ?person, such as
'pdr' (Project director), or 'sad' (Scientific advisor), with the same
problem.


I can just consider the second person as a contributor and go on, but... is
this an expected behavour? What I am doing wrong?

Thanks in advance.

	[[alternative HTML version deleted]]


From julia.silge at gmail.com  Mon Mar 20 18:56:25 2017
From: julia.silge at gmail.com (Julia Silge)
Date: Mon, 20 Mar 2017 17:56:25 +0000
Subject: [R-pkg-devel] How do you discover and learn about R packages?
Message-ID: <CA+mbi1emgiE4JP4AioA=rbBu=yNR=yxWXWT0JNaxSYhbuvfdTw@mail.gmail.com>

I am contributing to a session at userR 2017 this coming July that will
focus on discovering and learning about R packages. This is an increasingly
important issue for R users as we all decide which of the 10,000+ packages
to invest time in understanding and then use in our work.

To prepare for this session and gain some understanding, I am running an
online survey about how R users currently discover and learn about R
packages:
http://doo.vote/a87ff60

The question has one multiple select question about how you currently
discover and learn about R packages. If you have other ways that you don?t
feel were fairly covered in the survey options, feel free to reply to me or
leave a comment here on my blog:
http://juliasilge.com/blog/Package-Search/

Thanks,
Julia

	[[alternative HTML version deleted]]


From mark.vanderloo at gmail.com  Mon Mar 20 22:27:03 2017
From: mark.vanderloo at gmail.com (Mark van der Loo)
Date: Mon, 20 Mar 2017 21:27:03 +0000
Subject: [R-pkg-devel] How do you discover and learn about R packages?
In-Reply-To: <CA+mbi1emgiE4JP4AioA=rbBu=yNR=yxWXWT0JNaxSYhbuvfdTw@mail.gmail.com>
References: <CA+mbi1emgiE4JP4AioA=rbBu=yNR=yxWXWT0JNaxSYhbuvfdTw@mail.gmail.com>
Message-ID: <CAOKDuOh-+c_4bnBG5XxOQ012ZxuQFwQ5JLqXLcVDWzDixNBeRw@mail.gmail.com>

Julia,

Just took the poll.

I think cranberries would deserve mention there as well. It is the only
continuous feed that reports in new pkgs and updates (that I know of).

Best,
Mark

On Mon, Mar 20, 2017, 14:57 Julia Silge <julia.silge at gmail.com> wrote:

> I am contributing to a session at userR 2017 this coming July that will
> focus on discovering and learning about R packages. This is an increasingly
> important issue for R users as we all decide which of the 10,000+ packages
> to invest time in understanding and then use in our work.
>
> To prepare for this session and gain some understanding, I am running an
> online survey about how R users currently discover and learn about R
> packages:
> http://doo.vote/a87ff60
>
> The question has one multiple select question about how you currently
> discover and learn about R packages. If you have other ways that you don?t
> feel were fairly covered in the survey options, feel free to reply to me or
> leave a comment here on my blog:
> http://juliasilge.com/blog/Package-Search/
>
> Thanks,
> Julia
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From julia.silge at gmail.com  Mon Mar 20 22:30:16 2017
From: julia.silge at gmail.com (Julia Silge)
Date: Mon, 20 Mar 2017 21:30:16 +0000
Subject: [R-pkg-devel] How do you discover and learn about R packages?
In-Reply-To: <CAOKDuOh-+c_4bnBG5XxOQ012ZxuQFwQ5JLqXLcVDWzDixNBeRw@mail.gmail.com>
References: <CA+mbi1emgiE4JP4AioA=rbBu=yNR=yxWXWT0JNaxSYhbuvfdTw@mail.gmail.com>
	<CAOKDuOh-+c_4bnBG5XxOQ012ZxuQFwQ5JLqXLcVDWzDixNBeRw@mail.gmail.com>
Message-ID: <CA+mbi1f=WAYWj6VMZ0Ww0sBfY2iB4fDhrYcAckOw2hKETE3dEg@mail.gmail.com>

Yes, great input! I appreciate Dirk also bringing up CRANberries earlier;
it is such a valuable resource. I know that users are glad to access it via
Twitter and its separate website.

Thanks so much,
Julia


On Mon, Mar 20, 2017 at 3:27 PM Mark van der Loo <mark.vanderloo at gmail.com>
wrote:

> Julia,
>
> Just took the poll.
>
> I think cranberries would deserve mention there as well. It is the only
> continuous feed that reports in new pkgs and updates (that I know of).
>
> Best,
> Mark
>
> On Mon, Mar 20, 2017, 14:57 Julia Silge <julia.silge at gmail.com> wrote:
>
> I am contributing to a session at userR 2017 this coming July that will
> focus on discovering and learning about R packages. This is an increasingly
> important issue for R users as we all decide which of the 10,000+ packages
> to invest time in understanding and then use in our work.
>
> To prepare for this session and gain some understanding, I am running an
> online survey about how R users currently discover and learn about R
> packages:
> http://doo.vote/a87ff60
>
> The question has one multiple select question about how you currently
> discover and learn about R packages. If you have other ways that you don?t
> feel were fairly covered in the survey options, feel free to reply to me or
> leave a comment here on my blog:
> http://juliasilge.com/blog/Package-Search/
>
> Thanks,
> Julia
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>

	[[alternative HTML version deleted]]


From jbeaulieu at nimbios.org  Fri Mar 24 14:52:57 2017
From: jbeaulieu at nimbios.org (Jeremy Beaulieu)
Date: Fri, 24 Mar 2017 08:52:57 -0500
Subject: [R-pkg-devel] Registering compiled functions and Winbuilder
	pre-check error
Message-ID: <8A3383B0-9B32-4E9E-A461-D393BD512CA3@nimbios.org>

Hi all:

So, I?m trying to submit a new version of a package of mine and have run into the new registration of compiled functions requirement. I?ve followed all the instructions, made sure the code runs properly, and ran the package checks. Everything seems fine and there are no errors or notes that are flagged during the package check.

However, when I submit my package onto CRAN it does not pass the win-builder pre-check. Here is the output:

* using log directory 'd:/RCompile/CRANincoming/R-devel/hisse.Rcheck'
* using R Under development (unstable) (2017-03-21 r72375)
* using platform: x86_64-w64-mingw32 (64-bit)
* using session charset: ISO8859-1
* checking for file 'hisse/DESCRIPTION' ... OK
* this is package 'hisse' version '1.8.2'
* checking CRAN incoming feasibility ... NOTE
Maintainer: 'Jeremy Beaulieu <jbeaulieu at nimbios.org <mailto:jbeaulieu at nimbios.org>>'

Possibly mis-spelled words in DESCRIPTION:
 HiSSE (10:37)
 Speciation (4:21, 10:63)
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for hidden files and directories ... OK
* checking for portable file names ... OK
* checking whether package 'hisse' can be installed ... OK
* checking installed package size ... OK
* checking package directory ... OK
* checking 'build' directory ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking for left-over files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* loading checks for arch 'i386'
** checking whether the package can be loaded ... OK
** checking whether the package can be loaded with stated dependencies ... OK
** checking whether the package can be unloaded cleanly ... OK
** checking whether the namespace can be loaded with stated dependencies ... OK
** checking whether the namespace can be unloaded cleanly ... OK
** checking loading without being on the library search path ... OK
** checking use of S3 registration ... OK
* loading checks for arch 'x64'
** checking whether the package can be loaded ... OK
** checking whether the package can be loaded with stated dependencies ... OK
** checking whether the package can be unloaded cleanly ... OK
** checking whether the namespace can be loaded with stated dependencies ... OK
** checking whether the namespace can be unloaded cleanly ... OK
** checking loading without being on the library search path ... OK
** checking use of S3 registration ... OK
* checking dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... OK
* checking Rd files ... OK
* checking Rd metadata ... OK
* checking Rd line widths ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* checking Rd contents ... OK
* checking for unstated dependencies in examples ... OK
* checking line endings in C/C++/Fortran sources/headers ... OK
* checking line endings in Makefiles ... OK
* checking compilation flags in Makevars ... OK
* checking for GNU extensions in Makefiles ... OK
* checking for portable use of $(BLAS_LIBS) and $(LAPACK_LIBS) ... OK
* checking compiled code ... NOTE
File 'hisse/libs/i386/hisse.dll':
 Found no call to: 'R_registerRoutines'
File 'hisse/libs/x64/hisse.dll':
 Found no call to: 'R_registerRoutines'

It is good practice to register native routines and to disable symbol
search.

See 'Writing portable packages' in the 'Writing R Extensions' manual.
* checking installed files from 'inst/doc' ... OK
* checking files in 'vignettes' ... OK
* checking examples ...
** running examples for arch 'i386' ... [3s] OK
** running examples for arch 'x64' ... [4s] OK
* checking for unstated dependencies in 'tests' ... OK
* checking tests ...
** running tests for arch 'i386' ... [6s] OK
 Running 'testthat.R' [6s]
** running tests for arch 'x64' ... [8s] OK
 Running 'testthat.R' [7s]
* checking for unstated dependencies in vignettes ... OK
* checking package vignettes in 'inst/doc' ... OK
* checking re-building of vignette outputs ... [30s] OK
* checking PDF version of manual ... OK
* DONE
Status: 2 NOTEs

The error is obviously the "File 'hisse/libs/i386/hisse.dll? but that has the notes: But I have no idea what this error is and how to fix it. In fact, when I run the code on Winbuilder myself, I get no such error.

Here is my init.c file:

#include <stdlib.h> // for NULL
#include <R_ext/Rdynload.h>


/* .C calls */
extern void initmod_bisse();
extern void initmod_hisse();
extern void initmod_hisse_null();

extern void maddison_DE_bisse(void *, void *, void *, void *, void *, void *);
extern void maddison_DE_hisse(void *, void *, void *, void *, void *, void *);
extern void maddison_DE_hisse_null(void *, void *, void *, void *, void *, void *);

extern void set_birth_bisse_void(void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *);
extern void set_birth_hisse_null_void(void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *);
extern void set_birth_hisse_void(void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *, void *);

static const R_CMethodDef CEntries[] = {
   {"initmod_bisse",             (DL_FUNC) &initmod_bisse,              0},
   {"initmod_hisse",             (DL_FUNC) &initmod_hisse,              0},
   {"initmod_hisse_null",        (DL_FUNC) &initmod_hisse_null,              0},
   {"maddison_DE_bisse",         (DL_FUNC) &maddison_DE_bisse,          6},
   {"maddison_DE_hisse",         (DL_FUNC) &maddison_DE_hisse,          6},
   {"maddison_DE_hisse_null",    (DL_FUNC) &maddison_DE_hisse_null,          6},
   {"set_birth_bisse_void",      (DL_FUNC) &set_birth_bisse_void,      29},
   {"set_birth_hisse_null_void", (DL_FUNC) &set_birth_hisse_null_void, 54},
   {"set_birth_hisse_void",      (DL_FUNC) &set_birth_hisse_void,      59},
   {NULL, NULL, 0}
};

void R_init_hisse(DllInfo *dll)
{
   R_registerRoutines(dll, CEntries, NULL, NULL, NULL);
   R_useDynamicSymbols(dll, FALSE);
}

Any help or advice on this would be greatly appreciated. Again, the version that I install on my computer and such runs fine. So I am not sure why it is saying I am making no calls to R_registerRoutines. 





	[[alternative HTML version deleted]]


From edd at debian.org  Fri Mar 24 17:21:45 2017
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 24 Mar 2017 11:21:45 -0500
Subject: [R-pkg-devel] Registering compiled functions and
	Winbuilder	pre-check error
In-Reply-To: <8A3383B0-9B32-4E9E-A461-D393BD512CA3@nimbios.org>
References: <8A3383B0-9B32-4E9E-A461-D393BD512CA3@nimbios.org>
Message-ID: <22741.18329.111016.181176@max.eddelbuettel.com>


On 24 March 2017 at 08:52, Jeremy Beaulieu wrote:
| * checking compiled code ... NOTE
| File 'hisse/libs/i386/hisse.dll':
|  Found no call to: 'R_registerRoutines'
| File 'hisse/libs/x64/hisse.dll':
|  Found no call to: 'R_registerRoutines'
| 
| It is good practice to register native routines and to disable symbol
| search.
| 
| See 'Writing portable packages' in the 'Writing R Extensions' manual.
| * checking installed files from 'inst/doc' ... OK

Somehow the file init.c is not compiled into your dll.  You need to figure
out why.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From jbeaulieu at nimbios.org  Fri Mar 24 21:52:04 2017
From: jbeaulieu at nimbios.org (Jeremy Beaulieu)
Date: Fri, 24 Mar 2017 15:52:04 -0500
Subject: [R-pkg-devel] Registering compiled functions and Winbuilder
	pre-check error
In-Reply-To: <22741.18329.111016.181176@max.eddelbuettel.com>
References: <8A3383B0-9B32-4E9E-A461-D393BD512CA3@nimbios.org>
	<22741.18329.111016.181176@max.eddelbuettel.com>
Message-ID: <FDFD89AC-424E-40D8-A005-0E2474817A36@nimbios.org>

Thanks for the quick reply.

Hmm. Well I?m not sure how to go about this. Should I change the name of the file? I assumed that it could init.c, but maybe that has changed.



> On Mar 24, 2017, at 11:21 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
> 
> 
> On 24 March 2017 at 08:52, Jeremy Beaulieu wrote:
> | * checking compiled code ... NOTE
> | File 'hisse/libs/i386/hisse.dll':
> |  Found no call to: 'R_registerRoutines'
> | File 'hisse/libs/x64/hisse.dll':
> |  Found no call to: 'R_registerRoutines'
> | 
> | It is good practice to register native routines and to disable symbol
> | search.
> | 
> | See 'Writing portable packages' in the 'Writing R Extensions' manual.
> | * checking installed files from 'inst/doc' ... OK
> 
> Somehow the file init.c is not compiled into your dll.  You need to figure
> out why.
> 
> Dirk
> 
> -- 
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From maechler at stat.math.ethz.ch  Mon Mar 27 15:25:37 2017
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 27 Mar 2017 15:25:37 +0200
Subject: [R-pkg-devel] multiple bibentry()s in CITATION
In-Reply-To: <ACD1644AA6C67E4FBD0C350625508EC8365C289F@FHSDB2D11-2.csu.mcmaster.ca>
References: <ACD1644AA6C67E4FBD0C350625508EC836572E5C@FHSDB2D11-2.csu.mcmaster.ca>
	<22652.57435.512098.137246@stat.math.ethz.ch>
	<ACD1644AA6C67E4FBD0C350625508EC8365C289F@FHSDB2D11-2.csu.mcmaster.ca>
Message-ID: <22745.4817.144245.205895@stat.math.ethz.ch>

>>>>> Fox, John <jfox at mcmaster.ca>
>>>>>     on Mon, 16 Jan 2017 15:44:05 +0000 writes:

    > Dear Martin,
    > Thanks for addressing this question, if belatedly!

    > After a little bit of thought, perhaps a default somewhere between 1 and Inf makes sense, along with an additional argument to citation: citation(package="pkg", bibtex.max=n), with default bibtex.max= getOption("citation.bibtex.max"), where the citation.bibtex.max option is initially set to something like 4. If the number of available citations exceeds bibtex.max, then a message like "there are additional BiBTeX citations, enter 'citation(package="pkg", bibtex.max=Inf)' to see all of them."

In the mean time, I have always used my proposed change.
I think any number between 1 and Inf is so much arbitrary that
inspite of your good thoughts I kept the *new* default at Inf.

and because of this open question, I have forgotten to commit
the change to the development version of R !

I have done so now, however not ported it yet to  "R 3.4.0 alpha".
If not much surfaces (in CRAN / Bioc checks), we may port it in
time for 3.4.0.


Martin

    > Best,
    > John

    >> -----Original Message-----
    >> From: Martin Maechler [mailto:maechler at stat.math.ethz.ch]
    >> Sent: Monday, January 16, 2017 10:02 AM
    >> To: Fox, John <jfox at mcmaster.ca>
    >> Cc: r-package-devel at r-project.org
    >> Subject: Re: [R-pkg-devel] multiple bibentry()s in CITATION
    >> 
    >> >>>>> Fox, John <jfox at mcmaster.ca>
    >> >>>>>     on Fri, 2 Sep 2016 15:42:46 +0000 writes:
    >> 
    >> (which is more than 4 months ago)
    >> 
    >> > Dear list members,
    >> > I've noticed that citation(package="pkg") generates both a text
    >> citation and a BiBTeX entry when the CITATION file contains a single
    >> call to bibentry() or citEntry(), but that only text citations are shown
    >> if there are multiple calls to bibentry() or citEntry().
    >> 
    >> > Is this behaviour intentional? In my opinion, it's useful always
    >> to show the BiBTeX (although it's available through
    >> toBibtex(citation(package="pkg")) ).
    >> 
    >> > The Writing R Extensions manual says, "A CITATION file will
    >> contain *calls* [my emphasis] to function bibentry."
    >> 
    >> > Thanks,
    >> > John
    >> 
    >> and you did not get a reply....
    >> I had wanted but forgotten about it ... two parts :
    >> 
    >> 1)  On November 24, 2012,  I had improved R with an option to get this
    >> so this has been a "hidden gem" ;-) for a while in R:
    >> 
    >> > options(citation.bibtex.max = Inf)
    >> > citation(package = "Rcmdr")
    >> 
    >> To cite the 'Rcmdr' package in publications use:
    >> 
    >> Fox, J., and Bouchet-Valat, M. (2017). Rcmdr: R Commander. R package
    >> version 2.3-2.
    >> 
    >> A BibTeX entry for LaTeX users is
    >> 
    >> @Manual{,
    >> title = {{Rcmdr: R Commander}},
    >> author = {John Fox and Milan Bouchet-Valat},
    >> year = {2017},
    >> note = {R package version 2.3-2},
    >> url = {http://socserv.socsci.mcmaster.ca/jfox/Misc/Rcmdr/},
    >> }
    >> 
    >> Fox, J. (2017). Using the R Commander: A Point-and-Click Interface or
    >> R. Boca Raton FL:
    >> Chapman and Hall/CRC Press.
    >> 
    >> A BibTeX entry for LaTeX users is
    >> 
    >> @Book{,
    >> title = {Using the {R Commander}: A Point-and-Click Interface for
    >> {R}},
    >> author = {John Fox},
    >> year = {2017},
    >> publisher = {Chapman and Hall/CRC Press},
    >> address = {Boca Raton {FL}},
    >> url = {http://socserv.mcmaster.ca/jfox/Books/RCommander/},
    >> }
    >> 
    >> Fox, J. (2005). The R Commander: A Basic Statistics Graphical User
    >> Interface to R.
    >> Journal of Statistical Software, 14(9): 1--42.
    >> 
    >> A BibTeX entry for LaTeX users is
    >> 
    >> @Article{,
    >> title = {The {R} {C}ommander: A Basic Statistics Graphical User
    >> Interface to {R}},
    >> author = {John Fox},
    >> year = {2005},
    >> journal = {Journal of Statistical Software},
    >> volume = {14},
    >> number = {9},
    >> pages = {1--42},
    >> url = {http://www.jstatsoft.org/v14/i09},
    >> }
    >> 
    >> >
    >> ----------------
    >> 
    >> This all works "obviously" (;-) via utils:::format.bibentry () and even
    >> when I had made the number one an argument to that function with a
    >> default you can set via options(),  I had wondered a bit  why the cutoff
    >> should by default be at one.
    >> 
    >> E.g., it looks strange that by *adding* a 2nd reference, you get shorter
    >> citation output.... and to me it would seem more coherent to have the
    >> default rather be 'Inf' instead of '1',  i.e. always showing both text
    >> and bibtex.
    >> 
    >> There is quite a difference though: For our copula package, e.g.,
    >> 
    >> > options(citation.bibtex.max = 1); citation(package = "copula")
    >> 
    >> To cite the R package copula in publications use:
    >> 
    >> Marius Hofert, Ivan Kojadinovic, Martin Maechler and Jun Yan (2017).
    >> copula:
    >> Multivariate Dependence with Copulas. R package version 0.999-16 URL
    >> https://CRAN.R-project.org/package=copula
    >> 
    >> Jun Yan (2007). Enjoy the Joy of Copulas: With a Package copula.
    >> Journal of Statistical
    >> Software, 21(4), 1-21. URLhttp://www.jstatsoft.org/v21/i04/.
    >> 
    >> Ivan Kojadinovic, Jun Yan (2010). Modeling Multivariate Distributions
    >> with Continuous
    >> Margins Using the copula R Package. Journal of Statistical Software,
    >> 34(9), 1-20. URL
    >> http://www.jstatsoft.org/v34/i09/.
    >> 
    >> Marius Hofert, Martin Maechler (2011). Nested Archimedean Copulas Meet
    >> R: The nacopula
    >> Package. Journal of Statistical Software, 39(9), 1-20. URL
    >> http://www.jstatsoft.org/v39/i09/.
    >> 
    >> >
    >> 
    >> This is relatively compact (18 lines)
    >> whereas it gives  67 lines of output when the option is set to something
    >> >= 4.
    >> 
    >> Other opinions?
    >> What do you think, would it be worth the compatibility break to change
    >> the default from '1' to 'Inf' ?
    >> 
    >> Best regards,
    >> Martin


From kasperdanielhansen at gmail.com  Mon Mar 27 16:38:12 2017
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Mon, 27 Mar 2017 08:38:12 -0600
Subject: [R-pkg-devel] multiple bibentry()s in CITATION
In-Reply-To: <22745.4817.144245.205895@stat.math.ethz.ch>
References: <ACD1644AA6C67E4FBD0C350625508EC836572E5C@FHSDB2D11-2.csu.mcmaster.ca>
	<22652.57435.512098.137246@stat.math.ethz.ch>
	<ACD1644AA6C67E4FBD0C350625508EC8365C289F@FHSDB2D11-2.csu.mcmaster.ca>
	<22745.4817.144245.205895@stat.math.ethz.ch>
Message-ID: <CAC2h7ut5bQ5pwEViOoGdf-v=p3smq3nQkSLi4f0=Vx4xoN--3w@mail.gmail.com>

Thanks.  It would be great to have this working in 3.4.  In Bioc there are
multiple packages with CITATION files with multiple entries, one such
example is minfi
  bioconductor.org/packages/minfi

On my wishlist is that it would be great to have support for printing the
header field which many people use to give a context for the citation. This
is important because when you list multiple papers you need (I think) some
explanation for when to cite the different ones.

Best,
Kasper

On Mon, Mar 27, 2017 at 7:25 AM, Martin Maechler <maechler at stat.math.ethz.ch
> wrote:

> >>>>> Fox, John <jfox at mcmaster.ca>
> >>>>>     on Mon, 16 Jan 2017 15:44:05 +0000 writes:
>
>     > Dear Martin,
>     > Thanks for addressing this question, if belatedly!
>
>     > After a little bit of thought, perhaps a default somewhere between 1
> and Inf makes sense, along with an additional argument to citation:
> citation(package="pkg", bibtex.max=n), with default bibtex.max=
> getOption("citation.bibtex.max"), where the citation.bibtex.max option is
> initially set to something like 4. If the number of available citations
> exceeds bibtex.max, then a message like "there are additional BiBTeX
> citations, enter 'citation(package="pkg", bibtex.max=Inf)' to see all of
> them."
>
> In the mean time, I have always used my proposed change.
> I think any number between 1 and Inf is so much arbitrary that
> inspite of your good thoughts I kept the *new* default at Inf.
>
> and because of this open question, I have forgotten to commit
> the change to the development version of R !
>
> I have done so now, however not ported it yet to  "R 3.4.0 alpha".
> If not much surfaces (in CRAN / Bioc checks), we may port it in
> time for 3.4.0.
>
>
> Martin
>
>     > Best,
>     > John
>
>     >> -----Original Message-----
>     >> From: Martin Maechler [mailto:maechler at stat.math.ethz.ch]
>     >> Sent: Monday, January 16, 2017 10:02 AM
>     >> To: Fox, John <jfox at mcmaster.ca>
>     >> Cc: r-package-devel at r-project.org
>     >> Subject: Re: [R-pkg-devel] multiple bibentry()s in CITATION
>     >>
>     >> >>>>> Fox, John <jfox at mcmaster.ca>
>     >> >>>>>     on Fri, 2 Sep 2016 15:42:46 +0000 writes:
>     >>
>     >> (which is more than 4 months ago)
>     >>
>     >> > Dear list members,
>     >> > I've noticed that citation(package="pkg") generates both a text
>     >> citation and a BiBTeX entry when the CITATION file contains a single
>     >> call to bibentry() or citEntry(), but that only text citations are
> shown
>     >> if there are multiple calls to bibentry() or citEntry().
>     >>
>     >> > Is this behaviour intentional? In my opinion, it's useful always
>     >> to show the BiBTeX (although it's available through
>     >> toBibtex(citation(package="pkg")) ).
>     >>
>     >> > The Writing R Extensions manual says, "A CITATION file will
>     >> contain *calls* [my emphasis] to function bibentry."
>     >>
>     >> > Thanks,
>     >> > John
>     >>
>     >> and you did not get a reply....
>     >> I had wanted but forgotten about it ... two parts :
>     >>
>     >> 1)  On November 24, 2012,  I had improved R with an option to get
> this
>     >> so this has been a "hidden gem" ;-) for a while in R:
>     >>
>     >> > options(citation.bibtex.max = Inf)
>     >> > citation(package = "Rcmdr")
>     >>
>     >> To cite the 'Rcmdr' package in publications use:
>     >>
>     >> Fox, J., and Bouchet-Valat, M. (2017). Rcmdr: R Commander. R package
>     >> version 2.3-2.
>     >>
>     >> A BibTeX entry for LaTeX users is
>     >>
>     >> @Manual{,
>     >> title = {{Rcmdr: R Commander}},
>     >> author = {John Fox and Milan Bouchet-Valat},
>     >> year = {2017},
>     >> note = {R package version 2.3-2},
>     >> url = {http://socserv.socsci.mcmaster.ca/jfox/Misc/Rcmdr/},
>     >> }
>     >>
>     >> Fox, J. (2017). Using the R Commander: A Point-and-Click Interface
> or
>     >> R. Boca Raton FL:
>     >> Chapman and Hall/CRC Press.
>     >>
>     >> A BibTeX entry for LaTeX users is
>     >>
>     >> @Book{,
>     >> title = {Using the {R Commander}: A Point-and-Click Interface for
>     >> {R}},
>     >> author = {John Fox},
>     >> year = {2017},
>     >> publisher = {Chapman and Hall/CRC Press},
>     >> address = {Boca Raton {FL}},
>     >> url = {http://socserv.mcmaster.ca/jfox/Books/RCommander/},
>     >> }
>     >>
>     >> Fox, J. (2005). The R Commander: A Basic Statistics Graphical User
>     >> Interface to R.
>     >> Journal of Statistical Software, 14(9): 1--42.
>     >>
>     >> A BibTeX entry for LaTeX users is
>     >>
>     >> @Article{,
>     >> title = {The {R} {C}ommander: A Basic Statistics Graphical User
>     >> Interface to {R}},
>     >> author = {John Fox},
>     >> year = {2005},
>     >> journal = {Journal of Statistical Software},
>     >> volume = {14},
>     >> number = {9},
>     >> pages = {1--42},
>     >> url = {http://www.jstatsoft.org/v14/i09},
>     >> }
>     >>
>     >> >
>     >> ----------------
>     >>
>     >> This all works "obviously" (;-) via utils:::format.bibentry () and
> even
>     >> when I had made the number one an argument to that function with a
>     >> default you can set via options(),  I had wondered a bit  why the
> cutoff
>     >> should by default be at one.
>     >>
>     >> E.g., it looks strange that by *adding* a 2nd reference, you get
> shorter
>     >> citation output.... and to me it would seem more coherent to have
> the
>     >> default rather be 'Inf' instead of '1',  i.e. always showing both
> text
>     >> and bibtex.
>     >>
>     >> There is quite a difference though: For our copula package, e.g.,
>     >>
>     >> > options(citation.bibtex.max = 1); citation(package = "copula")
>     >>
>     >> To cite the R package copula in publications use:
>     >>
>     >> Marius Hofert, Ivan Kojadinovic, Martin Maechler and Jun Yan (2017).
>     >> copula:
>     >> Multivariate Dependence with Copulas. R package version 0.999-16 URL
>     >> https://CRAN.R-project.org/package=copula
>     >>
>     >> Jun Yan (2007). Enjoy the Joy of Copulas: With a Package copula.
>     >> Journal of Statistical
>     >> Software, 21(4), 1-21. URLhttp://www.jstatsoft.org/v21/i04/.
>     >>
>     >> Ivan Kojadinovic, Jun Yan (2010). Modeling Multivariate
> Distributions
>     >> with Continuous
>     >> Margins Using the copula R Package. Journal of Statistical Software,
>     >> 34(9), 1-20. URL
>     >> http://www.jstatsoft.org/v34/i09/.
>     >>
>     >> Marius Hofert, Martin Maechler (2011). Nested Archimedean Copulas
> Meet
>     >> R: The nacopula
>     >> Package. Journal of Statistical Software, 39(9), 1-20. URL
>     >> http://www.jstatsoft.org/v39/i09/.
>     >>
>     >> >
>     >>
>     >> This is relatively compact (18 lines)
>     >> whereas it gives  67 lines of output when the option is set to
> something
>     >> >= 4.
>     >>
>     >> Other opinions?
>     >> What do you think, would it be worth the compatibility break to
> change
>     >> the default from '1' to 'Inf' ?
>     >>
>     >> Best regards,
>     >> Martin
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From jfox at mcmaster.ca  Mon Mar 27 17:12:30 2017
From: jfox at mcmaster.ca (Fox, John)
Date: Mon, 27 Mar 2017 15:12:30 +0000
Subject: [R-pkg-devel] multiple bibentry()s in CITATION
In-Reply-To: <22745.4817.144245.205895@stat.math.ethz.ch>
References: <ACD1644AA6C67E4FBD0C350625508EC836572E5C@FHSDB2D11-2.csu.mcmaster.ca>
	<22652.57435.512098.137246@stat.math.ethz.ch>
	<ACD1644AA6C67E4FBD0C350625508EC8365C289F@FHSDB2D11-2.csu.mcmaster.ca>
	<22745.4817.144245.205895@stat.math.ethz.ch>
Message-ID: <ACD1644AA6C67E4FBD0C350625508EC836621911@FHSDB2D11-2.csu.mcmaster.ca>

Dear Martin,

Thanks for following up on this.

Best,
 John

> -----Original Message-----
> From: Martin Maechler [mailto:maechler at stat.math.ethz.ch]
> Sent: March 27, 2017 9:26 AM
> To: Fox, John <jfox at mcmaster.ca>
> Cc: Martin Maechler <maechler at stat.math.ethz.ch>; r-package-devel at r-
> project.org
> Subject: RE: [R-pkg-devel] multiple bibentry()s in CITATION
> 
> >>>>> Fox, John <jfox at mcmaster.ca>
> >>>>>     on Mon, 16 Jan 2017 15:44:05 +0000 writes:
> 
>     > Dear Martin,
>     > Thanks for addressing this question, if belatedly!
> 
>     > After a little bit of thought, perhaps a default somewhere between 1 and
> Inf makes sense, along with an additional argument to citation:
> citation(package="pkg", bibtex.max=n), with default bibtex.max=
> getOption("citation.bibtex.max"), where the citation.bibtex.max option is
> initially set to something like 4. If the number of available citations exceeds
> bibtex.max, then a message like "there are additional BiBTeX citations, enter
> 'citation(package="pkg", bibtex.max=Inf)' to see all of them."
> 
> In the mean time, I have always used my proposed change.
> I think any number between 1 and Inf is so much arbitrary that inspite of your
> good thoughts I kept the *new* default at Inf.
> 
> and because of this open question, I have forgotten to commit the change to
> the development version of R !
> 
> I have done so now, however not ported it yet to  "R 3.4.0 alpha".
> If not much surfaces (in CRAN / Bioc checks), we may port it in time for 3.4.0.
> 
> 
> Martin
> 
>     > Best,
>     > John
> 
>     >> -----Original Message-----
>     >> From: Martin Maechler [mailto:maechler at stat.math.ethz.ch]
>     >> Sent: Monday, January 16, 2017 10:02 AM
>     >> To: Fox, John <jfox at mcmaster.ca>
>     >> Cc: r-package-devel at r-project.org
>     >> Subject: Re: [R-pkg-devel] multiple bibentry()s in CITATION
>     >>
>     >> >>>>> Fox, John <jfox at mcmaster.ca>
>     >> >>>>>     on Fri, 2 Sep 2016 15:42:46 +0000 writes:
>     >>
>     >> (which is more than 4 months ago)
>     >>
>     >> > Dear list members,
>     >> > I've noticed that citation(package="pkg") generates both a text
>     >> citation and a BiBTeX entry when the CITATION file contains a single
>     >> call to bibentry() or citEntry(), but that only text citations are shown
>     >> if there are multiple calls to bibentry() or citEntry().
>     >>
>     >> > Is this behaviour intentional? In my opinion, it's useful always
>     >> to show the BiBTeX (although it's available through
>     >> toBibtex(citation(package="pkg")) ).
>     >>
>     >> > The Writing R Extensions manual says, "A CITATION file will
>     >> contain *calls* [my emphasis] to function bibentry."
>     >>
>     >> > Thanks,
>     >> > John
>     >>
>     >> and you did not get a reply....
>     >> I had wanted but forgotten about it ... two parts :
>     >>
>     >> 1)  On November 24, 2012,  I had improved R with an option to get this
>     >> so this has been a "hidden gem" ;-) for a while in R:
>     >>
>     >> > options(citation.bibtex.max = Inf)
>     >> > citation(package = "Rcmdr")
>     >>
>     >> To cite the 'Rcmdr' package in publications use:
>     >>
>     >> Fox, J., and Bouchet-Valat, M. (2017). Rcmdr: R Commander. R package
>     >> version 2.3-2.
>     >>
>     >> A BibTeX entry for LaTeX users is
>     >>
>     >> @Manual{,
>     >> title = {{Rcmdr: R Commander}},
>     >> author = {John Fox and Milan Bouchet-Valat},
>     >> year = {2017},
>     >> note = {R package version 2.3-2},
>     >> url = {http://socserv.socsci.mcmaster.ca/jfox/Misc/Rcmdr/},
>     >> }
>     >>
>     >> Fox, J. (2017). Using the R Commander: A Point-and-Click Interface or
>     >> R. Boca Raton FL:
>     >> Chapman and Hall/CRC Press.
>     >>
>     >> A BibTeX entry for LaTeX users is
>     >>
>     >> @Book{,
>     >> title = {Using the {R Commander}: A Point-and-Click Interface for
>     >> {R}},
>     >> author = {John Fox},
>     >> year = {2017},
>     >> publisher = {Chapman and Hall/CRC Press},
>     >> address = {Boca Raton {FL}},
>     >> url = {http://socserv.mcmaster.ca/jfox/Books/RCommander/},
>     >> }
>     >>
>     >> Fox, J. (2005). The R Commander: A Basic Statistics Graphical User
>     >> Interface to R.
>     >> Journal of Statistical Software, 14(9): 1--42.
>     >>
>     >> A BibTeX entry for LaTeX users is
>     >>
>     >> @Article{,
>     >> title = {The {R} {C}ommander: A Basic Statistics Graphical User
>     >> Interface to {R}},
>     >> author = {John Fox},
>     >> year = {2005},
>     >> journal = {Journal of Statistical Software},
>     >> volume = {14},
>     >> number = {9},
>     >> pages = {1--42},
>     >> url = {http://www.jstatsoft.org/v14/i09},
>     >> }
>     >>
>     >> >
>     >> ----------------
>     >>
>     >> This all works "obviously" (;-) via utils:::format.bibentry () and even
>     >> when I had made the number one an argument to that function with a
>     >> default you can set via options(),  I had wondered a bit  why the cutoff
>     >> should by default be at one.
>     >>
>     >> E.g., it looks strange that by *adding* a 2nd reference, you get shorter
>     >> citation output.... and to me it would seem more coherent to have the
>     >> default rather be 'Inf' instead of '1',  i.e. always showing both text
>     >> and bibtex.
>     >>
>     >> There is quite a difference though: For our copula package, e.g.,
>     >>
>     >> > options(citation.bibtex.max = 1); citation(package = "copula")
>     >>
>     >> To cite the R package copula in publications use:
>     >>
>     >> Marius Hofert, Ivan Kojadinovic, Martin Maechler and Jun Yan (2017).
>     >> copula:
>     >> Multivariate Dependence with Copulas. R package version 0.999-16 URL
>     >> https://CRAN.R-project.org/package=copula
>     >>
>     >> Jun Yan (2007). Enjoy the Joy of Copulas: With a Package copula.
>     >> Journal of Statistical
>     >> Software, 21(4), 1-21. URLhttp://www.jstatsoft.org/v21/i04/.
>     >>
>     >> Ivan Kojadinovic, Jun Yan (2010). Modeling Multivariate Distributions
>     >> with Continuous
>     >> Margins Using the copula R Package. Journal of Statistical Software,
>     >> 34(9), 1-20. URL
>     >> http://www.jstatsoft.org/v34/i09/.
>     >>
>     >> Marius Hofert, Martin Maechler (2011). Nested Archimedean Copulas
> Meet
>     >> R: The nacopula
>     >> Package. Journal of Statistical Software, 39(9), 1-20. URL
>     >> http://www.jstatsoft.org/v39/i09/.
>     >>
>     >> >
>     >>
>     >> This is relatively compact (18 lines)
>     >> whereas it gives  67 lines of output when the option is set to something
>     >> >= 4.
>     >>
>     >> Other opinions?
>     >> What do you think, would it be worth the compatibility break to change
>     >> the default from '1' to 'Inf' ?
>     >>
>     >> Best regards,
>     >> Martin


From kasperdanielhansen at gmail.com  Mon Mar 27 18:20:00 2017
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Mon, 27 Mar 2017 10:20:00 -0600
Subject: [R-pkg-devel] multiple bibentry()s in CITATION
In-Reply-To: <alpine.DEB.2.20.1703271656400.1902@paninaro>
References: <ACD1644AA6C67E4FBD0C350625508EC836572E5C@FHSDB2D11-2.csu.mcmaster.ca>
	<22652.57435.512098.137246@stat.math.ethz.ch>
	<ACD1644AA6C67E4FBD0C350625508EC8365C289F@FHSDB2D11-2.csu.mcmaster.ca>
	<22745.4817.144245.205895@stat.math.ethz.ch>
	<CAC2h7ut5bQ5pwEViOoGdf-v=p3smq3nQkSLi4f0=Vx4xoN--3w@mail.gmail.com>
	<alpine.DEB.2.20.1703271656400.1902@paninaro>
Message-ID: <CAC2h7utoKehGhrbafODuS+EALViPEaqxp0VtntQe7q4rZqp9rQ@mail.gmail.com>

I apologize for not being clear.  The printing of header depends on the
output style.  Indeed text works, but say
  print(citation("minfi"), style = "HTML")
does not.  Btw., I agree it might be nice to control the printing of header.

On Mon, Mar 27, 2017 at 9:07 AM, Achim Zeileis <Achim.Zeileis at uibk.ac.at>
wrote:

> On Mon, 27 Mar 2017, Kasper Daniel Hansen wrote:
>
> Thanks.  It would be great to have this working in 3.4.  In Bioc there are
>> multiple packages with CITATION files with multiple entries, one such
>> example is minfi
>>  bioconductor.org/packages/minfi
>>
>> On my wishlist is that it would be great to have support for printing the
>> header field which many people use to give a context for the citation. This
>> is important because when you list multiple papers you need (I think) some
>> explanation for when to cite the different ones.
>>
>
> But this is what citation("pkg_name") or print(bibentry_object, style =
> "citation") already do or am I missing something.
>
> I haven't installed "minfi" but just sourced the CITATION into an object x
> and the print(x, style = "citation") seemed to work as intended.
>
> But this is probably a good example where even adding four BibTeX items
> leads to scrolling even on console windows with many lines and columns. In
> these cases it would likely be better not to display any BibTeX and rather
> add a hint as to how the BibTeX can be obtained if desired. In addition to
> Martin's idea with 'citation(package="pkg", bibtex.max=Inf)' one could also
> use 'toBibtex(citation("pkg"))'. The latter, of course, only gives the
> BibTeX but again for long lists like the one in minfi it is probably more
> digestable in separate chunks...
>
> Best,
> Z
>
> Best,
>> Kasper
>>
>> On Mon, Mar 27, 2017 at 7:25 AM, Martin Maechler <
>> maechler at stat.math.ethz.ch
>>
>>> wrote:
>>>
>>
>> Fox, John <jfox at mcmaster.ca>
>>>>>>>>     on Mon, 16 Jan 2017 15:44:05 +0000 writes:
>>>>>>>>
>>>>>>>
>>>    > Dear Martin,
>>>    > Thanks for addressing this question, if belatedly!
>>>
>>>    > After a little bit of thought, perhaps a default somewhere between 1
>>> and Inf makes sense, along with an additional argument to citation:
>>> citation(package="pkg", bibtex.max=n), with default bibtex.max=
>>> getOption("citation.bibtex.max"), where the citation.bibtex.max option
>>> is
>>> initially set to something like 4. If the number of available citations
>>> exceeds bibtex.max, then a message like "there are additional BiBTeX
>>> citations, enter 'citation(package="pkg", bibtex.max=Inf)' to see all of
>>> them."
>>>
>>> In the mean time, I have always used my proposed change.
>>> I think any number between 1 and Inf is so much arbitrary that
>>> inspite of your good thoughts I kept the *new* default at Inf.
>>>
>>> and because of this open question, I have forgotten to commit
>>> the change to the development version of R !
>>>
>>> I have done so now, however not ported it yet to  "R 3.4.0 alpha".
>>> If not much surfaces (in CRAN / Bioc checks), we may port it in
>>> time for 3.4.0.
>>>
>>>
>>> Martin
>>>
>>>    > Best,
>>>    > John
>>>
>>>    >> -----Original Message-----
>>>    >> From: Martin Maechler [mailto:maechler at stat.math.ethz.ch]
>>>    >> Sent: Monday, January 16, 2017 10:02 AM
>>>    >> To: Fox, John <jfox at mcmaster.ca>
>>>    >> Cc: r-package-devel at r-project.org
>>>    >> Subject: Re: [R-pkg-devel] multiple bibentry()s in CITATION
>>>    >>
>>>    >>>>>>> Fox, John <jfox at mcmaster.ca>
>>>    >>>>>>>     on Fri, 2 Sep 2016 15:42:46 +0000 writes:
>>>    >>
>>>    >> (which is more than 4 months ago)
>>>    >>
>>>    >>> Dear list members,
>>>    >>> I've noticed that citation(package="pkg") generates both a text
>>>    >> citation and a BiBTeX entry when the CITATION file contains a
>>> single
>>>    >> call to bibentry() or citEntry(), but that only text citations are
>>> shown
>>>    >> if there are multiple calls to bibentry() or citEntry().
>>>    >>
>>>    >>> Is this behaviour intentional? In my opinion, it's useful always
>>>    >> to show the BiBTeX (although it's available through
>>>    >> toBibtex(citation(package="pkg")) ).
>>>    >>
>>>    >>> The Writing R Extensions manual says, "A CITATION file will
>>>    >> contain *calls* [my emphasis] to function bibentry."
>>>    >>
>>>    >>> Thanks,
>>>    >>> John
>>>    >>
>>>    >> and you did not get a reply....
>>>    >> I had wanted but forgotten about it ... two parts :
>>>    >>
>>>    >> 1)  On November 24, 2012,  I had improved R with an option to get
>>> this
>>>    >> so this has been a "hidden gem" ;-) for a while in R:
>>>    >>
>>>    >>> options(citation.bibtex.max = Inf)
>>>    >>> citation(package = "Rcmdr")
>>>    >>
>>>    >> To cite the 'Rcmdr' package in publications use:
>>>    >>
>>>    >> Fox, J., and Bouchet-Valat, M. (2017). Rcmdr: R Commander. R
>>> package
>>>    >> version 2.3-2.
>>>    >>
>>>    >> A BibTeX entry for LaTeX users is
>>>    >>
>>>    >> @Manual{,
>>>    >> title = {{Rcmdr: R Commander}},
>>>    >> author = {John Fox and Milan Bouchet-Valat},
>>>    >> year = {2017},
>>>    >> note = {R package version 2.3-2},
>>>    >> url = {http://socserv.socsci.mcmaster.ca/jfox/Misc/Rcmdr/},
>>>    >> }
>>>    >>
>>>    >> Fox, J. (2017). Using the R Commander: A Point-and-Click Interface
>>> or
>>>    >> R. Boca Raton FL:
>>>    >> Chapman and Hall/CRC Press.
>>>    >>
>>>    >> A BibTeX entry for LaTeX users is
>>>    >>
>>>    >> @Book{,
>>>    >> title = {Using the {R Commander}: A Point-and-Click Interface for
>>>    >> {R}},
>>>    >> author = {John Fox},
>>>    >> year = {2017},
>>>    >> publisher = {Chapman and Hall/CRC Press},
>>>    >> address = {Boca Raton {FL}},
>>>    >> url = {http://socserv.mcmaster.ca/jfox/Books/RCommander/},
>>>    >> }
>>>    >>
>>>    >> Fox, J. (2005). The R Commander: A Basic Statistics Graphical User
>>>    >> Interface to R.
>>>    >> Journal of Statistical Software, 14(9): 1--42.
>>>    >>
>>>    >> A BibTeX entry for LaTeX users is
>>>    >>
>>>    >> @Article{,
>>>    >> title = {The {R} {C}ommander: A Basic Statistics Graphical User
>>>    >> Interface to {R}},
>>>    >> author = {John Fox},
>>>    >> year = {2005},
>>>    >> journal = {Journal of Statistical Software},
>>>    >> volume = {14},
>>>    >> number = {9},
>>>    >> pages = {1--42},
>>>    >> url = {http://www.jstatsoft.org/v14/i09},
>>>    >> }
>>>    >>
>>>    >>>
>>>    >> ----------------
>>>    >>
>>>    >> This all works "obviously" (;-) via utils:::format.bibentry () and
>>> even
>>>    >> when I had made the number one an argument to that function with a
>>>    >> default you can set via options(),  I had wondered a bit  why the
>>> cutoff
>>>    >> should by default be at one.
>>>    >>
>>>    >> E.g., it looks strange that by *adding* a 2nd reference, you get
>>> shorter
>>>    >> citation output.... and to me it would seem more coherent to have
>>> the
>>>    >> default rather be 'Inf' instead of '1',  i.e. always showing both
>>> text
>>>    >> and bibtex.
>>>    >>
>>>    >> There is quite a difference though: For our copula package, e.g.,
>>>    >>
>>>    >>> options(citation.bibtex.max = 1); citation(package = "copula")
>>>    >>
>>>    >> To cite the R package copula in publications use:
>>>    >>
>>>    >> Marius Hofert, Ivan Kojadinovic, Martin Maechler and Jun Yan
>>> (2017).
>>>    >> copula:
>>>    >> Multivariate Dependence with Copulas. R package version 0.999-16
>>> URL
>>>    >> https://CRAN.R-project.org/package=copula
>>>    >>
>>>    >> Jun Yan (2007). Enjoy the Joy of Copulas: With a Package copula.
>>>    >> Journal of Statistical
>>>    >> Software, 21(4), 1-21. URLhttp://www.jstatsoft.org/v21/i04/.
>>>    >>
>>>    >> Ivan Kojadinovic, Jun Yan (2010). Modeling Multivariate
>>> Distributions
>>>    >> with Continuous
>>>    >> Margins Using the copula R Package. Journal of Statistical
>>> Software,
>>>    >> 34(9), 1-20. URL
>>>    >> http://www.jstatsoft.org/v34/i09/.
>>>    >>
>>>    >> Marius Hofert, Martin Maechler (2011). Nested Archimedean Copulas
>>> Meet
>>>    >> R: The nacopula
>>>    >> Package. Journal of Statistical Software, 39(9), 1-20. URL
>>>    >> http://www.jstatsoft.org/v39/i09/.
>>>    >>
>>>    >>>
>>>    >>
>>>    >> This is relatively compact (18 lines)
>>>    >> whereas it gives  67 lines of output when the option is set to
>>> something
>>>    >>>= 4.
>>>    >>
>>>    >> Other opinions?
>>>    >> What do you think, would it be worth the compatibility break to
>>> change
>>>    >> the default from '1' to 'Inf' ?
>>>    >>
>>>    >> Best regards,
>>>    >> Martin
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>>
>>

	[[alternative HTML version deleted]]


From paul.buerkner at gmail.com  Thu Mar 30 12:54:09 2017
From: paul.buerkner at gmail.com (Paul Buerkner)
Date: Thu, 30 Mar 2017 12:54:09 +0200
Subject: [R-pkg-devel] Problem in stats::model.matrix when omitting two-way
	interactions
Message-ID: <CAGoSky9NaN-URhGDRqyAJ_kkeW9bV_H6UfcNLqkozLtziAOySw@mail.gmail.com>

Hi all,

recently I stumbled upen a problem in stats::model.matrix that I think is
worth reporting.

When I run:

> dat <- data.frame(
>   y = rnorm(8),
>   x1 = factor(rep(0:1, each = 4)),
>   x2 = factor(rep(rep(0:1, each = 2), 2)),
>   x3 = factor(rep(0:1, 4))
> )
>
> stats::model.matrix(y ~ x1+x2+x3 + x1:x2:x3, dat)

I get a matrix with 12 columns, which are linearily dependent and thus not
identified in a linear model:

> summary(lm(y ~  x1+x2+x3 + x1:x2:x3, dat))

Of course, there is usually no need for such a formula that ignores the
two-way interactions, but from my point of view, model.matrix should still
return only 8 columns (or less) in order to produce identified models.

I wonder if this is some sort of intendend behavior or just a side effect
of the way model.matrix handles factors.

Many thanks in advance.

Paul

	[[alternative HTML version deleted]]


From jfox at mcmaster.ca  Thu Mar 30 19:41:33 2017
From: jfox at mcmaster.ca (Fox, John)
Date: Thu, 30 Mar 2017 17:41:33 +0000
Subject: [R-pkg-devel] Problem in stats::model.matrix when omitting
 two-way	interactions
In-Reply-To: <CAGoSky9NaN-URhGDRqyAJ_kkeW9bV_H6UfcNLqkozLtziAOySw@mail.gmail.com>
References: <CAGoSky9NaN-URhGDRqyAJ_kkeW9bV_H6UfcNLqkozLtziAOySw@mail.gmail.com>
Message-ID: <ACD1644AA6C67E4FBD0C350625508EC836622AA9@FHSDB2D11-2.csu.mcmaster.ca>

Dear Paul,

Isn't this really a question for r-help rather than r-package-devel?

In any event, I think that your message is based on (an entirely understandable) misunderstanding of what the : operator on the right-hand side of a model formula does. The : operator is equivalent to %in%, and used as you have will produce a nested model structure. If you insure that all lower-order terms (i.e., all terms marginal to an interaction) are present, : may be used to create interactions, but as a general matter formulas do not like to create model matrices that violate marginality.

Consider the following simplified (equivalent) examples, using your "data":

---------- snip --------------

> cbind(dat[, 2:3], stats::model.matrix(y ~ x1 + x1:x2, dat))
  x1 x2 (Intercept) x11 x10:x21 x11:x21
1  0  0           1   0       0       0
2  0  0           1   0       0       0
3  0  1           1   0       1       0
4  0  1           1   0       1       0
5  1  0           1   1       0       0
6  1  0           1   1       0       0
7  1  1           1   1       0       1
8  1  1           1   1       0       1
> 
> cbind(dat[, 2:3], stats::model.matrix(y ~ x1 + x2 %in% x1, dat))
  x1 x2 (Intercept) x11 x10:x21 x11:x21
1  0  0           1   0       0       0
2  0  0           1   0       0       0
3  0  1           1   0       1       0
4  0  1           1   0       1       0
5  1  0           1   1       0       0
6  1  0           1   1       0       0
7  1  1           1   1       0       1
8  1  1           1   1       0       1
> 
> cbind(dat[, 2:3], stats::model.matrix(y ~ x1/x2, dat))
  x1 x2 (Intercept) x11 x10:x21 x11:x21
1  0  0           1   0       0       0
2  0  0           1   0       0       0
3  0  1           1   0       1       0
4  0  1           1   0       1       0
5  1  0           1   1       0       0
6  1  0           1   1       0       0
7  1  1           1   1       0       1
8  1  1           1   1       0       1

---------- snip --------------

In the first two cases, reversing the order of the operands, x2:x1 and x2 %in% x1, would also produce the same results.

I hope this helps,
 John

-----------------------------
John Fox, Professor
McMaster University
Hamilton, Ontario
Canada L8S 4M4
Web: socserv.mcmaster.ca/jfox



> -----Original Message-----
> From: R-package-devel [mailto:r-package-devel-bounces at r-project.org] On
> Behalf Of Paul Buerkner
> Sent: March 30, 2017 6:54 AM
> To: r-package-devel at r-project.org
> Subject: [R-pkg-devel] Problem in stats::model.matrix when omitting two-
> way interactions
> 
> Hi all,
> 
> recently I stumbled upen a problem in stats::model.matrix that I think is
> worth reporting.
> 
> When I run:
> 
> > dat <- data.frame(
> >   y = rnorm(8),
> >   x1 = factor(rep(0:1, each = 4)),
> >   x2 = factor(rep(rep(0:1, each = 2), 2)),
> >   x3 = factor(rep(0:1, 4))
> > )
> >
> > stats::model.matrix(y ~ x1+x2+x3 + x1:x2:x3, dat)
> 
> I get a matrix with 12 columns, which are linearily dependent and thus not
> identified in a linear model:
> 
> > summary(lm(y ~  x1+x2+x3 + x1:x2:x3, dat))
> 
> Of course, there is usually no need for such a formula that ignores the two-
> way interactions, but from my point of view, model.matrix should still return
> only 8 columns (or less) in order to produce identified models.
> 
> I wonder if this is some sort of intendend behavior or just a side effect of the
> way model.matrix handles factors.
> 
> Many thanks in advance.
> 
> Paul
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From avraham.adler at gmail.com  Fri Mar 31 18:09:39 2017
From: avraham.adler at gmail.com (Avraham Adler)
Date: Fri, 31 Mar 2017 12:09:39 -0400
Subject: [R-pkg-devel] Solaris SPARC, Fortran, and logical errors?
In-Reply-To: <CAF8bMcZGJ6BOhcz3crzX1BEuoePyQvNe7An0oNBhV5Wcgontxw@mail.gmail.com>
References: <CAL6gwnLk3tNDgbfSv9hOa8snOj+VXV1g3FjkSAzLKosq_cm2Rg@mail.gmail.com>
	<CAF8bMcZGJ6BOhcz3crzX1BEuoePyQvNe7An0oNBhV5Wcgontxw@mail.gmail.com>
Message-ID: <CAL6gwnL2U1bw6au779tQk1wXSUnMNc-KpGaC7YDaw6+7EbUeFQ@mail.gmail.com>

On Wed, Mar 15, 2017 at 12:19 PM, William Dunlap <wdunlap at tibco.com> wrote:
> I don't know about the current Sparc Fortran compilers, but over the
> years have learned not to try to pass logicals and character strings
> between C and Fortran.  I have seen Fortran compilers that treated
> integer -1 (all bits 1) as .true. and anything else as .false. and I
> have see ones that looked only at bit 7, counting from the right, to
> determine the value.
>
> I recommend changing your Fortran code to accept an integer instead of
> a logical for boolean inputs and outputs.

Posting for posterity's and future similar questions' sakes [1], I am
relieved to find that removing reliance on the Fortran 2003
ISO_C_binding of c_bool, casting logicals explicitly as integers of 0
or 1, and testing for those integers in Fortran, seems to have finally
sated the SPARCmonster's appetite. [2]

Thank you very much!

Avi

[1] https://xkcd.com/979/
[2] https://cran.r-project.org/web/checks/check_results_Delaporte.html
- Version 6.0.0


