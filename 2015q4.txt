From dstr7320 at uni.sydney.edu.au  Thu Oct  1 02:00:05 2015
From: dstr7320 at uni.sydney.edu.au (Dario Strbenac)
Date: Thu, 1 Oct 2015 00:00:05 +0000
Subject: [R-pkg-devel] Formals of S4 Function
Message-ID: <SN1PR0101MB14394755E0037FDCAC69087BCD4D0@SN1PR0101MB1439.prod.exchangelabs.com>

Good day,

Is it still planned that there will be a new method for determining formals implemented for R 3.3 or enhancing the current formals method to work seamlessly on S4 functions ?  http://r.789695.n4.nabble.com/Q-Get-formal-arguments-of-my-implemented-S4-method-td4702420.html I am currently developing a package and one of my design choices would be based on the near-term availability of this feature.

--------------------------------------
Dario Strbenac
PhD Student
University of Sydney
Camperdown NSW 2050
Australia

From famuvie at gmail.com  Tue Oct  6 11:41:23 2015
From: famuvie at gmail.com (=?UTF-8?Q?Facundo_Mu=c3=b1oz?=)
Date: Tue, 6 Oct 2015 11:41:23 +0200
Subject: [R-pkg-devel] src/install.libs.R
Message-ID: <56139743.6080203@gmail.com>

Dear all,

I need to make use of the |src/install.libs.R| file, in order to perform
certain tasks at installation time.
I followed the R-exts doc
<http://cran.univ-paris1.fr/doc/manuals/r-release/R-exts.html#Package-subdirectories>.
However, R CMD INSTALL seems to never run the script.

Here is a minimal reproducible example.
It makes use of |devtools| to simplify the example, but I have tried the
installation manually as well.

|## Create a minimal buildable package library(devtools)
create('testpkg') ## Write src/install.libs.R dir.create('testpkg/src')
test.file <- path.expand('~/testfile.txt') diag.lines <- c(
deparse(quote(stop('This should break the installation'))),
deparse(quote(file.create(test.file))) ) writeLines(diag.lines,
'testpkg/src/install.libs.R') ## Install package ## also tried manually
with R CMD INSTALL install('testpkg') ## The installation did not break
## nor the file has been created file.exists('~/testfile.txt') # FALSE
## Cleanup remove.packages('testpkg') unlink('testpkg', recursive = TRUE) |

Am I missing something?

thanks in advance
?acu.-

PS: by the way?

|> sessionInfo() R version 3.2.2 (2015-08-14) Platform:
x86_64-pc-linux-gnu (64-bit) Running under: Ubuntu 14.04.2 LTS locale:
[1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C LC_TIME=en_US.UTF-8
LC_COLLATE=en_US.UTF-8 [5] LC_MONETARY=fr_FR.UTF-8
LC_MESSAGES=en_US.UTF-8 LC_PAPER=fr_FR.UTF-8 LC_NAME=C [9] LC_ADDRESS=C
LC_TELEPHONE=C LC_MEASUREMENT=fr_FR.UTF-8 LC_IDENTIFICATION=C attached
base packages: [1] stats graphics grDevices utils datasets methods base
other attached packages: [1] devtools_1.8.0.9000 loaded via a namespace
(and not attached): [1] tools_3.2.2 memoise_0.2.1 digest_0.6.8 |

?

	[[alternative HTML version deleted]]


From henrik.bengtsson at ucsf.edu  Thu Oct  8 02:37:10 2015
From: henrik.bengtsson at ucsf.edu (Henrik Bengtsson)
Date: Wed, 7 Oct 2015 17:37:10 -0700
Subject: [R-pkg-devel] Format/parser for NEWS (not NEWS.Rd)?
Message-ID: <CAFDcVCTdAJn8exdnw-y9D7fJCy7=LEVxAOCmCbr1is14ZTihDA@mail.gmail.com>

Hi,

I'm looking for a parser of the plain text NEWS format (not the
NEWS.Rd format) - ideally the same on that is used by R itself.  Does
anyone know which that one is / of such at tool?

Thanks,

Henrik

PS. help("news") mentions tools:::news2Rd(), but that's actually
defunct (just reported
https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=16556).


From bob at rudis.net  Thu Oct  8 03:40:02 2015
From: bob at rudis.net (boB Rudis)
Date: Wed, 7 Oct 2015 21:40:02 -0400
Subject: [R-pkg-devel] Format/parser for NEWS (not NEWS.Rd)?
In-Reply-To: <CAFDcVCTdAJn8exdnw-y9D7fJCy7=LEVxAOCmCbr1is14ZTihDA@mail.gmail.com>
References: <CAFDcVCTdAJn8exdnw-y9D7fJCy7=LEVxAOCmCbr1is14ZTihDA@mail.gmail.com>
Message-ID: <CAJ4QxaMTOK4mNn3KLXWXPrAXvx=44i+n_UxHX3ESUkK-ymEyxg@mail.gmail.com>

Try looking at the source for tools:::.news_reader_default and then tools::toRd

On Wed, Oct 7, 2015 at 8:37 PM, Henrik Bengtsson
<henrik.bengtsson at ucsf.edu> wrote:
> Hi,
>
> I'm looking for a parser of the plain text NEWS format (not the
> NEWS.Rd format) - ideally the same on that is used by R itself.  Does
> anyone know which that one is / of such at tool?
>
> Thanks,
>
> Henrik
>
> PS. help("news") mentions tools:::news2Rd(), but that's actually
> defunct (just reported
> https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=16556).
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From bpbond at gmail.com  Thu Oct  8 14:06:41 2015
From: bpbond at gmail.com (Ben Bond-Lamberty)
Date: Thu, 8 Oct 2015 08:06:41 -0400
Subject: [R-pkg-devel] Diagnosing error on CRAN's old R, old Windows
Message-ID: <CAGg1N9LWAcw_QL51mmZNjMimAi2wGF5e-wV8D8Gg=Ci0cPjNUw@mail.gmail.com>

Dear list,

My recent package was accepted and posted by CRAN, but the check
results (https://cran.r-project.org/web/checks/check_results_luzlogr.html)
show an error for flavor 'r-oldrel-windows-ix86+x86_64'. Everything
else passes fine. Unfortunately the error diagnostics are not
particularly helpful, only showing that four tests failed; the only
common thread I see, maybe, is that all four tests--and no others--use
R's file.size() function.

Any suggestions on figuring out what's going on? Is this necessary to
fix? I'd rather not track down an old Windows machine and install an
old R release on it just to debug, though will if necessary.

Thanks,

Ben


From murdoch.duncan at gmail.com  Thu Oct  8 14:43:27 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 8 Oct 2015 08:43:27 -0400
Subject: [R-pkg-devel] Diagnosing error on CRAN's old R, old Windows
In-Reply-To: <CAGg1N9LWAcw_QL51mmZNjMimAi2wGF5e-wV8D8Gg=Ci0cPjNUw@mail.gmail.com>
References: <CAGg1N9LWAcw_QL51mmZNjMimAi2wGF5e-wV8D8Gg=Ci0cPjNUw@mail.gmail.com>
Message-ID: <561664EF.2070002@gmail.com>

On 08/10/2015 8:06 AM, Ben Bond-Lamberty wrote:
> Dear list,
> 
> My recent package was accepted and posted by CRAN, but the check
> results (https://cran.r-project.org/web/checks/check_results_luzlogr.html)
> show an error for flavor 'r-oldrel-windows-ix86+x86_64'. Everything
> else passes fine. Unfortunately the error diagnostics are not
> particularly helpful, only showing that four tests failed; the only
> common thread I see, maybe, is that all four tests--and no others--use
> R's file.size() function.
> 
> Any suggestions on figuring out what's going on? Is this necessary to
> fix? I'd rather not track down an old Windows machine and install an
> old R release on it just to debug, though will if necessary.

Those errors came in your own test script, so you should be able to make
the messages more informative.  Don't blame CRAN for that.

You shouldn't need an old Windows machine, just an old release of R.
The result script shows that R-oldrel is 3.1.3; a binary for that is
available on CRAN.  (Of course, it's possible that the error is specific
to the version of Windows on the CRAN machine, but it's pretty easy to
find out if the problem is reproducible on whatever Windows machine you
do have.)

Duncan Murdoch


From bpbond at gmail.com  Thu Oct  8 15:57:10 2015
From: bpbond at gmail.com (Ben Bond-Lamberty)
Date: Thu, 8 Oct 2015 09:57:10 -0400
Subject: [R-pkg-devel] Diagnosing error on CRAN's old R, old Windows
In-Reply-To: <561664EF.2070002@gmail.com>
References: <CAGg1N9LWAcw_QL51mmZNjMimAi2wGF5e-wV8D8Gg=Ci0cPjNUw@mail.gmail.com>
	<561664EF.2070002@gmail.com>
Message-ID: <CAGg1N9LU9iWxuixopK2pSENU2ue3LPcHoAFWmRFKbvTHuU75VA@mail.gmail.com>

My intent wasn't particularly to blame CRAN, just puzzlement that a
normally-chatty test script is silently dying in this one case.
Anyway, thanks for the advice.
Ben



On Thu, Oct 8, 2015 at 8:43 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> On 08/10/2015 8:06 AM, Ben Bond-Lamberty wrote:
>> Dear list,
>>
>> My recent package was accepted and posted by CRAN, but the check
>> results (https://cran.r-project.org/web/checks/check_results_luzlogr.html)
>> show an error for flavor 'r-oldrel-windows-ix86+x86_64'. Everything
>> else passes fine. Unfortunately the error diagnostics are not
>> particularly helpful, only showing that four tests failed; the only
>> common thread I see, maybe, is that all four tests--and no others--use
>> R's file.size() function.
>>
>> Any suggestions on figuring out what's going on? Is this necessary to
>> fix? I'd rather not track down an old Windows machine and install an
>> old R release on it just to debug, though will if necessary.
>
> Those errors came in your own test script, so you should be able to make
> the messages more informative.  Don't blame CRAN for that.
>
> You shouldn't need an old Windows machine, just an old release of R.
> The result script shows that R-oldrel is 3.1.3; a binary for that is
> available on CRAN.  (Of course, it's possible that the error is specific
> to the version of Windows on the CRAN machine, but it's pretty easy to
> find out if the problem is reproducible on whatever Windows machine you
> do have.)
>
> Duncan Murdoch


From bpbond at gmail.com  Thu Oct  8 16:51:26 2015
From: bpbond at gmail.com (Ben Bond-Lamberty)
Date: Thu, 8 Oct 2015 10:51:26 -0400
Subject: [R-pkg-devel] Diagnosing error on CRAN's old R, old Windows
In-Reply-To: <CAGg1N9LU9iWxuixopK2pSENU2ue3LPcHoAFWmRFKbvTHuU75VA@mail.gmail.com>
References: <CAGg1N9LWAcw_QL51mmZNjMimAi2wGF5e-wV8D8Gg=Ci0cPjNUw@mail.gmail.com>
	<561664EF.2070002@gmail.com>
	<CAGg1N9LU9iWxuixopK2pSENU2ue3LPcHoAFWmRFKbvTHuU75VA@mail.gmail.com>
Message-ID: <CAGg1N9JZV3vy38S7i8HpumLyfkSjNipm1GzPy9nYQz1UaoZGUg@mail.gmail.com>

>Unfortunately the error diagnostics are not particularly helpful, only showing that four tests failed; the only common thread I see, maybe, is that all four tests--and no others--use R's file.size() function.

Brief follow-up for completeness: it turns out that `file.size()`
doesn't exist on Windows R 3.1.1 - instead need to use
`file.info()$size`. So problem fixed, although I still don't know why
no error message was appearing.

B


From mark.vanderloo at gmail.com  Thu Oct  8 17:27:09 2015
From: mark.vanderloo at gmail.com (Mark van der Loo)
Date: Thu, 08 Oct 2015 15:27:09 +0000
Subject: [R-pkg-devel] Diagnosing error on CRAN's old R, old Windows
In-Reply-To: <CAGg1N9JZV3vy38S7i8HpumLyfkSjNipm1GzPy9nYQz1UaoZGUg@mail.gmail.com>
References: <CAGg1N9LWAcw_QL51mmZNjMimAi2wGF5e-wV8D8Gg=Ci0cPjNUw@mail.gmail.com>
	<561664EF.2070002@gmail.com>
	<CAGg1N9LU9iWxuixopK2pSENU2ue3LPcHoAFWmRFKbvTHuU75VA@mail.gmail.com>
	<CAGg1N9JZV3vy38S7i8HpumLyfkSjNipm1GzPy9nYQz1UaoZGUg@mail.gmail.com>
Message-ID: <CAOKDuOhbpuvg0faZ6WNUv8k55tMA8WKVAkGNPT_45-a=7NG7zA@mail.gmail.com>

I had the same problem recently. It was apparently a windows-only
oldrel-only problem (and a specific oldrel, I can't remember which one). I
opted to adjust the DESCRIPTION to depend on a higher R version. Main
reason was that I don't have access to the right type of Windows version to
test it locally and the winbuilder service only tests on the most recent
R-versions (current and R-devel).

These system-dependent problems pop up now and then, causing work on both
CRAN volunteer and developer side. Especially the work on the volunteer
side could/should be avoided. So here's a nudge-nudge wink-wink to the R
consortium to set up a builder service that fully emulates CRAN. It is
probably not trivial but I feel it would be of value. More ambitiously,
such a builder service could include (attempts to) build against other R
engines apart from the GNU implementation -- but I'm digressing.

Best,
Mark









Op do 8 okt. 2015 om 16:52 schreef Ben Bond-Lamberty <bpbond at gmail.com>:

> >Unfortunately the error diagnostics are not particularly helpful, only
> showing that four tests failed; the only common thread I see, maybe, is
> that all four tests--and no others--use R's file.size() function.
>
> Brief follow-up for completeness: it turns out that `file.size()`
> doesn't exist on Windows R 3.1.1 - instead need to use
> `file.info()$size`. So problem fixed, although I still don't know why
> no error message was appearing.
>
> B
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From jefferis at mrc-lmb.cam.ac.uk  Thu Oct  8 22:41:12 2015
From: jefferis at mrc-lmb.cam.ac.uk (Dr Gregory Jefferis)
Date: Thu, 08 Oct 2015 21:41:12 +0100
Subject: [R-pkg-devel] how to make "r-release-osx-x86_64-mavericks"
 machine support rgl 3D plots
In-Reply-To: <55D0B886.3000903@gmail.com>
References: <1B3F92D43EA50646AB74A6C8C69A036064D00C@ait-pex02mbx05.win.dtu.dk>
	<21963.15225.888683.947819@max.nulle.part> <55CB4503.9090706@gmail.com>
	<3F0C870A-8D2A-4E49-8434-266F978285E0@mrc-lmb.cam.ac.uk>
	<55D0B886.3000903@gmail.com>
Message-ID: <57AA0143-09F5-4080-A417-727814FD9748@mrc-lmb.cam.ac.uk>

Dear Duncan,

Could I just revive this one more time

On 16 Aug 2015, at 17:21, Duncan Murdoch wrote:

> It is harder for you to implement this yourself, because CRAN frowns 
> on
> tests that try to detect whether they're running under CRAN or not.
>
> You could put in "if (interactive())" checks around your displays.  If
> you want to check whether the rgl calls are okay, you could do 
> something
> like this:
>
> library(rgl)
> options(rgl.useNULL = TRUE)

I have a package which imports rgl i.e. rgl is loaded on package 
startup. A number of examples (not tests) use rgl features and I do not 
want these to be run on CRAN.

Is there a way to configure rgl.useNULL to handle this situation?

Many thanks,

Greg.

--
Gregory Jefferis, PhD
Division of Neurobiology
MRC Laboratory of Molecular Biology
Francis Crick Avenue
Cambridge Biomedical Campus
Cambridge, CB2 OQH, UK

http://www2.mrc-lmb.cam.ac.uk/group-leaders/h-to-m/g-jefferis
http://jefferislab.org
http://flybrain.stanford.edu


From murdoch.duncan at gmail.com  Thu Oct  8 23:10:26 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 8 Oct 2015 17:10:26 -0400
Subject: [R-pkg-devel] how to make "r-release-osx-x86_64-mavericks"
 machine support rgl 3D plots
In-Reply-To: <57AA0143-09F5-4080-A417-727814FD9748@mrc-lmb.cam.ac.uk>
References: <1B3F92D43EA50646AB74A6C8C69A036064D00C@ait-pex02mbx05.win.dtu.dk>
	<21963.15225.888683.947819@max.nulle.part> <55CB4503.9090706@gmail.com>
	<3F0C870A-8D2A-4E49-8434-266F978285E0@mrc-lmb.cam.ac.uk>
	<55D0B886.3000903@gmail.com>
	<57AA0143-09F5-4080-A417-727814FD9748@mrc-lmb.cam.ac.uk>
Message-ID: <5616DBC2.4090005@gmail.com>

On 08/10/2015 4:41 PM, Dr Gregory Jefferis wrote:
> Dear Duncan,
> 
> Could I just revive this one more time
> 
> On 16 Aug 2015, at 17:21, Duncan Murdoch wrote:
> 
>> It is harder for you to implement this yourself, because CRAN frowns 
>> on
>> tests that try to detect whether they're running under CRAN or not.
>>
>> You could put in "if (interactive())" checks around your displays.  If
>> you want to check whether the rgl calls are okay, you could do 
>> something
>> like this:
>>
>> library(rgl)
>> options(rgl.useNULL = TRUE)
> 
> I have a package which imports rgl i.e. rgl is loaded on package 
> startup. A number of examples (not tests) use rgl features and I do not 
> want these to be run on CRAN.
> 
> Is there a way to configure rgl.useNULL to handle this situation?
> 

I don't think so, but I don't think you really want that.

options(rgl.useNULL = TRUE)

doesn't stop rgl from running, it just stops it from trying to display
anything.  So you could put code like

if (!interactive())
  options(rgl.useNULL = TRUE)

into your .onLoad function for your package, and it wouldn't try to open
a display on CRAN, or anywhere else that wasn't interactive.

Duncan


From murdoch.duncan at gmail.com  Fri Oct  9 02:30:59 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 8 Oct 2015 20:30:59 -0400
Subject: [R-pkg-devel] how to make "r-release-osx-x86_64-mavericks"
 machine support rgl 3D plots
In-Reply-To: <CAMMJQ0bc1zv7d_N2ASw+dwcuRddhVSuWz+TkNfiew5QgkKZbLQ@mail.gmail.com>
References: <1B3F92D43EA50646AB74A6C8C69A036064D00C@ait-pex02mbx05.win.dtu.dk>
	<21963.15225.888683.947819@max.nulle.part> <55CB4503.9090706@gmail.com>
	<3F0C870A-8D2A-4E49-8434-266F978285E0@mrc-lmb.cam.ac.uk>
	<55D0B886.3000903@gmail.com>
	<57AA0143-09F5-4080-A417-727814FD9748@mrc-lmb.cam.ac.uk>
	<5616DBC2.4090005@gmail.com>
	<CAMMJQ0bc1zv7d_N2ASw+dwcuRddhVSuWz+TkNfiew5QgkKZbLQ@mail.gmail.com>
Message-ID: <56170AC3.60902@gmail.com>

On 08/10/2015 7:55 PM, Ott Toomet wrote:
> Alternatively, you can exclude selected tests from being included in the
> package.  Most of the tests I do are not necessary to run on CRAN, these
> are not system dependent while still time consuming.  To run these just
> on my PC in enough.  So I use .Rbuildignore to exclude those.

Another way to achieve something similar is to put some tests in another
directory besides "tests" (e.g. inst/slowtests), and use the --test-dir
argument to R CMD check to run those.  This way other people can run
your tests if they want to.

Duncan Murdoch

> 
> Cheers,
> Ott
> 
> On Thu, Oct 8, 2015 at 2:10 PM, Duncan Murdoch <murdoch.duncan at gmail.com
> <mailto:murdoch.duncan at gmail.com>> wrote:
> 
>     On 08/10/2015 4:41 PM, Dr Gregory Jefferis wrote:
>     > Dear Duncan,
>     >
>     > Could I just revive this one more time
>     >
>     > On 16 Aug 2015, at 17:21, Duncan Murdoch wrote:
>     >
>     >> It is harder for you to implement this yourself, because CRAN frowns
>     >> on
>     >> tests that try to detect whether they're running under CRAN or not.
>     >>
>     >> You could put in "if (interactive())" checks around your displays.  If
>     >> you want to check whether the rgl calls are okay, you could do
>     >> something
>     >> like this:
>     >>
>     >> library(rgl)
>     >> options(rgl.useNULL = TRUE)
>     >
>     > I have a package which imports rgl i.e. rgl is loaded on package
>     > startup. A number of examples (not tests) use rgl features and I do not
>     > want these to be run on CRAN.
>     >
>     > Is there a way to configure rgl.useNULL to handle this situation?
>     >
> 
>     I don't think so, but I don't think you really want that.
> 
>     options(rgl.useNULL = TRUE)
> 
>     doesn't stop rgl from running, it just stops it from trying to display
>     anything.  So you could put code like
> 
>     if (!interactive())
>       options(rgl.useNULL = TRUE)
> 
>     into your .onLoad function for your package, and it wouldn't try to open
>     a display on CRAN, or anywhere else that wasn't interactive.
> 
>     Duncan
> 
>     ______________________________________________
>     R-package-devel at r-project.org <mailto:R-package-devel at r-project.org>
>     mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> 
> 
> 
> -- 
> Ott Toomet
> 
> Visiting Researcher
> School of Information
> Mary Gates Hall, Suite 310
> University of Washington
> Seattle, WA 98195
>


From otoomet at gmail.com  Fri Oct  9 01:55:50 2015
From: otoomet at gmail.com (Ott Toomet)
Date: Thu, 8 Oct 2015 16:55:50 -0700
Subject: [R-pkg-devel] how to make "r-release-osx-x86_64-mavericks"
 machine support rgl 3D plots
In-Reply-To: <5616DBC2.4090005@gmail.com>
References: <1B3F92D43EA50646AB74A6C8C69A036064D00C@ait-pex02mbx05.win.dtu.dk>
	<21963.15225.888683.947819@max.nulle.part> <55CB4503.9090706@gmail.com>
	<3F0C870A-8D2A-4E49-8434-266F978285E0@mrc-lmb.cam.ac.uk>
	<55D0B886.3000903@gmail.com>
	<57AA0143-09F5-4080-A417-727814FD9748@mrc-lmb.cam.ac.uk>
	<5616DBC2.4090005@gmail.com>
Message-ID: <CAMMJQ0bc1zv7d_N2ASw+dwcuRddhVSuWz+TkNfiew5QgkKZbLQ@mail.gmail.com>

Alternatively, you can exclude selected tests from being included in the
package.  Most of the tests I do are not necessary to run on CRAN, these
are not system dependent while still time consuming.  To run these just on
my PC in enough.  So I use .Rbuildignore to exclude those.

Cheers,
Ott

On Thu, Oct 8, 2015 at 2:10 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 08/10/2015 4:41 PM, Dr Gregory Jefferis wrote:
> > Dear Duncan,
> >
> > Could I just revive this one more time
> >
> > On 16 Aug 2015, at 17:21, Duncan Murdoch wrote:
> >
> >> It is harder for you to implement this yourself, because CRAN frowns
> >> on
> >> tests that try to detect whether they're running under CRAN or not.
> >>
> >> You could put in "if (interactive())" checks around your displays.  If
> >> you want to check whether the rgl calls are okay, you could do
> >> something
> >> like this:
> >>
> >> library(rgl)
> >> options(rgl.useNULL = TRUE)
> >
> > I have a package which imports rgl i.e. rgl is loaded on package
> > startup. A number of examples (not tests) use rgl features and I do not
> > want these to be run on CRAN.
> >
> > Is there a way to configure rgl.useNULL to handle this situation?
> >
>
> I don't think so, but I don't think you really want that.
>
> options(rgl.useNULL = TRUE)
>
> doesn't stop rgl from running, it just stops it from trying to display
> anything.  So you could put code like
>
> if (!interactive())
>   options(rgl.useNULL = TRUE)
>
> into your .onLoad function for your package, and it wouldn't try to open
> a display on CRAN, or anywhere else that wasn't interactive.
>
> Duncan
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>



-- 
Ott Toomet

Visiting Researcher
School of Information
Mary Gates Hall, Suite 310
University of Washington
Seattle, WA 98195

	[[alternative HTML version deleted]]


From cdetermanjr at gmail.com  Mon Oct 12 20:13:55 2015
From: cdetermanjr at gmail.com (Charles Determan)
Date: Mon, 12 Oct 2015 13:13:55 -0500
Subject: [R-pkg-devel] R CMD check NOTE - Long paths in package
Message-ID: <CAKxd1KOkDmN7uX-DApk5zikGZ3TMog2pRKG-GniZUC5XZt4ObQ@mail.gmail.com>

Greetings,

I have a package which provides headers for a C++ library (similar to the
BH package).  However, the C++ library has some heavily nested components
within its' structure so when I run R CMD check I get the following NOTE:

Tarballs are only required to store paths of up to 100 bytes and cannot
store those of more than 256 bytes, with restrictions including to 100
bytes for the final component.

Is this a major problem?  As this is a 'NOTE' I am under the impression
that the long paths are not critical but I want to make sure.

Thank you,
Regards,

Charles

	[[alternative HTML version deleted]]


From edd at debian.org  Tue Oct 13 05:16:27 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 12 Oct 2015 22:16:27 -0500
Subject: [R-pkg-devel] R CMD check NOTE - Long paths in package
In-Reply-To: <CAKxd1KOkDmN7uX-DApk5zikGZ3TMog2pRKG-GniZUC5XZt4ObQ@mail.gmail.com>
References: <CAKxd1KOkDmN7uX-DApk5zikGZ3TMog2pRKG-GniZUC5XZt4ObQ@mail.gmail.com>
Message-ID: <22044.30603.463681.423932@max.nulle.part>


On 12 October 2015 at 13:13, Charles Determan wrote:
| Greetings,
| 
| I have a package which provides headers for a C++ library (similar to the
| BH package).  However, the C++ library has some heavily nested components
| within its' structure so when I run R CMD check I get the following NOTE:
| 
| Tarballs are only required to store paths of up to 100 bytes and cannot
| store those of more than 256 bytes, with restrictions including to 100
| bytes for the final component.
| 
| Is this a major problem?

Yes.

| As this is a 'NOTE' I am under the impression
| that the long paths are not critical but I want to make sure.

Wrong.

'BH' is called 'BH', believe it or not, to save a few letters, or else I
would have a dozen or more files complain for the very same reason (and CRAN
reject it for non-suitable path/filenames).  Hence not 'BoostHeaders' but
just 'BH'. And see the ChangeLog of BH and revel in how _each_ release has to
rename one of the Runge-Kutta integration files to make the 'net' path length
be suitable for R packing.

There is no point in ignoring the output of R CMD check unless you _really_
know better.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From b.rowlingson at lancaster.ac.uk  Tue Oct 13 09:01:48 2015
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 13 Oct 2015 08:01:48 +0100
Subject: [R-pkg-devel] R CMD check NOTE - Long paths in package
In-Reply-To: <22044.30603.463681.423932@max.nulle.part>
References: <CAKxd1KOkDmN7uX-DApk5zikGZ3TMog2pRKG-GniZUC5XZt4ObQ@mail.gmail.com>
	<22044.30603.463681.423932@max.nulle.part>
Message-ID: <CANVKczPn+mG1Z+zSQtgmjpghYXGHiohdrNbU5eFWPd2OWJmXtw@mail.gmail.com>

On Tue, Oct 13, 2015 at 4:16 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 12 October 2015 at 13:13, Charles Determan wrote:
> | Greetings,
> |
> | I have a package which provides headers for a C++ library (similar to the
> | BH package).  However, the C++ library has some heavily nested components
> | within its' structure so when I run R CMD check I get the following NOTE:
> |
> | Tarballs are only required to store paths of up to 100 bytes and cannot
> | store those of more than 256 bytes, with restrictions including to 100
> | bytes for the final component.
> |
> | Is this a major problem?
>
> Yes.
>
> | As this is a 'NOTE' I am under the impression
> | that the long paths are not critical but I want to make sure.
>
> Wrong.
>
> 'BH' is called 'BH', believe it or not, to save a few letters, or else I
> would have a dozen or more files complain for the very same reason (and CRAN
> reject it for non-suitable path/filenames).  Hence not 'BoostHeaders' but
> just 'BH'. And see the ChangeLog of BH and revel in how _each_ release has to
> rename one of the Runge-Kutta integration files to make the 'net' path length
> be suitable for R packing.
>
> There is no point in ignoring the output of R CMD check unless you _really_
> know better.

 But is it worth asking if the NOTE's restriction could be lifted,
given that from what I read on wikipedia that the "tar" file format
has been happy with long path names since 2001? Given that R-Core/CRAN
sometimes refer to R versions from a year ago as "obsolete", how can
they complain about sticking with a file format restriction from the
last century? I've just happily made a tar file with a path that is
1300 chars long containing a file with a name of 160 chars .

 Or are there still old versions of tar around, or other file systems
with restrictive naming practices (in which case the error should be
about the names/paths of the files themselves, not that old versions
of tar can't cope with them)?

 It now seems to have bothered at least two people and Dirk sounds
like he's had to implement a little hack to keep the path names down.

Barry


From ligges at statistik.tu-dortmund.de  Tue Oct 13 09:42:55 2015
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 13 Oct 2015 09:42:55 +0200
Subject: [R-pkg-devel] R CMD check NOTE - Long paths in package
In-Reply-To: <CANVKczPn+mG1Z+zSQtgmjpghYXGHiohdrNbU5eFWPd2OWJmXtw@mail.gmail.com>
References: <CAKxd1KOkDmN7uX-DApk5zikGZ3TMog2pRKG-GniZUC5XZt4ObQ@mail.gmail.com>
	<22044.30603.463681.423932@max.nulle.part>
	<CANVKczPn+mG1Z+zSQtgmjpghYXGHiohdrNbU5eFWPd2OWJmXtw@mail.gmail.com>
Message-ID: <561CB5FF.4060009@statistik.tu-dortmund.de>



On 13.10.2015 09:01, Barry Rowlingson wrote:
> On Tue, Oct 13, 2015 at 4:16 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>>
>> On 12 October 2015 at 13:13, Charles Determan wrote:
>> | Greetings,
>> |
>> | I have a package which provides headers for a C++ library (similar to the
>> | BH package).  However, the C++ library has some heavily nested components
>> | within its' structure so when I run R CMD check I get the following NOTE:
>> |
>> | Tarballs are only required to store paths of up to 100 bytes and cannot
>> | store those of more than 256 bytes, with restrictions including to 100
>> | bytes for the final component.
>> |
>> | Is this a major problem?
>>
>> Yes.
>>
>> | As this is a 'NOTE' I am under the impression
>> | that the long paths are not critical but I want to make sure.
>>
>> Wrong.
>>
>> 'BH' is called 'BH', believe it or not, to save a few letters, or else I
>> would have a dozen or more files complain for the very same reason (and CRAN
>> reject it for non-suitable path/filenames).  Hence not 'BoostHeaders' but
>> just 'BH'. And see the ChangeLog of BH and revel in how _each_ release has to
>> rename one of the Runge-Kutta integration files to make the 'net' path length
>> be suitable for R packing.
>>
>> There is no point in ignoring the output of R CMD check unless you _really_
>> know better.
>
>   But is it worth asking if the NOTE's restriction could be lifted,
> given that from what I read on wikipedia that the "tar" file format
> has been happy with long path names since 2001? Given that R-Core/CRAN
> sometimes refer to R versions from a year ago as "obsolete", how can
> they complain about sticking with a file format restriction from the
> last century? I've just happily made a tar file with a path that is
> 1300 chars long containing a file with a name of 160 chars .
>
>   Or are there still old versions of tar around, or other file systems
> with restrictive naming practices (in which case the error should be
> about the names/paths of the files themselves, not that old versions
> of tar can't cope with them)?

Yes, some Unixes seem to have old tar versions installed.

Best,
Uwe Ligges

>
>   It now seems to have bothered at least two people and Dirk sounds
> like he's had to implement a little hack to keep the path names down.
>
> Barry
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From pdalgd at gmail.com  Tue Oct 13 11:02:37 2015
From: pdalgd at gmail.com (peter dalgaard)
Date: Tue, 13 Oct 2015 11:02:37 +0200
Subject: [R-pkg-devel] R CMD check NOTE - Long paths in package
In-Reply-To: <561CB5FF.4060009@statistik.tu-dortmund.de>
References: <CAKxd1KOkDmN7uX-DApk5zikGZ3TMog2pRKG-GniZUC5XZt4ObQ@mail.gmail.com>
	<22044.30603.463681.423932@max.nulle.part>
	<CANVKczPn+mG1Z+zSQtgmjpghYXGHiohdrNbU5eFWPd2OWJmXtw@mail.gmail.com>
	<561CB5FF.4060009@statistik.tu-dortmund.de>
Message-ID: <A1594A8C-4F0B-4DA2-9246-4157B2ED3D50@gmail.com>


On 13 Oct 2015, at 09:42 , Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:

> 
> 
> On 13.10.2015 09:01, Barry Rowlingson wrote:
>> On Tue, Oct 13, 2015 at 4:16 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>>> 
>>> On 12 October 2015 at 13:13, Charles Determan wrote:
>>> | Greetings,
>>> |
>>> | I have a package which provides headers for a C++ library (similar to the
>>> | BH package).  However, the C++ library has some heavily nested components
>>> | within its' structure so when I run R CMD check I get the following NOTE:
>>> |
>>> | Tarballs are only required to store paths of up to 100 bytes and cannot
>>> | store those of more than 256 bytes, with restrictions including to 100
>>> | bytes for the final component.
>>> |
>>> | Is this a major problem?
>>> 
>>> Yes.
>>> 
>>> | As this is a 'NOTE' I am under the impression
>>> | that the long paths are not critical but I want to make sure.
>>> 
>>> Wrong.
>>> 
>>> 'BH' is called 'BH', believe it or not, to save a few letters, or else I
>>> would have a dozen or more files complain for the very same reason (and CRAN
>>> reject it for non-suitable path/filenames).  Hence not 'BoostHeaders' but
>>> just 'BH'. And see the ChangeLog of BH and revel in how _each_ release has to
>>> rename one of the Runge-Kutta integration files to make the 'net' path length
>>> be suitable for R packing.
>>> 
>>> There is no point in ignoring the output of R CMD check unless you _really_
>>> know better.
>> 
>>  But is it worth asking if the NOTE's restriction could be lifted,
>> given that from what I read on wikipedia that the "tar" file format
>> has been happy with long path names since 2001? Given that R-Core/CRAN
>> sometimes refer to R versions from a year ago as "obsolete", how can
>> they complain about sticking with a file format restriction from the
>> last century? I've just happily made a tar file with a path that is
>> 1300 chars long containing a file with a name of 160 chars .
>> 
>>  Or are there still old versions of tar around, or other file systems
>> with restrictive naming practices (in which case the error should be
>> about the names/paths of the files themselves, not that old versions
>> of tar can't cope with them)?
> 
> Yes, some Unixes seem to have old tar versions installed.

Yes, it is somewhat harder to deem entire OSs obsolete... 

But: How old versions and how common is the issue? 

Mainstream Unix is essentially Linux and OS X these days. OS X seems to be stuck in 2010 (BSD tar 2.8.3), at least up until Yosemite. Linux distros usually keep themselves up to date, except for the enterprise/long upgrade cycle ones that can be like 5 years outdated. Less common, but still in use, are FreeBSD, Solaris and AIX. 

It _is_ a valid question for how long we want out-of-the-box support for OSs that use obsolete tools. At some point we could decide that the more obscure Unices would have to install a recent version (with the R configuration arranging to set TAR=/usr/local/bin/gtar or somesuch).

-pd

> 
> Best,
> Uwe Ligges
> 
>> 
>>  It now seems to have bothered at least two people and Dirk sounds
>> like he's had to implement a little hack to keep the path names down.
>> 
>> Barry
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> 
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From cdetermanjr at gmail.com  Tue Oct 13 22:04:23 2015
From: cdetermanjr at gmail.com (Charles Determan)
Date: Tue, 13 Oct 2015 15:04:23 -0500
Subject: [R-pkg-devel] R CMD check NOTE - Long paths in package
In-Reply-To: <A1594A8C-4F0B-4DA2-9246-4157B2ED3D50@gmail.com>
References: <CAKxd1KOkDmN7uX-DApk5zikGZ3TMog2pRKG-GniZUC5XZt4ObQ@mail.gmail.com>
	<22044.30603.463681.423932@max.nulle.part>
	<CANVKczPn+mG1Z+zSQtgmjpghYXGHiohdrNbU5eFWPd2OWJmXtw@mail.gmail.com>
	<561CB5FF.4060009@statistik.tu-dortmund.de>
	<A1594A8C-4F0B-4DA2-9246-4157B2ED3D50@gmail.com>
Message-ID: <CAKxd1KNCSeq8QaG1v+=7h7a-ir36KGRKVxzCk=7=ZGjjirvw6A@mail.gmail.com>

I'm glad to see this discussion.  Unfortunately in the short term I cannot
remove the nested files (as Dirk implies with the BH package) as it would
require restructuring the c++ library and make it far more difficult to
maintain.  Unless there are other suggestions I will need to hold off on
submission until such a time that OSs that use obsolete tools are no longer
supported out-of-the-box (as Peter says).  I will likely just continue to
maintain the package on my gitub until CRAN would accept the longer paths.

Charles

On Tue, Oct 13, 2015 at 4:02 AM, peter dalgaard <pdalgd at gmail.com> wrote:

>
> On 13 Oct 2015, at 09:42 , Uwe Ligges <ligges at statistik.tu-dortmund.de>
> wrote:
>
> >
> >
> > On 13.10.2015 09:01, Barry Rowlingson wrote:
> >> On Tue, Oct 13, 2015 at 4:16 AM, Dirk Eddelbuettel <edd at debian.org>
> wrote:
> >>>
> >>> On 12 October 2015 at 13:13, Charles Determan wrote:
> >>> | Greetings,
> >>> |
> >>> | I have a package which provides headers for a C++ library (similar
> to the
> >>> | BH package).  However, the C++ library has some heavily nested
> components
> >>> | within its' structure so when I run R CMD check I get the following
> NOTE:
> >>> |
> >>> | Tarballs are only required to store paths of up to 100 bytes and
> cannot
> >>> | store those of more than 256 bytes, with restrictions including to
> 100
> >>> | bytes for the final component.
> >>> |
> >>> | Is this a major problem?
> >>>
> >>> Yes.
> >>>
> >>> | As this is a 'NOTE' I am under the impression
> >>> | that the long paths are not critical but I want to make sure.
> >>>
> >>> Wrong.
> >>>
> >>> 'BH' is called 'BH', believe it or not, to save a few letters, or else
> I
> >>> would have a dozen or more files complain for the very same reason
> (and CRAN
> >>> reject it for non-suitable path/filenames).  Hence not 'BoostHeaders'
> but
> >>> just 'BH'. And see the ChangeLog of BH and revel in how _each_ release
> has to
> >>> rename one of the Runge-Kutta integration files to make the 'net' path
> length
> >>> be suitable for R packing.
> >>>
> >>> There is no point in ignoring the output of R CMD check unless you
> _really_
> >>> know better.
> >>
> >>  But is it worth asking if the NOTE's restriction could be lifted,
> >> given that from what I read on wikipedia that the "tar" file format
> >> has been happy with long path names since 2001? Given that R-Core/CRAN
> >> sometimes refer to R versions from a year ago as "obsolete", how can
> >> they complain about sticking with a file format restriction from the
> >> last century? I've just happily made a tar file with a path that is
> >> 1300 chars long containing a file with a name of 160 chars .
> >>
> >>  Or are there still old versions of tar around, or other file systems
> >> with restrictive naming practices (in which case the error should be
> >> about the names/paths of the files themselves, not that old versions
> >> of tar can't cope with them)?
> >
> > Yes, some Unixes seem to have old tar versions installed.
>
> Yes, it is somewhat harder to deem entire OSs obsolete...
>
> But: How old versions and how common is the issue?
>
> Mainstream Unix is essentially Linux and OS X these days. OS X seems to be
> stuck in 2010 (BSD tar 2.8.3), at least up until Yosemite. Linux distros
> usually keep themselves up to date, except for the enterprise/long upgrade
> cycle ones that can be like 5 years outdated. Less common, but still in
> use, are FreeBSD, Solaris and AIX.
>
> It _is_ a valid question for how long we want out-of-the-box support for
> OSs that use obsolete tools. At some point we could decide that the more
> obscure Unices would have to install a recent version (with the R
> configuration arranging to set TAR=/usr/local/bin/gtar or somesuch).
>
> -pd
>
> >
> > Best,
> > Uwe Ligges
> >
> >>
> >>  It now seems to have bothered at least two people and Dirk sounds
> >> like he's had to implement a little hack to keep the path names down.
> >>
> >> Barry
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> --
> Peter Dalgaard, Professor,
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Office: A 4.23
> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From henrik.bengtsson at ucsf.edu  Tue Oct 13 23:21:54 2015
From: henrik.bengtsson at ucsf.edu (Henrik Bengtsson)
Date: Tue, 13 Oct 2015 14:21:54 -0700
Subject: [R-pkg-devel] R CMD check NOTE - Long paths in package
In-Reply-To: <CAKxd1KNCSeq8QaG1v+=7h7a-ir36KGRKVxzCk=7=ZGjjirvw6A@mail.gmail.com>
References: <CAKxd1KOkDmN7uX-DApk5zikGZ3TMog2pRKG-GniZUC5XZt4ObQ@mail.gmail.com>
	<22044.30603.463681.423932@max.nulle.part>
	<CANVKczPn+mG1Z+zSQtgmjpghYXGHiohdrNbU5eFWPd2OWJmXtw@mail.gmail.com>
	<561CB5FF.4060009@statistik.tu-dortmund.de>
	<A1594A8C-4F0B-4DA2-9246-4157B2ED3D50@gmail.com>
	<CAKxd1KNCSeq8QaG1v+=7h7a-ir36KGRKVxzCk=7=ZGjjirvw6A@mail.gmail.com>
Message-ID: <CAFDcVCSD_x1LPxYQWAKuSzZQJDmQmUVXqUzxk9d6X5vnR8n=kg@mail.gmail.com>

Regardless of tar or not, note that there are other limits in R on how
long *file* names can be, e.g.

> pathname <- paste(rep("a", times=255), collapse="")
> nchar(pathname)
[1] 255
> cat("hello", file=pathname)

> pathname <- paste(rep("a", times=256), collapse="")
> nchar(pathname)
[1] 256
> cat("hello", file=pathname)
Error in file(file, ifelse(append, "a", "w")) :
  cannot open the connection
In addition: Warning message:
In file(file, ifelse(append, "a", "w")) :
  cannot open file
'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa':
File name too long

The above is the output from R 3.2.2 on x86_64-pc-linux-gnu (64-bit).
I don't know if/where this is documented.

Also, and possibly related to the above, the MS Windows operating
system has a limit of 256 characters on the *absolute* *pathname*
(directory and file names including slashes but not initial drive
letter specification), cf.
http://aroma-project.org/howtos/UseLongFilenamesOnWindows/.   For
instance, if your package is installed in, say, library
"C:/Users/JohnDoe/R/win-library/3.2/", you've already used up 35
characters out of your 256 available ones just there.  Then add the
length of your package name.  So, allowing for fairly long usernames
on Windows, in order for your package to build/install on Windows as
well, you might still want to aim for something like a maximum of
200-character *relative* pathnames. (You might get away with a bit
longer src/ pathnames if you build a Windows binary package under,
say, "T:/', because src/ is not part of the distributed binary, so the
user can still install it, but I don't know how far you want to push
that).

/Henrik



On Tue, Oct 13, 2015 at 1:04 PM, Charles Determan <cdetermanjr at gmail.com> wrote:
> I'm glad to see this discussion.  Unfortunately in the short term I cannot
> remove the nested files (as Dirk implies with the BH package) as it would
> require restructuring the c++ library and make it far more difficult to
> maintain.  Unless there are other suggestions I will need to hold off on
> submission until such a time that OSs that use obsolete tools are no longer
> supported out-of-the-box (as Peter says).  I will likely just continue to
> maintain the package on my gitub until CRAN would accept the longer paths.
>
> Charles
>
> On Tue, Oct 13, 2015 at 4:02 AM, peter dalgaard <pdalgd at gmail.com> wrote:
>
>>
>> On 13 Oct 2015, at 09:42 , Uwe Ligges <ligges at statistik.tu-dortmund.de>
>> wrote:
>>
>> >
>> >
>> > On 13.10.2015 09:01, Barry Rowlingson wrote:
>> >> On Tue, Oct 13, 2015 at 4:16 AM, Dirk Eddelbuettel <edd at debian.org>
>> wrote:
>> >>>
>> >>> On 12 October 2015 at 13:13, Charles Determan wrote:
>> >>> | Greetings,
>> >>> |
>> >>> | I have a package which provides headers for a C++ library (similar
>> to the
>> >>> | BH package).  However, the C++ library has some heavily nested
>> components
>> >>> | within its' structure so when I run R CMD check I get the following
>> NOTE:
>> >>> |
>> >>> | Tarballs are only required to store paths of up to 100 bytes and
>> cannot
>> >>> | store those of more than 256 bytes, with restrictions including to
>> 100
>> >>> | bytes for the final component.
>> >>> |
>> >>> | Is this a major problem?
>> >>>
>> >>> Yes.
>> >>>
>> >>> | As this is a 'NOTE' I am under the impression
>> >>> | that the long paths are not critical but I want to make sure.
>> >>>
>> >>> Wrong.
>> >>>
>> >>> 'BH' is called 'BH', believe it or not, to save a few letters, or else
>> I
>> >>> would have a dozen or more files complain for the very same reason
>> (and CRAN
>> >>> reject it for non-suitable path/filenames).  Hence not 'BoostHeaders'
>> but
>> >>> just 'BH'. And see the ChangeLog of BH and revel in how _each_ release
>> has to
>> >>> rename one of the Runge-Kutta integration files to make the 'net' path
>> length
>> >>> be suitable for R packing.
>> >>>
>> >>> There is no point in ignoring the output of R CMD check unless you
>> _really_
>> >>> know better.
>> >>
>> >>  But is it worth asking if the NOTE's restriction could be lifted,
>> >> given that from what I read on wikipedia that the "tar" file format
>> >> has been happy with long path names since 2001? Given that R-Core/CRAN
>> >> sometimes refer to R versions from a year ago as "obsolete", how can
>> >> they complain about sticking with a file format restriction from the
>> >> last century? I've just happily made a tar file with a path that is
>> >> 1300 chars long containing a file with a name of 160 chars .
>> >>
>> >>  Or are there still old versions of tar around, or other file systems
>> >> with restrictive naming practices (in which case the error should be
>> >> about the names/paths of the files themselves, not that old versions
>> >> of tar can't cope with them)?
>> >
>> > Yes, some Unixes seem to have old tar versions installed.
>>
>> Yes, it is somewhat harder to deem entire OSs obsolete...
>>
>> But: How old versions and how common is the issue?
>>
>> Mainstream Unix is essentially Linux and OS X these days. OS X seems to be
>> stuck in 2010 (BSD tar 2.8.3), at least up until Yosemite. Linux distros
>> usually keep themselves up to date, except for the enterprise/long upgrade
>> cycle ones that can be like 5 years outdated. Less common, but still in
>> use, are FreeBSD, Solaris and AIX.
>>
>> It _is_ a valid question for how long we want out-of-the-box support for
>> OSs that use obsolete tools. At some point we could decide that the more
>> obscure Unices would have to install a recent version (with the R
>> configuration arranging to set TAR=/usr/local/bin/gtar or somesuch).
>>
>> -pd
>>
>> >
>> > Best,
>> > Uwe Ligges
>> >
>> >>
>> >>  It now seems to have bothered at least two people and Dirk sounds
>> >> like he's had to implement a little hack to keep the path names down.
>> >>
>> >> Barry
>> >>
>> >> ______________________________________________
>> >> R-package-devel at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >>
>> >
>> > ______________________________________________
>> > R-package-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> --
>> Peter Dalgaard, Professor,
>> Center for Statistics, Copenhagen Business School
>> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
>> Phone: (+45)38153501
>> Office: A 4.23
>> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From henrik.bengtsson at ucsf.edu  Wed Oct 14 00:06:59 2015
From: henrik.bengtsson at ucsf.edu (Henrik Bengtsson)
Date: Tue, 13 Oct 2015 15:06:59 -0700
Subject: [R-pkg-devel] Format/parser for NEWS (not NEWS.Rd)?
In-Reply-To: <CAJ4QxaMTOK4mNn3KLXWXPrAXvx=44i+n_UxHX3ESUkK-ymEyxg@mail.gmail.com>
References: <CAFDcVCTdAJn8exdnw-y9D7fJCy7=LEVxAOCmCbr1is14ZTihDA@mail.gmail.com>
	<CAJ4QxaMTOK4mNn3KLXWXPrAXvx=44i+n_UxHX3ESUkK-ymEyxg@mail.gmail.com>
Message-ID: <CAFDcVCSoxZOaK_0QA1tLvZmTcJ_+MJ1gvm7tve3Wbv+6BEem4w@mail.gmail.com>

On Wed, Oct 7, 2015 at 6:40 PM, boB Rudis <bob at rudis.net> wrote:
> Try looking at the source for tools:::.news_reader_default and then tools::toRd

Thank you for this.  That works - for example

> news <- tools:::.news_reader_default("NEWS")
> str(news)
Classes 'news_db' and 'data.frame':     21 obs. of  4 variables:
 $ Version : chr  "0.8.1" "0.8.1" "0.8.1" "0.8.0" ...
 $ Date    : chr  "2015-10-05" "2015-10-05" "2015-10-05" "2015-09-06" ...
 $ Category: chr  NA NA NA NA ...
 $ Text    : chr  "eager() and multicore() gained argument 'globals', where\nglo
bals=TRUE will validate that all global variables\nidentified can "| __truncated
__ "lazy(sum(x, ...), globals=TRUE) now properly passes `...`\nfrom the function
 from which the future is setup.  If not\ncalled wi"| __truncated__ "Added vigne
tte 'Futures in R: Common issues with solutions'." "plan(\"default\") resets to
the default strategy, which is\nsynchroneous eager evaluation unless option 'fut
ure_plan'\nor envir"| __truncated__ ...
 - attr(*, "bad")= logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
> any(attr(news, "bad"))
[1] FALSE

This would work as way to validate NEWS.


Also, to follow up on my own original post suggesting that
tools:::news2Rd() calls deprecated functions.  From the feedback I got
on the documentation bug report
(https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=16556) and
looking at the code, the following does indeed parse and output to
NEWS.Rd:

> setwd("/path/to/MyPackage/")
> tools:::news2Rd("NEWS", out="NEWS.Rd")

which assuming NEWS is in the root of the package. If it's under
inst/, then tools:::news2Rd("inst/NEWS", out="NEWS.Rd").

However, it is important that the DESCRIPTION file is also found by
tools:::news2Rd().  In other words, tools:::news2Rd() assumes you're
running in a package director.  If you do what I tried previously and
put the NEWS file in a separate "sandbox" directory, then you get:

> tools:::news2Rd("NEWS", out="NEWS.Rd")
Error: 'readNEWS' is defunct.
See help("Defunct")

With the a very recent R-devel, you now get:

> tools:::news2Rd("NEWS", "NEWS.Rd")
Error in tools:::news2Rd("NEWS", "NEWS.Rd") : DESCRIPTION file not found

which is more informative.

Henrik

>
> On Wed, Oct 7, 2015 at 8:37 PM, Henrik Bengtsson
> <henrik.bengtsson at ucsf.edu> wrote:
>> Hi,
>>
>> I'm looking for a parser of the plain text NEWS format (not the
>> NEWS.Rd format) - ideally the same on that is used by R itself.  Does
>> anyone know which that one is / of such at tool?
>>
>> Thanks,
>>
>> Henrik
>>
>> PS. help("news") mentions tools:::news2Rd(), but that's actually
>> defunct (just reported
>> https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=16556).
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From edd at debian.org  Wed Oct 14 01:03:51 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 13 Oct 2015 18:03:51 -0500
Subject: [R-pkg-devel] R CMD check NOTE - Long paths in package
In-Reply-To: <CAKxd1KNCSeq8QaG1v+=7h7a-ir36KGRKVxzCk=7=ZGjjirvw6A@mail.gmail.com>
References: <CAKxd1KOkDmN7uX-DApk5zikGZ3TMog2pRKG-GniZUC5XZt4ObQ@mail.gmail.com>
	<22044.30603.463681.423932@max.nulle.part>
	<CANVKczPn+mG1Z+zSQtgmjpghYXGHiohdrNbU5eFWPd2OWJmXtw@mail.gmail.com>
	<561CB5FF.4060009@statistik.tu-dortmund.de>
	<A1594A8C-4F0B-4DA2-9246-4157B2ED3D50@gmail.com>
	<CAKxd1KNCSeq8QaG1v+=7h7a-ir36KGRKVxzCk=7=ZGjjirvw6A@mail.gmail.com>
Message-ID: <22045.36311.857611.353572@max.nulle.part>


On 13 October 2015 at 15:04, Charles Determan wrote:
| I'm glad to see this discussion.  Unfortunately in the short term I cannot
| remove the nested files (as Dirk implies with the BH package) as it would

Rename, not remove. Of course I didn't remove a file.

I changed a filename, and the include statement leading to it.

| require restructuring the c++ library and make it far more difficult to
| maintain.  Unless there are other suggestions I will need to hold off on
| submission until such a time that OSs that use obsolete tools are no longer
| supported out-of-the-box (as Peter says).  I will likely just continue to
| maintain the package on my gitub until CRAN would accept the longer paths.

Which still keeps it uninstallable on some systems.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From james.f.hester at gmail.com  Wed Oct 14 21:53:22 2015
From: james.f.hester at gmail.com (Jim Hester)
Date: Wed, 14 Oct 2015 15:53:22 -0400
Subject: [R-pkg-devel] problem with locale-dependent order()
In-Reply-To: <CABdHhvGFWKnqUp_7eZiR83UQhW217WA4Zj0OaqbDF--zddsV4w@mail.gmail.com>
References: <1594107507.7395252.1442607921071.JavaMail.zimbra@meteo.be>
	<CABdHhvGFWKnqUp_7eZiR83UQhW217WA4Zj0OaqbDF--zddsV4w@mail.gmail.com>
Message-ID: <CAD6tx97b-oYmOTwH5U1r=ygcM7JjLmf5N3MCP9p-mq0FwMamOQ@mail.gmail.com>

Alex,

'with_collate' is one of the functions included in the withr package (
https://cran.rstudio.com/web/packages/withr/).
So you could simply write

  sort_c <- function(x) withr::with_collate("C", sort(x))

The usage semantics and implementation are essentially identical to what
Hadley described.

Jim

On Sun, Sep 20, 2015 at 1:22 PM, Hadley Wickham <h.wickham at gmail.com> wrote:

> Hi Alex,
>
> As far as I know, that's the best solution. In roxygen, I've wrapped
> it up with a couple of helpers:
>
> set_collate <- function(locale) {
>   cur <- Sys.getlocale(category = "LC_COLLATE")
>   Sys.setlocale(category = "LC_COLLATE", locale = locale)
>   cur
> }
>
> with_collate <- function(locale, code) {
>   old <- set_collate(locale)
>   on.exit(set_collate(old))
>
>   force(code)
> }
>
> sort_c <- function(x) with_collate("C", sort(x))
>
> Hadley
>
> On Fri, Sep 18, 2015 at 4:25 PM, Alex Deckmyn <alex.deckmyn at meteo.be>
> wrote:
> > Hi,
> >
> > For an update of the maps package, I have run into a bug caused by the
> locale-depent behaviour of order().
> > In a certain function, the polygon names of the world map are lexically
> sorted with order() prior to being sent to a C routine. That routine
> expects them to be sorted according to ASCII rules, but that is not the
> result I get. The main culprit is the colon used to identify sub-regions.
> For instance, in my locale (en_GB_UTF-8), I get
> >
> > "uk:northen ireland" < "ukrain" < "uk:scotland"
> >
> > which is not the order expected by C. I guess some language settings
> would also cause other unexpected results.
> >
> > Apart from the pain of fixing uk/ukrain ambiguities, is there a safe way
> to fix this order() in a package? An obvious solution seems to be
> >
> > lcc <- Sys.getlocale("LC_COLLATE")
> > Sys.setlocale("LC_COLLATE","C")
> > ord.nam <- order(nam)
> > Sys.setlocale("LC_COLLATE",lcc)
> >
> > This seems to work fine on my linux PC, but I am not sure about other
> platforms (Windows, OS-X...), though the "C" locale should be standard. Is
> this safe? Or is there a better way to get the right ordering?
> >
> > Alex
> >
> > ---
> > Dr. Alex Deckmyn e-mail: alex.deckmyn at meteo.be
> > Royal Meteorological Institute http://www.meteo.be
> > Ringlaan 3, 1180 Ukkel, Belgium tel. (32)(2)3730646
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>
>
> --
> http://had.co.nz/
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From drjimlemon at gmail.com  Fri Oct 16 12:46:38 2015
From: drjimlemon at gmail.com (Jim Lemon)
Date: Fri, 16 Oct 2015 21:46:38 +1100
Subject: [R-pkg-devel] R-devel installation and libcurl
Message-ID: <CA+8X3fVybrJW3f4-LLn81qzx=QJvd-MN8J-x6bd-99DbthZxpw@mail.gmail.com>

Hi,
I have been attempting to install R-devel to check updated packages for
CRAN. After reading the relevant section in R Installation and
Administration, searching and a lot of unsuccessful fiddling with
"configure", I thought I might as well ask.

Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Fedora 21 (Twenty One)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

configure hits the wall when checking for libcurl. I installed libcurl
v7.37.0 and while it is recognized, I have not succeeded in getting it to
find curl.h (it's in /usr/include/curl/curl.h). R Installation ahd
Administration seems to suggest that the path information should be put in
MkRules.local. However, that file is nowhere to be found. Neither can I
find any variable in "configure" that specifies where to look for curl.h.

I'm sure that this is very simple, but if anyone can provide a method to
stop the:

...
checking curl/curl.h usability... no
checking curl/curl.h presence... no
checking for curl/curl.h... no
configure: error: libcurl >= 7.28.0 library and headers are required with
support for https

error I would be most grateful.

Jim

	[[alternative HTML version deleted]]


From plummerm at iarc.fr  Fri Oct 16 18:33:44 2015
From: plummerm at iarc.fr (Martyn Plummer)
Date: Fri, 16 Oct 2015 16:33:44 +0000
Subject: [R-pkg-devel] R-devel installation and libcurl
In-Reply-To: <CA+8X3fVybrJW3f4-LLn81qzx=QJvd-MN8J-x6bd-99DbthZxpw@mail.gmail.com>
References: <CA+8X3fVybrJW3f4-LLn81qzx=QJvd-MN8J-x6bd-99DbthZxpw@mail.gmail.com>
Message-ID: <1445013224.6634.12.camel@iarc.fr>

On Fri, 2015-10-16 at 21:46 +1100, Jim Lemon wrote:
> Hi,
> I have been attempting to install R-devel to check updated packages for
> CRAN. After reading the relevant section in R Installation and
> Administration, searching and a lot of unsuccessful fiddling with
> "configure", I thought I might as well ask.
> 
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Fedora 21 (Twenty One)
> 
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> 
> configure hits the wall when checking for libcurl. I installed libcurl
> v7.37.0 and while it is recognized, I have not succeeded in getting it to
> find curl.h (it's in /usr/include/curl/curl.h). R Installation ahd
> Administration seems to suggest that the path information should be put in
> MkRules.local. However, that file is nowhere to be found. Neither can I
> find any variable in "configure" that specifies where to look for curl.h.
> 
> I'm sure that this is very simple, but if anyone can provide a method to
> stop the:
> 
> ...
> checking curl/curl.h usability... no
> checking curl/curl.h presence... no
> checking for curl/curl.h... no
> configure: error: libcurl >= 7.28.0 library and headers are required with
> support for https
> 
> error I would be most grateful.

This may be a little bit off topic for this list, since it is not an
issue with your package, but I'll try to answer anyway.

The header file /usr/include/curl/curl.h is provided by both the 32-bit
and 64-bit versions of libcurl-devel. I can reproduce your error if I
have libcurl-devel.i686 installed (which provides the header) but not
libcurl-devel.x86_64 (which is needed to compile the 64-bit version of
R). This gives me the following output:

checking for curl-config... /usr/bin/curl-config
checking libcurl version ... 7.37.0
Package libcurl was not found in the pkg-config search path.
Perhaps you should add the directory containing `libcurl.pc'
to the PKG_CONFIG_PATH environment variable
No package 'libcurl' found
checking curl/curl.h usability... no
checking curl/curl.h presence... no
checking for curl/curl.h... no
configure: error: libcurl >= 7.28.0 library and headers are required
with support for https

Martyn

> Jim
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-----------------------------------------------------------------------
This message and its attachments are strictly confidenti...{{dropped:8}}


From famuvie at gmail.com  Fri Oct 16 19:18:58 2015
From: famuvie at gmail.com (=?UTF-8?Q?Facundo_Mu=c3=b1oz?=)
Date: Fri, 16 Oct 2015 19:18:58 +0200
Subject: [R-pkg-devel] Fwd: src/install.libs.R
In-Reply-To: <56139743.6080203@gmail.com>
References: <56139743.6080203@gmail.com>
Message-ID: <56213182.4060802@gmail.com>

I relaunch this question for which I had no answers.
Just in case someone who can give some insight missed it before.

Thanks in advance
        ?acu.-



-------- Mensaje reenviado --------
Asunto: 	src/install.libs.R
Fecha: 	Tue, 6 Oct 2015 11:41:23 +0200
De: 	Facundo Mu?oz <famuvie at gmail.com>
Para: 	r-package-devel at r-project.org



Dear all,

I need to make use of the |src/install.libs.R| file, in order to perform
certain tasks at installation time.
I followed the R-exts doc
<http://cran.univ-paris1.fr/doc/manuals/r-release/R-exts.html#Package-subdirectories>.
However, R CMD INSTALL seems to never run the script.

Here is a minimal reproducible example.
It makes use of |devtools| to simplify the example, but I have tried the
installation manually as well.

|## Create a minimal buildable package library(devtools)
create('testpkg') ## Write src/install.libs.R dir.create('testpkg/src')
test.file <- path.expand('~/testfile.txt') diag.lines <- c(
deparse(quote(stop('This should break the installation'))),
deparse(quote(file.create(test.file))) ) writeLines(diag.lines,
'testpkg/src/install.libs.R') ## Install package ## also tried manually
with R CMD INSTALL install('testpkg') ## The installation did not break
## nor the file has been created file.exists('~/testfile.txt') # FALSE
## Cleanup remove.packages('testpkg') unlink('testpkg', recursive = TRUE) |

Am I missing something?

thanks in advance
?acu.-

PS: by the way?

|> sessionInfo() R version 3.2.2 (2015-08-14) Platform:
x86_64-pc-linux-gnu (64-bit) Running under: Ubuntu 14.04.2 LTS locale:
[1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C LC_TIME=en_US.UTF-8
LC_COLLATE=en_US.UTF-8 [5] LC_MONETARY=fr_FR.UTF-8
LC_MESSAGES=en_US.UTF-8 LC_PAPER=fr_FR.UTF-8 LC_NAME=C [9] LC_ADDRESS=C
LC_TELEPHONE=C LC_MEASUREMENT=fr_FR.UTF-8 LC_IDENTIFICATION=C attached
base packages: [1] stats graphics grDevices utils datasets methods base
other attached packages: [1] devtools_1.8.0.9000 loaded via a namespace
(and not attached): [1] tools_3.2.2 memoise_0.2.1 digest_0.6.8 |

?



	[[alternative HTML version deleted]]


From pdalgd at gmail.com  Fri Oct 16 19:37:06 2015
From: pdalgd at gmail.com (peter dalgaard)
Date: Fri, 16 Oct 2015 19:37:06 +0200
Subject: [R-pkg-devel] R-devel installation and libcurl
In-Reply-To: <1445013224.6634.12.camel@iarc.fr>
References: <CA+8X3fVybrJW3f4-LLn81qzx=QJvd-MN8J-x6bd-99DbthZxpw@mail.gmail.com>
	<1445013224.6634.12.camel@iarc.fr>
Message-ID: <EA2EC212-8678-40A3-8237-CCC01E1B3638@gmail.com>


> On 16 Oct 2015, at 18:33 , Martyn Plummer <plummerM at iarc.fr> wrote:
> 
> On Fri, 2015-10-16 at 21:46 +1100, Jim Lemon wrote:
>> Hi,
>> I have been attempting to install R-devel to check updated packages for
>> CRAN. After reading the relevant section in R Installation and
>> Administration, searching and a lot of unsuccessful fiddling with
>> "configure", I thought I might as well ask.
>> 
>> Platform: x86_64-pc-linux-gnu (64-bit)
>> Running under: Fedora 21 (Twenty One)
>> 
>> locale:
>> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>> [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>> [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>> 
>> configure hits the wall when checking for libcurl. I installed libcurl
>> v7.37.0 and while it is recognized, I have not succeeded in getting it to
>> find curl.h (it's in /usr/include/curl/curl.h). R Installation ahd
>> Administration seems to suggest that the path information should be put in
>> MkRules.local. However, that file is nowhere to be found. Neither can I
>> find any variable in "configure" that specifies where to look for curl.h.
>> 
>> I'm sure that this is very simple, but if anyone can provide a method to
>> stop the:
>> 
>> ...
>> checking curl/curl.h usability... no
>> checking curl/curl.h presence... no
>> checking for curl/curl.h... no
>> configure: error: libcurl >= 7.28.0 library and headers are required with
>> support for https
>> 
>> error I would be most grateful.
> 
> This may be a little bit off topic for this list, since it is not an
> issue with your package, but I'll try to answer anyway.

Also, a generic piece of advice: configure doesn't always get its error messages precisely right. Sometimes it is useful to go through the config.log and see exactly what program failed to compile with what error message. It's not that unusual to see an include file test program failing due to wrong compiler flags or libraries. 

-pd

> The header file /usr/include/curl/curl.h is provided by both the 32-bit
> and 64-bit versions of libcurl-devel. I can reproduce your error if I
> have libcurl-devel.i686 installed (which provides the header) but not
> libcurl-devel.x86_64 (which is needed to compile the 64-bit version of
> R). This gives me the following output:
> 
> checking for curl-config... /usr/bin/curl-config
> checking libcurl version ... 7.37.0
> Package libcurl was not found in the pkg-config search path.
> Perhaps you should add the directory containing `libcurl.pc'
> to the PKG_CONFIG_PATH environment variable
> No package 'libcurl' found
> checking curl/curl.h usability... no
> checking curl/curl.h presence... no
> checking for curl/curl.h... no
> configure: error: libcurl >= 7.28.0 library and headers are required
> with support for https
> 
> Martyn
> 
>> Jim
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> -----------------------------------------------------------------------
> This message and its attachments are strictly confidenti...{{dropped:8}}
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From murdoch.duncan at gmail.com  Fri Oct 16 19:42:39 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 16 Oct 2015 13:42:39 -0400
Subject: [R-pkg-devel] Fwd: src/install.libs.R
In-Reply-To: <56213182.4060802@gmail.com>
References: <56139743.6080203@gmail.com> <56213182.4060802@gmail.com>
Message-ID: <5621370F.5080907@gmail.com>

I can't really read your code (HTML?), but there are several CRAN
packages which make use of this, for example tth, rJava, etc. I just
tried installing tth and it ran the script.  So you might want to see
how your package differs from that one.

Duncan Murdoch

On 16/10/2015 1:18 PM, Facundo Mu?oz wrote:
> I relaunch this question for which I had no answers.
> Just in case someone who can give some insight missed it before.
> 
> Thanks in advance
>         ?acu.-
> 
> 
> 
> -------- Mensaje reenviado --------
> Asunto: 	src/install.libs.R
> Fecha: 	Tue, 6 Oct 2015 11:41:23 +0200
> De: 	Facundo Mu?oz <famuvie at gmail.com>
> Para: 	r-package-devel at r-project.org
> 
> 
> 
> Dear all,
> 
> I need to make use of the |src/install.libs.R| file, in order to perform
> certain tasks at installation time.
> I followed the R-exts doc
> <http://cran.univ-paris1.fr/doc/manuals/r-release/R-exts.html#Package-subdirectories>.
> However, R CMD INSTALL seems to never run the script.
> 
> Here is a minimal reproducible example.
> It makes use of |devtools| to simplify the example, but I have tried the
> installation manually as well.
> 
> |## Create a minimal buildable package library(devtools)
> create('testpkg') ## Write src/install.libs.R dir.create('testpkg/src')
> test.file <- path.expand('~/testfile.txt') diag.lines <- c(
> deparse(quote(stop('This should break the installation'))),
> deparse(quote(file.create(test.file))) ) writeLines(diag.lines,
> 'testpkg/src/install.libs.R') ## Install package ## also tried manually
> with R CMD INSTALL install('testpkg') ## The installation did not break
> ## nor the file has been created file.exists('~/testfile.txt') # FALSE
> ## Cleanup remove.packages('testpkg') unlink('testpkg', recursive = TRUE) |
> 
> Am I missing something?
> 
> thanks in advance
> ?acu.-
> 
> PS: by the way?
> 
> |> sessionInfo() R version 3.2.2 (2015-08-14) Platform:
> x86_64-pc-linux-gnu (64-bit) Running under: Ubuntu 14.04.2 LTS locale:
> [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C LC_TIME=en_US.UTF-8
> LC_COLLATE=en_US.UTF-8 [5] LC_MONETARY=fr_FR.UTF-8
> LC_MESSAGES=en_US.UTF-8 LC_PAPER=fr_FR.UTF-8 LC_NAME=C [9] LC_ADDRESS=C
> LC_TELEPHONE=C LC_MEASUREMENT=fr_FR.UTF-8 LC_IDENTIFICATION=C attached
> base packages: [1] stats graphics grDevices utils datasets methods base
> other attached packages: [1] devtools_1.8.0.9000 loaded via a namespace
> (and not attached): [1] tools_3.2.2 memoise_0.2.1 digest_0.6.8 |
> 
> ?
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From murdoch.duncan at gmail.com  Fri Oct 16 21:32:01 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 16 Oct 2015 15:32:01 -0400
Subject: [R-pkg-devel] Fwd: src/install.libs.R
In-Reply-To: <56213182.4060802@gmail.com>
References: <56139743.6080203@gmail.com> <56213182.4060802@gmail.com>
Message-ID: <562150B1.2080402@gmail.com>

On 16/10/2015 1:18 PM, Facundo Mu?oz wrote:
> I relaunch this question for which I had no answers.
> Just in case someone who can give some insight missed it before.

We corresponded offline.  The problem with the sample is that it has no
files in src that trigger processing:  those would be Makefile,
Makefile.win, Makevars, or source files in supported languages.

If the real example doesn't have any of these (e.g. because it is just
copying a pre-compiled file from somewhere; not something you should do
in a CRAN package, but maybe reasonable in a local one), then the
easiest workaround is just to add an empty Makevars file.

Duncan Murdoch

> 
> Thanks in advance
>         ?acu.-
> 
> 
> 
> -------- Mensaje reenviado --------
> Asunto: 	src/install.libs.R
> Fecha: 	Tue, 6 Oct 2015 11:41:23 +0200
> De: 	Facundo Mu?oz <famuvie at gmail.com>
> Para: 	r-package-devel at r-project.org
> 
> 
> 
> Dear all,
> 
> I need to make use of the |src/install.libs.R| file, in order to perform
> certain tasks at installation time.
> I followed the R-exts doc
> <http://cran.univ-paris1.fr/doc/manuals/r-release/R-exts.html#Package-subdirectories>.
> However, R CMD INSTALL seems to never run the script.
> 
> Here is a minimal reproducible example.
> It makes use of |devtools| to simplify the example, but I have tried the
> installation manually as well.
> 
> |## Create a minimal buildable package library(devtools)
> create('testpkg') ## Write src/install.libs.R dir.create('testpkg/src')
> test.file <- path.expand('~/testfile.txt') diag.lines <- c(
> deparse(quote(stop('This should break the installation'))),
> deparse(quote(file.create(test.file))) ) writeLines(diag.lines,
> 'testpkg/src/install.libs.R') ## Install package ## also tried manually
> with R CMD INSTALL install('testpkg') ## The installation did not break
> ## nor the file has been created file.exists('~/testfile.txt') # FALSE
> ## Cleanup remove.packages('testpkg') unlink('testpkg', recursive = TRUE) |
> 
> Am I missing something?
> 
> thanks in advance
> ?acu.-
> 
> PS: by the way?
> 
> |> sessionInfo() R version 3.2.2 (2015-08-14) Platform:
> x86_64-pc-linux-gnu (64-bit) Running under: Ubuntu 14.04.2 LTS locale:
> [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C LC_TIME=en_US.UTF-8
> LC_COLLATE=en_US.UTF-8 [5] LC_MONETARY=fr_FR.UTF-8
> LC_MESSAGES=en_US.UTF-8 LC_PAPER=fr_FR.UTF-8 LC_NAME=C [9] LC_ADDRESS=C
> LC_TELEPHONE=C LC_MEASUREMENT=fr_FR.UTF-8 LC_IDENTIFICATION=C attached
> base packages: [1] stats graphics grDevices utils datasets methods base
> other attached packages: [1] devtools_1.8.0.9000 loaded via a namespace
> (and not attached): [1] tools_3.2.2 memoise_0.2.1 digest_0.6.8 |
> 
> ?
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From drjimlemon at gmail.com  Sun Oct 18 08:37:33 2015
From: drjimlemon at gmail.com (Jim Lemon)
Date: Sun, 18 Oct 2015 17:37:33 +1100
Subject: [R-pkg-devel] R-devel installation and libcurl
In-Reply-To: <EA2EC212-8678-40A3-8237-CCC01E1B3638@gmail.com>
References: <CA+8X3fVybrJW3f4-LLn81qzx=QJvd-MN8J-x6bd-99DbthZxpw@mail.gmail.com>
	<1445013224.6634.12.camel@iarc.fr>
	<EA2EC212-8678-40A3-8237-CCC01E1B3638@gmail.com>
Message-ID: <CA+8X3fU9R_tK-q3fecFiSgbR_No5rMe9x8a9DqXVK4pnWBzu7Q@mail.gmail.com>

Hi Martyn,
Thanks for the tip, that was the problem. I had the wrong libcurl-devel
installed.

Jim

On Sat, Oct 17, 2015 at 4:37 AM, peter dalgaard <pdalgd at gmail.com> wrote:

>
> > On 16 Oct 2015, at 18:33 , Martyn Plummer <plummerM at iarc.fr> wrote:
> >
> > On Fri, 2015-10-16 at 21:46 +1100, Jim Lemon wrote:
> >> Hi,
> >> I have been attempting to install R-devel to check updated packages for
> >> CRAN. After reading the relevant section in R Installation and
> >> Administration, searching and a lot of unsuccessful fiddling with
> >> "configure", I thought I might as well ask.
> >>
> >> Platform: x86_64-pc-linux-gnu (64-bit)
> >> Running under: Fedora 21 (Twenty One)
> >>
> >> locale:
> >> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> >> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> >> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> >> [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> >> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> >> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> >>
> >> configure hits the wall when checking for libcurl. I installed libcurl
> >> v7.37.0 and while it is recognized, I have not succeeded in getting it
> to
> >> find curl.h (it's in /usr/include/curl/curl.h). R Installation ahd
> >> Administration seems to suggest that the path information should be put
> in
> >> MkRules.local. However, that file is nowhere to be found. Neither can I
> >> find any variable in "configure" that specifies where to look for
> curl.h.
> >>
> >> I'm sure that this is very simple, but if anyone can provide a method to
> >> stop the:
> >>
> >> ...
> >> checking curl/curl.h usability... no
> >> checking curl/curl.h presence... no
> >> checking for curl/curl.h... no
> >> configure: error: libcurl >= 7.28.0 library and headers are required
> with
> >> support for https
> >>
> >> error I would be most grateful.
> >
> > This may be a little bit off topic for this list, since it is not an
> > issue with your package, but I'll try to answer anyway.
>
> Also, a generic piece of advice: configure doesn't always get its error
> messages precisely right. Sometimes it is useful to go through the
> config.log and see exactly what program failed to compile with what error
> message. It's not that unusual to see an include file test program failing
> due to wrong compiler flags or libraries.
>
> -pd
>
> > The header file /usr/include/curl/curl.h is provided by both the 32-bit
> > and 64-bit versions of libcurl-devel. I can reproduce your error if I
> > have libcurl-devel.i686 installed (which provides the header) but not
> > libcurl-devel.x86_64 (which is needed to compile the 64-bit version of
> > R). This gives me the following output:
> >
> > checking for curl-config... /usr/bin/curl-config
> > checking libcurl version ... 7.37.0
> > Package libcurl was not found in the pkg-config search path.
> > Perhaps you should add the directory containing `libcurl.pc'
> > to the PKG_CONFIG_PATH environment variable
> > No package 'libcurl' found
> > checking curl/curl.h usability... no
> > checking curl/curl.h presence... no
> > checking for curl/curl.h... no
> > configure: error: libcurl >= 7.28.0 library and headers are required
> > with support for https
> >
> > Martyn
> >
> >> Jim
> >>
> >>      [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
> > -----------------------------------------------------------------------
> > This message and its attachments are strictly confidenti...{{dropped:8}}
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> --
> Peter Dalgaard, Professor,
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
>
>
>
>
>
>
>
>
>

	[[alternative HTML version deleted]]


From DOgle at northland.edu  Thu Oct 22 00:15:51 2015
From: DOgle at northland.edu (Derek Ogle)
Date: Wed, 21 Oct 2015 22:15:51 +0000
Subject: [R-pkg-devel] CRAN checks question
Message-ID: <5C759AAB3680854DA1CFD152DD5CCE5A012D6010DE@NC-MAIL2010.northland.edu>

I was hoping to submit a new version of my FSA package today when I noticed that the current version on CRAN has an error on the CRAN checks page (which I don't believe was there when I first submitted that version of the package).  The error is detailed here (https://cran.r-project.org/web/checks/check_results_FSA.html) and copied below.  The error is only for the "r-devel-windows-ix86+x86_64" flavor and appears to be related to missing gdata and testthat packages.  I looked at both the gdata and testthat packages on CRAN and they have clean CRAN checks.  I looked at a handful of other packages that depend on gdata and testthat and they appear to have clean CRAN checks.  I checked the package on win-builder and it did not return any errors.  Any pointers?

---------------------------------
Version: 0.8.1 
Check: examples 
Result: ERROR 
????Running examples in 'FSA-Ex.R' failed
????The error most likely occurred in:
????
????> ### Name: Subset
????> ### Title: Subsets/filters a data frame and drops the unused levels.
????> ### Aliases: Subset filterD
????> ### Keywords: misc
????> 
????> ### ** Examples
????> 
????> ## The problem -- note use of unused level in the final table.
????> levels(iris$Species)
????[1] "setosa" "versicolor" "virginica" 
????> iris.set1 <- subset(iris,Species=="setosa" | Species=="versicolor")
????> levels(iris.set1$Species)
????[1] "setosa" "versicolor" "virginica" 
????> xtabs(~Species,data=iris)
????Species
???? setosa versicolor virginica 
???? 50 50 50 
????> 
????> ## A simpler fix using Subset
????> iris.set2 <- Subset(iris,Species=="setosa" | Species=="versicolor")
????Loading required namespace: gdata
????Failed with error: 'there is no package called 'gdata''
????Error: 'filterD' requires the 'gdata' package to be installed!
????Execution halted 
Flavor: r-devel-windows-ix86+x86_64 
Version: 0.8.1 
Check: tests 
Result: ERROR 
????Running the tests in 'tests/test-all.R' failed.
????Last 13 lines of output:
???? Type 'license()' or 'licence()' for distribution details.
???? 
???? R is a collaborative project with many contributors.
???? Type 'contributors()' for more information and
???? 'citation()' on how to cite R or R packages in publications.
???? 
???? Type 'demo()' for some demos, 'help()' for on-line help, or
???? 'help.start()' for an HTML browser interface to help.
???? Type 'q()' to quit R.
???? 
???? > library(testthat)
???? Error in library(testthat) : there is no package called 'testthat'
???? Execution halted 
Flavor: r-devel-windows-ix86+x86_64 
Version: 0.8.1
---------------------------------

Dr. Derek H. Ogle
Professor of Mathematical Sciences & Natural Resources
Northland College
1411 Ellis Ave
Ashland, WI  54806

e-mail: dogle at northland.edu
web: derekogle.com
fishr: derekogle.com/fishR/
Introduction to Fisheries Analysis with R book: derekogle/com/IFAR/


From h.wickham at gmail.com  Thu Oct 22 15:31:22 2015
From: h.wickham at gmail.com (Hadley Wickham)
Date: Thu, 22 Oct 2015 08:31:22 -0500
Subject: [R-pkg-devel] CRAN checks question
In-Reply-To: <5C759AAB3680854DA1CFD152DD5CCE5A012D6010DE@NC-MAIL2010.northland.edu>
References: <5C759AAB3680854DA1CFD152DD5CCE5A012D6010DE@NC-MAIL2010.northland.edu>
Message-ID: <CABdHhvHmN-R=ZNaf9acc+8DxTR+z3vyBVbkX5pDFkAyFOwXTpA@mail.gmail.com>

I've also seen some problems with missing testthat on
r-devel-windows-ix86+x86_64 - I'd say it's a temporary problem on the
CRAN end, and if your package is ok on win builder, you should be ok
to submit.

Hadley

On Wed, Oct 21, 2015 at 5:15 PM, Derek Ogle <DOgle at northland.edu> wrote:
> I was hoping to submit a new version of my FSA package today when I noticed that the current version on CRAN has an error on the CRAN checks page (which I don't believe was there when I first submitted that version of the package).  The error is detailed here (https://cran.r-project.org/web/checks/check_results_FSA.html) and copied below.  The error is only for the "r-devel-windows-ix86+x86_64" flavor and appears to be related to missing gdata and testthat packages.  I looked at both the gdata and testthat packages on CRAN and they have clean CRAN checks.  I looked at a handful of other packages that depend on gdata and testthat and they appear to have clean CRAN checks.  I checked the package on win-builder and it did not return any errors.  Any pointers?
>
> ---------------------------------
> Version: 0.8.1
> Check: examples
> Result: ERROR
>     Running examples in 'FSA-Ex.R' failed
>     The error most likely occurred in:
>
>     > ### Name: Subset
>     > ### Title: Subsets/filters a data frame and drops the unused levels.
>     > ### Aliases: Subset filterD
>     > ### Keywords: misc
>     >
>     > ### ** Examples
>     >
>     > ## The problem -- note use of unused level in the final table.
>     > levels(iris$Species)
>     [1] "setosa" "versicolor" "virginica"
>     > iris.set1 <- subset(iris,Species=="setosa" | Species=="versicolor")
>     > levels(iris.set1$Species)
>     [1] "setosa" "versicolor" "virginica"
>     > xtabs(~Species,data=iris)
>     Species
>      setosa versicolor virginica
>      50 50 50
>     >
>     > ## A simpler fix using Subset
>     > iris.set2 <- Subset(iris,Species=="setosa" | Species=="versicolor")
>     Loading required namespace: gdata
>     Failed with error: 'there is no package called 'gdata''
>     Error: 'filterD' requires the 'gdata' package to be installed!
>     Execution halted
> Flavor: r-devel-windows-ix86+x86_64
> Version: 0.8.1
> Check: tests
> Result: ERROR
>     Running the tests in 'tests/test-all.R' failed.
>     Last 13 lines of output:
>      Type 'license()' or 'licence()' for distribution details.
>
>      R is a collaborative project with many contributors.
>      Type 'contributors()' for more information and
>      'citation()' on how to cite R or R packages in publications.
>
>      Type 'demo()' for some demos, 'help()' for on-line help, or
>      'help.start()' for an HTML browser interface to help.
>      Type 'q()' to quit R.
>
>      > library(testthat)
>      Error in library(testthat) : there is no package called 'testthat'
>      Execution halted
> Flavor: r-devel-windows-ix86+x86_64
> Version: 0.8.1
> ---------------------------------
>
> Dr. Derek H. Ogle
> Professor of Mathematical Sciences & Natural Resources
> Northland College
> 1411 Ellis Ave
> Ashland, WI  54806
>
> e-mail: dogle at northland.edu
> web: derekogle.com
> fishr: derekogle.com/fishR/
> Introduction to Fisheries Analysis with R book: derekogle/com/IFAR/
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
http://had.co.nz/


From ligges at statistik.tu-dortmund.de  Thu Oct 22 17:30:59 2015
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 22 Oct 2015 17:30:59 +0200
Subject: [R-pkg-devel] CRAN checks question
In-Reply-To: <CABdHhvHmN-R=ZNaf9acc+8DxTR+z3vyBVbkX5pDFkAyFOwXTpA@mail.gmail.com>
References: <5C759AAB3680854DA1CFD152DD5CCE5A012D6010DE@NC-MAIL2010.northland.edu>
	<CABdHhvHmN-R=ZNaf9acc+8DxTR+z3vyBVbkX5pDFkAyFOwXTpA@mail.gmail.com>
Message-ID: <56290133.5030508@statistik.tu-dortmund.de>

We are testing a very strict check setting, this will be reverted shortly.

Best,
Uwe Ligges



On 22.10.2015 15:31, Hadley Wickham wrote:
> I've also seen some problems with missing testthat on
> r-devel-windows-ix86+x86_64 - I'd say it's a temporary problem on the
> CRAN end, and if your package is ok on win builder, you should be ok
> to submit.
>
> Hadley
>
> On Wed, Oct 21, 2015 at 5:15 PM, Derek Ogle <DOgle at northland.edu> wrote:
>> I was hoping to submit a new version of my FSA package today when I noticed that the current version on CRAN has an error on the CRAN checks page (which I don't believe was there when I first submitted that version of the package).  The error is detailed here (https://cran.r-project.org/web/checks/check_results_FSA.html) and copied below.  The error is only for the "r-devel-windows-ix86+x86_64" flavor and appears to be related to missing gdata and testthat packages.  I looked at both the gdata and testthat packages on CRAN and they have clean CRAN checks.  I looked at a handful of other packages that depend on gdata and testthat and they appear to have clean CRAN checks.  I checked the package on win-builder and it did not return any errors.  Any pointers?
>>
>> ---------------------------------
>> Version: 0.8.1
>> Check: examples
>> Result: ERROR
>>      Running examples in 'FSA-Ex.R' failed
>>      The error most likely occurred in:
>>
>>      > ### Name: Subset
>>      > ### Title: Subsets/filters a data frame and drops the unused levels.
>>      > ### Aliases: Subset filterD
>>      > ### Keywords: misc
>>      >
>>      > ### ** Examples
>>      >
>>      > ## The problem -- note use of unused level in the final table.
>>      > levels(iris$Species)
>>      [1] "setosa" "versicolor" "virginica"
>>      > iris.set1 <- subset(iris,Species=="setosa" | Species=="versicolor")
>>      > levels(iris.set1$Species)
>>      [1] "setosa" "versicolor" "virginica"
>>      > xtabs(~Species,data=iris)
>>      Species
>>       setosa versicolor virginica
>>       50 50 50
>>      >
>>      > ## A simpler fix using Subset
>>      > iris.set2 <- Subset(iris,Species=="setosa" | Species=="versicolor")
>>      Loading required namespace: gdata
>>      Failed with error: 'there is no package called 'gdata''
>>      Error: 'filterD' requires the 'gdata' package to be installed!
>>      Execution halted
>> Flavor: r-devel-windows-ix86+x86_64
>> Version: 0.8.1
>> Check: tests
>> Result: ERROR
>>      Running the tests in 'tests/test-all.R' failed.
>>      Last 13 lines of output:
>>       Type 'license()' or 'licence()' for distribution details.
>>
>>       R is a collaborative project with many contributors.
>>       Type 'contributors()' for more information and
>>       'citation()' on how to cite R or R packages in publications.
>>
>>       Type 'demo()' for some demos, 'help()' for on-line help, or
>>       'help.start()' for an HTML browser interface to help.
>>       Type 'q()' to quit R.
>>
>>       > library(testthat)
>>       Error in library(testthat) : there is no package called 'testthat'
>>       Execution halted
>> Flavor: r-devel-windows-ix86+x86_64
>> Version: 0.8.1
>> ---------------------------------
>>
>> Dr. Derek H. Ogle
>> Professor of Mathematical Sciences & Natural Resources
>> Northland College
>> 1411 Ellis Ave
>> Ashland, WI  54806
>>
>> e-mail: dogle at northland.edu
>> web: derekogle.com
>> fishr: derekogle.com/fishR/
>> Introduction to Fisheries Analysis with R book: derekogle/com/IFAR/
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>
>


From d.luedecke at uke.de  Fri Oct 23 10:30:56 2015
From: d.luedecke at uke.de (=?UTF-8?Q?Daniel_L=c3=bcdecke?=)
Date: Fri, 23 Oct 2015 10:30:56 +0200
Subject: [R-pkg-devel] S3 method, useMethod and <-, using Roxygen
Message-ID: <5629F040.1030708@uke.de>

Hello,
I don't exactly know how to name my problem, so I try to describe it.

In my package (sjmisc), I have a function to set label attributes to 
vectors:

set_labels <- function(x, labels, ...) {
...
}

Usage would be:
x <- set_labels(x, c("lo", "high"))


No I wanted to also add functionality to directly change a value:
set_labels(x) <- c("lo", "high")


So I added this to my package source:

#' @rdname set_labels
#' @export
`set_labels<-` <- function(x, force.labels = FALSE, force.values = TRUE, 
value) {
   UseMethod("set_labels<-")
}

#' @rdname set_labels
#' @export
`set_labels<-.default` <- function(x, force.labels = FALSE, force.values 
= TRUE, value) {
   x <- set_labels(x, values, force.labels, force.values)
   x
}


However, running the check gives following note and warnings:

* checking R code for possible problems ... NOTE
set_labels<-.default: no visible binding for global variable 'values'
* checking Rd files ... OK
* checking Rd metadata ... OK
* checking Rd line widths ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... WARNING
Functions or methods with usage in documentation object 'set_labels' but 
not in code:
   set_labels.default

* checking Rd \usage sections ... WARNING
Objects in \usage without \alias in documentation object 'set_labels':
   'set_labels.default'

Bad \usage lines found in documentation object 'set_labels':
     <- value

Functions with \usage entries need to have the appropriate \alias
entries, and all their arguments documented.
The \usage entries must correspond to syntactically valid R code.
See chapter 'Writing R documentation files' in the 'Writing R
Extensions' manual.


I don't know what to do here. Any help is appreciated!

Thanks in advance
Daniel
--

_____________________________________________________________________

Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
Vorstandsmitglieder: Prof. Dr. Burkhard G?ke (Vorsitzender), Prof. Dr. Dr. Uwe Koch-Gromus, Joachim Pr?l?, Rainer Schoppik
_____________________________________________________________________

SAVE PAPER - THINK BEFORE PRINTING

From kirill.mueller at ivt.baug.ethz.ch  Fri Oct 23 10:37:13 2015
From: kirill.mueller at ivt.baug.ethz.ch (=?UTF-8?Q?Kirill_M=c3=bcller?=)
Date: Fri, 23 Oct 2015 10:37:13 +0200
Subject: [R-pkg-devel] S3 method, useMethod and <-, using Roxygen
In-Reply-To: <5629F040.1030708@uke.de>
References: <5629F040.1030708@uke.de>
Message-ID: <5629F1B9.2060408@ivt.baug.ethz.ch>

values -> value is a typo in the implementation of .default(). I'm not 
sure you need to document the .default() function (the second @rdname 
set_labels). If this doesn't help, you could try renaming set_labels() 
to avoid collisions.


Best regards

Kirill


On 23.10.2015 10:30, Daniel L?decke wrote:
> Hello,
> I don't exactly know how to name my problem, so I try to describe it.
>
> In my package (sjmisc), I have a function to set label attributes to 
> vectors:
>
> set_labels <- function(x, labels, ...) {
> ...
> }
>
> Usage would be:
> x <- set_labels(x, c("lo", "high"))
>
>
> No I wanted to also add functionality to directly change a value:
> set_labels(x) <- c("lo", "high")
>
>
> So I added this to my package source:
>
> #' @rdname set_labels
> #' @export
> `set_labels<-` <- function(x, force.labels = FALSE, force.values = 
> TRUE, value) {
>   UseMethod("set_labels<-")
> }
>
> #' @rdname set_labels
> #' @export
> `set_labels<-.default` <- function(x, force.labels = FALSE, 
> force.values = TRUE, value) {
>   x <- set_labels(x, values, force.labels, force.values)
>   x
> }
>
>
> However, running the check gives following note and warnings:
>
> * checking R code for possible problems ... NOTE
> set_labels<-.default: no visible binding for global variable 'values'
> * checking Rd files ... OK
> * checking Rd metadata ... OK
> * checking Rd line widths ... OK
> * checking Rd cross-references ... OK
> * checking for missing documentation entries ... OK
> * checking for code/documentation mismatches ... WARNING
> Functions or methods with usage in documentation object 'set_labels' 
> but not in code:
>   set_labels.default
>
> * checking Rd \usage sections ... WARNING
> Objects in \usage without \alias in documentation object 'set_labels':
>   'set_labels.default'
>
> Bad \usage lines found in documentation object 'set_labels':
>     <- value
>
> Functions with \usage entries need to have the appropriate \alias
> entries, and all their arguments documented.
> The \usage entries must correspond to syntactically valid R code.
> See chapter 'Writing R documentation files' in the 'Writing R
> Extensions' manual.
>
>
> I don't know what to do here. Any help is appreciated!
>
> Thanks in advance
> Daniel
> -- 
>
> _____________________________________________________________________
>
> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen 
> Rechts; Gerichtsstand: Hamburg | www.uke.de
> Vorstandsmitglieder: Prof. Dr. Burkhard G?ke (Vorsitzender), Prof. Dr. 
> Dr. Uwe Koch-Gromus, Joachim Pr?l?, Rainer Schoppik
> _____________________________________________________________________
>
> SAVE PAPER - THINK BEFORE PRINTING
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From d.luedecke at uke.de  Fri Oct 23 10:37:49 2015
From: d.luedecke at uke.de (=?UTF-8?Q?Daniel_L=c3=bcdecke?=)
Date: Fri, 23 Oct 2015 10:37:49 +0200
Subject: [R-pkg-devel] S3 method, useMethod and <-, using Roxygen
In-Reply-To: <5629F040.1030708@uke.de>
References: <5629F040.1030708@uke.de>
Message-ID: <5629F1DD.1070908@uke.de>

Ok, the "Note" is due a typo (x <- set_labels(x, values,... "values" 
should be "value").

But still after fixing this, the two warnings remain.

Am 23.10.2015 um 10:30 schrieb Daniel L?decke:
> Hello,
> I don't exactly know how to name my problem, so I try to describe it.
>
> In my package (sjmisc), I have a function to set label attributes to
> vectors:
>
> set_labels <- function(x, labels, ...) {
> ...
> }
>
> Usage would be:
> x <- set_labels(x, c("lo", "high"))
>
>
> No I wanted to also add functionality to directly change a value:
> set_labels(x) <- c("lo", "high")
>
>
> So I added this to my package source:
>
> #' @rdname set_labels
> #' @export
> `set_labels<-` <- function(x, force.labels = FALSE, force.values = TRUE,
> value) {
>    UseMethod("set_labels<-")
> }
>
> #' @rdname set_labels
> #' @export
> `set_labels<-.default` <- function(x, force.labels = FALSE, force.values
> = TRUE, value) {
>    x <- set_labels(x, values, force.labels, force.values)
>    x
> }
>
>
> However, running the check gives following note and warnings:
>
> * checking R code for possible problems ... NOTE
> set_labels<-.default: no visible binding for global variable 'values'
> * checking Rd files ... OK
> * checking Rd metadata ... OK
> * checking Rd line widths ... OK
> * checking Rd cross-references ... OK
> * checking for missing documentation entries ... OK
> * checking for code/documentation mismatches ... WARNING
> Functions or methods with usage in documentation object 'set_labels' but
> not in code:
>    set_labels.default
>
> * checking Rd \usage sections ... WARNING
> Objects in \usage without \alias in documentation object 'set_labels':
>    'set_labels.default'
>
> Bad \usage lines found in documentation object 'set_labels':
>      <- value
>
> Functions with \usage entries need to have the appropriate \alias
> entries, and all their arguments documented.
> The \usage entries must correspond to syntactically valid R code.
> See chapter 'Writing R documentation files' in the 'Writing R
> Extensions' manual.
>
>
> I don't know what to do here. Any help is appreciated!
>
> Thanks in advance
> Daniel
--

_____________________________________________________________________

Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
Vorstandsmitglieder: Prof. Dr. Burkhard G?ke (Vorsitzender), Prof. Dr. Dr. Uwe Koch-Gromus, Joachim Pr?l?, Rainer Schoppik
_____________________________________________________________________

SAVE PAPER - THINK BEFORE PRINTING

From h.wickham at gmail.com  Fri Oct 23 13:10:19 2015
From: h.wickham at gmail.com (Hadley Wickham)
Date: Fri, 23 Oct 2015 06:10:19 -0500
Subject: [R-pkg-devel] S3 method, useMethod and <-, using Roxygen
In-Reply-To: <5629F040.1030708@uke.de>
References: <5629F040.1030708@uke.de>
Message-ID: <CABdHhvFbFBSmE7F=_UUpzONGNF6S1LVZLJcD=ovpvBs5_V0GkA@mail.gmail.com>

Here's a minimal reprex:

out <- roc_proc_text(rd_roclet(), "
  #' Foo
  `foo<-` <- function(x, y, value) {
    UseMethod('set_labels<-')
  }

  #' Foo
  `foo<-.default` <- function(x, y, value) {
    x
  }
  ")[[2]]

cat(format(out))

That generates

\usage{
\method{foo}{default}(x, y) <- value
}

which I believe is correct, although I don't think I've ever seen such
a construct in the wild.

Duncan: does that look right to you? (i.e. is that what the usage of
method of a replacement function should look like?)

Hadley

On Fri, Oct 23, 2015 at 3:30 AM, Daniel L?decke <d.luedecke at uke.de> wrote:
> Hello,
> I don't exactly know how to name my problem, so I try to describe it.
>
> In my package (sjmisc), I have a function to set label attributes to
> vectors:
>
> set_labels <- function(x, labels, ...) {
> ...
> }
>
> Usage would be:
> x <- set_labels(x, c("lo", "high"))
>
>
> No I wanted to also add functionality to directly change a value:
> set_labels(x) <- c("lo", "high")
>
>
> So I added this to my package source:
>
> #' @rdname set_labels
> #' @export
> `set_labels<-` <- function(x, force.labels = FALSE, force.values = TRUE,
> value) {
>   UseMethod("set_labels<-")
> }
>
> #' @rdname set_labels
> #' @export
> `set_labels<-.default` <- function(x, force.labels = FALSE, force.values =
> TRUE, value) {
>   x <- set_labels(x, values, force.labels, force.values)
>   x
> }
>
>
> However, running the check gives following note and warnings:
>
> * checking R code for possible problems ... NOTE
> set_labels<-.default: no visible binding for global variable 'values'
> * checking Rd files ... OK
> * checking Rd metadata ... OK
> * checking Rd line widths ... OK
> * checking Rd cross-references ... OK
> * checking for missing documentation entries ... OK
> * checking for code/documentation mismatches ... WARNING
> Functions or methods with usage in documentation object 'set_labels' but not
> in code:
>   set_labels.default
>
> * checking Rd \usage sections ... WARNING
> Objects in \usage without \alias in documentation object 'set_labels':
>   'set_labels.default'
>
> Bad \usage lines found in documentation object 'set_labels':
>     <- value
>
> Functions with \usage entries need to have the appropriate \alias
> entries, and all their arguments documented.
> The \usage entries must correspond to syntactically valid R code.
> See chapter 'Writing R documentation files' in the 'Writing R
> Extensions' manual.
>
>
> I don't know what to do here. Any help is appreciated!
>
> Thanks in advance
> Daniel
> --
>
> _____________________________________________________________________
>
> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen
> Rechts; Gerichtsstand: Hamburg | www.uke.de
> Vorstandsmitglieder: Prof. Dr. Burkhard G?ke (Vorsitzender), Prof. Dr. Dr.
> Uwe Koch-Gromus, Joachim Pr?l?, Rainer Schoppik
> _____________________________________________________________________
>
> SAVE PAPER - THINK BEFORE PRINTING
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
http://had.co.nz/


From d.luedecke at uke.de  Fri Oct 23 14:29:22 2015
From: d.luedecke at uke.de (=?UTF-8?Q?Daniel_L=c3=bcdecke?=)
Date: Fri, 23 Oct 2015 14:29:22 +0200
Subject: [R-pkg-devel] S3 method, useMethod and <-, using Roxygen
In-Reply-To: <5629F1B9.2060408@ivt.baug.ethz.ch>
References: <5629F040.1030708@uke.de> <5629F1B9.2060408@ivt.baug.ethz.ch>
Message-ID: <562A2822.1070408@uke.de>

Ok, this seems to work!

Though I don't know why there's a warning, because in another function I 
use @rdname as described before, which doesn't give a warning.

Best
Daniel

Am 23.10.2015 um 10:37 schrieb Kirill M?ller:
> values -> value is a typo in the implementation of .default(). I'm not
> sure you need to document the .default() function (the second @rdname
> set_labels). If this doesn't help, you could try renaming set_labels()
> to avoid collisions.
>
>
> Best regards
>
> Kirill
>
>
> On 23.10.2015 10:30, Daniel L?decke wrote:
>> Hello,
>> I don't exactly know how to name my problem, so I try to describe it.
>>
>> In my package (sjmisc), I have a function to set label attributes to
>> vectors:
>>
>> set_labels <- function(x, labels, ...) {
>> ...
>> }
>>
>> Usage would be:
>> x <- set_labels(x, c("lo", "high"))
>>
>>
>> No I wanted to also add functionality to directly change a value:
>> set_labels(x) <- c("lo", "high")
>>
>>
>> So I added this to my package source:
>>
>> #' @rdname set_labels
>> #' @export
>> `set_labels<-` <- function(x, force.labels = FALSE, force.values =
>> TRUE, value) {
>>   UseMethod("set_labels<-")
>> }
>>
>> #' @rdname set_labels
>> #' @export
>> `set_labels<-.default` <- function(x, force.labels = FALSE,
>> force.values = TRUE, value) {
>>   x <- set_labels(x, values, force.labels, force.values)
>>   x
>> }
>>
>>
>> However, running the check gives following note and warnings:
>>
>> * checking R code for possible problems ... NOTE
>> set_labels<-.default: no visible binding for global variable 'values'
>> * checking Rd files ... OK
>> * checking Rd metadata ... OK
>> * checking Rd line widths ... OK
>> * checking Rd cross-references ... OK
>> * checking for missing documentation entries ... OK
>> * checking for code/documentation mismatches ... WARNING
>> Functions or methods with usage in documentation object 'set_labels'
>> but not in code:
>>   set_labels.default
>>
>> * checking Rd \usage sections ... WARNING
>> Objects in \usage without \alias in documentation object 'set_labels':
>>   'set_labels.default'
>>
>> Bad \usage lines found in documentation object 'set_labels':
>>     <- value
>>
>> Functions with \usage entries need to have the appropriate \alias
>> entries, and all their arguments documented.
>> The \usage entries must correspond to syntactically valid R code.
>> See chapter 'Writing R documentation files' in the 'Writing R
>> Extensions' manual.
>>
>>
>> I don't know what to do here. Any help is appreciated!
>>
>> Thanks in advance
>> Daniel
>> --
>>
>> _____________________________________________________________________
>>
>> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen
>> Rechts; Gerichtsstand: Hamburg | www.uke.de
>> Vorstandsmitglieder: Prof. Dr. Burkhard G?ke (Vorsitzender), Prof. Dr.
>> Dr. Uwe Koch-Gromus, Joachim Pr?l?, Rainer Schoppik
>> _____________________________________________________________________
>>
>> SAVE PAPER - THINK BEFORE PRINTING
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

Daniel L?decke, Dr. phil.

Universit?tsklinikum Hamburg-Eppendorf
Zentrum f?r Psychosoziale Medizin
Institut f?r Medizinische Soziologie
W37, 8. Stock
Martinistr. 52
D-20246 Hamburg

Tel: +49 (0)1515 2494757
Tel: +49 (0)40 7410 52878
--

_____________________________________________________________________

Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
Vorstandsmitglieder: Prof. Dr. Burkhard G?ke (Vorsitzender), Prof. Dr. Dr. Uwe Koch-Gromus, Joachim Pr?l?, Rainer Schoppik
_____________________________________________________________________

SAVE PAPER - THINK BEFORE PRINTING

From d.luedecke at uke.de  Fri Oct 23 14:32:40 2015
From: d.luedecke at uke.de (=?UTF-8?Q?Daniel_L=c3=bcdecke?=)
Date: Fri, 23 Oct 2015 14:32:40 +0200
Subject: [R-pkg-devel] S3 method, useMethod and <-, using Roxygen
In-Reply-To: <CABdHhvFbFBSmE7F=_UUpzONGNF6S1LVZLJcD=ovpvBs5_V0GkA@mail.gmail.com>
References: <5629F040.1030708@uke.de>
	<CABdHhvFbFBSmE7F=_UUpzONGNF6S1LVZLJcD=ovpvBs5_V0GkA@mail.gmail.com>
Message-ID: <562A28E8.1070709@uke.de>


 > which I believe is correct, although I don't think I've ever seen such
 > a construct in the wild.

What would be the proper way to define such methods?

Eg, I want `set_label` to work like this:
x <- set_label(x, "my label")

and additionally, like this:
set_label(x) <- "my label"


How would I define the latter function?

(this is how it is currently done by me)

#' @export
set_label <- function(x, lab, attr.string = NULL) {
...
}

#' @rdname set_label
#' @export
`set_label<-` <- function(x, attr.string = NULL, value) {
   UseMethod("set_label<-")
}

#' @rdname set_label
#' @export
`set_label<-.default` <- function(x, attr.string = NULL, value) {
   x <- set_label(x, value, attr.string)
   x
}




Am 23.10.2015 um 13:10 schrieb Hadley Wickham:
> Here's a minimal reprex:
>
> out <- roc_proc_text(rd_roclet(), "
>    #' Foo
>    `foo<-` <- function(x, y, value) {
>      UseMethod('set_labels<-')
>    }
>
>    #' Foo
>    `foo<-.default` <- function(x, y, value) {
>      x
>    }
>    ")[[2]]
>
> cat(format(out))
>
> That generates
>
> \usage{
> \method{foo}{default}(x, y) <- value
> }
>
--

_____________________________________________________________________

Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
Vorstandsmitglieder: Prof. Dr. Burkhard G?ke (Vorsitzender), Prof. Dr. Dr. Uwe Koch-Gromus, Joachim Pr?l?, Rainer Schoppik
_____________________________________________________________________

SAVE PAPER - THINK BEFORE PRINTING

From d.luedecke at uke.de  Fri Oct 23 14:41:49 2015
From: d.luedecke at uke.de (=?UTF-8?Q?Daniel_L=c3=bcdecke?=)
Date: Fri, 23 Oct 2015 14:41:49 +0200
Subject: [R-pkg-devel] S3 method, useMethod and <-, using Roxygen
In-Reply-To: <CABdHhvFbFBSmE7F=_UUpzONGNF6S1LVZLJcD=ovpvBs5_V0GkA@mail.gmail.com>
References: <5629F040.1030708@uke.de>
	<CABdHhvFbFBSmE7F=_UUpzONGNF6S1LVZLJcD=ovpvBs5_V0GkA@mail.gmail.com>
Message-ID: <562A2B0D.4020805@uke.de>

Ok, this might be a Roxygene issue, so I would close this discussion 
here and file an issue at GitHub for further investigation. What I found 
out so far:

#' @rdname set_label
#' @export
`set_label<-` <- function(x, attr.string = NULL, value) {
   UseMethod("set_label<-")
}

#' @rdname set_label
#' @export
`set_label<-.default` <- function(x, attr.string = NULL, value) {
   x <- set_label(x, value, attr.string)
   x
}


creates following rd-file:

% Generated by roxygen2 (4.1.1): do not edit by hand
% Please edit documentation in R/set_label.R
\name{set_label}
\alias{set_label}
\alias{set_label<-}
\alias{set_label<-.default}
\alias{set_var_labels}
\title{Add variable label(s) to variables}
\usage{
set_label(x, lab, attr.string = NULL)

set_var_labels(x, lab, attr.string = NULL)

set_label(x, attr.string = NULL) <- value

\method{set_label}{default}(x, attr.string = NULL) <- value
}


while

#' @rdname set_labels
#' @export
`set_labels<-` <- function(x, force.labels = FALSE, force.values = TRUE, 
value) {
   UseMethod("set_labels<-")
}

#' @rdname set_labels
#' @export
`set_labels<-.default` <- function(x, force.labels = FALSE, force.values 
= TRUE, value) {
   x <- set_labels(x, value, force.labels, force.values)
   x
}


results in

% Generated by roxygen2 (4.1.1): do not edit by hand
% Please edit documentation in R/set_labels.R
\name{set_labels}
\alias{set_labels}
\alias{set_labels<-}
\alias{set_labels<-.default}
\alias{set_val_labels}
\title{Add value labels to variables}
\usage{
set_labels(x, labels, force.labels = FALSE, force.values = TRUE)

set_val_labels(x, labels, force.labels = FALSE, force.values = TRUE)

set_labels(x, force.labels = FALSE, force.values = TRUE) <- value

\method{set_labels}{default}(x, force.labels = FALSE, force.values = TRUE)
   <- value
}


There's a carriage return (or similar) in the generated rd-file which 
throws the warning message in the check procedure. I cam up with 
removing "#' @rdname set_labels", because 1) it works fine then and 2) 
my index-page of the package help does not list redundant function names 
multiple times.

Best
Daniel



Am 23.10.2015 um 13:10 schrieb Hadley Wickham:
> Here's a minimal reprex:
>
> out <- roc_proc_text(rd_roclet(), "
>    #' Foo
>    `foo<-` <- function(x, y, value) {
>      UseMethod('set_labels<-')
>    }
>
>    #' Foo
>    `foo<-.default` <- function(x, y, value) {
>      x
>    }
>    ")[[2]]
>
> cat(format(out))
>
> That generates
>
> \usage{
> \method{foo}{default}(x, y) <- value
> }
>
> which I believe is correct, although I don't think I've ever seen such
> a construct in the wild.
>
> Duncan: does that look right to you? (i.e. is that what the usage of
> method of a replacement function should look like?)
>
> Hadley
>
> On Fri, Oct 23, 2015 at 3:30 AM, Daniel L?decke <d.luedecke at uke.de> wrote:
>> Hello,
>> I don't exactly know how to name my problem, so I try to describe it.
>>
>> In my package (sjmisc), I have a function to set label attributes to
>> vectors:
>>
>> set_labels <- function(x, labels, ...) {
>> ...
>> }
>>
--

_____________________________________________________________________

Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
Vorstandsmitglieder: Prof. Dr. Burkhard G?ke (Vorsitzender), Prof. Dr. Dr. Uwe Koch-Gromus, Joachim Pr?l?, Rainer Schoppik
_____________________________________________________________________

SAVE PAPER - THINK BEFORE PRINTING

From j.e.aten at gmail.com  Sat Oct 24 18:31:21 2015
From: j.e.aten at gmail.com (Jason E. Aten)
Date: Sat, 24 Oct 2015 09:31:21 -0700
Subject: [R-pkg-devel] golang based package for R msgpack and websocket work
	(RMQ)
Message-ID: <CAPNEFAY7XaOGhLvm_FTSXSf7H3a9oT6FHZp6MwZ1gSgwajC+fg@mail.gmail.com>

Hello r-package-devel,

I've made a package for R that uses Go (golang), the compiled language
created by Rob Pike, Ken Thomson, Robert Griesemer, a team of Google
employees, and thousands of open source volunteer contributors. See
http://golang.org

My package, called RMQ for "R messaging and queuing" provides msgpack
(supporting version 2 of msgpack) serialization and robust web-socket based
RPC.  The existing package for msgpackR in CRAN is for the outdated msgpack
1 standard, and can be very slow for some inputs, crashing on others. RMQ
instead uses a highly optimized and compiled msgpack parsing library. RMQ
also incorporates a hardened and well-tested websocket webserver framework
from the Go world. The details of RMQ can be viewed at
https://github.com/glycerine/rmq

I view this as cutting edge work. It demonstrates for the first time how to
integrate libraries written in Go with R.

Complimenting the great library support in R, there are a quite some number
of high quality libraries in Go; especially the networking, crypto, and
big-integer libraries. Realistic integration between Go and R only became
viable last month, with the release of Go1.5.1 that supports compiling Go
code into shared libraries and simplified package vendoring.

I don't know how viable it is to contribute RMQ (or any Go based package to
CRAN). If it is not too difficult, I would be willing to try.  Go1.5.1
would need to be installed on all build hosts. I would be willing to help
setup an appropriate build environments if need be.

In summary, my question is: is it viable to add RMQ to CRAN?

Thank you for your thoughts!

Jason

	[[alternative HTML version deleted]]


From edd at debian.org  Mon Oct 26 14:59:47 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 26 Oct 2015 08:59:47 -0500
Subject: [R-pkg-devel] golang based package for R msgpack and websocket
	work	(RMQ)
In-Reply-To: <CAPNEFAY7XaOGhLvm_FTSXSf7H3a9oT6FHZp6MwZ1gSgwajC+fg@mail.gmail.com>
References: <CAPNEFAY7XaOGhLvm_FTSXSf7H3a9oT6FHZp6MwZ1gSgwajC+fg@mail.gmail.com>
Message-ID: <22062.12755.608268.416137@max.nulle.part>


Hi Jason,

On 24 October 2015 at 09:31, Jason E. Aten wrote:
| Hello r-package-devel,
| 
| I've made a package for R that uses Go (golang), the compiled language
| created by Rob Pike, Ken Thomson, Robert Griesemer, a team of Google
| employees, and thousands of open source volunteer contributors. See
| http://golang.org

Nice. I like go and looked at it a few times over these last few years. Did
you know that Google has worked on Go/R integration?  Christoph Best talked
about it at useR! 2015. No code release yet, and it depends on RPC and new
ProtoBuf.

| My package, called RMQ for "R messaging and queuing" provides msgpack
| (supporting version 2 of msgpack) serialization and robust web-socket based
| RPC.  The existing package for msgpackR in CRAN is for the outdated msgpack
| 1 standard, and can be very slow for some inputs, crashing on others. RMQ
| instead uses a highly optimized and compiled msgpack parsing library. RMQ
| also incorporates a hardened and well-tested websocket webserver framework
| from the Go world. The details of RMQ can be viewed at
| https://github.com/glycerine/rmq
| 
| I view this as cutting edge work. It demonstrates for the first time how to
| integrate libraries written in Go with R.

Let's the view of package author's of their own package an invariant :)  Most
are pretty impressed.
 
| Complimenting the great library support in R, there are a quite some number
| of high quality libraries in Go; especially the networking, crypto, and
| big-integer libraries. Realistic integration between Go and R only became
| viable last month, with the release of Go1.5.1 that supports compiling Go
| code into shared libraries and simplified package vendoring.
| 
| I don't know how viable it is to contribute RMQ (or any Go based package to
| CRAN). If it is not too difficult, I would be willing to try.  Go1.5.1
| would need to be installed on all build hosts. I would be willing to help
| setup an appropriate build environments if need be.

You "just" make that
  a) a SystemRequirements: entry and possibly add a line to say which
     Debian/Ubuntu and/or Fedora/Yum packages need to be installed
  b) possibly test for it in configure
 
| In summary, my question is: is it viable to add RMQ to CRAN?

Yes. Many other packages on CRAN depend on / work with external packages,
libraries or tools.

We'll help.  Let's work on this.

Dirk
 
| Thank you for your thoughts!
| 
| Jason
| 
| 	[[alternative HTML version deleted]]
| 
| ______________________________________________
| R-package-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From j.e.aten at gmail.com  Mon Oct 26 17:46:42 2015
From: j.e.aten at gmail.com (Jason E. Aten)
Date: Mon, 26 Oct 2015 09:46:42 -0700
Subject: [R-pkg-devel] golang based package for R msgpack and websocket
 work (RMQ)
In-Reply-To: <22062.12755.608268.416137@max.nulle.part>
References: <CAPNEFAY7XaOGhLvm_FTSXSf7H3a9oT6FHZp6MwZ1gSgwajC+fg@mail.gmail.com>
	<22062.12755.608268.416137@max.nulle.part>
Message-ID: <CAPNEFAYFnSrmhi2KUU7TtY9FC5=zzkvdrAKvrXarJ_y2W+A6mA@mail.gmail.com>

On Mon, Oct 26, 2015 at 6:59 AM, Dirk Eddelbuettel <edd at debian.org> wrote:

>  Did you know that Google has worked on Go/R integration?  Christoph Best
> talked
> about it at useR! 2015. No code release yet, and it depends on RPC and new
> ProtoBuf.


Cool. Thanks for mentioning that. I'll send him a note.


> Let's the view of package author's of their own package an invariant :)
> Most
> are pretty impressed.


HA! :-)


> You "just" make that
>   a) a SystemRequirements: entry and possibly add a line to say which
>      Debian/Ubuntu and/or Fedora/Yum packages need to be installed
>   b) possibly test for it in configure
>

I'll try to dig into the autotools docs and figure out how to add a
configure test. It's really just running "go version" and checking that the
"go" executalbe exists and the output of "go version" is 1.5.1 or later.

I added a human readable note to the SystemRequirements in the
DESCRIPTION.  It's "apt-get install golang" on ubuntu, and "yum install
golang" on fedora. Should the SystemRequirements field be in some kind of
machine parseable/CRAN build-testable syntax?

Best,
Jason

	[[alternative HTML version deleted]]


From edd at debian.org  Mon Oct 26 17:57:49 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 26 Oct 2015 11:57:49 -0500
Subject: [R-pkg-devel] golang based package for R msgpack and websocket
 work (RMQ)
In-Reply-To: <CAPNEFAYFnSrmhi2KUU7TtY9FC5=zzkvdrAKvrXarJ_y2W+A6mA@mail.gmail.com>
References: <CAPNEFAY7XaOGhLvm_FTSXSf7H3a9oT6FHZp6MwZ1gSgwajC+fg@mail.gmail.com>
	<22062.12755.608268.416137@max.nulle.part>
	<CAPNEFAYFnSrmhi2KUU7TtY9FC5=zzkvdrAKvrXarJ_y2W+A6mA@mail.gmail.com>
Message-ID: <22062.23437.33588.503831@max.nulle.part>


On 26 October 2015 at 09:46, Jason E. Aten wrote:
| Cool. Thanks for mentioning that. I'll send him a note.

+1 -- I would have CC'ed him had I had his email handy. I'll try to reach out too.

|     You "just" make that
|     ? a) a SystemRequirements: entry and possibly add a line to say which
|     ? ? ?Debian/Ubuntu and/or Fedora/Yum packages need to be installed
|     ? b) possibly test for it in configure
| 
| 
| I'll try to dig into the autotools docs and figure out how to add a configure

If it is "all greek" to you let me know. I helped a few other packages over
the years with simple configure tasks.

| test. It's really just running "go version" and checking that the "go"
| executalbe exists and the output of "go version" is 1.5.1 or later.

Pretty much. Here is what I do in RQuantLib:

    pkg_version=`quantlib-config --version`

    # also test for quantlib version using result from quantlib-config --version
    case ${pkg_version} in
    0.1.*|0.2.*|0.3.*|0.4.*|0.8.*|0.9.*|1.0.*|1.1.*|1.2.*|1.3.*)
	AC_MSG_WARN([RQuantLib requires QuantLib (>= 1.4.0).])
	AC_MSG_ERROR([Please upgrade to a current version.])
	;;
    esac

autoconf looks complicated, but is mostly just shell scripting ...
 
| I added a human readable note to the SystemRequirements in the DESCRIPTION.?
| It's "apt-get install golang" on ubuntu, and "yum install golang" on fedora.
| Should the SystemRequirements field be in some kind of machine parseable/CRAN
| build-testable syntax?

But I checked with eg

   http://metadata.ftp-master.debian.org/changelogs//main/g/golang/golang_1.5.1-1_changelog

and few systems will have 1.5.1 yet.  Ie it probably won't Ubuntu before
16.04 next year.  Are there PPAs?

Dirk

PS Oh, and I forgot to mention that I like msgPack a lot too :)   and have
played a little bit with C++ bindings via Rcpp.

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd at debian.org  Tue Oct 27 21:12:53 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 27 Oct 2015 15:12:53 -0500
Subject: [R-pkg-devel] golang based package for R msgpack and websocket
 work (RMQ)
In-Reply-To: <CAPNEFAZKLdaoSgpOhj5e4-hLh4MMtrZdpm-0HW0BsRqiDJMRjg@mail.gmail.com>
References: <CAPNEFAY7XaOGhLvm_FTSXSf7H3a9oT6FHZp6MwZ1gSgwajC+fg@mail.gmail.com>
	<22062.12755.608268.416137@max.nulle.part>
	<CAPNEFAYFnSrmhi2KUU7TtY9FC5=zzkvdrAKvrXarJ_y2W+A6mA@mail.gmail.com>
	<22062.23437.33588.503831@max.nulle.part>
	<CAPNEFAZKLdaoSgpOhj5e4-hLh4MMtrZdpm-0HW0BsRqiDJMRjg@mail.gmail.com>
Message-ID: <22063.56006.642.644525@max.nulle.part>


On 27 October 2015 at 12:51, Jason E. Aten wrote:
| Re PPAs: good question.
| 
| I did some digging. The ubuntu 14 PPA that I found (https://launchpad.net/
| ~eugenesan/+ppa-packages) was already out of date (having go1.5 not go1.5.1)
| when I tried it on a test cloud box running ubuntu 14.

I found this one which is current for go 1.5.1:
    https://launchpad.net/~ubuntu-lxc/+archive/ubuntu/lxd-stable

Debian unstable is fine; testing may be soon
 
| I think the best way to get Go on a CRAN build box is to do a simple binary
| install with the following two lines. This has the big advantage that it will
| work on any flavor of linux on amd64, since the go binaries are statically
| linked. i.e. any version of ubuntu, fedora, centos, redhat, etc. ?(Full
| details: https://golang.org/doc/install ?lists the exact architectures that the
| binary tarballs support, encompassing FreeBSD, Linux, Windows, and OSX and
| which architectures for each.)
| 
| 
| sudo curl https://storage.googleapis.com/golang/go1.5.1.linux-amd64.tar.gz | su
| do tar xz -C /usr/local/
| 
| sudo echo 'export PATH=$PATH:/usr/local/go/bin' >> /etc/profile
| 
| NB This will install the "go" binary to /usr/local/go/bin/go. The install
| location /usr/local/go is baked into the go1.5.1.linux-amd64.tar.gz binary as
| the default GOROOT location, so it can't be moved without setting the GOROOT
| env variable as well.
| 
| 
| So that's what I would recommend.? Any questions, let me know if know.

I cannot speak for CRAN but based on my experience this may be a bit of long
shot.  Maybe you can offer them a Docker image or something less intrusive at
the system level.

But I could also be too pessimistic. You should probably just ask CRAN.  But
right now, with the somewhat advanced system requirements, you may just get
asked to wait.  Dunno.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From j.e.aten at gmail.com  Tue Oct 27 20:51:20 2015
From: j.e.aten at gmail.com (Jason E. Aten)
Date: Tue, 27 Oct 2015 12:51:20 -0700
Subject: [R-pkg-devel] golang based package for R msgpack and websocket
 work (RMQ)
In-Reply-To: <22062.23437.33588.503831@max.nulle.part>
References: <CAPNEFAY7XaOGhLvm_FTSXSf7H3a9oT6FHZp6MwZ1gSgwajC+fg@mail.gmail.com>
	<22062.12755.608268.416137@max.nulle.part>
	<CAPNEFAYFnSrmhi2KUU7TtY9FC5=zzkvdrAKvrXarJ_y2W+A6mA@mail.gmail.com>
	<22062.23437.33588.503831@max.nulle.part>
Message-ID: <CAPNEFAZKLdaoSgpOhj5e4-hLh4MMtrZdpm-0HW0BsRqiDJMRjg@mail.gmail.com>

Re PPAs: good question.

I did some digging. The ubuntu 14 PPA that I found (
https://launchpad.net/~eugenesan/+ppa-packages) was already out of date
(having go1.5 not go1.5.1) when I tried it on a test cloud box running
ubuntu 14.

I think the best way to get Go on a CRAN build box is to do a simple binary
install with the following two lines. This has the big advantage that it
will work on any flavor of linux on amd64, since the go binaries are
statically linked. i.e. any version of ubuntu, fedora, centos, redhat, etc.
 (Full details: https://golang.org/doc/install  lists the exact
architectures that the binary tarballs support, encompassing FreeBSD,
Linux, Windows, and OSX and which architectures for each.)

*sudo curl https://storage.googleapis.com/golang/go1.5.1.linux-amd64.tar.gz
<https://storage.googleapis.com/golang/go1.5.1.linux-amd64.tar.gz> | su**do
tar xz -C /usr/local/*

*sudo echo 'export PATH=$PATH:/usr/local/go/bin' >> /etc/profile*
NB This will install the "go" binary to /usr/local/go/bin/go. The install
location /usr/local/go is baked into the go1.5.1.linux-amd64.tar.gz binary
as the default GOROOT location, so it can't be moved without setting the
GOROOT env variable as well.


So that's what I would recommend.  Any questions, let me know if know.

Jason


On Mon, Oct 26, 2015 at 9:57 AM, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 26 October 2015 at 09:46, Jason E. Aten wrote:
> | Cool. Thanks for mentioning that. I'll send him a note.
>
> +1 -- I would have CC'ed him had I had his email handy. I'll try to reach
> out too.
>
> |     You "just" make that
> |       a) a SystemRequirements: entry and possibly add a line to say which
> |          Debian/Ubuntu and/or Fedora/Yum packages need to be installed
> |       b) possibly test for it in configure
> |
> |
> | I'll try to dig into the autotools docs and figure out how to add a
> configure
>
> If it is "all greek" to you let me know. I helped a few other packages over
> the years with simple configure tasks.
>
> | test. It's really just running "go version" and checking that the "go"
> | executalbe exists and the output of "go version" is 1.5.1 or later.
>
> Pretty much. Here is what I do in RQuantLib:
>
>     pkg_version=`quantlib-config --version`
>
>     # also test for quantlib version using result from quantlib-config
> --version
>     case ${pkg_version} in
>     0.1.*|0.2.*|0.3.*|0.4.*|0.8.*|0.9.*|1.0.*|1.1.*|1.2.*|1.3.*)
>         AC_MSG_WARN([RQuantLib requires QuantLib (>= 1.4.0).])
>         AC_MSG_ERROR([Please upgrade to a current version.])
>         ;;
>     esac
>
> autoconf looks complicated, but is mostly just shell scripting ...
>
> | I added a human readable note to the SystemRequirements in the
> DESCRIPTION.
> | It's "apt-get install golang" on ubuntu, and "yum install golang" on
> fedora.
> | Should the SystemRequirements field be in some kind of machine
> parseable/CRAN
> | build-testable syntax?
>
> But I checked with eg
>
>
> http://metadata.ftp-master.debian.org/changelogs//main/g/golang/golang_1.5.1-1_changelog
>
> and few systems will have 1.5.1 yet.  Ie it probably won't Ubuntu before
> 16.04 next year.  Are there PPAs?
>
> Dirk
>
> PS Oh, and I forgot to mention that I like msgPack a lot too :)   and have
> played a little bit with C++ bindings via Rcpp.
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From Ross.Boylan at ucsf.edu  Fri Nov  6 00:52:45 2015
From: Ross.Boylan at ucsf.edu (Boylan, Ross)
Date: Thu, 5 Nov 2015 23:52:45 +0000
Subject: [R-pkg-devel] NAMESPACE and S4 classes
Message-ID: <F1F13E14A610474196571953929C02090BD788BA@ex08.net.ucsf.edu>

I am trying to update a package from 2010 to the new standards, including adding a NAMESPACE file.   The package has S4 classes, and I'm having some trouble interpreting the manual.

Suppose I have
setClass("MyClass", .....)
MyClass <- function(a, b, c) {...}  # constructor
and various methods for the class

Assuming I want to make the class and everything associated user-visible, I must
exportClass(MyClass)

Do I need to 
export(MyClass)
so the constructor is visible?

Do I need to 
exportMethods()
for the methods of that class?

I take it that if the class uses a name from elsewhere in the system, e.g., it has a "print" method, I must import that too.  Or is it that I only need to import generics that are not in the base package?

From ligges at statistik.tu-dortmund.de  Fri Nov  6 12:05:45 2015
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 6 Nov 2015 12:05:45 +0100
Subject: [R-pkg-devel] NAMESPACE and S4 classes
In-Reply-To: <F1F13E14A610474196571953929C02090BD788BA@ex08.net.ucsf.edu>
References: <F1F13E14A610474196571953929C02090BD788BA@ex08.net.ucsf.edu>
Message-ID: <563C8989.1040100@statistik.tu-dortmund.de>



On 06.11.2015 00:52, Boylan, Ross wrote:
> I am trying to update a package from 2010 to the new standards, including adding a NAMESPACE file.   The package has S4 classes, and I'm having some trouble interpreting the manual.
>
> Suppose I have
> setClass("MyClass", .....)
> MyClass <- function(a, b, c) {...}  # constructor
> and various methods for the class
>
> Assuming I want to make the class and everything associated user-visible, I must
> exportClass(MyClass)
>
> Do I need to
> export(MyClass)
> so the constructor is visible?

Yes, if a user shoudl have access to the constructor.

> Do I need to
> exportMethods()
> for the methods of that class?

Yes, if not only used internally by your own functions.



>
> I take it that if the class uses a name from elsewhere in the system, e.g., it has a "print" method, I must import that too.  Or is it that I only need to import generics that are not in the base package?

Right, you need to import the generics you want to use.

Best,
Uwe Ligges

> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From jwijffels at bnosac.be  Tue Nov 10 16:32:27 2015
From: jwijffels at bnosac.be (Jan Wijffels)
Date: Tue, 10 Nov 2015 16:32:27 +0100
Subject: [R-pkg-devel] extra license (ODbL) on
	https://svn.r-project.org/R/trunk/share/licenses/license.db
Message-ID: <CAJ9GNakVqMersd7A1_BLTa3OTEnHM1BpRKCEzH_wCwzcGy=Lsg@mail.gmail.com>

Hi,

I would like to add an R package to CRAN which is now available at github:
https://github.com/jwijffels/BelgiumMaps.Admin

The package contains data from OpenStreetMap which should be released under
the Open Database license (ODbL 1.0) which can be found at
http://opendatacommons.org/licenses/odbl/1-0/

Unfortunately ODbL is not part of
https://svn.r-project.org/R/trunk/share/licenses/license.db
So I presume it will be rejected by the CRAN policy which states that other
licenses than in that license.db file will generally be rejected.

Hence my question. What can I do to make ODbL part of
https://svn.r-project.org/R/trunk/share/licenses/license.db

thanks,
Jan

Jan Wijffels
Statistician
www.bnosac.be  | +32 486 611708

	[[alternative HTML version deleted]]


From jwijffels at bnosac.be  Tue Nov 10 16:57:41 2015
From: jwijffels at bnosac.be (Jan Wijffels)
Date: Tue, 10 Nov 2015 16:57:41 +0100
Subject: [R-pkg-devel] found ... marked UTF-8 strings
Message-ID: <CAJ9GNak66SQstVC-4YvnGDPwpPLxHRbR1rynmnyA6i+fqua8xw@mail.gmail.com>

?Dear,

I trying to fix all notes from R ?CMD check on a package.
The package contains a data.frame inside the data folder where character
vectors in the dataset are set with an UTF-8 encoding.
?R CMD check gives me.?


* checking data for non-ASCII characters ... NOTE  Note: found 1163
marked UTF-8 strings

I would like to keep the strings as correctly encoded as UTF-8 instead of
having to convert them to ASCII. Hence my questions:

Question 1: What can I do to make this NOTE disappear?
?
Now that http://win-builder.r-project.org/ with R-devel? doesn't give me
the NOTE, while with R-release, I'm still getting the NOTE.
Question 2: Will the note disappear in the next release of R allowing to
have encoded character strings in a data.frame in the data folder?

?thanks,
?Jan?

Jan Wijffels
Statistician
www.bnosac.be  | +32 486 611708

	[[alternative HTML version deleted]]


From cdetermanjr at gmail.com  Thu Nov 12 14:17:16 2015
From: cdetermanjr at gmail.com (Charles Determan)
Date: Thu, 12 Nov 2015 07:17:16 -0600
Subject: [R-pkg-devel] configure.win for multiple architectures
Message-ID: <CAKxd1KNNqekaVfhMMV-OHZdnYk7_BzP+21MRzJriz2KM_F92dA@mail.gmail.com>

I am trying to compile a package (using Rcpp) where the libraries needed
for linking (assigned with PKG_LIBS) are in different locations depending
upon the architecture (32 or 64 bit).

In the R-admin documents 6.3.1 Windows (
http://www.hep.by/gnu/r-patched/r-admin/R-admin_36.html) it is stated that
if 'configure.win' does something appropriate for both architectures use
option `--force-biarch`'.

Are there any packages that demonstrate this?

Thanks,
Charles

	[[alternative HTML version deleted]]


From edd at debian.org  Thu Nov 12 14:34:23 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 12 Nov 2015 07:34:23 -0600
Subject: [R-pkg-devel] configure.win for multiple architectures
In-Reply-To: <CAKxd1KNNqekaVfhMMV-OHZdnYk7_BzP+21MRzJriz2KM_F92dA@mail.gmail.com>
References: <CAKxd1KNNqekaVfhMMV-OHZdnYk7_BzP+21MRzJriz2KM_F92dA@mail.gmail.com>
Message-ID: <22084.38239.579497.284375@max.nulle.part>


On 12 November 2015 at 07:17, Charles Determan wrote:
| I am trying to compile a package (using Rcpp) where the libraries needed
| for linking (assigned with PKG_LIBS) are in different locations depending
| upon the architecture (32 or 64 bit).
[...]

Maybe you can borrow this short piece from Rblpapi which picks a win32 or a
win64 library path:


  ## Distinguish between 32 and 64 bit windows
  ifeq "$(WIN)" "64"
      FLV = x64
  else
      FLV = i386
  endif

  ## Standard compiler / linker flags including windows flavor
  CXX_STD = CXX11
  PKG_CPPFLAGS = -I../inst/include -I.
  PKG_LIBS = -lblpapi3_${WIN} -L${FLV}


There is more in Makevars.win as this file also downloads a vendor library
(which it puts into that very directory). This is per an agreement with CRAN
as it keeps the (not-FOSS) library outside the package, but permits simple
building.  Our package itself is FOSS, but it depends on this vendor library.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From cdetermanjr at gmail.com  Thu Nov 12 15:45:12 2015
From: cdetermanjr at gmail.com (Charles Determan)
Date: Thu, 12 Nov 2015 08:45:12 -0600
Subject: [R-pkg-devel] configure.win for multiple architectures
In-Reply-To: <22084.38239.579497.284375@max.nulle.part>
References: <CAKxd1KNNqekaVfhMMV-OHZdnYk7_BzP+21MRzJriz2KM_F92dA@mail.gmail.com>
	<22084.38239.579497.284375@max.nulle.part>
Message-ID: <CAKxd1KOFs0PxcuN2W8pAx93OUXodDFpuO+dObbtOCi_0ucp6JA@mail.gmail.com>

Thanks Dirk,

This appears to work for my purposes.

Charles

On Thu, Nov 12, 2015 at 7:34 AM, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 12 November 2015 at 07:17, Charles Determan wrote:
> | I am trying to compile a package (using Rcpp) where the libraries needed
> | for linking (assigned with PKG_LIBS) are in different locations depending
> | upon the architecture (32 or 64 bit).
> [...]
>
> Maybe you can borrow this short piece from Rblpapi which picks a win32 or a
> win64 library path:
>
>
>   ## Distinguish between 32 and 64 bit windows
>   ifeq "$(WIN)" "64"
>       FLV = x64
>   else
>       FLV = i386
>   endif
>
>   ## Standard compiler / linker flags including windows flavor
>   CXX_STD = CXX11
>   PKG_CPPFLAGS = -I../inst/include -I.
>   PKG_LIBS = -lblpapi3_${WIN} -L${FLV}
>
>
> There is more in Makevars.win as this file also downloads a vendor library
> (which it puts into that very directory). This is per an agreement with
> CRAN
> as it keeps the (not-FOSS) library outside the package, but permits simple
> building.  Our package itself is FOSS, but it depends on this vendor
> library.
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From lafaye at dms.umontreal.ca  Fri Nov 13 17:24:41 2015
From: lafaye at dms.umontreal.ca (Pierre Lafaye de Micheaux)
Date: Fri, 13 Nov 2015 17:24:41 +0100
Subject: [R-pkg-devel] Problem (with complex.h?) under Microsoft Windows
Message-ID: <56460EC9.1020303@dms.umontreal.ca>

Dear all,

I created a new version of the package IndependenceTests where I call 
some C and Fortran functions (using the .C() or .Fortran() interface).
It works perfectly under Linux, with gcc. No problem with R CMD check. I 
would like to upload this package on the CRAN.

But when I first tried to use winbuilder, I got an error with the 
following message:

* installing *source* package 'IndependenceTests' ...
** libs

*** arch - i386
g++  -I"D:/RCompile/recent/R/include" -DNDEBUG 
-I"d:/RCompile/r-compiling/local/local320/include"     -O2 -Wall 
-mtune=core2 -c Cnhat.cpp -o Cnhat.o
Cnhat.cpp:9:89: error: 'complex' has not been declared
Cnhat.cpp:9:105: error: two or more data types in declaration of 'res'
....
.....
etc.


I think I understand that there is a problem (only under Windows though) 
with the complex type.
The beginning of my file Cnhat.cpp is as follows:

1. #include <R.h>
2. #include "Rmath.h"
3. #include <complex.h>
4. #include <iostream>
5. using namespace std;
6.
7. extern"C" {
8.
9.   void CnhatC(double *vecs, double *vect, double *X, int *n, int *q, 
int *p, int *vecd, complex double *res) {
10.
11.    void phinhatReturn(double *vect1, double *vect2, double *vect3, 
double *X, int *q, int *n, double _Complex *res1, double _Complex *res2, 
double _Complex *res3);
12.    double _Complex tmp2, prod1 = 1.0 + 0.0*_Complex_I, prod2 = 1.0 + 
0.0*_Complex_I, somme = 0.0 + 0.0*_Complex_I;
13.    int indbeginblocl, l, i, *vecdl, k, j;
14.    double *vecsl, *mvectl, *diffvecsvectl, *Xl;
15.    double _Complex *res1, *res2, *res3;
16.    vecdl = new int[1];
17.    res1 =  new _Complex double[1];
....
.....
etc.

As you can see, there seem to be some problem (on line 9.) with: complex 
double *res

Could you please point me to something (e.g., another package) that 
might help me solve the problem? If possible, I would like to avoid 
invest too much time using the new .Call() interface because I am quite 
familiar
with the old .C(). And also I am not even sure if it would help solving 
the problem.

Best regards,

Pierre L.

-- 
Pierre Lafaye de Micheaux

Adresse courrier:
Universit? de Montr?al
Pavillon Andr?-Aisenstadt
D?partement de Math?matiques et Statistique
CP 6128 Succursale Centre-ville
Montr?al Qc H3C 3J7
CANADA

Adresse physique:
D?partement de Math?matiques et Statistique
Bureau 4249, Pavillon Andr?-Aisenstadt
2920, chemin de la Tour
Montr?al, Qu?bec H3T 1J4
CANADA

T?l.: (00-1) 514-343-6607 / Fax: (00-1) 514-343-5700
lafaye at dms.umontreal.ca
http://www.biostatisticien.eu


	[[alternative HTML version deleted]]


From edd at debian.org  Fri Nov 13 21:12:16 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 13 Nov 2015 14:12:16 -0600
Subject: [R-pkg-devel] Problem (with complex.h?) under Microsoft Windows
In-Reply-To: <56460EC9.1020303@dms.umontreal.ca>
References: <56460EC9.1020303@dms.umontreal.ca>
Message-ID: <22086.17440.833043.722735@max.nulle.part>


On 13 November 2015 at 17:24, Pierre Lafaye de Micheaux wrote:
| might help me solve the problem? If possible, I would like to avoid 
| invest too much time using the new .Call() interface because I am quite 
| familiar with the old .C().

If you pay attention to posts in recent years of the R-devel list (or here)
you will see that .C is now actively discouraged -- eg in a few posts by R
Core member Simon Urbanek.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From proebuck at mdanderson.org  Fri Nov 13 21:24:25 2015
From: proebuck at mdanderson.org (Roebuck,Paul L)
Date: Fri, 13 Nov 2015 20:24:25 +0000
Subject: [R-pkg-devel] Problem (with complex.h?) under Microsoft Windows
In-Reply-To: <56460EC9.1020303@dms.umontreal.ca>
References: <56460EC9.1020303@dms.umontreal.ca>
Message-ID: <F9D8FADAB1DB8447B03EE30D076C1AC2132D53FB@D1PWPEXMBX06.mdanderson.edu>

Too bad you couldn't just use C++ std::complex, but that's a no-go if your function needs C linkage.

<http://stackoverflow.com/questions/1063406/c99-complex-support-with-visual-studio>
suggests MS-specific topic, but answers explain more.

Have you looked at RCpp package?

________________________________________
From: R-package-devel [r-package-devel-bounces at r-project.org] on behalf of Pierre Lafaye de Micheaux [lafaye at dms.umontreal.ca]
Sent: Friday, November 13, 2015 10:24 AM
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Problem (with complex.h?) under Microsoft Windows

I created a new version of the package IndependenceTests where I call
some C and Fortran functions (using the .C() or .Fortran() interface).
It works perfectly under Linux, with gcc. No problem with R CMD check. I
would like to upload this package on the CRAN.

But when I first tried to use winbuilder, I got an error with the
following message:

* installing *source* package 'IndependenceTests' ...
** libs

*** arch - i386
g++  -I"D:/RCompile/recent/R/include" -DNDEBUG
-I"d:/RCompile/r-compiling/local/local320/include"     -O2 -Wall
-mtune=core2 -c Cnhat.cpp -o Cnhat.o
Cnhat.cpp:9:89: error: 'complex' has not been declared
Cnhat.cpp:9:105: error: two or more data types in declaration of 'res'
....
.....
etc.


I think I understand that there is a problem (only under Windows though)
with the complex type.
The beginning of my file Cnhat.cpp is as follows:

1. #include <R.h>
2. #include "Rmath.h"
3. #include <complex.h>
4. #include <iostream>
5. using namespace std;
6.
7. extern"C" {
8.
9.   void CnhatC(double *vecs, double *vect, double *X, int *n, int *q,
int *p, int *vecd, complex double *res) {
10.
11.    void phinhatReturn(double *vect1, double *vect2, double *vect3,
double *X, int *q, int *n, double _Complex *res1, double _Complex *res2,
double _Complex *res3);
12.    double _Complex tmp2, prod1 = 1.0 + 0.0*_Complex_I, prod2 = 1.0 +
0.0*_Complex_I, somme = 0.0 + 0.0*_Complex_I;
13.    int indbeginblocl, l, i, *vecdl, k, j;
14.    double *vecsl, *mvectl, *diffvecsvectl, *Xl;
15.    double _Complex *res1, *res2, *res3;
16.    vecdl = new int[1];
17.    res1 =  new _Complex double[1];
....
.....
etc.

As you can see, there seem to be some problem (on line 9.) with: complex
double *res

Could you please point me to something (e.g., another package) that
might help me solve the problem? If possible, I would like to avoid
invest too much time using the new .Call() interface because I am quite
familiar
with the old .C(). And also I am not even sure if it would help solving
the problem.

Best regards,

Pierre L.

--
Pierre Lafaye de Micheaux

Adresse courrier:
Universit? de Montr?al
Pavillon Andr?-Aisenstadt
D?partement de Math?matiques et Statistique
CP 6128 Succursale Centre-ville
Montr?al Qc H3C 3J7
CANADA

Adresse physique:
D?partement de Math?matiques et Statistique
Bureau 4249, Pavillon Andr?-Aisenstadt
2920, chemin de la Tour
Montr?al, Qu?bec H3T 1J4
CANADA

T?l.: (00-1) 514-343-6607 / Fax: (00-1) 514-343-5700
lafaye at dms.umontreal.ca
http://www.biostatisticien.eu


        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel
The information contained in this e-mail message may be privileged, confidential, and/or protected from disclosure. This e-mail message may contain protected health information (PHI); dissemination of PHI should comply with applicable federal and state laws. If you are not the intended recipient, or an authorized representative of the intended recipient, any further review, disclosure, use, dissemination, distribution, or copying of this message or any attachment (or the information contained therein) is strictly prohibited. If you think that you have received this e-mail message in error, please notify the sender by return e-mail and delete all references to it and its contents from your systems.


From murdoch.duncan at gmail.com  Fri Nov 13 21:36:00 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 13 Nov 2015 15:36:00 -0500
Subject: [R-pkg-devel] Problem (with complex.h?) under Microsoft Windows
In-Reply-To: <56460EC9.1020303@dms.umontreal.ca>
References: <56460EC9.1020303@dms.umontreal.ca>
Message-ID: <564649B0.8000701@gmail.com>

On 13/11/2015 11:24 AM, Pierre Lafaye de Micheaux wrote:
> Dear all,
>
> I created a new version of the package IndependenceTests where I call
> some C and Fortran functions (using the .C() or .Fortran() interface).
> It works perfectly under Linux, with gcc. No problem with R CMD check. I
> would like to upload this package on the CRAN.
>
> But when I first tried to use winbuilder, I got an error with the
> following message:
>
> * installing *source* package 'IndependenceTests' ...
> ** libs
>
> *** arch - i386
> g++  -I"D:/RCompile/recent/R/include" -DNDEBUG
> -I"d:/RCompile/r-compiling/local/local320/include"     -O2 -Wall
> -mtune=core2 -c Cnhat.cpp -o Cnhat.o
> Cnhat.cpp:9:89: error: 'complex' has not been declared
> Cnhat.cpp:9:105: error: two or more data types in declaration of 'res'
> ....
> .....
> etc.
>
>
> I think I understand that there is a problem (only under Windows though)
> with the complex type.
> The beginning of my file Cnhat.cpp is as follows:
>
> 1. #include <R.h>
> 2. #include "Rmath.h"
> 3. #include <complex.h>
> 4. #include <iostream>
> 5. using namespace std;
> 6.
> 7. extern"C" {
> 8.
> 9.   void CnhatC(double *vecs, double *vect, double *X, int *n, int *q,
> int *p, int *vecd, complex double *res) {
> 10.
> 11.    void phinhatReturn(double *vect1, double *vect2, double *vect3,
> double *X, int *q, int *n, double _Complex *res1, double _Complex *res2,
> double _Complex *res3);
> 12.    double _Complex tmp2, prod1 = 1.0 + 0.0*_Complex_I, prod2 = 1.0 +
> 0.0*_Complex_I, somme = 0.0 + 0.0*_Complex_I;
> 13.    int indbeginblocl, l, i, *vecdl, k, j;
> 14.    double *vecsl, *mvectl, *diffvecsvectl, *Xl;
> 15.    double _Complex *res1, *res2, *res3;
> 16.    vecdl = new int[1];
> 17.    res1 =  new _Complex double[1];
> ....
> .....
> etc.
>
> As you can see, there seem to be some problem (on line 9.) with: complex
> double *res
>
> Could you please point me to something (e.g., another package) that
> might help me solve the problem? If possible, I would like to avoid
> invest too much time using the new .Call() interface because I am quite
> familiar
> with the old .C(). And also I am not even sure if it would help solving
> the problem.

You should be using Rcomplex in the type declaration. (See Writing R 
Extensions for a discussion of this.)  It is defined as

typedef struct {
	double r;
	double i;
} Rcomplex;

which is likely compatible with your "complex double" on those other 
systems (which are using newer gcc versions), but it's not guaranteed to 
be, even there.

Duncan Murdoch


From edd at debian.org  Sat Nov 14 05:02:01 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 13 Nov 2015 22:02:01 -0600
Subject: [R-pkg-devel] Problem (with complex.h?) under Microsoft Windows
In-Reply-To: <F9D8FADAB1DB8447B03EE30D076C1AC2132D53FB@D1PWPEXMBX06.mdanderson.edu>
References: <56460EC9.1020303@dms.umontreal.ca>
	<F9D8FADAB1DB8447B03EE30D076C1AC2132D53FB@D1PWPEXMBX06.mdanderson.edu>
Message-ID: <22086.45625.933834.882100@max.nulle.part>


On 13 November 2015 at 20:24, Roebuck,Paul L wrote:
| Too bad you couldn't just use C++ std::complex, but that's a no-go if your function needs C linkage.
| 
| <http://stackoverflow.com/questions/1063406/c99-complex-support-with-visual-studio>
| suggests MS-specific topic, but answers explain more.
| 
| Have you looked at RCpp package?

Rcpp can help quite a bit with all of the mechanics: header files, linking,
loading, conversion, ...  We don't use it all that much for complex data
types but some things certainly work, and Baptiste has a few packages (using
RcppArmadillo) which use complex numbers.

Here is a quick example:

R> library(Rcpp)             # load Rcpp, them define a one-liner in the R shell
R> cppFunction("ComplexVector timesTwo(ComplexVector x) { ComplexVector y = x+x; return y; }")
R> timesTwo(7i)              # use it
[1] 0+14i
R> timesTwo(c(4+2i, 7i))     # vectors or scalars are the same to R
[1] 8+ 4i 0+14i
R> 

This should very much work the same way in Windows.  And note that we didn't
have to specify a single header (though you can of course should you need
extra ones -- see many examples at http://gallery.rcpp.org)

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From Gordon.Brown at cruk.cam.ac.uk  Sun Nov 15 14:02:04 2015
From: Gordon.Brown at cruk.cam.ac.uk (Gordon Brown)
Date: Sun, 15 Nov 2015 13:02:04 +0000
Subject: [R-pkg-devel] Problem (with complex.h?) under Microsoft Windows
In-Reply-To: <F9D8FADAB1DB8447B03EE30D076C1AC2132D53FB@D1PWPEXMBX06.mdanderson.edu>
References: <56460EC9.1020303@dms.umontreal.ca>
	<F9D8FADAB1DB8447B03EE30D076C1AC2132D53FB@D1PWPEXMBX06.mdanderson.edu>
Message-ID: <D26E30E5.1BCEE%gordon.brown@cruk.cam.ac.uk>

Hi, folks,

I just want to throw in another vote for Rcpp.  I recently rewrote some old code that used the legacy interface to use Rcpp, and life with Rcpp is *much* better.  The code is clean and easy to read (and write), and memory protection is taken care of.  I don't know if it will fix Pierre's specific problem, but if you try it, I suspect you'll like it.

Many thanks to Dirk, Romain, and all.

Cheers,

 - Gord


From: R-package-devel <r-package-devel-bounces at r-project.org<mailto:r-package-devel-bounces at r-project.org>> on behalf of "Roebuck,Paul L" <proebuck at mdanderson.org<mailto:proebuck at mdanderson.org>>
Date: Friday, 13 November 2015 20:24
To: "r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>" <r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>>
Subject: Re: [R-pkg-devel] Problem (with complex.h?) under Microsoft Windows

Too bad you couldn't just use C++ std::complex, but that's a no-go if your function needs C linkage.

<http://stackoverflow.com/questions/1063406/c99-complex-support-with-visual-studio>
suggests MS-specific topic, but answers explain more.

Have you looked at RCpp package?

________________________________________
From: R-package-devel [r-package-devel-bounces at r-project.org<mailto:r-package-devel-bounces at r-project.org>] on behalf of Pierre Lafaye de Micheaux [lafaye at dms.umontreal.ca<mailto:lafaye at dms.umontreal.ca>]
Sent: Friday, November 13, 2015 10:24 AM
To: r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>
Subject: [R-pkg-devel] Problem (with complex.h?) under Microsoft Windows

I created a new version of the package IndependenceTests where I call
some C and Fortran functions (using the .C() or .Fortran() interface).
It works perfectly under Linux, with gcc. No problem with R CMD check. I
would like to upload this package on the CRAN.

But when I first tried to use winbuilder, I got an error with the
following message:

* installing *source* package 'IndependenceTests' ...
** libs

*** arch - i386
g++  -I"D:/RCompile/recent/R/include" -DNDEBUG
-I"d:/RCompile/r-compiling/local/local320/include"     -O2 -Wall
-mtune=core2 -c Cnhat.cpp -o Cnhat.o
Cnhat.cpp:9:89: error: 'complex' has not been declared
Cnhat.cpp:9:105: error: two or more data types in declaration of 'res'
....
.....
etc.


I think I understand that there is a problem (only under Windows though)
with the complex type.
The beginning of my file Cnhat.cpp is as follows:

1. #include <R.h>
2. #include "Rmath.h"
3. #include <complex.h>
4. #include <iostream>
5. using namespace std;
6.
7. extern"C" {
8.
9.   void CnhatC(double *vecs, double *vect, double *X, int *n, int *q,
int *p, int *vecd, complex double *res) {
10.
11.    void phinhatReturn(double *vect1, double *vect2, double *vect3,
double *X, int *q, int *n, double _Complex *res1, double _Complex *res2,
double _Complex *res3);
12.    double _Complex tmp2, prod1 = 1.0 + 0.0*_Complex_I, prod2 = 1.0 +
0.0*_Complex_I, somme = 0.0 + 0.0*_Complex_I;
13.    int indbeginblocl, l, i, *vecdl, k, j;
14.    double *vecsl, *mvectl, *diffvecsvectl, *Xl;
15.    double _Complex *res1, *res2, *res3;
16.    vecdl = new int[1];
17.    res1 =  new _Complex double[1];
....
.....
etc.

As you can see, there seem to be some problem (on line 9.) with: complex
double *res

Could you please point me to something (e.g., another package) that
might help me solve the problem? If possible, I would like to avoid
invest too much time using the new .Call() interface because I am quite
familiar
with the old .C(). And also I am not even sure if it would help solving
the problem.

Best regards,

Pierre L.

--
Pierre Lafaye de Micheaux

Adresse courrier:
Universit? de Montr?al
Pavillon Andr?-Aisenstadt
D?partement de Math?matiques et Statistique
CP 6128 Succursale Centre-ville
Montr?al Qc H3C 3J7
CANADA

Adresse physique:
D?partement de Math?matiques et Statistique
Bureau 4249, Pavillon Andr?-Aisenstadt
2920, chemin de la Tour
Montr?al, Qu?bec H3T 1J4
CANADA

T?l.: (00-1) 514-343-6607 / Fax: (00-1) 514-343-5700
lafaye at dms.umontreal.ca<mailto:lafaye at dms.umontreal.ca>
http://www.biostatisticien.eu


        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel
The information contained in this e-mail message may be privileged, confidential, and/or protected from disclosure. This e-mail message may contain protected health information (PHI); dissemination of PHI should comply with applicable federal and state laws. If you are not the intended recipient, or an authorized representative of the intended recipient, any further review, disclosure, use, dissemination, distribution, or copying of this message or any attachment (or the information contained therein) is strictly prohibited. If you think that you have received this e-mail message in error, please notify the sender by return e-mail and delete all references to it and its contents from your systems.

______________________________________________
R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From wright at imbs.uni-luebeck.de  Mon Nov 16 13:07:21 2015
From: wright at imbs.uni-luebeck.de (Marvin Wright)
Date: Mon, 16 Nov 2015 13:07:21 +0100
Subject: [R-pkg-devel] Checking for C++11
Message-ID: <6B292690-BA3A-4770-9E1D-D83C858CE758@imbs.uni-luebeck.de>

Dear all, 

I would like to check for C++11 support in a package. The package requires gcc >= 4.7 or clang >= 3.0. Windows is handled differently in Makevars.win. I tried two approaches in Makevars so far, but both give warnings in CRAN checks. 

Approach 1: 
## Check for gcc >= 4.7
ifeq ($(shell basename $(CC)),gcc)
GCC_VER := $(shell gcc -dumpversion)
GCC_MAJOR := $(shell gcc -dumpversion | cut -f1-2 -d.)

GCC_OK := $(shell echo $(GCC_MAJOR) \>= 4.7 | bc )
ifneq ($(GCC_OK),1)
  $(error Error: gcc >= 4.7 required, version $(GCC_VER) installed. Please update gcc.)
endif
endif

Works quite well but a warning in check ?as-cran: 
> Found the following file(s) containing GNU extensions:
> src/Makevars
> Portable Makefiles do not use GNU extensions such as +=, :=, $(shell),
> $(wildcard), ifeq ... endif. See section ?Writing portable packages? in
> the ?Writing R Extensions? manual.


Approach 2: 
Use std=c++11 flag instead of CXX_STD = CXX11, which should work on gcc >=4.7 and throw an error on earlier versions. 

This time in check ?as-cran: 
> Non-portable flags in variable 'PKG_CPPFLAGS':
> -std=c++11

Any other ideas how to check? Or is one of the versions above OK on CRAN? 

Thanks, 

Marvin

From murdoch.duncan at gmail.com  Mon Nov 16 13:44:10 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 16 Nov 2015 07:44:10 -0500
Subject: [R-pkg-devel] Checking for C++11
In-Reply-To: <6B292690-BA3A-4770-9E1D-D83C858CE758@imbs.uni-luebeck.de>
References: <6B292690-BA3A-4770-9E1D-D83C858CE758@imbs.uni-luebeck.de>
Message-ID: <5649CF9A.905@gmail.com>

On 16/11/2015 7:07 AM, Marvin Wright wrote:
> Dear all,
>
> I would like to check for C++11 support in a package. The package requires gcc >= 4.7 or clang >= 3.0. Windows is handled differently in Makevars.win. I tried two approaches in Makevars so far, but both give warnings in CRAN checks.
>
> Approach 1:
> ## Check for gcc >= 4.7
> ifeq ($(shell basename $(CC)),gcc)
> GCC_VER := $(shell gcc -dumpversion)
> GCC_MAJOR := $(shell gcc -dumpversion | cut -f1-2 -d.)
>
> GCC_OK := $(shell echo $(GCC_MAJOR) \>= 4.7 | bc )
> ifneq ($(GCC_OK),1)
>    $(error Error: gcc >= 4.7 required, version $(GCC_VER) installed. Please update gcc.)
> endif
> endif
>
> Works quite well but a warning in check ?as-cran:
>> Found the following file(s) containing GNU extensions:
>> src/Makevars
>> Portable Makefiles do not use GNU extensions such as +=, :=, $(shell),
>> $(wildcard), ifeq ... endif. See section ?Writing portable packages? in
>> the ?Writing R Extensions? manual.
>
>
> Approach 2:
> Use std=c++11 flag instead of CXX_STD = CXX11, which should work on gcc >=4.7 and throw an error on earlier versions.
>
> This time in check ?as-cran:
>> Non-portable flags in variable 'PKG_CPPFLAGS':
>> -std=c++11
>
> Any other ideas how to check? Or is one of the versions above OK on CRAN?

A better approach may be to check for features rather than versions by 
just using them.  Put in tests that fail if the features you need are 
not there, and put something like "C++11" into your DESCRIPTION file 
SystemRequirements field to tell people why they're failing (as well as 
comments in the source).

Duncan Murdoch


From edd at debian.org  Mon Nov 16 13:56:27 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 16 Nov 2015 06:56:27 -0600
Subject: [R-pkg-devel] Checking for C++11
In-Reply-To: <6B292690-BA3A-4770-9E1D-D83C858CE758@imbs.uni-luebeck.de>
References: <6B292690-BA3A-4770-9E1D-D83C858CE758@imbs.uni-luebeck.de>
Message-ID: <22089.53883.263336.72759@max.nulle.part>


On 16 November 2015 at 13:07, Marvin Wright wrote:
| I would like to check for C++11 support in a package. The package requires gcc >= 4.7 or clang >= 3.0. Windows is handled differently in Makevars.win. I tried two approaches in Makevars so far, but both give warnings in CRAN checks. 
| 
| Approach 1: 
| ## Check for gcc >= 4.7
| ifeq ($(shell basename $(CC)),gcc)
| GCC_VER := $(shell gcc -dumpversion)
| GCC_MAJOR := $(shell gcc -dumpversion | cut -f1-2 -d.)
| 
| GCC_OK := $(shell echo $(GCC_MAJOR) \>= 4.7 | bc )
| ifneq ($(GCC_OK),1)
|   $(error Error: gcc >= 4.7 required, version $(GCC_VER) installed. Please update gcc.)
| endif
| endif
| 
| Works quite well but a warning in check ?as-cran: 
| > Found the following file(s) containing GNU extensions:
| > src/Makevars
| > Portable Makefiles do not use GNU extensions such as +=, :=, $(shell),
| > $(wildcard), ifeq ... endif. See section ?Writing portable packages? in
| > the ?Writing R Extensions? manual.

Yup. One of the things I dislike the about current CRAN checks. GNU Make *is*
a standard, but we are not allowed to use it unless we use the GNUMakefile
name (which is ugly), or declare a 'SystemRequirements: GNU make'.

So I would not use this.
 
| Approach 2: 
| Use std=c++11 flag instead of CXX_STD = CXX11, which should work on gcc >=4.7 and throw an error on earlier versions. 
| 
| This time in check ?as-cran: 
| > Non-portable flags in variable 'PKG_CPPFLAGS':
| > -std=c++11

Obviously not good as it throws an error.
 
| Any other ideas how to check? Or is one of the versions above OK on CRAN? 

Look eg at RcppTOML which includes/provides the cpptoml.h header which is
real C++11.  There I just do (in DESCRIPTION)

   SystemRequirements: A C++11 compiler. Version 4.6.* of g++ (as currently in
    Rtools) is insufficient; versions 4.8.*, 4.9.* or later will be fine.

and (in src/Makevars)

   ## This is a C++11 package
   CXX_STD = CXX11

Then CRAN takes care of things -- see the status at

   https://cran.rstudio.com/web/checks/check_results_RcppTOML.html

which generally builds fine (and where I just noticed the Mavericks error --
ick. Anybody with a Mavericks box who can help by poking around ?)

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd at debian.org  Mon Nov 16 16:53:52 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 16 Nov 2015 09:53:52 -0600
Subject: [R-pkg-devel] Checking for C++11
In-Reply-To: <4DC4659A-D2D6-4119-8567-88F547FBD991@imbs.uni-luebeck.de>
References: <6B292690-BA3A-4770-9E1D-D83C858CE758@imbs.uni-luebeck.de>
	<22089.53883.263336.72759@max.nulle.part>
	<4DC4659A-D2D6-4119-8567-88F547FBD991@imbs.uni-luebeck.de>
Message-ID: <22089.64528.201110.155101@max.nulle.part>


On 16 November 2015 at 16:45, Marvin Wright wrote:
| Thanks, that helped. However, a user with gcc < 4.7 will still get cryptic
| errors. 
| 
| I had another idea: I created a file src/AAA_check_cpp11.cpp, checking the
| preprocessor directive ?__cplusplus?, see https://github.com/mnwright/ranger/
| blob/master/ranger-r-package/ranger/src/AAA_check_cpp11.cpp. This isn?t
| beautiful, but the error message is better and it?s fine on CRAN. 

That is basically what autoconf is for. You can embed small programs in the
configure.ac -- that _is_ how header presence and linkability is tested.

I don't have a link handly but I can probably help (off-list) if needed.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From wright at imbs.uni-luebeck.de  Mon Nov 16 16:45:10 2015
From: wright at imbs.uni-luebeck.de (Marvin Wright)
Date: Mon, 16 Nov 2015 16:45:10 +0100
Subject: [R-pkg-devel] Checking for C++11
In-Reply-To: <22089.53883.263336.72759@max.nulle.part>
References: <6B292690-BA3A-4770-9E1D-D83C858CE758@imbs.uni-luebeck.de>
	<22089.53883.263336.72759@max.nulle.part>
Message-ID: <4DC4659A-D2D6-4119-8567-88F547FBD991@imbs.uni-luebeck.de>

Thanks, that helped. However, a user with gcc < 4.7 will still get cryptic errors. 

I had another idea: I created a file src/AAA_check_cpp11.cpp, checking the preprocessor directive ?__cplusplus?, see https://github.com/mnwright/ranger/blob/master/ranger-r-package/ranger/src/AAA_check_cpp11.cpp <https://github.com/mnwright/ranger/blob/master/ranger-r-package/ranger/src/AAA_check_cpp11.cpp>. This isn?t beautiful, but the error message is better and it?s fine on CRAN. 


> On 16 Nov 2015, at 13:56, Dirk Eddelbuettel <edd at debian.org> wrote:
> 
> 
> On 16 November 2015 at 13:07, Marvin Wright wrote:
> | I would like to check for C++11 support in a package. The package requires gcc >= 4.7 or clang >= 3.0. Windows is handled differently in Makevars.win. I tried two approaches in Makevars so far, but both give warnings in CRAN checks. 
> | 
> | Approach 1: 
> | ## Check for gcc >= 4.7
> | ifeq ($(shell basename $(CC)),gcc)
> | GCC_VER := $(shell gcc -dumpversion)
> | GCC_MAJOR := $(shell gcc -dumpversion | cut -f1-2 -d.)
> | 
> | GCC_OK := $(shell echo $(GCC_MAJOR) \>= 4.7 | bc )
> | ifneq ($(GCC_OK),1)
> |   $(error Error: gcc >= 4.7 required, version $(GCC_VER) installed. Please update gcc.)
> | endif
> | endif
> | 
> | Works quite well but a warning in check ?as-cran: 
> | > Found the following file(s) containing GNU extensions:
> | > src/Makevars
> | > Portable Makefiles do not use GNU extensions such as +=, :=, $(shell),
> | > $(wildcard), ifeq ... endif. See section ?Writing portable packages? in
> | > the ?Writing R Extensions? manual.
> 
> Yup. One of the things I dislike the about current CRAN checks. GNU Make *is*
> a standard, but we are not allowed to use it unless we use the GNUMakefile
> name (which is ugly), or declare a 'SystemRequirements: GNU make'.
> 
> So I would not use this.
> 
> | Approach 2: 
> | Use std=c++11 flag instead of CXX_STD = CXX11, which should work on gcc >=4.7 and throw an error on earlier versions. 
> | 
> | This time in check ?as-cran: 
> | > Non-portable flags in variable 'PKG_CPPFLAGS':
> | > -std=c++11
> 
> Obviously not good as it throws an error.
> 
> | Any other ideas how to check? Or is one of the versions above OK on CRAN? 
> 
> Look eg at RcppTOML which includes/provides the cpptoml.h header which is
> real C++11.  There I just do (in DESCRIPTION)
> 
>   SystemRequirements: A C++11 compiler. Version 4.6.* of g++ (as currently in
>    Rtools) is insufficient; versions 4.8.*, 4.9.* or later will be fine.
> 
> and (in src/Makevars)
> 
>   ## This is a C++11 package
>   CXX_STD = CXX11
> 
> Then CRAN takes care of things -- see the status at
> 
>   https://cran.rstudio.com/web/checks/check_results_RcppTOML.html
> 
> which generally builds fine (and where I just noticed the Mavericks error --
> ick. Anybody with a Mavericks box who can help by poking around ?)
> 
> Dirk
> 
> -- 
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


	[[alternative HTML version deleted]]


From glennmschultz at me.com  Thu Nov 19 02:35:15 2015
From: glennmschultz at me.com (Glenn Schultz)
Date: Thu, 19 Nov 2015 01:35:15 +0000 (GMT)
Subject: [R-pkg-devel] Class with functions as slots
Message-ID: <2995f598-5caf-4265-9d40-e050416355cf@me.com>

All,

I have the following class with slots as functions. For the analysis of MBS this is good set-up as it allows for a very clean and modular way of handling things. ?My question is really geared to understanding what is happening in R.

Below is the function without sato = NULL R CMD throws a warning global variable not defined. ?With SATO = NULL I do not get the warning. ?Why only sato and not two and ten which are also inputs?

Glenn

# Bond Lab is a software application for the analysis of 
# fixed income securities it provides a suite of applications
# in addition to standard fixed income analysis bond lab provides 
# for the specific analysis of structured products residential mortgage backed securities, 
# asset backed securities, and commerical mortgage backed securities
# License GPL3 + File License
# Copyright (C) 2014 Glenn M Schultz, CFA

#' An S4 class whose slots are functions used to propogate
#' the mortgage rate used to motivate the prepayment model
#' @slot yr30 A function defining the 30-year mortgage rate as a function
#' of the 2- and 10-year swap rate
#' @slot yr15 A function defining the 15-year mortgage rate as a function
#' of the 2- and 10-year swap rate 
#' @export MortgageRate

setClass("MortgageRate",
representation(
yr30 = "function",
yr15 = "function"))

#' A constructor function for the class Mortgage Rate
MortgageRate <- function(){
sato = NULL
new("MortgageRate",
yr30 = function(two = numeric(), ten = numeric(), sato = numeric()) {
2.25 + (.06 * two) + (.75 * ten) + sato},

yr15 = function(two = numeric(), ten = numeric()){
1.75 + (.06 * two) + (.75 * ten) + sato}
)}

From josh.m.ulrich at gmail.com  Thu Nov 19 02:51:31 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 18 Nov 2015 19:51:31 -0600
Subject: [R-pkg-devel] Class with functions as slots
In-Reply-To: <2995f598-5caf-4265-9d40-e050416355cf@me.com>
References: <2995f598-5caf-4265-9d40-e050416355cf@me.com>
Message-ID: <CAPPM_gTst1Cv1hbCF6OYiiLkYV5sjC74L2DWKykYspRo+i20zw@mail.gmail.com>

On Wed, Nov 18, 2015 at 7:35 PM, Glenn Schultz <glennmschultz at me.com> wrote:
> All,
>
> I have the following class with slots as functions. For the analysis of MBS
> this is good set-up as it allows for a very clean and modular way of
> handling things.  My question is really geared to understanding what is
> happening in R.
>
> Below is the function without sato = NULL R CMD throws a warning global
> variable not defined.  With SATO = NULL I do not get the warning.  Why only
> sato and not two and ten which are also inputs?
>
You use sato in the yr15 function even though it is not an argument to
the function.  Did you forget to add it as an argument to the yr15
function?

> Glenn
>
> # Bond Lab is a software application for the analysis of # fixed income
> securities it provides a suite of applications
> # in addition to standard fixed income analysis bond lab provides # for the
> specific analysis of structured products residential mortgage backed
> securities, # asset backed securities, and commerical mortgage backed
> securities
> # License GPL3 + File License
> # Copyright (C) 2014 Glenn M Schultz, CFA
>
> #' An S4 class whose slots are functions used to propogate
> #' the mortgage rate used to motivate the prepayment model
> #' @slot yr30 A function defining the 30-year mortgage rate as a function
> #' of the 2- and 10-year swap rate
> #' @slot yr15 A function defining the 15-year mortgage rate as a function
> #' of the 2- and 10-year swap rate #' @export MortgageRate
>
> setClass("MortgageRate",
> representation(
> yr30 = "function",
> yr15 = "function"))
>
> #' A constructor function for the class Mortgage Rate
> MortgageRate <- function(){
> sato = NULL
> new("MortgageRate",
> yr30 = function(two = numeric(), ten = numeric(), sato = numeric()) {
> 2.25 + (.06 * two) + (.75 * ten) + sato},
>
> yr15 = function(two = numeric(), ten = numeric()){
> 1.75 + (.06 * two) + (.75 * ten) + sato}
> )}
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


From dmarcelino at live.com  Thu Nov 19 15:05:00 2015
From: dmarcelino at live.com (Daniel Marcelino)
Date: Thu, 19 Nov 2015 11:05:00 -0300
Subject: [R-pkg-devel] Build fails on Mavericks
Message-ID: <SNT146-W34AB9B97B28DB4E0B02053BB1B0@phx.gbl>

Hi, I'm having this error when building C functions from a package:

?clang: error: no such file or directory: '/usr/local/lib/libreadline.a'?

Apparently, it's a path issue caused by xcode/gfortran, but I couldn't figure out how to solve it.?
"which gcc" points to "/usr/bin/gcc"
Does someone have any idea on how on this?

Thanks,
Daniel

 		 	   		  

From murdoch.duncan at gmail.com  Thu Nov 19 15:40:50 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 19 Nov 2015 09:40:50 -0500
Subject: [R-pkg-devel] Build fails on Mavericks
In-Reply-To: <SNT146-W34AB9B97B28DB4E0B02053BB1B0@phx.gbl>
References: <SNT146-W34AB9B97B28DB4E0B02053BB1B0@phx.gbl>
Message-ID: <564DDF72.301@gmail.com>

On 19/11/2015 9:05 AM, Daniel Marcelino wrote:
> Hi, I'm having this error when building C functions from a package:
>
>   clang: error: no such file or directory: '/usr/local/lib/libreadline.a'
>
> Apparently, it's a path issue caused by xcode/gfortran, but I couldn't figure out how to solve it.
> "which gcc" points to "/usr/bin/gcc"
> Does someone have any idea on how on this?

You didn't say what system you're on, but the message is coming from 
clang, not gcc, so it looks like OSX, and "which gcc" is irrelevant.  If 
so, you probably want to ask on the R-sig-mac group.  If not, give more 
details.

Duncan Murdoch


From Rainer at krugs.de  Thu Nov 19 17:37:30 2015
From: Rainer at krugs.de (Rainer M Krug)
Date: Thu, 19 Nov 2015 17:37:30 +0100
Subject: [R-pkg-devel] Build fails on Mavericks
In-Reply-To: <564DDF72.301@gmail.com> (Duncan Murdoch's message of "Thu, 19
	Nov 2015 09:40:50 -0500")
References: <SNT146-W34AB9B97B28DB4E0B02053BB1B0@phx.gbl>
	<564DDF72.301@gmail.com>
Message-ID: <m27flekks5.fsf@krugs.de>

Duncan Murdoch <murdoch.duncan at gmail.com> writes:

> On 19/11/2015 9:05 AM, Daniel Marcelino wrote:
>> Hi, I'm having this error when building C functions from a package:
>>
>>   clang: error: no such file or directory: '/usr/local/lib/libreadline.a'
>>
>> Apparently, it's a path issue caused by xcode/gfortran, but I couldn't figure out how to solve it.
>> "which gcc" points to "/usr/bin/gcc"
>> Does someone have any idea on how on this?
>
> You didn't say what system you're on, but the message is coming from
> clang, not gcc, so it looks like OSX, and "which gcc" is irrelevant.
> If so, you probably want to ask on the R-sig-mac group.  If not, give
> more details.

Also: did you use the official R installer or installed it using homebrew?

The path looks very much like homebrew. If yes, try installing readline
From homebrew.

Cheers,

Rainer

>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug

PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20151119/683c358e/attachment.bin>

From dmarcelino at live.com  Thu Nov 19 18:28:18 2015
From: dmarcelino at live.com (Daniel Marcelino)
Date: Thu, 19 Nov 2015 15:28:18 -0200
Subject: [R-pkg-devel] Build fails on Mavericks
In-Reply-To: <m27flekks5.fsf@krugs.de>
References: <SNT146-W34AB9B97B28DB4E0B02053BB1B0@phx.gbl>
	<564DDF72.301@gmail.com> <m27flekks5.fsf@krugs.de>
Message-ID: <CAAjbdi+Oj9HxgtCspnyczar9KxtmZSRWmfK3pJAXO=Awpjsfow@mail.gmail.com>

Yes, I do use homebrew for installing almost everything.

I ended up solving the issue with $ brew link readline --forc
e

Daniel

On Thu, Nov 19, 2015 at 2:37 PM, Rainer M Krug <Rainer at krugs.de> wrote:
> Duncan Murdoch <murdoch.duncan at gmail.com> writes:
>
>> On 19/11/2015 9:05 AM, Daniel Marcelino wrote:
>>> Hi, I'm having this error when building C functions from a package:
>>>
>>>   clang: error: no such file or directory: '/usr/local/lib/libreadline.a'
>>>
>>> Apparently, it's a path issue caused by xcode/gfortran, but I couldn't figure out how to solve it.
>>> "which gcc" points to "/usr/bin/gcc"
>>> Does someone have any idea on how on this?
>>
>> You didn't say what system you're on, but the message is coming from
>> clang, not gcc, so it looks like OSX, and "which gcc" is irrelevant.
>> If so, you probably want to ask on the R-sig-mac group.  If not, give
>> more details.
>
> Also: did you use the official R installer or installed it using homebrew?
>
> The path looks very much like homebrew. If yes, try installing readline
> From homebrew.
>
> Cheers,
>
> Rainer
>
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> --
> Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)
>
> Centre of Excellence for Invasion Biology
> Stellenbosch University
> South Africa
>
> Tel :       +33 - (0)9 53 10 27 44
> Cell:       +33 - (0)6 85 62 59 98
> Fax :       +33 - (0)9 58 10 27 44
>
> Fax (D):    +49 - (0)3 21 21 25 22 44
>
> email:      Rainer at krugs.de
>
> Skype:      RMkrug
>
> PGP: 0x0F52F982


From kamvarz at science.oregonstate.edu  Thu Nov 19 20:18:01 2015
From: kamvarz at science.oregonstate.edu (Zhian Kamvar)
Date: Thu, 19 Nov 2015 11:18:01 -0800
Subject: [R-pkg-devel] Build fails on Mavericks
In-Reply-To: <CAAjbdi+Oj9HxgtCspnyczar9KxtmZSRWmfK3pJAXO=Awpjsfow@mail.gmail.com>
References: <SNT146-W34AB9B97B28DB4E0B02053BB1B0@phx.gbl>
	<564DDF72.301@gmail.com> <m27flekks5.fsf@krugs.de>
	<CAAjbdi+Oj9HxgtCspnyczar9KxtmZSRWmfK3pJAXO=Awpjsfow@mail.gmail.com>
Message-ID: <92F94572-AF23-4F61-B2DB-127A74BDE1DE@science.oregonstate.edu>

Might it be an issue with your Makevars file?

As far as I can tell, by default, OS X sets clang as the C compiler. If you installed gcc separately, then you have to tell R to use it in ~/.R/Makevars

Here's an example of my Makevars file so that I can run C code with openmp: https://gist.github.com/zkamvar/9a7c4b8251a0a662f214

Zhian

> On Nov 19, 2015, at 09:28 , Daniel Marcelino <dmarcelino at live.com> wrote:
> 
> Yes, I do use homebrew for installing almost everything.
> 
> I ended up solving the issue with $ brew link readline --forc
> e
> 
> Daniel
> 
> On Thu, Nov 19, 2015 at 2:37 PM, Rainer M Krug <Rainer at krugs.de> wrote:
>> Duncan Murdoch <murdoch.duncan at gmail.com> writes:
>> 
>>> On 19/11/2015 9:05 AM, Daniel Marcelino wrote:
>>>> Hi, I'm having this error when building C functions from a package:
>>>> 
>>>>  clang: error: no such file or directory: '/usr/local/lib/libreadline.a'
>>>> 
>>>> Apparently, it's a path issue caused by xcode/gfortran, but I couldn't figure out how to solve it.
>>>> "which gcc" points to "/usr/bin/gcc"
>>>> Does someone have any idea on how on this?
>>> 
>>> You didn't say what system you're on, but the message is coming from
>>> clang, not gcc, so it looks like OSX, and "which gcc" is irrelevant.
>>> If so, you probably want to ask on the R-sig-mac group.  If not, give
>>> more details.
>> 
>> Also: did you use the official R installer or installed it using homebrew?
>> 
>> The path looks very much like homebrew. If yes, try installing readline
>> From homebrew.
>> 
>> Cheers,
>> 
>> Rainer
>> 
>>> 
>>> Duncan Murdoch
>>> 
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> 
>> --
>> Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)
>> 
>> Centre of Excellence for Invasion Biology
>> Stellenbosch University
>> South Africa
>> 
>> Tel :       +33 - (0)9 53 10 27 44
>> Cell:       +33 - (0)6 85 62 59 98
>> Fax :       +33 - (0)9 58 10 27 44
>> 
>> Fax (D):    +49 - (0)3 21 21 25 22 44
>> 
>> email:      Rainer at krugs.de
>> 
>> Skype:      RMkrug
>> 
>> PGP: 0x0F52F982
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From tushar.sadhu08 at gmail.com  Thu Nov 19 17:33:15 2015
From: tushar.sadhu08 at gmail.com (Tushar Sadhu)
Date: Thu, 19 Nov 2015 22:03:15 +0530
Subject: [R-pkg-devel] Help with making a package for Twitter Authentication
Message-ID: <CAE_K4vvv7+KLMWDSAPQZWcAAQJQVKF0GMLB_n7gOdgePKF=MwQ@mail.gmail.com>

Hello and greetings

I have been doing Twitter Data Analysis following a few blogs which
requires me to register as a developer and enter a PIN everytime I want to
start reading tweets. But now I have made a basic package which does all
the hectic authentication, but the PIN from an authorized app is still
required.
(specifically after twitCred is correctly defined and this step :
twitCred$handshake(cainfo = system.file("CurlSSL", "cacert.pem", package =
"RCurl"))     )
Though it works and reduces the steps, it still has to go to the URL and
enter the PIN manually

So my questions are two :

1. If I go ahead with the current method of reading tweets by logging from
my account, how do I automate the process of entering the PIN when the code
runs inside the package?
2. What is the standard method of gathering tweets without any
authentication at all. How is it done professionally without using anyone's
account and PIN.

This is my first question here and I am not sure if I am following the
right protocols or am asking silly questions. In either case I am sorry.

Please help!
Also Thankyou in advance :)

Regards
Tushar Sadhu

	[[alternative HTML version deleted]]


From retep.meissner at gmail.com  Sun Nov 22 04:07:00 2015
From: retep.meissner at gmail.com (Peter Meissner)
Date: Sun, 22 Nov 2015 03:08:00 +0001
Subject: [R-pkg-devel] Help with making a package for Twitter
 Authentication
In-Reply-To: <CAE_K4vvv7+KLMWDSAPQZWcAAQJQVKF0GMLB_n7gOdgePKF=MwQ@mail.gmail.com>
References: <CAE_K4vvv7+KLMWDSAPQZWcAAQJQVKF0GMLB_n7gOdgePKF=MwQ@mail.gmail.com>
Message-ID: <1448161620.5509.0@smtp.gmail.com>

Hey,

I am not sure, that this is the right list for questions that are 'only 
mildly' related to package developement. Your question is more about 
API/webscraping etc. . 

Maybe someone can point to a better place to post questions like this?. 

... that beeing said ... 

If I understand your problem right, I would suggest to try out the 
twitteR package [1] which already has authentication and data retrieval 
build in. 

If you do want to do it on your own I would suggest building on top of 
httr [2] for  authentication and HTTP-communication to access 
information from the official Twitter API [3]. Make sure to have a look 
at the demo provided on httr's Github repo [4]. Also the httr vignette 
on how to write API wrapper packages might be useful and last and very 
least I build a kind of minimal package for reading tweets and tweeting 
ot be found on my Github [5] which might also be of use because it only 
implements reading tweets of specific user.

Good luck, Peter


[1] https://cran.r-project.org/web/packages/twitteR/index.html
[2] https://cran.r-project.org/web/packages/httr/index.html
[3] https://dev.twitter.com/rest/public
[4] https://github.com/hadley/httr/blob/master/demo/oauth1-twitter.r
[5] https://github.com/petermeissner/twitterlight



Am Do, 19. Nov, 2015 um 5:33 schrieb Tushar Sadhu 
<tushar.sadhu08 at gmail.com>:
> Hello and greetings
> 
> I have been doing Twitter Data Analysis following a few blogs which
> requires me to register as a developer and enter a PIN everytime I 
> want to
> start reading tweets. But now I have made a basic package which does 
> all
> the hectic authentication, but the PIN from an authorized app is still
> required.
> (specifically after twitCred is correctly defined and this step :
> twitCred$handshake(cainfo = system.file("CurlSSL", "cacert.pem", 
> package =
> "RCurl"))     )
> Though it works and reduces the steps, it still has to go to the URL 
> and
> enter the PIN manually
> 
> So my questions are two :
> 
> 1. If I go ahead with the current method of reading tweets by logging 
> from
> my account, how do I automate the process of entering the PIN when 
> the code
> runs inside the package?
> 2. What is the standard method of gathering tweets without any
> authentication at all. How is it done professionally without using 
> anyone's
> account and PIN.
> 
> This is my first question here and I am not sure if I am following the
> right protocols or am asking silly questions. In either case I am 
> sorry.
> 
> Please help!
> Also Thankyou in advance :)
> 
> Regards
> Tushar Sadhu
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From rflight79 at gmail.com  Fri Nov 20 18:11:41 2015
From: rflight79 at gmail.com (Robert M. Flight)
Date: Fri, 20 Nov 2015 17:11:41 +0000
Subject: [R-pkg-devel] Help with making a package for Twitter
	Authentication
In-Reply-To: <CAE_K4vvv7+KLMWDSAPQZWcAAQJQVKF0GMLB_n7gOdgePKF=MwQ@mail.gmail.com>
References: <CAE_K4vvv7+KLMWDSAPQZWcAAQJQVKF0GMLB_n7gOdgePKF=MwQ@mail.gmail.com>
Message-ID: <CAJLyBTUwt8K5RPwjWjC0VO63MgPw0QGVgADe6j4P-48bO2r1pQ@mail.gmail.com>

Tushar,

I've created a Twitter App, and then saved the credentials for that app as
an object that is part of an R package, using the four pieces of *api key,
api secret, token key, token secret* that you get when you create a new
app. I've posted a tutorial here:
http://rmflight.github.io/posts/2014/06/r_job_notifications_twitter.html

The only thing I've found is that with new versions of some packages I may
have to regenerate the object and save it with the package.

Note that this method *should only be used with personal packages*, and the
credential object should never go into version control!

Alternatively, I think there may be a way to read in the four pieces from a
text file to generate the Oauth token object that can then be used for the
session. This might be a better method for a distributable package, and I'm
actually thinking of switching to this method myself, but have not tried it
yet.

I hope this helps.

-Robert

On Fri, Nov 20, 2015 at 11:55 AM Tushar Sadhu <tushar.sadhu08 at gmail.com>
wrote:

> Hello and greetings
>
> I have been doing Twitter Data Analysis following a few blogs which
> requires me to register as a developer and enter a PIN everytime I want to
> start reading tweets. But now I have made a basic package which does all
> the hectic authentication, but the PIN from an authorized app is still
> required.
> (specifically after twitCred is correctly defined and this step :
> twitCred$handshake(cainfo = system.file("CurlSSL", "cacert.pem", package =
> "RCurl"))     )
> Though it works and reduces the steps, it still has to go to the URL and
> enter the PIN manually
>
> So my questions are two :
>
> 1. If I go ahead with the current method of reading tweets by logging from
> my account, how do I automate the process of entering the PIN when the code
> runs inside the package?
> 2. What is the standard method of gathering tweets without any
> authentication at all. How is it done professionally without using anyone's
> account and PIN.
>
> This is my first question here and I am not sure if I am following the
> right protocols or am asking silly questions. In either case I am sorry.
>
> Please help!
> Also Thankyou in advance :)
>
> Regards
> Tushar Sadhu
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From jenny at stat.ubc.ca  Wed Nov 25 00:15:56 2015
From: jenny at stat.ubc.ca (Jenny Bryan)
Date: Tue, 24 Nov 2015 15:15:56 -0800
Subject: [R-pkg-devel] Help with making a package for Twitter
	Authentication
In-Reply-To: <CAJLyBTUwt8K5RPwjWjC0VO63MgPw0QGVgADe6j4P-48bO2r1pQ@mail.gmail.com>
References: <CAE_K4vvv7+KLMWDSAPQZWcAAQJQVKF0GMLB_n7gOdgePKF=MwQ@mail.gmail.com>
	<CAJLyBTUwt8K5RPwjWjC0VO63MgPw0QGVgADe6j4P-48bO2r1pQ@mail.gmail.com>
Message-ID: <991A130D-827D-4BF9-AE1E-87A4A29EB53E@stat.ubc.ca>

> On Nov 21, 2015, at 7:07 PM, Peter Meissner <retep.meissner at gmail.com> wrote:
> 
> Hey,
> 
> I am not sure, that this is the right list for questions that are 'only 
> mildly' related to package developement. Your question is more about 
> API/webscraping etc. . 
> 
> Maybe someone can point to a better place to post questions like this?. 

A good place to ask API wrapping questions is:

https://discuss.ropensci.org

> On Nov 20, 2015, at 9:11 AM, Robert M. Flight <rflight79 at gmail.com> wrote:
> 
> Tushar,
> 
> I've created a Twitter App, and then saved the credentials for that app as
> an object that is part of an R package, using the four pieces of *api key,
> api secret, token key, token secret* that you get when you create a new
> app. I've posted a tutorial here:
> http://rmflight.github.io/posts/2014/06/r_job_notifications_twitter.html
> 
> The only thing I've found is that with new versions of some packages I may
> have to regenerate the object and save it with the package.
> 
> Note that this method *should only be used with personal packages*, and the
> credential object should never go into version control!

While this may not be true for Twitter, there are many APIs where the app key
and ?secret? don?t necessarily need to be kept super secret.

Yes, you would not want to put, e.g., actual access tokens in a package or
on GitHub. I?m NOT contradicting what Robert says above for his approach.

But it feels like package authors are overly conservative about building in
default apps that can facilitate first-time or casual use of an API from R.

? Jenny

From edd at debian.org  Wed Nov 25 04:02:14 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 24 Nov 2015 21:02:14 -0600
Subject: [R-pkg-devel] Help with making a package for
	Twitter	Authentication
In-Reply-To: <CAJLyBTUwt8K5RPwjWjC0VO63MgPw0QGVgADe6j4P-48bO2r1pQ@mail.gmail.com>
References: <CAE_K4vvv7+KLMWDSAPQZWcAAQJQVKF0GMLB_n7gOdgePKF=MwQ@mail.gmail.com>
	<CAJLyBTUwt8K5RPwjWjC0VO63MgPw0QGVgADe6j4P-48bO2r1pQ@mail.gmail.com>
Message-ID: <22101.9398.257771.402644@max.nulle.part>


I just use and external program: bti [1] and let it handle authentication
(there is a set up step).  That works beautifully for two cronjobs:
CRANberries [2] (which has tweeted thousands of times) and the CRAN Repo
Policy changes watcher [3] which tweets whenever the policy document is
updated.  I use bti because the R twitter clients were at the times shutout
from twitter, and I also had a devil of a time making them work. I never
looked back.

That said, I have not attempted to read in bulk.

Hth,  Dirk


[1] By Linux kernel maintainer Greg Kroah-Hartman, see
    https://github.com/gregkh/bti
[2] http://dirk.eddelbuettel.com/cranberries/
[3] https://github.com/eddelbuettel/crp
-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From carnivorescience at gmail.com  Fri Nov 27 19:48:04 2015
From: carnivorescience at gmail.com (Guillaume Chapron)
Date: Fri, 27 Nov 2015 19:48:04 +0100
Subject: [R-pkg-devel] Multi-threaded C with R's RNG
Message-ID: <BBE589F7-F00B-4A44-A355-CEEF5EE257C0@gmail.com>

Hello,

Has anyone written a package with a C code that uses R's RNG but in a multi-threaded way (e.g. to parallelize Monte Carlo simulations)? I do not have the knowledge to figure out myself how to solved this and would need to see an example.

Thanks!

Guillaume

--
Guillaume Chapron, PhD

Associate Professor

Grims? Wildlife Research Station
Swedish University of Agricultural Sciences
SE - 73091 Riddarhyttan, Sweden

http://www.carnivore.science/
Twitter @CarnivoreSci


From edd at debian.org  Fri Nov 27 20:20:01 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 27 Nov 2015 13:20:01 -0600
Subject: [R-pkg-devel] Multi-threaded C with R's RNG
In-Reply-To: <BBE589F7-F00B-4A44-A355-CEEF5EE257C0@gmail.com>
References: <BBE589F7-F00B-4A44-A355-CEEF5EE257C0@gmail.com>
Message-ID: <22104.44257.327624.746646@max.nulle.part>


On 27 November 2015 at 19:48, Guillaume Chapron wrote:
| Has anyone written a package with a C code that uses R's RNG but in a multi-threaded way (e.g. to parallelize Monte Carlo simulations)? I do not have the knowledge to figure out myself how to solved this and would need to see an example.

To the best of my knowledge you cannot do thatas the RNG writes state back,
so you would have interaction between multiple threads and R itself --- which
is almost surely going to end in tears.

Multithreading is fine with proper mutexes, and/or via OpenMP, but keep your
data in non-R data structures and stau away from R while you multithread.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From glennmschultz at me.com  Fri Nov 27 23:33:17 2015
From: glennmschultz at me.com (Glenn Schultz)
Date: Fri, 27 Nov 2015 22:33:17 +0000 (GMT)
Subject: [R-pkg-devel] Strange warnings from build
Message-ID: <3085e3be-9d78-4fdd-b7df-822450fedff6@me.com>

Hello All,?

When I build my package. ?I get the following warnings. ?I think these are related to LaTex and ElCapitan but are flowing through to my R build. All the tests pass and the help files work. ?These are just warnings but are frustrating nonetheless.

Note: I just up graded to El Capitan OS - This blew out my Tex Maker / Knitr to the point that I was ready to give up. ?I had to uninstall mactex and texmaker twice but everything seems to be ?working okay as far a knitr and Tex Maker is concerned - basically I can knit my document and get the same results as before.

I am not sure where to start to correct the R build warnings and I have been researching for about 2-3 weeks. ?I am a little more fearful of the R build warnings than the Tex Maker / Knitr as that issue was basically one of path. 

In R build case I just don't know, so I am a little more fearful. ?If someone could give me a nudge in the right direction I would appreciate the help.

Glenn

The new warnings are:
===============================================================
This is the first one
================================================================
Undocumented arguments in documentation object 'Mortgage.OAS'
?bond.id? ?trade.date? ?settlement.date? ?original.bal? ?price?
?sigma? ?paths?


The code for the constructor function is documented.

#' Mortgage OAS the OAS engine for pass through OAS
#' 
#' Pass through OAS engine
#' @param bond.id A character string the bond id or cusip number
#' @param trade.date A character string the trade date
#' @param settlement.date A character string the settlement date
#' @param original.bal A numeric value the pool original balance
#' @param price A numeric value the price of the pass through
#' @param sigma A numeric value the volatility assumption (not annualized)
#' @param paths A numeric value the number of paths
#' @importFrom lubridate %m+%
#' @export Mortgage.OAS
Mortgage.OAS <- function(bond.id = "character", 
trade.date = "character", 
settlement.date = "character", 
original.bal = numeric(),
price = numeric(), 
sigma = numeric(), 
paths = numeric()
){ some stuff to do OAS}

============================================================
The other is
============================================================

Functions with \usage entries need to have the appropriate \alias
entries, and all their arguments documented.
The \usage entries must correspond to syntactically valid R code.
See chapter ?Writing R documentation files? in the ?Writing R
Extensions? manual.
* checking Rd contents ... OK
* checking for unstated dependencies in examples ... OK
* checking examples ... OK
Examples with CPU or elapsed time > 5s
user system elapsed
REMIC.OAS 22.746 0.351 23.100
PassThroughOAS 11.449 0.067 11.518
* checking PDF version of manual ... WARNING
LaTeX errors when creating PDF version.
This typically indicates Rd problems.
LaTeX errors found:
! You can't use `macro parameter character #' in horizontal mode.
l.1175 #
# Not run: need example
Sorry, but I'm not programmed to handle this case;
I'll just pretend that you didn't ask for it.
! You can't use `macro parameter character #' in horizontal mode.
l.1175 ##


From h.wickham at gmail.com  Fri Nov 27 23:49:36 2015
From: h.wickham at gmail.com (Hadley Wickham)
Date: Sat, 28 Nov 2015 11:49:36 +1300
Subject: [R-pkg-devel] Strange warnings from build
In-Reply-To: <3085e3be-9d78-4fdd-b7df-822450fedff6@me.com>
References: <3085e3be-9d78-4fdd-b7df-822450fedff6@me.com>
Message-ID: <CABdHhvGFJ_VvmqEy3aDQTaMbV5jSyMbjrqAHFxx-eKS6=F1atA@mail.gmail.com>

Take a look at this line:

#' #' Pass through OAS engine

Hadley

On Sat, Nov 28, 2015 at 11:33 AM, Glenn Schultz <glennmschultz at me.com> wrote:
> Hello All,
>
> When I build my package.  I get the following warnings.  I think these are
> related to LaTex and ElCapitan but are flowing through to my R build. All
> the tests pass and the help files work.  These are just warnings but are
> frustrating nonetheless.
>
> Note: I just up graded to El Capitan OS - This blew out my Tex Maker / Knitr
> to the point that I was ready to give up.  I had to uninstall mactex and
> texmaker twice but everything seems to be  working okay as far a knitr and
> Tex Maker is concerned - basically I can knit my document and get the same
> results as before.
>
> I am not sure where to start to correct the R build warnings and I have been
> researching for about 2-3 weeks.  I am a little more fearful of the R build
> warnings than the Tex Maker / Knitr as that issue was basically one of path.
> In R build case I just don't know, so I am a little more fearful.  If
> someone could give me a nudge in the right direction I would appreciate the
> help.
>
> Glenn
>
> The new warnings are:
> ===============================================================
> This is the first one
> ================================================================
> Undocumented arguments in documentation object 'Mortgage.OAS'
> ?bond.id? ?trade.date? ?settlement.date? ?original.bal? ?price?
> ?sigma? ?paths?
>
>
> The code for the constructor function is documented.
>
> #' Mortgage OAS the OAS engine for pass through OAS
> #' #' Pass through OAS engine
> #' @param bond.id A character string the bond id or cusip number
> #' @param trade.date A character string the trade date
> #' @param settlement.date A character string the settlement date
> #' @param original.bal A numeric value the pool original balance
> #' @param price A numeric value the price of the pass through
> #' @param sigma A numeric value the volatility assumption (not annualized)
> #' @param paths A numeric value the number of paths
> #' @importFrom lubridate %m+%
> #' @export Mortgage.OAS
> Mortgage.OAS <- function(bond.id = "character", trade.date = "character",
> settlement.date = "character", original.bal = numeric(),
> price = numeric(), sigma = numeric(), paths = numeric()
> ){ some stuff to do OAS}
>
> ============================================================
> The other is
> ============================================================
>
> Functions with \usage entries need to have the appropriate \alias
> entries, and all their arguments documented.
> The \usage entries must correspond to syntactically valid R code.
> See chapter ?Writing R documentation files? in the ?Writing R
> Extensions? manual.
> * checking Rd contents ... OK
> * checking for unstated dependencies in examples ... OK
> * checking examples ... OK
> Examples with CPU or elapsed time > 5s
> user system elapsed
> REMIC.OAS 22.746 0.351 23.100
> PassThroughOAS 11.449 0.067 11.518
> * checking PDF version of manual ... WARNING
> LaTeX errors when creating PDF version.
> This typically indicates Rd problems.
> LaTeX errors found:
> ! You can't use `macro parameter character #' in horizontal mode.
> l.1175 #
> # Not run: need example
> Sorry, but I'm not programmed to handle this case;
> I'll just pretend that you didn't ask for it.
> ! You can't use `macro parameter character #' in horizontal mode.
> l.1175 ##
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
http://had.co.nz/


From Tom.Snijders at nuffield.ox.ac.uk  Sat Nov 28 14:40:47 2015
From: Tom.Snijders at nuffield.ox.ac.uk (Tom Snijders)
Date: Sat, 28 Nov 2015 13:40:47 +0000
Subject: [R-pkg-devel] Multi-threaded C with R's RNG
Message-ID: <38F6D40F55648441B2070D889450ADCBB9A66B0E@NUFF-ROCKALL.nuff.ox.ac.uk>

On Fri, 27 Nov 2015 19:48:04 +0100, Guillaume Chapron carnivorescience at gmail.com<mailto:carnivorescience at gmail.com> wrote:



| Has anyone written a package with a C code that uses R's RNG but in a multi-threaded way (e.g. to parallelize Monte Carlo simulations)? I do not have the knowledge to figure out myself how to solved this and would need to see an example.



This is done in RSiena, using the package parallel. The programming was done by Ruth Ripley. There is some documentation in the package RSienaTest in \doc\RSIENAspec.tex and \doc\RSienaDeveloper.tex (search in these files for 'processes'); RSienaTest is not at CRAN but can be obtained from http://r-forge.r-project.org/R/?group_id=461; with respect to this use of random number streams, RSiena and RSienaTest are identical.



Best wishes,

Tom
================================================================
Tom A.B. Snijders
Professor of Statistics and Methodology
Dept. of Sociology, University of Groningen
Emeritus Fellow, Nuffield College, University of Oxford
Associate Member, Dept. of Statistics, University of Oxford
http://www.stats.ox.ac.uk/~snijders/


	[[alternative HTML version deleted]]


From edd at debian.org  Sat Nov 28 18:24:03 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 28 Nov 2015 11:24:03 -0600
Subject: [R-pkg-devel] Multi-threaded C with R's RNG
In-Reply-To: <38F6D40F55648441B2070D889450ADCBB9A66B0E@NUFF-ROCKALL.nuff.ox.ac.uk>
References: <38F6D40F55648441B2070D889450ADCBB9A66B0E@NUFF-ROCKALL.nuff.ox.ac.uk>
Message-ID: <22105.58163.684418.782407@max.nulle.part>


On 28 November 2015 at 13:40, Tom Snijders wrote:
| On Fri, 27 Nov 2015 19:48:04 +0100, Guillaume Chapron carnivorescience at gmail.com<mailto:carnivorescience at gmail.com> wrote:
| 
| 
| 
| | Has anyone written a package with a C code that uses R's RNG but in a multi-threaded way (e.g. to parallelize Monte Carlo simulations)? I do not have the knowledge to figure out myself how to solved this and would need to see an example.
| 
| 
| 
| This is done in RSiena, using the package parallel. The programming was done by Ruth Ripley. There is some documentation in the package RSienaTest in \doc\RSIENAspec.tex and \doc\RSienaDeveloper.tex (search in these files for 'processes'); RSienaTest is not at CRAN but can be obtained from http://r-forge.r-project.org/R/?group_id=461; with respect to this use of random number streams, RSiena and RSienaTest are identical.

I just glanced at its Random.h and Random.cpp.  One could split hairs and say
that its use of unif_rand() and subsequent _modifications within RSiena_
itself keep the calculation away from R's core.

See Writing R Extensions and the difference between using the RNG via
unif_rand (as also discussed in using the optional external math library that
buildable from R sources) and using the full-blown d/p/q/r functions.
Presumably when people ask for 'R random numbers in streams' they want the
full richness of the various distributions available for random draws.

But your point is well taken: the basic uniform sample can be accessed, and
hence be seeded from R before calling.   More complicated (parallel) setup
may still require extrade code.

There are a few CRAN packages doing that.  Too bad we don't have a nice
survey paper.  I could do with one now...

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From roman.storchak at gmail.com  Tue Dec  1 17:16:00 2015
From: roman.storchak at gmail.com (Roman Storchak)
Date: Tue, 1 Dec 2015 23:16:00 +0700
Subject: [R-pkg-devel] First response time of the function is worse than
	following ones
Message-ID: <CAHS+ucXjuLm8JuC+3ShT-DFh=rO2FAh7f9z+WUEeb=bhMqos8w@mail.gmail.com>

Hello,
I am trying to create my first package that should be used with an OpenCPU
server.

This package requires 2 things:
     -    to load multiple multiple objects to RAM/ Done by onLoad function.

   - It depends on 3  libraries that are loaded by "Imports: data.table,
   gbm, stringdist" in DESCRIPTION file. ( and lazyload is False)

My package and its dependencies are listed in preload section  in the
/etc/opencpu/server.conf


Technically, everything works as expected, but:
When I load package first time system.time(myfunc(input)) is substantially
higher then all following timings.  I don?t understand why it happens.  All
dependencies are preloaded, all objects are loaded in to RAM.

On the higher scale - same (unknown to me) reason prevents package achieve
desired response delay while being used through an OpenCPU.

I can't understand why it is happening. Which way should I elaborate on the
package?


-- 
????? ???????, PhD
???????: 093.713.55.25
http://www.linkedin.com/in/storchak

	[[alternative HTML version deleted]]


From famuvie at gmail.com  Thu Dec  3 00:24:22 2015
From: famuvie at gmail.com (=?UTF-8?Q?Facundo_Mu=c3=b1oz?=)
Date: Thu, 3 Dec 2015 00:24:22 +0100
Subject: [R-pkg-devel] coercion in R CMD check
Message-ID: <565F7DA6.5060905@gmail.com>

I have been struggling all day with this issue, which was terribly
difficult to identify.

In the end, if I have a test in my package such as:

test_that("coercions works... depending the check", {
  s = "/A/string/starting/with/a/slash"
  expect_true(s > 0)
})


then if I test() it, it goes fine.
But if I R CMD check the packaged source, it fails.

I don't understand the difference between the testing performed by R CMD
check, and the testing performed by myself. It is not related with
--as-cran.


Cheers
        ?acu.-


From edd at debian.org  Thu Dec  3 00:35:27 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 2 Dec 2015 17:35:27 -0600
Subject: [R-pkg-devel] coercion in R CMD check
In-Reply-To: <565F7DA6.5060905@gmail.com>
References: <565F7DA6.5060905@gmail.com>
Message-ID: <22111.32831.774804.817345@max.nulle.part>


On 3 December 2015 at 00:24, Facundo Mu?oz wrote:
| I have been struggling all day with this issue, which was terribly
| difficult to identify.
| 
| In the end, if I have a test in my package such as:
| 
| test_that("coercions works... depending the check", {
|   s = "/A/string/starting/with/a/slash"
|   expect_true(s > 0)
| })
| 
| 
| then if I test() it, it goes fine.
| But if I R CMD check the packaged source, it fails.
| 
| I don't understand the difference between the testing performed by R CMD
| check, and the testing performed by myself. It is not related with
| --as-cran.

Do have testthat loaded?  Can you analyse a minimal working package and see
what is different?  We don't have your package so ...   Start from one of the
hundreds of testthat using packages on CRAN and see what they do.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From ligges at statistik.tu-dortmund.de  Thu Dec  3 00:37:40 2015
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 3 Dec 2015 00:37:40 +0100
Subject: [R-pkg-devel] coercion in R CMD check
In-Reply-To: <565F7DA6.5060905@gmail.com>
References: <565F7DA6.5060905@gmail.com>
Message-ID: <565F80C4.4010205@statistik.tu-dortmund.de>



On 03.12.2015 00:24, Facundo Mu?oz wrote:
> I have been struggling all day with this issue, which was terribly
> difficult to identify.
>
> In the end, if I have a test in my package such as:
>
> test_that("coercions works... depending the check", {
>    s = "/A/string/starting/with/a/slash"
>    expect_true(s > 0)


This depends on the locale you are in.

s > 0 is FALSE for me in all locales I just tried ...



Best,
Uwe Ligges





> })
>
>
> then if I test() it, it goes fine.
> But if I R CMD check the packaged source, it fails.
>
> I don't understand the difference between the testing performed by R CMD
> check, and the testing performed by myself. It is not related with
> --as-cran.
>
>
> Cheers
>          ?acu.-
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From wdunlap at tibco.com  Thu Dec  3 01:50:41 2015
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 2 Dec 2015 16:50:41 -0800
Subject: [R-pkg-devel] coercion in R CMD check
In-Reply-To: <565F7DA6.5060905@gmail.com>
References: <565F7DA6.5060905@gmail.com>
Message-ID: <CAF8bMcZcL=rdnEGSUs_MoswNJ9Pvb5pw7vuRLnKZLVHwRZDC2Q@mail.gmail.com>

It may depend on your locale setting (see Sys.getlocale() and Sys.setlocale()).
In what locale is "/A/string" > "0"?
Bill Dunlap
TIBCO Software
wdunlap tibco.com


On Wed, Dec 2, 2015 at 3:24 PM, Facundo Mu?oz <famuvie at gmail.com> wrote:
> I have been struggling all day with this issue, which was terribly
> difficult to identify.
>
> In the end, if I have a test in my package such as:
>
> test_that("coercions works... depending the check", {
>   s = "/A/string/starting/with/a/slash"
>   expect_true(s > 0)
> })
>
>
> then if I test() it, it goes fine.
> But if I R CMD check the packaged source, it fails.
>
> I don't understand the difference between the testing performed by R CMD
> check, and the testing performed by myself. It is not related with
> --as-cran.
>
>
> Cheers
>         ?acu.-
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From berryboessenkool at hotmail.com  Thu Dec  3 09:40:12 2015
From: berryboessenkool at hotmail.com (Berry Boessenkool)
Date: Thu, 3 Dec 2015 09:40:12 +0100
Subject: [R-pkg-devel] install from github
Message-ID: <DUB123-W35C7421F2E63F2F8CD401ED50D0@phx.gbl>





Hi,

is someone aware of a way to easily install a package hosted on github without using devtools::install_github?
Does anyone else ever need to avoid devtools?
Would something doing that be worth a package on CRAN?
Optional if no,yes,yes: Is my basic idea below any good at all?

Thanks ahead,
Berry, Potsdam, Germany

Details:

devtools has so many dependencies that it takes quite some time to install on old computers or with slow internet. Not suitable for a quick demo in the R course I'm teaching, which I found out the hard way (thinking R had hung up, I terminated it, crashing Rstudio in the proces...).
Not finding anything and happy to postpone actual work, I wrote some (very!) basic code. I doubt it works across platforms and situations. I guess I'm doing useless stuff, but I had fun and learned a few new things...


instgithub <- function(
   pk, # "user/package"
   cleanup=TRUE, # remove downloaded zipfile and folder with source code
   ...) # Further arguments passed to install.packages, untested so far
{
pkn <- strsplit(pk, "/")[[1]][2] # package name part
download.file(url=paste0("https://github.com/",pk,"/archive/master.zip"),
              destfile=paste0(pkn,".zip"))
unzip(paste0(pkn,".zip"))
file.rename(paste0(pkn,"-master"), pkn)
# Dependencies - really not elegant at all!
deps <- read.dcf(paste0(pkn, "/DESCRIPTION"), fields="Imports")
deps <- strsplit(deps, ", ")[[1]]
deps <- sapply(strsplit(deps, " ", fixed=T), "[", 1) # remove version restrictions
deps <- deps[!deps %in% rownames(installed.packages())] # install only new packages
# install dependencies
dummy <- lapply(na.omit(deps), install.packages, ...)
# actually install the package itself:
install.packages(pkn, repos=NULL, type="source", ...)
# clean up:
if(cleanup)
  {
  unlink(pkn, recursive=TRUE)
  unlink(paste0(pkn,".zip"))
  }
}

# example test cases, work fine on windows 7 with current R3.2.2 + write permission at getwd:
if(FALSE){
instgithub(pk="brry/extremeStat")
library(extremeStat)
instgithub("talgalili/installr")
instgithub("hadley/readxl")
}



 		 	   		  
	[[alternative HTML version deleted]]


From Rainer at krugs.de  Thu Dec  3 10:00:15 2015
From: Rainer at krugs.de (Rainer M Krug)
Date: Thu, 03 Dec 2015 10:00:15 +0100
Subject: [R-pkg-devel] install from github
In-Reply-To: <DUB123-W35C7421F2E63F2F8CD401ED50D0@phx.gbl> (Berry
	Boessenkool's message of "Thu, 3 Dec 2015 09:40:12 +0100")
References: <DUB123-W35C7421F2E63F2F8CD401ED50D0@phx.gbl>
Message-ID: <m2a8prvrds.fsf@krugs.de>

Berry Boessenkool <berryboessenkool at hotmail.com> writes:

> Hi,
>
> is someone aware of a way to easily install a package hosted on github without using devtools::install_github?
> Does anyone else ever need to avoid devtools?
Hi,

Check out drat [https://github.com/eddelbuettel/drat]  and for a
description check out
[http://eddelbuettel.github.io/drat/DratForPackageAuthors.html].

Be aware that I have never used it - but I should...

Cheers,

Rainer


> Would something doing that be worth a package on CRAN?
> Optional if no,yes,yes: Is my basic idea below any good at all?
>
> Thanks ahead,
> Berry, Potsdam, Germany
>
> Details:
>
> devtools has so many dependencies that it takes quite some time to install on old computers or with slow internet. Not suitable for a quick demo in the R course I'm teaching, which I found out the hard way (thinking R had hung up, I terminated it, crashing Rstudio in the proces...).
> Not finding anything and happy to postpone actual work, I wrote some (very!) basic code. I doubt it works across platforms and situations. I guess I'm doing useless stuff, but I had fun and learned a few new things...
>
>
> instgithub <- function(
>    pk, # "user/package"
>    cleanup=TRUE, # remove downloaded zipfile and folder with source code
>    ...) # Further arguments passed to install.packages, untested so far
> {
> pkn <- strsplit(pk, "/")[[1]][2] # package name part
> download.file(url=paste0("https://github.com/",pk,"/archive/master.zip"),
>               destfile=paste0(pkn,".zip"))
> unzip(paste0(pkn,".zip"))
> file.rename(paste0(pkn,"-master"), pkn)
> # Dependencies - really not elegant at all!
> deps <- read.dcf(paste0(pkn, "/DESCRIPTION"), fields="Imports")
> deps <- strsplit(deps, ", ")[[1]]
> deps <- sapply(strsplit(deps, " ", fixed=T), "[", 1) # remove version restrictions
> deps <- deps[!deps %in% rownames(installed.packages())] # install only new packages
> # install dependencies
> dummy <- lapply(na.omit(deps), install.packages, ...)
> # actually install the package itself:
> install.packages(pkn, repos=NULL, type="source", ...)
> # clean up:
> if(cleanup)
>   {
>   unlink(pkn, recursive=TRUE)
>   unlink(paste0(pkn,".zip"))
>   }
> }
>
> # example test cases, work fine on windows 7 with current R3.2.2 + write permission at getwd:
> if(FALSE){
> instgithub(pk="brry/extremeStat")
> library(extremeStat)
> instgithub("talgalili/installr")
> instgithub("hadley/readxl")
> }
>
>
>
>  		 	   		  
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug

PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20151203/309435f1/attachment.bin>

From mark.vanderloo at gmail.com  Thu Dec  3 11:50:36 2015
From: mark.vanderloo at gmail.com (Mark van der Loo)
Date: Thu, 03 Dec 2015 10:50:36 +0000
Subject: [R-pkg-devel] install from github
In-Reply-To: <m2a8prvrds.fsf@krugs.de>
References: <DUB123-W35C7421F2E63F2F8CD401ED50D0@phx.gbl>
	<m2a8prvrds.fsf@krugs.de>
Message-ID: <CAOKDuOj0i2gvV_VMzcN8TuBs_VmR7vg2v5U=WK3FAFPwpqZwAw@mail.gmail.com>

>> is someone aware of a way to easily install a package hosted on github
without using devtools::install_github?

Personally, I love Dirk's[1] drat package. It allows authors to set up a
personal CRAN-like system on their github pages. This means that the author
of the package can decide when a (beta) release of a package is ready for
use. I use it frequently, for example to allow people to confirm bug fixes
prior to resubmitting to CRAN.

>> Does anyone else ever need to avoid devtools?

I love devtools, but avoid install_github. Be aware that installing from
github does require some knowledge of the (directory) structure of the
repo, which not necessarily is that of a package. For example, in my
R-package repos, the package is always behind a pkg/[pkgname] folder. Besides
that you can't be sure that a package downloaded from github actually
builds (unless the author uses a build service), there are issues with
documentation. install_github for example presumes that all Rd files are in
the repo[2]. As these are nowadays mostly generated by Roxygen2, I feel
such files do not belong there and since the creation of Roxygen I've left
them out. Other authors might do the same.

I also wonder about the use case of install_github in an R-course. The
courses I teach never depend on software that are in an experimental stage
(there's enough to teach on CRAN)

>> Would something doing that be worth a package on CRAN?

I agree with the dependency issue, so in that sense yes. But to make it
robust, repo-owners probably need to adhere to either a pure R package
structure or start using makefiles for package building.


Best,
Mark

[1] When I say Dirk, I assume you know which one :-).
[2] At least, this used to be true. I haven't used it in a while.









Op do 3 dec. 2015 om 10:01 schreef Rainer M Krug <Rainer at krugs.de>:

> Berry Boessenkool <berryboessenkool at hotmail.com> writes:
>
> > Hi,
> >
> > is someone aware of a way to easily install a package hosted on github
> without using devtools::install_github?
> > Does anyone else ever need to avoid devtools?
> Hi,
>
> Check out drat [https://github.com/eddelbuettel/drat]  and for a
> description check out
> [http://eddelbuettel.github.io/drat/DratForPackageAuthors.html].
>
> Be aware that I have never used it - but I should...
>
> Cheers,
>
> Rainer
>
>
> > Would something doing that be worth a package on CRAN?
> > Optional if no,yes,yes: Is my basic idea below any good at all?
> >
> > Thanks ahead,
> > Berry, Potsdam, Germany
> >
> > Details:
> >
> > devtools has so many dependencies that it takes quite some time to
> install on old computers or with slow internet. Not suitable for a quick
> demo in the R course I'm teaching, which I found out the hard way (thinking
> R had hung up, I terminated it, crashing Rstudio in the proces...).
> > Not finding anything and happy to postpone actual work, I wrote some
> (very!) basic code. I doubt it works across platforms and situations. I
> guess I'm doing useless stuff, but I had fun and learned a few new things...
> >
> >
> > instgithub <- function(
> >    pk, # "user/package"
> >    cleanup=TRUE, # remove downloaded zipfile and folder with source code
> >    ...) # Further arguments passed to install.packages, untested so far
> > {
> > pkn <- strsplit(pk, "/")[[1]][2] # package name part
> > download.file(url=paste0("https://github.com/
> ",pk,"/archive/master.zip"),
> >               destfile=paste0(pkn,".zip"))
> > unzip(paste0(pkn,".zip"))
> > file.rename(paste0(pkn,"-master"), pkn)
> > # Dependencies - really not elegant at all!
> > deps <- read.dcf(paste0(pkn, "/DESCRIPTION"), fields="Imports")
> > deps <- strsplit(deps, ", ")[[1]]
> > deps <- sapply(strsplit(deps, " ", fixed=T), "[", 1) # remove version
> restrictions
> > deps <- deps[!deps %in% rownames(installed.packages())] # install only
> new packages
> > # install dependencies
> > dummy <- lapply(na.omit(deps), install.packages, ...)
> > # actually install the package itself:
> > install.packages(pkn, repos=NULL, type="source", ...)
> > # clean up:
> > if(cleanup)
> >   {
> >   unlink(pkn, recursive=TRUE)
> >   unlink(paste0(pkn,".zip"))
> >   }
> > }
> >
> > # example test cases, work fine on windows 7 with current R3.2.2 + write
> permission at getwd:
> > if(FALSE){
> > instgithub(pk="brry/extremeStat")
> > library(extremeStat)
> > instgithub("talgalili/installr")
> > instgithub("hadley/readxl")
> > }
> >
> >
> >
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> --
> Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
> Biology, UCT), Dipl. Phys. (Germany)
>
> Centre of Excellence for Invasion Biology
> Stellenbosch University
> South Africa
>
> Tel :       +33 - (0)9 53 10 27 44
> Cell:       +33 - (0)6 85 62 59 98
> Fax :       +33 - (0)9 58 10 27 44
>
> Fax (D):    +49 - (0)3 21 21 25 22 44
>
> email:      Rainer at krugs.de
>
> Skype:      RMkrug
>
> PGP: 0x0F52F982
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From edd at debian.org  Fri Dec  4 03:53:48 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 3 Dec 2015 20:53:48 -0600
Subject: [R-pkg-devel] install from github
In-Reply-To: <DUB123-W35C7421F2E63F2F8CD401ED50D0@phx.gbl>
References: <DUB123-W35C7421F2E63F2F8CD401ED50D0@phx.gbl>
Message-ID: <22113.60.245674.943246@max.nulle.part>


Berry,

Missed this this morning ...

On 3 December 2015 at 09:40, Berry Boessenkool wrote:
| is someone aware of a way to easily install a package hosted on github without using devtools::install_github?

Sure, drat can help. A couple of people use it for their packages; Mark
who already replied is among.

| Does anyone else ever need to avoid devtools?

Sure. I happen to basically never ever use devtools. 

| Would something doing that be worth a package on CRAN?

Sure, drat :)

| Optional if no,yes,yes: Is my basic idea below any good at all?

I would think so.

drat wraps around some code in base R's tools package to help _create_ a
repository, and also wraps around base R's options() to set additional
repositories.  After that, it is just install.packages() and of course
update.packages() giving you full repository flow and dependency resolution.

And as Mark already pointed out, installation will pick tarballs released
by their _authors_ rather than a random snapshot picking by chance by the
user.

The hardest part about drat is explaining. According to some people in the
room (hi, David!) I even failed at that during my six minutes at useR!.  Oh
well.  You have a couple of vignettes, my website and the github repo. Maybe
start at http://dirk.eddelbuettel.com/code/drat.html.

Cheers, Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From tushar.sadhu08 at gmail.com  Sun Dec  6 20:44:50 2015
From: tushar.sadhu08 at gmail.com (Tushar Sadhu)
Date: Mon, 7 Dec 2015 01:14:50 +0530
Subject: [R-pkg-devel] Help with making a package for Twitter
	Authentication
In-Reply-To: <22101.9398.257771.402644@max.nulle.part>
References: <CAE_K4vvv7+KLMWDSAPQZWcAAQJQVKF0GMLB_n7gOdgePKF=MwQ@mail.gmail.com>
	<CAJLyBTUwt8K5RPwjWjC0VO63MgPw0QGVgADe6j4P-48bO2r1pQ@mail.gmail.com>
	<22101.9398.257771.402644@max.nulle.part>
Message-ID: <CAE_K4vscbM5URCq3zq0WFHJ010uu_MOUmRvDcYUb6eRnSKrr9w@mail.gmail.com>

Hello everyone!
Really sorry for the late reply. So I read and read up as all the answers
suggested and here is my response to all  of them but before that, I want
to establish what I am trying to achieve:

The aim is to get a Twitter App that displays n number of tweets about a
particular #tag but the main constraint is that it HAS to be put on version
control. Now the issue is this cannot happen without my personal account
being involved and the consumer token and keys along with the app specific
tokens being put up there.

One easy solution will be to create a twitter account for my project called
APPada (thereby removing my personal account from the picture) and then let
its keys out in the open as it wont harm anyone. Is this advisable?
But I want to know if there is a way to not include accounts at all.
As someone said bulk reading

Now to the individual responses :

1. Robert,
I have infact followed the exact way you mentioned but have you tried using
your app for the last few months? They changed their policy of verification
and so there is a extra input value that I have to provide for accessing
Twitter.
http://stackoverflow.com/questions/31128492/twitter-setup-twitter-oauth-failing

After a lot of StackOverflow-ing and experimenting I found the solution to
get it work like the old times
  requestURL <- "https://api.twitter.com/oauth/request_token"
  accessURL <- "https://api.twitter.com/oauth/access_token"
  authURL <- "https://api.twitter.com/oauth/authorize"

  twitCred <- OAuthFactory$new(consumerKey=consumer_key,
                               consumerSecret=consumer_secret,
                               requestURL=requestURL,
                               accessURL=accessURL,
                               authURL=authURL)
  twitCred$handshake(cainfo = system.file("CurlSSL", "cacert.pem", package
= "RCurl"))
  save(twitCred, file="twitter authentication.Rdata")
  load("twitter authentication.Rdata")

  consumer_key = twitCred$consumerKey
  consumer_secret = twitCred$consumerSecret
  access_token = twitCred$oauthKey
  access_secret = twitCred$oauthSecret

  setup_twitter_oauth(consumer_key, consumer_secret, access_token,
access_secret)

Once this done, I have to manually enter the PIN dispplayed in the webpage
I ma directed to. Then everything works fine.
So the package I made had a function called AppadaInit() which did all this
and yet it required the PIN.
Another requirement is that my account has to be logged into everytime this
package is used. (Please find the screenshots attached which show these
issues)

Therefore it cannot be used for a project where I want people download it
and to use this.

2. Peter,
The above method does use twitteR and the problem is that with the old
commands its functionalities (oauth_app) give the following message

OAuth authentication error:
This most likely means that you have incorrectly called
setup_twitter_oauth()'
And that is the reason I went ahead with the only way which works, ie
entering the PIN everytime

3. Jenny,
Thanks for the forum link I will check for a solution there. But I did not
understand what you meant by this :
"But it feels like package authors are overly conservative about building in
default apps that can facilitate first-time or casual use of an API from R."


4. Dirk,
I have never used a Cronjob. Not sure how they work.Is it needed for a
small project?

Sorry for the long message, kindly do reply

Finally, thanks a lot for the replies so far guys!

Regards
Tushar Sadhu





On Wed, Nov 25, 2015 at 8:32 AM, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> I just use and external program: bti [1] and let it handle authentication
> (there is a set up step).  That works beautifully for two cronjobs:
> CRANberries [2] (which has tweeted thousands of times) and the CRAN Repo
> Policy changes watcher [3] which tweets whenever the policy document is
> updated.  I use bti because the R twitter clients were at the times shutout
> from twitter, and I also had a devil of a time making them work. I never
> looked back.
>
> That said, I have not attempted to read in bulk.
>
> Hth,  Dirk
>
>
> [1] By Linux kernel maintainer Greg Kroah-Hartman, see
>     https://github.com/gregkh/bti
> [2] http://dirk.eddelbuettel.com/cranberries/
> [3] https://github.com/eddelbuettel/crp
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From tushar.sadhu08 at gmail.com  Sun Dec  6 20:48:20 2015
From: tushar.sadhu08 at gmail.com (Tushar Sadhu)
Date: Mon, 7 Dec 2015 01:18:20 +0530
Subject: [R-pkg-devel] Help with making a package for Twitter
	Authentication
In-Reply-To: <CAE_K4vscbM5URCq3zq0WFHJ010uu_MOUmRvDcYUb6eRnSKrr9w@mail.gmail.com>
References: <CAE_K4vvv7+KLMWDSAPQZWcAAQJQVKF0GMLB_n7gOdgePKF=MwQ@mail.gmail.com>
	<CAJLyBTUwt8K5RPwjWjC0VO63MgPw0QGVgADe6j4P-48bO2r1pQ@mail.gmail.com>
	<22101.9398.257771.402644@max.nulle.part>
	<CAE_K4vscbM5URCq3zq0WFHJ010uu_MOUmRvDcYUb6eRnSKrr9w@mail.gmail.com>
Message-ID: <CAE_K4vv_SwjSi3z6t6SxXFjdVPwZ11So+Tqi3yhpGvZbu7HSGw@mail.gmail.com>

PS : The Screenshots are in the attachments

On Mon, Dec 7, 2015 at 1:14 AM, Tushar Sadhu <tushar.sadhu08 at gmail.com>
wrote:

> Hello everyone!
> Really sorry for the late reply. So I read and read up as all the answers
> suggested and here is my response to all  of them but before that, I want
> to establish what I am trying to achieve:
>
> The aim is to get a Twitter App that displays n number of tweets about a
> particular #tag but the main constraint is that it HAS to be put on version
> control. Now the issue is this cannot happen without my personal account
> being involved and the consumer token and keys along with the app specific
> tokens being put up there.
>
> One easy solution will be to create a twitter account for my project
> called APPada (thereby removing my personal account from the picture) and
> then let its keys out in the open as it wont harm anyone. Is this advisable?
> But I want to know if there is a way to not include accounts at all.
> As someone said bulk reading
>
> Now to the individual responses :
>
> 1. Robert,
> I have infact followed the exact way you mentioned but have you tried
> using your app for the last few months? They changed their policy of
> verification and so there is a extra input value that I have to provide for
> accessing Twitter.
>
> http://stackoverflow.com/questions/31128492/twitter-setup-twitter-oauth-failing
>
> After a lot of StackOverflow-ing and experimenting I found the solution to
> get it work like the old times
>   requestURL <- "https://api.twitter.com/oauth/request_token"
>   accessURL <- "https://api.twitter.com/oauth/access_token"
>   authURL <- "https://api.twitter.com/oauth/authorize"
>
>   twitCred <- OAuthFactory$new(consumerKey=consumer_key,
>                                consumerSecret=consumer_secret,
>                                requestURL=requestURL,
>                                accessURL=accessURL,
>                                authURL=authURL)
>   twitCred$handshake(cainfo = system.file("CurlSSL", "cacert.pem", package
> = "RCurl"))
>   save(twitCred, file="twitter authentication.Rdata")
>   load("twitter authentication.Rdata")
>
>   consumer_key = twitCred$consumerKey
>   consumer_secret = twitCred$consumerSecret
>   access_token = twitCred$oauthKey
>   access_secret = twitCred$oauthSecret
>
>   setup_twitter_oauth(consumer_key, consumer_secret, access_token,
> access_secret)
>
> Once this done, I have to manually enter the PIN dispplayed in the webpage
> I ma directed to. Then everything works fine.
> So the package I made had a function called AppadaInit() which did all
> this and yet it required the PIN.
> Another requirement is that my account has to be logged into everytime
> this package is used. (Please find the screenshots attached which show
> these issues)
>
> Therefore it cannot be used for a project where I want people download it
> and to use this.
>
> 2. Peter,
> The above method does use twitteR and the problem is that with the old
> commands its functionalities (oauth_app) give the following message
>
> OAuth authentication error:
> This most likely means that you have incorrectly called
> setup_twitter_oauth()'
> And that is the reason I went ahead with the only way which works, ie
> entering the PIN everytime
>
> 3. Jenny,
> Thanks for the forum link I will check for a solution there. But I did not
> understand what you meant by this :
> "But it feels like package authors are overly conservative about building
> in
> default apps that can facilitate first-time or casual use of an API from R.
> "
>
>
> 4. Dirk,
> I have never used a Cronjob. Not sure how they work.Is it needed for a
> small project?
>
> Sorry for the long message, kindly do reply
>
> Finally, thanks a lot for the replies so far guys!
>
> Regards
> Tushar Sadhu
>
>
>
>
>
> On Wed, Nov 25, 2015 at 8:32 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
>>
>> I just use and external program: bti [1] and let it handle authentication
>> (there is a set up step).  That works beautifully for two cronjobs:
>> CRANberries [2] (which has tweeted thousands of times) and the CRAN Repo
>> Policy changes watcher [3] which tweets whenever the policy document is
>> updated.  I use bti because the R twitter clients were at the times
>> shutout
>> from twitter, and I also had a devil of a time making them work. I never
>> looked back.
>>
>> That said, I have not attempted to read in bulk.
>>
>> Hth,  Dirk
>>
>>
>> [1] By Linux kernel maintainer Greg Kroah-Hartman, see
>>     https://github.com/gregkh/bti
>> [2] http://dirk.eddelbuettel.com/cranberries/
>> [3] https://github.com/eddelbuettel/crp
>> --
>> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>>
>
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 1.png
Type: image/png
Size: 118297 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20151207/d2a4088a/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 2.png
Type: image/png
Size: 102893 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20151207/d2a4088a/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 3.png
Type: image/png
Size: 112155 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20151207/d2a4088a/attachment-0002.png>

From edd at debian.org  Sun Dec  6 21:55:10 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 6 Dec 2015 14:55:10 -0600
Subject: [R-pkg-devel] Help with making a package for Twitter
	Authentication
In-Reply-To: <CAE_K4vv_SwjSi3z6t6SxXFjdVPwZ11So+Tqi3yhpGvZbu7HSGw@mail.gmail.com>
References: <CAE_K4vvv7+KLMWDSAPQZWcAAQJQVKF0GMLB_n7gOdgePKF=MwQ@mail.gmail.com>
	<CAJLyBTUwt8K5RPwjWjC0VO63MgPw0QGVgADe6j4P-48bO2r1pQ@mail.gmail.com>
	<22101.9398.257771.402644@max.nulle.part>
	<CAE_K4vscbM5URCq3zq0WFHJ010uu_MOUmRvDcYUb6eRnSKrr9w@mail.gmail.com>
	<CAE_K4vv_SwjSi3z6t6SxXFjdVPwZ11So+Tqi3yhpGvZbu7HSGw@mail.gmail.com>
Message-ID: <22116.41134.910096.171291@max.nulle.part>


On 7 December 2015 at 01:18, Tushar Sadhu wrote:
| PS : The Screenshots are in the attachments

Please don't do that. Place it somewhere on the intertubes and link to
it. Thin of the email list as ascii only.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murray.efford at otago.ac.nz  Tue Dec  8 05:54:03 2015
From: murray.efford at otago.ac.nz (Murray Efford)
Date: Tue, 8 Dec 2015 04:54:03 +0000
Subject: [R-pkg-devel] C function dbinom_raw missing on
	r-oldrel-windows-ix86+x86_64
Message-ID: <b7bc4a470fa14dfd88afa240d80948be@its-mail-p03.registry.otago.ac.nz>

My recent revision of the package 'secr' has been accepted by CRAN, but I
see from the Check Results that installation fails (see link below) on
r-oldrel-windows-ix86+x86_64 (alone) because it cannot find dbinom_raw
(which I now call directly). Is there an easy fix, and should I bother?

https://www.r-project.org/nosvn/R.check/r-oldrel-windows-ix86+x86_64/secr-00install.html

Murray

From erik.bulow at rccvast.se  Tue Dec  8 12:13:31 2015
From: erik.bulow at rccvast.se (Erik Bulow)
Date: Tue, 8 Dec 2015 11:13:31 +0000
Subject: [R-pkg-devel] How to make S3-method for the "format" generic for
 class inheriting from "AsIs"
Message-ID: <D28C79EA.104FB%erik.bulow@rccvast.se>

Dear list!

I am one of two authors to the package "sweidnumbr"
(https://cran.r-project.org/web/packages/sweidnumbr/index.html). This
package introduce an S3-class called "pin" and methods etc for handling
personal identification numbers.

An object might look like:
x <- structure("1912121212", class = c("AsIs", "pin", "character"))

We want the "AsIs" class to allow for example recycling when the object is
put into a data.frame. Problem is that we would also like to have our own
format.pin-method. This is problematic since base::format.AsIs does not
use "NextMethod" (which all other xxx.AsIs methods do).

We can think of two possible solutions:

1. We can redefine the format-function to handle this but will then get a
check note for masking base::format.
2. We could skip the format.pin method and introduce a stand alone
function called "pin_format" or similair (but our method is very similair
to base::format.Date and we would like to benefit from that).

We can not skip the "AsIs" class inheritence. If we do, we need to rewrite
"data.frame" (which is a function and not an S3 generic in opposite to
as.data.frame for which we could just add as.data.frame.pin). If we do, we
still get the same check note as above but for masking base::data.frame
instead.

Is it possible to use both the benefits of the AsIs-class but to also
define our own format-method without masking anything from other packages?

Best regards
Erik B?low


From h.wickham at gmail.com  Tue Dec  8 14:09:51 2015
From: h.wickham at gmail.com (Hadley Wickham)
Date: Tue, 8 Dec 2015 07:09:51 -0600
Subject: [R-pkg-devel] How to make S3-method for the "format" generic
 for class inheriting from "AsIs"
In-Reply-To: <D28C79EA.104FB%erik.bulow@rccvast.se>
References: <D28C79EA.104FB%erik.bulow@rccvast.se>
Message-ID: <CABdHhvFQKx4Fq397JtkpwAu9bbvDhQH+Qe0O0GdvPg11hiQy_Q@mail.gmail.com>

Why not just make your own as.data.frame method? e.g.

as.data.frame.pin <- function(x, ...) {
  structure(
    list(x),
    class = "data.frame",
    row.names = .set_row_names(length(x))
  )
}

data.frame() calls as.data.frame() on all of its arguments.

Hadley

On Tue, Dec 8, 2015 at 5:13 AM, Erik Bulow <erik.bulow at rccvast.se> wrote:
> Dear list!
>
> I am one of two authors to the package "sweidnumbr"
> (https://cran.r-project.org/web/packages/sweidnumbr/index.html). This
> package introduce an S3-class called "pin" and methods etc for handling
> personal identification numbers.
>
> An object might look like:
> x <- structure("1912121212", class = c("AsIs", "pin", "character"))
>
> We want the "AsIs" class to allow for example recycling when the object is
> put into a data.frame. Problem is that we would also like to have our own
> format.pin-method. This is problematic since base::format.AsIs does not
> use "NextMethod" (which all other xxx.AsIs methods do).
>
> We can think of two possible solutions:
>
> 1. We can redefine the format-function to handle this but will then get a
> check note for masking base::format.
> 2. We could skip the format.pin method and introduce a stand alone
> function called "pin_format" or similair (but our method is very similair
> to base::format.Date and we would like to benefit from that).
>
> We can not skip the "AsIs" class inheritence. If we do, we need to rewrite
> "data.frame" (which is a function and not an S3 generic in opposite to
> as.data.frame for which we could just add as.data.frame.pin). If we do, we
> still get the same check note as above but for masking base::data.frame
> instead.
>
> Is it possible to use both the benefits of the AsIs-class but to also
> define our own format-method without masking anything from other packages?
>
> Best regards
> Erik B?low
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
http://had.co.nz/


From georgi.boshnakov at manchester.ac.uk  Tue Dec  8 15:37:45 2015
From: georgi.boshnakov at manchester.ac.uk (Georgi Boshnakov)
Date: Tue, 8 Dec 2015 14:37:45 +0000
Subject: [R-pkg-devel] compileAttributes() and 'using namespace' directives
Message-ID: <438D2EC9EAFE5946B2D5864670EA468E016D00F828@MBXP01.ds.man.ac.uk>

Hi,

With a collaborator we are working on a package which uses Rcpp and RcppArmadillo.   Our *.cpp files  start with something like

// [[Rcpp::depends(RcppArmadillo)]]

#include <iostream>
#include "RcppArmadillo.h"

using namespace arma;
using namespace std;
using namespace Rcpp;


Running compileAttributes()  generates an RcppExports.cpp which gives errors unless we manually  add 

using namespace arma;

when everything is fine. Is this outside the scope of the automatic facilities?  

compileAttributes()   puts the corresponding directive for the Rcpp namespace but even after reading every possible source I could not figure out how to make this happen for the "arma" namespace. 

The same problem appears when using devtools::test() which exits with an error if RcppExports.cpp is not generated by it but if I remove that file, my understanding is that devtools::test() calls compileAttributes()  with the effect of producing invalid file and with little indication for the users what has gone wrong, besides the message "Error: Command failed (1)".


Thanks,
Georgi

 
--
Dr Georgi Boshnakov               tel: (+44) (0)161 306 3684
School of Mathematics             fax: (+44) (0)161 306 3669
Alan Turing Building 1.125
The University of Manchester      email: Georgi.Boshnakov at manchester.ac.uk
Oxford Road
Manchester M13 9PL
UK



From erik.bulow at rccvast.se  Tue Dec  8 15:38:57 2015
From: erik.bulow at rccvast.se (Erik Bulow)
Date: Tue, 8 Dec 2015 14:38:57 +0000
Subject: [R-pkg-devel] How to make S3-method for the "format" generic
 for class inheriting from "AsIs"
In-Reply-To: <CABdHhvFQKx4Fq397JtkpwAu9bbvDhQH+Qe0O0GdvPg11hiQy_Q@mail.gmail.com>
References: <D28C79EA.104FB%erik.bulow@rccvast.se>
	<CABdHhvFQKx4Fq397JtkpwAu9bbvDhQH+Qe0O0GdvPg11hiQy_Q@mail.gmail.com>
Message-ID: <D28CA301.10524%erik.bulow@rccvast.se>

Thank you very much Hadley for your fast response!


I do however find the following lines (102-113) from "data.frame" a little
problematic here:

  [...]
  if (is.vector(xi1) || is.factor(xi1))
    xi[[j]] <- rep(xi1, length.out = nr)
  else if (is.character(xi1) && inherits(xi1, "AsIs"))
    xi[[j]] <- structure(rep(xi1, length.out = nr),
      class = class(xi1))
  else if (inherits(xi1, "Date") || inherits(xi1,
    "POSIXct")) 
    xi[[j]] <- rep(xi1, length.out = nr)
  else {
    fixed <- FALSE
    break
  }
  [...]


With the "as.data.frame.pin" as suggested, I will here get "fixed <-
FALSE" which will result in:

  > data.frame(1:2, structure("191212121212", class = c("pin",
"character")))
  Error in data.frame(1:2, structure("191212121212", class = c("pin",
"character"))) : 
  arguments imply differing number of rows: 2, 1



As a big fan of your work, I know your arguments against R?s recycling
rules (and I do agree) but I would like to allow recycling at least when
(as above) the length of my pin vector is only 1 (I do know of course that
dplyr::data_frame does just that :-).

Best Regards!
Erik B






On 2015-12-08 14:09, "Hadley Wickham" <h.wickham at gmail.com> wrote:

>Why not just make your own as.data.frame method? e.g.
>
>as.data.frame.pin <- function(x, ...) {
>  structure(
>    list(x),
>    class = "data.frame",
>    row.names = .set_row_names(length(x))
>  )
>}
>
>data.frame() calls as.data.frame() on all of its arguments.
>
>Hadley
>
>On Tue, Dec 8, 2015 at 5:13 AM, Erik Bulow <erik.bulow at rccvast.se> wrote:
>> Dear list!
>>
>> I am one of two authors to the package "sweidnumbr"
>> (https://cran.r-project.org/web/packages/sweidnumbr/index.html). This
>> package introduce an S3-class called "pin" and methods etc for handling
>> personal identification numbers.
>>
>> An object might look like:
>> x <- structure("1912121212", class = c("AsIs", "pin", "character"))
>>
>> We want the "AsIs" class to allow for example recycling when the object
>>is
>> put into a data.frame. Problem is that we would also like to have our
>>own
>> format.pin-method. This is problematic since base::format.AsIs does not
>> use "NextMethod" (which all other xxx.AsIs methods do).
>>
>> We can think of two possible solutions:
>>
>> 1. We can redefine the format-function to handle this but will then get
>>a
>> check note for masking base::format.
>> 2. We could skip the format.pin method and introduce a stand alone
>> function called "pin_format" or similair (but our method is very
>>similair
>> to base::format.Date and we would like to benefit from that).
>>
>> We can not skip the "AsIs" class inheritence. If we do, we need to
>>rewrite
>> "data.frame" (which is a function and not an S3 generic in opposite to
>> as.data.frame for which we could just add as.data.frame.pin). If we do,
>>we
>> still get the same check note as above but for masking base::data.frame
>> instead.
>>
>> Is it possible to use both the benefits of the AsIs-class but to also
>> define our own format-method without masking anything from other
>>packages?
>>
>> Best regards
>> Erik B?low
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>
>
>-- 
>http://had.co.nz/


From edd at debian.org  Tue Dec  8 15:56:08 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 8 Dec 2015 08:56:08 -0600
Subject: [R-pkg-devel] compileAttributes() and 'using namespace'
	directives
In-Reply-To: <438D2EC9EAFE5946B2D5864670EA468E016D00F828@MBXP01.ds.man.ac.uk>
References: <438D2EC9EAFE5946B2D5864670EA468E016D00F828@MBXP01.ds.man.ac.uk>
Message-ID: <22118.61320.122799.291257@max.nulle.part>


Georgi,

Wrong list?  Try rcpp-devel for Rcpp question.

On 8 December 2015 at 14:37, Georgi Boshnakov wrote:
| Hi,
| 
| With a collaborator we are working on a package which uses Rcpp and RcppArmadillo.   Our *.cpp files  start with something like
| 
| // [[Rcpp::depends(RcppArmadillo)]]

Use that when you use sourceCpp() on a file. In a package, use LinkingTo:.
See the vignette Rcpp Attributes in the Rcpp package.

| #include <iostream>
| #include "RcppArmadillo.h"
| 
| using namespace arma;
| using namespace std;
| using namespace Rcpp;

I much prefer explicit namespacing in my package code (as opposed to quick
one-offs). Then again this should not break things.
 
| Running compileAttributes()  generates an RcppExports.cpp which gives errors unless we manually  add 
| 
| using namespace arma;
| 
| when everything is fine. Is this outside the scope of the automatic facilities?  
| 
| compileAttributes()   puts the corresponding directive for the Rcpp namespace but even after reading every possible source I could not figure out how to make this happen for the "arma" namespace. 

There are over 170 packages on CRAN which use RcppArmadillo. When I am stuck
on problem I often find that compare with that something similar that works
is a good approach.
 
| The same problem appears when using devtools::test() which exits with an error if RcppExports.cpp is not generated by it but if I remove that file, my understanding is that devtools::test() calls compileAttributes()  with the effect of producing invalid file and with little indication for the users what has gone wrong, besides the message "Error: Command failed (1)".

The Rcpp documentation does neither mention nor recommend devtools, so I'd
first try without it. But seems like a side effect of the earlier issue.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From plummerm at iarc.fr  Tue Dec  8 16:14:50 2015
From: plummerm at iarc.fr (Martyn Plummer)
Date: Tue, 8 Dec 2015 15:14:50 +0000
Subject: [R-pkg-devel] C function dbinom_raw missing on
 r-oldrel-windows-ix86+x86_64
In-Reply-To: <b7bc4a470fa14dfd88afa240d80948be@its-mail-p03.registry.otago.ac.nz>
References: <b7bc4a470fa14dfd88afa240d80948be@its-mail-p03.registry.otago.ac.nz>
Message-ID: <1449587663.865.30.camel@iarc.fr>

On Tue, 2015-12-08 at 04:54 +0000, Murray Efford wrote:
> My recent revision of the package 'secr' has been accepted by CRAN, but I
> see from the Check Results that installation fails (see link below) on
> r-oldrel-windows-ix86+x86_64 (alone) because it cannot find dbinom_raw
> (which I now call directly). Is there an easy fix, and should I bother?
> 
> https://www.r-project.org/nosvn/R.check/r-oldrel-windows-ix86+x86_64/secr-00install.html

The function dbinom_raw first appeared in release 3.2.0, which is why it
does not work on the old release (oldrel=3.1.3 currently). 

You should make 3.2.0 the minimum version, i.e. in the DESCRIPTION file

Depends: R (>= 3.2.0), methods

Martyn
  
> Murray
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-----------------------------------------------------------------------
This message and its attachments are strictly confidenti...{{dropped:8}}


From edd at debian.org  Sat Dec 12 15:30:27 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 12 Dec 2015 08:30:27 -0600
Subject: [R-pkg-devel] Run-away R CMD check ?
Message-ID: <22124.12163.954994.566090@max.nulle.part>


For Rcpp and friends, I frequently run 'R CMD check' in "batch mode" over a
large set of packages.  That works fine, apart from taking long :)

I am using the exact same script (which is home-grown and could do with a
revision, but is public at [1] -- basically just a big loop over a set of
packages), and the exact same ~/.R/check.Renviron.

Yet on the (bigger, better, newerm ...) machine at work I have three packages
which get into a loop and never finish R CMD check.

Any idea why / how and what to do?  Besides skipping these three packages
which I'll do next?

The only commonality is that all three use testthat, but so do many other
packages that test fine.  

Dirk

[1] https://github.com/RcppCore/rcpp-logs/blob/master/scripts/runRcppDepends.r

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murdoch.duncan at gmail.com  Sat Dec 12 17:00:34 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 12 Dec 2015 11:00:34 -0500
Subject: [R-pkg-devel] Run-away R CMD check ?
In-Reply-To: <22124.12163.954994.566090@max.nulle.part>
References: <22124.12163.954994.566090@max.nulle.part>
Message-ID: <566C44A2.3080105@gmail.com>

On 12/12/2015 9:30 AM, Dirk Eddelbuettel wrote:
>
> For Rcpp and friends, I frequently run 'R CMD check' in "batch mode" over a
> large set of packages.  That works fine, apart from taking long :)
>
> I am using the exact same script (which is home-grown and could do with a
> revision, but is public at [1] -- basically just a big loop over a set of
> packages), and the exact same ~/.R/check.Renviron.
>
> Yet on the (bigger, better, newerm ...) machine at work I have three packages
> which get into a loop and never finish R CMD check.
>
> Any idea why / how and what to do?  Besides skipping these three packages
> which I'll do next?
>
> The only commonality is that all three use testthat, but so do many other
> packages that test fine.
>
> Dirk
>
> [1] https://github.com/RcppCore/rcpp-logs/blob/master/scripts/runRcppDepends.r
>

I'd put a time limit on the process so it fails eventually, and then see 
what the log shows just before the failure.  That is, I would if I could 
remember how to do that.

Duncan Murdoch


From edd at debian.org  Sat Dec 12 17:34:27 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 12 Dec 2015 10:34:27 -0600
Subject: [R-pkg-devel] Run-away R CMD check ?
In-Reply-To: <566C44A2.3080105@gmail.com>
References: <22124.12163.954994.566090@max.nulle.part>
	<566C44A2.3080105@gmail.com>
Message-ID: <22124.19603.607205.709393@max.nulle.part>


On 12 December 2015 at 11:00, Duncan Murdoch wrote:
| On 12/12/2015 9:30 AM, Dirk Eddelbuettel wrote:
| >
| > For Rcpp and friends, I frequently run 'R CMD check' in "batch mode" over a
| > large set of packages.  That works fine, apart from taking long :)
| >
| > I am using the exact same script (which is home-grown and could do with a
| > revision, but is public at [1] -- basically just a big loop over a set of
| > packages), and the exact same ~/.R/check.Renviron.
| >
| > Yet on the (bigger, better, newerm ...) machine at work I have three packages
| > which get into a loop and never finish R CMD check.
| >
| > Any idea why / how and what to do?  Besides skipping these three packages
| > which I'll do next?
| >
| > The only commonality is that all three use testthat, but so do many other
| > packages that test fine.
| >
| > Dirk
| >
| > [1] https://github.com/RcppCore/rcpp-logs/blob/master/scripts/runRcppDepends.r
| >
| 
| I'd put a time limit on the process so it fails eventually, and then see 
| what the log shows just before the failure.  That is, I would if I could 
| remember how to do that.

Yes. I thought about watcher processes too. But I haven't come up with
something simple enough to implement.

So for now I will just skip those three bad boys. Two of them, as I recall,
are merely unreasonable and finish after a while.  The other way ran all night.

I'd love to know how CRAN deals with that, or understand better why it
doesn't bite me on the server at home.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From pgilbert902 at gmail.com  Sat Dec 12 17:36:11 2015
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Sat, 12 Dec 2015 11:36:11 -0500
Subject: [R-pkg-devel] Run-away R CMD check ?
In-Reply-To: <566C44A2.3080105@gmail.com>
References: <22124.12163.954994.566090@max.nulle.part>
	<566C44A2.3080105@gmail.com>
Message-ID: <566C4CFB.8090201@gmail.com>



On 12/12/2015 11:00 AM, Duncan Murdoch wrote:
> On 12/12/2015 9:30 AM, Dirk Eddelbuettel wrote:
>>
>> For Rcpp and friends, I frequently run 'R CMD check' in "batch mode"
>> over a
>> large set of packages.  That works fine, apart from taking long :)
>>
>> I am using the exact same script (which is home-grown and could do with a
>> revision, but is public at [1] -- basically just a big loop over a set of
>> packages), and the exact same ~/.R/check.Renviron.
>>
>> Yet on the (bigger, better, newerm ...) machine at work I have three
>> packages
>> which get into a loop and never finish R CMD check.
>>
>> Any idea why / how and what to do?  Besides skipping these three packages
>> which I'll do next?

Two possibilities occur to me.
1/ Since I am just looking for a way to eliminate "No repository set..." 
and see you had the same concern once, if you actually solved that you 
may be getting into the "...cyclic dependency check" which notes in the 
code suggest may give an endless loop. I've skipped several details I 
don't understand.

2/ You can get a lock condition with make -j 2. For example, I have a 
test that can clobber a test db that another test is using, so I have to 
be carefully not to run these in parallel. This is easy to check, if you 
try without parallel make and don't have a problem then it is likely the 
issue.

Paul Gilbert

>>
>> The only commonality is that all three use testthat, but so do many other
>> packages that test fine.
>>
>> Dirk
>>
>> [1]
>> https://github.com/RcppCore/rcpp-logs/blob/master/scripts/runRcppDepends.r
>>
>>
>
> I'd put a time limit on the process so it fails eventually, and then see
> what the log shows just before the failure.  That is, I would if I could
> remember how to do that.
>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From edd at debian.org  Sat Dec 12 18:02:37 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 12 Dec 2015 11:02:37 -0600
Subject: [R-pkg-devel] Run-away R CMD check ?
In-Reply-To: <566C4CFB.8090201@gmail.com>
References: <22124.12163.954994.566090@max.nulle.part>
	<566C44A2.3080105@gmail.com> <566C4CFB.8090201@gmail.com>
Message-ID: <22124.21293.686065.799903@max.nulle.part>


On 12 December 2015 at 11:36, Paul Gilbert wrote:
| 
| 
| On 12/12/2015 11:00 AM, Duncan Murdoch wrote:
| > On 12/12/2015 9:30 AM, Dirk Eddelbuettel wrote:
| >>
| >> For Rcpp and friends, I frequently run 'R CMD check' in "batch mode"
| >> over a
| >> large set of packages.  That works fine, apart from taking long :)
| >>
| >> I am using the exact same script (which is home-grown and could do with a
| >> revision, but is public at [1] -- basically just a big loop over a set of
| >> packages), and the exact same ~/.R/check.Renviron.
| >>
| >> Yet on the (bigger, better, newerm ...) machine at work I have three
| >> packages
| >> which get into a loop and never finish R CMD check.
| >>
| >> Any idea why / how and what to do?  Besides skipping these three packages
| >> which I'll do next?
| 
| Two possibilities occur to me.
| 1/ Since I am just looking for a way to eliminate "No repository set..." 
| and see you had the same concern once, if you actually solved that you 
| may be getting into the "...cyclic dependency check" which notes in the 
| code suggest may give an endless loop. I've skipped several details I 
| don't understand.

No, it's not that. These build fine; they 'merely' go on too long when
running the tests.
 
| 2/ You can get a lock condition with make -j 2. For example, I have a 
| test that can clobber a test db that another test is using, so I have to 
| be carefully not to run these in parallel. This is easy to check, if you 
| try without parallel make and don't have a problem then it is likely the 
| issue.

That is a really good suggestion.  I have so little ram on the older server
here at home that don't usually set a parallel make.   At work I do, and that
may well be the difference.  Will test and report back.

Thanks!

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From ligges at statistik.tu-dortmund.de  Sat Dec 12 18:57:18 2015
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 12 Dec 2015 18:57:18 +0100
Subject: [R-pkg-devel] Run-away R CMD check ?
In-Reply-To: <22124.19603.607205.709393@max.nulle.part>
References: <22124.12163.954994.566090@max.nulle.part>
	<566C44A2.3080105@gmail.com> <22124.19603.607205.709393@max.nulle.part>
Message-ID: <566C5FFE.7010102@statistik.tu-dortmund.de>



On 12.12.2015 17:34, Dirk Eddelbuettel wrote:
>
> On 12 December 2015 at 11:00, Duncan Murdoch wrote:
> | On 12/12/2015 9:30 AM, Dirk Eddelbuettel wrote:
> | >
> | > For Rcpp and friends, I frequently run 'R CMD check' in "batch mode" over a
> | > large set of packages.  That works fine, apart from taking long :)
> | >
> | > I am using the exact same script (which is home-grown and could do with a
> | > revision, but is public at [1] -- basically just a big loop over a set of
> | > packages), and the exact same ~/.R/check.Renviron.
> | >
> | > Yet on the (bigger, better, newerm ...) machine at work I have three packages
> | > which get into a loop and never finish R CMD check.
> | >
> | > Any idea why / how and what to do?  Besides skipping these three packages
> | > which I'll do next?
> | >
> | > The only commonality is that all three use testthat, but so do many other
> | > packages that test fine.
> | >
> | > Dirk
> | >
> | > [1] https://github.com/RcppCore/rcpp-logs/blob/master/scripts/runRcppDepends.r
> | >
> |
> | I'd put a time limit on the process so it fails eventually, and then see
> | what the log shows just before the failure.  That is, I would if I could
> | remember how to do that.
>
> Yes. I thought about watcher processes too. But I haven't come up with
> something simple enough to implement.
>
> So for now I will just skip those three bad boys. Two of them, as I recall,
> are merely unreasonable and finish after a while.  The other way ran all night.
>
> I'd love to know how CRAN deals with that, or understand better why it
> doesn't bite me on the server at home.

CRAN has different approaches.

Under Windows, I typically have an R process that controls the check 
process and writes out the process id and timestamp and then starts R 
CMD check. Another watcher simply kills the process of a given process 
ID including all childs if they are beyond some timeout threshold.

Best,
Uwe


From edd at debian.org  Sat Dec 12 19:10:06 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 12 Dec 2015 12:10:06 -0600
Subject: [R-pkg-devel] Run-away R CMD check ?
In-Reply-To: <566C5FFE.7010102@statistik.tu-dortmund.de>
References: <22124.12163.954994.566090@max.nulle.part>
	<566C44A2.3080105@gmail.com>
	<22124.19603.607205.709393@max.nulle.part>
	<566C5FFE.7010102@statistik.tu-dortmund.de>
Message-ID: <22124.25342.988769.701768@max.nulle.part>


On 12 December 2015 at 18:57, Uwe Ligges wrote:
| CRAN has different approaches.
| 
| Under Windows, I typically have an R process that controls the check 
| process and writes out the process id and timestamp and then starts R 
| CMD check. Another watcher simply kills the process of a given process 
| ID including all childs if they are beyond some timeout threshold.

I was leaning towards something like that. We'll see what I end up doing...

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From A.J.Godfrey at massey.ac.nz  Sat Dec 12 21:52:29 2015
From: A.J.Godfrey at massey.ac.nz (Godfrey, Jonathan)
Date: Sat, 12 Dec 2015 20:52:29 +0000
Subject: [R-pkg-devel] saving user preferences per workspace
Message-ID: <D59DA89C3CD73C44A799E7087F8E6A9E1BDCF898@tur-exch-node1.massey.ac.nz>

Hello,

I wish to offer users of my BrailleR package the ability to save their preferences, which may change by the workspace.

I've toyed with the ideas:

1.        saving a file in the corresponding folder;  or,

2.       creating an object containing all the settings in the workspace


In either scenario, the settings get picked up next time the user loads the package in the right workspace. Both have worked.

My problem is that I think my functions to create or modify the file or object breach CRAN policies. I am certainly getting a NOTE for using assign(..., pos=1)

I had thought to try using the parent environment instead of explicitly using 'pos=1' but sometimes my functions are operating at the grandchild level with respect to pos=1 and therefore fail.

I think my previous solution of writing a file in the current folder was only getting past the CRAN checks because I was doing it with a condition of running R in interactive mode. if(interactive()){...}
But I think it is a breach of the policies to write a file to the user's hard drive, and sneaking around with a solution that CRAN checks can't cope with (yet) really doesn't work for me.

Any ideas, especially pointers to other packages that do manage this task would help me greatly.

Thanks for any help/advice,
Jonathan



	[[alternative HTML version deleted]]


From retep.meissner at gmail.com  Sun Dec 13 09:34:59 2015
From: retep.meissner at gmail.com (Peter Meissner)
Date: Sun, 13 Dec 2015 09:34:59 +0100
Subject: [R-pkg-devel] saving user preferences per workspace
In-Reply-To: <D59DA89C3CD73C44A799E7087F8E6A9E1BDCF898@tur-exch-node1.massey.ac.nz>
References: <D59DA89C3CD73C44A799E7087F8E6A9E1BDCF898@tur-exch-node1.massey.ac.nz>
Message-ID: <CAB-BFRommacz0Hz9gR4N4JXRjda1_36pnk-LQiWYFRoa7iJw9w@mail.gmail.com>

Hey,

as far as I understand it, it is not ok to do any writing to the filesystem
(except tempfiles) behind the back of the user - never ever (except on
installation).

But what you can do is implement explicit functions to explicitly save and
load options.

Furthermore, you can tell the user, that the load function will always look
for:

1. brailer_options_file.opt in the current working directory
2. for an brailer_options_file entry in the .Renviron file to determine if
there might be a file to load options from (e.g. brailer_options_file
entry=~/brailer_options_file.opt)
3. else the function does not laod any options

Depending on what is appropriate for your package you might than run the
options load function on package startup via putting an .onLoad function
into your R/zzz.R file.

I am not sure if that's the most elegant or efficient way to implement such
a thing but it served me well for the wikipediatrend package where I needed
a way for caching downloads and I am convinced that it is CRAN policies
compliant.

If there are better ideas or room for discussion I am eager to here it.


Best, Peter

2015-12-12 21:52 GMT+01:00 Godfrey, Jonathan <A.J.Godfrey at massey.ac.nz>:

> Hello,
>
> I wish to offer users of my BrailleR package the ability to save their
> preferences, which may change by the workspace.
>
> I've toyed with the ideas:
>
> 1.        saving a file in the corresponding folder;  or,
>
> 2.       creating an object containing all the settings in the workspace
>
>
> In either scenario, the settings get picked up next time the user loads
> the package in the right workspace. Both have worked.
>
> My problem is that I think my functions to create or modify the file or
> object breach CRAN policies. I am certainly getting a NOTE for using
> assign(..., pos=1)
>
> I had thought to try using the parent environment instead of explicitly
> using 'pos=1' but sometimes my functions are operating at the grandchild
> level with respect to pos=1 and therefore fail.
>
> I think my previous solution of writing a file in the current folder was
> only getting past the CRAN checks because I was doing it with a condition
> of running R in interactive mode. if(interactive()){...}
> But I think it is a breach of the policies to write a file to the user's
> hard drive, and sneaking around with a solution that CRAN checks can't cope
> with (yet) really doesn't work for me.
>
> Any ideas, especially pointers to other packages that do manage this task
> would help me greatly.
>
> Thanks for any help/advice,
> Jonathan
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd at debian.org  Sun Dec 13 17:20:13 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 13 Dec 2015 10:20:13 -0600
Subject: [R-pkg-devel] Run-away R CMD check ?
In-Reply-To: <22124.25342.988769.701768@max.nulle.part>
References: <22124.12163.954994.566090@max.nulle.part>
	<566C44A2.3080105@gmail.com>
	<22124.19603.607205.709393@max.nulle.part>
	<566C5FFE.7010102@statistik.tu-dortmund.de>
	<22124.25342.988769.701768@max.nulle.part>
Message-ID: <22125.39613.882352.891889@max.nulle.part>


On 12 December 2015 at 12:10, Dirk Eddelbuettel wrote:
| 
| On 12 December 2015 at 18:57, Uwe Ligges wrote:
| | CRAN has different approaches.
| | 
| | Under Windows, I typically have an R process that controls the check 
| | process and writes out the process id and timestamp and then starts R 
| | CMD check. Another watcher simply kills the process of a given process 
| | ID including all childs if they are beyond some timeout threshold.
| 
| I was leaning towards something like that. We'll see what I end up doing...

I am also going to keep closer tabs on how long each test takes -- some
packages are clearly more expensive than others.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From csardi.gabor at gmail.com  Mon Dec 14 00:31:45 2015
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Sun, 13 Dec 2015 23:31:45 +0000
Subject: [R-pkg-devel] saving user preferences per workspace
In-Reply-To: <CAB-BFRommacz0Hz9gR4N4JXRjda1_36pnk-LQiWYFRoa7iJw9w@mail.gmail.com>
References: <D59DA89C3CD73C44A799E7087F8E6A9E1BDCF898@tur-exch-node1.massey.ac.nz>
	<CAB-BFRommacz0Hz9gR4N4JXRjda1_36pnk-LQiWYFRoa7iJw9w@mail.gmail.com>
Message-ID: <CABtg=Kk-JfqPWubievAYhq8+Lto1weZQP43DMeL1u36FSqm-KQ@mail.gmail.com>

Maybe you'll also find the 'rappdirs' package useful.

Gabor

On Sun, Dec 13, 2015 at 8:34 AM, Peter Meissner
<retep.meissner at gmail.com> wrote:
> Hey,
>
> as far as I understand it, it is not ok to do any writing to the filesystem
> (except tempfiles) behind the back of the user - never ever (except on
> installation).
>
> But what you can do is implement explicit functions to explicitly save and
> load options.
>
> Furthermore, you can tell the user, that the load function will always look
> for:
>
> 1. brailer_options_file.opt in the current working directory
> 2. for an brailer_options_file entry in the .Renviron file to determine if
> there might be a file to load options from (e.g. brailer_options_file
> entry=~/brailer_options_file.opt)
> 3. else the function does not laod any options
>
> Depending on what is appropriate for your package you might than run the
> options load function on package startup via putting an .onLoad function
> into your R/zzz.R file.
>
> I am not sure if that's the most elegant or efficient way to implement such
> a thing but it served me well for the wikipediatrend package where I needed
> a way for caching downloads and I am convinced that it is CRAN policies
> compliant.
>
> If there are better ideas or room for discussion I am eager to here it.
>
>
> Best, Peter
>
> 2015-12-12 21:52 GMT+01:00 Godfrey, Jonathan <A.J.Godfrey at massey.ac.nz>:
>
>> Hello,
>>
>> I wish to offer users of my BrailleR package the ability to save their
>> preferences, which may change by the workspace.
>>
>> I've toyed with the ideas:
>>
>> 1.        saving a file in the corresponding folder;  or,
>>
>> 2.       creating an object containing all the settings in the workspace
>>
>>
>> In either scenario, the settings get picked up next time the user loads
>> the package in the right workspace. Both have worked.
>>
>> My problem is that I think my functions to create or modify the file or
>> object breach CRAN policies. I am certainly getting a NOTE for using
>> assign(..., pos=1)
>>
>> I had thought to try using the parent environment instead of explicitly
>> using 'pos=1' but sometimes my functions are operating at the grandchild
>> level with respect to pos=1 and therefore fail.
>>
>> I think my previous solution of writing a file in the current folder was
>> only getting past the CRAN checks because I was doing it with a condition
>> of running R in interactive mode. if(interactive()){...}
>> But I think it is a breach of the policies to write a file to the user's
>> hard drive, and sneaking around with a solution that CRAN checks can't cope
>> with (yet) really doesn't work for me.
>>
>> Any ideas, especially pointers to other packages that do manage this task
>> would help me greatly.
>>
>> Thanks for any help/advice,
>> Jonathan
>>
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From pgilbert902 at gmail.com  Tue Dec 15 01:46:14 2015
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Mon, 14 Dec 2015 19:46:14 -0500
Subject: [R-pkg-devel] --as-cran URL check
Message-ID: <566F62D6.5070407@gmail.com>


I am having some trouble with a NOTE produced by an R-devel check of URL 
references. The reference was

  \url{http://som.eldoc.ub.rug.nl/reports/themeF/2005/05F10/}

which the --as-cran check finds has moved and notifies about the 
redirected address

 
http://www.rug.nl/research/portal/publications/pub(d7d4ea3d-af1d-487a-b9b6-c0816994ef5a).html

My browser finds this, and does not distinguish it from

 
http://www.rug.nl/research/portal/publications/pub%28d7d4ea3d-af1d-487a-b9b6-c0816994ef5a%29.html

However, I cannot get either of these forms of the new address to work 
in the man page and/or CITATION file  \url{}. The first gives

Found the following (possibly) invalid URLs:
   URL: 
http://www.rug.nl/research/portal/publications/pub(d7d4ea3d-af1d-487a-b9b6-c0816994ef5a).html
     From: man/estFAmodel.Rd
           man/estTSFmodel.Rd
           man/tsfa-package.Rd
           inst/CITATION
     Status: 500
     Message: Internal Server Error

even though I can cut and paste that address from the error message into 
my browser and it works fine. The second form results in a problem 
parsing the Rd file, the end of the section is not recognized and for 
the next section I get "unexpected section header '\examples'". I think 
the percent signs cause the end of the line with the closing } to be 
treated as a comment, but if I put the } on a new line the status 500 
occurs. With the percent signs escaped in the second form I get the 
status 500 error message as in the first form.

Is this a bug in the R-devel --as-cran URL check, or does anyone see 
something I am missing?

Thanks,
Paul Gilbert


From edd at debian.org  Tue Dec 15 02:35:03 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 14 Dec 2015 19:35:03 -0600
Subject: [R-pkg-devel] --as-cran URL check
In-Reply-To: <566F62D6.5070407@gmail.com>
References: <566F62D6.5070407@gmail.com>
Message-ID: <22127.28231.762452.299968@max.nulle.part>


On 14 December 2015 at 19:46, Paul Gilbert wrote:
| I am having some trouble with a NOTE produced by an R-devel check of URL 
| references. The reference was
| 
|   \url{http://som.eldoc.ub.rug.nl/reports/themeF/2005/05F10/}
| 
| which the --as-cran check finds has moved and notifies about the 
| redirected address
| 
|  
| http://www.rug.nl/research/portal/publications/pub(d7d4ea3d-af1d-487a-b9b6-c0816994ef5a).html
| 
| My browser finds this, and does not distinguish it from
| 
|  
| http://www.rug.nl/research/portal/publications/pub%28d7d4ea3d-af1d-487a-b9b6-c0816994ef5a%29.html
| 
| However, I cannot get either of these forms of the new address to work 
| in the man page and/or CITATION file  \url{}. The first gives
| 
| Found the following (possibly) invalid URLs:
|    URL: 
| http://www.rug.nl/research/portal/publications/pub(d7d4ea3d-af1d-487a-b9b6-c0816994ef5a).html
|      From: man/estFAmodel.Rd
|            man/estTSFmodel.Rd
|            man/tsfa-package.Rd
|            inst/CITATION
|      Status: 500
|      Message: Internal Server Error
| 
| even though I can cut and paste that address from the error message into 
| my browser and it works fine. The second form results in a problem 
| parsing the Rd file, the end of the section is not recognized and for 
| the next section I get "unexpected section header '\examples'". I think 
| the percent signs cause the end of the line with the closing } to be 
| treated as a comment, but if I put the } on a new line the status 500 
| occurs. With the percent signs escaped in the second form I get the 
| status 500 error message as in the first form.
| 
| Is this a bug in the R-devel --as-cran URL check, or does anyone see 
| something I am missing?

For that reason, I (and some other folks that I talked to) ended up removing
URLs creating such reports from documentation.  The webchecker used by CRAN
in Vienna appears to be broken. It *should* follow redirect, yet it does not.

And if you can't beat'em ... you end up avoiding'em.  

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From wdunlap at tibco.com  Tue Dec 15 03:10:49 2015
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 14 Dec 2015 18:10:49 -0800
Subject: [R-pkg-devel] --as-cran URL check
In-Reply-To: <566F62D6.5070407@gmail.com>
References: <566F62D6.5070407@gmail.com>
Message-ID: <CAF8bMcbFnht3w4HOCEK_-KCehnY5KXQqDRaQSTn4MUgmes8htQ@mail.gmail.com>

Put backslashes in front of the percent signs in the Rd file's URL:
  \url{http://www.rug.nl/research/portal/publications/pub\%28d7d4ea3d-af1d-487a-b9b6-c0816994ef5a\%29.html}
Bill Dunlap
TIBCO Software
wdunlap tibco.com


On Mon, Dec 14, 2015 at 4:46 PM, Paul Gilbert <pgilbert902 at gmail.com> wrote:
>
> I am having some trouble with a NOTE produced by an R-devel check of URL
> references. The reference was
>
>  \url{http://som.eldoc.ub.rug.nl/reports/themeF/2005/05F10/}
>
> which the --as-cran check finds has moved and notifies about the redirected
> address
>
>
> http://www.rug.nl/research/portal/publications/pub(d7d4ea3d-af1d-487a-b9b6-c0816994ef5a).html
>
> My browser finds this, and does not distinguish it from
>
>
> http://www.rug.nl/research/portal/publications/pub%28d7d4ea3d-af1d-487a-b9b6-c0816994ef5a%29.html
>
> However, I cannot get either of these forms of the new address to work in
> the man page and/or CITATION file  \url{}. The first gives
>
> Found the following (possibly) invalid URLs:
>   URL:
> http://www.rug.nl/research/portal/publications/pub(d7d4ea3d-af1d-487a-b9b6-c0816994ef5a).html
>     From: man/estFAmodel.Rd
>           man/estTSFmodel.Rd
>           man/tsfa-package.Rd
>           inst/CITATION
>     Status: 500
>     Message: Internal Server Error
>
> even though I can cut and paste that address from the error message into my
> browser and it works fine. The second form results in a problem parsing the
> Rd file, the end of the section is not recognized and for the next section I
> get "unexpected section header '\examples'". I think the percent signs cause
> the end of the line with the closing } to be treated as a comment, but if I
> put the } on a new line the status 500 occurs. With the percent signs
> escaped in the second form I get the status 500 error message as in the
> first form.
>
> Is this a bug in the R-devel --as-cran URL check, or does anyone see
> something I am missing?
>
> Thanks,
> Paul Gilbert
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From pgilbert902 at gmail.com  Tue Dec 15 03:15:58 2015
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Mon, 14 Dec 2015 21:15:58 -0500
Subject: [R-pkg-devel] --as-cran URL check
In-Reply-To: <CAF8bMcbFnht3w4HOCEK_-KCehnY5KXQqDRaQSTn4MUgmes8htQ@mail.gmail.com>
References: <566F62D6.5070407@gmail.com>
	<CAF8bMcbFnht3w4HOCEK_-KCehnY5KXQqDRaQSTn4MUgmes8htQ@mail.gmail.com>
Message-ID: <566F77DE.7030508@gmail.com>

No, that what I meant by "percent signs escaped". It just gets me back 
to the status 500 error. I think Dirk may be correct that it is a bug in 
the --as-can URL check.

Paul

On 12/14/2015 09:10 PM, William Dunlap wrote:
> Put backslashes in front of the percent signs in the Rd file's URL:
>    \url{http://www.rug.nl/research/portal/publications/pub\%28d7d4ea3d-af1d-487a-b9b6-c0816994ef5a\%29.html}
> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com
>
>
> On Mon, Dec 14, 2015 at 4:46 PM, Paul Gilbert <pgilbert902 at gmail.com> wrote:
>>
>> I am having some trouble with a NOTE produced by an R-devel check of URL
>> references. The reference was
>>
>>   \url{http://som.eldoc.ub.rug.nl/reports/themeF/2005/05F10/}
>>
>> which the --as-cran check finds has moved and notifies about the redirected
>> address
>>
>>
>> http://www.rug.nl/research/portal/publications/pub(d7d4ea3d-af1d-487a-b9b6-c0816994ef5a).html
>>
>> My browser finds this, and does not distinguish it from
>>
>>
>> http://www.rug.nl/research/portal/publications/pub%28d7d4ea3d-af1d-487a-b9b6-c0816994ef5a%29.html
>>
>> However, I cannot get either of these forms of the new address to work in
>> the man page and/or CITATION file  \url{}. The first gives
>>
>> Found the following (possibly) invalid URLs:
>>    URL:
>> http://www.rug.nl/research/portal/publications/pub(d7d4ea3d-af1d-487a-b9b6-c0816994ef5a).html
>>      From: man/estFAmodel.Rd
>>            man/estTSFmodel.Rd
>>            man/tsfa-package.Rd
>>            inst/CITATION
>>      Status: 500
>>      Message: Internal Server Error
>>
>> even though I can cut and paste that address from the error message into my
>> browser and it works fine. The second form results in a problem parsing the
>> Rd file, the end of the section is not recognized and for the next section I
>> get "unexpected section header '\examples'". I think the percent signs cause
>> the end of the line with the closing } to be treated as a comment, but if I
>> put the } on a new line the status 500 occurs. With the percent signs
>> escaped in the second form I get the status 500 error message as in the
>> first form.
>>
>> Is this a bug in the R-devel --as-cran URL check, or does anyone see
>> something I am missing?
>>
>> Thanks,
>> Paul Gilbert
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From wdunlap at tibco.com  Tue Dec 15 03:22:51 2015
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 14 Dec 2015 18:22:51 -0800
Subject: [R-pkg-devel] --as-cran URL check
In-Reply-To: <566F77DE.7030508@gmail.com>
References: <566F62D6.5070407@gmail.com>
	<CAF8bMcbFnht3w4HOCEK_-KCehnY5KXQqDRaQSTn4MUgmes8htQ@mail.gmail.com>
	<566F77DE.7030508@gmail.com>
Message-ID: <CAF8bMcagC1c5w0fvuaBphZcOAWh0O8-eJ47UHTweSpKKTZ-Suw@mail.gmail.com>

I'm sorry, I hadn't noticed that the URL checks were not done because
of the note
   Checking URLs requires 'libcurl' support in the R build
Bill Dunlap
TIBCO Software
wdunlap tibco.com


On Mon, Dec 14, 2015 at 6:15 PM, Paul Gilbert <pgilbert902 at gmail.com> wrote:
> No, that what I meant by "percent signs escaped". It just gets me back to
> the status 500 error. I think Dirk may be correct that it is a bug in the
> --as-can URL check.
>
> Paul
>
>
> On 12/14/2015 09:10 PM, William Dunlap wrote:
>>
>> Put backslashes in front of the percent signs in the Rd file's URL:
>>
>> \url{http://www.rug.nl/research/portal/publications/pub\%28d7d4ea3d-af1d-487a-b9b6-c0816994ef5a\%29.html}
>> Bill Dunlap
>> TIBCO Software
>> wdunlap tibco.com
>>
>>
>> On Mon, Dec 14, 2015 at 4:46 PM, Paul Gilbert <pgilbert902 at gmail.com>
>> wrote:
>>>
>>>
>>> I am having some trouble with a NOTE produced by an R-devel check of URL
>>> references. The reference was
>>>
>>>   \url{http://som.eldoc.ub.rug.nl/reports/themeF/2005/05F10/}
>>>
>>> which the --as-cran check finds has moved and notifies about the
>>> redirected
>>> address
>>>
>>>
>>>
>>> http://www.rug.nl/research/portal/publications/pub(d7d4ea3d-af1d-487a-b9b6-c0816994ef5a).html
>>>
>>> My browser finds this, and does not distinguish it from
>>>
>>>
>>>
>>> http://www.rug.nl/research/portal/publications/pub%28d7d4ea3d-af1d-487a-b9b6-c0816994ef5a%29.html
>>>
>>> However, I cannot get either of these forms of the new address to work in
>>> the man page and/or CITATION file  \url{}. The first gives
>>>
>>> Found the following (possibly) invalid URLs:
>>>    URL:
>>>
>>> http://www.rug.nl/research/portal/publications/pub(d7d4ea3d-af1d-487a-b9b6-c0816994ef5a).html
>>>      From: man/estFAmodel.Rd
>>>            man/estTSFmodel.Rd
>>>            man/tsfa-package.Rd
>>>            inst/CITATION
>>>      Status: 500
>>>      Message: Internal Server Error
>>>
>>> even though I can cut and paste that address from the error message into
>>> my
>>> browser and it works fine. The second form results in a problem parsing
>>> the
>>> Rd file, the end of the section is not recognized and for the next
>>> section I
>>> get "unexpected section header '\examples'". I think the percent signs
>>> cause
>>> the end of the line with the closing } to be treated as a comment, but if
>>> I
>>> put the } on a new line the status 500 occurs. With the percent signs
>>> escaped in the second form I get the status 500 error message as in the
>>> first form.
>>>
>>> Is this a bug in the R-devel --as-cran URL check, or does anyone see
>>> something I am missing?
>>>
>>> Thanks,
>>> Paul Gilbert
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From edd at debian.org  Fri Dec 18 14:14:52 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 18 Dec 2015 07:14:52 -0600
Subject: [R-pkg-devel] --as-cran URL check
In-Reply-To: <CAF8bMcagC1c5w0fvuaBphZcOAWh0O8-eJ47UHTweSpKKTZ-Suw@mail.gmail.com>
References: <566F62D6.5070407@gmail.com>
	<CAF8bMcbFnht3w4HOCEK_-KCehnY5KXQqDRaQSTn4MUgmes8htQ@mail.gmail.com>
	<566F77DE.7030508@gmail.com>
	<CAF8bMcagC1c5w0fvuaBphZcOAWh0O8-eJ47UHTweSpKKTZ-Suw@mail.gmail.com>
Message-ID: <22132.1740.381192.824018@max.nulle.part>


Kurt,

I am emailing you directly in extension of a thread from r-package-devel for
which you can see the full (short, five posts) history at
  http://thread.gmane.org/gmane.comp.lang.r.packages.devel/581

Not long ago I had the idea of defining macros for GitHub pull requests and
issue tickets.  This is now used in half a dozen packages.  So eg for the
Rblpapi package I use

  \newcommand{\ghpr}{\href{https://github.com/Rblp/Rblpapi/pull/#1}{##1}}
  \newcommand{\ghit}{\href{https://github.com/Rblp/Rblpapi/issues/#1}{##1}}

and that is working just fine from CRAN as per

  https://cran.r-project.org/web/packages/Rblpapi/news.html

and all those links resolve.  Yet as of this morning all these links get me 

 URL: https://github.com/Rblp/Rblpapi/issues/68
    From: inst/NEWS.Rd
    Status: 400
    Message: Bad Request

whereas the link _of course_ resolves fine in the browser.

Is there a way to make the warning go away but let link survive?

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd at debian.org  Sat Dec 19 05:27:07 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 18 Dec 2015 22:27:07 -0600
Subject: [R-pkg-devel] --as-cran URL check
In-Reply-To: <22132.1740.381192.824018@max.nulle.part>
References: <566F62D6.5070407@gmail.com>
	<CAF8bMcbFnht3w4HOCEK_-KCehnY5KXQqDRaQSTn4MUgmes8htQ@mail.gmail.com>
	<566F77DE.7030508@gmail.com>
	<CAF8bMcagC1c5w0fvuaBphZcOAWh0O8-eJ47UHTweSpKKTZ-Suw@mail.gmail.com>
	<22132.1740.381192.824018@max.nulle.part>
Message-ID: <22132.56475.965445.193309@max.nulle.part>


On 18 December 2015 at 07:14, Dirk Eddelbuettel wrote:
| 
| Kurt,
| 
| I am emailing you directly in extension of a thread from r-package-devel for
| which you can see the full (short, five posts) history at
|   http://thread.gmane.org/gmane.comp.lang.r.packages.devel/581
| 
| Not long ago I had the idea of defining macros for GitHub pull requests and
| issue tickets.  This is now used in half a dozen packages.  So eg for the
| Rblpapi package I use
| 
|   \newcommand{\ghpr}{\href{https://github.com/Rblp/Rblpapi/pull/#1}{##1}}
|   \newcommand{\ghit}{\href{https://github.com/Rblp/Rblpapi/issues/#1}{##1}}
| 
| and that is working just fine from CRAN as per
| 
|   https://cran.r-project.org/web/packages/Rblpapi/news.html
| 
| and all those links resolve.  Yet as of this morning all these links get me 
| 
|  URL: https://github.com/Rblp/Rblpapi/issues/68
|     From: inst/NEWS.Rd
|     Status: 400
|     Message: Bad Request
| 
| whereas the link _of course_ resolves fine in the browser.
| 
| Is there a way to make the warning go away but let link survive?

Looks like it tricked me -- apparent issue at the GitHub side. These tests
now pass again.

I think I had fallen once before for this, and may well again another time.

Dirk
 
| Dirk
| 
| -- 
| http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
| 
| ______________________________________________
| R-package-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From henrik.bengtsson at gmail.com  Sat Dec 19 17:22:01 2015
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Sat, 19 Dec 2015 08:22:01 -0800
Subject: [R-pkg-devel] saving user preferences per workspace
In-Reply-To: <CAB-BFRommacz0Hz9gR4N4JXRjda1_36pnk-LQiWYFRoa7iJw9w@mail.gmail.com>
References: <D59DA89C3CD73C44A799E7087F8E6A9E1BDCF898@tur-exch-node1.massey.ac.nz>
	<CAB-BFRommacz0Hz9gR4N4JXRjda1_36pnk-LQiWYFRoa7iJw9w@mail.gmail.com>
Message-ID: <CAFDcVCTxe0JNnBhajA9e8d5yTWP77cTkb=RM_t5fm2fc3yLgZA@mail.gmail.com>

The CRAN Policies [https://cran.r-project.org/web/packages/policies.html] say:

"- Packages should not write in the users? home filespace, nor
anywhere else on the file system apart from the R session?s temporary
directory (or during installation in the location pointed to by
TMPDIR: and such usage should be cleaned up). Installing into the
system?s R installation (e.g., scripts to its bin directory) is not
allowed.

Limited exceptions may be allowed in interactive sessions if the
package obtains confirmation from the user."

CRAN package R.cache saves to file after getting user's approval.
First time the package is loaded it asks the user for permission to
create "root" directory to store cached data.   If the directory
already exists, then it won't ask (again).  If it does not exist and
user disapproves to create it or R is running in an interactive, then
it falls back to using a temporary directory (which is still useful
for caching/memoization).

/Henrik
(author of R.cache)

On Sun, Dec 13, 2015 at 12:34 AM, Peter Meissner
<retep.meissner at gmail.com> wrote:
> Hey,
>
> as far as I understand it, it is not ok to do any writing to the filesystem
> (except tempfiles) behind the back of the user - never ever (except on
> installation).
>
> But what you can do is implement explicit functions to explicitly save and
> load options.
>
> Furthermore, you can tell the user, that the load function will always look
> for:
>
> 1. brailer_options_file.opt in the current working directory
> 2. for an brailer_options_file entry in the .Renviron file to determine if
> there might be a file to load options from (e.g. brailer_options_file
> entry=~/brailer_options_file.opt)
> 3. else the function does not laod any options
>
> Depending on what is appropriate for your package you might than run the
> options load function on package startup via putting an .onLoad function
> into your R/zzz.R file.
>
> I am not sure if that's the most elegant or efficient way to implement such
> a thing but it served me well for the wikipediatrend package where I needed
> a way for caching downloads and I am convinced that it is CRAN policies
> compliant.
>
> If there are better ideas or room for discussion I am eager to here it.
>
>
> Best, Peter
>
> 2015-12-12 21:52 GMT+01:00 Godfrey, Jonathan <A.J.Godfrey at massey.ac.nz>:
>
>> Hello,
>>
>> I wish to offer users of my BrailleR package the ability to save their
>> preferences, which may change by the workspace.
>>
>> I've toyed with the ideas:
>>
>> 1.        saving a file in the corresponding folder;  or,
>>
>> 2.       creating an object containing all the settings in the workspace
>>
>>
>> In either scenario, the settings get picked up next time the user loads
>> the package in the right workspace. Both have worked.
>>
>> My problem is that I think my functions to create or modify the file or
>> object breach CRAN policies. I am certainly getting a NOTE for using
>> assign(..., pos=1)
>>
>> I had thought to try using the parent environment instead of explicitly
>> using 'pos=1' but sometimes my functions are operating at the grandchild
>> level with respect to pos=1 and therefore fail.
>>
>> I think my previous solution of writing a file in the current folder was
>> only getting past the CRAN checks because I was doing it with a condition
>> of running R in interactive mode. if(interactive()){...}
>> But I think it is a breach of the policies to write a file to the user's
>> hard drive, and sneaking around with a solution that CRAN checks can't cope
>> with (yet) really doesn't work for me.
>>
>> Any ideas, especially pointers to other packages that do manage this task
>> would help me greatly.
>>
>> Thanks for any help/advice,
>> Jonathan
>>
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From glennmschultz at me.com  Sun Dec 20 19:02:26 2015
From: glennmschultz at me.com (Glenn Schultz)
Date: Sun, 20 Dec 2015 18:02:26 +0000 (GMT)
Subject: [R-pkg-devel] RCMD Note - why did I have to do this?
Message-ID: <399108e4-a352-4812-a27f-7ff67629b0d1@me.com>

Hello all,

I need some help understanding namespace and methods.

I received a note from RCMD imports methods fields...

I changed my file from
#' @import methods
NULL
?to include the following:

#' @imports methods::fields
NULL

such that it now reads

#' @import methods
NULL

#' @imports methods::fields
NULL

This removed the note - I am not just sure why I had to do this - I use devtools and Roxygen ?

Thanks,
Glenn

From h.wickham at gmail.com  Sun Dec 20 20:37:27 2015
From: h.wickham at gmail.com (Hadley Wickham)
Date: Sun, 20 Dec 2015 13:37:27 -0600
Subject: [R-pkg-devel] RCMD Note - why did I have to do this?
In-Reply-To: <399108e4-a352-4812-a27f-7ff67629b0d1@me.com>
References: <399108e4-a352-4812-a27f-7ff67629b0d1@me.com>
Message-ID: <CABdHhvF17Z6NV-iP47jKFuTYBR1dSZBdXfQ82eFJO+rEeQ9usA@mail.gmail.com>

You didn't include the NOTE you saw, and this isn't valid roxygen:

#' @imports methods::fields

So it's a bit hard to tell what the problem is.

Hadley


On Sun, Dec 20, 2015 at 12:02 PM, Glenn Schultz <glennmschultz at me.com> wrote:
> Hello all,
>
> I need some help understanding namespace and methods.
>
> I received a note from RCMD imports methods fields...
>
> I changed my file from
> #' @import methods
> NULL
>  to include the following:
>
> #' @imports methods::fields
> NULL
>
> such that it now reads
>
> #' @import methods
> NULL
>
> #' @imports methods::fields
> NULL
>
> This removed the note - I am not just sure why I had to do this - I use
> devtools and Roxygen
>
> Thanks,
> Glenn
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
http://had.co.nz/


From glennmschultz at me.com  Sun Dec 20 21:04:03 2015
From: glennmschultz at me.com (Glenn Schultz)
Date: Sun, 20 Dec 2015 20:04:03 +0000 (GMT)
Subject: [R-pkg-devel] RCMD Note - why did I have to do this?
Message-ID: <289db98b-8227-41f5-a53d-8177306c01a1@me.com>

Hi Hadley,

You are correct -?
#' @import method
NULL

removes the Note - This is a mental semantic error on my part. ?Whenever I think import my brain says this "imports foo" and I type #' @imports foo.

Thanks for you time and sorry about the confusion on my part
Glenn

On Dec 20, 2015, at 01:37 PM, Hadley Wickham <h.wickham at gmail.com> wrote:

You didn't include the NOTE you saw, and this isn't valid roxygen:

#' @imports methods::fields

So it's a bit hard to tell what the problem is.

Hadley


On Sun, Dec 20, 2015 at 12:02 PM, Glenn Schultz <glennmschultz at me.com> wrote:
Hello all,

I need some help understanding namespace and methods.

I received a note from RCMD imports methods fields...

I changed my file from
#' @import methods
NULL
to include the following:

#' @imports methods::fields
NULL

such that it now reads

#' @import methods
NULL

#' @imports methods::fields
NULL

This removed the note - I am not just sure why I had to do this - I use
devtools and Roxygen

Thanks,
Glenn
______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
http://had.co.nz/

From patrick.giraudoux at univ-fcomte.fr  Tue Dec 22 11:34:20 2015
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Tue, 22 Dec 2015 11:34:20 +0100
Subject: [R-pkg-devel] Namespace: summary of all undefined globals
In-Reply-To: <mailman.13.1450609204.10851.r-devel@r-project.org>
References: <mailman.13.1450609204.10851.r-devel@r-project.org>
Message-ID: <5679272C.3060405@univ-fcomte.fr>

Dear listers,

Kurt (subject "CRAN packages maintained by you" sent on 02/07/2015) was 
mentionning to package maintainers that "with current versions of 
r-devel, one can get a convenient summary of all undefined globals" and 
describing how to get a summary conveniently.

Now I am using R 3.2.3 but cannot get this by using rcmd check --as-cran 
mypackage, the "traditionnal" namespace with obviously incomplete 
declaration going through the check 'checking R code for possible 
problems' with no note.

Can you confirm that the implementation of R-devel in July, is still NOT 
in R 3.2.3 and that one should still use the current version of r-devel 
to get a summary of undefined globals (through notes after 'checking R 
code for possible problems) ? Is there a way to get it from R 3.2.3 ?

Thanks in advance,

Patrick


From pdalgd at gmail.com  Tue Dec 22 12:58:36 2015
From: pdalgd at gmail.com (peter dalgaard)
Date: Tue, 22 Dec 2015 12:58:36 +0100
Subject: [R-pkg-devel] Namespace: summary of all undefined globals
In-Reply-To: <5679272C.3060405@univ-fcomte.fr>
References: <mailman.13.1450609204.10851.r-devel@r-project.org>
	<5679272C.3060405@univ-fcomte.fr>
Message-ID: <220DD84D-1A4A-4957-A67A-30E862E9E1E4@gmail.com>

The "release branch", currently 3.2.x, by principle contains patch releases of 3.2.0 (i.e. bug fix releases; we do occasionally let new features slip in, but only if they are truly orthogonal to existing code, which is usually not the case in the QA/QC areas). If something was in r-devel in July, then it will have been slated for 3.3.0. 

The most obvious way to get hold of the feature is to install/build a current version of R-devel. Otherwise, you have to port the code to the release branch yourself.

-pd

> On 22 Dec 2015, at 11:34 , Patrick Giraudoux <patrick.giraudoux at univ-fcomte.fr> wrote:
> 
> Dear listers,
> 
> Kurt (subject "CRAN packages maintained by you" sent on 02/07/2015) was mentionning to package maintainers that "with current versions of r-devel, one can get a convenient summary of all undefined globals" and describing how to get a summary conveniently.
> 
> Now I am using R 3.2.3 but cannot get this by using rcmd check --as-cran mypackage, the "traditionnal" namespace with obviously incomplete declaration going through the check 'checking R code for possible problems' with no note.
> 
> Can you confirm that the implementation of R-devel in July, is still NOT in R 3.2.3 and that one should still use the current version of r-devel to get a summary of undefined globals (through notes after 'checking R code for possible problems) ? Is there a way to get it from R 3.2.3 ?
> 
> Thanks in advance,
> 
> Patrick
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From csardi.gabor at gmail.com  Tue Dec 22 13:03:10 2015
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Tue, 22 Dec 2015 12:03:10 +0000
Subject: [R-pkg-devel] Namespace: summary of all undefined globals
In-Reply-To: <220DD84D-1A4A-4957-A67A-30E862E9E1E4@gmail.com>
References: <mailman.13.1450609204.10851.r-devel@r-project.org>
	<5679272C.3060405@univ-fcomte.fr>
	<220DD84D-1A4A-4957-A67A-30E862E9E1E4@gmail.com>
Message-ID: <CABtg=Kk--KA6Py+ekcdyzD+dck9nvHqPTCKqOw2Z4hCn8L16wA@mail.gmail.com>

If you don't want to build r-devel yourself, you can just use
http://win-builder.r-project.org/

Or, if your project is on GitHub you can also use
https://github.com/metacran/r-builder to check on multiple R versions,
including R-devel.

Gabor

On Tue, Dec 22, 2015 at 11:58 AM, peter dalgaard <pdalgd at gmail.com> wrote:
> The "release branch", currently 3.2.x, by principle contains patch releases of 3.2.0 (i.e. bug fix releases; we do occasionally let new features slip in, but only if they are truly orthogonal to existing code, which is usually not the case in the QA/QC areas). If something was in r-devel in July, then it will have been slated for 3.3.0.
>
> The most obvious way to get hold of the feature is to install/build a current version of R-devel. Otherwise, you have to port the code to the release branch yourself.
>
> -pd
>
>> On 22 Dec 2015, at 11:34 , Patrick Giraudoux <patrick.giraudoux at univ-fcomte.fr> wrote:
>>
>> Dear listers,
>>
>> Kurt (subject "CRAN packages maintained by you" sent on 02/07/2015) was mentionning to package maintainers that "with current versions of r-devel, one can get a convenient summary of all undefined globals" and describing how to get a summary conveniently.
>>
>> Now I am using R 3.2.3 but cannot get this by using rcmd check --as-cran mypackage, the "traditionnal" namespace with obviously incomplete declaration going through the check 'checking R code for possible problems' with no note.
>>
>> Can you confirm that the implementation of R-devel in July, is still NOT in R 3.2.3 and that one should still use the current version of r-devel to get a summary of undefined globals (through notes after 'checking R code for possible problems) ? Is there a way to get it from R 3.2.3 ?
>>
>> Thanks in advance,
>>
>> Patrick
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> --
> Peter Dalgaard, Professor,
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Office: A 4.23
> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From patrick.giraudoux at univ-fcomte.fr  Tue Dec 22 13:05:04 2015
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Tue, 22 Dec 2015 13:05:04 +0100
Subject: [R-pkg-devel] Namespace: summary of all undefined globals
In-Reply-To: <220DD84D-1A4A-4957-A67A-30E862E9E1E4@gmail.com>
References: <mailman.13.1450609204.10851.r-devel@r-project.org>
	<5679272C.3060405@univ-fcomte.fr>
	<220DD84D-1A4A-4957-A67A-30E862E9E1E4@gmail.com>
Message-ID: <56793C70.9050603@univ-fcomte.fr>

Le 22/12/2015 12:58, peter dalgaard a ?crit :
> The "release branch", currently 3.2.x, by principle contains patch releases of 3.2.0 (i.e. bug fix releases; we do occasionally let new features slip in, but only if they are truly orthogonal to existing code, which is usually not the case in the QA/QC areas). If something was in r-devel in July, then it will have been slated for 3.3.0.
>
> The most obvious way to get hold of the feature is to install/build a current version of R-devel. Otherwise, you have to port the code to the release branch yourself.
>
> -pd

Thanks Peter. The workflow is clear now.  Hence,  definitely I will 
migrate to R-devel (I was stiking to the last release - here 3.2.3 - to 
stay at the same level as the students -in ecology, not developers).

Best,

Patrick




>
>> On 22 Dec 2015, at 11:34 , Patrick Giraudoux <patrick.giraudoux at univ-fcomte.fr> wrote:
>>
>> Dear listers,
>>
>> Kurt (subject "CRAN packages maintained by you" sent on 02/07/2015) was mentionning to package maintainers that "with current versions of r-devel, one can get a convenient summary of all undefined globals" and describing how to get a summary conveniently.
>>
>> Now I am using R 3.2.3 but cannot get this by using rcmd check --as-cran mypackage, the "traditionnal" namespace with obviously incomplete declaration going through the check 'checking R code for possible problems' with no note.
>>
>> Can you confirm that the implementation of R-devel in July, is still NOT in R 3.2.3 and that one should still use the current version of r-devel to get a summary of undefined globals (through notes after 'checking R code for possible problems) ? Is there a way to get it from R 3.2.3 ?
>>
>> Thanks in advance,
>>
>> Patrick
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From jefferis at mrc-lmb.cam.ac.uk  Wed Dec 30 21:54:14 2015
From: jefferis at mrc-lmb.cam.ac.uk (Dr Gregory Jefferis)
Date: Wed, 30 Dec 2015 20:54:14 +0000
Subject: [R-pkg-devel] how to make "r-release-osx-x86_64-mavericks"
 machine support rgl 3D plots
In-Reply-To: <5616DBC2.4090005@gmail.com>
References: <1B3F92D43EA50646AB74A6C8C69A036064D00C@ait-pex02mbx05.win.dtu.dk>
	<21963.15225.888683.947819@max.nulle.part> <55CB4503.9090706@gmail.com>
	<3F0C870A-8D2A-4E49-8434-266F978285E0@mrc-lmb.cam.ac.uk>
	<55D0B886.3000903@gmail.com>
	<57AA0143-09F5-4080-A417-727814FD9748@mrc-lmb.cam.ac.uk>
	<5616DBC2.4090005@gmail.com>
Message-ID: <2985A400-2044-493B-947A-69445611E0D7@mrc-lmb.cam.ac.uk>

Dear Duncan,

On 8 Oct 2015, at 22:10, Duncan Murdoch wrote:

> On 08/10/2015 4:41 PM, Dr Gregory Jefferis wrote:

[snip]

>> I have a package which imports rgl i.e. rgl is loaded on package
>> startup. A number of examples (not tests) use rgl features and I do 
>> not
>> want these to be run on CRAN.
>>
>> Is there a way to configure rgl.useNULL to handle this situation?
>>
>
> I don't think so, but I don't think you really want that.
>
> options(rgl.useNULL = TRUE)
>
> doesn't stop rgl from running, it just stops it from trying to display
> anything.  So you could put code like
>
> if (!interactive())
> options(rgl.useNULL = TRUE)
>
> into your .onLoad function for your package, and it wouldn't try to 
> open
> a display on CRAN, or anywhere else that wasn't interactive.

I tried following this suggestion, but this has the unintended (for me) 
consequence that it is no longer possible to get rgl snapshots e.g. in 
knitr when rgl.useNULL=TRUE? From what I can see writeWebGL works fine 
but snapshot3d does not and this is not quite what I was expecting 
(though it seems fair enough in retrospect).

Is there a workaround to get snapshots out of a RGL null display?

If not, I think I am back to square 1 in terms of trying to figure out 
how to suppress rgl *examples* (tests are easy) on CRAN.

With many thanks,

Greg.


> sessionInfo()
R version 3.2.3 (2015-12-10)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.9.5 (Mavericks)

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] nat.nblast_1.6.1 catmaid_0.6      httr_1.0.0       nat_1.8.1        
rgl_0.95.1435    devtools_1.9.1

loaded via a namespace (and not attached):
  [1] Rcpp_0.12.2        formatR_1.2.1      plyr_1.8.3         
nabor_0.4.6        tools_3.2.3
  [6] nat.utils_0.5.1    digest_0.6.8       jsonlite_0.9.19    
memoise_0.2.1      filehash_2.3
[11] igraph_1.0.1       curl_0.9.4         yaml_2.1.13        spam_1.3-0 
         stringr_1.0.0
[16] knitr_1.11         dendroextras_0.2.1 grid_3.2.3         R6_2.1.1   
         rmarkdown_0.7
[21] magrittr_1.5       codetools_0.2-14   htmltools_0.2.6    
rsconnect_0.3.79   stringi_1.0-1





--
Gregory Jefferis, PhD
Division of Neurobiology
MRC Laboratory of Molecular Biology
Francis Crick Avenue
Cambridge Biomedical Campus
Cambridge, CB2 OQH, UK

http://www2.mrc-lmb.cam.ac.uk/group-leaders/h-to-m/g-jefferis
http://jefferislab.org
http://flybrain.stanford.edu


From murdoch.duncan at gmail.com  Wed Dec 30 22:11:05 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 30 Dec 2015 16:11:05 -0500
Subject: [R-pkg-devel] how to make "r-release-osx-x86_64-mavericks"
 machine support rgl 3D plots
In-Reply-To: <2985A400-2044-493B-947A-69445611E0D7@mrc-lmb.cam.ac.uk>
References: <1B3F92D43EA50646AB74A6C8C69A036064D00C@ait-pex02mbx05.win.dtu.dk>
	<21963.15225.888683.947819@max.nulle.part> <55CB4503.9090706@gmail.com>
	<3F0C870A-8D2A-4E49-8434-266F978285E0@mrc-lmb.cam.ac.uk>
	<55D0B886.3000903@gmail.com>
	<57AA0143-09F5-4080-A417-727814FD9748@mrc-lmb.cam.ac.uk>
	<5616DBC2.4090005@gmail.com>
	<2985A400-2044-493B-947A-69445611E0D7@mrc-lmb.cam.ac.uk>
Message-ID: <56844869.8010101@gmail.com>

On 30/12/2015 3:54 PM, Dr Gregory Jefferis wrote:
> Dear Duncan,
>
> On 8 Oct 2015, at 22:10, Duncan Murdoch wrote:
>
>> On 08/10/2015 4:41 PM, Dr Gregory Jefferis wrote:
>
> [snip]
>
>>> I have a package which imports rgl i.e. rgl is loaded on package
>>> startup. A number of examples (not tests) use rgl features and I do
>>> not
>>> want these to be run on CRAN.
>>>
>>> Is there a way to configure rgl.useNULL to handle this situation?
>>>
>>
>> I don't think so, but I don't think you really want that.
>>
>> options(rgl.useNULL = TRUE)
>>
>> doesn't stop rgl from running, it just stops it from trying to display
>> anything.  So you could put code like
>>
>> if (!interactive())
>> options(rgl.useNULL = TRUE)
>>
>> into your .onLoad function for your package, and it wouldn't try to
>> open
>> a display on CRAN, or anywhere else that wasn't interactive.
>
> I tried following this suggestion, but this has the unintended (for me)
> consequence that it is no longer possible to get rgl snapshots e.g. in
> knitr when rgl.useNULL=TRUE? From what I can see writeWebGL works fine
> but snapshot3d does not and this is not quite what I was expecting
> (though it seems fair enough in retrospect).
>
> Is there a workaround to get snapshots out of a RGL null display?

No.  Theoretically it's possible to use a virtual frame buffer in X11 to 
hold the image, but I've got no experience with that myself.

>
> If not, I think I am back to square 1 in terms of trying to figure out
> how to suppress rgl *examples* (tests are easy) on CRAN.

You can test for a null device using rgl.useNULL().  If that is true, 
don't try to produce a snapshot.

Duncan Murdoch

>
> With many thanks,
>
> Greg.
>
>
>> sessionInfo()
> R version 3.2.3 (2015-12-10)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.9.5 (Mavericks)
>
> locale:
> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] nat.nblast_1.6.1 catmaid_0.6      httr_1.0.0       nat_1.8.1
> rgl_0.95.1435    devtools_1.9.1
>
> loaded via a namespace (and not attached):
>    [1] Rcpp_0.12.2        formatR_1.2.1      plyr_1.8.3
> nabor_0.4.6        tools_3.2.3
>    [6] nat.utils_0.5.1    digest_0.6.8       jsonlite_0.9.19
> memoise_0.2.1      filehash_2.3
> [11] igraph_1.0.1       curl_0.9.4         yaml_2.1.13        spam_1.3-0
>           stringr_1.0.0
> [16] knitr_1.11         dendroextras_0.2.1 grid_3.2.3         R6_2.1.1
>           rmarkdown_0.7
> [21] magrittr_1.5       codetools_0.2-14   htmltools_0.2.6
> rsconnect_0.3.79   stringi_1.0-1
>
>
>
>
>
> --
> Gregory Jefferis, PhD
> Division of Neurobiology
> MRC Laboratory of Molecular Biology
> Francis Crick Avenue
> Cambridge Biomedical Campus
> Cambridge, CB2 OQH, UK
>
> http://www2.mrc-lmb.cam.ac.uk/group-leaders/h-to-m/g-jefferis
> http://jefferislab.org
> http://flybrain.stanford.edu
>


From jefferis at mrc-lmb.cam.ac.uk  Wed Dec 30 22:42:54 2015
From: jefferis at mrc-lmb.cam.ac.uk (Dr Gregory Jefferis)
Date: Wed, 30 Dec 2015 21:42:54 +0000
Subject: [R-pkg-devel] how to make "r-release-osx-x86_64-mavericks"
 machine support rgl 3D plots
In-Reply-To: <56844869.8010101@gmail.com>
References: <1B3F92D43EA50646AB74A6C8C69A036064D00C@ait-pex02mbx05.win.dtu.dk>
	<21963.15225.888683.947819@max.nulle.part> <55CB4503.9090706@gmail.com>
	<3F0C870A-8D2A-4E49-8434-266F978285E0@mrc-lmb.cam.ac.uk>
	<55D0B886.3000903@gmail.com>
	<57AA0143-09F5-4080-A417-727814FD9748@mrc-lmb.cam.ac.uk>
	<5616DBC2.4090005@gmail.com>
	<2985A400-2044-493B-947A-69445611E0D7@mrc-lmb.cam.ac.uk>
	<56844869.8010101@gmail.com>
Message-ID: <E29C2255-B30A-4AB0-B4D8-75295BAFFBC7@mrc-lmb.cam.ac.uk>

On 30 Dec 2015, at 21:11, Duncan Murdoch wrote:


>> Is there a workaround to get snapshots out of a RGL null display?
>
> No.

OK. Thanks for confirming.

> Theoretically it's possible to use a virtual frame buffer in X11 to 
> hold the image, but I've got no experience with that myself.

I have used xvfb in some headless environments (including travis).

>> If not, I think I am back to square 1 in terms of trying to figure 
>> out
>> how to suppress rgl *examples* (tests are easy) on CRAN.
>
> You can test for a null device using rgl.useNULL().  If that is true, 
> don't try to produce a snapshot.

I wasn't being clear there. I want to have rgl example code (e.g. plot3d 
statements) in my documentation

* that's not enclosed in conditionals
* or \dontrun
* but that doesn't use a live rgl window during package check 
(especially on CRAN)
* ... unless I do something to request this.

The code is not actually making snapshots.

I think what I may try is changing my .onLoad to look something like 
this:

.onLoad <- function(libname, pkgname) {

   DEVTOOLS_CRAN=toupper(Sys.getenv("NOT_CRAN")) %in% c("FALSE","0", 
"NO")

   # this is a heuristic to determine if we are running on CRAN
   CRAN=toupper(Sys.getenv("_R_CHECK_INSTALL_DEPENDS_")) %in% c("TRUE", 
"YES", "1")

   if(!interactive() && is.null(getOption('rgl.useNULL')) && 
(DEVTOOLS_CRAN || CRAN)){
     options(rgl.useNULL=TRUE)
   }

}

Thanks again,

Greg.

--
Gregory Jefferis, PhD
Division of Neurobiology
MRC Laboratory of Molecular Biology
Francis Crick Avenue
Cambridge Biomedical Campus
Cambridge, CB2 OQH, UK

http://www2.mrc-lmb.cam.ac.uk/group-leaders/h-to-m/g-jefferis
http://jefferislab.org
http://flybrain.stanford.edu


From murdoch.duncan at gmail.com  Thu Dec 31 01:28:38 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 30 Dec 2015 19:28:38 -0500
Subject: [R-pkg-devel] how to make "r-release-osx-x86_64-mavericks"
 machine support rgl 3D plots
In-Reply-To: <E29C2255-B30A-4AB0-B4D8-75295BAFFBC7@mrc-lmb.cam.ac.uk>
References: <1B3F92D43EA50646AB74A6C8C69A036064D00C@ait-pex02mbx05.win.dtu.dk>
	<21963.15225.888683.947819@max.nulle.part> <55CB4503.9090706@gmail.com>
	<3F0C870A-8D2A-4E49-8434-266F978285E0@mrc-lmb.cam.ac.uk>
	<55D0B886.3000903@gmail.com>
	<57AA0143-09F5-4080-A417-727814FD9748@mrc-lmb.cam.ac.uk>
	<5616DBC2.4090005@gmail.com>
	<2985A400-2044-493B-947A-69445611E0D7@mrc-lmb.cam.ac.uk>
	<56844869.8010101@gmail.com>
	<E29C2255-B30A-4AB0-B4D8-75295BAFFBC7@mrc-lmb.cam.ac.uk>
Message-ID: <568476B6.9020100@gmail.com>

On 30/12/2015 4:42 PM, Dr Gregory Jefferis wrote:
> On 30 Dec 2015, at 21:11, Duncan Murdoch wrote:
>
>
>>> Is there a workaround to get snapshots out of a RGL null display?
>>
>> No.
>
> OK. Thanks for confirming.
>
>> Theoretically it's possible to use a virtual frame buffer in X11 to
>> hold the image, but I've got no experience with that myself.
>
> I have used xvfb in some headless environments (including travis).
>
>>> If not, I think I am back to square 1 in terms of trying to figure
>>> out
>>> how to suppress rgl *examples* (tests are easy) on CRAN.
>>
>> You can test for a null device using rgl.useNULL().  If that is true,
>> don't try to produce a snapshot.
>
> I wasn't being clear there. I want to have rgl example code (e.g. plot3d
> statements) in my documentation
>
> * that's not enclosed in conditionals
> * or \dontrun
> * but that doesn't use a live rgl window during package check
> (especially on CRAN)
> * ... unless I do something to request this.
>
> The code is not actually making snapshots.


I'm not sure I understand why.  Why not write examples that produce rgl 
displays (or nothing with a null device)?  rgl itself has lots of these, 
and passes checks on most systems.  Currently it is supposed to detect 
display initialization failures and fall back to the null device, but I 
don't know if this works on the only CRAN system that seems to need it, 
the OSX system, because I haven't seen results of tests yet.

>
> I think what I may try is changing my .onLoad to look something like
> this:
>
> .onLoad <- function(libname, pkgname) {
>
>     DEVTOOLS_CRAN=toupper(Sys.getenv("NOT_CRAN")) %in% c("FALSE","0",
> "NO")
>
>     # this is a heuristic to determine if we are running on CRAN
>     CRAN=toupper(Sys.getenv("_R_CHECK_INSTALL_DEPENDS_")) %in% c("TRUE",
> "YES", "1")
>
>     if(!interactive() && is.null(getOption('rgl.useNULL')) &&
> (DEVTOOLS_CRAN || CRAN)){
>       options(rgl.useNULL=TRUE)
>     }
>
> }

I would be careful about that -- the CRAN people want to run realistic 
tests, and they will likely object if you are trying to act differently 
on their system than on your users' systems.

Duncan Murdoch

> Thanks again,
>
> Greg.
>
> --
> Gregory Jefferis, PhD
> Division of Neurobiology
> MRC Laboratory of Molecular Biology
> Francis Crick Avenue
> Cambridge Biomedical Campus
> Cambridge, CB2 OQH, UK
>
> http://www2.mrc-lmb.cam.ac.uk/group-leaders/h-to-m/g-jefferis
> http://jefferislab.org
> http://flybrain.stanford.edu
>


From jefferis at mrc-lmb.cam.ac.uk  Thu Dec 31 13:47:37 2015
From: jefferis at mrc-lmb.cam.ac.uk (Dr Gregory Jefferis)
Date: Thu, 31 Dec 2015 12:47:37 +0000
Subject: [R-pkg-devel] how to make "r-release-osx-x86_64-mavericks"
 machine support rgl 3D plots
In-Reply-To: <568476B6.9020100@gmail.com>
References: <1B3F92D43EA50646AB74A6C8C69A036064D00C@ait-pex02mbx05.win.dtu.dk>
	<21963.15225.888683.947819@max.nulle.part> <55CB4503.9090706@gmail.com>
	<3F0C870A-8D2A-4E49-8434-266F978285E0@mrc-lmb.cam.ac.uk>
	<55D0B886.3000903@gmail.com>
	<57AA0143-09F5-4080-A417-727814FD9748@mrc-lmb.cam.ac.uk>
	<5616DBC2.4090005@gmail.com>
	<2985A400-2044-493B-947A-69445611E0D7@mrc-lmb.cam.ac.uk>
	<56844869.8010101@gmail.com>
	<E29C2255-B30A-4AB0-B4D8-75295BAFFBC7@mrc-lmb.cam.ac.uk>
	<568476B6.9020100@gmail.com>
Message-ID: <6D4AC9E7-18AF-4EBE-ACD1-B923003D743D@mrc-lmb.cam.ac.uk>

Dear Duncan,

On 31 Dec 2015, at 0:28, Duncan Murdoch wrote:

> On 30/12/2015 4:42 PM, Dr Gregory Jefferis wrote:
>> On 30 Dec 2015, at 21:11, Duncan Murdoch wrote:

>> I wasn't being clear there. I want to have rgl example code (e.g. 
>> plot3d
>> statements) in my documentation
>>
>> * that's not enclosed in conditionals
>> * or \dontrun
>> * but that doesn't use a live rgl window during package check
>> (especially on CRAN)
>> * ... unless I do something to request this.

> I'm not sure I understand why.  Why not write examples that produce 
> rgl displays (or nothing with a null device)?  rgl itself has lots of 
> these, and passes checks on most systems.  Currently it is supposed to 
> detect display initialization failures and fall back to the null 
> device, but I don't know if this works on the only CRAN system that 
> seems to need it, the OSX system, because I haven't seen results of 
> tests yet.

My packages are used by a small community of neuroscientists with 
varying degrees of expertise in running /installing / compiling code. 
Not infrequently using these packages is the first time they use R. Most 
use macs. The mac binary version of the main nat package was out of date 
for about 6 months because it could not be built on the CRAN mac because 
of some kind of rgl problem on that machine (you probably know what that 
was - I presume it was difficult to fix!). This forces my users to use 
devtools for installation and also means that the install instructions 
for downstream packages depending on nat are insufficient because they 
assume that nat can be fetched from CRAN.

By running rgl with the null device on CRAN I still exercise the 
relevant code but insulate myself from this kind of issue.

>> I think what I may try is changing my .onLoad to look something like
>> this:

[snip]

> I would be careful about that -- the CRAN people want to run realistic 
> tests, and they will likely object if you are trying to act 
> differently on their system than on your users' systems.

You're right that's something to be careful about. I guess I want to use 
the null device during check, not just on CRAN ? it's annoying to have 
X11 windows cropping up when coding. I'd argue, that this is actually 
less restrictive than skipping tests on CRAN ? which as far as I know 
is perfectly acceptable. The problem is that there are no simple 
mechanisms to skip example code (rather than tests) ? hence the 
approach of putting code to test/set rgl.useNULL status in .onLoad that 
you originally suggested.

Thanks again for advice/feedback.

Best wishes	,

Greg.

--
Gregory Jefferis, PhD
Division of Neurobiology
MRC Laboratory of Molecular Biology
Francis Crick Avenue
Cambridge Biomedical Campus
Cambridge, CB2 OQH, UK

http://www2.mrc-lmb.cam.ac.uk/group-leaders/h-to-m/g-jefferis
http://jefferislab.org
http://flybrain.stanford.edu


