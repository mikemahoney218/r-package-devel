From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Mon Jan  2 19:20:11 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Mon, 2 Jan 2023 12:20:11 -0600
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
Message-ID: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>

Hello, All:


	  What are current recommendations for GitHub Action?


	  My most recent change to "sos" generated "Failed to get R" for 
ubuntu-latest (release, devel, and oldrel-1).


https://github.com/sbgraves237/sos/actions/runs/3820307473/jobs/6498527786


	  I would happily rtfm if I only knew which fmtr.


	  Thanks,
	  Spencer Graves


From zk@mv@r @end|ng |rom gm@||@com  Mon Jan  2 19:34:41 2023
From: zk@mv@r @end|ng |rom gm@||@com (Zhian Kamvar)
Date: Mon, 2 Jan 2023 10:34:41 -0800
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
In-Reply-To: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
References: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
Message-ID: <CAPsXksJ=MPS=979NnD4hJGeg5hDk80JF-KPhYoMtDv64ZKxXWw@mail.gmail.com>

This warning says to update to v2 of the action from r-lib:

Warning: r-lib/actions/setup-r at v1 is deprecated. Please update your
> workflow to use the 'v2' version. Also look at the examples at
> https://github.com/r-lib/actions/tree/v2/examples because '@v2' workflows
> are much simpler than 'v1' workflows.


We ran into a similar problem and switching to v2 did the trick.

Best,
Zhian

On Mon, Jan 2, 2023 at 10:20 AM Spencer Graves <
spencer.graves at effectivedefense.org> wrote:

> Hello, All:
>
>
>           What are current recommendations for GitHub Action?
>
>
>           My most recent change to "sos" generated "Failed to get R" for
> ubuntu-latest (release, devel, and oldrel-1).
>
>
> https://github.com/sbgraves237/sos/actions/runs/3820307473/jobs/6498527786
>
>
>           I would happily rtfm if I only knew which fmtr.
>
>
>           Thanks,
>           Spencer Graves
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Mon Jan  2 19:38:16 2023
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 2 Jan 2023 12:38:16 -0600
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
In-Reply-To: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
References: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
Message-ID: <25523.9368.854032.549309@rob.eddelbuettel.com>


As the error is common against your _all three_ of your Ubuntu runs, you
could consider the possibility that the events are correlated.  Most often it
simply means a (temporary, usually) network or server outage.  I would wait,
and then relaunch (which these days you can do just for the failed jobs).

It is also worth paying attention to warnings such as

   Warning: r-lib/actions/setup-r at v1 is deprecated. Please update your
   workflow to use the 'v2' version. Also look at the examples at
   https://github.com/r-lib/actions/tree/v2/examples because '@v2' workflows
   are much simpler than 'v1' workflows.

Hth,  Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Tue Jan  3 02:18:33 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Mon, 2 Jan 2023 19:18:33 -0600
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
In-Reply-To: <25523.9368.854032.549309@rob.eddelbuettel.com>
References: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
 <25523.9368.854032.549309@rob.eddelbuettel.com>
Message-ID: <b97fe385-c884-1365-3ab2-d86a293d9a27@effectivedefense.org>



On 1/2/23 12:38 PM, Dirk Eddelbuettel wrote:
> 
> As the error is common against your _all three_ of your Ubuntu runs, you
> could consider the possibility that the events are correlated.  Most often it
> simply means a (temporary, usually) network or server outage.  I would wait,
> and then relaunch (which these days you can do just for the failed jobs).
> 
> It is also worth paying attention to warnings such as
> 
>     Warning: r-lib/actions/setup-r at v1 is deprecated. Please update your
>     workflow to use the 'v2' version. Also look at the examples at
>     https://github.com/r-lib/actions/tree/v2/examples because '@v2' workflows
>     are much simpler than 'v1' workflows.


	  Thanks to Zhian Kamvar and Dirk Eddelbuettel for encouraging me to 
look at the warning.


	  I replaced a few lined of my "R-CMD-check.yaml" file with the the 
"v3" and "v2" versions in the example in 
"https://github.com/r-lib/actions/tree/v2/examples" and deleted 
subsequent lines that I didn't understand, and I got an instant failure: 
  It didn't run even one of the 5 tests.  Then I did "git revert" with 
the version number from GitHub and changed several lines to match the 
example with the succeeding yaml code.  GitHub Action ran and failed on 
all 5 platforms.  I did "git revert" with that and changed 
"r-lib/actions/setup-r at v1" to "r-lib/actions/setup-r at v2".  With that, 
R-release ran successfully on Unbuntu as well as Windows and macOS.


	  However, Ubuntu failed with devel and oldrel1, complaining, "there is 
no package called ?rcmdcheck?".


	  See:


https://github.com/sbgraves237/sos


	  Suggestions?
	  Thanks,
	  Spencer Graves

> 
> Hth,  Dirk
>


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Jan  4 10:18:40 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 4 Jan 2023 12:18:40 +0300
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
In-Reply-To: <b97fe385-c884-1365-3ab2-d86a293d9a27@effectivedefense.org>
References: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
 <25523.9368.854032.549309@rob.eddelbuettel.com>
 <b97fe385-c884-1365-3ab2-d86a293d9a27@effectivedefense.org>
Message-ID: <20230104121840.7dc90239@Tarkus>

On Mon, 2 Jan 2023 19:18:33 -0600
Spencer Graves <spencer.graves at effectivedefense.org> wrote:

> 	  However, Ubuntu failed with devel and oldrel1, complaining,
> "there is no package called ?rcmdcheck?".

If we start from the error message and work backwards, it's easy to see
that `rcmdcheck` fails to install because it depends on `curl`, which
also fails to install. `curl` fails to install because the virtual
machine running the GitHub Action doesn't have libcurl headers
installed; there's even an error message about that, but it's not fatal:

------------------------- ANTICONF ERROR ---------------------------
Configuration failed because libcurl was not found. Try installing:
 * deb: libcurl4-openssl-dev (Debian, Ubuntu, etc)
 * rpm: libcurl-devel (Fedora, CentOS, RHEL)
If libcurl is already installed, check that 'pkg-config' is in your
PATH and PKG_CONFIG_PATH contains a libcurl.pc file. If pkg-config
is unavailable you can set INCLUDE_DIR and LIB_DIR manually via:
R CMD INSTALL --configure-vars='INCLUDE_DIR=... LIB_DIR=...'
--------------------------------------------------------------------

I don't have enough experience in the abstraction layers involved, but
if you stuff a `sudo apt install libcurl4-openssl-dev` (which should
run as a system command line, just like the "Install system
dependencies" step) somewhere before the "Install dependencies" step,
it should work.

-- 
Best regards,
Ivan


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Wed Jan  4 11:50:20 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Wed, 4 Jan 2023 11:50:20 +0100
Subject: [R-pkg-devel] new toolchain "RTools43" for building devel binaries
 (both R base and packages)
Message-ID: <2d486a48-087d-4bbe-b8cd-021025cfabc8@statistik.tu-dortmund.de>

Dear developers,

for those building from source on Windows:

A new toolchain called "RTools43" has been prepared by Tomas Kalibera.
It is now used to build the Windows binaries (R base and contributed 
packages) for R-devel on Windows. See
<https://cran.r-project.org/bin/windows/Rtools/rtools43/rtools.html>.

Best,
Uwe Ligges


From k|ng@@ @end|ng |rom um|ch@edu  Wed Jan  4 21:54:52 2023
From: k|ng@@ @end|ng |rom um|ch@edu (Aaron A. King)
Date: Wed, 4 Jan 2023 15:54:52 -0500
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
Message-ID: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>

Hi all,

I'm modifying a package so as to remove its dependence on the superseded
packages *reshape2* and *plyr*, in favor of dependence on *dplyr*.  In
particular, I'm just importing the one function `dplyr::bind_rows`.

A curious thing happens, however, as soon as I include this among the
imports.  I begin to get R CMD check NOTEs alerting me to the presence of
S3 generic inconsistencies.  These are associated with two functions in the
package: `filter.mean` and `filter.traj`, which the checker mistakes for S3
methods based on the generic `stats::filter` function.  Actually, these are
not S3 methods.  In fact, they are S4 generics and declared as such.

When *dplyr* is not imported, R CMD check is happy with these functions.
When it is imported, R CMD check complains.

Now I understand that it may be preferable to move away from functions with
names containing dots for this reason, and in fact I am already doing so,
but I think the question is a good one:

Why does inclusion of *dplyr* in the import list appear to trigger these
warnings when they were not there before?

Thanks in advance for any insight you can give!

Aaron A. King, Ph.D.
Nelson G. Hairston Professor of Ecology, Evolutionary Biology, and Complex
Systems
University of Michigan
kinglab.eeb.lsa.umich.edu
GPG Public Key: 0x15780975

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Jan  4 22:22:09 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 5 Jan 2023 00:22:09 +0300
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
Message-ID: <20230105002209.6e1fae5d@Tarkus>

On Wed, 4 Jan 2023 15:54:52 -0500
"Aaron A. King" <kingaa at umich.edu> wrote:

> Why does inclusion of *dplyr* in the import list appear to trigger
> these warnings when they were not there before?

I think that's because dplyr itself contains an S3 generic named
"filter", and having a package namespace loaded (not even attached) is
enough to take its registered S3 methods into consideration for method
dispatch. Here we have an opposite situation, though, and your
functions aren't registered as S3 methods. Will your function still be
called if you artificially construct a wrong object and feed it to
dplyr::filter while your package namespace is attached?

library(YOURPACKAGE)
dplyr::filter(structure(list(), class = 'traj'))

Additionally, stats::filter doesn't seem to be an S3 generic, so that's
one thing that the check gets confused about.

-- 
Best regards,
Ivan


From k|ng@@ @end|ng |rom um|ch@edu  Thu Jan  5 23:58:47 2023
From: k|ng@@ @end|ng |rom um|ch@edu (Aaron A. King)
Date: Thu, 5 Jan 2023 17:58:47 -0500
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <20230105002209.6e1fae5d@Tarkus>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
 <20230105002209.6e1fae5d@Tarkus>
Message-ID: <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>

Thanks for the fast reply!

When I follow your suggestion above, I get

library(pomp)
dplyr::filter(structure(list(), class = 'traj'))

Error in UseMethod("filter") :
  no applicable method for 'filter' applied to an object of class "traj"

Which is not what would happen if my filter.traj function were called.  So
the S3 dispatch system is not confused.  Thus this really is a false
positive.

It still leaves open the question, why does this suddenly appear when dplyr
is loaded?  If I understand you correctly, it would be triggered by the
inclusion of the generic 'filter' in dplyr, which was previously not
present. However, since the S3 dispatch system is not itself confused, I
suppose it must be the case that the S3 generic/method consistency checker
itself is confused.  I wonder, how does the checker decide when to throw a
NOTE?  Is it a simple pattern-matching system, something like "If X.Y is
exported, where X is a generic and Y is any string and X.Y is not declared
as an S3 method, then throw NOTE"?

Dr. Aaron A. King
University of Michigan


On Wed, Jan 4, 2023 at 4:22 PM Ivan Krylov <krylov.r00t at gmail.com> wrote:

> On Wed, 4 Jan 2023 15:54:52 -0500
> "Aaron A. King" <kingaa at umich.edu> wrote:
>
> > Why does inclusion of *dplyr* in the import list appear to trigger
> > these warnings when they were not there before?
>
> I think that's because dplyr itself contains an S3 generic named
> "filter", and having a package namespace loaded (not even attached) is
> enough to take its registered S3 methods into consideration for method
> dispatch. Here we have an opposite situation, though, and your
> functions aren't registered as S3 methods. Will your function still be
> called if you artificially construct a wrong object and feed it to
> dplyr::filter while your package namespace is attached?
>
> library(YOURPACKAGE)
> dplyr::filter(structure(list(), class = 'traj'))
>
> Additionally, stats::filter doesn't seem to be an S3 generic, so that's
> one thing that the check gets confused about.
>
> --
> Best regards,
> Ivan
>

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan  6 09:21:49 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 6 Jan 2023 11:21:49 +0300
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
 <20230105002209.6e1fae5d@Tarkus>
 <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>
Message-ID: <20230106112149.10207568@Tarkus>

On Thu, 5 Jan 2023 17:58:47 -0500
"Aaron A. King" <kingaa at umich.edu> wrote:

> However, since the S3 dispatch system is not itself confused, I
> suppose it must be the case that the S3 generic/method consistency
> checker itself is confused.  I wonder, how does the checker decide
> when to throw a NOTE?  Is it a simple pattern-matching system,
> something like "If X.Y is exported, where X is a generic and Y is any
> string and X.Y is not declared as an S3 method, then throw NOTE"?

The aim of the check is a bit different: "if an S3 method for generic X
and class Y exists, and the formal arguments of X.Y don't extend the
formal arguments of X in a certain way, then throw a NOTE", but then
something gets wrong about deciding whether X.Y is an S3 method, and
once filter.mean is decided to be an S3 method, of course it doesn't
match the formals of filter.

This function is even a public API of the tools package, see
?tools::checkS3methods:
https://github.com/r-devel/r-svn/blob/b57918fd104962415a752ea7db12dcf4f3f5219f/src/library/tools/R/QC.R#L2310-L2560

> When I follow your suggestion above, I get
> 
> library(pomp)
> dplyr::filter(structure(list(), class = 'traj'))
> 
> Error in UseMethod("filter") :
> no applicable method for 'filter' applied to an object of class "traj"

Interesting. I wonder if there's are other remaining ways to confuse
the S3 dispatch system into thinking your function is an S3 method that
the check is supposed to guard against. For instance, the following is
likely to work with your package:

library(pomp)
library(dplyr)
identical(filter.traj, getS3method('filter', 'traj'))
# as long as there's a visible 'filter' generic, getS3method will
# locate filter.traj as the method

...despite the method lookup seems to (correctly) fail, as you've just
demonstrated. But on older versions of R, this used to wrongly resolve
the call:

library(Ropj)
read <- function(x, ...) UseMethod('read')
identical(read.opj, getS3method('read','opj')) # works in R-devel
# [1] TRUE
read(structure(0, class = 'opj')) # calls read.opj in old R
# Error in read_opj(file, encoding, tree) :
#   Expecting a single string value: [type=double; extent=1].

I'm afraid I'm out of my depth here. The old, wrong behaviour seems to
match the R language definition
<https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Definition>.
The current behaviour seems to do the right thing? by letting the
functions opt into being methods, but then getS3method() seems to
contradict what actually gets called. Should we be fixing the
documentation, the implementation, or the check?

Can you try stepping through tools::checkS3methods('pomp') (or
tools::checkS3methods(dir = 'path/to/source/directory')) to see where
'filter' appears in the list of generics and where the 

-- 
Best regards,
Ivan


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan  6 09:24:13 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 6 Jan 2023 11:24:13 +0300
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <20230106112149.10207568@Tarkus>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
 <20230105002209.6e1fae5d@Tarkus>
 <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>
 <20230106112149.10207568@Tarkus>
Message-ID: <20230106112413.478d82da@Tarkus>

(Sorry for the unfinished message. I've got to do something about my
mailer to make it harder to send them accidentally.)

On Fri, 6 Jan 2023 11:21:49 +0300
Ivan Krylov <krylov.r00t at gmail.com> wrote:

> to see where 'filter' appears in the list of generics and where the

filter.traj function gets matched to it as a method?

-- 
Best regards,
Ivan


From k|ng@@ @end|ng |rom um|ch@edu  Fri Jan  6 19:56:10 2023
From: k|ng@@ @end|ng |rom um|ch@edu (Aaron A. King)
Date: Fri, 6 Jan 2023 13:56:10 -0500
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <20230106112413.478d82da@Tarkus>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
 <20230105002209.6e1fae5d@Tarkus>
 <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>
 <20230106112149.10207568@Tarkus> <20230106112413.478d82da@Tarkus>
Message-ID: <CAGPRvNC2T5Ce-ZdcKdwsmh53uQ1JVYf75CTC=i6Bbf2mL7B0Jw@mail.gmail.com>

Excellent suggestion, Ivan. Thanks for pointing out just where to look.

I stepped through tools::checkS3methods("pomp") and it does appear to be
roughly as I conjectured.  Namely, all functions are extracted from the
pomp namespace and checked against a list of generics.  The check that is
performed is a simple pattern-match (i.e.,
startsWith(paste0(genericname,"."), functionname)).  Clearly this is prone
to false positives.  I wonder what would be involved in tightening this up
so that it agrees with what the actual dispatch mechanism gives....

Interestingly, there is a whitelist, implemented mostly via
tools::nonS3methods().  The function (plyr::rbind.fill) that I had been
importing is there but its replacement (dplyr::bind_rows) is not. So this
answers my original question.

The whitelist appears to be a somewhat arbitrary compilation of functions
from various packages, with no obvious theme.  For example, dplyr is not on
the list, but ElectoGraph is; reshape is on the list but reshape2 is not.
The impression of arbitrariness is reinforced by the fact that packages
that Wickham has for whatever reason decided are superseded are present in
that list and packages he considers for the moment to be worth maintaining
are not.  Doing a quick 'git blame' I see that the whitelist was mostly put
together in 2013, with a few additions in 2015 and much more occasionally
since.

It occurs to me that there ought to be a mechanism whereby a package author
could add to the list of non-S3 methods.  I see from the mailing list
archives that there was discussion of this back in 2015 (
https://stat.ethz.ch/pipermail/r-devel/2015-June/071356.html), with what
looked like consensus that there ought to be such a facility, but nothing
seems to have actually been done about it.  I conjecture that the decision
was to just fold false positives into the whitelist on an ad hoc basis.

Dr. Aaron A. King
University of Michigan


On Fri, Jan 6, 2023 at 3:24 AM Ivan Krylov <krylov.r00t at gmail.com> wrote:

> (Sorry for the unfinished message. I've got to do something about my
> mailer to make it harder to send them accidentally.)
>
> On Fri, 6 Jan 2023 11:21:49 +0300
> Ivan Krylov <krylov.r00t at gmail.com> wrote:
>
> > to see where 'filter' appears in the list of generics and where the
>
> filter.traj function gets matched to it as a method?
>
> --
> Best regards,
> Ivan
>

	[[alternative HTML version deleted]]


From th|erry@denoeux @end|ng |rom utc@|r  Sat Jan  7 09:02:18 2023
From: th|erry@denoeux @end|ng |rom utc@|r (Thierry Denoeux)
Date: Sat, 7 Jan 2023 15:02:18 +0700
Subject: [R-pkg-devel] Problem with NEWS file
Message-ID: <A76FB9A9-9F8A-4836-8CDB-7622E9D76BFC@utc.fr>

Dear all,

Version 2.0.0 of my ?evclass' package was rejected for the second time with the following note from the Debian check (the Windows check is OK):

* checking package subdirectories ... NOTE
Problems with news in ?NEWS?:
  Cannot process chunk/lines:
    Version 2.0.0 includes an implementation of radial basis function neural network classifiers, as well as functions to express the outputs of trained logistic regression or feed-forward neural network classifiers as Dempster-Shafer mass functions. These methods are based on an interpretation of the operations performed in neural networks as the combination of weights of evidence by Dempster's rule (see: "T. Denoeux, Logistic Regression, Neural Networks and Dempster-Shafer Theory: a New Perspective. Knowledge-Based Systems 176:54-67, 2019").

I already tried to change the NEWS file but I have no idea where the error might come from. The NEWS file is a text file created by TextEdit on Mac with UTF-8 encoding, so I don?t see how there could be hidden special characters in it. I see nothing special in the line that could not be processed. Any help would be greatly appreciated.

Best,

Thierry
----------
Prof. Thierry Denoeux
Universit? de technologie de Compi?gne
Institut universitaire de France
Rue Roger Couttolenc, CS 60319
60203 Compi?gne cedex, France
https://www.hds.utc.fr/~tdenoeux


	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Sat Jan  7 09:20:45 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 7 Jan 2023 11:20:45 +0300
Subject: [R-pkg-devel] Problem with NEWS file
In-Reply-To: <A76FB9A9-9F8A-4836-8CDB-7622E9D76BFC@utc.fr>
References: <A76FB9A9-9F8A-4836-8CDB-7622E9D76BFC@utc.fr>
Message-ID: <20230107112045.4fcf06b3@Tarkus>

On Sat, 7 Jan 2023 15:02:18 +0700
Thierry Denoeux <thierry.denoeux at utc.fr> wrote:

> The NEWS file is a text file created by TextEdit on Mac with UTF-8
> encoding, so I don?t see how there could be hidden special characters
> in it.

The problem is that the NEWS files are supposed to have a certain
format (documented in help(news)). For a long time, this hasn't been
enforced, but now there are checks in place that require NEWS to be
written to specifications.

I think that your line can be transformed as follows in order to parse
correctly:

Changes in version 2.0.0

 * Implementation of radial basis function neural network classifiers,
   as well as functions to express the outputs of trained logistic
   regression or feed-forward neural network classifiers as
   Dempster-Shafer mass functions. These methods are based on an
   interpretation of the operations performed in neural networks as the
   combination of weights of evidence by Dempster's rule (see: "T.
   Denoeux, Logistic Regression, Neural Networks and Dempster-Shafer
   Theory: a New Perspective. Knowledge-Based Systems 176:54-67, 2019").

You can also write an inst/NEWS.Rd file in Rd format.

As you can see from reading ?news, it is preferred to provide a
bulleted list of the changes.

-- 
Best regards,
Ivan


From th|erry@denoeux @end|ng |rom utc@|r  Sat Jan  7 10:37:53 2023
From: th|erry@denoeux @end|ng |rom utc@|r (Thierry Denoeux)
Date: Sat, 7 Jan 2023 16:37:53 +0700
Subject: [R-pkg-devel] Problem with NEWS file
In-Reply-To: <20230107112045.4fcf06b3@Tarkus>
References: <A76FB9A9-9F8A-4836-8CDB-7622E9D76BFC@utc.fr>
 <20230107112045.4fcf06b3@Tarkus>
Message-ID: <B219EF5F-BEE8-4071-AA95-608DE2539DA1@utc.fr>

I had overlooked these new specifications for the NEWS file. Thank you very much!
Thierry
----------
Prof. Thierry Denoeux
Universit? de technologie de Compi?gne
Institut universitaire de France
Rue Roger Couttolenc, CS 60319
60203 Compi?gne cedex, France
https://www.hds.utc.fr/~tdenoeux

> Le 7 janv. 2023 ? 15:20, Ivan Krylov <krylov.r00t at gmail.com> a ?crit :
> 
> On Sat, 7 Jan 2023 15:02:18 +0700
> Thierry Denoeux <thierry.denoeux at utc.fr> wrote:
> 
>> The NEWS file is a text file created by TextEdit on Mac with UTF-8
>> encoding, so I don?t see how there could be hidden special characters
>> in it.
> 
> The problem is that the NEWS files are supposed to have a certain
> format (documented in help(news)). For a long time, this hasn't been
> enforced, but now there are checks in place that require NEWS to be
> written to specifications.
> 
> I think that your line can be transformed as follows in order to parse
> correctly:
> 
> Changes in version 2.0.0
> 
> * Implementation of radial basis function neural network classifiers,
>   as well as functions to express the outputs of trained logistic
>   regression or feed-forward neural network classifiers as
>   Dempster-Shafer mass functions. These methods are based on an
>   interpretation of the operations performed in neural networks as the
>   combination of weights of evidence by Dempster's rule (see: "T.
>   Denoeux, Logistic Regression, Neural Networks and Dempster-Shafer
>   Theory: a New Perspective. Knowledge-Based Systems 176:54-67, 2019").
> 
> You can also write an inst/NEWS.Rd file in Rd format.
> 
> As you can see from reading ?news, it is preferred to provide a
> bulleted list of the changes.
> 
> -- 
> Best regards,
> Ivan


	[[alternative HTML version deleted]]


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sun Jan  8 02:43:10 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Sat, 7 Jan 2023 20:43:10 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
Message-ID: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>

Hi,

I am in the middle of developing a new package, which contains a 
markdown-knitr-html vignette. When I try to run

R CMD build [mypackagedirectory]

I get an error message

Quitting from lines 330-336
Error: processing vignette? failed with diagnostics:
invalid z limits

If I run the same markdown script interactively inside R Studio, there 
is no error.
If I knit the markdown script inside R Studio, it produces the correct 
HTML output, with no error.

The offending lines of code (the chunk at 330-336) invoke an "image" 
method on an object of a class defined in the package, which in turn 
computes a matrix from items inside the object and calls image.default, 
which is presumably where the error is coming from.

Two questions: (1) How is it possible that the same code works error 
free in the RStudio contexts, but fails in the attempt to build the package?
(2) Any suggestions on how to debug something that only throws an error 
from "R CMD build" would be most welcome.

Thanks in advance,
 ? Kevin


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Jan  8 11:04:44 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 8 Jan 2023 05:04:44 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
Message-ID: <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>

On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
> Hi,
> 
> I am in the middle of developing a new package, which contains a
> markdown-knitr-html vignette. When I try to run
> 
> R CMD build [mypackagedirectory]
> 
> I get an error message
> 
> Quitting from lines 330-336
> Error: processing vignette? failed with diagnostics:
> invalid z limits
> 
> If I run the same markdown script interactively inside R Studio, there
> is no error.
> If I knit the markdown script inside R Studio, it produces the correct
> HTML output, with no error.
> 
> The offending lines of code (the chunk at 330-336) invoke an "image"
> method on an object of a class defined in the package, which in turn
> computes a matrix from items inside the object and calls image.default,
> which is presumably where the error is coming from.
> 
> Two questions: (1) How is it possible that the same code works error
> free in the RStudio contexts, but fails in the attempt to build the package?
> (2) Any suggestions on how to debug something that only throws an error
> from "R CMD build" would be most welcome.

Debugging that sort of thing is hard.  Here's what I would try:

 From inside an R session, run

   tools:::.build_packages("[mypackagedirectory]")

That runs the code that R CMD build runs, so it might trigger the same 
error.  If so, debug in the usual way, with traceback(), etc.

If that doesn't trigger the error, try it using a different front-end, 
e.g. running R at the command line instead of running it in RStudio.

If you still can't trigger it, then start modifying the vignette to find 
the exact line that causes the error (e.g. by commenting out the second 
half of the code in that chunk; did the error go away? etc.).  Then 
modify it again to save all the inputs to the bad line in a file before 
running it, and see if running that line in a different context still 
triggers the error. Etc.

Duncan Murdoch


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Sun Jan  8 12:42:41 2023
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Sun, 8 Jan 2023 11:42:41 +0000
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
Message-ID: <CWLP265MB3505AF01E9516596CA84782DAEF99@CWLP265MB3505.GBRP265.PROD.OUTLOOK.COM>

A frequent cause of such errors is that in the offending scenario a method is not visible, so the call goes directly to the default method. This often can be verified by temporarily printing something from your method when it gets control.

Without more details it is difficult to be more specific. It may be a missing import or export, for example.

Georgi Boshnakov


Get Outlook for Android<https://aka.ms/AAb9ysg>

________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Duncan Murdoch <murdoch.duncan at gmail.com>
Sent: Sunday, 8 January 2023, 10:05
To: Kevin R. Coombes <kevin.r.coombes at gmail.com>; R Package Development <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] Mysterious "invalid z limit"

On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
> Hi,
>
> I am in the middle of developing a new package, which contains a
> markdown-knitr-html vignette. When I try to run
>
> R CMD build [mypackagedirectory]
>
> I get an error message
>
> Quitting from lines 330-336
> Error: processing vignette  failed with diagnostics:
> invalid z limits
>
> If I run the same markdown script interactively inside R Studio, there
> is no error.
> If I knit the markdown script inside R Studio, it produces the correct
> HTML output, with no error.
>
> The offending lines of code (the chunk at 330-336) invoke an "image"
> method on an object of a class defined in the package, which in turn
> computes a matrix from items inside the object and calls image.default,
> which is presumably where the error is coming from.
>
> Two questions: (1) How is it possible that the same code works error
> free in the RStudio contexts, but fails in the attempt to build the package?
> (2) Any suggestions on how to debug something that only throws an error
> from "R CMD build" would be most welcome.

Debugging that sort of thing is hard.  Here's what I would try:

 From inside an R session, run

   tools:::.build_packages("[mypackagedirectory]")

That runs the code that R CMD build runs, so it might trigger the same
error.  If so, debug in the usual way, with traceback(), etc.

If that doesn't trigger the error, try it using a different front-end,
e.g. running R at the command line instead of running it in RStudio.

If you still can't trigger it, then start modifying the vignette to find
the exact line that causes the error (e.g. by commenting out the second
half of the code in that chunk; did the error go away? etc.).  Then
modify it again to save all the inputs to the bad line in a file before
running it, and see if running that line in a different context still
triggers the error. Etc.

Duncan Murdoch

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Sun Jan  8 12:58:30 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sun, 8 Jan 2023 14:58:30 +0300
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
Message-ID: <20230108145830.5ad85981@Tarkus>

On Sat, 7 Jan 2023 20:43:10 -0500
"Kevin R. Coombes" <kevin.r.coombes at gmail.com> wrote:

> (1) How is it possible that the same code works error 
> free in the RStudio contexts, but fails in the attempt to build the
> package?

When knitting the vignette from RStudio, it uses the package you
already have installed. When knitting the vignette from R CMD build, it
uses the code it's about to package. Could it be that your source code
is different from the copy installed in your library?

> (2) Any suggestions on how to debug something that only
> throws an error from "R CMD build" would be most welcome.

R CMD build --no-build-vignettes should let you proceed and get a
tarball that could be installed. Hopefully you'll be able to reproduce
the error then.

-- 
Best regards,
Ivan


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sun Jan  8 16:00:30 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Sun, 8 Jan 2023 10:00:30 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <20230108145830.5ad85981@Tarkus>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <20230108145830.5ad85981@Tarkus>
Message-ID: <a92eb547-f448-2ae3-fd46-cfd05f8c1b6f@gmail.com>

A terrific answer; thanks. (I am kicking myself for not realizing the 
answer you gave to question 1. Of course that's the explanation. Too 
many consecutive hours debugging other items to get to that point, I 
suppose.)
 ? Kevin

On 1/8/2023 6:58 AM, Ivan Krylov wrote:
> On Sat, 7 Jan 2023 20:43:10 -0500
> "Kevin R. Coombes" <kevin.r.coombes at gmail.com> wrote:
>
>> (1) How is it possible that the same code works error
>> free in the RStudio contexts, but fails in the attempt to build the
>> package?
> When knitting the vignette from RStudio, it uses the package you
> already have installed. When knitting the vignette from R CMD build, it
> uses the code it's about to package. Could it be that your source code
> is different from the copy installed in your library?
>
>> (2) Any suggestions on how to debug something that only
>> throws an error from "R CMD build" would be most welcome.
> R CMD build --no-build-vignettes should let you proceed and get a
> tarball that could be installed. Hopefully you'll be able to reproduce
> the error then.
>


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sun Jan  8 16:11:41 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Sun, 8 Jan 2023 10:11:41 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
Message-ID: <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>

A very helpful answer. For some reason (probably because I have an 
ancient perl script that automates the steps i take when building and 
checking packages), I keep forgetting that the "tools" package let's me 
do these things from within R.

I had already isolated the offending line ("plot(obj)") inside the chunk 
where the error occurred, and removed any additional arguments. I 
wrapped that line in a "try" command followed by a conditional 
"traceback()" to find the problem.? This allowed the package build to 
knit the vignette and provide some feedback about what was going on. It 
turned out that I had copied and pasted an assignment line of the form

main <- [compute the title]

from earlier in the code and pasted it directly as an argument to the 
call to image.default. And R did exactly what I told it to (not 
surprisingly), and interpreted the value of that assignment as the 
unnamed "zlim" option that would have been the corresponding positional 
argument that should have been there.

And yes, I still use "left arrow" <- instead of equals = as assignments. 
(Heck, I even use emacs and ESS with a leftover keybinding that uses the 
underscore key to insert the left arrow. Apparently, I'm ancient myself.)

 ? Kevin

On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
>> Hi,
>>
>> I am in the middle of developing a new package, which contains a
>> markdown-knitr-html vignette. When I try to run
>>
>> R CMD build [mypackagedirectory]
>>
>> I get an error message
>>
>> Quitting from lines 330-336
>> Error: processing vignette? failed with diagnostics:
>> invalid z limits
>>
>> If I run the same markdown script interactively inside R Studio, there
>> is no error.
>> If I knit the markdown script inside R Studio, it produces the correct
>> HTML output, with no error.
>>
>> The offending lines of code (the chunk at 330-336) invoke an "image"
>> method on an object of a class defined in the package, which in turn
>> computes a matrix from items inside the object and calls image.default,
>> which is presumably where the error is coming from.
>>
>> Two questions: (1) How is it possible that the same code works error
>> free in the RStudio contexts, but fails in the attempt to build the 
>> package?
>> (2) Any suggestions on how to debug something that only throws an error
>> from "R CMD build" would be most welcome.
>
> Debugging that sort of thing is hard.? Here's what I would try:
>
> From inside an R session, run
>
> ? tools:::.build_packages("[mypackagedirectory]")
>
> That runs the code that R CMD build runs, so it might trigger the same 
> error.? If so, debug in the usual way, with traceback(), etc.
>
> If that doesn't trigger the error, try it using a different front-end, 
> e.g. running R at the command line instead of running it in RStudio.
>
> If you still can't trigger it, then start modifying the vignette to 
> find the exact line that causes the error (e.g. by commenting out the 
> second half of the code in that chunk; did the error go away? etc.).? 
> Then modify it again to save all the inputs to the bad line in a file 
> before running it, and see if running that line in a different context 
> still triggers the error. Etc.
>
> Duncan Murdoch


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun Jan  8 17:30:32 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 8 Jan 2023 10:30:32 -0600
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
Message-ID: <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>

	  If you use GitHub, I highly recommend using "GitHub Action" as 
described by Wickham and Bryan, R Packages:


https://r-pkgs.org/code.html#code-style


	  I'm not sure the best way to get it set up, but I have all my 
packages on GitHub configured so each "push" that changes anything has 
"R CMD Check" run on 5 different platforms:  The release version of R on 
the latest Windows, macOS, and Ubuntu plus the development version and 
the most recent old release on Ubuntu.  I rarely run R CMD check on my 
local machine anymore:  I just "git commit" and "git push".  Then GitHub 
Action manages testing on those 5 platforms.


	  To be precise, I do "git status" before "git push" to make sure I 
have "committed" everything I want to commit before I "git push".  And I 
do "git pull" to make sure a collaborator hasn't "pushed" something new 
I should look at before I "git push".


	  Finally, I want to thank again G?bor Cs?rdi who helped me greatly get 
past problems I hand with "GitHub Action" for my "sos" package.  He 
provided example workflows in:


https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml


	  I also needed LaTeX support, for which G?bor suggested the following:


https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages


	  Spencer Graves
	

On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
> A very helpful answer. For some reason (probably because I have an 
> ancient perl script that automates the steps i take when building and 
> checking packages), I keep forgetting that the "tools" package let's me 
> do these things from within R.
> 
> I had already isolated the offending line ("plot(obj)") inside the chunk 
> where the error occurred, and removed any additional arguments. I 
> wrapped that line in a "try" command followed by a conditional 
> "traceback()" to find the problem.? This allowed the package build to 
> knit the vignette and provide some feedback about what was going on. It 
> turned out that I had copied and pasted an assignment line of the form
> 
> main <- [compute the title]
> 
> from earlier in the code and pasted it directly as an argument to the 
> call to image.default. And R did exactly what I told it to (not 
> surprisingly), and interpreted the value of that assignment as the 
> unnamed "zlim" option that would have been the corresponding positional 
> argument that should have been there.
> 
> And yes, I still use "left arrow" <- instead of equals = as assignments. 
> (Heck, I even use emacs and ESS with a leftover keybinding that uses the 
> underscore key to insert the left arrow. Apparently, I'm ancient myself.)
> 
>  ? Kevin
> 
> On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
>> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
>>> Hi,
>>>
>>> I am in the middle of developing a new package, which contains a
>>> markdown-knitr-html vignette. When I try to run
>>>
>>> R CMD build [mypackagedirectory]
>>>
>>> I get an error message
>>>
>>> Quitting from lines 330-336
>>> Error: processing vignette? failed with diagnostics:
>>> invalid z limits
>>>
>>> If I run the same markdown script interactively inside R Studio, there
>>> is no error.
>>> If I knit the markdown script inside R Studio, it produces the correct
>>> HTML output, with no error.
>>>
>>> The offending lines of code (the chunk at 330-336) invoke an "image"
>>> method on an object of a class defined in the package, which in turn
>>> computes a matrix from items inside the object and calls image.default,
>>> which is presumably where the error is coming from.
>>>
>>> Two questions: (1) How is it possible that the same code works error
>>> free in the RStudio contexts, but fails in the attempt to build the 
>>> package?
>>> (2) Any suggestions on how to debug something that only throws an error
>>> from "R CMD build" would be most welcome.
>>
>> Debugging that sort of thing is hard.? Here's what I would try:
>>
>> From inside an R session, run
>>
>> ? tools:::.build_packages("[mypackagedirectory]")
>>
>> That runs the code that R CMD build runs, so it might trigger the same 
>> error.? If so, debug in the usual way, with traceback(), etc.
>>
>> If that doesn't trigger the error, try it using a different front-end, 
>> e.g. running R at the command line instead of running it in RStudio.
>>
>> If you still can't trigger it, then start modifying the vignette to 
>> find the exact line that causes the error (e.g. by commenting out the 
>> second half of the code in that chunk; did the error go away? etc.). 
>> Then modify it again to save all the inputs to the bad line in a file 
>> before running it, and see if running that line in a different context 
>> still triggers the error. Etc.
>>
>> Duncan Murdoch
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sun Jan  8 18:36:02 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin Coombes)
Date: Sun, 8 Jan 2023 12:36:02 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
Message-ID: <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>

I have been using R-Forge for many years for package development. And I
have been using GitLab for other projects almost as long.

However, over the past few months, the R-Forge support seems to be
decaying, and I now have several projects that won't currently build there
because of various items that appear to need fixing at their end. So, I am
actively exploring what it will take to move packages and projects to git.

I already know how to use a git client to clone a Subversion repository
from R-Forge (using "git svn"). And how to change the remote origin to push
it to a new git location. (And I  may also be willing to lose the revision
history if it is going to make the transition easier.)

I am now at the step of understanding the recent changes at GitLab with
respect to support for "Educational" or "Open Source" status, especially in
terms of how many monthly minutes of CI/CD time I can use for free. When
working on a new package, I tend to make lots of small commit-pushes, and
it sounds like each one of those will eat up minutes. So, any advice on how
to manage that issue would be greatly appreciated.

Best,
  Kevin

On Sun, Jan 8, 2023, 11:30 AM Spencer Graves <
spencer.graves at effectivedefense.org> wrote:

>           If you use GitHub, I highly recommend using "GitHub Action" as
> described by Wickham and Bryan, R Packages:
>
>
> https://r-pkgs.org/code.html#code-style
>
>
>           I'm not sure the best way to get it set up, but I have all my
> packages on GitHub configured so each "push" that changes anything has
> "R CMD Check" run on 5 different platforms:  The release version of R on
> the latest Windows, macOS, and Ubuntu plus the development version and
> the most recent old release on Ubuntu.  I rarely run R CMD check on my
> local machine anymore:  I just "git commit" and "git push".  Then GitHub
> Action manages testing on those 5 platforms.
>
>
>           To be precise, I do "git status" before "git push" to make sure
> I
> have "committed" everything I want to commit before I "git push".  And I
> do "git pull" to make sure a collaborator hasn't "pushed" something new
> I should look at before I "git push".
>
>
>           Finally, I want to thank again G?bor Cs?rdi who helped me
> greatly get
> past problems I hand with "GitHub Action" for my "sos" package.  He
> provided example workflows in:
>
>
>
> https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml
>
>
>           I also needed LaTeX support, for which G?bor suggested the
> following:
>
>
> https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages
>
>
>           Spencer Graves
>
>
> On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
> > A very helpful answer. For some reason (probably because I have an
> > ancient perl script that automates the steps i take when building and
> > checking packages), I keep forgetting that the "tools" package let's me
> > do these things from within R.
> >
> > I had already isolated the offending line ("plot(obj)") inside the chunk
> > where the error occurred, and removed any additional arguments. I
> > wrapped that line in a "try" command followed by a conditional
> > "traceback()" to find the problem.  This allowed the package build to
> > knit the vignette and provide some feedback about what was going on. It
> > turned out that I had copied and pasted an assignment line of the form
> >
> > main <- [compute the title]
> >
> > from earlier in the code and pasted it directly as an argument to the
> > call to image.default. And R did exactly what I told it to (not
> > surprisingly), and interpreted the value of that assignment as the
> > unnamed "zlim" option that would have been the corresponding positional
> > argument that should have been there.
> >
> > And yes, I still use "left arrow" <- instead of equals = as assignments.
> > (Heck, I even use emacs and ESS with a leftover keybinding that uses the
> > underscore key to insert the left arrow. Apparently, I'm ancient myself.)
> >
> >    Kevin
> >
> > On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
> >> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
> >>> Hi,
> >>>
> >>> I am in the middle of developing a new package, which contains a
> >>> markdown-knitr-html vignette. When I try to run
> >>>
> >>> R CMD build [mypackagedirectory]
> >>>
> >>> I get an error message
> >>>
> >>> Quitting from lines 330-336
> >>> Error: processing vignette  failed with diagnostics:
> >>> invalid z limits
> >>>
> >>> If I run the same markdown script interactively inside R Studio, there
> >>> is no error.
> >>> If I knit the markdown script inside R Studio, it produces the correct
> >>> HTML output, with no error.
> >>>
> >>> The offending lines of code (the chunk at 330-336) invoke an "image"
> >>> method on an object of a class defined in the package, which in turn
> >>> computes a matrix from items inside the object and calls image.default,
> >>> which is presumably where the error is coming from.
> >>>
> >>> Two questions: (1) How is it possible that the same code works error
> >>> free in the RStudio contexts, but fails in the attempt to build the
> >>> package?
> >>> (2) Any suggestions on how to debug something that only throws an error
> >>> from "R CMD build" would be most welcome.
> >>
> >> Debugging that sort of thing is hard.  Here's what I would try:
> >>
> >> From inside an R session, run
> >>
> >>   tools:::.build_packages("[mypackagedirectory]")
> >>
> >> That runs the code that R CMD build runs, so it might trigger the same
> >> error.  If so, debug in the usual way, with traceback(), etc.
> >>
> >> If that doesn't trigger the error, try it using a different front-end,
> >> e.g. running R at the command line instead of running it in RStudio.
> >>
> >> If you still can't trigger it, then start modifying the vignette to
> >> find the exact line that causes the error (e.g. by commenting out the
> >> second half of the code in that chunk; did the error go away? etc.).
> >> Then modify it again to save all the inputs to the bad line in a file
> >> before running it, and see if running that line in a different context
> >> still triggers the error. Etc.
> >>
> >> Duncan Murdoch
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun Jan  8 19:38:58 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 8 Jan 2023 12:38:58 -0600
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
 <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
Message-ID: <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>



On 1/8/23 11:36 AM, Kevin Coombes wrote:
> I have been using R-Forge for many years for package development. And I 
> have been using GitLab for other projects almost as long.
> 
> However, over the past few months, the R-Forge support seems to be 
> decaying, and I now have several projects that won't currently build 
> there because of various items that appear to need fixing at their end. 
> So, I am actively exploring what it will take to move packages and 
> projects to git.


	  R-Forge was wonderful for me when I started using it.  Then several 
years ago, I started having problems like you described.  A few years 
ago I migrated from R-Forge to GitHub.


	  One problem I encountered in the transition:  On R-Forge, I had 
multiple packages in the same R-Forge project.  I had to split them 
apart for GitHub.

> 
> I already know how to use a git client to clone a Subversion repository 
> from R-Forge (using "git svn"). And how to change the remote origin to 
> push it to a new git location. (And I? may also be willing to lose the 
> revision history if it is going to make the transition easier.)
> 
> I am now at the step of understanding the recent changes at GitLab with 
> respect to support for "Educational" or "Open Source" status, especially 
> in terms of how many monthly minutes of CI/CD time I can use for free. 
> When working on a new package, I tend to make lots of small 
> commit-pushes, and it sounds like each one of those will eat up minutes. 
> So, any advice on how to manage that issue?would be greatly appreciated.


	  When I first got into Subversion, I remember Doug Bates saying, 
"Commit early and often."  The word "Commit" doesn't mean the same in 
Git as in Subversion, so I would encourage you to "Git push early and 
often."


	  There may be limits on free use of GitHub, but I'm not aware of them: 
  If you want a private account, you need to pay for that, but the 
charges for that are not much.


	  If anyone knows anything different from what I've just said, I hope 
they will disabuse my of this part of my ignorance.


	  Spencer

> 
> Best,
>  ? Kevin
> 
> On Sun, Jan 8, 2023, 11:30 AM Spencer Graves 
> <spencer.graves at effectivedefense.org 
> <mailto:spencer.graves at effectivedefense.org>> wrote:
> 
>      ? ? ? ? ? If you use GitHub, I highly recommend using "GitHub
>     Action" as
>     described by Wickham and Bryan, R Packages:
> 
> 
>     https://r-pkgs.org/code.html#code-style
>     <https://r-pkgs.org/code.html#code-style>
> 
> 
>      ? ? ? ? ? I'm not sure the best way to get it set up, but I have
>     all my
>     packages on GitHub configured so each "push" that changes anything has
>     "R CMD Check" run on 5 different platforms:? The release version of
>     R on
>     the latest Windows, macOS, and Ubuntu plus the development version and
>     the most recent old release on Ubuntu.? I rarely run R CMD check on my
>     local machine anymore:? I just "git commit" and "git push".? Then
>     GitHub
>     Action manages testing on those 5 platforms.
> 
> 
>      ? ? ? ? ? To be precise, I do "git status" before "git push" to
>     make sure I
>     have "committed" everything I want to commit before I "git push". 
>     And I
>     do "git pull" to make sure a collaborator hasn't "pushed" something new
>     I should look at before I "git push".
> 
> 
>      ? ? ? ? ? Finally, I want to thank again G?bor Cs?rdi who helped me
>     greatly get
>     past problems I hand with "GitHub Action" for my "sos" package.? He
>     provided example workflows in:
> 
> 
>     https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml <https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml>
> 
> 
>      ? ? ? ? ? I also needed LaTeX support, for which G?bor suggested
>     the following:
> 
> 
>     https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages
>     <https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages>
> 
> 
>      ? ? ? ? ? Spencer Graves
> 
> 
>     On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
>      > A very helpful answer. For some reason (probably because I have an
>      > ancient perl script that automates the steps i take when building
>     and
>      > checking packages), I keep forgetting that the "tools" package
>     let's me
>      > do these things from within R.
>      >
>      > I had already isolated the offending line ("plot(obj)") inside
>     the chunk
>      > where the error occurred, and removed any additional arguments. I
>      > wrapped that line in a "try" command followed by a conditional
>      > "traceback()" to find the problem.? This allowed the package
>     build to
>      > knit the vignette and provide some feedback about what was going
>     on. It
>      > turned out that I had copied and pasted an assignment line of the
>     form
>      >
>      > main <- [compute the title]
>      >
>      > from earlier in the code and pasted it directly as an argument to
>     the
>      > call to image.default. And R did exactly what I told it to (not
>      > surprisingly), and interpreted the value of that assignment as the
>      > unnamed "zlim" option that would have been the corresponding
>     positional
>      > argument that should have been there.
>      >
>      > And yes, I still use "left arrow" <- instead of equals = as
>     assignments.
>      > (Heck, I even use emacs and ESS with a leftover keybinding that
>     uses the
>      > underscore key to insert the left arrow. Apparently, I'm ancient
>     myself.)
>      >
>      >? ? Kevin
>      >
>      > On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
>      >> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
>      >>> Hi,
>      >>>
>      >>> I am in the middle of developing a new package, which contains a
>      >>> markdown-knitr-html vignette. When I try to run
>      >>>
>      >>> R CMD build [mypackagedirectory]
>      >>>
>      >>> I get an error message
>      >>>
>      >>> Quitting from lines 330-336
>      >>> Error: processing vignette? failed with diagnostics:
>      >>> invalid z limits
>      >>>
>      >>> If I run the same markdown script interactively inside R
>     Studio, there
>      >>> is no error.
>      >>> If I knit the markdown script inside R Studio, it produces the
>     correct
>      >>> HTML output, with no error.
>      >>>
>      >>> The offending lines of code (the chunk at 330-336) invoke an
>     "image"
>      >>> method on an object of a class defined in the package, which in
>     turn
>      >>> computes a matrix from items inside the object and calls
>     image.default,
>      >>> which is presumably where the error is coming from.
>      >>>
>      >>> Two questions: (1) How is it possible that the same code works
>     error
>      >>> free in the RStudio contexts, but fails in the attempt to build
>     the
>      >>> package?
>      >>> (2) Any suggestions on how to debug something that only throws
>     an error
>      >>> from "R CMD build" would be most welcome.
>      >>
>      >> Debugging that sort of thing is hard.? Here's what I would try:
>      >>
>      >> From inside an R session, run
>      >>
>      >> ? tools:::.build_packages("[mypackagedirectory]")
>      >>
>      >> That runs the code that R CMD build runs, so it might trigger
>     the same
>      >> error.? If so, debug in the usual way, with traceback(), etc.
>      >>
>      >> If that doesn't trigger the error, try it using a different
>     front-end,
>      >> e.g. running R at the command line instead of running it in RStudio.
>      >>
>      >> If you still can't trigger it, then start modifying the vignette to
>      >> find the exact line that causes the error (e.g. by commenting
>     out the
>      >> second half of the code in that chunk; did the error go away?
>     etc.).
>      >> Then modify it again to save all the inputs to the bad line in a
>     file
>      >> before running it, and see if running that line in a different
>     context
>      >> still triggers the error. Etc.
>      >>
>      >> Duncan Murdoch
>      >
>      > ______________________________________________
>      > R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org> mailing list
>      > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>


From bbo|ker @end|ng |rom gm@||@com  Sun Jan  8 19:52:57 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 8 Jan 2023 13:52:57 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
 <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
 <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
Message-ID: <70be627e-93ae-05db-3377-5c229faff736@gmail.com>



On 2023-01-08 1:38 p.m., Spencer Graves wrote:
> 
> 
> On 1/8/23 11:36 AM, Kevin Coombes wrote:
>> I have been using R-Forge for many years for package development. And 
>> I have been using GitLab for other projects almost as long.
>>
>> However, over the past few months, the R-Forge support seems to be 
>> decaying, and I now have several projects that won't currently build 
>> there because of various items that appear to need fixing at their 
>> end. So, I am actively exploring what it will take to move packages 
>> and projects to git.
> 
> 
>  ????? R-Forge was wonderful for me when I started using it.? Then 
> several years ago, I started having problems like you described.? A few 
> years ago I migrated from R-Forge to GitHub.
> 
> 
>  ????? One problem I encountered in the transition:? On R-Forge, I had 
> multiple packages in the same R-Forge project.? I had to split them 
> apart for GitHub.
> 
>>
>> I already know how to use a git client to clone a Subversion 
>> repository from R-Forge (using "git svn"). And how to change the 
>> remote origin to push it to a new git location. (And I? may also be 
>> willing to lose the revision history if it is going to make the 
>> transition easier.)
>>
>> I am now at the step of understanding the recent changes at GitLab 
>> with respect to support for "Educational" or "Open Source" status, 
>> especially in terms of how many monthly minutes of CI/CD time I can 
>> use for free. When working on a new package, I tend to make lots of 
>> small commit-pushes, and it sounds like each one of those will eat up 
>> minutes. So, any advice on how to manage that issue?would be greatly 
>> appreciated.
> 
> 
>  ????? When I first got into Subversion, I remember Doug Bates saying, 
> "Commit early and often."? The word "Commit" doesn't mean the same in 
> Git as in Subversion, so I would encourage you to "Git push early and 
> often."
> 
> 
>  ????? There may be limits on free use of GitHub, but I'm not aware of 
> them: ?If you want a private account, you need to pay for that, but the 
> charges for that are not much.

   The free tier of Github allows 2000 minutes/month of continuous 
integration testing for private repos, and unlimited (???) for public 
repos.  (2000 minutes/month is more than I've ever needed.)

   Furthermore, it's pretty easy to set up github actions so that it 
only runs tests if you ask it to (by appending e.g. "[run ci]" to your 
commit message), or in opt-out mode (i.e., skip tests if "[skip ci]" is 
in your commit message).

> 
> 
>  ????? If anyone knows anything different from what I've just said, I 
> hope they will disabuse my of this part of my ignorance.
> 
> 
>  ????? Spencer
> 
>>
>> Best,
>> ?? Kevin
>>
>> On Sun, Jan 8, 2023, 11:30 AM Spencer Graves 
>> <spencer.graves at effectivedefense.org 
>> <mailto:spencer.graves at effectivedefense.org>> wrote:
>>
>> ???? ? ? ? ? ? If you use GitHub, I highly recommend using "GitHub
>> ??? Action" as
>> ??? described by Wickham and Bryan, R Packages:
>>
>>
>> ??? https://r-pkgs.org/code.html#code-style
>> ??? <https://r-pkgs.org/code.html#code-style>
>>
>>
>> ???? ? ? ? ? ? I'm not sure the best way to get it set up, but I have
>> ??? all my
>> ??? packages on GitHub configured so each "push" that changes anything 
>> has
>> ??? "R CMD Check" run on 5 different platforms:? The release version of
>> ??? R on
>> ??? the latest Windows, macOS, and Ubuntu plus the development version 
>> and
>> ??? the most recent old release on Ubuntu.? I rarely run R CMD check 
>> on my
>> ??? local machine anymore:? I just "git commit" and "git push".? Then
>> ??? GitHub
>> ??? Action manages testing on those 5 platforms.
>>
>>
>> ???? ? ? ? ? ? To be precise, I do "git status" before "git push" to
>> ??? make sure I
>> ??? have "committed" everything I want to commit before I "git push". 
>> ??? And I
>> ??? do "git pull" to make sure a collaborator hasn't "pushed" 
>> something new
>> ??? I should look at before I "git push".
>>
>>
>> ???? ? ? ? ? ? Finally, I want to thank again G?bor Cs?rdi who helped me
>> ??? greatly get
>> ??? past problems I hand with "GitHub Action" for my "sos" package.? He
>> ??? provided example workflows in:
>>
>>
>>     
>> https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml <https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml>
>>
>>
>> ???? ? ? ? ? ? I also needed LaTeX support, for which G?bor suggested
>> ??? the following:
>>
>>
>> ??? https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages
>>     
>> <https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages>
>>
>>
>> ???? ? ? ? ? ? Spencer Graves
>>
>>
>> ??? On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
>> ???? > A very helpful answer. For some reason (probably because I have an
>> ???? > ancient perl script that automates the steps i take when building
>> ??? and
>> ???? > checking packages), I keep forgetting that the "tools" package
>> ??? let's me
>> ???? > do these things from within R.
>> ???? >
>> ???? > I had already isolated the offending line ("plot(obj)") inside
>> ??? the chunk
>> ???? > where the error occurred, and removed any additional arguments. I
>> ???? > wrapped that line in a "try" command followed by a conditional
>> ???? > "traceback()" to find the problem.? This allowed the package
>> ??? build to
>> ???? > knit the vignette and provide some feedback about what was going
>> ??? on. It
>> ???? > turned out that I had copied and pasted an assignment line of the
>> ??? form
>> ???? >
>> ???? > main <- [compute the title]
>> ???? >
>> ???? > from earlier in the code and pasted it directly as an argument to
>> ??? the
>> ???? > call to image.default. And R did exactly what I told it to (not
>> ???? > surprisingly), and interpreted the value of that assignment as the
>> ???? > unnamed "zlim" option that would have been the corresponding
>> ??? positional
>> ???? > argument that should have been there.
>> ???? >
>> ???? > And yes, I still use "left arrow" <- instead of equals = as
>> ??? assignments.
>> ???? > (Heck, I even use emacs and ESS with a leftover keybinding that
>> ??? uses the
>> ???? > underscore key to insert the left arrow. Apparently, I'm ancient
>> ??? myself.)
>> ???? >
>> ???? >? ? Kevin
>> ???? >
>> ???? > On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
>> ???? >> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
>> ???? >>> Hi,
>> ???? >>>
>> ???? >>> I am in the middle of developing a new package, which contains a
>> ???? >>> markdown-knitr-html vignette. When I try to run
>> ???? >>>
>> ???? >>> R CMD build [mypackagedirectory]
>> ???? >>>
>> ???? >>> I get an error message
>> ???? >>>
>> ???? >>> Quitting from lines 330-336
>> ???? >>> Error: processing vignette? failed with diagnostics:
>> ???? >>> invalid z limits
>> ???? >>>
>> ???? >>> If I run the same markdown script interactively inside R
>> ??? Studio, there
>> ???? >>> is no error.
>> ???? >>> If I knit the markdown script inside R Studio, it produces the
>> ??? correct
>> ???? >>> HTML output, with no error.
>> ???? >>>
>> ???? >>> The offending lines of code (the chunk at 330-336) invoke an
>> ??? "image"
>> ???? >>> method on an object of a class defined in the package, which in
>> ??? turn
>> ???? >>> computes a matrix from items inside the object and calls
>> ??? image.default,
>> ???? >>> which is presumably where the error is coming from.
>> ???? >>>
>> ???? >>> Two questions: (1) How is it possible that the same code works
>> ??? error
>> ???? >>> free in the RStudio contexts, but fails in the attempt to build
>> ??? the
>> ???? >>> package?
>> ???? >>> (2) Any suggestions on how to debug something that only throws
>> ??? an error
>> ???? >>> from "R CMD build" would be most welcome.
>> ???? >>
>> ???? >> Debugging that sort of thing is hard.? Here's what I would try:
>> ???? >>
>> ???? >> From inside an R session, run
>> ???? >>
>> ???? >> ? tools:::.build_packages("[mypackagedirectory]")
>> ???? >>
>> ???? >> That runs the code that R CMD build runs, so it might trigger
>> ??? the same
>> ???? >> error.? If so, debug in the usual way, with traceback(), etc.
>> ???? >>
>> ???? >> If that doesn't trigger the error, try it using a different
>> ??? front-end,
>> ???? >> e.g. running R at the command line instead of running it in 
>> RStudio.
>> ???? >>
>> ???? >> If you still can't trigger it, then start modifying the 
>> vignette to
>> ???? >> find the exact line that causes the error (e.g. by commenting
>> ??? out the
>> ???? >> second half of the code in that chunk; did the error go away?
>> ??? etc.).
>> ???? >> Then modify it again to save all the inputs to the bad line in a
>> ??? file
>> ???? >> before running it, and see if running that line in a different
>> ??? context
>> ???? >> still triggers the error. Etc.
>> ???? >>
>> ???? >> Duncan Murdoch
>> ???? >
>> ???? > ______________________________________________
>> ???? > R-package-devel at r-project.org
>> ??? <mailto:R-package-devel at r-project.org> mailing list
>> ???? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> ??? <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From w||||@m@becker @end|ng |rom b|ue|oxd@t@@eu  Mon Jan  9 10:28:18 2023
From: w||||@m@becker @end|ng |rom b|ue|oxd@t@@eu (William Becker)
Date: Mon, 9 Jan 2023 10:28:18 +0100 (CET)
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <70be627e-93ae-05db-3377-5c229faff736@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
 <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
 <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
 <70be627e-93ae-05db-3377-5c229faff736@gmail.com>
Message-ID: <1635330386.1430908.1673256498618@privateemail.com>

Thanks for mentioning the possibility to opt out of the CMD checks on GitHub actions, which I didn't know about before. I also have GHA set up and I like the concept of automated testing, but one thing that bothers me is that sometimes I make a small but necessary commit (e.g. to fix a bug) and it runs the whole suite of tests and checks on all functions which takes around five minutes. Most of the time this is overkill and it occurs to me that it has an unnecessary environmental impact. Perhaps this is something to think about occasionally in our CI/CD setups.

So now I'm off to tweak my GitHub actions...

> On 08/01/2023 19:52 CET Ben Bolker <bbolker at gmail.com> wrote:
> 
>  
> On 2023-01-08 1:38 p.m., Spencer Graves wrote:
> > 
> > 
> > On 1/8/23 11:36 AM, Kevin Coombes wrote:
> >> I have been using R-Forge for many years for package development. And 
> >> I have been using GitLab for other projects almost as long.
> >>
> >> However, over the past few months, the R-Forge support seems to be 
> >> decaying, and I now have several projects that won't currently build 
> >> there because of various items that appear to need fixing at their 
> >> end. So, I am actively exploring what it will take to move packages 
> >> and projects to git.
> > 
> > 
> >  ????? R-Forge was wonderful for me when I started using it.? Then 
> > several years ago, I started having problems like you described.? A few 
> > years ago I migrated from R-Forge to GitHub.
> > 
> > 
> >  ????? One problem I encountered in the transition:? On R-Forge, I had 
> > multiple packages in the same R-Forge project.? I had to split them 
> > apart for GitHub.
> > 
> >>
> >> I already know how to use a git client to clone a Subversion 
> >> repository from R-Forge (using "git svn"). And how to change the 
> >> remote origin to push it to a new git location. (And I? may also be 
> >> willing to lose the revision history if it is going to make the 
> >> transition easier.)
> >>
> >> I am now at the step of understanding the recent changes at GitLab 
> >> with respect to support for "Educational" or "Open Source" status, 
> >> especially in terms of how many monthly minutes of CI/CD time I can 
> >> use for free. When working on a new package, I tend to make lots of 
> >> small commit-pushes, and it sounds like each one of those will eat up 
> >> minutes. So, any advice on how to manage that issue?would be greatly 
> >> appreciated.
> > 
> > 
> >  ????? When I first got into Subversion, I remember Doug Bates saying, 
> > "Commit early and often."? The word "Commit" doesn't mean the same in 
> > Git as in Subversion, so I would encourage you to "Git push early and 
> > often."
> > 
> > 
> >  ????? There may be limits on free use of GitHub, but I'm not aware of 
> > them: ?If you want a private account, you need to pay for that, but the 
> > charges for that are not much.
> 
>    The free tier of Github allows 2000 minutes/month of continuous 
> integration testing for private repos, and unlimited (???) for public 
> repos.  (2000 minutes/month is more than I've ever needed.)
> 
>    Furthermore, it's pretty easy to set up github actions so that it 
> only runs tests if you ask it to (by appending e.g. "[run ci]" to your 
> commit message), or in opt-out mode (i.e., skip tests if "[skip ci]" is 
> in your commit message).
> 
> > 
> > 
> >  ????? If anyone knows anything different from what I've just said, I 
> > hope they will disabuse my of this part of my ignorance.
> > 
> > 
> >  ????? Spencer
> > 
> >>
> >> Best,
> >> ?? Kevin
> >>
> >> On Sun, Jan 8, 2023, 11:30 AM Spencer Graves 
> >> <spencer.graves at effectivedefense.org 
> >> <mailto:spencer.graves at effectivedefense.org>> wrote:
> >>
> >> ???? ? ? ? ? ? If you use GitHub, I highly recommend using "GitHub
> >> ??? Action" as
> >> ??? described by Wickham and Bryan, R Packages:
> >>
> >>
> >> ??? https://r-pkgs.org/code.html#code-style
> >> ??? <https://r-pkgs.org/code.html#code-style>
> >>
> >>
> >> ???? ? ? ? ? ? I'm not sure the best way to get it set up, but I have
> >> ??? all my
> >> ??? packages on GitHub configured so each "push" that changes anything 
> >> has
> >> ??? "R CMD Check" run on 5 different platforms:? The release version of
> >> ??? R on
> >> ??? the latest Windows, macOS, and Ubuntu plus the development version 
> >> and
> >> ??? the most recent old release on Ubuntu.? I rarely run R CMD check 
> >> on my
> >> ??? local machine anymore:? I just "git commit" and "git push".? Then
> >> ??? GitHub
> >> ??? Action manages testing on those 5 platforms.
> >>
> >>
> >> ???? ? ? ? ? ? To be precise, I do "git status" before "git push" to
> >> ??? make sure I
> >> ??? have "committed" everything I want to commit before I "git push". 
> >> ??? And I
> >> ??? do "git pull" to make sure a collaborator hasn't "pushed" 
> >> something new
> >> ??? I should look at before I "git push".
> >>
> >>
> >> ???? ? ? ? ? ? Finally, I want to thank again G?bor Cs?rdi who helped me
> >> ??? greatly get
> >> ??? past problems I hand with "GitHub Action" for my "sos" package.? He
> >> ??? provided example workflows in:
> >>
> >>
> >>     
> >> https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml <https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml>
> >>
> >>
> >> ???? ? ? ? ? ? I also needed LaTeX support, for which G?bor suggested
> >> ??? the following:
> >>
> >>
> >> ??? https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages
> >>     
> >> <https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages>
> >>
> >>
> >> ???? ? ? ? ? ? Spencer Graves
> >>
> >>
> >> ??? On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
> >> ???? > A very helpful answer. For some reason (probably because I have an
> >> ???? > ancient perl script that automates the steps i take when building
> >> ??? and
> >> ???? > checking packages), I keep forgetting that the "tools" package
> >> ??? let's me
> >> ???? > do these things from within R.
> >> ???? >
> >> ???? > I had already isolated the offending line ("plot(obj)") inside
> >> ??? the chunk
> >> ???? > where the error occurred, and removed any additional arguments. I
> >> ???? > wrapped that line in a "try" command followed by a conditional
> >> ???? > "traceback()" to find the problem.? This allowed the package
> >> ??? build to
> >> ???? > knit the vignette and provide some feedback about what was going
> >> ??? on. It
> >> ???? > turned out that I had copied and pasted an assignment line of the
> >> ??? form
> >> ???? >
> >> ???? > main <- [compute the title]
> >> ???? >
> >> ???? > from earlier in the code and pasted it directly as an argument to
> >> ??? the
> >> ???? > call to image.default. And R did exactly what I told it to (not
> >> ???? > surprisingly), and interpreted the value of that assignment as the
> >> ???? > unnamed "zlim" option that would have been the corresponding
> >> ??? positional
> >> ???? > argument that should have been there.
> >> ???? >
> >> ???? > And yes, I still use "left arrow" <- instead of equals = as
> >> ??? assignments.
> >> ???? > (Heck, I even use emacs and ESS with a leftover keybinding that
> >> ??? uses the
> >> ???? > underscore key to insert the left arrow. Apparently, I'm ancient
> >> ??? myself.)
> >> ???? >
> >> ???? >? ? Kevin
> >> ???? >
> >> ???? > On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
> >> ???? >> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
> >> ???? >>> Hi,
> >> ???? >>>
> >> ???? >>> I am in the middle of developing a new package, which contains a
> >> ???? >>> markdown-knitr-html vignette. When I try to run
> >> ???? >>>
> >> ???? >>> R CMD build [mypackagedirectory]
> >> ???? >>>
> >> ???? >>> I get an error message
> >> ???? >>>
> >> ???? >>> Quitting from lines 330-336
> >> ???? >>> Error: processing vignette? failed with diagnostics:
> >> ???? >>> invalid z limits
> >> ???? >>>
> >> ???? >>> If I run the same markdown script interactively inside R
> >> ??? Studio, there
> >> ???? >>> is no error.
> >> ???? >>> If I knit the markdown script inside R Studio, it produces the
> >> ??? correct
> >> ???? >>> HTML output, with no error.
> >> ???? >>>
> >> ???? >>> The offending lines of code (the chunk at 330-336) invoke an
> >> ??? "image"
> >> ???? >>> method on an object of a class defined in the package, which in
> >> ??? turn
> >> ???? >>> computes a matrix from items inside the object and calls
> >> ??? image.default,
> >> ???? >>> which is presumably where the error is coming from.
> >> ???? >>>
> >> ???? >>> Two questions: (1) How is it possible that the same code works
> >> ??? error
> >> ???? >>> free in the RStudio contexts, but fails in the attempt to build
> >> ??? the
> >> ???? >>> package?
> >> ???? >>> (2) Any suggestions on how to debug something that only throws
> >> ??? an error
> >> ???? >>> from "R CMD build" would be most welcome.
> >> ???? >>
> >> ???? >> Debugging that sort of thing is hard.? Here's what I would try:
> >> ???? >>
> >> ???? >> From inside an R session, run
> >> ???? >>
> >> ???? >> ? tools:::.build_packages("[mypackagedirectory]")
> >> ???? >>
> >> ???? >> That runs the code that R CMD build runs, so it might trigger
> >> ??? the same
> >> ???? >> error.? If so, debug in the usual way, with traceback(), etc.
> >> ???? >>
> >> ???? >> If that doesn't trigger the error, try it using a different
> >> ??? front-end,
> >> ???? >> e.g. running R at the command line instead of running it in 
> >> RStudio.
> >> ???? >>
> >> ???? >> If you still can't trigger it, then start modifying the 
> >> vignette to
> >> ???? >> find the exact line that causes the error (e.g. by commenting
> >> ??? out the
> >> ???? >> second half of the code in that chunk; did the error go away?
> >> ??? etc.).
> >> ???? >> Then modify it again to save all the inputs to the bad line in a
> >> ??? file
> >> ???? >> before running it, and see if running that line in a different
> >> ??? context
> >> ???? >> still triggers the error. Etc.
> >> ???? >>
> >> ???? >> Duncan Murdoch
> >> ???? >
> >> ???? > ______________________________________________
> >> ???? > R-package-devel at r-project.org
> >> ??? <mailto:R-package-devel at r-project.org> mailing list
> >> ???? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >> ??? <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> >>
> > 
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> -- 
> Dr. Benjamin Bolker
> Professor, Mathematics & Statistics and Biology, McMaster University
> Director, School of Computational Science and Engineering
> (Acting) Graduate chair, Mathematics & Statistics
>  > E-mail is sent at my convenience; I don't expect replies outside of 
> working hours.
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

William Becker PhD
willbecker.me (https://www.willbecker.me/)
See our new project at compositeindicators.com (https://compositeindicators.com/)


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Mon Jan  9 20:44:02 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Mon, 9 Jan 2023 14:44:02 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
 <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
 <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
Message-ID: <5f8dde15-38a0-d8fc-b2d4-53eb3be4bca4@gmail.com>

Did you have to split the packages to get the CI/CD tools to work? 
Because,to me, it looks as though I can install multiple different R 
packages from the same git project, using something like

library(devtools)
install_gitlab("krcoombes/[PROJECT]", "pkg/[PACKAGE]")

Best,
 ? Kevin

On 1/8/2023 1:38 PM, Spencer Graves wrote:
>
> ????? R-Forge was wonderful for me when I started using it.? Then 
> several years ago, I started having problems like you described. A few 
> years ago I migrated from R-Forge to GitHub.
>
>
> ????? One problem I encountered in the transition:? On R-Forge, I had 
> multiple packages in the same R-Forge project.? I had to split them 
> apart for GitHub.


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Fri Jan 13 09:54:50 2023
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Fri, 13 Jan 2023 08:54:50 +0000
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
Message-ID: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Dear list members,

I am getting the following response when I try to upload growthPheno_2.1.17.tar.gz:

Detected package information [non-editable]
In case of errors reupload the package or contact cran team

The package was successfully uploaded on 2022-11-15. It is available on https://github.com/briencj/growthPheno.

I have scoured the DESCRIPTION file and compared it with the DESCRIPTION file for dae, another of my packages that has been successfully uploaded in the last 12 hours.

I have run R CMD  --as-cran growthPheno_2.1.17.tar.gz with the final status being OK.

I am stumped as to what is causing the problem. Can anyone throw any lot on what the problem might be?

Thanks in advance,

Cheers,

 Chris

Chris Brien | Senior Biostatistician
Australian Plant Phenomics Facility


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan 13 15:06:33 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 13 Jan 2023 17:06:33 +0300
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
In-Reply-To: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
References: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <20230113170633.55feee95@arachnoid>

? Fri, 13 Jan 2023 08:54:50 +0000
Chris Brien <chris.brien at adelaide.edu.au> ?????:

> I am getting the following response when I try to upload
> growthPheno_2.1.17.tar.gz:
> 
> Detected package information [non-editable]
> In case of errors reupload the package or contact cran team

That's not an error. This message is to inform you that the following
fields have been extracted from your DESCRIPTION file and aren't
supposed to be edited by hand. Is there a better way to phrase that?

Do you see anything out of place in the form? If the form content seems
OK, click the "Submit package" button near the bottom of the page to
continue.

-- 
Best regards,
Ivan


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Fri Jan 13 22:51:01 2023
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Fri, 13 Jan 2023 21:51:01 +0000
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
In-Reply-To: <20230113170633.55feee95@arachnoid>
References: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <20230113170633.55feee95@arachnoid>
Message-ID: <ME4P282MB12871E95DE9FD0305FC00159A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Hi Ivan,

Thanks for taking up my query.

I realized after I sent the message that I should have added that the package files is being dropped as well. It replaces my file name with "No file chosen".  Consequently I cannot continue submit the package.

I saw it as an error message because it is not a message that I have seen in the many times that I have uploaded a package to CRAN.

My interpretation of the message was that there is some "non-editable" material in the package information, most likely the DESCRIPTION file.

However, I doubted that this could be the case because the only changes in the DESCRIPTION file since I uploaded Version 2.1.16 two months ago are in the Version, Date, Packaged and Suggests, the latter having writeXLS removed because it is no longer needed.  I have verified that these are the only changed by extracting the DESCRIPTION file from both growthPheno_2.1.16 and 2.1.17 and doing a file comparison on them.

This led me to think that the problem must be in other than the DESCRIPTION file.

Unfortunately, I remain unable to upload the package.

Cheers,

  Chris



> -----Original Message-----
> From: Ivan Krylov <krylov.r00t at gmail.com>
> Sent: Saturday, 14 January 2023 12:37 AM
> To: Chris Brien <chris.brien at adelaide.edu.au>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
>
> CAUTION: External email. Only click on links or open attachments from
> trusted senders.
>
> ? Fri, 13 Jan 2023 08:54:50 +0000
> Chris Brien <chris.brien at adelaide.edu.au> ?????:
>
> > I am getting the following response when I try to upload
> > growthPheno_2.1.17.tar.gz:
> >
> > Detected package information [non-editable] In case of errors reupload
> > the package or contact cran team
>
> That's not an error. This message is to inform you that the following fields
> have been extracted from your DESCRIPTION file and aren't supposed to be
> edited by hand. Is there a better way to phrase that?
>
> Do you see anything out of place in the form? If the form content seems OK,
> click the "Submit package" button near the bottom of the page to continue.
>
> --
> Best regards,
> Ivan


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan 13 23:15:13 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 14 Jan 2023 01:15:13 +0300
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
In-Reply-To: <ME4P282MB12871E95DE9FD0305FC00159A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
References: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <20230113170633.55feee95@arachnoid>
 <ME4P282MB12871E95DE9FD0305FC00159A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <20230114011513.4456b7b6@Tarkus>

On Fri, 13 Jan 2023 21:51:01 +0000
Chris Brien <chris.brien at adelaide.edu.au> wrote:

> the package files is being dropped as well. It replaces my file name
> with "No file chosen".  Consequently I cannot continue submit the
> package.

I understand that this behaviour is counter-intuitive, but that seems
to be the way it's supposed to work. Package submission is a multi-step
process:

Step 1 involves providing your name, your e-mail address and the
package file. Once uploaded, the package file stays somewhere at CRAN,
at least for a while.

Step 2 involves making sure that you've uploaded the right package.
You're shown your name, e-mail address, the optional comment and the
fields from the DESCRIPTION file. The "Package:" file upload field
should be empty because CRAN already has a copy of the file.

Pressing the "Re-upload the package/Edit information" will repeat the
step 1 and take you back to the same place, just before the step 2. In
order to progress, you need to press the "Submit package" button below
the form, despite the "Package:" file upload field is empty.

Do the "Title:", "Description:", "Authors(s):" fields contain the
information for your package? Does the "Submit package" button work for
you? Are there any other messages there?

Perhaps the CRAN submission form should show some indication that the
file has been uploaded near the file entry field during step 2?

-- 
Best regards,
Ivan


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Fri Jan 13 23:59:45 2023
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Fri, 13 Jan 2023 22:59:45 +0000
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
In-Reply-To: <20230114011513.4456b7b6@Tarkus>
References: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <20230113170633.55feee95@arachnoid>
 <ME4P282MB12871E95DE9FD0305FC00159A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <20230114011513.4456b7b6@Tarkus>
Message-ID: <ME4P282MB1287C1704A5378D233B1CA7FA0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Hi Ivan,

The submit button has worked!!!!

You are right that it is counterintuitive and I have been well trained not to submit things to CRAN that contain errors :-)

I agree that something like "Package uploaded" would be better than "No file chosen" in Stage 2, afterall I have chosen a file.

Thanks very much for your help. All's well that ends well.

Cheers,

  Chris



> -----Original Message-----
> From: Ivan Krylov <krylov.r00t at gmail.com>
> Sent: Saturday, 14 January 2023 8:45 AM
> To: Chris Brien <chris.brien at adelaide.edu.au>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
>
> CAUTION: External email. Only click on links or open attachments from
> trusted senders.
>
> On Fri, 13 Jan 2023 21:51:01 +0000
> Chris Brien <chris.brien at adelaide.edu.au> wrote:
>
> > the package files is being dropped as well. It replaces my file name
> > with "No file chosen".  Consequently I cannot continue submit the
> > package.
>
> I understand that this behaviour is counter-intuitive, but that seems to be
> the way it's supposed to work. Package submission is a multi-step
> process:
>
> Step 1 involves providing your name, your e-mail address and the package
> file. Once uploaded, the package file stays somewhere at CRAN, at least for a
> while.
>
> Step 2 involves making sure that you've uploaded the right package.
> You're shown your name, e-mail address, the optional comment and the
> fields from the DESCRIPTION file. The "Package:" file upload field should be
> empty because CRAN already has a copy of the file.
>
> Pressing the "Re-upload the package/Edit information" will repeat the step 1
> and take you back to the same place, just before the step 2. In order to
> progress, you need to press the "Submit package" button below the form,
> despite the "Package:" file upload field is empty.
>
> Do the "Title:", "Description:", "Authors(s):" fields contain the information for
> your package? Does the "Submit package" button work for you? Are there
> any other messages there?
>
> Perhaps the CRAN submission form should show some indication that the file
> has been uploaded near the file entry field during step 2?
>
> --
> Best regards,
> Ivan


