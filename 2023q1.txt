From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Mon Jan  2 19:20:11 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Mon, 2 Jan 2023 12:20:11 -0600
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
Message-ID: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>

Hello, All:


	  What are current recommendations for GitHub Action?


	  My most recent change to "sos" generated "Failed to get R" for 
ubuntu-latest (release, devel, and oldrel-1).


https://github.com/sbgraves237/sos/actions/runs/3820307473/jobs/6498527786


	  I would happily rtfm if I only knew which fmtr.


	  Thanks,
	  Spencer Graves


From zk@mv@r @end|ng |rom gm@||@com  Mon Jan  2 19:34:41 2023
From: zk@mv@r @end|ng |rom gm@||@com (Zhian Kamvar)
Date: Mon, 2 Jan 2023 10:34:41 -0800
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
In-Reply-To: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
References: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
Message-ID: <CAPsXksJ=MPS=979NnD4hJGeg5hDk80JF-KPhYoMtDv64ZKxXWw@mail.gmail.com>

This warning says to update to v2 of the action from r-lib:

Warning: r-lib/actions/setup-r at v1 is deprecated. Please update your
> workflow to use the 'v2' version. Also look at the examples at
> https://github.com/r-lib/actions/tree/v2/examples because '@v2' workflows
> are much simpler than 'v1' workflows.


We ran into a similar problem and switching to v2 did the trick.

Best,
Zhian

On Mon, Jan 2, 2023 at 10:20 AM Spencer Graves <
spencer.graves at effectivedefense.org> wrote:

> Hello, All:
>
>
>           What are current recommendations for GitHub Action?
>
>
>           My most recent change to "sos" generated "Failed to get R" for
> ubuntu-latest (release, devel, and oldrel-1).
>
>
> https://github.com/sbgraves237/sos/actions/runs/3820307473/jobs/6498527786
>
>
>           I would happily rtfm if I only knew which fmtr.
>
>
>           Thanks,
>           Spencer Graves
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Mon Jan  2 19:38:16 2023
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 2 Jan 2023 12:38:16 -0600
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
In-Reply-To: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
References: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
Message-ID: <25523.9368.854032.549309@rob.eddelbuettel.com>


As the error is common against your _all three_ of your Ubuntu runs, you
could consider the possibility that the events are correlated.  Most often it
simply means a (temporary, usually) network or server outage.  I would wait,
and then relaunch (which these days you can do just for the failed jobs).

It is also worth paying attention to warnings such as

   Warning: r-lib/actions/setup-r at v1 is deprecated. Please update your
   workflow to use the 'v2' version. Also look at the examples at
   https://github.com/r-lib/actions/tree/v2/examples because '@v2' workflows
   are much simpler than 'v1' workflows.

Hth,  Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Tue Jan  3 02:18:33 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Mon, 2 Jan 2023 19:18:33 -0600
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
In-Reply-To: <25523.9368.854032.549309@rob.eddelbuettel.com>
References: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
 <25523.9368.854032.549309@rob.eddelbuettel.com>
Message-ID: <b97fe385-c884-1365-3ab2-d86a293d9a27@effectivedefense.org>



On 1/2/23 12:38 PM, Dirk Eddelbuettel wrote:
> 
> As the error is common against your _all three_ of your Ubuntu runs, you
> could consider the possibility that the events are correlated.  Most often it
> simply means a (temporary, usually) network or server outage.  I would wait,
> and then relaunch (which these days you can do just for the failed jobs).
> 
> It is also worth paying attention to warnings such as
> 
>     Warning: r-lib/actions/setup-r at v1 is deprecated. Please update your
>     workflow to use the 'v2' version. Also look at the examples at
>     https://github.com/r-lib/actions/tree/v2/examples because '@v2' workflows
>     are much simpler than 'v1' workflows.


	  Thanks to Zhian Kamvar and Dirk Eddelbuettel for encouraging me to 
look at the warning.


	  I replaced a few lined of my "R-CMD-check.yaml" file with the the 
"v3" and "v2" versions in the example in 
"https://github.com/r-lib/actions/tree/v2/examples" and deleted 
subsequent lines that I didn't understand, and I got an instant failure: 
  It didn't run even one of the 5 tests.  Then I did "git revert" with 
the version number from GitHub and changed several lines to match the 
example with the succeeding yaml code.  GitHub Action ran and failed on 
all 5 platforms.  I did "git revert" with that and changed 
"r-lib/actions/setup-r at v1" to "r-lib/actions/setup-r at v2".  With that, 
R-release ran successfully on Unbuntu as well as Windows and macOS.


	  However, Ubuntu failed with devel and oldrel1, complaining, "there is 
no package called ?rcmdcheck?".


	  See:


https://github.com/sbgraves237/sos


	  Suggestions?
	  Thanks,
	  Spencer Graves

> 
> Hth,  Dirk
>


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Jan  4 10:18:40 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 4 Jan 2023 12:18:40 +0300
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
In-Reply-To: <b97fe385-c884-1365-3ab2-d86a293d9a27@effectivedefense.org>
References: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
 <25523.9368.854032.549309@rob.eddelbuettel.com>
 <b97fe385-c884-1365-3ab2-d86a293d9a27@effectivedefense.org>
Message-ID: <20230104121840.7dc90239@Tarkus>

On Mon, 2 Jan 2023 19:18:33 -0600
Spencer Graves <spencer.graves at effectivedefense.org> wrote:

> 	  However, Ubuntu failed with devel and oldrel1, complaining,
> "there is no package called ?rcmdcheck?".

If we start from the error message and work backwards, it's easy to see
that `rcmdcheck` fails to install because it depends on `curl`, which
also fails to install. `curl` fails to install because the virtual
machine running the GitHub Action doesn't have libcurl headers
installed; there's even an error message about that, but it's not fatal:

------------------------- ANTICONF ERROR ---------------------------
Configuration failed because libcurl was not found. Try installing:
 * deb: libcurl4-openssl-dev (Debian, Ubuntu, etc)
 * rpm: libcurl-devel (Fedora, CentOS, RHEL)
If libcurl is already installed, check that 'pkg-config' is in your
PATH and PKG_CONFIG_PATH contains a libcurl.pc file. If pkg-config
is unavailable you can set INCLUDE_DIR and LIB_DIR manually via:
R CMD INSTALL --configure-vars='INCLUDE_DIR=... LIB_DIR=...'
--------------------------------------------------------------------

I don't have enough experience in the abstraction layers involved, but
if you stuff a `sudo apt install libcurl4-openssl-dev` (which should
run as a system command line, just like the "Install system
dependencies" step) somewhere before the "Install dependencies" step,
it should work.

-- 
Best regards,
Ivan


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Wed Jan  4 11:50:20 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Wed, 4 Jan 2023 11:50:20 +0100
Subject: [R-pkg-devel] new toolchain "RTools43" for building devel binaries
 (both R base and packages)
Message-ID: <2d486a48-087d-4bbe-b8cd-021025cfabc8@statistik.tu-dortmund.de>

Dear developers,

for those building from source on Windows:

A new toolchain called "RTools43" has been prepared by Tomas Kalibera.
It is now used to build the Windows binaries (R base and contributed 
packages) for R-devel on Windows. See
<https://cran.r-project.org/bin/windows/Rtools/rtools43/rtools.html>.

Best,
Uwe Ligges


From k|ng@@ @end|ng |rom um|ch@edu  Wed Jan  4 21:54:52 2023
From: k|ng@@ @end|ng |rom um|ch@edu (Aaron A. King)
Date: Wed, 4 Jan 2023 15:54:52 -0500
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
Message-ID: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>

Hi all,

I'm modifying a package so as to remove its dependence on the superseded
packages *reshape2* and *plyr*, in favor of dependence on *dplyr*.  In
particular, I'm just importing the one function `dplyr::bind_rows`.

A curious thing happens, however, as soon as I include this among the
imports.  I begin to get R CMD check NOTEs alerting me to the presence of
S3 generic inconsistencies.  These are associated with two functions in the
package: `filter.mean` and `filter.traj`, which the checker mistakes for S3
methods based on the generic `stats::filter` function.  Actually, these are
not S3 methods.  In fact, they are S4 generics and declared as such.

When *dplyr* is not imported, R CMD check is happy with these functions.
When it is imported, R CMD check complains.

Now I understand that it may be preferable to move away from functions with
names containing dots for this reason, and in fact I am already doing so,
but I think the question is a good one:

Why does inclusion of *dplyr* in the import list appear to trigger these
warnings when they were not there before?

Thanks in advance for any insight you can give!

Aaron A. King, Ph.D.
Nelson G. Hairston Professor of Ecology, Evolutionary Biology, and Complex
Systems
University of Michigan
kinglab.eeb.lsa.umich.edu
GPG Public Key: 0x15780975

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Jan  4 22:22:09 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 5 Jan 2023 00:22:09 +0300
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
Message-ID: <20230105002209.6e1fae5d@Tarkus>

On Wed, 4 Jan 2023 15:54:52 -0500
"Aaron A. King" <kingaa at umich.edu> wrote:

> Why does inclusion of *dplyr* in the import list appear to trigger
> these warnings when they were not there before?

I think that's because dplyr itself contains an S3 generic named
"filter", and having a package namespace loaded (not even attached) is
enough to take its registered S3 methods into consideration for method
dispatch. Here we have an opposite situation, though, and your
functions aren't registered as S3 methods. Will your function still be
called if you artificially construct a wrong object and feed it to
dplyr::filter while your package namespace is attached?

library(YOURPACKAGE)
dplyr::filter(structure(list(), class = 'traj'))

Additionally, stats::filter doesn't seem to be an S3 generic, so that's
one thing that the check gets confused about.

-- 
Best regards,
Ivan


From k|ng@@ @end|ng |rom um|ch@edu  Thu Jan  5 23:58:47 2023
From: k|ng@@ @end|ng |rom um|ch@edu (Aaron A. King)
Date: Thu, 5 Jan 2023 17:58:47 -0500
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <20230105002209.6e1fae5d@Tarkus>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
 <20230105002209.6e1fae5d@Tarkus>
Message-ID: <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>

Thanks for the fast reply!

When I follow your suggestion above, I get

library(pomp)
dplyr::filter(structure(list(), class = 'traj'))

Error in UseMethod("filter") :
  no applicable method for 'filter' applied to an object of class "traj"

Which is not what would happen if my filter.traj function were called.  So
the S3 dispatch system is not confused.  Thus this really is a false
positive.

It still leaves open the question, why does this suddenly appear when dplyr
is loaded?  If I understand you correctly, it would be triggered by the
inclusion of the generic 'filter' in dplyr, which was previously not
present. However, since the S3 dispatch system is not itself confused, I
suppose it must be the case that the S3 generic/method consistency checker
itself is confused.  I wonder, how does the checker decide when to throw a
NOTE?  Is it a simple pattern-matching system, something like "If X.Y is
exported, where X is a generic and Y is any string and X.Y is not declared
as an S3 method, then throw NOTE"?

Dr. Aaron A. King
University of Michigan


On Wed, Jan 4, 2023 at 4:22 PM Ivan Krylov <krylov.r00t at gmail.com> wrote:

> On Wed, 4 Jan 2023 15:54:52 -0500
> "Aaron A. King" <kingaa at umich.edu> wrote:
>
> > Why does inclusion of *dplyr* in the import list appear to trigger
> > these warnings when they were not there before?
>
> I think that's because dplyr itself contains an S3 generic named
> "filter", and having a package namespace loaded (not even attached) is
> enough to take its registered S3 methods into consideration for method
> dispatch. Here we have an opposite situation, though, and your
> functions aren't registered as S3 methods. Will your function still be
> called if you artificially construct a wrong object and feed it to
> dplyr::filter while your package namespace is attached?
>
> library(YOURPACKAGE)
> dplyr::filter(structure(list(), class = 'traj'))
>
> Additionally, stats::filter doesn't seem to be an S3 generic, so that's
> one thing that the check gets confused about.
>
> --
> Best regards,
> Ivan
>

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan  6 09:21:49 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 6 Jan 2023 11:21:49 +0300
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
 <20230105002209.6e1fae5d@Tarkus>
 <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>
Message-ID: <20230106112149.10207568@Tarkus>

On Thu, 5 Jan 2023 17:58:47 -0500
"Aaron A. King" <kingaa at umich.edu> wrote:

> However, since the S3 dispatch system is not itself confused, I
> suppose it must be the case that the S3 generic/method consistency
> checker itself is confused.  I wonder, how does the checker decide
> when to throw a NOTE?  Is it a simple pattern-matching system,
> something like "If X.Y is exported, where X is a generic and Y is any
> string and X.Y is not declared as an S3 method, then throw NOTE"?

The aim of the check is a bit different: "if an S3 method for generic X
and class Y exists, and the formal arguments of X.Y don't extend the
formal arguments of X in a certain way, then throw a NOTE", but then
something gets wrong about deciding whether X.Y is an S3 method, and
once filter.mean is decided to be an S3 method, of course it doesn't
match the formals of filter.

This function is even a public API of the tools package, see
?tools::checkS3methods:
https://github.com/r-devel/r-svn/blob/b57918fd104962415a752ea7db12dcf4f3f5219f/src/library/tools/R/QC.R#L2310-L2560

> When I follow your suggestion above, I get
> 
> library(pomp)
> dplyr::filter(structure(list(), class = 'traj'))
> 
> Error in UseMethod("filter") :
> no applicable method for 'filter' applied to an object of class "traj"

Interesting. I wonder if there's are other remaining ways to confuse
the S3 dispatch system into thinking your function is an S3 method that
the check is supposed to guard against. For instance, the following is
likely to work with your package:

library(pomp)
library(dplyr)
identical(filter.traj, getS3method('filter', 'traj'))
# as long as there's a visible 'filter' generic, getS3method will
# locate filter.traj as the method

...despite the method lookup seems to (correctly) fail, as you've just
demonstrated. But on older versions of R, this used to wrongly resolve
the call:

library(Ropj)
read <- function(x, ...) UseMethod('read')
identical(read.opj, getS3method('read','opj')) # works in R-devel
# [1] TRUE
read(structure(0, class = 'opj')) # calls read.opj in old R
# Error in read_opj(file, encoding, tree) :
#   Expecting a single string value: [type=double; extent=1].

I'm afraid I'm out of my depth here. The old, wrong behaviour seems to
match the R language definition
<https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Definition>.
The current behaviour seems to do the right thing? by letting the
functions opt into being methods, but then getS3method() seems to
contradict what actually gets called. Should we be fixing the
documentation, the implementation, or the check?

Can you try stepping through tools::checkS3methods('pomp') (or
tools::checkS3methods(dir = 'path/to/source/directory')) to see where
'filter' appears in the list of generics and where the 

-- 
Best regards,
Ivan


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan  6 09:24:13 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 6 Jan 2023 11:24:13 +0300
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <20230106112149.10207568@Tarkus>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
 <20230105002209.6e1fae5d@Tarkus>
 <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>
 <20230106112149.10207568@Tarkus>
Message-ID: <20230106112413.478d82da@Tarkus>

(Sorry for the unfinished message. I've got to do something about my
mailer to make it harder to send them accidentally.)

On Fri, 6 Jan 2023 11:21:49 +0300
Ivan Krylov <krylov.r00t at gmail.com> wrote:

> to see where 'filter' appears in the list of generics and where the

filter.traj function gets matched to it as a method?

-- 
Best regards,
Ivan


From k|ng@@ @end|ng |rom um|ch@edu  Fri Jan  6 19:56:10 2023
From: k|ng@@ @end|ng |rom um|ch@edu (Aaron A. King)
Date: Fri, 6 Jan 2023 13:56:10 -0500
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <20230106112413.478d82da@Tarkus>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
 <20230105002209.6e1fae5d@Tarkus>
 <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>
 <20230106112149.10207568@Tarkus> <20230106112413.478d82da@Tarkus>
Message-ID: <CAGPRvNC2T5Ce-ZdcKdwsmh53uQ1JVYf75CTC=i6Bbf2mL7B0Jw@mail.gmail.com>

Excellent suggestion, Ivan. Thanks for pointing out just where to look.

I stepped through tools::checkS3methods("pomp") and it does appear to be
roughly as I conjectured.  Namely, all functions are extracted from the
pomp namespace and checked against a list of generics.  The check that is
performed is a simple pattern-match (i.e.,
startsWith(paste0(genericname,"."), functionname)).  Clearly this is prone
to false positives.  I wonder what would be involved in tightening this up
so that it agrees with what the actual dispatch mechanism gives....

Interestingly, there is a whitelist, implemented mostly via
tools::nonS3methods().  The function (plyr::rbind.fill) that I had been
importing is there but its replacement (dplyr::bind_rows) is not. So this
answers my original question.

The whitelist appears to be a somewhat arbitrary compilation of functions
from various packages, with no obvious theme.  For example, dplyr is not on
the list, but ElectoGraph is; reshape is on the list but reshape2 is not.
The impression of arbitrariness is reinforced by the fact that packages
that Wickham has for whatever reason decided are superseded are present in
that list and packages he considers for the moment to be worth maintaining
are not.  Doing a quick 'git blame' I see that the whitelist was mostly put
together in 2013, with a few additions in 2015 and much more occasionally
since.

It occurs to me that there ought to be a mechanism whereby a package author
could add to the list of non-S3 methods.  I see from the mailing list
archives that there was discussion of this back in 2015 (
https://stat.ethz.ch/pipermail/r-devel/2015-June/071356.html), with what
looked like consensus that there ought to be such a facility, but nothing
seems to have actually been done about it.  I conjecture that the decision
was to just fold false positives into the whitelist on an ad hoc basis.

Dr. Aaron A. King
University of Michigan


On Fri, Jan 6, 2023 at 3:24 AM Ivan Krylov <krylov.r00t at gmail.com> wrote:

> (Sorry for the unfinished message. I've got to do something about my
> mailer to make it harder to send them accidentally.)
>
> On Fri, 6 Jan 2023 11:21:49 +0300
> Ivan Krylov <krylov.r00t at gmail.com> wrote:
>
> > to see where 'filter' appears in the list of generics and where the
>
> filter.traj function gets matched to it as a method?
>
> --
> Best regards,
> Ivan
>

	[[alternative HTML version deleted]]


From th|erry@denoeux @end|ng |rom utc@|r  Sat Jan  7 09:02:18 2023
From: th|erry@denoeux @end|ng |rom utc@|r (Thierry Denoeux)
Date: Sat, 7 Jan 2023 15:02:18 +0700
Subject: [R-pkg-devel] Problem with NEWS file
Message-ID: <A76FB9A9-9F8A-4836-8CDB-7622E9D76BFC@utc.fr>

Dear all,

Version 2.0.0 of my ?evclass' package was rejected for the second time with the following note from the Debian check (the Windows check is OK):

* checking package subdirectories ... NOTE
Problems with news in ?NEWS?:
  Cannot process chunk/lines:
    Version 2.0.0 includes an implementation of radial basis function neural network classifiers, as well as functions to express the outputs of trained logistic regression or feed-forward neural network classifiers as Dempster-Shafer mass functions. These methods are based on an interpretation of the operations performed in neural networks as the combination of weights of evidence by Dempster's rule (see: "T. Denoeux, Logistic Regression, Neural Networks and Dempster-Shafer Theory: a New Perspective. Knowledge-Based Systems 176:54-67, 2019").

I already tried to change the NEWS file but I have no idea where the error might come from. The NEWS file is a text file created by TextEdit on Mac with UTF-8 encoding, so I don?t see how there could be hidden special characters in it. I see nothing special in the line that could not be processed. Any help would be greatly appreciated.

Best,

Thierry
----------
Prof. Thierry Denoeux
Universit? de technologie de Compi?gne
Institut universitaire de France
Rue Roger Couttolenc, CS 60319
60203 Compi?gne cedex, France
https://www.hds.utc.fr/~tdenoeux


	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Sat Jan  7 09:20:45 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 7 Jan 2023 11:20:45 +0300
Subject: [R-pkg-devel] Problem with NEWS file
In-Reply-To: <A76FB9A9-9F8A-4836-8CDB-7622E9D76BFC@utc.fr>
References: <A76FB9A9-9F8A-4836-8CDB-7622E9D76BFC@utc.fr>
Message-ID: <20230107112045.4fcf06b3@Tarkus>

On Sat, 7 Jan 2023 15:02:18 +0700
Thierry Denoeux <thierry.denoeux at utc.fr> wrote:

> The NEWS file is a text file created by TextEdit on Mac with UTF-8
> encoding, so I don?t see how there could be hidden special characters
> in it.

The problem is that the NEWS files are supposed to have a certain
format (documented in help(news)). For a long time, this hasn't been
enforced, but now there are checks in place that require NEWS to be
written to specifications.

I think that your line can be transformed as follows in order to parse
correctly:

Changes in version 2.0.0

 * Implementation of radial basis function neural network classifiers,
   as well as functions to express the outputs of trained logistic
   regression or feed-forward neural network classifiers as
   Dempster-Shafer mass functions. These methods are based on an
   interpretation of the operations performed in neural networks as the
   combination of weights of evidence by Dempster's rule (see: "T.
   Denoeux, Logistic Regression, Neural Networks and Dempster-Shafer
   Theory: a New Perspective. Knowledge-Based Systems 176:54-67, 2019").

You can also write an inst/NEWS.Rd file in Rd format.

As you can see from reading ?news, it is preferred to provide a
bulleted list of the changes.

-- 
Best regards,
Ivan


From th|erry@denoeux @end|ng |rom utc@|r  Sat Jan  7 10:37:53 2023
From: th|erry@denoeux @end|ng |rom utc@|r (Thierry Denoeux)
Date: Sat, 7 Jan 2023 16:37:53 +0700
Subject: [R-pkg-devel] Problem with NEWS file
In-Reply-To: <20230107112045.4fcf06b3@Tarkus>
References: <A76FB9A9-9F8A-4836-8CDB-7622E9D76BFC@utc.fr>
 <20230107112045.4fcf06b3@Tarkus>
Message-ID: <B219EF5F-BEE8-4071-AA95-608DE2539DA1@utc.fr>

I had overlooked these new specifications for the NEWS file. Thank you very much!
Thierry
----------
Prof. Thierry Denoeux
Universit? de technologie de Compi?gne
Institut universitaire de France
Rue Roger Couttolenc, CS 60319
60203 Compi?gne cedex, France
https://www.hds.utc.fr/~tdenoeux

> Le 7 janv. 2023 ? 15:20, Ivan Krylov <krylov.r00t at gmail.com> a ?crit :
> 
> On Sat, 7 Jan 2023 15:02:18 +0700
> Thierry Denoeux <thierry.denoeux at utc.fr> wrote:
> 
>> The NEWS file is a text file created by TextEdit on Mac with UTF-8
>> encoding, so I don?t see how there could be hidden special characters
>> in it.
> 
> The problem is that the NEWS files are supposed to have a certain
> format (documented in help(news)). For a long time, this hasn't been
> enforced, but now there are checks in place that require NEWS to be
> written to specifications.
> 
> I think that your line can be transformed as follows in order to parse
> correctly:
> 
> Changes in version 2.0.0
> 
> * Implementation of radial basis function neural network classifiers,
>   as well as functions to express the outputs of trained logistic
>   regression or feed-forward neural network classifiers as
>   Dempster-Shafer mass functions. These methods are based on an
>   interpretation of the operations performed in neural networks as the
>   combination of weights of evidence by Dempster's rule (see: "T.
>   Denoeux, Logistic Regression, Neural Networks and Dempster-Shafer
>   Theory: a New Perspective. Knowledge-Based Systems 176:54-67, 2019").
> 
> You can also write an inst/NEWS.Rd file in Rd format.
> 
> As you can see from reading ?news, it is preferred to provide a
> bulleted list of the changes.
> 
> -- 
> Best regards,
> Ivan


	[[alternative HTML version deleted]]


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sun Jan  8 02:43:10 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Sat, 7 Jan 2023 20:43:10 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
Message-ID: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>

Hi,

I am in the middle of developing a new package, which contains a 
markdown-knitr-html vignette. When I try to run

R CMD build [mypackagedirectory]

I get an error message

Quitting from lines 330-336
Error: processing vignette? failed with diagnostics:
invalid z limits

If I run the same markdown script interactively inside R Studio, there 
is no error.
If I knit the markdown script inside R Studio, it produces the correct 
HTML output, with no error.

The offending lines of code (the chunk at 330-336) invoke an "image" 
method on an object of a class defined in the package, which in turn 
computes a matrix from items inside the object and calls image.default, 
which is presumably where the error is coming from.

Two questions: (1) How is it possible that the same code works error 
free in the RStudio contexts, but fails in the attempt to build the package?
(2) Any suggestions on how to debug something that only throws an error 
from "R CMD build" would be most welcome.

Thanks in advance,
 ? Kevin


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Jan  8 11:04:44 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 8 Jan 2023 05:04:44 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
Message-ID: <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>

On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
> Hi,
> 
> I am in the middle of developing a new package, which contains a
> markdown-knitr-html vignette. When I try to run
> 
> R CMD build [mypackagedirectory]
> 
> I get an error message
> 
> Quitting from lines 330-336
> Error: processing vignette? failed with diagnostics:
> invalid z limits
> 
> If I run the same markdown script interactively inside R Studio, there
> is no error.
> If I knit the markdown script inside R Studio, it produces the correct
> HTML output, with no error.
> 
> The offending lines of code (the chunk at 330-336) invoke an "image"
> method on an object of a class defined in the package, which in turn
> computes a matrix from items inside the object and calls image.default,
> which is presumably where the error is coming from.
> 
> Two questions: (1) How is it possible that the same code works error
> free in the RStudio contexts, but fails in the attempt to build the package?
> (2) Any suggestions on how to debug something that only throws an error
> from "R CMD build" would be most welcome.

Debugging that sort of thing is hard.  Here's what I would try:

 From inside an R session, run

   tools:::.build_packages("[mypackagedirectory]")

That runs the code that R CMD build runs, so it might trigger the same 
error.  If so, debug in the usual way, with traceback(), etc.

If that doesn't trigger the error, try it using a different front-end, 
e.g. running R at the command line instead of running it in RStudio.

If you still can't trigger it, then start modifying the vignette to find 
the exact line that causes the error (e.g. by commenting out the second 
half of the code in that chunk; did the error go away? etc.).  Then 
modify it again to save all the inputs to the bad line in a file before 
running it, and see if running that line in a different context still 
triggers the error. Etc.

Duncan Murdoch


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Sun Jan  8 12:42:41 2023
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Sun, 8 Jan 2023 11:42:41 +0000
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
Message-ID: <CWLP265MB3505AF01E9516596CA84782DAEF99@CWLP265MB3505.GBRP265.PROD.OUTLOOK.COM>

A frequent cause of such errors is that in the offending scenario a method is not visible, so the call goes directly to the default method. This often can be verified by temporarily printing something from your method when it gets control.

Without more details it is difficult to be more specific. It may be a missing import or export, for example.

Georgi Boshnakov


Get Outlook for Android<https://aka.ms/AAb9ysg>

________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Duncan Murdoch <murdoch.duncan at gmail.com>
Sent: Sunday, 8 January 2023, 10:05
To: Kevin R. Coombes <kevin.r.coombes at gmail.com>; R Package Development <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] Mysterious "invalid z limit"

On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
> Hi,
>
> I am in the middle of developing a new package, which contains a
> markdown-knitr-html vignette. When I try to run
>
> R CMD build [mypackagedirectory]
>
> I get an error message
>
> Quitting from lines 330-336
> Error: processing vignette  failed with diagnostics:
> invalid z limits
>
> If I run the same markdown script interactively inside R Studio, there
> is no error.
> If I knit the markdown script inside R Studio, it produces the correct
> HTML output, with no error.
>
> The offending lines of code (the chunk at 330-336) invoke an "image"
> method on an object of a class defined in the package, which in turn
> computes a matrix from items inside the object and calls image.default,
> which is presumably where the error is coming from.
>
> Two questions: (1) How is it possible that the same code works error
> free in the RStudio contexts, but fails in the attempt to build the package?
> (2) Any suggestions on how to debug something that only throws an error
> from "R CMD build" would be most welcome.

Debugging that sort of thing is hard.  Here's what I would try:

 From inside an R session, run

   tools:::.build_packages("[mypackagedirectory]")

That runs the code that R CMD build runs, so it might trigger the same
error.  If so, debug in the usual way, with traceback(), etc.

If that doesn't trigger the error, try it using a different front-end,
e.g. running R at the command line instead of running it in RStudio.

If you still can't trigger it, then start modifying the vignette to find
the exact line that causes the error (e.g. by commenting out the second
half of the code in that chunk; did the error go away? etc.).  Then
modify it again to save all the inputs to the bad line in a file before
running it, and see if running that line in a different context still
triggers the error. Etc.

Duncan Murdoch

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Sun Jan  8 12:58:30 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sun, 8 Jan 2023 14:58:30 +0300
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
Message-ID: <20230108145830.5ad85981@Tarkus>

On Sat, 7 Jan 2023 20:43:10 -0500
"Kevin R. Coombes" <kevin.r.coombes at gmail.com> wrote:

> (1) How is it possible that the same code works error 
> free in the RStudio contexts, but fails in the attempt to build the
> package?

When knitting the vignette from RStudio, it uses the package you
already have installed. When knitting the vignette from R CMD build, it
uses the code it's about to package. Could it be that your source code
is different from the copy installed in your library?

> (2) Any suggestions on how to debug something that only
> throws an error from "R CMD build" would be most welcome.

R CMD build --no-build-vignettes should let you proceed and get a
tarball that could be installed. Hopefully you'll be able to reproduce
the error then.

-- 
Best regards,
Ivan


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sun Jan  8 16:00:30 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Sun, 8 Jan 2023 10:00:30 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <20230108145830.5ad85981@Tarkus>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <20230108145830.5ad85981@Tarkus>
Message-ID: <a92eb547-f448-2ae3-fd46-cfd05f8c1b6f@gmail.com>

A terrific answer; thanks. (I am kicking myself for not realizing the 
answer you gave to question 1. Of course that's the explanation. Too 
many consecutive hours debugging other items to get to that point, I 
suppose.)
 ? Kevin

On 1/8/2023 6:58 AM, Ivan Krylov wrote:
> On Sat, 7 Jan 2023 20:43:10 -0500
> "Kevin R. Coombes" <kevin.r.coombes at gmail.com> wrote:
>
>> (1) How is it possible that the same code works error
>> free in the RStudio contexts, but fails in the attempt to build the
>> package?
> When knitting the vignette from RStudio, it uses the package you
> already have installed. When knitting the vignette from R CMD build, it
> uses the code it's about to package. Could it be that your source code
> is different from the copy installed in your library?
>
>> (2) Any suggestions on how to debug something that only
>> throws an error from "R CMD build" would be most welcome.
> R CMD build --no-build-vignettes should let you proceed and get a
> tarball that could be installed. Hopefully you'll be able to reproduce
> the error then.
>


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sun Jan  8 16:11:41 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Sun, 8 Jan 2023 10:11:41 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
Message-ID: <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>

A very helpful answer. For some reason (probably because I have an 
ancient perl script that automates the steps i take when building and 
checking packages), I keep forgetting that the "tools" package let's me 
do these things from within R.

I had already isolated the offending line ("plot(obj)") inside the chunk 
where the error occurred, and removed any additional arguments. I 
wrapped that line in a "try" command followed by a conditional 
"traceback()" to find the problem.? This allowed the package build to 
knit the vignette and provide some feedback about what was going on. It 
turned out that I had copied and pasted an assignment line of the form

main <- [compute the title]

from earlier in the code and pasted it directly as an argument to the 
call to image.default. And R did exactly what I told it to (not 
surprisingly), and interpreted the value of that assignment as the 
unnamed "zlim" option that would have been the corresponding positional 
argument that should have been there.

And yes, I still use "left arrow" <- instead of equals = as assignments. 
(Heck, I even use emacs and ESS with a leftover keybinding that uses the 
underscore key to insert the left arrow. Apparently, I'm ancient myself.)

 ? Kevin

On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
>> Hi,
>>
>> I am in the middle of developing a new package, which contains a
>> markdown-knitr-html vignette. When I try to run
>>
>> R CMD build [mypackagedirectory]
>>
>> I get an error message
>>
>> Quitting from lines 330-336
>> Error: processing vignette? failed with diagnostics:
>> invalid z limits
>>
>> If I run the same markdown script interactively inside R Studio, there
>> is no error.
>> If I knit the markdown script inside R Studio, it produces the correct
>> HTML output, with no error.
>>
>> The offending lines of code (the chunk at 330-336) invoke an "image"
>> method on an object of a class defined in the package, which in turn
>> computes a matrix from items inside the object and calls image.default,
>> which is presumably where the error is coming from.
>>
>> Two questions: (1) How is it possible that the same code works error
>> free in the RStudio contexts, but fails in the attempt to build the 
>> package?
>> (2) Any suggestions on how to debug something that only throws an error
>> from "R CMD build" would be most welcome.
>
> Debugging that sort of thing is hard.? Here's what I would try:
>
> From inside an R session, run
>
> ? tools:::.build_packages("[mypackagedirectory]")
>
> That runs the code that R CMD build runs, so it might trigger the same 
> error.? If so, debug in the usual way, with traceback(), etc.
>
> If that doesn't trigger the error, try it using a different front-end, 
> e.g. running R at the command line instead of running it in RStudio.
>
> If you still can't trigger it, then start modifying the vignette to 
> find the exact line that causes the error (e.g. by commenting out the 
> second half of the code in that chunk; did the error go away? etc.).? 
> Then modify it again to save all the inputs to the bad line in a file 
> before running it, and see if running that line in a different context 
> still triggers the error. Etc.
>
> Duncan Murdoch


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun Jan  8 17:30:32 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 8 Jan 2023 10:30:32 -0600
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
Message-ID: <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>

	  If you use GitHub, I highly recommend using "GitHub Action" as 
described by Wickham and Bryan, R Packages:


https://r-pkgs.org/code.html#code-style


	  I'm not sure the best way to get it set up, but I have all my 
packages on GitHub configured so each "push" that changes anything has 
"R CMD Check" run on 5 different platforms:  The release version of R on 
the latest Windows, macOS, and Ubuntu plus the development version and 
the most recent old release on Ubuntu.  I rarely run R CMD check on my 
local machine anymore:  I just "git commit" and "git push".  Then GitHub 
Action manages testing on those 5 platforms.


	  To be precise, I do "git status" before "git push" to make sure I 
have "committed" everything I want to commit before I "git push".  And I 
do "git pull" to make sure a collaborator hasn't "pushed" something new 
I should look at before I "git push".


	  Finally, I want to thank again G?bor Cs?rdi who helped me greatly get 
past problems I hand with "GitHub Action" for my "sos" package.  He 
provided example workflows in:


https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml


	  I also needed LaTeX support, for which G?bor suggested the following:


https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages


	  Spencer Graves
	

On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
> A very helpful answer. For some reason (probably because I have an 
> ancient perl script that automates the steps i take when building and 
> checking packages), I keep forgetting that the "tools" package let's me 
> do these things from within R.
> 
> I had already isolated the offending line ("plot(obj)") inside the chunk 
> where the error occurred, and removed any additional arguments. I 
> wrapped that line in a "try" command followed by a conditional 
> "traceback()" to find the problem.? This allowed the package build to 
> knit the vignette and provide some feedback about what was going on. It 
> turned out that I had copied and pasted an assignment line of the form
> 
> main <- [compute the title]
> 
> from earlier in the code and pasted it directly as an argument to the 
> call to image.default. And R did exactly what I told it to (not 
> surprisingly), and interpreted the value of that assignment as the 
> unnamed "zlim" option that would have been the corresponding positional 
> argument that should have been there.
> 
> And yes, I still use "left arrow" <- instead of equals = as assignments. 
> (Heck, I even use emacs and ESS with a leftover keybinding that uses the 
> underscore key to insert the left arrow. Apparently, I'm ancient myself.)
> 
>  ? Kevin
> 
> On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
>> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
>>> Hi,
>>>
>>> I am in the middle of developing a new package, which contains a
>>> markdown-knitr-html vignette. When I try to run
>>>
>>> R CMD build [mypackagedirectory]
>>>
>>> I get an error message
>>>
>>> Quitting from lines 330-336
>>> Error: processing vignette? failed with diagnostics:
>>> invalid z limits
>>>
>>> If I run the same markdown script interactively inside R Studio, there
>>> is no error.
>>> If I knit the markdown script inside R Studio, it produces the correct
>>> HTML output, with no error.
>>>
>>> The offending lines of code (the chunk at 330-336) invoke an "image"
>>> method on an object of a class defined in the package, which in turn
>>> computes a matrix from items inside the object and calls image.default,
>>> which is presumably where the error is coming from.
>>>
>>> Two questions: (1) How is it possible that the same code works error
>>> free in the RStudio contexts, but fails in the attempt to build the 
>>> package?
>>> (2) Any suggestions on how to debug something that only throws an error
>>> from "R CMD build" would be most welcome.
>>
>> Debugging that sort of thing is hard.? Here's what I would try:
>>
>> From inside an R session, run
>>
>> ? tools:::.build_packages("[mypackagedirectory]")
>>
>> That runs the code that R CMD build runs, so it might trigger the same 
>> error.? If so, debug in the usual way, with traceback(), etc.
>>
>> If that doesn't trigger the error, try it using a different front-end, 
>> e.g. running R at the command line instead of running it in RStudio.
>>
>> If you still can't trigger it, then start modifying the vignette to 
>> find the exact line that causes the error (e.g. by commenting out the 
>> second half of the code in that chunk; did the error go away? etc.). 
>> Then modify it again to save all the inputs to the bad line in a file 
>> before running it, and see if running that line in a different context 
>> still triggers the error. Etc.
>>
>> Duncan Murdoch
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sun Jan  8 18:36:02 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin Coombes)
Date: Sun, 8 Jan 2023 12:36:02 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
Message-ID: <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>

I have been using R-Forge for many years for package development. And I
have been using GitLab for other projects almost as long.

However, over the past few months, the R-Forge support seems to be
decaying, and I now have several projects that won't currently build there
because of various items that appear to need fixing at their end. So, I am
actively exploring what it will take to move packages and projects to git.

I already know how to use a git client to clone a Subversion repository
from R-Forge (using "git svn"). And how to change the remote origin to push
it to a new git location. (And I  may also be willing to lose the revision
history if it is going to make the transition easier.)

I am now at the step of understanding the recent changes at GitLab with
respect to support for "Educational" or "Open Source" status, especially in
terms of how many monthly minutes of CI/CD time I can use for free. When
working on a new package, I tend to make lots of small commit-pushes, and
it sounds like each one of those will eat up minutes. So, any advice on how
to manage that issue would be greatly appreciated.

Best,
  Kevin

On Sun, Jan 8, 2023, 11:30 AM Spencer Graves <
spencer.graves at effectivedefense.org> wrote:

>           If you use GitHub, I highly recommend using "GitHub Action" as
> described by Wickham and Bryan, R Packages:
>
>
> https://r-pkgs.org/code.html#code-style
>
>
>           I'm not sure the best way to get it set up, but I have all my
> packages on GitHub configured so each "push" that changes anything has
> "R CMD Check" run on 5 different platforms:  The release version of R on
> the latest Windows, macOS, and Ubuntu plus the development version and
> the most recent old release on Ubuntu.  I rarely run R CMD check on my
> local machine anymore:  I just "git commit" and "git push".  Then GitHub
> Action manages testing on those 5 platforms.
>
>
>           To be precise, I do "git status" before "git push" to make sure
> I
> have "committed" everything I want to commit before I "git push".  And I
> do "git pull" to make sure a collaborator hasn't "pushed" something new
> I should look at before I "git push".
>
>
>           Finally, I want to thank again G?bor Cs?rdi who helped me
> greatly get
> past problems I hand with "GitHub Action" for my "sos" package.  He
> provided example workflows in:
>
>
>
> https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml
>
>
>           I also needed LaTeX support, for which G?bor suggested the
> following:
>
>
> https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages
>
>
>           Spencer Graves
>
>
> On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
> > A very helpful answer. For some reason (probably because I have an
> > ancient perl script that automates the steps i take when building and
> > checking packages), I keep forgetting that the "tools" package let's me
> > do these things from within R.
> >
> > I had already isolated the offending line ("plot(obj)") inside the chunk
> > where the error occurred, and removed any additional arguments. I
> > wrapped that line in a "try" command followed by a conditional
> > "traceback()" to find the problem.  This allowed the package build to
> > knit the vignette and provide some feedback about what was going on. It
> > turned out that I had copied and pasted an assignment line of the form
> >
> > main <- [compute the title]
> >
> > from earlier in the code and pasted it directly as an argument to the
> > call to image.default. And R did exactly what I told it to (not
> > surprisingly), and interpreted the value of that assignment as the
> > unnamed "zlim" option that would have been the corresponding positional
> > argument that should have been there.
> >
> > And yes, I still use "left arrow" <- instead of equals = as assignments.
> > (Heck, I even use emacs and ESS with a leftover keybinding that uses the
> > underscore key to insert the left arrow. Apparently, I'm ancient myself.)
> >
> >    Kevin
> >
> > On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
> >> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
> >>> Hi,
> >>>
> >>> I am in the middle of developing a new package, which contains a
> >>> markdown-knitr-html vignette. When I try to run
> >>>
> >>> R CMD build [mypackagedirectory]
> >>>
> >>> I get an error message
> >>>
> >>> Quitting from lines 330-336
> >>> Error: processing vignette  failed with diagnostics:
> >>> invalid z limits
> >>>
> >>> If I run the same markdown script interactively inside R Studio, there
> >>> is no error.
> >>> If I knit the markdown script inside R Studio, it produces the correct
> >>> HTML output, with no error.
> >>>
> >>> The offending lines of code (the chunk at 330-336) invoke an "image"
> >>> method on an object of a class defined in the package, which in turn
> >>> computes a matrix from items inside the object and calls image.default,
> >>> which is presumably where the error is coming from.
> >>>
> >>> Two questions: (1) How is it possible that the same code works error
> >>> free in the RStudio contexts, but fails in the attempt to build the
> >>> package?
> >>> (2) Any suggestions on how to debug something that only throws an error
> >>> from "R CMD build" would be most welcome.
> >>
> >> Debugging that sort of thing is hard.  Here's what I would try:
> >>
> >> From inside an R session, run
> >>
> >>   tools:::.build_packages("[mypackagedirectory]")
> >>
> >> That runs the code that R CMD build runs, so it might trigger the same
> >> error.  If so, debug in the usual way, with traceback(), etc.
> >>
> >> If that doesn't trigger the error, try it using a different front-end,
> >> e.g. running R at the command line instead of running it in RStudio.
> >>
> >> If you still can't trigger it, then start modifying the vignette to
> >> find the exact line that causes the error (e.g. by commenting out the
> >> second half of the code in that chunk; did the error go away? etc.).
> >> Then modify it again to save all the inputs to the bad line in a file
> >> before running it, and see if running that line in a different context
> >> still triggers the error. Etc.
> >>
> >> Duncan Murdoch
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun Jan  8 19:38:58 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 8 Jan 2023 12:38:58 -0600
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
 <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
Message-ID: <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>



On 1/8/23 11:36 AM, Kevin Coombes wrote:
> I have been using R-Forge for many years for package development. And I 
> have been using GitLab for other projects almost as long.
> 
> However, over the past few months, the R-Forge support seems to be 
> decaying, and I now have several projects that won't currently build 
> there because of various items that appear to need fixing at their end. 
> So, I am actively exploring what it will take to move packages and 
> projects to git.


	  R-Forge was wonderful for me when I started using it.  Then several 
years ago, I started having problems like you described.  A few years 
ago I migrated from R-Forge to GitHub.


	  One problem I encountered in the transition:  On R-Forge, I had 
multiple packages in the same R-Forge project.  I had to split them 
apart for GitHub.

> 
> I already know how to use a git client to clone a Subversion repository 
> from R-Forge (using "git svn"). And how to change the remote origin to 
> push it to a new git location. (And I? may also be willing to lose the 
> revision history if it is going to make the transition easier.)
> 
> I am now at the step of understanding the recent changes at GitLab with 
> respect to support for "Educational" or "Open Source" status, especially 
> in terms of how many monthly minutes of CI/CD time I can use for free. 
> When working on a new package, I tend to make lots of small 
> commit-pushes, and it sounds like each one of those will eat up minutes. 
> So, any advice on how to manage that issue?would be greatly appreciated.


	  When I first got into Subversion, I remember Doug Bates saying, 
"Commit early and often."  The word "Commit" doesn't mean the same in 
Git as in Subversion, so I would encourage you to "Git push early and 
often."


	  There may be limits on free use of GitHub, but I'm not aware of them: 
  If you want a private account, you need to pay for that, but the 
charges for that are not much.


	  If anyone knows anything different from what I've just said, I hope 
they will disabuse my of this part of my ignorance.


	  Spencer

> 
> Best,
>  ? Kevin
> 
> On Sun, Jan 8, 2023, 11:30 AM Spencer Graves 
> <spencer.graves at effectivedefense.org 
> <mailto:spencer.graves at effectivedefense.org>> wrote:
> 
>      ? ? ? ? ? If you use GitHub, I highly recommend using "GitHub
>     Action" as
>     described by Wickham and Bryan, R Packages:
> 
> 
>     https://r-pkgs.org/code.html#code-style
>     <https://r-pkgs.org/code.html#code-style>
> 
> 
>      ? ? ? ? ? I'm not sure the best way to get it set up, but I have
>     all my
>     packages on GitHub configured so each "push" that changes anything has
>     "R CMD Check" run on 5 different platforms:? The release version of
>     R on
>     the latest Windows, macOS, and Ubuntu plus the development version and
>     the most recent old release on Ubuntu.? I rarely run R CMD check on my
>     local machine anymore:? I just "git commit" and "git push".? Then
>     GitHub
>     Action manages testing on those 5 platforms.
> 
> 
>      ? ? ? ? ? To be precise, I do "git status" before "git push" to
>     make sure I
>     have "committed" everything I want to commit before I "git push". 
>     And I
>     do "git pull" to make sure a collaborator hasn't "pushed" something new
>     I should look at before I "git push".
> 
> 
>      ? ? ? ? ? Finally, I want to thank again G?bor Cs?rdi who helped me
>     greatly get
>     past problems I hand with "GitHub Action" for my "sos" package.? He
>     provided example workflows in:
> 
> 
>     https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml <https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml>
> 
> 
>      ? ? ? ? ? I also needed LaTeX support, for which G?bor suggested
>     the following:
> 
> 
>     https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages
>     <https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages>
> 
> 
>      ? ? ? ? ? Spencer Graves
> 
> 
>     On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
>      > A very helpful answer. For some reason (probably because I have an
>      > ancient perl script that automates the steps i take when building
>     and
>      > checking packages), I keep forgetting that the "tools" package
>     let's me
>      > do these things from within R.
>      >
>      > I had already isolated the offending line ("plot(obj)") inside
>     the chunk
>      > where the error occurred, and removed any additional arguments. I
>      > wrapped that line in a "try" command followed by a conditional
>      > "traceback()" to find the problem.? This allowed the package
>     build to
>      > knit the vignette and provide some feedback about what was going
>     on. It
>      > turned out that I had copied and pasted an assignment line of the
>     form
>      >
>      > main <- [compute the title]
>      >
>      > from earlier in the code and pasted it directly as an argument to
>     the
>      > call to image.default. And R did exactly what I told it to (not
>      > surprisingly), and interpreted the value of that assignment as the
>      > unnamed "zlim" option that would have been the corresponding
>     positional
>      > argument that should have been there.
>      >
>      > And yes, I still use "left arrow" <- instead of equals = as
>     assignments.
>      > (Heck, I even use emacs and ESS with a leftover keybinding that
>     uses the
>      > underscore key to insert the left arrow. Apparently, I'm ancient
>     myself.)
>      >
>      >? ? Kevin
>      >
>      > On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
>      >> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
>      >>> Hi,
>      >>>
>      >>> I am in the middle of developing a new package, which contains a
>      >>> markdown-knitr-html vignette. When I try to run
>      >>>
>      >>> R CMD build [mypackagedirectory]
>      >>>
>      >>> I get an error message
>      >>>
>      >>> Quitting from lines 330-336
>      >>> Error: processing vignette? failed with diagnostics:
>      >>> invalid z limits
>      >>>
>      >>> If I run the same markdown script interactively inside R
>     Studio, there
>      >>> is no error.
>      >>> If I knit the markdown script inside R Studio, it produces the
>     correct
>      >>> HTML output, with no error.
>      >>>
>      >>> The offending lines of code (the chunk at 330-336) invoke an
>     "image"
>      >>> method on an object of a class defined in the package, which in
>     turn
>      >>> computes a matrix from items inside the object and calls
>     image.default,
>      >>> which is presumably where the error is coming from.
>      >>>
>      >>> Two questions: (1) How is it possible that the same code works
>     error
>      >>> free in the RStudio contexts, but fails in the attempt to build
>     the
>      >>> package?
>      >>> (2) Any suggestions on how to debug something that only throws
>     an error
>      >>> from "R CMD build" would be most welcome.
>      >>
>      >> Debugging that sort of thing is hard.? Here's what I would try:
>      >>
>      >> From inside an R session, run
>      >>
>      >> ? tools:::.build_packages("[mypackagedirectory]")
>      >>
>      >> That runs the code that R CMD build runs, so it might trigger
>     the same
>      >> error.? If so, debug in the usual way, with traceback(), etc.
>      >>
>      >> If that doesn't trigger the error, try it using a different
>     front-end,
>      >> e.g. running R at the command line instead of running it in RStudio.
>      >>
>      >> If you still can't trigger it, then start modifying the vignette to
>      >> find the exact line that causes the error (e.g. by commenting
>     out the
>      >> second half of the code in that chunk; did the error go away?
>     etc.).
>      >> Then modify it again to save all the inputs to the bad line in a
>     file
>      >> before running it, and see if running that line in a different
>     context
>      >> still triggers the error. Etc.
>      >>
>      >> Duncan Murdoch
>      >
>      > ______________________________________________
>      > R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org> mailing list
>      > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>


From bbo|ker @end|ng |rom gm@||@com  Sun Jan  8 19:52:57 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 8 Jan 2023 13:52:57 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
 <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
 <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
Message-ID: <70be627e-93ae-05db-3377-5c229faff736@gmail.com>



On 2023-01-08 1:38 p.m., Spencer Graves wrote:
> 
> 
> On 1/8/23 11:36 AM, Kevin Coombes wrote:
>> I have been using R-Forge for many years for package development. And 
>> I have been using GitLab for other projects almost as long.
>>
>> However, over the past few months, the R-Forge support seems to be 
>> decaying, and I now have several projects that won't currently build 
>> there because of various items that appear to need fixing at their 
>> end. So, I am actively exploring what it will take to move packages 
>> and projects to git.
> 
> 
>  ????? R-Forge was wonderful for me when I started using it.? Then 
> several years ago, I started having problems like you described.? A few 
> years ago I migrated from R-Forge to GitHub.
> 
> 
>  ????? One problem I encountered in the transition:? On R-Forge, I had 
> multiple packages in the same R-Forge project.? I had to split them 
> apart for GitHub.
> 
>>
>> I already know how to use a git client to clone a Subversion 
>> repository from R-Forge (using "git svn"). And how to change the 
>> remote origin to push it to a new git location. (And I? may also be 
>> willing to lose the revision history if it is going to make the 
>> transition easier.)
>>
>> I am now at the step of understanding the recent changes at GitLab 
>> with respect to support for "Educational" or "Open Source" status, 
>> especially in terms of how many monthly minutes of CI/CD time I can 
>> use for free. When working on a new package, I tend to make lots of 
>> small commit-pushes, and it sounds like each one of those will eat up 
>> minutes. So, any advice on how to manage that issue?would be greatly 
>> appreciated.
> 
> 
>  ????? When I first got into Subversion, I remember Doug Bates saying, 
> "Commit early and often."? The word "Commit" doesn't mean the same in 
> Git as in Subversion, so I would encourage you to "Git push early and 
> often."
> 
> 
>  ????? There may be limits on free use of GitHub, but I'm not aware of 
> them: ?If you want a private account, you need to pay for that, but the 
> charges for that are not much.

   The free tier of Github allows 2000 minutes/month of continuous 
integration testing for private repos, and unlimited (???) for public 
repos.  (2000 minutes/month is more than I've ever needed.)

   Furthermore, it's pretty easy to set up github actions so that it 
only runs tests if you ask it to (by appending e.g. "[run ci]" to your 
commit message), or in opt-out mode (i.e., skip tests if "[skip ci]" is 
in your commit message).

> 
> 
>  ????? If anyone knows anything different from what I've just said, I 
> hope they will disabuse my of this part of my ignorance.
> 
> 
>  ????? Spencer
> 
>>
>> Best,
>> ?? Kevin
>>
>> On Sun, Jan 8, 2023, 11:30 AM Spencer Graves 
>> <spencer.graves at effectivedefense.org 
>> <mailto:spencer.graves at effectivedefense.org>> wrote:
>>
>> ???? ? ? ? ? ? If you use GitHub, I highly recommend using "GitHub
>> ??? Action" as
>> ??? described by Wickham and Bryan, R Packages:
>>
>>
>> ??? https://r-pkgs.org/code.html#code-style
>> ??? <https://r-pkgs.org/code.html#code-style>
>>
>>
>> ???? ? ? ? ? ? I'm not sure the best way to get it set up, but I have
>> ??? all my
>> ??? packages on GitHub configured so each "push" that changes anything 
>> has
>> ??? "R CMD Check" run on 5 different platforms:? The release version of
>> ??? R on
>> ??? the latest Windows, macOS, and Ubuntu plus the development version 
>> and
>> ??? the most recent old release on Ubuntu.? I rarely run R CMD check 
>> on my
>> ??? local machine anymore:? I just "git commit" and "git push".? Then
>> ??? GitHub
>> ??? Action manages testing on those 5 platforms.
>>
>>
>> ???? ? ? ? ? ? To be precise, I do "git status" before "git push" to
>> ??? make sure I
>> ??? have "committed" everything I want to commit before I "git push". 
>> ??? And I
>> ??? do "git pull" to make sure a collaborator hasn't "pushed" 
>> something new
>> ??? I should look at before I "git push".
>>
>>
>> ???? ? ? ? ? ? Finally, I want to thank again G?bor Cs?rdi who helped me
>> ??? greatly get
>> ??? past problems I hand with "GitHub Action" for my "sos" package.? He
>> ??? provided example workflows in:
>>
>>
>>     
>> https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml <https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml>
>>
>>
>> ???? ? ? ? ? ? I also needed LaTeX support, for which G?bor suggested
>> ??? the following:
>>
>>
>> ??? https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages
>>     
>> <https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages>
>>
>>
>> ???? ? ? ? ? ? Spencer Graves
>>
>>
>> ??? On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
>> ???? > A very helpful answer. For some reason (probably because I have an
>> ???? > ancient perl script that automates the steps i take when building
>> ??? and
>> ???? > checking packages), I keep forgetting that the "tools" package
>> ??? let's me
>> ???? > do these things from within R.
>> ???? >
>> ???? > I had already isolated the offending line ("plot(obj)") inside
>> ??? the chunk
>> ???? > where the error occurred, and removed any additional arguments. I
>> ???? > wrapped that line in a "try" command followed by a conditional
>> ???? > "traceback()" to find the problem.? This allowed the package
>> ??? build to
>> ???? > knit the vignette and provide some feedback about what was going
>> ??? on. It
>> ???? > turned out that I had copied and pasted an assignment line of the
>> ??? form
>> ???? >
>> ???? > main <- [compute the title]
>> ???? >
>> ???? > from earlier in the code and pasted it directly as an argument to
>> ??? the
>> ???? > call to image.default. And R did exactly what I told it to (not
>> ???? > surprisingly), and interpreted the value of that assignment as the
>> ???? > unnamed "zlim" option that would have been the corresponding
>> ??? positional
>> ???? > argument that should have been there.
>> ???? >
>> ???? > And yes, I still use "left arrow" <- instead of equals = as
>> ??? assignments.
>> ???? > (Heck, I even use emacs and ESS with a leftover keybinding that
>> ??? uses the
>> ???? > underscore key to insert the left arrow. Apparently, I'm ancient
>> ??? myself.)
>> ???? >
>> ???? >? ? Kevin
>> ???? >
>> ???? > On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
>> ???? >> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
>> ???? >>> Hi,
>> ???? >>>
>> ???? >>> I am in the middle of developing a new package, which contains a
>> ???? >>> markdown-knitr-html vignette. When I try to run
>> ???? >>>
>> ???? >>> R CMD build [mypackagedirectory]
>> ???? >>>
>> ???? >>> I get an error message
>> ???? >>>
>> ???? >>> Quitting from lines 330-336
>> ???? >>> Error: processing vignette? failed with diagnostics:
>> ???? >>> invalid z limits
>> ???? >>>
>> ???? >>> If I run the same markdown script interactively inside R
>> ??? Studio, there
>> ???? >>> is no error.
>> ???? >>> If I knit the markdown script inside R Studio, it produces the
>> ??? correct
>> ???? >>> HTML output, with no error.
>> ???? >>>
>> ???? >>> The offending lines of code (the chunk at 330-336) invoke an
>> ??? "image"
>> ???? >>> method on an object of a class defined in the package, which in
>> ??? turn
>> ???? >>> computes a matrix from items inside the object and calls
>> ??? image.default,
>> ???? >>> which is presumably where the error is coming from.
>> ???? >>>
>> ???? >>> Two questions: (1) How is it possible that the same code works
>> ??? error
>> ???? >>> free in the RStudio contexts, but fails in the attempt to build
>> ??? the
>> ???? >>> package?
>> ???? >>> (2) Any suggestions on how to debug something that only throws
>> ??? an error
>> ???? >>> from "R CMD build" would be most welcome.
>> ???? >>
>> ???? >> Debugging that sort of thing is hard.? Here's what I would try:
>> ???? >>
>> ???? >> From inside an R session, run
>> ???? >>
>> ???? >> ? tools:::.build_packages("[mypackagedirectory]")
>> ???? >>
>> ???? >> That runs the code that R CMD build runs, so it might trigger
>> ??? the same
>> ???? >> error.? If so, debug in the usual way, with traceback(), etc.
>> ???? >>
>> ???? >> If that doesn't trigger the error, try it using a different
>> ??? front-end,
>> ???? >> e.g. running R at the command line instead of running it in 
>> RStudio.
>> ???? >>
>> ???? >> If you still can't trigger it, then start modifying the 
>> vignette to
>> ???? >> find the exact line that causes the error (e.g. by commenting
>> ??? out the
>> ???? >> second half of the code in that chunk; did the error go away?
>> ??? etc.).
>> ???? >> Then modify it again to save all the inputs to the bad line in a
>> ??? file
>> ???? >> before running it, and see if running that line in a different
>> ??? context
>> ???? >> still triggers the error. Etc.
>> ???? >>
>> ???? >> Duncan Murdoch
>> ???? >
>> ???? > ______________________________________________
>> ???? > R-package-devel at r-project.org
>> ??? <mailto:R-package-devel at r-project.org> mailing list
>> ???? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> ??? <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From w||||@m@becker @end|ng |rom b|ue|oxd@t@@eu  Mon Jan  9 10:28:18 2023
From: w||||@m@becker @end|ng |rom b|ue|oxd@t@@eu (William Becker)
Date: Mon, 9 Jan 2023 10:28:18 +0100 (CET)
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <70be627e-93ae-05db-3377-5c229faff736@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
 <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
 <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
 <70be627e-93ae-05db-3377-5c229faff736@gmail.com>
Message-ID: <1635330386.1430908.1673256498618@privateemail.com>

Thanks for mentioning the possibility to opt out of the CMD checks on GitHub actions, which I didn't know about before. I also have GHA set up and I like the concept of automated testing, but one thing that bothers me is that sometimes I make a small but necessary commit (e.g. to fix a bug) and it runs the whole suite of tests and checks on all functions which takes around five minutes. Most of the time this is overkill and it occurs to me that it has an unnecessary environmental impact. Perhaps this is something to think about occasionally in our CI/CD setups.

So now I'm off to tweak my GitHub actions...

> On 08/01/2023 19:52 CET Ben Bolker <bbolker at gmail.com> wrote:
> 
>  
> On 2023-01-08 1:38 p.m., Spencer Graves wrote:
> > 
> > 
> > On 1/8/23 11:36 AM, Kevin Coombes wrote:
> >> I have been using R-Forge for many years for package development. And 
> >> I have been using GitLab for other projects almost as long.
> >>
> >> However, over the past few months, the R-Forge support seems to be 
> >> decaying, and I now have several projects that won't currently build 
> >> there because of various items that appear to need fixing at their 
> >> end. So, I am actively exploring what it will take to move packages 
> >> and projects to git.
> > 
> > 
> >  ????? R-Forge was wonderful for me when I started using it.? Then 
> > several years ago, I started having problems like you described.? A few 
> > years ago I migrated from R-Forge to GitHub.
> > 
> > 
> >  ????? One problem I encountered in the transition:? On R-Forge, I had 
> > multiple packages in the same R-Forge project.? I had to split them 
> > apart for GitHub.
> > 
> >>
> >> I already know how to use a git client to clone a Subversion 
> >> repository from R-Forge (using "git svn"). And how to change the 
> >> remote origin to push it to a new git location. (And I? may also be 
> >> willing to lose the revision history if it is going to make the 
> >> transition easier.)
> >>
> >> I am now at the step of understanding the recent changes at GitLab 
> >> with respect to support for "Educational" or "Open Source" status, 
> >> especially in terms of how many monthly minutes of CI/CD time I can 
> >> use for free. When working on a new package, I tend to make lots of 
> >> small commit-pushes, and it sounds like each one of those will eat up 
> >> minutes. So, any advice on how to manage that issue?would be greatly 
> >> appreciated.
> > 
> > 
> >  ????? When I first got into Subversion, I remember Doug Bates saying, 
> > "Commit early and often."? The word "Commit" doesn't mean the same in 
> > Git as in Subversion, so I would encourage you to "Git push early and 
> > often."
> > 
> > 
> >  ????? There may be limits on free use of GitHub, but I'm not aware of 
> > them: ?If you want a private account, you need to pay for that, but the 
> > charges for that are not much.
> 
>    The free tier of Github allows 2000 minutes/month of continuous 
> integration testing for private repos, and unlimited (???) for public 
> repos.  (2000 minutes/month is more than I've ever needed.)
> 
>    Furthermore, it's pretty easy to set up github actions so that it 
> only runs tests if you ask it to (by appending e.g. "[run ci]" to your 
> commit message), or in opt-out mode (i.e., skip tests if "[skip ci]" is 
> in your commit message).
> 
> > 
> > 
> >  ????? If anyone knows anything different from what I've just said, I 
> > hope they will disabuse my of this part of my ignorance.
> > 
> > 
> >  ????? Spencer
> > 
> >>
> >> Best,
> >> ?? Kevin
> >>
> >> On Sun, Jan 8, 2023, 11:30 AM Spencer Graves 
> >> <spencer.graves at effectivedefense.org 
> >> <mailto:spencer.graves at effectivedefense.org>> wrote:
> >>
> >> ???? ? ? ? ? ? If you use GitHub, I highly recommend using "GitHub
> >> ??? Action" as
> >> ??? described by Wickham and Bryan, R Packages:
> >>
> >>
> >> ??? https://r-pkgs.org/code.html#code-style
> >> ??? <https://r-pkgs.org/code.html#code-style>
> >>
> >>
> >> ???? ? ? ? ? ? I'm not sure the best way to get it set up, but I have
> >> ??? all my
> >> ??? packages on GitHub configured so each "push" that changes anything 
> >> has
> >> ??? "R CMD Check" run on 5 different platforms:? The release version of
> >> ??? R on
> >> ??? the latest Windows, macOS, and Ubuntu plus the development version 
> >> and
> >> ??? the most recent old release on Ubuntu.? I rarely run R CMD check 
> >> on my
> >> ??? local machine anymore:? I just "git commit" and "git push".? Then
> >> ??? GitHub
> >> ??? Action manages testing on those 5 platforms.
> >>
> >>
> >> ???? ? ? ? ? ? To be precise, I do "git status" before "git push" to
> >> ??? make sure I
> >> ??? have "committed" everything I want to commit before I "git push". 
> >> ??? And I
> >> ??? do "git pull" to make sure a collaborator hasn't "pushed" 
> >> something new
> >> ??? I should look at before I "git push".
> >>
> >>
> >> ???? ? ? ? ? ? Finally, I want to thank again G?bor Cs?rdi who helped me
> >> ??? greatly get
> >> ??? past problems I hand with "GitHub Action" for my "sos" package.? He
> >> ??? provided example workflows in:
> >>
> >>
> >>     
> >> https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml <https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml>
> >>
> >>
> >> ???? ? ? ? ? ? I also needed LaTeX support, for which G?bor suggested
> >> ??? the following:
> >>
> >>
> >> ??? https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages
> >>     
> >> <https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages>
> >>
> >>
> >> ???? ? ? ? ? ? Spencer Graves
> >>
> >>
> >> ??? On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
> >> ???? > A very helpful answer. For some reason (probably because I have an
> >> ???? > ancient perl script that automates the steps i take when building
> >> ??? and
> >> ???? > checking packages), I keep forgetting that the "tools" package
> >> ??? let's me
> >> ???? > do these things from within R.
> >> ???? >
> >> ???? > I had already isolated the offending line ("plot(obj)") inside
> >> ??? the chunk
> >> ???? > where the error occurred, and removed any additional arguments. I
> >> ???? > wrapped that line in a "try" command followed by a conditional
> >> ???? > "traceback()" to find the problem.? This allowed the package
> >> ??? build to
> >> ???? > knit the vignette and provide some feedback about what was going
> >> ??? on. It
> >> ???? > turned out that I had copied and pasted an assignment line of the
> >> ??? form
> >> ???? >
> >> ???? > main <- [compute the title]
> >> ???? >
> >> ???? > from earlier in the code and pasted it directly as an argument to
> >> ??? the
> >> ???? > call to image.default. And R did exactly what I told it to (not
> >> ???? > surprisingly), and interpreted the value of that assignment as the
> >> ???? > unnamed "zlim" option that would have been the corresponding
> >> ??? positional
> >> ???? > argument that should have been there.
> >> ???? >
> >> ???? > And yes, I still use "left arrow" <- instead of equals = as
> >> ??? assignments.
> >> ???? > (Heck, I even use emacs and ESS with a leftover keybinding that
> >> ??? uses the
> >> ???? > underscore key to insert the left arrow. Apparently, I'm ancient
> >> ??? myself.)
> >> ???? >
> >> ???? >? ? Kevin
> >> ???? >
> >> ???? > On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
> >> ???? >> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
> >> ???? >>> Hi,
> >> ???? >>>
> >> ???? >>> I am in the middle of developing a new package, which contains a
> >> ???? >>> markdown-knitr-html vignette. When I try to run
> >> ???? >>>
> >> ???? >>> R CMD build [mypackagedirectory]
> >> ???? >>>
> >> ???? >>> I get an error message
> >> ???? >>>
> >> ???? >>> Quitting from lines 330-336
> >> ???? >>> Error: processing vignette? failed with diagnostics:
> >> ???? >>> invalid z limits
> >> ???? >>>
> >> ???? >>> If I run the same markdown script interactively inside R
> >> ??? Studio, there
> >> ???? >>> is no error.
> >> ???? >>> If I knit the markdown script inside R Studio, it produces the
> >> ??? correct
> >> ???? >>> HTML output, with no error.
> >> ???? >>>
> >> ???? >>> The offending lines of code (the chunk at 330-336) invoke an
> >> ??? "image"
> >> ???? >>> method on an object of a class defined in the package, which in
> >> ??? turn
> >> ???? >>> computes a matrix from items inside the object and calls
> >> ??? image.default,
> >> ???? >>> which is presumably where the error is coming from.
> >> ???? >>>
> >> ???? >>> Two questions: (1) How is it possible that the same code works
> >> ??? error
> >> ???? >>> free in the RStudio contexts, but fails in the attempt to build
> >> ??? the
> >> ???? >>> package?
> >> ???? >>> (2) Any suggestions on how to debug something that only throws
> >> ??? an error
> >> ???? >>> from "R CMD build" would be most welcome.
> >> ???? >>
> >> ???? >> Debugging that sort of thing is hard.? Here's what I would try:
> >> ???? >>
> >> ???? >> From inside an R session, run
> >> ???? >>
> >> ???? >> ? tools:::.build_packages("[mypackagedirectory]")
> >> ???? >>
> >> ???? >> That runs the code that R CMD build runs, so it might trigger
> >> ??? the same
> >> ???? >> error.? If so, debug in the usual way, with traceback(), etc.
> >> ???? >>
> >> ???? >> If that doesn't trigger the error, try it using a different
> >> ??? front-end,
> >> ???? >> e.g. running R at the command line instead of running it in 
> >> RStudio.
> >> ???? >>
> >> ???? >> If you still can't trigger it, then start modifying the 
> >> vignette to
> >> ???? >> find the exact line that causes the error (e.g. by commenting
> >> ??? out the
> >> ???? >> second half of the code in that chunk; did the error go away?
> >> ??? etc.).
> >> ???? >> Then modify it again to save all the inputs to the bad line in a
> >> ??? file
> >> ???? >> before running it, and see if running that line in a different
> >> ??? context
> >> ???? >> still triggers the error. Etc.
> >> ???? >>
> >> ???? >> Duncan Murdoch
> >> ???? >
> >> ???? > ______________________________________________
> >> ???? > R-package-devel at r-project.org
> >> ??? <mailto:R-package-devel at r-project.org> mailing list
> >> ???? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >> ??? <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> >>
> > 
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> -- 
> Dr. Benjamin Bolker
> Professor, Mathematics & Statistics and Biology, McMaster University
> Director, School of Computational Science and Engineering
> (Acting) Graduate chair, Mathematics & Statistics
>  > E-mail is sent at my convenience; I don't expect replies outside of 
> working hours.
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

William Becker PhD
willbecker.me (https://www.willbecker.me/)
See our new project at compositeindicators.com (https://compositeindicators.com/)


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Mon Jan  9 20:44:02 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Mon, 9 Jan 2023 14:44:02 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
 <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
 <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
Message-ID: <5f8dde15-38a0-d8fc-b2d4-53eb3be4bca4@gmail.com>

Did you have to split the packages to get the CI/CD tools to work? 
Because,to me, it looks as though I can install multiple different R 
packages from the same git project, using something like

library(devtools)
install_gitlab("krcoombes/[PROJECT]", "pkg/[PACKAGE]")

Best,
 ? Kevin

On 1/8/2023 1:38 PM, Spencer Graves wrote:
>
> ????? R-Forge was wonderful for me when I started using it.? Then 
> several years ago, I started having problems like you described. A few 
> years ago I migrated from R-Forge to GitHub.
>
>
> ????? One problem I encountered in the transition:? On R-Forge, I had 
> multiple packages in the same R-Forge project.? I had to split them 
> apart for GitHub.


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Fri Jan 13 09:54:50 2023
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Fri, 13 Jan 2023 08:54:50 +0000
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
Message-ID: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Dear list members,

I am getting the following response when I try to upload growthPheno_2.1.17.tar.gz:

Detected package information [non-editable]
In case of errors reupload the package or contact cran team

The package was successfully uploaded on 2022-11-15. It is available on https://github.com/briencj/growthPheno.

I have scoured the DESCRIPTION file and compared it with the DESCRIPTION file for dae, another of my packages that has been successfully uploaded in the last 12 hours.

I have run R CMD  --as-cran growthPheno_2.1.17.tar.gz with the final status being OK.

I am stumped as to what is causing the problem. Can anyone throw any lot on what the problem might be?

Thanks in advance,

Cheers,

 Chris

Chris Brien | Senior Biostatistician
Australian Plant Phenomics Facility


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan 13 15:06:33 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 13 Jan 2023 17:06:33 +0300
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
In-Reply-To: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
References: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <20230113170633.55feee95@arachnoid>

? Fri, 13 Jan 2023 08:54:50 +0000
Chris Brien <chris.brien at adelaide.edu.au> ?????:

> I am getting the following response when I try to upload
> growthPheno_2.1.17.tar.gz:
> 
> Detected package information [non-editable]
> In case of errors reupload the package or contact cran team

That's not an error. This message is to inform you that the following
fields have been extracted from your DESCRIPTION file and aren't
supposed to be edited by hand. Is there a better way to phrase that?

Do you see anything out of place in the form? If the form content seems
OK, click the "Submit package" button near the bottom of the page to
continue.

-- 
Best regards,
Ivan


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Fri Jan 13 22:51:01 2023
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Fri, 13 Jan 2023 21:51:01 +0000
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
In-Reply-To: <20230113170633.55feee95@arachnoid>
References: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <20230113170633.55feee95@arachnoid>
Message-ID: <ME4P282MB12871E95DE9FD0305FC00159A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Hi Ivan,

Thanks for taking up my query.

I realized after I sent the message that I should have added that the package files is being dropped as well. It replaces my file name with "No file chosen".  Consequently I cannot continue submit the package.

I saw it as an error message because it is not a message that I have seen in the many times that I have uploaded a package to CRAN.

My interpretation of the message was that there is some "non-editable" material in the package information, most likely the DESCRIPTION file.

However, I doubted that this could be the case because the only changes in the DESCRIPTION file since I uploaded Version 2.1.16 two months ago are in the Version, Date, Packaged and Suggests, the latter having writeXLS removed because it is no longer needed.  I have verified that these are the only changed by extracting the DESCRIPTION file from both growthPheno_2.1.16 and 2.1.17 and doing a file comparison on them.

This led me to think that the problem must be in other than the DESCRIPTION file.

Unfortunately, I remain unable to upload the package.

Cheers,

  Chris



> -----Original Message-----
> From: Ivan Krylov <krylov.r00t at gmail.com>
> Sent: Saturday, 14 January 2023 12:37 AM
> To: Chris Brien <chris.brien at adelaide.edu.au>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
>
> CAUTION: External email. Only click on links or open attachments from
> trusted senders.
>
> ? Fri, 13 Jan 2023 08:54:50 +0000
> Chris Brien <chris.brien at adelaide.edu.au> ?????:
>
> > I am getting the following response when I try to upload
> > growthPheno_2.1.17.tar.gz:
> >
> > Detected package information [non-editable] In case of errors reupload
> > the package or contact cran team
>
> That's not an error. This message is to inform you that the following fields
> have been extracted from your DESCRIPTION file and aren't supposed to be
> edited by hand. Is there a better way to phrase that?
>
> Do you see anything out of place in the form? If the form content seems OK,
> click the "Submit package" button near the bottom of the page to continue.
>
> --
> Best regards,
> Ivan


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan 13 23:15:13 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 14 Jan 2023 01:15:13 +0300
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
In-Reply-To: <ME4P282MB12871E95DE9FD0305FC00159A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
References: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <20230113170633.55feee95@arachnoid>
 <ME4P282MB12871E95DE9FD0305FC00159A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <20230114011513.4456b7b6@Tarkus>

On Fri, 13 Jan 2023 21:51:01 +0000
Chris Brien <chris.brien at adelaide.edu.au> wrote:

> the package files is being dropped as well. It replaces my file name
> with "No file chosen".  Consequently I cannot continue submit the
> package.

I understand that this behaviour is counter-intuitive, but that seems
to be the way it's supposed to work. Package submission is a multi-step
process:

Step 1 involves providing your name, your e-mail address and the
package file. Once uploaded, the package file stays somewhere at CRAN,
at least for a while.

Step 2 involves making sure that you've uploaded the right package.
You're shown your name, e-mail address, the optional comment and the
fields from the DESCRIPTION file. The "Package:" file upload field
should be empty because CRAN already has a copy of the file.

Pressing the "Re-upload the package/Edit information" will repeat the
step 1 and take you back to the same place, just before the step 2. In
order to progress, you need to press the "Submit package" button below
the form, despite the "Package:" file upload field is empty.

Do the "Title:", "Description:", "Authors(s):" fields contain the
information for your package? Does the "Submit package" button work for
you? Are there any other messages there?

Perhaps the CRAN submission form should show some indication that the
file has been uploaded near the file entry field during step 2?

-- 
Best regards,
Ivan


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Fri Jan 13 23:59:45 2023
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Fri, 13 Jan 2023 22:59:45 +0000
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
In-Reply-To: <20230114011513.4456b7b6@Tarkus>
References: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <20230113170633.55feee95@arachnoid>
 <ME4P282MB12871E95DE9FD0305FC00159A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <20230114011513.4456b7b6@Tarkus>
Message-ID: <ME4P282MB1287C1704A5378D233B1CA7FA0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Hi Ivan,

The submit button has worked!!!!

You are right that it is counterintuitive and I have been well trained not to submit things to CRAN that contain errors :-)

I agree that something like "Package uploaded" would be better than "No file chosen" in Stage 2, afterall I have chosen a file.

Thanks very much for your help. All's well that ends well.

Cheers,

  Chris



> -----Original Message-----
> From: Ivan Krylov <krylov.r00t at gmail.com>
> Sent: Saturday, 14 January 2023 8:45 AM
> To: Chris Brien <chris.brien at adelaide.edu.au>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
>
> CAUTION: External email. Only click on links or open attachments from
> trusted senders.
>
> On Fri, 13 Jan 2023 21:51:01 +0000
> Chris Brien <chris.brien at adelaide.edu.au> wrote:
>
> > the package files is being dropped as well. It replaces my file name
> > with "No file chosen".  Consequently I cannot continue submit the
> > package.
>
> I understand that this behaviour is counter-intuitive, but that seems to be
> the way it's supposed to work. Package submission is a multi-step
> process:
>
> Step 1 involves providing your name, your e-mail address and the package
> file. Once uploaded, the package file stays somewhere at CRAN, at least for a
> while.
>
> Step 2 involves making sure that you've uploaded the right package.
> You're shown your name, e-mail address, the optional comment and the
> fields from the DESCRIPTION file. The "Package:" file upload field should be
> empty because CRAN already has a copy of the file.
>
> Pressing the "Re-upload the package/Edit information" will repeat the step 1
> and take you back to the same place, just before the step 2. In order to
> progress, you need to press the "Submit package" button below the form,
> despite the "Package:" file upload field is empty.
>
> Do the "Title:", "Description:", "Authors(s):" fields contain the information for
> your package? Does the "Submit package" button work for you? Are there
> any other messages there?
>
> Perhaps the CRAN submission form should show some indication that the file
> has been uploaded near the file entry field during step 2?
>
> --
> Best regards,
> Ivan


From m@|zhou @end|ng |rom gm@||@com  Thu Jan 19 05:00:35 2023
From: m@|zhou @end|ng |rom gm@||@com (mai zhou)
Date: Wed, 18 Jan 2023 23:00:35 -0500
Subject: [R-pkg-devel] Rcmd check skip example
Message-ID: <CAJGy0hd219xgqs0_gfiu_gQRNfZHcq+u7Qx1+hXV9iNQE2TjJA@mail.gmail.com>

Hi,

In the process of adding examples to the .RD file, I noticed
Rcmd check seems to skip certain example code.

I put my example code  x%*%y%*%z  (matrix multiplication) in the
RD file. After running Rcmd check
(on windows) and look into the xxx.Rcheck directory,
  xxx-EX.ROUT  file, it seems that the example check stopped
 at x (i.e. everything after % sign is ignored, like LaTeX).

That seems like a bug. Can anyone confirm on newer version?

Mine:

> sessionInfo()
R version 4.1.2 (2021-11-01)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 22621)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.2    emplikAUC_0.3     rootSolve_1.8.2.3 emplik2_1.32
>


Mm... I have Win11, why the sessionInfo() say W10 ?  (but that is something
else)

best,

Mai Zhou

	[[alternative HTML version deleted]]


From @kw@|mmo @end|ng |rom gm@||@com  Thu Jan 19 05:17:57 2023
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Wed, 18 Jan 2023 23:17:57 -0500
Subject: [R-pkg-devel] Rcmd check skip example
In-Reply-To: <CAJGy0hd219xgqs0_gfiu_gQRNfZHcq+u7Qx1+hXV9iNQE2TjJA@mail.gmail.com>
References: <CAJGy0hd219xgqs0_gfiu_gQRNfZHcq+u7Qx1+hXV9iNQE2TjJA@mail.gmail.com>
Message-ID: <CAPcHnpQguvFBWCmCQBObcu9UXvtLQ=yTdiJKzZjrdH5ExARBBQ@mail.gmail.com>

Rd documentation is latex like, so comments can be included with a percent
symbol. You should write \% if you intend to write a literal percent
symbol.

On Wed, Jan 18, 2023, 23:00 mai zhou <maizhou at gmail.com> wrote:

> Hi,
>
> In the process of adding examples to the .RD file, I noticed
> Rcmd check seems to skip certain example code.
>
> I put my example code  x%*%y%*%z  (matrix multiplication) in the
> RD file. After running Rcmd check
> (on windows) and look into the xxx.Rcheck directory,
>   xxx-EX.ROUT  file, it seems that the example check stopped
>  at x (i.e. everything after % sign is ignored, like LaTeX).
>
> That seems like a bug. Can anyone confirm on newer version?
>
> Mine:
>
> > sessionInfo()
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 10 x64 (build 22621)
>
> Matrix products: default
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2    emplikAUC_0.3     rootSolve_1.8.2.3 emplik2_1.32
> >
>
>
> Mm... I have Win11, why the sessionInfo() say W10 ?  (but that is something
> else)
>
> best,
>
> Mai Zhou
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Thu Jan 19 11:57:21 2023
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Thu, 19 Jan 2023 11:57:21 +0100
Subject: [R-pkg-devel] Rcmd check skip example
In-Reply-To: <CAJGy0hd219xgqs0_gfiu_gQRNfZHcq+u7Qx1+hXV9iNQE2TjJA@mail.gmail.com>
References: <CAJGy0hd219xgqs0_gfiu_gQRNfZHcq+u7Qx1+hXV9iNQE2TjJA@mail.gmail.com>
Message-ID: <1ac52482-6907-e516-a371-2cb850c82015@gmail.com>


On 1/19/23 05:00, mai zhou wrote:
> Hi,
>
> In the process of adding examples to the .RD file, I noticed
> Rcmd check seems to skip certain example code.
>
> I put my example code  x%*%y%*%z  (matrix multiplication) in the
> RD file. After running Rcmd check
> (on windows) and look into the xxx.Rcheck directory,
>    xxx-EX.ROUT  file, it seems that the example check stopped
>   at x (i.e. everything after % sign is ignored, like LaTeX).
>
> That seems like a bug. Can anyone confirm on newer version?
>
> Mine:
>
>> sessionInfo()
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 10 x64 (build 22621)
>
> Matrix products: default
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2    emplikAUC_0.3     rootSolve_1.8.2.3 emplik2_1.32
>
> Mm... I have Win11, why the sessionInfo() say W10 ?  (but that is something
> else)

R 4.1.0 was released before Windows 11, but even in R-devel, 
sessionInfo() reports "Windows 10" on "Windows 11". The problem is that 
the information comes from win.version()/GetVersionEx() and, as also 
documented in ?win.version, this may return "compatibility version".

With the already released versions of R and current R-devel, one can 
tell Windows 11 from the build number (your 22621 is Windows 11 22H2, 
22000 is Windows 11 21H2).

Thanks for spotting and reporting this.

Tomas

>
> best,
>
> Mai Zhou
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Thu Jan 19 12:33:42 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Thu, 19 Jan 2023 12:33:42 +0100
Subject: [R-pkg-devel] Rcmd check skip example
In-Reply-To: <1ac52482-6907-e516-a371-2cb850c82015@gmail.com>
References: <CAJGy0hd219xgqs0_gfiu_gQRNfZHcq+u7Qx1+hXV9iNQE2TjJA@mail.gmail.com>
 <1ac52482-6907-e516-a371-2cb850c82015@gmail.com>
Message-ID: <f4428811-9949-414e-3722-2ae795f836b8@statistik.tu-dortmund.de>



On 19.01.2023 11:57, Tomas Kalibera wrote:
> 
> On 1/19/23 05:00, mai zhou wrote:
>> Hi,
>>
>> In the process of adding examples to the .RD file, I noticed
>> Rcmd check seems to skip certain example code.
>>
>> I put my example code? x%*%y%*%z? (matrix multiplication) in the
>> RD file. After running Rcmd check
>> (on windows) and look into the xxx.Rcheck directory,
>> ?? xxx-EX.ROUT? file, it seems that the example check stopped
>> ? at x (i.e. everything after % sign is ignored, like LaTeX).
>>
>> That seems like a bug. Can anyone confirm on newer version?
>>
>> Mine:
>>
>>> sessionInfo()
>> R version 4.1.2 (2021-11-01)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows 10 x64 (build 22621)
>>
>> Matrix products: default
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252
>> [2] LC_CTYPE=English_United States.1252
>> [3] LC_MONETARY=English_United States.1252
>> [4] LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats???? graphics? grDevices utils???? datasets? methods?? base
>>
>> loaded via a namespace (and not attached):
>> [1] compiler_4.1.2??? emplikAUC_0.3???? rootSolve_1.8.2.3 emplik2_1.32
>>
>> Mm... I have Win11, why the sessionInfo() say W10 ?? (but that is 
>> something
>> else)
> 
> R 4.1.0 was released before Windows 11, but even in R-devel, 
> sessionInfo() reports "Windows 10" on "Windows 11". The problem is that 
> the information comes from win.version()/GetVersionEx() and, as also 
> documented in ?win.version, this may return "compatibility version".
> 
> With the already released versions of R and current R-devel, one can 
> tell Windows 11 from the build number (your 22621 is Windows 11 22H2, 
> 22000 is Windows 11 21H2).

Indeed, the versions from 10.0.22000 are called Windows 11.
Windows 10 builds are expected to stay below 10.0.22000.
It is up to Microsoft why the label their version 10.x.y as Windows 11 
(well, they labelled version 5.x.y as Windows 2000 etc., so nothing new 
here).

Best,
Uwe Ligges



> 
> Thanks for spotting and reporting this.
> 
> Tomas
> 
>>
>> best,
>>
>> Mai Zhou
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Fri Jan 20 15:41:25 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Fri, 20 Jan 2023 08:41:25 -0600
Subject: [R-pkg-devel] corrupted NAMESPACE file
Message-ID: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>

Hello, All:


	  The NAMESPACE file in


https://github.com/JamesRamsay5/fda


is corrupted.  RStudio 2022.12.0+353 (the current version) won't open 
it, complaining, "File is binary rather than text so cannot be opened by 
the source editor."  TextEdit (macOS 11.7.2) opened it as normal, as did 
vi.  Both allowed me to make and save changes, but RStudio still gave 
the same error.  Worse, after "git push", GitHub Action on 5 platforms 
ended with:


** byte-compile and prepare package for lazy loading
Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
   1:1: unexpected input


	  That's the same error I've gotten with "R CMD build fda" locally.


	  Suggestions?
	  Thanks,
	  Spencer Graves


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan 20 15:53:56 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 20 Jan 2023 17:53:56 +0300
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
Message-ID: <20230120175356.5d529f5e@arachnoid>

? Fri, 20 Jan 2023 08:41:25 -0600
Spencer Graves <spencer.graves at effectivedefense.org> ?????:

> ** byte-compile and prepare package for lazy loading
> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>    1:1: unexpected input

tools::showNonASCIIfile('https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
# 1: <ef><bb><bf>export(AmpPhaseDecomp,

Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
You'll need to remove it, e.g. by re-creating the first line.

-- 
Best regards,
Ivan


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Fri Jan 20 16:22:46 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Fri, 20 Jan 2023 16:22:46 +0100
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <20230120175356.5d529f5e@arachnoid>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
Message-ID: <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>



On 20.01.2023 15:53, Ivan Krylov wrote:
> ? Fri, 20 Jan 2023 08:41:25 -0600
> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
> 
>> ** byte-compile and prepare package for lazy loading
>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>     1:1: unexpected input
> 
> tools::showNonASCIIfile('https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
> 
> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
> You'll need to remove it, e.g. by re-creating the first line.


Note that this is also called "byte order mark" (BOM). Tell your editor 
not to create files with BOM.

You can also fix in R:

x <- readLines(..., encoding="UTF-8-BOM")
writeLines(x, ......)

Best,
Uwe Ligges


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Fri Jan 20 18:15:52 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Fri, 20 Jan 2023 11:15:52 -0600
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
Message-ID: <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>

Hi, Ivan and Uwe:


	  Thanks for your suggestions, but I've so far been unable to get them 
to work.  see below.


On 1/20/23 9:22 AM, Uwe Ligges wrote:
> 
> 
> On 20.01.2023 15:53, Ivan Krylov wrote:
>> ? Fri, 20 Jan 2023 08:41:25 -0600
>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>
>>> ** byte-compile and prepare package for lazy loading
>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>> ??? 1:1: unexpected input
>>
>> tools::showNonASCIIfile('https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>
>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>> You'll need to remove it, e.g. by re-creating the first line.
> 
> 
> Note that this is also called "byte order mark" (BOM). Tell your editor 
> not to create files with BOM.
> 
> You can also fix in R:
> 
> x <- readLines(..., encoding="UTF-8-BOM")
> writeLines(x, ......)


	  In RStudio 2022.12.0+353 (the current version),


tools::showNonASCIIfile('https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')


returned "char(0)".  'readLines' and 'writeLines' as Uwe suggested 
failed to fix it for me.


	  The first problem I noticed with this was that RStudio could not read 
the NAMESPACE file.  When I tried, it said, "File is binary rather than 
text so cannot be opened by the source editor."  I changed something 
using a different editor and did "git commit" and "git push", and got 
the error on GitHub that I reported above.  I copied the file elsewhere, 
deleted it locally and from GitHub, then recreated it in LibreOffice by 
manually typing the first and last lines then copying the rest from a 
copy I had saved elsewhere.  The RStudio would open the file, but I 
still get the same error message as above from both "R CMD build fda" 
locally and from GitHub Action at:


https://github.com/JamesRamsay5/fda


	  Other suggestions?
	  Thanks,
	  Spencer Graves

> 
> Best,
> Uwe Ligges
> 
> 
> 
> 
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Jan 20 18:38:51 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 20 Jan 2023 12:38:51 -0500
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
Message-ID: <34d5c077-c429-8981-75c6-a7c9cc9c01ed@gmail.com>

On 20/01/2023 12:15 p.m., Spencer Graves wrote:
> Hi, Ivan and Uwe:
> 
> 
> 	  Thanks for your suggestions, but I've so far been unable to get them
> to work.  see below.
> 
> 
> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>
>>
>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>
>>>> ** byte-compile and prepare package for lazy loading
>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>  ??? 1:1: unexpected input
>>>
>>> tools::showNonASCIIfile('https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>
>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>>> You'll need to remove it, e.g. by re-creating the first line.
>>
>>
>> Note that this is also called "byte order mark" (BOM). Tell your editor
>> not to create files with BOM.
>>
>> You can also fix in R:
>>
>> x <- readLines(..., encoding="UTF-8-BOM")
>> writeLines(x, ......)
> 
> 
> 	  In RStudio 2022.12.0+353 (the current version),
> 
> 
> tools::showNonASCIIfile('https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> 
> 
> returned "char(0)".  'readLines' and 'writeLines' as Uwe suggested
> failed to fix it for me.
> 
> 
> 	  The first problem I noticed with this was that RStudio could not read
> the NAMESPACE file.  When I tried, it said, "File is binary rather than
> text so cannot be opened by the source editor."  I changed something
> using a different editor and did "git commit" and "git push", and got
> the error on GitHub that I reported above.  I copied the file elsewhere,
> deleted it locally and from GitHub, then recreated it in LibreOffice by
> manually typing the first and last lines then copying the rest from a
> copy I had saved elsewhere.  The RStudio would open the file, but I
> still get the same error message as above from both "R CMD build fda"
> locally and from GitHub Action at:
> 
> 
> https://github.com/JamesRamsay5/fda
> 
> 
> 	  Other suggestions?

I think Uwe's suggestion was to check out the file, apply his two steps, 
and commit it again.  Your showNonASCIIfile() call was trying to work on 
something else.  Maybe your other commands were too?

Another possibility is to roll back all your changes to that file until 
you have a copy you can work with.  I think commit ab455089 is probably 
the bad one; Github shows invisible changes to the first line.  You 
don't want those.

Duncan Murdoch


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Jan 20 19:03:42 2023
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Fri, 20 Jan 2023 10:03:42 -0800
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
Message-ID: <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>

Setting the locale to "C" (or perhaps some other non-UTF-8 locale) will
show the BOM bytes.  E.g., on Windows I get:

> Sys.getlocale()
[1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
States.utf8;LC_MONETARY=English_United
States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
> tools::showNonASCIIfile('
https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> rawToChar(readBin('
https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
what="raw", n=20))
[1] "?export(AmpPhasDec"
> Sys.setlocale(locale="C")
[1] "C"
> tools::showNonASCIIfile('
https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
1: <ef><bb><bf>export(AmpPhasDecomp,
> rawToChar(readBin('
https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
what="raw", n=20))
[1] "\357\273\277export(AmpPhasDec"

-Bill


On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
spencer.graves at effectivedefense.org> wrote:

> Hi, Ivan and Uwe:
>
>
>           Thanks for your suggestions, but I've so far been unable to get
> them
> to work.  see below.
>
>
> On 1/20/23 9:22 AM, Uwe Ligges wrote:
> >
> >
> > On 20.01.2023 15:53, Ivan Krylov wrote:
> >> ? Fri, 20 Jan 2023 08:41:25 -0600
> >> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
> >>
> >>> ** byte-compile and prepare package for lazy loading
> >>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
> >>>     1:1: unexpected input
> >>
> >> tools::showNonASCIIfile('
> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> >> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
> >>
> >> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
> >> You'll need to remove it, e.g. by re-creating the first line.
> >
> >
> > Note that this is also called "byte order mark" (BOM). Tell your editor
> > not to create files with BOM.
> >
> > You can also fix in R:
> >
> > x <- readLines(..., encoding="UTF-8-BOM")
> > writeLines(x, ......)
>
>
>           In RStudio 2022.12.0+353 (the current version),
>
>
> tools::showNonASCIIfile('
> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>
>
> returned "char(0)".  'readLines' and 'writeLines' as Uwe suggested
> failed to fix it for me.
>
>
>           The first problem I noticed with this was that RStudio could not
> read
> the NAMESPACE file.  When I tried, it said, "File is binary rather than
> text so cannot be opened by the source editor."  I changed something
> using a different editor and did "git commit" and "git push", and got
> the error on GitHub that I reported above.  I copied the file elsewhere,
> deleted it locally and from GitHub, then recreated it in LibreOffice by
> manually typing the first and last lines then copying the rest from a
> copy I had saved elsewhere.  The RStudio would open the file, but I
> still get the same error message as above from both "R CMD build fda"
> locally and from GitHub Action at:
>
>
> https://github.com/JamesRamsay5/fda
>
>
>           Other suggestions?
>           Thanks,
>           Spencer Graves
>
> >
> > Best,
> > Uwe Ligges
> >
> >
> >
> >
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From greg @end|ng |rom ||rm@n@y@h@com  Sat Jan 21 00:02:51 2023
From: greg @end|ng |rom ||rm@n@y@h@com (Greg Hunt)
Date: Sat, 21 Jan 2023 10:02:51 +1100
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
Message-ID: <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>

xFEFF isn't a BOM in a UTF-8 file, its not anything.   The UTF-8 BOM is a
different sequence of bits.  If tools treat it as a BOM, that is arguably a
problem.

On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com> wrote:

> Setting the locale to "C" (or perhaps some other non-UTF-8 locale) will
> show the BOM bytes.  E.g., on Windows I get:
>
> > Sys.getlocale()
> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
> States.utf8;LC_MONETARY=English_United
> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
> > tools::showNonASCIIfile('
> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> > rawToChar(readBin('
> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
> what="raw", n=20))
> [1] "?export(AmpPhasDec"
> > Sys.setlocale(locale="C")
> [1] "C"
> > tools::showNonASCIIfile('
> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> 1: <ef><bb><bf>export(AmpPhasDecomp,
> > rawToChar(readBin('
> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
> what="raw", n=20))
> [1] "\357\273\277export(AmpPhasDec"
>
> -Bill
>
>
> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
> spencer.graves at effectivedefense.org> wrote:
>
> > Hi, Ivan and Uwe:
> >
> >
> >           Thanks for your suggestions, but I've so far been unable to get
> > them
> > to work.  see below.
> >
> >
> > On 1/20/23 9:22 AM, Uwe Ligges wrote:
> > >
> > >
> > > On 20.01.2023 15:53, Ivan Krylov wrote:
> > >> ? Fri, 20 Jan 2023 08:41:25 -0600
> > >> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
> > >>
> > >>> ** byte-compile and prepare package for lazy loading
> > >>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
> > >>>     1:1: unexpected input
> > >>
> > >> tools::showNonASCIIfile('
> > https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> > >> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
> > >>
> > >> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
> > >> You'll need to remove it, e.g. by re-creating the first line.
> > >
> > >
> > > Note that this is also called "byte order mark" (BOM). Tell your editor
> > > not to create files with BOM.
> > >
> > > You can also fix in R:
> > >
> > > x <- readLines(..., encoding="UTF-8-BOM")
> > > writeLines(x, ......)
> >
> >
> >           In RStudio 2022.12.0+353 (the current version),
> >
> >
> > tools::showNonASCIIfile('
> > https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> >
> >
> > returned "char(0)".  'readLines' and 'writeLines' as Uwe suggested
> > failed to fix it for me.
> >
> >
> >           The first problem I noticed with this was that RStudio could
> not
> > read
> > the NAMESPACE file.  When I tried, it said, "File is binary rather than
> > text so cannot be opened by the source editor."  I changed something
> > using a different editor and did "git commit" and "git push", and got
> > the error on GitHub that I reported above.  I copied the file elsewhere,
> > deleted it locally and from GitHub, then recreated it in LibreOffice by
> > manually typing the first and last lines then copying the rest from a
> > copy I had saved elsewhere.  The RStudio would open the file, but I
> > still get the same error message as above from both "R CMD build fda"
> > locally and from GitHub Action at:
> >
> >
> > https://github.com/JamesRamsay5/fda
> >
> >
> >           Other suggestions?
> >           Thanks,
> >           Spencer Graves
> >
> > >
> > > Best,
> > > Uwe Ligges
> > >
> > >
> > >
> > >
> > >
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jan 21 00:08:34 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 20 Jan 2023 18:08:34 -0500
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
 <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
Message-ID: <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>

On 20/01/2023 6:02 p.m., Greg Hunt wrote:
> xFEFF isn't a BOM in a UTF-8 file, its not anything.   The UTF-8 BOM is a
> different sequence of bits.  If tools treat it as a BOM, that is arguably a
> problem.

You're right.  FEFF is the UTF-16 big endian BOM.  UTF-16 is a 16 bit 
encoding, not at all the same as UTF-8.  I don't know how to read UTF-16 
in R. Uwe's advice was for UTF-8.

Duncan Murdoch

> 
> On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com> wrote:
> 
>> Setting the locale to "C" (or perhaps some other non-UTF-8 locale) will
>> show the BOM bytes.  E.g., on Windows I get:
>>
>>> Sys.getlocale()
>> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
>> States.utf8;LC_MONETARY=English_United
>> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
>>> tools::showNonASCIIfile('
>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>> rawToChar(readBin('
>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>> what="raw", n=20))
>> [1] "?export(AmpPhasDec"
>>> Sys.setlocale(locale="C")
>> [1] "C"
>>> tools::showNonASCIIfile('
>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>> 1: <ef><bb><bf>export(AmpPhasDecomp,
>>> rawToChar(readBin('
>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>> what="raw", n=20))
>> [1] "\357\273\277export(AmpPhasDec"
>>
>> -Bill
>>
>>
>> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
>> spencer.graves at effectivedefense.org> wrote:
>>
>>> Hi, Ivan and Uwe:
>>>
>>>
>>>            Thanks for your suggestions, but I've so far been unable to get
>>> them
>>> to work.  see below.
>>>
>>>
>>> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>>>
>>>>
>>>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>>>
>>>>>> ** byte-compile and prepare package for lazy loading
>>>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>>>      1:1: unexpected input
>>>>>
>>>>> tools::showNonASCIIfile('
>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>>>
>>>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>>>>> You'll need to remove it, e.g. by re-creating the first line.
>>>>
>>>>
>>>> Note that this is also called "byte order mark" (BOM). Tell your editor
>>>> not to create files with BOM.
>>>>
>>>> You can also fix in R:
>>>>
>>>> x <- readLines(..., encoding="UTF-8-BOM")
>>>> writeLines(x, ......)
>>>
>>>
>>>            In RStudio 2022.12.0+353 (the current version),
>>>
>>>
>>> tools::showNonASCIIfile('
>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>
>>>
>>> returned "char(0)".  'readLines' and 'writeLines' as Uwe suggested
>>> failed to fix it for me.
>>>
>>>
>>>            The first problem I noticed with this was that RStudio could
>> not
>>> read
>>> the NAMESPACE file.  When I tried, it said, "File is binary rather than
>>> text so cannot be opened by the source editor."  I changed something
>>> using a different editor and did "git commit" and "git push", and got
>>> the error on GitHub that I reported above.  I copied the file elsewhere,
>>> deleted it locally and from GitHub, then recreated it in LibreOffice by
>>> manually typing the first and last lines then copying the rest from a
>>> copy I had saved elsewhere.  The RStudio would open the file, but I
>>> still get the same error message as above from both "R CMD build fda"
>>> locally and from GitHub Action at:
>>>
>>>
>>> https://github.com/JamesRamsay5/fda
>>>
>>>
>>>            Other suggestions?
>>>            Thanks,
>>>            Spencer Graves
>>>
>>>>
>>>> Best,
>>>> Uwe Ligges
>>>>
>>>>
>>>>
>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sat Jan 21 02:16:58 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Fri, 20 Jan 2023 19:16:58 -0600
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
 <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
 <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>
Message-ID: <b80a813c-d02e-0f4f-d8f5-6671a39711c0@effectivedefense.org>

Hello, All:


	  My attempts to fix this problem exposed what seems to be a completely 
unrelated problem:  All five GitHub Actions end now with:


Error: package or namespace load failed for ?fda? in namespaceExport(ns, 
exports):
  undefined exports: refinery


	  The package includes ~man/refinery.Rd, ~data/refinery.rda, and 
NAMESPACE includes "export( ... refinery, ...)".


	  ???
	  I have Bitdefender installed on this computer.  A "Quick Scan" 
produced nothing just now.


	  Thanks,
	  Spencer


On 1/20/23 5:08 PM, Duncan Murdoch wrote:
> On 20/01/2023 6:02 p.m., Greg Hunt wrote:
>> xFEFF isn't a BOM in a UTF-8 file, its not anything.?? The UTF-8 BOM is a
>> different sequence of bits.? If tools treat it as a BOM, that is 
>> arguably a
>> problem.
> 
> You're right.? FEFF is the UTF-16 big endian BOM.? UTF-16 is a 16 bit 
> encoding, not at all the same as UTF-8.? I don't know how to read UTF-16 
> in R. Uwe's advice was for UTF-8.
> 
> Duncan Murdoch
> 
>>
>> On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com> 
>> wrote:
>>
>>> Setting the locale to "C" (or perhaps some other non-UTF-8 locale) will
>>> show the BOM bytes.? E.g., on Windows I get:
>>>
>>>> Sys.getlocale()
>>> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
>>> States.utf8;LC_MONETARY=English_United
>>> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
>>>> tools::showNonASCIIfile('
>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>> rawToChar(readBin('
>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>> what="raw", n=20))
>>> [1] "?export(AmpPhasDec"
>>>> Sys.setlocale(locale="C")
>>> [1] "C"
>>>> tools::showNonASCIIfile('
>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>> 1: <ef><bb><bf>export(AmpPhasDecomp,
>>>> rawToChar(readBin('
>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>> what="raw", n=20))
>>> [1] "\357\273\277export(AmpPhasDec"
>>>
>>> -Bill
>>>
>>>
>>> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
>>> spencer.graves at effectivedefense.org> wrote:
>>>
>>>> Hi, Ivan and Uwe:
>>>>
>>>>
>>>> ?????????? Thanks for your suggestions, but I've so far been unable 
>>>> to get
>>>> them
>>>> to work.? see below.
>>>>
>>>>
>>>> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>>>>
>>>>>
>>>>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>>>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>>>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>>>>
>>>>>>> ** byte-compile and prepare package for lazy loading
>>>>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>>>> ???? 1:1: unexpected input
>>>>>>
>>>>>> tools::showNonASCIIfile('
>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>>>>
>>>>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>>>>>> You'll need to remove it, e.g. by re-creating the first line.
>>>>>
>>>>>
>>>>> Note that this is also called "byte order mark" (BOM). Tell your 
>>>>> editor
>>>>> not to create files with BOM.
>>>>>
>>>>> You can also fix in R:
>>>>>
>>>>> x <- readLines(..., encoding="UTF-8-BOM")
>>>>> writeLines(x, ......)
>>>>
>>>>
>>>> ?????????? In RStudio 2022.12.0+353 (the current version),
>>>>
>>>>
>>>> tools::showNonASCIIfile('
>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>
>>>>
>>>> returned "char(0)".? 'readLines' and 'writeLines' as Uwe suggested
>>>> failed to fix it for me.
>>>>
>>>>
>>>> ?????????? The first problem I noticed with this was that RStudio could
>>> not
>>>> read
>>>> the NAMESPACE file.? When I tried, it said, "File is binary rather than
>>>> text so cannot be opened by the source editor."? I changed something
>>>> using a different editor and did "git commit" and "git push", and got
>>>> the error on GitHub that I reported above.? I copied the file 
>>>> elsewhere,
>>>> deleted it locally and from GitHub, then recreated it in LibreOffice by
>>>> manually typing the first and last lines then copying the rest from a
>>>> copy I had saved elsewhere.? The RStudio would open the file, but I
>>>> still get the same error message as above from both "R CMD build fda"
>>>> locally and from GitHub Action at:
>>>>
>>>>
>>>> https://github.com/JamesRamsay5/fda
>>>>
>>>>
>>>> ?????????? Other suggestions?
>>>> ?????????? Thanks,
>>>> ?????????? Spencer Graves
>>>>
>>>>>
>>>>> Best,
>>>>> Uwe Ligges
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>>> ???????? [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jan 21 02:32:45 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 20 Jan 2023 20:32:45 -0500
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <b80a813c-d02e-0f4f-d8f5-6671a39711c0@effectivedefense.org>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
 <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
 <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>
 <b80a813c-d02e-0f4f-d8f5-6671a39711c0@effectivedefense.org>
Message-ID: <5ee1615c-ad65-4985-8c39-55fd2be125de@gmail.com>

On 20/01/2023 8:16 p.m., Spencer Graves wrote:
> Hello, All:
> 
> 
> 	  My attempts to fix this problem exposed what seems to be a completely
> unrelated problem:  All five GitHub Actions end now with:
> 
> 
> Error: package or namespace load failed for ?fda? in namespaceExport(ns,
> exports):
>    undefined exports: refinery
> 
> 
> 	  The package includes ~man/refinery.Rd, ~data/refinery.rda, and
> NAMESPACE includes "export( ... refinery, ...)".


I think if you declare something as data by putting it in the data 
directory and using LazyData:true, you shouldn't also declare it as an 
export in the NAMESPACE file.

Duncan Murdoch

> 
> 
> 	  ???
> 	  I have Bitdefender installed on this computer.  A "Quick Scan"
> produced nothing just now.
> 
> 
> 	  Thanks,
> 	  Spencer
> 
> 
> On 1/20/23 5:08 PM, Duncan Murdoch wrote:
>> On 20/01/2023 6:02 p.m., Greg Hunt wrote:
>>> xFEFF isn't a BOM in a UTF-8 file, its not anything.?? The UTF-8 BOM is a
>>> different sequence of bits.? If tools treat it as a BOM, that is
>>> arguably a
>>> problem.
>>
>> You're right.? FEFF is the UTF-16 big endian BOM.? UTF-16 is a 16 bit
>> encoding, not at all the same as UTF-8.? I don't know how to read UTF-16
>> in R. Uwe's advice was for UTF-8.
>>
>> Duncan Murdoch
>>
>>>
>>> On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com>
>>> wrote:
>>>
>>>> Setting the locale to "C" (or perhaps some other non-UTF-8 locale) will
>>>> show the BOM bytes.? E.g., on Windows I get:
>>>>
>>>>> Sys.getlocale()
>>>> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
>>>> States.utf8;LC_MONETARY=English_United
>>>> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
>>>>> tools::showNonASCIIfile('
>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>> rawToChar(readBin('
>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>> what="raw", n=20))
>>>> [1] "?export(AmpPhasDec"
>>>>> Sys.setlocale(locale="C")
>>>> [1] "C"
>>>>> tools::showNonASCIIfile('
>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>> 1: <ef><bb><bf>export(AmpPhasDecomp,
>>>>> rawToChar(readBin('
>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>> what="raw", n=20))
>>>> [1] "\357\273\277export(AmpPhasDec"
>>>>
>>>> -Bill
>>>>
>>>>
>>>> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
>>>> spencer.graves at effectivedefense.org> wrote:
>>>>
>>>>> Hi, Ivan and Uwe:
>>>>>
>>>>>
>>>>>  ?????????? Thanks for your suggestions, but I've so far been unable
>>>>> to get
>>>>> them
>>>>> to work.? see below.
>>>>>
>>>>>
>>>>> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>>>>>
>>>>>>
>>>>>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>>>>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>>>>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>>>>>
>>>>>>>> ** byte-compile and prepare package for lazy loading
>>>>>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>>>>>  ???? 1:1: unexpected input
>>>>>>>
>>>>>>> tools::showNonASCIIfile('
>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>>>>>
>>>>>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>>>>>>> You'll need to remove it, e.g. by re-creating the first line.
>>>>>>
>>>>>>
>>>>>> Note that this is also called "byte order mark" (BOM). Tell your
>>>>>> editor
>>>>>> not to create files with BOM.
>>>>>>
>>>>>> You can also fix in R:
>>>>>>
>>>>>> x <- readLines(..., encoding="UTF-8-BOM")
>>>>>> writeLines(x, ......)
>>>>>
>>>>>
>>>>>  ?????????? In RStudio 2022.12.0+353 (the current version),
>>>>>
>>>>>
>>>>> tools::showNonASCIIfile('
>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>
>>>>>
>>>>> returned "char(0)".? 'readLines' and 'writeLines' as Uwe suggested
>>>>> failed to fix it for me.
>>>>>
>>>>>
>>>>>  ?????????? The first problem I noticed with this was that RStudio could
>>>> not
>>>>> read
>>>>> the NAMESPACE file.? When I tried, it said, "File is binary rather than
>>>>> text so cannot be opened by the source editor."? I changed something
>>>>> using a different editor and did "git commit" and "git push", and got
>>>>> the error on GitHub that I reported above.? I copied the file
>>>>> elsewhere,
>>>>> deleted it locally and from GitHub, then recreated it in LibreOffice by
>>>>> manually typing the first and last lines then copying the rest from a
>>>>> copy I had saved elsewhere.? The RStudio would open the file, but I
>>>>> still get the same error message as above from both "R CMD build fda"
>>>>> locally and from GitHub Action at:
>>>>>
>>>>>
>>>>> https://github.com/JamesRamsay5/fda
>>>>>
>>>>>
>>>>>  ?????????? Other suggestions?
>>>>>  ?????????? Thanks,
>>>>>  ?????????? Spencer Graves
>>>>>
>>>>>>
>>>>>> Best,
>>>>>> Uwe Ligges
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>
>>>>
>>>>  ???????? [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>>>  ????[[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sat Jan 21 03:47:34 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Fri, 20 Jan 2023 20:47:34 -0600
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <5ee1615c-ad65-4985-8c39-55fd2be125de@gmail.com>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
 <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
 <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>
 <b80a813c-d02e-0f4f-d8f5-6671a39711c0@effectivedefense.org>
 <5ee1615c-ad65-4985-8c39-55fd2be125de@gmail.com>
Message-ID: <21cf6c3c-07de-f0bf-8f80-c2cd5ab8f6b6@effectivedefense.org>



On 1/20/23 7:32 PM, Duncan Murdoch wrote:
> On 20/01/2023 8:16 p.m., Spencer Graves wrote:
>> Hello, All:
>>
>>
>> ????? My attempts to fix this problem exposed what seems to be a 
>> completely
>> unrelated problem:? All five GitHub Actions end now with:
>>
>>
>> Error: package or namespace load failed for ?fda? in namespaceExport(ns,
>> exports):
>> ?? undefined exports: refinery
>>
>>
>> ????? The package includes ~man/refinery.Rd, ~data/refinery.rda, and
>> NAMESPACE includes "export( ... refinery, ...)".
> 
> 
> I think if you declare something as data by putting it in the data 
> directory and using LazyData:true, you shouldn't also declare it as an 
> export in the NAMESPACE file.


	  I got the same negative results after deleting "LazyData: true" from 
DESCRIPTION.  (That's what I would expect, because there are 17 other 
*.rda files in the data subdirectory that are are mentioned in NAMESPACE 
and are not creating a problem.  In 2009 the package included both 
"data/refinery.rda" and "man/refinery.Rd".  They were erroneously 
removed at some point.  I'm now trying to restore them.)


	  Thanks,
	  Spencer

> 
> Duncan Murdoch
> 
>>
>>
>> ????? ???
>> ????? I have Bitdefender installed on this computer.? A "Quick Scan"
>> produced nothing just now.
>>
>>
>> ????? Thanks,
>> ????? Spencer
>>
>>
>> On 1/20/23 5:08 PM, Duncan Murdoch wrote:
>>> On 20/01/2023 6:02 p.m., Greg Hunt wrote:
>>>> xFEFF isn't a BOM in a UTF-8 file, its not anything.?? The UTF-8 BOM 
>>>> is a
>>>> different sequence of bits.? If tools treat it as a BOM, that is
>>>> arguably a
>>>> problem.
>>>
>>> You're right.? FEFF is the UTF-16 big endian BOM.? UTF-16 is a 16 bit
>>> encoding, not at all the same as UTF-8.? I don't know how to read UTF-16
>>> in R. Uwe's advice was for UTF-8.
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com>
>>>> wrote:
>>>>
>>>>> Setting the locale to "C" (or perhaps some other non-UTF-8 locale) 
>>>>> will
>>>>> show the BOM bytes.? E.g., on Windows I get:
>>>>>
>>>>>> Sys.getlocale()
>>>>> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
>>>>> States.utf8;LC_MONETARY=English_United
>>>>> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
>>>>>> tools::showNonASCIIfile('
>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>> rawToChar(readBin('
>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>>> what="raw", n=20))
>>>>> [1] "?export(AmpPhasDec"
>>>>>> Sys.setlocale(locale="C")
>>>>> [1] "C"
>>>>>> tools::showNonASCIIfile('
>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>> 1: <ef><bb><bf>export(AmpPhasDecomp,
>>>>>> rawToChar(readBin('
>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>>> what="raw", n=20))
>>>>> [1] "\357\273\277export(AmpPhasDec"
>>>>>
>>>>> -Bill
>>>>>
>>>>>
>>>>> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
>>>>> spencer.graves at effectivedefense.org> wrote:
>>>>>
>>>>>> Hi, Ivan and Uwe:
>>>>>>
>>>>>>
>>>>>> ??????????? Thanks for your suggestions, but I've so far been unable
>>>>>> to get
>>>>>> them
>>>>>> to work.? see below.
>>>>>>
>>>>>>
>>>>>> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>>>>>>
>>>>>>>
>>>>>>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>>>>>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>>>>>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>>>>>>
>>>>>>>>> ** byte-compile and prepare package for lazy loading
>>>>>>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>>>>>> ????? 1:1: unexpected input
>>>>>>>>
>>>>>>>> tools::showNonASCIIfile('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>>>>>>
>>>>>>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>>>>>>>> You'll need to remove it, e.g. by re-creating the first line.
>>>>>>>
>>>>>>>
>>>>>>> Note that this is also called "byte order mark" (BOM). Tell your
>>>>>>> editor
>>>>>>> not to create files with BOM.
>>>>>>>
>>>>>>> You can also fix in R:
>>>>>>>
>>>>>>> x <- readLines(..., encoding="UTF-8-BOM")
>>>>>>> writeLines(x, ......)
>>>>>>
>>>>>>
>>>>>> ??????????? In RStudio 2022.12.0+353 (the current version),
>>>>>>
>>>>>>
>>>>>> tools::showNonASCIIfile('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>
>>>>>>
>>>>>> returned "char(0)".? 'readLines' and 'writeLines' as Uwe suggested
>>>>>> failed to fix it for me.
>>>>>>
>>>>>>
>>>>>> ??????????? The first problem I noticed with this was that RStudio 
>>>>>> could
>>>>> not
>>>>>> read
>>>>>> the NAMESPACE file.? When I tried, it said, "File is binary rather 
>>>>>> than
>>>>>> text so cannot be opened by the source editor."? I changed something
>>>>>> using a different editor and did "git commit" and "git push", and got
>>>>>> the error on GitHub that I reported above.? I copied the file
>>>>>> elsewhere,
>>>>>> deleted it locally and from GitHub, then recreated it in 
>>>>>> LibreOffice by
>>>>>> manually typing the first and last lines then copying the rest from a
>>>>>> copy I had saved elsewhere.? The RStudio would open the file, but I
>>>>>> still get the same error message as above from both "R CMD build fda"
>>>>>> locally and from GitHub Action at:
>>>>>>
>>>>>>
>>>>>> https://github.com/JamesRamsay5/fda
>>>>>>
>>>>>>
>>>>>> ??????????? Other suggestions?
>>>>>> ??????????? Thanks,
>>>>>> ??????????? Spencer Graves
>>>>>>
>>>>>>>
>>>>>>> Best,
>>>>>>> Uwe Ligges
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>
>>>>> ????????? [[alternative HTML version deleted]]
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>
>>>>
>>>> ?????[[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sat Jan 21 08:47:35 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sat, 21 Jan 2023 08:47:35 +0100
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <21cf6c3c-07de-f0bf-8f80-c2cd5ab8f6b6@effectivedefense.org>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
 <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
 <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>
 <b80a813c-d02e-0f4f-d8f5-6671a39711c0@effectivedefense.org>
 <5ee1615c-ad65-4985-8c39-55fd2be125de@gmail.com>
 <21cf6c3c-07de-f0bf-8f80-c2cd5ab8f6b6@effectivedefense.org>
Message-ID: <d949af12-bb03-a0ac-8aa0-87f5880078f9@statistik.tu-dortmund.de>



On 21.01.2023 03:47, Spencer Graves wrote:
> 
> 
> On 1/20/23 7:32 PM, Duncan Murdoch wrote:
>> On 20/01/2023 8:16 p.m., Spencer Graves wrote:
>>> Hello, All:
>>>
>>>
>>> ????? My attempts to fix this problem exposed what seems to be a 
>>> completely
>>> unrelated problem:? All five GitHub Actions end now with:
>>>
>>>
>>> Error: package or namespace load failed for ?fda? in namespaceExport(ns,
>>> exports):
>>> ?? undefined exports: refinery
>>>
>>>
>>> ????? The package includes ~man/refinery.Rd, ~data/refinery.rda, and
>>> NAMESPACE includes "export( ... refinery, ...)".
>>
>>
>> I think if you declare something as data by putting it in the data 
>> directory and using LazyData:true, you shouldn't also declare it as an 
>> export in the NAMESPACE file.
> 
> 
>  ????? I got the same negative results after deleting "LazyData: true" 
> from DESCRIPTION.? (That's what I would expect, because there are 17 
> other *.rda files in the data subdirectory that are are mentioned in 
> NAMESPACE and are not creating a problem.? In 2009 the package included 
> both "data/refinery.rda" and "man/refinery.Rd".? They were erroneously 
> removed at some point.? I'm now trying to restore them.)

So you have declared LazyData: true?
How does the other package access the data object? By imprt directives?
Perhaps you exported the data in the past via the NAMSPACE file? But 
then it has to be in sysdata.rda?



Sorry for the confusion with the BOM.
The encoding sting for UTF-16  with byte order mark is "UTF-16BE".
I'd believe much more should have gone wrong then. Perhaps it was some 
editor that really messed it up?

Best,
Uwe Ligges



> 
>  ????? Thanks,
>  ????? Spencer
> 
>>
>> Duncan Murdoch
>>
>>>
>>>
>>> ????? ???
>>> ????? I have Bitdefender installed on this computer.? A "Quick Scan"
>>> produced nothing just now.
>>>
>>>
>>> ????? Thanks,
>>> ????? Spencer
>>>
>>>
>>> On 1/20/23 5:08 PM, Duncan Murdoch wrote:
>>>> On 20/01/2023 6:02 p.m., Greg Hunt wrote:
>>>>> xFEFF isn't a BOM in a UTF-8 file, its not anything.?? The UTF-8 
>>>>> BOM is a
>>>>> different sequence of bits.? If tools treat it as a BOM, that is
>>>>> arguably a
>>>>> problem.
>>>>
>>>> You're right.? FEFF is the UTF-16 big endian BOM.? UTF-16 is a 16 bit
>>>> encoding, not at all the same as UTF-8.? I don't know how to read 
>>>> UTF-16
>>>> in R. Uwe's advice was for UTF-8.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com>
>>>>> wrote:
>>>>>
>>>>>> Setting the locale to "C" (or perhaps some other non-UTF-8 locale) 
>>>>>> will
>>>>>> show the BOM bytes.? E.g., on Windows I get:
>>>>>>
>>>>>>> Sys.getlocale()
>>>>>> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
>>>>>> States.utf8;LC_MONETARY=English_United
>>>>>> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
>>>>>>> tools::showNonASCIIfile('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>> rawToChar(readBin('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>>>> what="raw", n=20))
>>>>>> [1] "?export(AmpPhasDec"
>>>>>>> Sys.setlocale(locale="C")
>>>>>> [1] "C"
>>>>>>> tools::showNonASCIIfile('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>> 1: <ef><bb><bf>export(AmpPhasDecomp,
>>>>>>> rawToChar(readBin('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>>>> what="raw", n=20))
>>>>>> [1] "\357\273\277export(AmpPhasDec"
>>>>>>
>>>>>> -Bill
>>>>>>
>>>>>>
>>>>>> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
>>>>>> spencer.graves at effectivedefense.org> wrote:
>>>>>>
>>>>>>> Hi, Ivan and Uwe:
>>>>>>>
>>>>>>>
>>>>>>> ??????????? Thanks for your suggestions, but I've so far been unable
>>>>>>> to get
>>>>>>> them
>>>>>>> to work.? see below.
>>>>>>>
>>>>>>>
>>>>>>> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>>>>>>>
>>>>>>>>
>>>>>>>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>>>>>>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>>>>>>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>>>>>>>
>>>>>>>>>> ** byte-compile and prepare package for lazy loading
>>>>>>>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>>>>>>> ????? 1:1: unexpected input
>>>>>>>>>
>>>>>>>>> tools::showNonASCIIfile('
>>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>>>>>>>
>>>>>>>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK 
>>>>>>>>> SPACE.
>>>>>>>>> You'll need to remove it, e.g. by re-creating the first line.
>>>>>>>>
>>>>>>>>
>>>>>>>> Note that this is also called "byte order mark" (BOM). Tell your
>>>>>>>> editor
>>>>>>>> not to create files with BOM.
>>>>>>>>
>>>>>>>> You can also fix in R:
>>>>>>>>
>>>>>>>> x <- readLines(..., encoding="UTF-8-BOM")
>>>>>>>> writeLines(x, ......)
>>>>>>>
>>>>>>>
>>>>>>> ??????????? In RStudio 2022.12.0+353 (the current version),
>>>>>>>
>>>>>>>
>>>>>>> tools::showNonASCIIfile('
>>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>>
>>>>>>>
>>>>>>> returned "char(0)".? 'readLines' and 'writeLines' as Uwe suggested
>>>>>>> failed to fix it for me.
>>>>>>>
>>>>>>>
>>>>>>> ??????????? The first problem I noticed with this was that 
>>>>>>> RStudio could
>>>>>> not
>>>>>>> read
>>>>>>> the NAMESPACE file.? When I tried, it said, "File is binary 
>>>>>>> rather than
>>>>>>> text so cannot be opened by the source editor."? I changed something
>>>>>>> using a different editor and did "git commit" and "git push", and 
>>>>>>> got
>>>>>>> the error on GitHub that I reported above.? I copied the file
>>>>>>> elsewhere,
>>>>>>> deleted it locally and from GitHub, then recreated it in 
>>>>>>> LibreOffice by
>>>>>>> manually typing the first and last lines then copying the rest 
>>>>>>> from a
>>>>>>> copy I had saved elsewhere.? The RStudio would open the file, but I
>>>>>>> still get the same error message as above from both "R CMD build 
>>>>>>> fda"
>>>>>>> locally and from GitHub Action at:
>>>>>>>
>>>>>>>
>>>>>>> https://github.com/JamesRamsay5/fda
>>>>>>>
>>>>>>>
>>>>>>> ??????????? Other suggestions?
>>>>>>> ??????????? Thanks,
>>>>>>> ??????????? Spencer Graves
>>>>>>>
>>>>>>>>
>>>>>>>> Best,
>>>>>>>> Uwe Ligges
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>>
>>>>>>
>>>>>> ????????? [[alternative HTML version deleted]]
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>
>>>>> ?????[[alternative HTML version deleted]]
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From hhoe|||n @end|ng |rom gm@||@com  Sat Jan 21 11:15:40 2023
From: hhoe|||n @end|ng |rom gm@||@com (Holger Hoefling)
Date: Sat, 21 Jan 2023 11:15:40 +0100
Subject: [R-pkg-devel] replacements of sprintf in compiled code
Message-ID: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>

Hi,

In my recent re-submission with a bug-fix of the hdf5r package, I got a new
set of warnings from the compiler, one being that I shouldn't be using
'sprintf'.

Is there a simple replacement that I can use?

Thanks

Holger Hoefling

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jan 21 11:27:03 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 21 Jan 2023 05:27:03 -0500
Subject: [R-pkg-devel] replacements of sprintf in compiled code
In-Reply-To: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
References: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
Message-ID: <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>

On 21/01/2023 5:15 a.m., Holger Hoefling wrote:
> Hi,
> 
> In my recent re-submission with a bug-fix of the hdf5r package, I got a new
> set of warnings from the compiler, one being that I shouldn't be using
> 'sprintf'.
> 
> Is there a simple replacement that I can use?

You should use snprintf() which has an extra argument to state the size 
of the buffer receiving the string.  For example,

  char text[32];
  sprintf(text, "%.4g", value);

could be written as

  char text[32];
  snprintf(text, 32, "%.4g", value);

This will write a string with at most 31 characters before the NUL at 
the end, and avoids the possibility of a buffer overrun.

Duncan Murdoch


From hhoe|||n @end|ng |rom gm@||@com  Sat Jan 21 11:33:22 2023
From: hhoe|||n @end|ng |rom gm@||@com (Holger Hoefling)
Date: Sat, 21 Jan 2023 11:33:22 +0100
Subject: [R-pkg-devel] replacements of sprintf in compiled code
In-Reply-To: <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
References: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
 <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
Message-ID: <CAFDswJuzj3PLPwO+3+4ocA--2KaOZ6iKzTmfLcVu_uxiVGuB9Q@mail.gmail.com>

Hi,

thanks for the tip! Is that available everywhere or do I need to set
compiler requirements?

Best

Holger Hoefling

On Sat, Jan 21, 2023 at 11:27 AM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 21/01/2023 5:15 a.m., Holger Hoefling wrote:
> > Hi,
> >
> > In my recent re-submission with a bug-fix of the hdf5r package, I got a
> new
> > set of warnings from the compiler, one being that I shouldn't be using
> > 'sprintf'.
> >
> > Is there a simple replacement that I can use?
>
> You should use snprintf() which has an extra argument to state the size
> of the buffer receiving the string.  For example,
>
>   char text[32];
>   sprintf(text, "%.4g", value);
>
> could be written as
>
>   char text[32];
>   snprintf(text, 32, "%.4g", value);
>
> This will write a string with at most 31 characters before the NUL at
> the end, and avoids the possibility of a buffer overrun.
>
> Duncan Murdoch
>

	[[alternative HTML version deleted]]


From m@tth|@@-gond@n @end|ng |rom gmx@de  Sat Jan 21 11:46:52 2023
From: m@tth|@@-gond@n @end|ng |rom gmx@de (Matthias Gondan)
Date: Sat, 21 Jan 2023 11:46:52 +0100
Subject: [R-pkg-devel] replacements of sprintf in compiled code
In-Reply-To: <CAFDswJuzj3PLPwO+3+4ocA--2KaOZ6iKzTmfLcVu_uxiVGuB9Q@mail.gmail.com>
References: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
 <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
 <CAFDswJuzj3PLPwO+3+4ocA--2KaOZ6iKzTmfLcVu_uxiVGuB9Q@mail.gmail.com>
Message-ID: <1MeU0k-1okx2X02tg-00aYUo@mail.gmx.net>

I think the function is more than 20 years old

https://en.cppreference.com/w/c/io/fprintf



Von: Holger Hoefling
Gesendet: Samstag, 21. Januar 2023 11:37
An: Duncan Murdoch
Cc: R Package Development
Betreff: Re: [R-pkg-devel] replacements of sprintf in compiled code

Hi,

thanks for the tip! Is that available everywhere or do I need to set
compiler requirements?

Best

Holger Hoefling

On Sat, Jan 21, 2023 at 11:27 AM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 21/01/2023 5:15 a.m., Holger Hoefling wrote:
> > Hi,
> >
> > In my recent re-submission with a bug-fix of the hdf5r package, I got a
> new
> > set of warnings from the compiler, one being that I shouldn't be using
> > 'sprintf'.
> >
> > Is there a simple replacement that I can use?
>
> You should use snprintf() which has an extra argument to state the size
> of the buffer receiving the string.  For example,
>
>   char text[32];
>   sprintf(text, "%.4g", value);
>
> could be written as
>
>   char text[32];
>   snprintf(text, 32, "%.4g", value);
>
> This will write a string with at most 31 characters before the NUL at
> the end, and avoids the possibility of a buffer overrun.
>
> Duncan Murdoch
>

	[[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jan 21 11:47:02 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 21 Jan 2023 05:47:02 -0500
Subject: [R-pkg-devel] replacements of sprintf in compiled code
In-Reply-To: <CAFDswJuzj3PLPwO+3+4ocA--2KaOZ6iKzTmfLcVu_uxiVGuB9Q@mail.gmail.com>
References: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
 <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
 <CAFDswJuzj3PLPwO+3+4ocA--2KaOZ6iKzTmfLcVu_uxiVGuB9Q@mail.gmail.com>
Message-ID: <4db9b982-42d7-ccb1-580b-d37f44f45f1d@gmail.com>

On 21/01/2023 5:33 a.m., Holger Hoefling wrote:
> Hi,
> 
> thanks for the tip! Is that available everywhere or do I need to set 
> compiler requirements?

You shouldn't need any special requirements.  I think this was 
standardized in C99, which is supported by default in R.  Not sure which 
C++ version adopted it, but it's available there too.

Duncan Murdoch

> 
> Best
> 
> Holger Hoefling
> 
> On Sat, Jan 21, 2023 at 11:27 AM Duncan Murdoch 
> <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>> wrote:
> 
>     On 21/01/2023 5:15 a.m., Holger Hoefling wrote:
>      > Hi,
>      >
>      > In my recent re-submission with a bug-fix of the hdf5r package, I
>     got a new
>      > set of warnings from the compiler, one being that I shouldn't be
>     using
>      > 'sprintf'.
>      >
>      > Is there a simple replacement that I can use?
> 
>     You should use snprintf() which has an extra argument to state the size
>     of the buffer receiving the string.? For example,
> 
>      ? char text[32];
>      ? sprintf(text, "%.4g", value);
> 
>     could be written as
> 
>      ? char text[32];
>      ? snprintf(text, 32, "%.4g", value);
> 
>     This will write a string with at most 31 characters before the NUL at
>     the end, and avoids the possibility of a buffer overrun.
> 
>     Duncan Murdoch
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jan 21 14:28:29 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 21 Jan 2023 08:28:29 -0500
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <21cf6c3c-07de-f0bf-8f80-c2cd5ab8f6b6@effectivedefense.org>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
 <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
 <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>
 <b80a813c-d02e-0f4f-d8f5-6671a39711c0@effectivedefense.org>
 <5ee1615c-ad65-4985-8c39-55fd2be125de@gmail.com>
 <21cf6c3c-07de-f0bf-8f80-c2cd5ab8f6b6@effectivedefense.org>
Message-ID: <13ba278a-1b46-a7c4-c27b-d9f9b17f6665@gmail.com>

On 20/01/2023 9:47 p.m., Spencer Graves wrote:
> 
> 
> On 1/20/23 7:32 PM, Duncan Murdoch wrote:
>> On 20/01/2023 8:16 p.m., Spencer Graves wrote:
>>> Hello, All:
>>>
>>>
>>>  ????? My attempts to fix this problem exposed what seems to be a
>>> completely
>>> unrelated problem:? All five GitHub Actions end now with:
>>>
>>>
>>> Error: package or namespace load failed for ?fda? in namespaceExport(ns,
>>> exports):
>>>  ?? undefined exports: refinery
>>>
>>>
>>>  ????? The package includes ~man/refinery.Rd, ~data/refinery.rda, and
>>> NAMESPACE includes "export( ... refinery, ...)".
>>
>>
>> I think if you declare something as data by putting it in the data
>> directory and using LazyData:true, you shouldn't also declare it as an
>> export in the NAMESPACE file.
> 
> 
> 	  I got the same negative results after deleting "LazyData: true" from
> DESCRIPTION.  (That's what I would expect, because there are 17 other
> *.rda files in the data subdirectory that are are mentioned in NAMESPACE
> and are not creating a problem.  In 2009 the package included both
> "data/refinery.rda" and "man/refinery.Rd".  They were erroneously
> removed at some point.  I'm now trying to restore them.)

I just cloned the repository, and saw the same error as you saw.  Then I 
followed my advice, and removed `refinery` from the NAMESPACE file, and 
the error went away.

Since you don't have `LazyData: true` in the current version, you need 
to run `data(refinery)` to make that dataset available.  That does work.

I also tried restoring `LazyData:true` as well as removing `refinery` 
from NAMESPACE, and that works too, without the need to call 
`data(refinery)`.  The variable is just available.

I'm not sure which *.rda files you are talking about that "are mentioned 
in NAMESPACE".  Now that I've removed `refinery` in my copy, I don't see 
any of them.

Duncan Murdoch

> 
> 
> 	  Thanks,
> 	  Spencer
> 
>>
>> Duncan Murdoch
>>
>>>
>>>
>>>  ????? ???
>>>  ????? I have Bitdefender installed on this computer.? A "Quick Scan"
>>> produced nothing just now.
>>>
>>>
>>>  ????? Thanks,
>>>  ????? Spencer
>>>
>>>
>>> On 1/20/23 5:08 PM, Duncan Murdoch wrote:
>>>> On 20/01/2023 6:02 p.m., Greg Hunt wrote:
>>>>> xFEFF isn't a BOM in a UTF-8 file, its not anything.?? The UTF-8 BOM
>>>>> is a
>>>>> different sequence of bits.? If tools treat it as a BOM, that is
>>>>> arguably a
>>>>> problem.
>>>>
>>>> You're right.? FEFF is the UTF-16 big endian BOM.? UTF-16 is a 16 bit
>>>> encoding, not at all the same as UTF-8.? I don't know how to read UTF-16
>>>> in R. Uwe's advice was for UTF-8.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com>
>>>>> wrote:
>>>>>
>>>>>> Setting the locale to "C" (or perhaps some other non-UTF-8 locale)
>>>>>> will
>>>>>> show the BOM bytes.? E.g., on Windows I get:
>>>>>>
>>>>>>> Sys.getlocale()
>>>>>> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
>>>>>> States.utf8;LC_MONETARY=English_United
>>>>>> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
>>>>>>> tools::showNonASCIIfile('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>> rawToChar(readBin('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>>>> what="raw", n=20))
>>>>>> [1] "?export(AmpPhasDec"
>>>>>>> Sys.setlocale(locale="C")
>>>>>> [1] "C"
>>>>>>> tools::showNonASCIIfile('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>> 1: <ef><bb><bf>export(AmpPhasDecomp,
>>>>>>> rawToChar(readBin('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>>>> what="raw", n=20))
>>>>>> [1] "\357\273\277export(AmpPhasDec"
>>>>>>
>>>>>> -Bill
>>>>>>
>>>>>>
>>>>>> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
>>>>>> spencer.graves at effectivedefense.org> wrote:
>>>>>>
>>>>>>> Hi, Ivan and Uwe:
>>>>>>>
>>>>>>>
>>>>>>>  ??????????? Thanks for your suggestions, but I've so far been unable
>>>>>>> to get
>>>>>>> them
>>>>>>> to work.? see below.
>>>>>>>
>>>>>>>
>>>>>>> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>>>>>>>
>>>>>>>>
>>>>>>>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>>>>>>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>>>>>>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>>>>>>>
>>>>>>>>>> ** byte-compile and prepare package for lazy loading
>>>>>>>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>>>>>>>  ????? 1:1: unexpected input
>>>>>>>>>
>>>>>>>>> tools::showNonASCIIfile('
>>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>>>>>>>
>>>>>>>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>>>>>>>>> You'll need to remove it, e.g. by re-creating the first line.
>>>>>>>>
>>>>>>>>
>>>>>>>> Note that this is also called "byte order mark" (BOM). Tell your
>>>>>>>> editor
>>>>>>>> not to create files with BOM.
>>>>>>>>
>>>>>>>> You can also fix in R:
>>>>>>>>
>>>>>>>> x <- readLines(..., encoding="UTF-8-BOM")
>>>>>>>> writeLines(x, ......)
>>>>>>>
>>>>>>>
>>>>>>>  ??????????? In RStudio 2022.12.0+353 (the current version),
>>>>>>>
>>>>>>>
>>>>>>> tools::showNonASCIIfile('
>>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>>
>>>>>>>
>>>>>>> returned "char(0)".? 'readLines' and 'writeLines' as Uwe suggested
>>>>>>> failed to fix it for me.
>>>>>>>
>>>>>>>
>>>>>>>  ??????????? The first problem I noticed with this was that RStudio
>>>>>>> could
>>>>>> not
>>>>>>> read
>>>>>>> the NAMESPACE file.? When I tried, it said, "File is binary rather
>>>>>>> than
>>>>>>> text so cannot be opened by the source editor."? I changed something
>>>>>>> using a different editor and did "git commit" and "git push", and got
>>>>>>> the error on GitHub that I reported above.? I copied the file
>>>>>>> elsewhere,
>>>>>>> deleted it locally and from GitHub, then recreated it in
>>>>>>> LibreOffice by
>>>>>>> manually typing the first and last lines then copying the rest from a
>>>>>>> copy I had saved elsewhere.? The RStudio would open the file, but I
>>>>>>> still get the same error message as above from both "R CMD build fda"
>>>>>>> locally and from GitHub Action at:
>>>>>>>
>>>>>>>
>>>>>>> https://github.com/JamesRamsay5/fda
>>>>>>>
>>>>>>>
>>>>>>>  ??????????? Other suggestions?
>>>>>>>  ??????????? Thanks,
>>>>>>>  ??????????? Spencer Graves
>>>>>>>
>>>>>>>>
>>>>>>>> Best,
>>>>>>>> Uwe Ligges
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>>
>>>>>>
>>>>>>  ????????? [[alternative HTML version deleted]]
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>
>>>>>  ?????[[alternative HTML version deleted]]
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>


From w||||@mwdun|@p @end|ng |rom gm@||@com  Sat Jan 21 16:52:48 2023
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Sat, 21 Jan 2023 07:52:48 -0800
Subject: [R-pkg-devel] replacements of sprintf in compiled code
In-Reply-To: <4db9b982-42d7-ccb1-580b-d37f44f45f1d@gmail.com>
References: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
 <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
 <CAFDswJuzj3PLPwO+3+4ocA--2KaOZ6iKzTmfLcVu_uxiVGuB9Q@mail.gmail.com>
 <4db9b982-42d7-ccb1-580b-d37f44f45f1d@gmail.com>
Message-ID: <CAHqSRuS1nkvvzmxqUQUELef0c+_7LCBm8QCqd-Jdfcjk9Ey-BQ@mail.gmail.com>

Even Microsoft added snprintf to Visual C++ in 2015 (not that that matters
for R).

-Bill

On Sat, Jan 21, 2023 at 2:47 AM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 21/01/2023 5:33 a.m., Holger Hoefling wrote:
> > Hi,
> >
> > thanks for the tip! Is that available everywhere or do I need to set
> > compiler requirements?
>
> You shouldn't need any special requirements.  I think this was
> standardized in C99, which is supported by default in R.  Not sure which
> C++ version adopted it, but it's available there too.
>
> Duncan Murdoch
>
> >
> > Best
> >
> > Holger Hoefling
> >
> > On Sat, Jan 21, 2023 at 11:27 AM Duncan Murdoch
> > <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>> wrote:
> >
> >     On 21/01/2023 5:15 a.m., Holger Hoefling wrote:
> >      > Hi,
> >      >
> >      > In my recent re-submission with a bug-fix of the hdf5r package, I
> >     got a new
> >      > set of warnings from the compiler, one being that I shouldn't be
> >     using
> >      > 'sprintf'.
> >      >
> >      > Is there a simple replacement that I can use?
> >
> >     You should use snprintf() which has an extra argument to state the
> size
> >     of the buffer receiving the string.  For example,
> >
> >        char text[32];
> >        sprintf(text, "%.4g", value);
> >
> >     could be written as
> >
> >        char text[32];
> >        snprintf(text, 32, "%.4g", value);
> >
> >     This will write a string with at most 31 characters before the NUL at
> >     the end, and avoids the possibility of a buffer overrun.
> >
> >     Duncan Murdoch
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Sat Jan 21 17:13:54 2023
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sat, 21 Jan 2023 10:13:54 -0600
Subject: [R-pkg-devel] replacements of sprintf in compiled code
In-Reply-To: <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
References: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
 <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
Message-ID: <25548.3906.870374.764431@rob.eddelbuettel.com>


On 21 January 2023 at 05:27, Duncan Murdoch wrote:
| On 21/01/2023 5:15 a.m., Holger Hoefling wrote:
| > Is there a simple replacement that I can use?
| 
| You should use snprintf() which has an extra argument to state the size 
| of the buffer receiving the string.  For example,
| 
|   char text[32];
|   sprintf(text, "%.4g", value);
| 
| could be written as
| 
|   char text[32];
|   snprintf(text, 32, "%.4g", value);
| 
| This will write a string with at most 31 characters before the NUL at 
| the end, and avoids the possibility of a buffer overrun.

And even better idiom (which I only came to too late for the update of a few
of my packages) is to rely on sizeof() as in

    char text[32];
    snprintf(text, sizeof(text), "%.4g", value);

which works for many / most simple cases of such static buffers.

Sometimes this sprintf compiler 'noise' is shrapnel from other packages we
include as headers, and harder to fix.  Brian Ripley kindly alerted us to one
remaining instance in the Rcpp headers which we fixed in October; the updated
package is currently awaiting its fate during its bi-annual update cycle but
is held in the dark and deep bowels of CRAN awaiting inspection (nine days
and counting now) as is package BH which in its annual update got a number of
headers refreshed from its upstream, plus an extra round of polish from
me. It too is available as an update in its git repo, and otherwise hiding in
those dark CRAN bowels.  I keep telling myself I should remain hopeful that
maybe one day we get to take advantage of it. Hopefully soon.

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From k|@u@@@ch||ep @end|ng |rom gm@||@com  Sun Jan 22 19:51:30 2023
From: k|@u@@@ch||ep @end|ng |rom gm@||@com (Klaus Schliep)
Date: Sun, 22 Jan 2023 19:51:30 +0100
Subject: [R-pkg-devel] Pretest failed and I fail to find out what's the
 problem
Message-ID: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>

 Dear all,

I try to submit a new version of the package phangorn and got the mail back:

"Dear maintainer,

package phangorn_2.11.0.tar.gz does not pass the incoming checks
automatically, please see the following pre-tests:
Windows: <
https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Windows/00check.log
>
Status: OK
Debian: <
https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Debian/00check.log
>
Status: OK"

I am kind of puzzled as to what the problem is, but it might well be that I
missed something? I appreciate any suggestions.

Kind regards,
Klaus Schliep


-- 
Klaus Schliep

Senior Scientist
Institute of Molecular Biotechnology
TU Graz

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Sun Jan 22 19:55:21 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 22 Jan 2023 13:55:21 -0500
Subject: [R-pkg-devel] Pretest failed and I fail to find out what's the
 problem
In-Reply-To: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
References: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
Message-ID: <04a1a0cb-9020-e643-1f73-2de0cc9c108f@gmail.com>

   Seems pretty mysterious to me! (No cryptic NOTEs anywhere in the 
logs, other than the inevitable "Note_to_CRAN_maintainers")

   I will be curious to see if anyone else finds something, but my guess 
is a hiccup on the CRAN end (i.e., you'll end up sending e-mail to the 
CRAN maintainers to clarify what's going on)


On 2023-01-22 1:51 p.m., Klaus Schliep wrote:
>   Dear all,
> 
> I try to submit a new version of the package phangorn and got the mail back:
> 
> "Dear maintainer,
> 
> package phangorn_2.11.0.tar.gz does not pass the incoming checks
> automatically, please see the following pre-tests:
> Windows: <
> https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Windows/00check.log
>>
> Status: OK
> Debian: <
> https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Debian/00check.log
>>
> Status: OK"
> 
> I am kind of puzzled as to what the problem is, but it might well be that I
> missed something? I appreciate any suggestions.
> 
> Kind regards,
> Klaus Schliep
> 
> 

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Jan 22 20:11:43 2023
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sun, 22 Jan 2023 11:11:43 -0800
Subject: [R-pkg-devel] Pretest failed and I fail to find out what's the
 problem
In-Reply-To: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
References: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
Message-ID: <0A19FD5F-E1EE-4E94-9DEC-234DDDDB1522@dcn.davis.ca.us>

Long build time for vignettes?

On January 22, 2023 10:51:30 AM PST, Klaus Schliep <klaus.schliep at gmail.com> wrote:
> Dear all,
>
>I try to submit a new version of the package phangorn and got the mail back:
>
>"Dear maintainer,
>
>package phangorn_2.11.0.tar.gz does not pass the incoming checks
>automatically, please see the following pre-tests:
>Windows: <
>https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Windows/00check.log
>>
>Status: OK
>Debian: <
>https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Debian/00check.log
>>
>Status: OK"
>
>I am kind of puzzled as to what the problem is, but it might well be that I
>missed something? I appreciate any suggestions.
>
>Kind regards,
>Klaus Schliep
>
>

-- 
Sent from my phone. Please excuse my brevity.


From kry|ov@r00t @end|ng |rom gm@||@com  Sun Jan 22 20:15:05 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sun, 22 Jan 2023 22:15:05 +0300
Subject: [R-pkg-devel] Pretest failed and I fail to find out what's the
 problem
In-Reply-To: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
References: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
Message-ID: <20230122221505.746b4db3@Tarkus>

On Sun, 22 Jan 2023 19:51:30 +0100
Klaus Schliep <klaus.schliep at gmail.com> wrote:

> package phangorn_2.11.0.tar.gz does not pass the incoming checks
> automatically, please see the following pre-tests:

Is this the whole e-mail? There may be a list of problems at the end of
the message, right after the signature ("Best regards, CRAN teams'
auto-check service"). It may be about the time your vignette took to
build on Windows, but I'm not sure about that.

-- 
Best regards,
Ivan


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sun Jan 22 21:43:05 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sun, 22 Jan 2023 21:43:05 +0100
Subject: [R-pkg-devel] Pretest failed and I fail to find out what's the
 problem
In-Reply-To: <04a1a0cb-9020-e643-1f73-2de0cc9c108f@gmail.com>
References: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
 <04a1a0cb-9020-e643-1f73-2de0cc9c108f@gmail.com>
Message-ID: <aa09fe26-93f9-1881-2c1e-11fbe6127a56@statistik.tu-dortmund.de>

Indeed,


* checking re-building of vignette outputs ... [13m] OK

Please reduce the vignette build timings by using
  - small toy data only
  - few iterations
  - or by providing precomputed results for the most lengthy parts. 
Otherwise we cannot afford checking the vignette regularly on CRAN.

Best,
Uwe Ligges


On 22.01.2023 19:55, Ben Bolker wrote:
>  ? Seems pretty mysterious to me! (No cryptic NOTEs anywhere in the 
> logs, other than the inevitable "Note_to_CRAN_maintainers")
> 
>  ? I will be curious to see if anyone else finds something, but my guess 
> is a hiccup on the CRAN end (i.e., you'll end up sending e-mail to the 
> CRAN maintainers to clarify what's going on)
> 
> 
> On 2023-01-22 1:51 p.m., Klaus Schliep wrote:
>> ? Dear all,
>>
>> I try to submit a new version of the package phangorn and got the mail 
>> back:
>>
>> "Dear maintainer,
>>
>> package phangorn_2.11.0.tar.gz does not pass the incoming checks
>> automatically, please see the following pre-tests:
>> Windows: <
>> https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Windows/00check.log
>>>
>> Status: OK
>> Debian: <
>> https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Debian/00check.log
>>>
>> Status: OK"
>>
>> I am kind of puzzled as to what the problem is, but it might well be 
>> that I
>> missed something? I appreciate any suggestions.
>>
>> Kind regards,
>> Klaus Schliep
>>
>>
>


From k|@u@@@ch||ep @end|ng |rom gm@||@com  Sun Jan 22 21:47:02 2023
From: k|@u@@@ch||ep @end|ng |rom gm@||@com (Klaus Schliep)
Date: Sun, 22 Jan 2023 21:47:02 +0100
Subject: [R-pkg-devel] Pretest failed and I fail to find out what's the
 problem
In-Reply-To: <aa09fe26-93f9-1881-2c1e-11fbe6127a56@statistik.tu-dortmund.de>
References: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
 <04a1a0cb-9020-e643-1f73-2de0cc9c108f@gmail.com>
 <aa09fe26-93f9-1881-2c1e-11fbe6127a56@statistik.tu-dortmund.de>
Message-ID: <CAKB+p3WzkyD1SXhkvTc0tHipdjMtGiQ0ti9OjGD7CxhP4N6KCg@mail.gmail.com>

Thanks a lot!
Kind regards,
Klaus Schliep

On Sun, Jan 22, 2023 at 9:43 PM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

> Indeed,
>
>
> * checking re-building of vignette outputs ... [13m] OK
>
> Please reduce the vignette build timings by using
>   - small toy data only
>   - few iterations
>   - or by providing precomputed results for the most lengthy parts.
> Otherwise we cannot afford checking the vignette regularly on CRAN.
>
> Best,
> Uwe Ligges
>
>
> On 22.01.2023 19:55, Ben Bolker wrote:
> >    Seems pretty mysterious to me! (No cryptic NOTEs anywhere in the
> > logs, other than the inevitable "Note_to_CRAN_maintainers")
> >
> >    I will be curious to see if anyone else finds something, but my guess
> > is a hiccup on the CRAN end (i.e., you'll end up sending e-mail to the
> > CRAN maintainers to clarify what's going on)
> >
> >
> > On 2023-01-22 1:51 p.m., Klaus Schliep wrote:
> >>   Dear all,
> >>
> >> I try to submit a new version of the package phangorn and got the mail
> >> back:
> >>
> >> "Dear maintainer,
> >>
> >> package phangorn_2.11.0.tar.gz does not pass the incoming checks
> >> automatically, please see the following pre-tests:
> >> Windows: <
> >>
> https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Windows/00check.log
> >>>
> >> Status: OK
> >> Debian: <
> >>
> https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Debian/00check.log
> >>>
> >> Status: OK"
> >>
> >> I am kind of puzzled as to what the problem is, but it might well be
> >> that I
> >> missed something? I appreciate any suggestions.
> >>
> >> Kind regards,
> >> Klaus Schliep
> >>
> >>
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


-- 
Klaus Schliep

Senior Scientist
Institute of Molecular Biotechnology
TU Graz
https://ubt.tugraz.at <https://icbt.tugraz.at>

	[[alternative HTML version deleted]]


From m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu  Mon Jan 23 17:30:52 2023
From: m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu (Maxim Nazarov)
Date: Mon, 23 Jan 2023 16:30:52 +0000
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
Message-ID: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>

Hello all,

I am submitting a minor update to one of my CRAN package (BIGL), and get strange errors on R-devel on win-builder - https://win-builder.r-project.org/incoming_pretest/BIGL_1.6.7_20230119_225109/Windows/00check.log and https://win-builder.r-project.org/o339zPAR6pWG/00check.log (different symbols)

It shows strange output like "`1Y???hA?..." before tests and cryptic error-messages like "unable to translate '(<be><b1><a7>m' to a wide string"
I can also see similar output in examples - https://win-builder.r-project.org/o339zPAR6pWG/examples_and_tests/BIGL-Ex.Rout 

I don't get any isses on debian R-devel, on R-release on windows, and also can't reproduce the errors locally on a windows machine with R-devel, so I am a bit lost.
Would anyone have any idea of what goes wrong?

Kind regards,
Maxim Nazarov


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Mon Jan 23 21:49:56 2023
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Mon, 23 Jan 2023 21:49:56 +0100
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
In-Reply-To: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
References: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
Message-ID: <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>


On 1/23/23 17:30, Maxim Nazarov wrote:
> Hello all,
>
> I am submitting a minor update to one of my CRAN package (BIGL), and get strange errors on R-devel on win-builder - https://win-builder.r-project.org/incoming_pretest/BIGL_1.6.7_20230119_225109/Windows/00check.log and https://win-builder.r-project.org/o339zPAR6pWG/00check.log (different symbols)
>
> It shows strange output like "`1Y???hA?..." before tests and cryptic error-messages like "unable to translate '(<be><b1><a7>m' to a wide string"
> I can also see similar output in examples - https://win-builder.r-project.org/o339zPAR6pWG/examples_and_tests/BIGL-Ex.Rout

These are errors and warnings in regex operations (grep, gsub) due to 
that the input data is not a valid string (validly encoded string). 
Because it is not valid, it cannot be converted to a wide string, which 
is needed for the regex operation, as this uses TRE.

So, you need to find out why the input strings are invalid. Common 
causes of such problems are that they are in a different encoding from 
the one told to R or to some other software on the way. Also the data 
may be corrupted.

> I don't get any isses on debian R-devel, on R-release on windows, and also can't reproduce the errors locally on a windows machine with R-devel, so I am a bit lost.
> Would anyone have any idea of what goes wrong?

It should be fairly easy from the error output to find out which 
operations have failed in the vignette. Perhaps you could find out how 
their inputs were generated.

If you have a Windows machine with R running in UTF-8 as the native 
encoding, with recent R-devel, and the error is still not reproducible, 
try to confirm that the inputs for the failing operations are correct.

Best
Tomas

>
> Kind regards,
> Maxim Nazarov
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu  Tue Jan 24 18:33:10 2023
From: m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu (Maxim Nazarov)
Date: Tue, 24 Jan 2023 17:33:10 +0000
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
In-Reply-To: <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>
References: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
 <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>
Message-ID: <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>

Thank you, Tomas, for your insights!

I think I found the root cause of the problem - my package uses the `nlsLM` function from the `minpack.lm` package and coincidentally the new version of that package was submitted to CRAN recently.
Looking at https://win-builder.r-project.org/incoming_pretest/minpack.lm_1.2-3_20230117_110122/reverseDependencies/changes.txt - we can see that this new version of minpack.lm is causing similar errors in many of its reverse dependencies.

In fact if I install that version from https://cran.r-project.org/incoming/archive/ I get the strange output when running a simple example from `nlsLM` even on linux:
```
install.packages("https://cran.r-project.org/incoming/archive/minpack.lm_1.2-3.tar.gz")
library(minpack.lm)
DNase1 <- subset(DNase, Run == 1)
capture.output(fm1DNase1 <- nlsLM(density ~ SSlogis(log(conc), Asym, xmid, scal), DNase1))
## produces "\xa8\002\x8c\003\x9bU"
```
this seems to come from the C code, which I don't fully understand.

So I guess it is an unfortunate timing, and I just need to wait for the minpack.lm package to be fixed, but I'm wondering (philosophically) if it is correct that my package is checked against non-released (non-approved) version of minpack.lm and rejected because of its shortcomings?

Kind regards,
Maxim Nazarov


----- Original Message -----
From: "Tomas Kalibera" <tomas.kalibera at gmail.com>
To: "Maxim Nazarov" <maxim.nazarov at openanalytics.eu>, "r-package-devel" <r-package-devel at r-project.org>
Sent: Monday, 23 January, 2023 21:49:56
Subject: Re: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder R-devel

On 1/23/23 17:30, Maxim Nazarov wrote:
> Hello all,
>
> I am submitting a minor update to one of my CRAN package (BIGL), and get strange errors on R-devel on win-builder - https://win-builder.r-project.org/incoming_pretest/BIGL_1.6.7_20230119_225109/Windows/00check.log and https://win-builder.r-project.org/o339zPAR6pWG/00check.log (different symbols)
>
> It shows strange output like "`1Y???hA?..." before tests and cryptic error-messages like "unable to translate '(<be><b1><a7>m' to a wide string"
> I can also see similar output in examples - https://win-builder.r-project.org/o339zPAR6pWG/examples_and_tests/BIGL-Ex.Rout

These are errors and warnings in regex operations (grep, gsub) due to 
that the input data is not a valid string (validly encoded string). 
Because it is not valid, it cannot be converted to a wide string, which 
is needed for the regex operation, as this uses TRE.

So, you need to find out why the input strings are invalid. Common 
causes of such problems are that they are in a different encoding from 
the one told to R or to some other software on the way. Also the data 
may be corrupted.

> I don't get any isses on debian R-devel, on R-release on windows, and also can't reproduce the errors locally on a windows machine with R-devel, so I am a bit lost.
> Would anyone have any idea of what goes wrong?

It should be fairly easy from the error output to find out which 
operations have failed in the vignette. Perhaps you could find out how 
their inputs were generated.

If you have a Windows machine with R running in UTF-8 as the native 
encoding, with recent R-devel, and the error is still not reproducible, 
try to confirm that the inputs for the failing operations are correct.

Best
Tomas

>
> Kind regards,
> Maxim Nazarov
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Jan 24 18:43:18 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 24 Jan 2023 12:43:18 -0500
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
In-Reply-To: <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>
References: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
 <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>
 <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>
Message-ID: <a7e315b0-1b04-af8a-2cea-2de30729ddc3@gmail.com>

I think that is likely bad luck, in that your package was being 
evaluated at the same time as the new minpack.lm, and CRAN/winbuilder 
don't isolate the builds.  If you resubmit unchanged (I'd do this on 
winbuilder, not CRAN) you may get a more reasonable outcome.

Duncan Murdoch

On 24/01/2023 12:33 p.m., Maxim Nazarov wrote:
> Thank you, Tomas, for your insights!
> 
> I think I found the root cause of the problem - my package uses the `nlsLM` function from the `minpack.lm` package and coincidentally the new version of that package was submitted to CRAN recently.
> Looking at https://win-builder.r-project.org/incoming_pretest/minpack.lm_1.2-3_20230117_110122/reverseDependencies/changes.txt - we can see that this new version of minpack.lm is causing similar errors in many of its reverse dependencies.
> 
> In fact if I install that version from https://cran.r-project.org/incoming/archive/ I get the strange output when running a simple example from `nlsLM` even on linux:
> ```
> install.packages("https://cran.r-project.org/incoming/archive/minpack.lm_1.2-3.tar.gz")
> library(minpack.lm)
> DNase1 <- subset(DNase, Run == 1)
> capture.output(fm1DNase1 <- nlsLM(density ~ SSlogis(log(conc), Asym, xmid, scal), DNase1))
> ## produces "\xa8\002\x8c\003\x9bU"
> ```
> this seems to come from the C code, which I don't fully understand.
> 
> So I guess it is an unfortunate timing, and I just need to wait for the minpack.lm package to be fixed, but I'm wondering (philosophically) if it is correct that my package is checked against non-released (non-approved) version of minpack.lm and rejected because of its shortcomings?
> 
> Kind regards,
> Maxim Nazarov
> 
> 
> ----- Original Message -----
> From: "Tomas Kalibera" <tomas.kalibera at gmail.com>
> To: "Maxim Nazarov" <maxim.nazarov at openanalytics.eu>, "r-package-devel" <r-package-devel at r-project.org>
> Sent: Monday, 23 January, 2023 21:49:56
> Subject: Re: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder R-devel
> 
> On 1/23/23 17:30, Maxim Nazarov wrote:
>> Hello all,
>>
>> I am submitting a minor update to one of my CRAN package (BIGL), and get strange errors on R-devel on win-builder - https://win-builder.r-project.org/incoming_pretest/BIGL_1.6.7_20230119_225109/Windows/00check.log and https://win-builder.r-project.org/o339zPAR6pWG/00check.log (different symbols)
>>
>> It shows strange output like "`1Y???hA?..." before tests and cryptic error-messages like "unable to translate '(<be><b1><a7>m' to a wide string"
>> I can also see similar output in examples - https://win-builder.r-project.org/o339zPAR6pWG/examples_and_tests/BIGL-Ex.Rout
> 
> These are errors and warnings in regex operations (grep, gsub) due to
> that the input data is not a valid string (validly encoded string).
> Because it is not valid, it cannot be converted to a wide string, which
> is needed for the regex operation, as this uses TRE.
> 
> So, you need to find out why the input strings are invalid. Common
> causes of such problems are that they are in a different encoding from
> the one told to R or to some other software on the way. Also the data
> may be corrupted.
> 
>> I don't get any isses on debian R-devel, on R-release on windows, and also can't reproduce the errors locally on a windows machine with R-devel, so I am a bit lost.
>> Would anyone have any idea of what goes wrong?
> 
> It should be fairly easy from the error output to find out which
> operations have failed in the vignette. Perhaps you could find out how
> their inputs were generated.
> 
> If you have a Windows machine with R running in UTF-8 as the native
> encoding, with recent R-devel, and the error is still not reproducible,
> try to confirm that the inputs for the failing operations are correct.
> 
> Best
> Tomas
> 
>>
>> Kind regards,
>> Maxim Nazarov
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From kry|ov@r00t @end|ng |rom gm@||@com  Tue Jan 24 19:12:21 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 24 Jan 2023 21:12:21 +0300
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
In-Reply-To: <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>
References: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
 <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>
 <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>
Message-ID: <20230124211221.4fe18230@Tarkus>

On Tue, 24 Jan 2023 17:33:10 +0000
Maxim Nazarov <maxim.nazarov at openanalytics.eu> wrote:

> this seems to come from the C code

I'm 99% sure this comes from the following changes to the package:

--- minpack.lm_1.2-2/src/fcn_message.c  2020-03-23 10:54:03.000000000 +0300
+++ minpack.lm_1.2-3/src/fcn_message.c  2023-01-17 09:30:05.000000000 +0300
@@ -3,24 +3,24 @@
 char *fcn_message(char *msg, int info, int n, int nit)
 {
     if      (info == 1)
-        sprintf(msg, "Relative error in the sum of squares is at most `ftol'.");
+        Rprintf(msg, "Relative error in the sum of squares is at most `ftol'.");
     else if (info == 2)

(And so on for other values of `info`.)

sprintf() takes a string pointer to write into as its first argument.
Rprintf(), on the other hand, prints straight to the R console; its
first argument is the format string. Given a valid pointer to an
uninitialised string instead of the format string, Rprintf prints stack
garbage to the console, ignoring the following arguments. My guess is
that the maintainers either intended to remove the msg argument
altogether or needed to use snprintf() and pass the buffer size to
fcn_message().

-- 
Best regards,
Ivan


From ur|@@ohn @end|ng |rom gm@||@com  Sun Jan 22 22:36:52 2023
From: ur|@@ohn @end|ng |rom gm@||@com (Uri Simonsohn)
Date: Sun, 22 Jan 2023 21:36:52 +0000
Subject: [R-pkg-devel] 
 If you had to choose one binary to preserve for a pkg, which would it be?
Message-ID: <em688ae61e-9014-4e28-9c9b-7af67631a44a@6e5c1f4b.com>

This is not a perfect list for this question, but possibly a good list.

I maintain 'groundhog', a package that seeks to simplify reproducibility 
of R code based on R packages.
It has so far relied on MRAN  for binaries of older/archived versions of 
packages, but MRAN is shutting down.
Posit (R Studio) also has archived binaries, but they are less 
transparent about it,  they do not have Mac binaries, and I am a little 
uncomfortable relying on a 3rd party again, specially because their 
archive is more difficult to navigate and this is part of a for-profit 
venture so access is far from guaranteed. So...

I will create an independent archive of all binaries for packages for 
Windows and Mac machines.

Instead of having daily backups like MRAN does/did, i will keep just one 
binary per combination of package, version, R version, operating system.
So a single 'rio' 0.5.0 binary for Windows for R-4.2.x, for example 
(MRAN keeps a daily copy of such file instead, possibly with 100+ 
identical or nearly identical copies).

I need to decide whether to keep the first binary that was uploaded to 
CRAN, the last one, or one in the middle, etc.
In  concept binaries should work regardless of which file is chosen, but 
there is a reason, i guess they are rebuilt so often so it may make a 
difference in the margin which of the many builts available in MRAN is 
chosen to be preserved. I think it has to do with changes in underlying 
packages used to build them, but am not sure.
This decision will also guide future archiving, which of the many 
versions of to be uploaded to CRAN binaries are preserved.

So, if you have experience or knowledge on this, which of the many 
previously created binaries for a given package version would you choose 
to archive long-term?
Groundhog will always attempt to install from source if a binary fails, 
so a certain error rate is tolerable.

Uri

----------------------------------

Uri Simonsohn (urisohn.com)

Professor of Behavioral Science, ESADE, Barcelona

Senior Fellow, Wharton School, University of Pennsylvania

Blog at:  DataColada.org <www.DataColada.org>

Easy data sharing: ResearchBox.org

Twitter: @uri_sohn




	[[alternative HTML version deleted]]


From y||4013 @end|ng |rom med@corne||@edu  Mon Jan 23 17:51:42 2023
From: y||4013 @end|ng |rom med@corne||@edu (Ying Li)
Date: Mon, 23 Jan 2023 16:51:42 +0000
Subject: [R-pkg-devel] Inconsistent R CMD Check results
Message-ID: <PH0PR06MB71575B163CB7557D3E0E146AEDC89@PH0PR06MB7157.namprd06.prod.outlook.com>

Dear all,

Hope you are well! Recently, in the check before a re-submission, I got an unexpected note when doing R CMD Check using rhub::check_for_cran(), saying that "Examples with CPU (user + system) or elapsed time > 5s".

I didn't expect this note to appear because the same examples didn't cause this note in the previous submission last December. Compared with the previous submission, we only edited documentation, there was no change in the R code for functions of our package.

To double-check, I downloaded our previous submission from CRAN and checked it again. It's strange that this current CRAN version also has this note now. However, when submitting it last December, there were no such notes. Do you have any idea why the R CMD Check results are inconsistent?

Since the examples caused no note in the last submission and were successfully submitted to CRAN, I'm not sure whether I should change the examples in this re-submission to eliminate this sudden note. Any suggestions will be appreciated!

Thank you!
Ying

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Jan 24 20:55:21 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 24 Jan 2023 14:55:21 -0500
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
In-Reply-To: <20230124211221.4fe18230@Tarkus>
References: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
 <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>
 <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>
 <20230124211221.4fe18230@Tarkus>
Message-ID: <2da90e2c-1d18-dbde-507e-3f52544e65ce@gmail.com>

On 24/01/2023 1:12 p.m., Ivan Krylov wrote:
> On Tue, 24 Jan 2023 17:33:10 +0000
> Maxim Nazarov <maxim.nazarov at openanalytics.eu> wrote:
> 
>> this seems to come from the C code
> 
> I'm 99% sure this comes from the following changes to the package:
> 
> --- minpack.lm_1.2-2/src/fcn_message.c  2020-03-23 10:54:03.000000000 +0300
> +++ minpack.lm_1.2-3/src/fcn_message.c  2023-01-17 09:30:05.000000000 +0300
> @@ -3,24 +3,24 @@
>   char *fcn_message(char *msg, int info, int n, int nit)
>   {
>       if      (info == 1)
> -        sprintf(msg, "Relative error in the sum of squares is at most `ftol'.");
> +        Rprintf(msg, "Relative error in the sum of squares is at most `ftol'.");
>       else if (info == 2)
> 
> (And so on for other values of `info`.)
> 
> sprintf() takes a string pointer to write into as its first argument.
> Rprintf(), on the other hand, prints straight to the R console; its
> first argument is the format string. Given a valid pointer to an
> uninitialised string instead of the format string, Rprintf prints stack
> garbage to the console, ignoring the following arguments. My guess is
> that the maintainers either intended to remove the msg argument
> altogether or needed to use snprintf() and pass the buffer size to
> fcn_message().
> 

Package maintainers recently got a message telling us not to use 
sprintf() any more.  I guess the minpack.lm maintainer either didn't 
read the whole message carefully enough and used Rprintf as a substitute 
instead of snprintf(), or intended to use snprintf(), but typed 
Rprintf() out of habit.

Duncan Murdoch


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Tue Jan 24 21:55:31 2023
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Tue, 24 Jan 2023 21:55:31 +0100
Subject: [R-pkg-devel] 
 If you had to choose one binary to preserve for a pkg, which would it be?
In-Reply-To: <em688ae61e-9014-4e28-9c9b-7af67631a44a@6e5c1f4b.com>
References: <em688ae61e-9014-4e28-9c9b-7af67631a44a@6e5c1f4b.com>
Message-ID: <93e860ae-462a-2de2-aa6a-aea976f22c3d@gmail.com>

On 1/22/23 22:36, Uri Simonsohn wrote:
> This is not a perfect list for this question, but possibly a good list.
I think this is a good match.
> I maintain 'groundhog', a package that seeks to simplify reproducibility
> of R code based on R packages.
> It has so far relied on MRAN  for binaries of older/archived versions of
> packages, but MRAN is shutting down.
> Posit (R Studio) also has archived binaries, but they are less
> transparent about it,  they do not have Mac binaries, and I am a little
> uncomfortable relying on a 3rd party again, specially because their
> archive is more difficult to navigate and this is part of a for-profit
> venture so access is far from guaranteed. So...
>
> I will create an independent archive of all binaries for packages for
> Windows and Mac machines.
>
> Instead of having daily backups like MRAN does/did, i will keep just one
> binary per combination of package, version, R version, operating system.
> So a single 'rio' 0.5.0 binary for Windows for R-4.2.x, for example
> (MRAN keeps a daily copy of such file instead, possibly with 100+
> identical or nearly identical copies).
>
> I need to decide whether to keep the first binary that was uploaded to
> CRAN, the last one, or one in the middle, etc.
> In  concept binaries should work regardless of which file is chosen, but
> there is a reason, i guess they are rebuilt so often so it may make a
> difference in the margin which of the many builts available in MRAN is
> chosen to be preserved. I think it has to do with changes in underlying
> packages used to build them, but am not sure.
> This decision will also guide future archiving, which of the many
> versions of to be uploaded to CRAN binaries are preserved.

I think the date-based snapshots made sense, that corresponded to how 
packages were tested and built together. I am afraid you cannot get 
close to that by choosing a single version. If you really must use only 
one, probably the latest.

If I wanted some reasonably reliable repeatability of computations, I 
would though keep a virtual machine snapshot with the matching OS, 
matching version of R, the packages installed (probably from source in 
case debugging became needed), and all external dependencies. Ideally 
with disconnected network to make sure the computation works fully 
locally, and as I would not be updating the OS, for security as well. I 
would keep that snapshot intact - never save the machine state again to 
it. And if possible convert it to several image formats just in case the 
virtualization software stops being supported or no longer can read 
certain formats.

Tomas

>
> So, if you have experience or knowledge on this, which of the many
> previously created binaries for a given package version would you choose
> to archive long-term?
> Groundhog will always attempt to install from source if a binary fails,
> so a certain error rate is tolerable.
>
> Uri
>
> ----------------------------------
>
> Uri Simonsohn (urisohn.com)
>
> Professor of Behavioral Science, ESADE, Barcelona
>
> Senior Fellow, Wharton School, University of Pennsylvania
>
> Blog at:  DataColada.org <www.DataColada.org>
>
> Easy data sharing: ResearchBox.org
>
> Twitter: @uri_sohn
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @|mon@urb@nek @end|ng |rom R-project@org  Tue Jan 24 22:01:13 2023
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Wed, 25 Jan 2023 10:01:13 +1300
Subject: [R-pkg-devel] 
 If you had to choose one binary to preserve for a pkg, which would it be?
In-Reply-To: <em688ae61e-9014-4e28-9c9b-7af67631a44a@6e5c1f4b.com>
References: <em688ae61e-9014-4e28-9c9b-7af67631a44a@6e5c1f4b.com>
Message-ID: <C37B7C06-5DF2-46C2-8906-B0F84A2FE8AE@R-project.org>

Uri,

I can speak only for macOS package binaries and they have been rarely re-built. The only time when a re-build is necessary is when a dependency is updated and breaks its backward-compatibility (sadly, yes, that happens). It is relatively rare, but recently Matrix was one example with reasonably big fall-out. Those things are likely to happen more often in the future, but if you are mainly interested in an archive then you should be able to simply go by modification dates for the macOS binaries. However, I would add a black-out period after a major R release, because what happens is that I do a full re-build of all packages after a major R release (up til then the packages are build against the beta/RC) and that can take up to a few days, so I wouldn't keep packages built before that first set is done which can be few days after the release.

Cheers,
Simon


> On Jan 23, 2023, at 10:36 AM, Uri Simonsohn <uri.sohn at gmail.com> wrote:
> 
> This is not a perfect list for this question, but possibly a good list.
> 
> I maintain 'groundhog', a package that seeks to simplify reproducibility 
> of R code based on R packages.
> It has so far relied on MRAN  for binaries of older/archived versions of 
> packages, but MRAN is shutting down.
> Posit (R Studio) also has archived binaries, but they are less 
> transparent about it,  they do not have Mac binaries, and I am a little 
> uncomfortable relying on a 3rd party again, specially because their 
> archive is more difficult to navigate and this is part of a for-profit 
> venture so access is far from guaranteed. So...
> 
> I will create an independent archive of all binaries for packages for 
> Windows and Mac machines.
> 
> Instead of having daily backups like MRAN does/did, i will keep just one 
> binary per combination of package, version, R version, operating system.
> So a single 'rio' 0.5.0 binary for Windows for R-4.2.x, for example 
> (MRAN keeps a daily copy of such file instead, possibly with 100+ 
> identical or nearly identical copies).
> 
> I need to decide whether to keep the first binary that was uploaded to 
> CRAN, the last one, or one in the middle, etc.
> In  concept binaries should work regardless of which file is chosen, but 
> there is a reason, i guess they are rebuilt so often so it may make a 
> difference in the margin which of the many builts available in MRAN is 
> chosen to be preserved. I think it has to do with changes in underlying 
> packages used to build them, but am not sure.
> This decision will also guide future archiving, which of the many 
> versions of to be uploaded to CRAN binaries are preserved.
> 
> So, if you have experience or knowledge on this, which of the many 
> previously created binaries for a given package version would you choose 
> to archive long-term?
> Groundhog will always attempt to install from source if a binary fails, 
> so a certain error rate is tolerable.
> 
> Uri
> 
> ----------------------------------
> 
> Uri Simonsohn (urisohn.com)
> 
> Professor of Behavioral Science, ESADE, Barcelona
> 
> Senior Fellow, Wharton School, University of Pennsylvania
> 
> Blog at:  DataColada.org <www.DataColada.org>
> 
> Easy data sharing: ResearchBox.org
> 
> Twitter: @uri_sohn
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Tue Jan 24 22:03:45 2023
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Tue, 24 Jan 2023 22:03:45 +0100
Subject: [R-pkg-devel] Inconsistent R CMD Check results
In-Reply-To: <PH0PR06MB71575B163CB7557D3E0E146AEDC89@PH0PR06MB7157.namprd06.prod.outlook.com>
References: <PH0PR06MB71575B163CB7557D3E0E146AEDC89@PH0PR06MB7157.namprd06.prod.outlook.com>
Message-ID: <12190c88-46c6-600b-2ad2-af41b28cc01d@gmail.com>

On 1/23/23 17:51, Ying Li via R-package-devel wrote:
> Dear all,
>
> Hope you are well! Recently, in the check before a re-submission, I got an unexpected note when doing R CMD Check using rhub::check_for_cran(), saying that "Examples with CPU (user + system) or elapsed time > 5s".
>
> I didn't expect this note to appear because the same examples didn't cause this note in the previous submission last December. Compared with the previous submission, we only edited documentation, there was no change in the R code for functions of our package.
>
> To double-check, I downloaded our previous submission from CRAN and checked it again. It's strange that this current CRAN version also has this note now. However, when submitting it last December, there were no such notes. Do you have any idea why the R CMD Check results are inconsistent?

You could check on Winbuilder as that is a concrete setup used for 
incoming checks. But in principle, the computation may take longer 
because of changes in dependencies, external software and R. Which can 
be due to a performance regression, a bugfix, etc. Only 
debugging/profiling could reveal the true cause.

> Since the examples caused no note in the last submission and were successfully submitted to CRAN, I'm not sure whether I should change the examples in this re-submission to eliminate this sudden note. Any suggestions will be appreciated!
If you were close to the limit last time, it may be a coincidence and 
you might simply reduce the examples to be on the safe side.

Tomas

>
> Thank you!
> Ying
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Wed Jan 25 15:52:41 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Wed, 25 Jan 2023 15:52:41 +0100
Subject: [R-pkg-devel] Inconsistent R CMD Check results
In-Reply-To: <12190c88-46c6-600b-2ad2-af41b28cc01d@gmail.com>
References: <PH0PR06MB71575B163CB7557D3E0E146AEDC89@PH0PR06MB7157.namprd06.prod.outlook.com>
 <12190c88-46c6-600b-2ad2-af41b28cc01d@gmail.com>
Message-ID: <6cba36c3-5688-8795-0115-c48f5491fa00@statistik.tu-dortmund.de>



On 24.01.2023 22:03, Tomas Kalibera wrote:
> On 1/23/23 17:51, Ying Li via R-package-devel wrote:
>> Dear all,
>>
>> Hope you are well! Recently, in the check before a re-submission, I 
>> got an unexpected note when doing R CMD Check using 
>> rhub::check_for_cran(), saying that "Examples with CPU (user + system) 
>> or elapsed time > 5s".
>>
>> I didn't expect this note to appear because the same examples didn't 
>> cause this note in the previous submission last December. Compared 
>> with the previous submission, we only edited documentation, there was 
>> no change in the R code for functions of our package.
>>
>> To double-check, I downloaded our previous submission from CRAN and 
>> checked it again. It's strange that this current CRAN version also has 
>> this note now. However, when submitting it last December, there were 
>> no such notes. Do you have any idea why the R CMD Check results are 
>> inconsistent?
> 
> You could check on Winbuilder as that is a concrete setup used for 
> incoming checks. But in principle, the computation may take longer 
> because of changes in dependencies, external software and R. Which can 
> be due to a performance regression, a bugfix, etc. Only 
> debugging/profiling could reveal the true cause.

Yes, it may even be some OS update, or just coincidence that the system 
was idling the last time your package got checked.
Note that CRAN systems are expected to be slower than, e.g., your 
laptop, as the servers use multi core CPUs with rather low frequencies.

Best,
Uwe Ligges




>> Since the examples caused no note in the last submission and were 
>> successfully submitted to CRAN, I'm not sure whether I should change 
>> the examples in this re-submission to eliminate this sudden note. Any 
>> suggestions will be appreciated!
> If you were close to the limit last time, it may be a coincidence and 
> you might simply reduce the examples to be on the safe side.
> 
> Tomas
> 
>>
>> Thank you!
>> Ying
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From y||4013 @end|ng |rom med@corne||@edu  Wed Jan 25 16:35:36 2023
From: y||4013 @end|ng |rom med@corne||@edu (Ying Li)
Date: Wed, 25 Jan 2023 15:35:36 +0000
Subject: [R-pkg-devel] Inconsistent R CMD Check results
Message-ID: <PH0PR06MB7157C59C34D467A0558C3BC4EDCE9@PH0PR06MB7157.namprd06.prod.outlook.com>

That makes sense, thanks very much for your explanation and advice, Tomas and Uwe!

Best,
Ying
________________________________
From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
Sent: Wednesday, January 25, 2023 9:52
To: Tomas Kalibera <tomas.kalibera at gmail.com>; Ying Li <yil4013 at med.cornell.edu>; r-package-devel at r-project.org <r-package-devel at r-project.org>
Cc: Arindam RoyChoudhury <arr2014 at med.cornell.edu>
Subject: [EXTERNAL] Re: [R-pkg-devel] Inconsistent R CMD Check results



On 24.01.2023 22:03, Tomas Kalibera wrote:
> On 1/23/23 17:51, Ying Li via R-package-devel wrote:
>> Dear all,
>>
>> Hope you are well! Recently, in the check before a re-submission, I
>> got an unexpected note when doing R CMD Check using
>> rhub::check_for_cran(), saying that "Examples with CPU (user + system)
>> or elapsed time > 5s".
>>
>> I didn't expect this note to appear because the same examples didn't
>> cause this note in the previous submission last December. Compared
>> with the previous submission, we only edited documentation, there was
>> no change in the R code for functions of our package.
>>
>> To double-check, I downloaded our previous submission from CRAN and
>> checked it again. It's strange that this current CRAN version also has
>> this note now. However, when submitting it last December, there were
>> no such notes. Do you have any idea why the R CMD Check results are
>> inconsistent?
>
> You could check on Winbuilder as that is a concrete setup used for
> incoming checks. But in principle, the computation may take longer
> because of changes in dependencies, external software and R. Which can
> be due to a performance regression, a bugfix, etc. Only
> debugging/profiling could reveal the true cause.

Yes, it may even be some OS update, or just coincidence that the system
was idling the last time your package got checked.
Note that CRAN systems are expected to be slower than, e.g., your
laptop, as the servers use multi core CPUs with rather low frequencies.

Best,
Uwe Ligges




>> Since the examples caused no note in the last submission and were
>> successfully submitted to CRAN, I'm not sure whether I should change
>> the examples in this re-submission to eliminate this sudden note. Any
>> suggestions will be appreciated!
> If you were close to the limit last time, it may be a coincidence and
> you might simply reduce the examples to be on the safe side.
>
> Tomas
>
>>
>> Thank you!
>> Ying
>>
>>     [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dpackage-2Ddevel&d=DwIDaQ&c=lb62iw4YL4RFalcE2hQUQealT9-RXrryqt9KZX2qu2s&r=bP8EQnZ_JVp-Bf-Rt9gvjFVaFYbqdYei_Hbkmzh0LNc&m=eLlMF2DixVEB3UPnbyg6ZeQMZ1z2DEeFgsJnjG7ZOkd8aWS2QLCazYACWGs5Jb-_&s=J5wxZE1CYC6I4jZ-omVH9Fq0hOJuvUarBD9ckVePRe4&e=
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dpackage-2Ddevel&d=DwIDaQ&c=lb62iw4YL4RFalcE2hQUQealT9-RXrryqt9KZX2qu2s&r=bP8EQnZ_JVp-Bf-Rt9gvjFVaFYbqdYei_Hbkmzh0LNc&m=eLlMF2DixVEB3UPnbyg6ZeQMZ1z2DEeFgsJnjG7ZOkd8aWS2QLCazYACWGs5Jb-_&s=J5wxZE1CYC6I4jZ-omVH9Fq0hOJuvUarBD9ckVePRe4&e=

	[[alternative HTML version deleted]]


From m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu  Thu Jan 26 11:33:33 2023
From: m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu (Maxim Nazarov)
Date: Thu, 26 Jan 2023 10:33:33 +0000
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
In-Reply-To: <2da90e2c-1d18-dbde-507e-3f52544e65ce@gmail.com>
References: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
 <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>
 <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>
 <20230124211221.4fe18230@Tarkus>
 <2da90e2c-1d18-dbde-507e-3f52544e65ce@gmail.com>
Message-ID: <01020185eda3cc99-f47e3053-d8f0-40ef-9a3c-dbd4a4a7cbd0-000000@eu-west-1.amazonses.com>

Thank you, Duncan and Ivan for helpful feedback.
I reached out to the maintainer of the package, and she was able to quickly resolve the issue and resubmit.
Consequently my re-submission was accepted.

Kind regards,
Maxim Nazarov


----- Original Message -----
From: "Duncan Murdoch" <murdoch.duncan at gmail.com>
To: "Ivan Krylov" <krylov.r00t at gmail.com>, "Maxim Nazarov" <maxim.nazarov at openanalytics.eu>
Cc: "r-package-devel" <r-package-devel at r-project.org>
Sent: Tuesday, 24 January, 2023 20:55:21
Subject: Re: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder R-devel

On 24/01/2023 1:12 p.m., Ivan Krylov wrote:
> On Tue, 24 Jan 2023 17:33:10 +0000
> Maxim Nazarov <maxim.nazarov at openanalytics.eu> wrote:
> 
>> this seems to come from the C code
> 
> I'm 99% sure this comes from the following changes to the package:
> 
> --- minpack.lm_1.2-2/src/fcn_message.c  2020-03-23 10:54:03.000000000 +0300
> +++ minpack.lm_1.2-3/src/fcn_message.c  2023-01-17 09:30:05.000000000 +0300
> @@ -3,24 +3,24 @@
>   char *fcn_message(char *msg, int info, int n, int nit)
>   {
>       if      (info == 1)
> -        sprintf(msg, "Relative error in the sum of squares is at most `ftol'.");
> +        Rprintf(msg, "Relative error in the sum of squares is at most `ftol'.");
>       else if (info == 2)
> 
> (And so on for other values of `info`.)
> 
> sprintf() takes a string pointer to write into as its first argument.
> Rprintf(), on the other hand, prints straight to the R console; its
> first argument is the format string. Given a valid pointer to an
> uninitialised string instead of the format string, Rprintf prints stack
> garbage to the console, ignoring the following arguments. My guess is
> that the maintainers either intended to remove the msg argument
> altogether or needed to use snprintf() and pass the buffer size to
> fcn_message().
> 

Package maintainers recently got a message telling us not to use 
sprintf() any more.  I guess the minpack.lm maintainer either didn't 
read the whole message carefully enough and used Rprintf as a substitute 
instead of snprintf(), or intended to use snprintf(), but typed 
Rprintf() out of habit.

Duncan Murdoch


From ur|@@ohn @end|ng |rom gm@||@com  Fri Jan 27 10:34:19 2023
From: ur|@@ohn @end|ng |rom gm@||@com (Uri Simonsohn)
Date: Fri, 27 Jan 2023 09:34:19 +0000
Subject: [R-pkg-devel] 
 If you had to choose one binary to preserve for a pkg, which would it be?
In-Reply-To: <C37B7C06-5DF2-46C2-8906-B0F84A2FE8AE@R-project.org>
References: <em688ae61e-9014-4e28-9c9b-7af67631a44a@6e5c1f4b.com>
 <C37B7C06-5DF2-46C2-8906-B0F84A2FE8AE@R-project.org>
Message-ID: <em262bb59c-da12-47b7-a34e-aa4d36964aba@8bdd459e.com>

Hi list,

I received a few emails, some off list, and replied privately to all.  
Based on the feedback, I decided to modify the approach to replacing 
MRAN.
To those interested, the updated plan follows:

1) Mac and Windows binaries from MRAN will be saved in a new archive, 
which will be called "GRAN" (G is for groundhog).  GRAN will also 
continue collecting new binaries from CRAN and archiving them for the 
foreseeable future.

2) In general, a given package, version, OS file will be saved once in 
the archive, using the 1st file posted to CRAN for that 
package-version-os (but looking at CRAN at least 10 days after a major R 
release, to ensure it was built with the released R version). There are 
two exceptions to this single binary rule (see (3) and (4))

3) The top 2% of packages on CRAN, with the most reverse dependencies, 
will be saved every 1st of the month even if it is the same package 
version. This mitigates the consequences of a given already built  
binary becoming incompatible with other packages (for example the binary 
for MASS is saved again, every 1st of the month, even if the version has 
not changed)

4) When a Mac binary is rebuilt, since they are are seldom rebuilt, it 
will be assumed that something happened, and that package version binary 
will be saved again for all OS. For example, if on 2021/05/03 MASS was 
rebuilt for Mac, the version for Windows and arm mac will also be saved 
again. Just in case. This is essentially piggybacking on Simon Urbanek's 
decisions to rebuild binaries, it assumes they are often diagnostic of 
needing a new build.

5) The package groundhog will automatically select the relevant binary 
to install, based on this architecture. Users will continue to simply 
need to run:
groundhog.library(pkg, date)

6) Once everything is rolled out and running smoothly, i will explore 
adding ubuntu binaries to GRAN

This should generate a fairly robust, if necessarily imperfect , archive 
of binaries, with a manageable GB footprint (ballpark <3TB  for all 
packages since 2014), and maximal ease-of-use.

The selective copying of MRAN-->GRAN is  taking place now, the version 
of groundhog that benefits from it should be released around May, 
several weeks before Microsoft erases MRAN.

Thanks for your feedback so far, very happy to receive further 
suggestions or thoughts off list.

Best,

Uri


------ Original Message ------
From "Simon Urbanek" <simon.urbanek at r-project.org>
To "Uri Simonsohn" <urisohn at gmail.com>
Cc R-package-devel at r-project.org
Date 1/24/2023 10:01:13 PM
Subject Re: [R-pkg-devel] If you had to choose one binary to preserve 
for a pkg, which would it be?

>Uri,
>
>I can speak only for macOS package binaries and they have been rarely re-built. The only time when a re-build is necessary is when a dependency is updated and breaks its backward-compatibility (sadly, yes, that happens). It is relatively rare, but recently Matrix was one example with reasonably big fall-out. Those things are likely to happen more often in the future, but if you are mainly interested in an archive then you should be able to simply go by modification dates for the macOS binaries. However, I would add a black-out period after a major R release, because what happens is that I do a full re-build of all packages after a major R release (up til then the packages are build against the beta/RC) and that can take up to a few days, so I wouldn't keep packages built before that first set is done which can be few days after the release.
>
>Cheers,
>Simon
>
>
>>  On Jan 23, 2023, at 10:36 AM, Uri Simonsohn <uri.sohn at gmail.com> wrote:
>>
>>  This is not a perfect list for this question, but possibly a good list.
>>
>>  I maintain 'groundhog', a package that seeks to simplify reproducibility
>>  of R code based on R packages.
>>  It has so far relied on MRAN  for binaries of older/archived versions of
>>  packages, but MRAN is shutting down.
>>  Posit (R Studio) also has archived binaries, but they are less
>>  transparent about it,  they do not have Mac binaries, and I am a little
>>  uncomfortable relying on a 3rd party again, specially because their
>>  archive is more difficult to navigate and this is part of a for-profit
>>  venture so access is far from guaranteed. So...
>>
>>  I will create an independent archive of all binaries for packages for
>>  Windows and Mac machines.
>>
>>  Instead of having daily backups like MRAN does/did, i will keep just one
>>  binary per combination of package, version, R version, operating system.
>>  So a single 'rio' 0.5.0 binary for Windows for R-4.2.x, for example
>>  (MRAN keeps a daily copy of such file instead, possibly with 100+
>>  identical or nearly identical copies).
>>
>>  I need to decide whether to keep the first binary that was uploaded to
>>  CRAN, the last one, or one in the middle, etc.
>>  In  concept binaries should work regardless of which file is chosen, but
>>  there is a reason, i guess they are rebuilt so often so it may make a
>>  difference in the margin which of the many builts available in MRAN is
>>  chosen to be preserved. I think it has to do with changes in underlying
>>  packages used to build them, but am not sure.
>>  This decision will also guide future archiving, which of the many
>>  versions of to be uploaded to CRAN binaries are preserved.
>>
>>  So, if you have experience or knowledge on this, which of the many
>>  previously created binaries for a given package version would you choose
>>  to archive long-term?
>>  Groundhog will always attempt to install from source if a binary fails,
>>  so a certain error rate is tolerable.
>>
>>  Uri
>>
>>  ----------------------------------
>>
>>  Uri Simonsohn (urisohn.com)
>>
>>  Professor of Behavioral Science, ESADE, Barcelona
>>
>>  Senior Fellow, Wharton School, University of Pennsylvania
>>
>>  Blog at:  DataColada.org <www.DataColada.org>
>>
>>  Easy data sharing: ResearchBox.org
>>
>>  Twitter: @uri_sohn
>>
>>
>>
>>
>>  	[[alternative HTML version deleted]]
>>
>>  ______________________________________________
>>R-package-devel at r-project.org mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
	[[alternative HTML version deleted]]


