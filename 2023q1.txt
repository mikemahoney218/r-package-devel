From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Mon Jan  2 19:20:11 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Mon, 2 Jan 2023 12:20:11 -0600
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
Message-ID: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>

Hello, All:


	  What are current recommendations for GitHub Action?


	  My most recent change to "sos" generated "Failed to get R" for 
ubuntu-latest (release, devel, and oldrel-1).


https://github.com/sbgraves237/sos/actions/runs/3820307473/jobs/6498527786


	  I would happily rtfm if I only knew which fmtr.


	  Thanks,
	  Spencer Graves


From zk@mv@r @end|ng |rom gm@||@com  Mon Jan  2 19:34:41 2023
From: zk@mv@r @end|ng |rom gm@||@com (Zhian Kamvar)
Date: Mon, 2 Jan 2023 10:34:41 -0800
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
In-Reply-To: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
References: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
Message-ID: <CAPsXksJ=MPS=979NnD4hJGeg5hDk80JF-KPhYoMtDv64ZKxXWw@mail.gmail.com>

This warning says to update to v2 of the action from r-lib:

Warning: r-lib/actions/setup-r at v1 is deprecated. Please update your
> workflow to use the 'v2' version. Also look at the examples at
> https://github.com/r-lib/actions/tree/v2/examples because '@v2' workflows
> are much simpler than 'v1' workflows.


We ran into a similar problem and switching to v2 did the trick.

Best,
Zhian

On Mon, Jan 2, 2023 at 10:20 AM Spencer Graves <
spencer.graves at effectivedefense.org> wrote:

> Hello, All:
>
>
>           What are current recommendations for GitHub Action?
>
>
>           My most recent change to "sos" generated "Failed to get R" for
> ubuntu-latest (release, devel, and oldrel-1).
>
>
> https://github.com/sbgraves237/sos/actions/runs/3820307473/jobs/6498527786
>
>
>           I would happily rtfm if I only knew which fmtr.
>
>
>           Thanks,
>           Spencer Graves
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Mon Jan  2 19:38:16 2023
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 2 Jan 2023 12:38:16 -0600
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
In-Reply-To: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
References: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
Message-ID: <25523.9368.854032.549309@rob.eddelbuettel.com>


As the error is common against your _all three_ of your Ubuntu runs, you
could consider the possibility that the events are correlated.  Most often it
simply means a (temporary, usually) network or server outage.  I would wait,
and then relaunch (which these days you can do just for the failed jobs).

It is also worth paying attention to warnings such as

   Warning: r-lib/actions/setup-r at v1 is deprecated. Please update your
   workflow to use the 'v2' version. Also look at the examples at
   https://github.com/r-lib/actions/tree/v2/examples because '@v2' workflows
   are much simpler than 'v1' workflows.

Hth,  Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Tue Jan  3 02:18:33 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Mon, 2 Jan 2023 19:18:33 -0600
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
In-Reply-To: <25523.9368.854032.549309@rob.eddelbuettel.com>
References: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
 <25523.9368.854032.549309@rob.eddelbuettel.com>
Message-ID: <b97fe385-c884-1365-3ab2-d86a293d9a27@effectivedefense.org>



On 1/2/23 12:38 PM, Dirk Eddelbuettel wrote:
> 
> As the error is common against your _all three_ of your Ubuntu runs, you
> could consider the possibility that the events are correlated.  Most often it
> simply means a (temporary, usually) network or server outage.  I would wait,
> and then relaunch (which these days you can do just for the failed jobs).
> 
> It is also worth paying attention to warnings such as
> 
>     Warning: r-lib/actions/setup-r at v1 is deprecated. Please update your
>     workflow to use the 'v2' version. Also look at the examples at
>     https://github.com/r-lib/actions/tree/v2/examples because '@v2' workflows
>     are much simpler than 'v1' workflows.


	  Thanks to Zhian Kamvar and Dirk Eddelbuettel for encouraging me to 
look at the warning.


	  I replaced a few lined of my "R-CMD-check.yaml" file with the the 
"v3" and "v2" versions in the example in 
"https://github.com/r-lib/actions/tree/v2/examples" and deleted 
subsequent lines that I didn't understand, and I got an instant failure: 
  It didn't run even one of the 5 tests.  Then I did "git revert" with 
the version number from GitHub and changed several lines to match the 
example with the succeeding yaml code.  GitHub Action ran and failed on 
all 5 platforms.  I did "git revert" with that and changed 
"r-lib/actions/setup-r at v1" to "r-lib/actions/setup-r at v2".  With that, 
R-release ran successfully on Unbuntu as well as Windows and macOS.


	  However, Ubuntu failed with devel and oldrel1, complaining, "there is 
no package called ?rcmdcheck?".


	  See:


https://github.com/sbgraves237/sos


	  Suggestions?
	  Thanks,
	  Spencer Graves

> 
> Hth,  Dirk
>


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Jan  4 10:18:40 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 4 Jan 2023 12:18:40 +0300
Subject: [R-pkg-devel] Current recommendations re. GitHub Action?
In-Reply-To: <b97fe385-c884-1365-3ab2-d86a293d9a27@effectivedefense.org>
References: <869a200d-ed9a-232e-795e-e459849ce164@effectivedefense.org>
 <25523.9368.854032.549309@rob.eddelbuettel.com>
 <b97fe385-c884-1365-3ab2-d86a293d9a27@effectivedefense.org>
Message-ID: <20230104121840.7dc90239@Tarkus>

On Mon, 2 Jan 2023 19:18:33 -0600
Spencer Graves <spencer.graves at effectivedefense.org> wrote:

> 	  However, Ubuntu failed with devel and oldrel1, complaining,
> "there is no package called ?rcmdcheck?".

If we start from the error message and work backwards, it's easy to see
that `rcmdcheck` fails to install because it depends on `curl`, which
also fails to install. `curl` fails to install because the virtual
machine running the GitHub Action doesn't have libcurl headers
installed; there's even an error message about that, but it's not fatal:

------------------------- ANTICONF ERROR ---------------------------
Configuration failed because libcurl was not found. Try installing:
 * deb: libcurl4-openssl-dev (Debian, Ubuntu, etc)
 * rpm: libcurl-devel (Fedora, CentOS, RHEL)
If libcurl is already installed, check that 'pkg-config' is in your
PATH and PKG_CONFIG_PATH contains a libcurl.pc file. If pkg-config
is unavailable you can set INCLUDE_DIR and LIB_DIR manually via:
R CMD INSTALL --configure-vars='INCLUDE_DIR=... LIB_DIR=...'
--------------------------------------------------------------------

I don't have enough experience in the abstraction layers involved, but
if you stuff a `sudo apt install libcurl4-openssl-dev` (which should
run as a system command line, just like the "Install system
dependencies" step) somewhere before the "Install dependencies" step,
it should work.

-- 
Best regards,
Ivan


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Wed Jan  4 11:50:20 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Wed, 4 Jan 2023 11:50:20 +0100
Subject: [R-pkg-devel] new toolchain "RTools43" for building devel binaries
 (both R base and packages)
Message-ID: <2d486a48-087d-4bbe-b8cd-021025cfabc8@statistik.tu-dortmund.de>

Dear developers,

for those building from source on Windows:

A new toolchain called "RTools43" has been prepared by Tomas Kalibera.
It is now used to build the Windows binaries (R base and contributed 
packages) for R-devel on Windows. See
<https://cran.r-project.org/bin/windows/Rtools/rtools43/rtools.html>.

Best,
Uwe Ligges


From k|ng@@ @end|ng |rom um|ch@edu  Wed Jan  4 21:54:52 2023
From: k|ng@@ @end|ng |rom um|ch@edu (Aaron A. King)
Date: Wed, 4 Jan 2023 15:54:52 -0500
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
Message-ID: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>

Hi all,

I'm modifying a package so as to remove its dependence on the superseded
packages *reshape2* and *plyr*, in favor of dependence on *dplyr*.  In
particular, I'm just importing the one function `dplyr::bind_rows`.

A curious thing happens, however, as soon as I include this among the
imports.  I begin to get R CMD check NOTEs alerting me to the presence of
S3 generic inconsistencies.  These are associated with two functions in the
package: `filter.mean` and `filter.traj`, which the checker mistakes for S3
methods based on the generic `stats::filter` function.  Actually, these are
not S3 methods.  In fact, they are S4 generics and declared as such.

When *dplyr* is not imported, R CMD check is happy with these functions.
When it is imported, R CMD check complains.

Now I understand that it may be preferable to move away from functions with
names containing dots for this reason, and in fact I am already doing so,
but I think the question is a good one:

Why does inclusion of *dplyr* in the import list appear to trigger these
warnings when they were not there before?

Thanks in advance for any insight you can give!

Aaron A. King, Ph.D.
Nelson G. Hairston Professor of Ecology, Evolutionary Biology, and Complex
Systems
University of Michigan
kinglab.eeb.lsa.umich.edu
GPG Public Key: 0x15780975

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Jan  4 22:22:09 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 5 Jan 2023 00:22:09 +0300
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
Message-ID: <20230105002209.6e1fae5d@Tarkus>

On Wed, 4 Jan 2023 15:54:52 -0500
"Aaron A. King" <kingaa at umich.edu> wrote:

> Why does inclusion of *dplyr* in the import list appear to trigger
> these warnings when they were not there before?

I think that's because dplyr itself contains an S3 generic named
"filter", and having a package namespace loaded (not even attached) is
enough to take its registered S3 methods into consideration for method
dispatch. Here we have an opposite situation, though, and your
functions aren't registered as S3 methods. Will your function still be
called if you artificially construct a wrong object and feed it to
dplyr::filter while your package namespace is attached?

library(YOURPACKAGE)
dplyr::filter(structure(list(), class = 'traj'))

Additionally, stats::filter doesn't seem to be an S3 generic, so that's
one thing that the check gets confused about.

-- 
Best regards,
Ivan


From k|ng@@ @end|ng |rom um|ch@edu  Thu Jan  5 23:58:47 2023
From: k|ng@@ @end|ng |rom um|ch@edu (Aaron A. King)
Date: Thu, 5 Jan 2023 17:58:47 -0500
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <20230105002209.6e1fae5d@Tarkus>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
 <20230105002209.6e1fae5d@Tarkus>
Message-ID: <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>

Thanks for the fast reply!

When I follow your suggestion above, I get

library(pomp)
dplyr::filter(structure(list(), class = 'traj'))

Error in UseMethod("filter") :
  no applicable method for 'filter' applied to an object of class "traj"

Which is not what would happen if my filter.traj function were called.  So
the S3 dispatch system is not confused.  Thus this really is a false
positive.

It still leaves open the question, why does this suddenly appear when dplyr
is loaded?  If I understand you correctly, it would be triggered by the
inclusion of the generic 'filter' in dplyr, which was previously not
present. However, since the S3 dispatch system is not itself confused, I
suppose it must be the case that the S3 generic/method consistency checker
itself is confused.  I wonder, how does the checker decide when to throw a
NOTE?  Is it a simple pattern-matching system, something like "If X.Y is
exported, where X is a generic and Y is any string and X.Y is not declared
as an S3 method, then throw NOTE"?

Dr. Aaron A. King
University of Michigan


On Wed, Jan 4, 2023 at 4:22 PM Ivan Krylov <krylov.r00t at gmail.com> wrote:

> On Wed, 4 Jan 2023 15:54:52 -0500
> "Aaron A. King" <kingaa at umich.edu> wrote:
>
> > Why does inclusion of *dplyr* in the import list appear to trigger
> > these warnings when they were not there before?
>
> I think that's because dplyr itself contains an S3 generic named
> "filter", and having a package namespace loaded (not even attached) is
> enough to take its registered S3 methods into consideration for method
> dispatch. Here we have an opposite situation, though, and your
> functions aren't registered as S3 methods. Will your function still be
> called if you artificially construct a wrong object and feed it to
> dplyr::filter while your package namespace is attached?
>
> library(YOURPACKAGE)
> dplyr::filter(structure(list(), class = 'traj'))
>
> Additionally, stats::filter doesn't seem to be an S3 generic, so that's
> one thing that the check gets confused about.
>
> --
> Best regards,
> Ivan
>

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan  6 09:21:49 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 6 Jan 2023 11:21:49 +0300
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
 <20230105002209.6e1fae5d@Tarkus>
 <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>
Message-ID: <20230106112149.10207568@Tarkus>

On Thu, 5 Jan 2023 17:58:47 -0500
"Aaron A. King" <kingaa at umich.edu> wrote:

> However, since the S3 dispatch system is not itself confused, I
> suppose it must be the case that the S3 generic/method consistency
> checker itself is confused.  I wonder, how does the checker decide
> when to throw a NOTE?  Is it a simple pattern-matching system,
> something like "If X.Y is exported, where X is a generic and Y is any
> string and X.Y is not declared as an S3 method, then throw NOTE"?

The aim of the check is a bit different: "if an S3 method for generic X
and class Y exists, and the formal arguments of X.Y don't extend the
formal arguments of X in a certain way, then throw a NOTE", but then
something gets wrong about deciding whether X.Y is an S3 method, and
once filter.mean is decided to be an S3 method, of course it doesn't
match the formals of filter.

This function is even a public API of the tools package, see
?tools::checkS3methods:
https://github.com/r-devel/r-svn/blob/b57918fd104962415a752ea7db12dcf4f3f5219f/src/library/tools/R/QC.R#L2310-L2560

> When I follow your suggestion above, I get
> 
> library(pomp)
> dplyr::filter(structure(list(), class = 'traj'))
> 
> Error in UseMethod("filter") :
> no applicable method for 'filter' applied to an object of class "traj"

Interesting. I wonder if there's are other remaining ways to confuse
the S3 dispatch system into thinking your function is an S3 method that
the check is supposed to guard against. For instance, the following is
likely to work with your package:

library(pomp)
library(dplyr)
identical(filter.traj, getS3method('filter', 'traj'))
# as long as there's a visible 'filter' generic, getS3method will
# locate filter.traj as the method

...despite the method lookup seems to (correctly) fail, as you've just
demonstrated. But on older versions of R, this used to wrongly resolve
the call:

library(Ropj)
read <- function(x, ...) UseMethod('read')
identical(read.opj, getS3method('read','opj')) # works in R-devel
# [1] TRUE
read(structure(0, class = 'opj')) # calls read.opj in old R
# Error in read_opj(file, encoding, tree) :
#   Expecting a single string value: [type=double; extent=1].

I'm afraid I'm out of my depth here. The old, wrong behaviour seems to
match the R language definition
<https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Definition>.
The current behaviour seems to do the right thing? by letting the
functions opt into being methods, but then getS3method() seems to
contradict what actually gets called. Should we be fixing the
documentation, the implementation, or the check?

Can you try stepping through tools::checkS3methods('pomp') (or
tools::checkS3methods(dir = 'path/to/source/directory')) to see where
'filter' appears in the list of generics and where the 

-- 
Best regards,
Ivan


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan  6 09:24:13 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 6 Jan 2023 11:24:13 +0300
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <20230106112149.10207568@Tarkus>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
 <20230105002209.6e1fae5d@Tarkus>
 <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>
 <20230106112149.10207568@Tarkus>
Message-ID: <20230106112413.478d82da@Tarkus>

(Sorry for the unfinished message. I've got to do something about my
mailer to make it harder to send them accidentally.)

On Fri, 6 Jan 2023 11:21:49 +0300
Ivan Krylov <krylov.r00t at gmail.com> wrote:

> to see where 'filter' appears in the list of generics and where the

filter.traj function gets matched to it as a method?

-- 
Best regards,
Ivan


From k|ng@@ @end|ng |rom um|ch@edu  Fri Jan  6 19:56:10 2023
From: k|ng@@ @end|ng |rom um|ch@edu (Aaron A. King)
Date: Fri, 6 Jan 2023 13:56:10 -0500
Subject: [R-pkg-devel] S3 generic/method consistency false positive when
 dplyr imported
In-Reply-To: <20230106112413.478d82da@Tarkus>
References: <CAGPRvNDXHT-ZB4H6if_RRRwSFahUFDWbuKeppFBihvVQ4DodWA@mail.gmail.com>
 <20230105002209.6e1fae5d@Tarkus>
 <CAGPRvNAsbNQdVYiJbOTaoPow3CK-5q8fiB6tj4cpdLx22xPCfw@mail.gmail.com>
 <20230106112149.10207568@Tarkus> <20230106112413.478d82da@Tarkus>
Message-ID: <CAGPRvNC2T5Ce-ZdcKdwsmh53uQ1JVYf75CTC=i6Bbf2mL7B0Jw@mail.gmail.com>

Excellent suggestion, Ivan. Thanks for pointing out just where to look.

I stepped through tools::checkS3methods("pomp") and it does appear to be
roughly as I conjectured.  Namely, all functions are extracted from the
pomp namespace and checked against a list of generics.  The check that is
performed is a simple pattern-match (i.e.,
startsWith(paste0(genericname,"."), functionname)).  Clearly this is prone
to false positives.  I wonder what would be involved in tightening this up
so that it agrees with what the actual dispatch mechanism gives....

Interestingly, there is a whitelist, implemented mostly via
tools::nonS3methods().  The function (plyr::rbind.fill) that I had been
importing is there but its replacement (dplyr::bind_rows) is not. So this
answers my original question.

The whitelist appears to be a somewhat arbitrary compilation of functions
from various packages, with no obvious theme.  For example, dplyr is not on
the list, but ElectoGraph is; reshape is on the list but reshape2 is not.
The impression of arbitrariness is reinforced by the fact that packages
that Wickham has for whatever reason decided are superseded are present in
that list and packages he considers for the moment to be worth maintaining
are not.  Doing a quick 'git blame' I see that the whitelist was mostly put
together in 2013, with a few additions in 2015 and much more occasionally
since.

It occurs to me that there ought to be a mechanism whereby a package author
could add to the list of non-S3 methods.  I see from the mailing list
archives that there was discussion of this back in 2015 (
https://stat.ethz.ch/pipermail/r-devel/2015-June/071356.html), with what
looked like consensus that there ought to be such a facility, but nothing
seems to have actually been done about it.  I conjecture that the decision
was to just fold false positives into the whitelist on an ad hoc basis.

Dr. Aaron A. King
University of Michigan


On Fri, Jan 6, 2023 at 3:24 AM Ivan Krylov <krylov.r00t at gmail.com> wrote:

> (Sorry for the unfinished message. I've got to do something about my
> mailer to make it harder to send them accidentally.)
>
> On Fri, 6 Jan 2023 11:21:49 +0300
> Ivan Krylov <krylov.r00t at gmail.com> wrote:
>
> > to see where 'filter' appears in the list of generics and where the
>
> filter.traj function gets matched to it as a method?
>
> --
> Best regards,
> Ivan
>

	[[alternative HTML version deleted]]


From th|erry@denoeux @end|ng |rom utc@|r  Sat Jan  7 09:02:18 2023
From: th|erry@denoeux @end|ng |rom utc@|r (Thierry Denoeux)
Date: Sat, 7 Jan 2023 15:02:18 +0700
Subject: [R-pkg-devel] Problem with NEWS file
Message-ID: <A76FB9A9-9F8A-4836-8CDB-7622E9D76BFC@utc.fr>

Dear all,

Version 2.0.0 of my ?evclass' package was rejected for the second time with the following note from the Debian check (the Windows check is OK):

* checking package subdirectories ... NOTE
Problems with news in ?NEWS?:
  Cannot process chunk/lines:
    Version 2.0.0 includes an implementation of radial basis function neural network classifiers, as well as functions to express the outputs of trained logistic regression or feed-forward neural network classifiers as Dempster-Shafer mass functions. These methods are based on an interpretation of the operations performed in neural networks as the combination of weights of evidence by Dempster's rule (see: "T. Denoeux, Logistic Regression, Neural Networks and Dempster-Shafer Theory: a New Perspective. Knowledge-Based Systems 176:54-67, 2019").

I already tried to change the NEWS file but I have no idea where the error might come from. The NEWS file is a text file created by TextEdit on Mac with UTF-8 encoding, so I don?t see how there could be hidden special characters in it. I see nothing special in the line that could not be processed. Any help would be greatly appreciated.

Best,

Thierry
----------
Prof. Thierry Denoeux
Universit? de technologie de Compi?gne
Institut universitaire de France
Rue Roger Couttolenc, CS 60319
60203 Compi?gne cedex, France
https://www.hds.utc.fr/~tdenoeux


	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Sat Jan  7 09:20:45 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 7 Jan 2023 11:20:45 +0300
Subject: [R-pkg-devel] Problem with NEWS file
In-Reply-To: <A76FB9A9-9F8A-4836-8CDB-7622E9D76BFC@utc.fr>
References: <A76FB9A9-9F8A-4836-8CDB-7622E9D76BFC@utc.fr>
Message-ID: <20230107112045.4fcf06b3@Tarkus>

On Sat, 7 Jan 2023 15:02:18 +0700
Thierry Denoeux <thierry.denoeux at utc.fr> wrote:

> The NEWS file is a text file created by TextEdit on Mac with UTF-8
> encoding, so I don?t see how there could be hidden special characters
> in it.

The problem is that the NEWS files are supposed to have a certain
format (documented in help(news)). For a long time, this hasn't been
enforced, but now there are checks in place that require NEWS to be
written to specifications.

I think that your line can be transformed as follows in order to parse
correctly:

Changes in version 2.0.0

 * Implementation of radial basis function neural network classifiers,
   as well as functions to express the outputs of trained logistic
   regression or feed-forward neural network classifiers as
   Dempster-Shafer mass functions. These methods are based on an
   interpretation of the operations performed in neural networks as the
   combination of weights of evidence by Dempster's rule (see: "T.
   Denoeux, Logistic Regression, Neural Networks and Dempster-Shafer
   Theory: a New Perspective. Knowledge-Based Systems 176:54-67, 2019").

You can also write an inst/NEWS.Rd file in Rd format.

As you can see from reading ?news, it is preferred to provide a
bulleted list of the changes.

-- 
Best regards,
Ivan


From th|erry@denoeux @end|ng |rom utc@|r  Sat Jan  7 10:37:53 2023
From: th|erry@denoeux @end|ng |rom utc@|r (Thierry Denoeux)
Date: Sat, 7 Jan 2023 16:37:53 +0700
Subject: [R-pkg-devel] Problem with NEWS file
In-Reply-To: <20230107112045.4fcf06b3@Tarkus>
References: <A76FB9A9-9F8A-4836-8CDB-7622E9D76BFC@utc.fr>
 <20230107112045.4fcf06b3@Tarkus>
Message-ID: <B219EF5F-BEE8-4071-AA95-608DE2539DA1@utc.fr>

I had overlooked these new specifications for the NEWS file. Thank you very much!
Thierry
----------
Prof. Thierry Denoeux
Universit? de technologie de Compi?gne
Institut universitaire de France
Rue Roger Couttolenc, CS 60319
60203 Compi?gne cedex, France
https://www.hds.utc.fr/~tdenoeux

> Le 7 janv. 2023 ? 15:20, Ivan Krylov <krylov.r00t at gmail.com> a ?crit :
> 
> On Sat, 7 Jan 2023 15:02:18 +0700
> Thierry Denoeux <thierry.denoeux at utc.fr> wrote:
> 
>> The NEWS file is a text file created by TextEdit on Mac with UTF-8
>> encoding, so I don?t see how there could be hidden special characters
>> in it.
> 
> The problem is that the NEWS files are supposed to have a certain
> format (documented in help(news)). For a long time, this hasn't been
> enforced, but now there are checks in place that require NEWS to be
> written to specifications.
> 
> I think that your line can be transformed as follows in order to parse
> correctly:
> 
> Changes in version 2.0.0
> 
> * Implementation of radial basis function neural network classifiers,
>   as well as functions to express the outputs of trained logistic
>   regression or feed-forward neural network classifiers as
>   Dempster-Shafer mass functions. These methods are based on an
>   interpretation of the operations performed in neural networks as the
>   combination of weights of evidence by Dempster's rule (see: "T.
>   Denoeux, Logistic Regression, Neural Networks and Dempster-Shafer
>   Theory: a New Perspective. Knowledge-Based Systems 176:54-67, 2019").
> 
> You can also write an inst/NEWS.Rd file in Rd format.
> 
> As you can see from reading ?news, it is preferred to provide a
> bulleted list of the changes.
> 
> -- 
> Best regards,
> Ivan


	[[alternative HTML version deleted]]


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sun Jan  8 02:43:10 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Sat, 7 Jan 2023 20:43:10 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
Message-ID: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>

Hi,

I am in the middle of developing a new package, which contains a 
markdown-knitr-html vignette. When I try to run

R CMD build [mypackagedirectory]

I get an error message

Quitting from lines 330-336
Error: processing vignette? failed with diagnostics:
invalid z limits

If I run the same markdown script interactively inside R Studio, there 
is no error.
If I knit the markdown script inside R Studio, it produces the correct 
HTML output, with no error.

The offending lines of code (the chunk at 330-336) invoke an "image" 
method on an object of a class defined in the package, which in turn 
computes a matrix from items inside the object and calls image.default, 
which is presumably where the error is coming from.

Two questions: (1) How is it possible that the same code works error 
free in the RStudio contexts, but fails in the attempt to build the package?
(2) Any suggestions on how to debug something that only throws an error 
from "R CMD build" would be most welcome.

Thanks in advance,
 ? Kevin


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Jan  8 11:04:44 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 8 Jan 2023 05:04:44 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
Message-ID: <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>

On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
> Hi,
> 
> I am in the middle of developing a new package, which contains a
> markdown-knitr-html vignette. When I try to run
> 
> R CMD build [mypackagedirectory]
> 
> I get an error message
> 
> Quitting from lines 330-336
> Error: processing vignette? failed with diagnostics:
> invalid z limits
> 
> If I run the same markdown script interactively inside R Studio, there
> is no error.
> If I knit the markdown script inside R Studio, it produces the correct
> HTML output, with no error.
> 
> The offending lines of code (the chunk at 330-336) invoke an "image"
> method on an object of a class defined in the package, which in turn
> computes a matrix from items inside the object and calls image.default,
> which is presumably where the error is coming from.
> 
> Two questions: (1) How is it possible that the same code works error
> free in the RStudio contexts, but fails in the attempt to build the package?
> (2) Any suggestions on how to debug something that only throws an error
> from "R CMD build" would be most welcome.

Debugging that sort of thing is hard.  Here's what I would try:

 From inside an R session, run

   tools:::.build_packages("[mypackagedirectory]")

That runs the code that R CMD build runs, so it might trigger the same 
error.  If so, debug in the usual way, with traceback(), etc.

If that doesn't trigger the error, try it using a different front-end, 
e.g. running R at the command line instead of running it in RStudio.

If you still can't trigger it, then start modifying the vignette to find 
the exact line that causes the error (e.g. by commenting out the second 
half of the code in that chunk; did the error go away? etc.).  Then 
modify it again to save all the inputs to the bad line in a file before 
running it, and see if running that line in a different context still 
triggers the error. Etc.

Duncan Murdoch


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Sun Jan  8 12:42:41 2023
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Sun, 8 Jan 2023 11:42:41 +0000
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
Message-ID: <CWLP265MB3505AF01E9516596CA84782DAEF99@CWLP265MB3505.GBRP265.PROD.OUTLOOK.COM>

A frequent cause of such errors is that in the offending scenario a method is not visible, so the call goes directly to the default method. This often can be verified by temporarily printing something from your method when it gets control.

Without more details it is difficult to be more specific. It may be a missing import or export, for example.

Georgi Boshnakov


Get Outlook for Android<https://aka.ms/AAb9ysg>

________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Duncan Murdoch <murdoch.duncan at gmail.com>
Sent: Sunday, 8 January 2023, 10:05
To: Kevin R. Coombes <kevin.r.coombes at gmail.com>; R Package Development <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] Mysterious "invalid z limit"

On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
> Hi,
>
> I am in the middle of developing a new package, which contains a
> markdown-knitr-html vignette. When I try to run
>
> R CMD build [mypackagedirectory]
>
> I get an error message
>
> Quitting from lines 330-336
> Error: processing vignette  failed with diagnostics:
> invalid z limits
>
> If I run the same markdown script interactively inside R Studio, there
> is no error.
> If I knit the markdown script inside R Studio, it produces the correct
> HTML output, with no error.
>
> The offending lines of code (the chunk at 330-336) invoke an "image"
> method on an object of a class defined in the package, which in turn
> computes a matrix from items inside the object and calls image.default,
> which is presumably where the error is coming from.
>
> Two questions: (1) How is it possible that the same code works error
> free in the RStudio contexts, but fails in the attempt to build the package?
> (2) Any suggestions on how to debug something that only throws an error
> from "R CMD build" would be most welcome.

Debugging that sort of thing is hard.  Here's what I would try:

 From inside an R session, run

   tools:::.build_packages("[mypackagedirectory]")

That runs the code that R CMD build runs, so it might trigger the same
error.  If so, debug in the usual way, with traceback(), etc.

If that doesn't trigger the error, try it using a different front-end,
e.g. running R at the command line instead of running it in RStudio.

If you still can't trigger it, then start modifying the vignette to find
the exact line that causes the error (e.g. by commenting out the second
half of the code in that chunk; did the error go away? etc.).  Then
modify it again to save all the inputs to the bad line in a file before
running it, and see if running that line in a different context still
triggers the error. Etc.

Duncan Murdoch

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Sun Jan  8 12:58:30 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sun, 8 Jan 2023 14:58:30 +0300
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
Message-ID: <20230108145830.5ad85981@Tarkus>

On Sat, 7 Jan 2023 20:43:10 -0500
"Kevin R. Coombes" <kevin.r.coombes at gmail.com> wrote:

> (1) How is it possible that the same code works error 
> free in the RStudio contexts, but fails in the attempt to build the
> package?

When knitting the vignette from RStudio, it uses the package you
already have installed. When knitting the vignette from R CMD build, it
uses the code it's about to package. Could it be that your source code
is different from the copy installed in your library?

> (2) Any suggestions on how to debug something that only
> throws an error from "R CMD build" would be most welcome.

R CMD build --no-build-vignettes should let you proceed and get a
tarball that could be installed. Hopefully you'll be able to reproduce
the error then.

-- 
Best regards,
Ivan


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sun Jan  8 16:00:30 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Sun, 8 Jan 2023 10:00:30 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <20230108145830.5ad85981@Tarkus>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <20230108145830.5ad85981@Tarkus>
Message-ID: <a92eb547-f448-2ae3-fd46-cfd05f8c1b6f@gmail.com>

A terrific answer; thanks. (I am kicking myself for not realizing the 
answer you gave to question 1. Of course that's the explanation. Too 
many consecutive hours debugging other items to get to that point, I 
suppose.)
 ? Kevin

On 1/8/2023 6:58 AM, Ivan Krylov wrote:
> On Sat, 7 Jan 2023 20:43:10 -0500
> "Kevin R. Coombes" <kevin.r.coombes at gmail.com> wrote:
>
>> (1) How is it possible that the same code works error
>> free in the RStudio contexts, but fails in the attempt to build the
>> package?
> When knitting the vignette from RStudio, it uses the package you
> already have installed. When knitting the vignette from R CMD build, it
> uses the code it's about to package. Could it be that your source code
> is different from the copy installed in your library?
>
>> (2) Any suggestions on how to debug something that only
>> throws an error from "R CMD build" would be most welcome.
> R CMD build --no-build-vignettes should let you proceed and get a
> tarball that could be installed. Hopefully you'll be able to reproduce
> the error then.
>


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sun Jan  8 16:11:41 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Sun, 8 Jan 2023 10:11:41 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
Message-ID: <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>

A very helpful answer. For some reason (probably because I have an 
ancient perl script that automates the steps i take when building and 
checking packages), I keep forgetting that the "tools" package let's me 
do these things from within R.

I had already isolated the offending line ("plot(obj)") inside the chunk 
where the error occurred, and removed any additional arguments. I 
wrapped that line in a "try" command followed by a conditional 
"traceback()" to find the problem.? This allowed the package build to 
knit the vignette and provide some feedback about what was going on. It 
turned out that I had copied and pasted an assignment line of the form

main <- [compute the title]

from earlier in the code and pasted it directly as an argument to the 
call to image.default. And R did exactly what I told it to (not 
surprisingly), and interpreted the value of that assignment as the 
unnamed "zlim" option that would have been the corresponding positional 
argument that should have been there.

And yes, I still use "left arrow" <- instead of equals = as assignments. 
(Heck, I even use emacs and ESS with a leftover keybinding that uses the 
underscore key to insert the left arrow. Apparently, I'm ancient myself.)

 ? Kevin

On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
>> Hi,
>>
>> I am in the middle of developing a new package, which contains a
>> markdown-knitr-html vignette. When I try to run
>>
>> R CMD build [mypackagedirectory]
>>
>> I get an error message
>>
>> Quitting from lines 330-336
>> Error: processing vignette? failed with diagnostics:
>> invalid z limits
>>
>> If I run the same markdown script interactively inside R Studio, there
>> is no error.
>> If I knit the markdown script inside R Studio, it produces the correct
>> HTML output, with no error.
>>
>> The offending lines of code (the chunk at 330-336) invoke an "image"
>> method on an object of a class defined in the package, which in turn
>> computes a matrix from items inside the object and calls image.default,
>> which is presumably where the error is coming from.
>>
>> Two questions: (1) How is it possible that the same code works error
>> free in the RStudio contexts, but fails in the attempt to build the 
>> package?
>> (2) Any suggestions on how to debug something that only throws an error
>> from "R CMD build" would be most welcome.
>
> Debugging that sort of thing is hard.? Here's what I would try:
>
> From inside an R session, run
>
> ? tools:::.build_packages("[mypackagedirectory]")
>
> That runs the code that R CMD build runs, so it might trigger the same 
> error.? If so, debug in the usual way, with traceback(), etc.
>
> If that doesn't trigger the error, try it using a different front-end, 
> e.g. running R at the command line instead of running it in RStudio.
>
> If you still can't trigger it, then start modifying the vignette to 
> find the exact line that causes the error (e.g. by commenting out the 
> second half of the code in that chunk; did the error go away? etc.).? 
> Then modify it again to save all the inputs to the bad line in a file 
> before running it, and see if running that line in a different context 
> still triggers the error. Etc.
>
> Duncan Murdoch


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun Jan  8 17:30:32 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 8 Jan 2023 10:30:32 -0600
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
Message-ID: <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>

	  If you use GitHub, I highly recommend using "GitHub Action" as 
described by Wickham and Bryan, R Packages:


https://r-pkgs.org/code.html#code-style


	  I'm not sure the best way to get it set up, but I have all my 
packages on GitHub configured so each "push" that changes anything has 
"R CMD Check" run on 5 different platforms:  The release version of R on 
the latest Windows, macOS, and Ubuntu plus the development version and 
the most recent old release on Ubuntu.  I rarely run R CMD check on my 
local machine anymore:  I just "git commit" and "git push".  Then GitHub 
Action manages testing on those 5 platforms.


	  To be precise, I do "git status" before "git push" to make sure I 
have "committed" everything I want to commit before I "git push".  And I 
do "git pull" to make sure a collaborator hasn't "pushed" something new 
I should look at before I "git push".


	  Finally, I want to thank again G?bor Cs?rdi who helped me greatly get 
past problems I hand with "GitHub Action" for my "sos" package.  He 
provided example workflows in:


https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml


	  I also needed LaTeX support, for which G?bor suggested the following:


https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages


	  Spencer Graves
	

On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
> A very helpful answer. For some reason (probably because I have an 
> ancient perl script that automates the steps i take when building and 
> checking packages), I keep forgetting that the "tools" package let's me 
> do these things from within R.
> 
> I had already isolated the offending line ("plot(obj)") inside the chunk 
> where the error occurred, and removed any additional arguments. I 
> wrapped that line in a "try" command followed by a conditional 
> "traceback()" to find the problem.? This allowed the package build to 
> knit the vignette and provide some feedback about what was going on. It 
> turned out that I had copied and pasted an assignment line of the form
> 
> main <- [compute the title]
> 
> from earlier in the code and pasted it directly as an argument to the 
> call to image.default. And R did exactly what I told it to (not 
> surprisingly), and interpreted the value of that assignment as the 
> unnamed "zlim" option that would have been the corresponding positional 
> argument that should have been there.
> 
> And yes, I still use "left arrow" <- instead of equals = as assignments. 
> (Heck, I even use emacs and ESS with a leftover keybinding that uses the 
> underscore key to insert the left arrow. Apparently, I'm ancient myself.)
> 
>  ? Kevin
> 
> On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
>> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
>>> Hi,
>>>
>>> I am in the middle of developing a new package, which contains a
>>> markdown-knitr-html vignette. When I try to run
>>>
>>> R CMD build [mypackagedirectory]
>>>
>>> I get an error message
>>>
>>> Quitting from lines 330-336
>>> Error: processing vignette? failed with diagnostics:
>>> invalid z limits
>>>
>>> If I run the same markdown script interactively inside R Studio, there
>>> is no error.
>>> If I knit the markdown script inside R Studio, it produces the correct
>>> HTML output, with no error.
>>>
>>> The offending lines of code (the chunk at 330-336) invoke an "image"
>>> method on an object of a class defined in the package, which in turn
>>> computes a matrix from items inside the object and calls image.default,
>>> which is presumably where the error is coming from.
>>>
>>> Two questions: (1) How is it possible that the same code works error
>>> free in the RStudio contexts, but fails in the attempt to build the 
>>> package?
>>> (2) Any suggestions on how to debug something that only throws an error
>>> from "R CMD build" would be most welcome.
>>
>> Debugging that sort of thing is hard.? Here's what I would try:
>>
>> From inside an R session, run
>>
>> ? tools:::.build_packages("[mypackagedirectory]")
>>
>> That runs the code that R CMD build runs, so it might trigger the same 
>> error.? If so, debug in the usual way, with traceback(), etc.
>>
>> If that doesn't trigger the error, try it using a different front-end, 
>> e.g. running R at the command line instead of running it in RStudio.
>>
>> If you still can't trigger it, then start modifying the vignette to 
>> find the exact line that causes the error (e.g. by commenting out the 
>> second half of the code in that chunk; did the error go away? etc.). 
>> Then modify it again to save all the inputs to the bad line in a file 
>> before running it, and see if running that line in a different context 
>> still triggers the error. Etc.
>>
>> Duncan Murdoch
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Sun Jan  8 18:36:02 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin Coombes)
Date: Sun, 8 Jan 2023 12:36:02 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
Message-ID: <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>

I have been using R-Forge for many years for package development. And I
have been using GitLab for other projects almost as long.

However, over the past few months, the R-Forge support seems to be
decaying, and I now have several projects that won't currently build there
because of various items that appear to need fixing at their end. So, I am
actively exploring what it will take to move packages and projects to git.

I already know how to use a git client to clone a Subversion repository
from R-Forge (using "git svn"). And how to change the remote origin to push
it to a new git location. (And I  may also be willing to lose the revision
history if it is going to make the transition easier.)

I am now at the step of understanding the recent changes at GitLab with
respect to support for "Educational" or "Open Source" status, especially in
terms of how many monthly minutes of CI/CD time I can use for free. When
working on a new package, I tend to make lots of small commit-pushes, and
it sounds like each one of those will eat up minutes. So, any advice on how
to manage that issue would be greatly appreciated.

Best,
  Kevin

On Sun, Jan 8, 2023, 11:30 AM Spencer Graves <
spencer.graves at effectivedefense.org> wrote:

>           If you use GitHub, I highly recommend using "GitHub Action" as
> described by Wickham and Bryan, R Packages:
>
>
> https://r-pkgs.org/code.html#code-style
>
>
>           I'm not sure the best way to get it set up, but I have all my
> packages on GitHub configured so each "push" that changes anything has
> "R CMD Check" run on 5 different platforms:  The release version of R on
> the latest Windows, macOS, and Ubuntu plus the development version and
> the most recent old release on Ubuntu.  I rarely run R CMD check on my
> local machine anymore:  I just "git commit" and "git push".  Then GitHub
> Action manages testing on those 5 platforms.
>
>
>           To be precise, I do "git status" before "git push" to make sure
> I
> have "committed" everything I want to commit before I "git push".  And I
> do "git pull" to make sure a collaborator hasn't "pushed" something new
> I should look at before I "git push".
>
>
>           Finally, I want to thank again G?bor Cs?rdi who helped me
> greatly get
> past problems I hand with "GitHub Action" for my "sos" package.  He
> provided example workflows in:
>
>
>
> https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml
>
>
>           I also needed LaTeX support, for which G?bor suggested the
> following:
>
>
> https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages
>
>
>           Spencer Graves
>
>
> On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
> > A very helpful answer. For some reason (probably because I have an
> > ancient perl script that automates the steps i take when building and
> > checking packages), I keep forgetting that the "tools" package let's me
> > do these things from within R.
> >
> > I had already isolated the offending line ("plot(obj)") inside the chunk
> > where the error occurred, and removed any additional arguments. I
> > wrapped that line in a "try" command followed by a conditional
> > "traceback()" to find the problem.  This allowed the package build to
> > knit the vignette and provide some feedback about what was going on. It
> > turned out that I had copied and pasted an assignment line of the form
> >
> > main <- [compute the title]
> >
> > from earlier in the code and pasted it directly as an argument to the
> > call to image.default. And R did exactly what I told it to (not
> > surprisingly), and interpreted the value of that assignment as the
> > unnamed "zlim" option that would have been the corresponding positional
> > argument that should have been there.
> >
> > And yes, I still use "left arrow" <- instead of equals = as assignments.
> > (Heck, I even use emacs and ESS with a leftover keybinding that uses the
> > underscore key to insert the left arrow. Apparently, I'm ancient myself.)
> >
> >    Kevin
> >
> > On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
> >> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
> >>> Hi,
> >>>
> >>> I am in the middle of developing a new package, which contains a
> >>> markdown-knitr-html vignette. When I try to run
> >>>
> >>> R CMD build [mypackagedirectory]
> >>>
> >>> I get an error message
> >>>
> >>> Quitting from lines 330-336
> >>> Error: processing vignette  failed with diagnostics:
> >>> invalid z limits
> >>>
> >>> If I run the same markdown script interactively inside R Studio, there
> >>> is no error.
> >>> If I knit the markdown script inside R Studio, it produces the correct
> >>> HTML output, with no error.
> >>>
> >>> The offending lines of code (the chunk at 330-336) invoke an "image"
> >>> method on an object of a class defined in the package, which in turn
> >>> computes a matrix from items inside the object and calls image.default,
> >>> which is presumably where the error is coming from.
> >>>
> >>> Two questions: (1) How is it possible that the same code works error
> >>> free in the RStudio contexts, but fails in the attempt to build the
> >>> package?
> >>> (2) Any suggestions on how to debug something that only throws an error
> >>> from "R CMD build" would be most welcome.
> >>
> >> Debugging that sort of thing is hard.  Here's what I would try:
> >>
> >> From inside an R session, run
> >>
> >>   tools:::.build_packages("[mypackagedirectory]")
> >>
> >> That runs the code that R CMD build runs, so it might trigger the same
> >> error.  If so, debug in the usual way, with traceback(), etc.
> >>
> >> If that doesn't trigger the error, try it using a different front-end,
> >> e.g. running R at the command line instead of running it in RStudio.
> >>
> >> If you still can't trigger it, then start modifying the vignette to
> >> find the exact line that causes the error (e.g. by commenting out the
> >> second half of the code in that chunk; did the error go away? etc.).
> >> Then modify it again to save all the inputs to the bad line in a file
> >> before running it, and see if running that line in a different context
> >> still triggers the error. Etc.
> >>
> >> Duncan Murdoch
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun Jan  8 19:38:58 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 8 Jan 2023 12:38:58 -0600
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
 <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
Message-ID: <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>



On 1/8/23 11:36 AM, Kevin Coombes wrote:
> I have been using R-Forge for many years for package development. And I 
> have been using GitLab for other projects almost as long.
> 
> However, over the past few months, the R-Forge support seems to be 
> decaying, and I now have several projects that won't currently build 
> there because of various items that appear to need fixing at their end. 
> So, I am actively exploring what it will take to move packages and 
> projects to git.


	  R-Forge was wonderful for me when I started using it.  Then several 
years ago, I started having problems like you described.  A few years 
ago I migrated from R-Forge to GitHub.


	  One problem I encountered in the transition:  On R-Forge, I had 
multiple packages in the same R-Forge project.  I had to split them 
apart for GitHub.

> 
> I already know how to use a git client to clone a Subversion repository 
> from R-Forge (using "git svn"). And how to change the remote origin to 
> push it to a new git location. (And I? may also be willing to lose the 
> revision history if it is going to make the transition easier.)
> 
> I am now at the step of understanding the recent changes at GitLab with 
> respect to support for "Educational" or "Open Source" status, especially 
> in terms of how many monthly minutes of CI/CD time I can use for free. 
> When working on a new package, I tend to make lots of small 
> commit-pushes, and it sounds like each one of those will eat up minutes. 
> So, any advice on how to manage that issue?would be greatly appreciated.


	  When I first got into Subversion, I remember Doug Bates saying, 
"Commit early and often."  The word "Commit" doesn't mean the same in 
Git as in Subversion, so I would encourage you to "Git push early and 
often."


	  There may be limits on free use of GitHub, but I'm not aware of them: 
  If you want a private account, you need to pay for that, but the 
charges for that are not much.


	  If anyone knows anything different from what I've just said, I hope 
they will disabuse my of this part of my ignorance.


	  Spencer

> 
> Best,
>  ? Kevin
> 
> On Sun, Jan 8, 2023, 11:30 AM Spencer Graves 
> <spencer.graves at effectivedefense.org 
> <mailto:spencer.graves at effectivedefense.org>> wrote:
> 
>      ? ? ? ? ? If you use GitHub, I highly recommend using "GitHub
>     Action" as
>     described by Wickham and Bryan, R Packages:
> 
> 
>     https://r-pkgs.org/code.html#code-style
>     <https://r-pkgs.org/code.html#code-style>
> 
> 
>      ? ? ? ? ? I'm not sure the best way to get it set up, but I have
>     all my
>     packages on GitHub configured so each "push" that changes anything has
>     "R CMD Check" run on 5 different platforms:? The release version of
>     R on
>     the latest Windows, macOS, and Ubuntu plus the development version and
>     the most recent old release on Ubuntu.? I rarely run R CMD check on my
>     local machine anymore:? I just "git commit" and "git push".? Then
>     GitHub
>     Action manages testing on those 5 platforms.
> 
> 
>      ? ? ? ? ? To be precise, I do "git status" before "git push" to
>     make sure I
>     have "committed" everything I want to commit before I "git push". 
>     And I
>     do "git pull" to make sure a collaborator hasn't "pushed" something new
>     I should look at before I "git push".
> 
> 
>      ? ? ? ? ? Finally, I want to thank again G?bor Cs?rdi who helped me
>     greatly get
>     past problems I hand with "GitHub Action" for my "sos" package.? He
>     provided example workflows in:
> 
> 
>     https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml <https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml>
> 
> 
>      ? ? ? ? ? I also needed LaTeX support, for which G?bor suggested
>     the following:
> 
> 
>     https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages
>     <https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages>
> 
> 
>      ? ? ? ? ? Spencer Graves
> 
> 
>     On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
>      > A very helpful answer. For some reason (probably because I have an
>      > ancient perl script that automates the steps i take when building
>     and
>      > checking packages), I keep forgetting that the "tools" package
>     let's me
>      > do these things from within R.
>      >
>      > I had already isolated the offending line ("plot(obj)") inside
>     the chunk
>      > where the error occurred, and removed any additional arguments. I
>      > wrapped that line in a "try" command followed by a conditional
>      > "traceback()" to find the problem.? This allowed the package
>     build to
>      > knit the vignette and provide some feedback about what was going
>     on. It
>      > turned out that I had copied and pasted an assignment line of the
>     form
>      >
>      > main <- [compute the title]
>      >
>      > from earlier in the code and pasted it directly as an argument to
>     the
>      > call to image.default. And R did exactly what I told it to (not
>      > surprisingly), and interpreted the value of that assignment as the
>      > unnamed "zlim" option that would have been the corresponding
>     positional
>      > argument that should have been there.
>      >
>      > And yes, I still use "left arrow" <- instead of equals = as
>     assignments.
>      > (Heck, I even use emacs and ESS with a leftover keybinding that
>     uses the
>      > underscore key to insert the left arrow. Apparently, I'm ancient
>     myself.)
>      >
>      >? ? Kevin
>      >
>      > On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
>      >> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
>      >>> Hi,
>      >>>
>      >>> I am in the middle of developing a new package, which contains a
>      >>> markdown-knitr-html vignette. When I try to run
>      >>>
>      >>> R CMD build [mypackagedirectory]
>      >>>
>      >>> I get an error message
>      >>>
>      >>> Quitting from lines 330-336
>      >>> Error: processing vignette? failed with diagnostics:
>      >>> invalid z limits
>      >>>
>      >>> If I run the same markdown script interactively inside R
>     Studio, there
>      >>> is no error.
>      >>> If I knit the markdown script inside R Studio, it produces the
>     correct
>      >>> HTML output, with no error.
>      >>>
>      >>> The offending lines of code (the chunk at 330-336) invoke an
>     "image"
>      >>> method on an object of a class defined in the package, which in
>     turn
>      >>> computes a matrix from items inside the object and calls
>     image.default,
>      >>> which is presumably where the error is coming from.
>      >>>
>      >>> Two questions: (1) How is it possible that the same code works
>     error
>      >>> free in the RStudio contexts, but fails in the attempt to build
>     the
>      >>> package?
>      >>> (2) Any suggestions on how to debug something that only throws
>     an error
>      >>> from "R CMD build" would be most welcome.
>      >>
>      >> Debugging that sort of thing is hard.? Here's what I would try:
>      >>
>      >> From inside an R session, run
>      >>
>      >> ? tools:::.build_packages("[mypackagedirectory]")
>      >>
>      >> That runs the code that R CMD build runs, so it might trigger
>     the same
>      >> error.? If so, debug in the usual way, with traceback(), etc.
>      >>
>      >> If that doesn't trigger the error, try it using a different
>     front-end,
>      >> e.g. running R at the command line instead of running it in RStudio.
>      >>
>      >> If you still can't trigger it, then start modifying the vignette to
>      >> find the exact line that causes the error (e.g. by commenting
>     out the
>      >> second half of the code in that chunk; did the error go away?
>     etc.).
>      >> Then modify it again to save all the inputs to the bad line in a
>     file
>      >> before running it, and see if running that line in a different
>     context
>      >> still triggers the error. Etc.
>      >>
>      >> Duncan Murdoch
>      >
>      > ______________________________________________
>      > R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org> mailing list
>      > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>


From bbo|ker @end|ng |rom gm@||@com  Sun Jan  8 19:52:57 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 8 Jan 2023 13:52:57 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
 <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
 <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
Message-ID: <70be627e-93ae-05db-3377-5c229faff736@gmail.com>



On 2023-01-08 1:38 p.m., Spencer Graves wrote:
> 
> 
> On 1/8/23 11:36 AM, Kevin Coombes wrote:
>> I have been using R-Forge for many years for package development. And 
>> I have been using GitLab for other projects almost as long.
>>
>> However, over the past few months, the R-Forge support seems to be 
>> decaying, and I now have several projects that won't currently build 
>> there because of various items that appear to need fixing at their 
>> end. So, I am actively exploring what it will take to move packages 
>> and projects to git.
> 
> 
>  ????? R-Forge was wonderful for me when I started using it.? Then 
> several years ago, I started having problems like you described.? A few 
> years ago I migrated from R-Forge to GitHub.
> 
> 
>  ????? One problem I encountered in the transition:? On R-Forge, I had 
> multiple packages in the same R-Forge project.? I had to split them 
> apart for GitHub.
> 
>>
>> I already know how to use a git client to clone a Subversion 
>> repository from R-Forge (using "git svn"). And how to change the 
>> remote origin to push it to a new git location. (And I? may also be 
>> willing to lose the revision history if it is going to make the 
>> transition easier.)
>>
>> I am now at the step of understanding the recent changes at GitLab 
>> with respect to support for "Educational" or "Open Source" status, 
>> especially in terms of how many monthly minutes of CI/CD time I can 
>> use for free. When working on a new package, I tend to make lots of 
>> small commit-pushes, and it sounds like each one of those will eat up 
>> minutes. So, any advice on how to manage that issue?would be greatly 
>> appreciated.
> 
> 
>  ????? When I first got into Subversion, I remember Doug Bates saying, 
> "Commit early and often."? The word "Commit" doesn't mean the same in 
> Git as in Subversion, so I would encourage you to "Git push early and 
> often."
> 
> 
>  ????? There may be limits on free use of GitHub, but I'm not aware of 
> them: ?If you want a private account, you need to pay for that, but the 
> charges for that are not much.

   The free tier of Github allows 2000 minutes/month of continuous 
integration testing for private repos, and unlimited (???) for public 
repos.  (2000 minutes/month is more than I've ever needed.)

   Furthermore, it's pretty easy to set up github actions so that it 
only runs tests if you ask it to (by appending e.g. "[run ci]" to your 
commit message), or in opt-out mode (i.e., skip tests if "[skip ci]" is 
in your commit message).

> 
> 
>  ????? If anyone knows anything different from what I've just said, I 
> hope they will disabuse my of this part of my ignorance.
> 
> 
>  ????? Spencer
> 
>>
>> Best,
>> ?? Kevin
>>
>> On Sun, Jan 8, 2023, 11:30 AM Spencer Graves 
>> <spencer.graves at effectivedefense.org 
>> <mailto:spencer.graves at effectivedefense.org>> wrote:
>>
>> ???? ? ? ? ? ? If you use GitHub, I highly recommend using "GitHub
>> ??? Action" as
>> ??? described by Wickham and Bryan, R Packages:
>>
>>
>> ??? https://r-pkgs.org/code.html#code-style
>> ??? <https://r-pkgs.org/code.html#code-style>
>>
>>
>> ???? ? ? ? ? ? I'm not sure the best way to get it set up, but I have
>> ??? all my
>> ??? packages on GitHub configured so each "push" that changes anything 
>> has
>> ??? "R CMD Check" run on 5 different platforms:? The release version of
>> ??? R on
>> ??? the latest Windows, macOS, and Ubuntu plus the development version 
>> and
>> ??? the most recent old release on Ubuntu.? I rarely run R CMD check 
>> on my
>> ??? local machine anymore:? I just "git commit" and "git push".? Then
>> ??? GitHub
>> ??? Action manages testing on those 5 platforms.
>>
>>
>> ???? ? ? ? ? ? To be precise, I do "git status" before "git push" to
>> ??? make sure I
>> ??? have "committed" everything I want to commit before I "git push". 
>> ??? And I
>> ??? do "git pull" to make sure a collaborator hasn't "pushed" 
>> something new
>> ??? I should look at before I "git push".
>>
>>
>> ???? ? ? ? ? ? Finally, I want to thank again G?bor Cs?rdi who helped me
>> ??? greatly get
>> ??? past problems I hand with "GitHub Action" for my "sos" package.? He
>> ??? provided example workflows in:
>>
>>
>>     
>> https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml <https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml>
>>
>>
>> ???? ? ? ? ? ? I also needed LaTeX support, for which G?bor suggested
>> ??? the following:
>>
>>
>> ??? https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages
>>     
>> <https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages>
>>
>>
>> ???? ? ? ? ? ? Spencer Graves
>>
>>
>> ??? On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
>> ???? > A very helpful answer. For some reason (probably because I have an
>> ???? > ancient perl script that automates the steps i take when building
>> ??? and
>> ???? > checking packages), I keep forgetting that the "tools" package
>> ??? let's me
>> ???? > do these things from within R.
>> ???? >
>> ???? > I had already isolated the offending line ("plot(obj)") inside
>> ??? the chunk
>> ???? > where the error occurred, and removed any additional arguments. I
>> ???? > wrapped that line in a "try" command followed by a conditional
>> ???? > "traceback()" to find the problem.? This allowed the package
>> ??? build to
>> ???? > knit the vignette and provide some feedback about what was going
>> ??? on. It
>> ???? > turned out that I had copied and pasted an assignment line of the
>> ??? form
>> ???? >
>> ???? > main <- [compute the title]
>> ???? >
>> ???? > from earlier in the code and pasted it directly as an argument to
>> ??? the
>> ???? > call to image.default. And R did exactly what I told it to (not
>> ???? > surprisingly), and interpreted the value of that assignment as the
>> ???? > unnamed "zlim" option that would have been the corresponding
>> ??? positional
>> ???? > argument that should have been there.
>> ???? >
>> ???? > And yes, I still use "left arrow" <- instead of equals = as
>> ??? assignments.
>> ???? > (Heck, I even use emacs and ESS with a leftover keybinding that
>> ??? uses the
>> ???? > underscore key to insert the left arrow. Apparently, I'm ancient
>> ??? myself.)
>> ???? >
>> ???? >? ? Kevin
>> ???? >
>> ???? > On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
>> ???? >> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
>> ???? >>> Hi,
>> ???? >>>
>> ???? >>> I am in the middle of developing a new package, which contains a
>> ???? >>> markdown-knitr-html vignette. When I try to run
>> ???? >>>
>> ???? >>> R CMD build [mypackagedirectory]
>> ???? >>>
>> ???? >>> I get an error message
>> ???? >>>
>> ???? >>> Quitting from lines 330-336
>> ???? >>> Error: processing vignette? failed with diagnostics:
>> ???? >>> invalid z limits
>> ???? >>>
>> ???? >>> If I run the same markdown script interactively inside R
>> ??? Studio, there
>> ???? >>> is no error.
>> ???? >>> If I knit the markdown script inside R Studio, it produces the
>> ??? correct
>> ???? >>> HTML output, with no error.
>> ???? >>>
>> ???? >>> The offending lines of code (the chunk at 330-336) invoke an
>> ??? "image"
>> ???? >>> method on an object of a class defined in the package, which in
>> ??? turn
>> ???? >>> computes a matrix from items inside the object and calls
>> ??? image.default,
>> ???? >>> which is presumably where the error is coming from.
>> ???? >>>
>> ???? >>> Two questions: (1) How is it possible that the same code works
>> ??? error
>> ???? >>> free in the RStudio contexts, but fails in the attempt to build
>> ??? the
>> ???? >>> package?
>> ???? >>> (2) Any suggestions on how to debug something that only throws
>> ??? an error
>> ???? >>> from "R CMD build" would be most welcome.
>> ???? >>
>> ???? >> Debugging that sort of thing is hard.? Here's what I would try:
>> ???? >>
>> ???? >> From inside an R session, run
>> ???? >>
>> ???? >> ? tools:::.build_packages("[mypackagedirectory]")
>> ???? >>
>> ???? >> That runs the code that R CMD build runs, so it might trigger
>> ??? the same
>> ???? >> error.? If so, debug in the usual way, with traceback(), etc.
>> ???? >>
>> ???? >> If that doesn't trigger the error, try it using a different
>> ??? front-end,
>> ???? >> e.g. running R at the command line instead of running it in 
>> RStudio.
>> ???? >>
>> ???? >> If you still can't trigger it, then start modifying the 
>> vignette to
>> ???? >> find the exact line that causes the error (e.g. by commenting
>> ??? out the
>> ???? >> second half of the code in that chunk; did the error go away?
>> ??? etc.).
>> ???? >> Then modify it again to save all the inputs to the bad line in a
>> ??? file
>> ???? >> before running it, and see if running that line in a different
>> ??? context
>> ???? >> still triggers the error. Etc.
>> ???? >>
>> ???? >> Duncan Murdoch
>> ???? >
>> ???? > ______________________________________________
>> ???? > R-package-devel at r-project.org
>> ??? <mailto:R-package-devel at r-project.org> mailing list
>> ???? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> ??? <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From w||||@m@becker @end|ng |rom b|ue|oxd@t@@eu  Mon Jan  9 10:28:18 2023
From: w||||@m@becker @end|ng |rom b|ue|oxd@t@@eu (William Becker)
Date: Mon, 9 Jan 2023 10:28:18 +0100 (CET)
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <70be627e-93ae-05db-3377-5c229faff736@gmail.com>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
 <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
 <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
 <70be627e-93ae-05db-3377-5c229faff736@gmail.com>
Message-ID: <1635330386.1430908.1673256498618@privateemail.com>

Thanks for mentioning the possibility to opt out of the CMD checks on GitHub actions, which I didn't know about before. I also have GHA set up and I like the concept of automated testing, but one thing that bothers me is that sometimes I make a small but necessary commit (e.g. to fix a bug) and it runs the whole suite of tests and checks on all functions which takes around five minutes. Most of the time this is overkill and it occurs to me that it has an unnecessary environmental impact. Perhaps this is something to think about occasionally in our CI/CD setups.

So now I'm off to tweak my GitHub actions...

> On 08/01/2023 19:52 CET Ben Bolker <bbolker at gmail.com> wrote:
> 
>  
> On 2023-01-08 1:38 p.m., Spencer Graves wrote:
> > 
> > 
> > On 1/8/23 11:36 AM, Kevin Coombes wrote:
> >> I have been using R-Forge for many years for package development. And 
> >> I have been using GitLab for other projects almost as long.
> >>
> >> However, over the past few months, the R-Forge support seems to be 
> >> decaying, and I now have several projects that won't currently build 
> >> there because of various items that appear to need fixing at their 
> >> end. So, I am actively exploring what it will take to move packages 
> >> and projects to git.
> > 
> > 
> >  ????? R-Forge was wonderful for me when I started using it.? Then 
> > several years ago, I started having problems like you described.? A few 
> > years ago I migrated from R-Forge to GitHub.
> > 
> > 
> >  ????? One problem I encountered in the transition:? On R-Forge, I had 
> > multiple packages in the same R-Forge project.? I had to split them 
> > apart for GitHub.
> > 
> >>
> >> I already know how to use a git client to clone a Subversion 
> >> repository from R-Forge (using "git svn"). And how to change the 
> >> remote origin to push it to a new git location. (And I? may also be 
> >> willing to lose the revision history if it is going to make the 
> >> transition easier.)
> >>
> >> I am now at the step of understanding the recent changes at GitLab 
> >> with respect to support for "Educational" or "Open Source" status, 
> >> especially in terms of how many monthly minutes of CI/CD time I can 
> >> use for free. When working on a new package, I tend to make lots of 
> >> small commit-pushes, and it sounds like each one of those will eat up 
> >> minutes. So, any advice on how to manage that issue?would be greatly 
> >> appreciated.
> > 
> > 
> >  ????? When I first got into Subversion, I remember Doug Bates saying, 
> > "Commit early and often."? The word "Commit" doesn't mean the same in 
> > Git as in Subversion, so I would encourage you to "Git push early and 
> > often."
> > 
> > 
> >  ????? There may be limits on free use of GitHub, but I'm not aware of 
> > them: ?If you want a private account, you need to pay for that, but the 
> > charges for that are not much.
> 
>    The free tier of Github allows 2000 minutes/month of continuous 
> integration testing for private repos, and unlimited (???) for public 
> repos.  (2000 minutes/month is more than I've ever needed.)
> 
>    Furthermore, it's pretty easy to set up github actions so that it 
> only runs tests if you ask it to (by appending e.g. "[run ci]" to your 
> commit message), or in opt-out mode (i.e., skip tests if "[skip ci]" is 
> in your commit message).
> 
> > 
> > 
> >  ????? If anyone knows anything different from what I've just said, I 
> > hope they will disabuse my of this part of my ignorance.
> > 
> > 
> >  ????? Spencer
> > 
> >>
> >> Best,
> >> ?? Kevin
> >>
> >> On Sun, Jan 8, 2023, 11:30 AM Spencer Graves 
> >> <spencer.graves at effectivedefense.org 
> >> <mailto:spencer.graves at effectivedefense.org>> wrote:
> >>
> >> ???? ? ? ? ? ? If you use GitHub, I highly recommend using "GitHub
> >> ??? Action" as
> >> ??? described by Wickham and Bryan, R Packages:
> >>
> >>
> >> ??? https://r-pkgs.org/code.html#code-style
> >> ??? <https://r-pkgs.org/code.html#code-style>
> >>
> >>
> >> ???? ? ? ? ? ? I'm not sure the best way to get it set up, but I have
> >> ??? all my
> >> ??? packages on GitHub configured so each "push" that changes anything 
> >> has
> >> ??? "R CMD Check" run on 5 different platforms:? The release version of
> >> ??? R on
> >> ??? the latest Windows, macOS, and Ubuntu plus the development version 
> >> and
> >> ??? the most recent old release on Ubuntu.? I rarely run R CMD check 
> >> on my
> >> ??? local machine anymore:? I just "git commit" and "git push".? Then
> >> ??? GitHub
> >> ??? Action manages testing on those 5 platforms.
> >>
> >>
> >> ???? ? ? ? ? ? To be precise, I do "git status" before "git push" to
> >> ??? make sure I
> >> ??? have "committed" everything I want to commit before I "git push". 
> >> ??? And I
> >> ??? do "git pull" to make sure a collaborator hasn't "pushed" 
> >> something new
> >> ??? I should look at before I "git push".
> >>
> >>
> >> ???? ? ? ? ? ? Finally, I want to thank again G?bor Cs?rdi who helped me
> >> ??? greatly get
> >> ??? past problems I hand with "GitHub Action" for my "sos" package.? He
> >> ??? provided example workflows in:
> >>
> >>
> >>     
> >> https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml <https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml>
> >>
> >>
> >> ???? ? ? ? ? ? I also needed LaTeX support, for which G?bor suggested
> >> ??? the following:
> >>
> >>
> >> ??? https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages
> >>     
> >> <https://github.com/r-lib/actions/tree/v2/setup-tinytex#ctan-packages>
> >>
> >>
> >> ???? ? ? ? ? ? Spencer Graves
> >>
> >>
> >> ??? On 1/8/23 9:11 AM, Kevin R. Coombes wrote:
> >> ???? > A very helpful answer. For some reason (probably because I have an
> >> ???? > ancient perl script that automates the steps i take when building
> >> ??? and
> >> ???? > checking packages), I keep forgetting that the "tools" package
> >> ??? let's me
> >> ???? > do these things from within R.
> >> ???? >
> >> ???? > I had already isolated the offending line ("plot(obj)") inside
> >> ??? the chunk
> >> ???? > where the error occurred, and removed any additional arguments. I
> >> ???? > wrapped that line in a "try" command followed by a conditional
> >> ???? > "traceback()" to find the problem.? This allowed the package
> >> ??? build to
> >> ???? > knit the vignette and provide some feedback about what was going
> >> ??? on. It
> >> ???? > turned out that I had copied and pasted an assignment line of the
> >> ??? form
> >> ???? >
> >> ???? > main <- [compute the title]
> >> ???? >
> >> ???? > from earlier in the code and pasted it directly as an argument to
> >> ??? the
> >> ???? > call to image.default. And R did exactly what I told it to (not
> >> ???? > surprisingly), and interpreted the value of that assignment as the
> >> ???? > unnamed "zlim" option that would have been the corresponding
> >> ??? positional
> >> ???? > argument that should have been there.
> >> ???? >
> >> ???? > And yes, I still use "left arrow" <- instead of equals = as
> >> ??? assignments.
> >> ???? > (Heck, I even use emacs and ESS with a leftover keybinding that
> >> ??? uses the
> >> ???? > underscore key to insert the left arrow. Apparently, I'm ancient
> >> ??? myself.)
> >> ???? >
> >> ???? >? ? Kevin
> >> ???? >
> >> ???? > On 1/8/2023 5:04 AM, Duncan Murdoch wrote:
> >> ???? >> On 07/01/2023 8:43 p.m., Kevin R. Coombes wrote:
> >> ???? >>> Hi,
> >> ???? >>>
> >> ???? >>> I am in the middle of developing a new package, which contains a
> >> ???? >>> markdown-knitr-html vignette. When I try to run
> >> ???? >>>
> >> ???? >>> R CMD build [mypackagedirectory]
> >> ???? >>>
> >> ???? >>> I get an error message
> >> ???? >>>
> >> ???? >>> Quitting from lines 330-336
> >> ???? >>> Error: processing vignette? failed with diagnostics:
> >> ???? >>> invalid z limits
> >> ???? >>>
> >> ???? >>> If I run the same markdown script interactively inside R
> >> ??? Studio, there
> >> ???? >>> is no error.
> >> ???? >>> If I knit the markdown script inside R Studio, it produces the
> >> ??? correct
> >> ???? >>> HTML output, with no error.
> >> ???? >>>
> >> ???? >>> The offending lines of code (the chunk at 330-336) invoke an
> >> ??? "image"
> >> ???? >>> method on an object of a class defined in the package, which in
> >> ??? turn
> >> ???? >>> computes a matrix from items inside the object and calls
> >> ??? image.default,
> >> ???? >>> which is presumably where the error is coming from.
> >> ???? >>>
> >> ???? >>> Two questions: (1) How is it possible that the same code works
> >> ??? error
> >> ???? >>> free in the RStudio contexts, but fails in the attempt to build
> >> ??? the
> >> ???? >>> package?
> >> ???? >>> (2) Any suggestions on how to debug something that only throws
> >> ??? an error
> >> ???? >>> from "R CMD build" would be most welcome.
> >> ???? >>
> >> ???? >> Debugging that sort of thing is hard.? Here's what I would try:
> >> ???? >>
> >> ???? >> From inside an R session, run
> >> ???? >>
> >> ???? >> ? tools:::.build_packages("[mypackagedirectory]")
> >> ???? >>
> >> ???? >> That runs the code that R CMD build runs, so it might trigger
> >> ??? the same
> >> ???? >> error.? If so, debug in the usual way, with traceback(), etc.
> >> ???? >>
> >> ???? >> If that doesn't trigger the error, try it using a different
> >> ??? front-end,
> >> ???? >> e.g. running R at the command line instead of running it in 
> >> RStudio.
> >> ???? >>
> >> ???? >> If you still can't trigger it, then start modifying the 
> >> vignette to
> >> ???? >> find the exact line that causes the error (e.g. by commenting
> >> ??? out the
> >> ???? >> second half of the code in that chunk; did the error go away?
> >> ??? etc.).
> >> ???? >> Then modify it again to save all the inputs to the bad line in a
> >> ??? file
> >> ???? >> before running it, and see if running that line in a different
> >> ??? context
> >> ???? >> still triggers the error. Etc.
> >> ???? >>
> >> ???? >> Duncan Murdoch
> >> ???? >
> >> ???? > ______________________________________________
> >> ???? > R-package-devel at r-project.org
> >> ??? <mailto:R-package-devel at r-project.org> mailing list
> >> ???? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >> ??? <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> >>
> > 
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> -- 
> Dr. Benjamin Bolker
> Professor, Mathematics & Statistics and Biology, McMaster University
> Director, School of Computational Science and Engineering
> (Acting) Graduate chair, Mathematics & Statistics
>  > E-mail is sent at my convenience; I don't expect replies outside of 
> working hours.
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

William Becker PhD
willbecker.me (https://www.willbecker.me/)
See our new project at compositeindicators.com (https://compositeindicators.com/)


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Mon Jan  9 20:44:02 2023
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Mon, 9 Jan 2023 14:44:02 -0500
Subject: [R-pkg-devel] Mysterious "invalid z limit"
In-Reply-To: <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
References: <c9f10ae8-a82a-c3c0-bac8-1e9b4948366f@gmail.com>
 <9ed9140c-4117-8089-f41e-c59452a3fcd6@gmail.com>
 <b11ae131-4f31-f57c-1dff-ba91ce50e583@gmail.com>
 <5db657e5-def6-6526-0e3b-951231cf04f3@effectivedefense.org>
 <CAHJ+2VKkVMOpoCiDj8PxPtgqrRgiZn+1hszqC7KXbFpHFibS=A@mail.gmail.com>
 <562bc0a8-3144-4d42-e1f6-45cfd536e01d@effectivedefense.org>
Message-ID: <5f8dde15-38a0-d8fc-b2d4-53eb3be4bca4@gmail.com>

Did you have to split the packages to get the CI/CD tools to work? 
Because,to me, it looks as though I can install multiple different R 
packages from the same git project, using something like

library(devtools)
install_gitlab("krcoombes/[PROJECT]", "pkg/[PACKAGE]")

Best,
 ? Kevin

On 1/8/2023 1:38 PM, Spencer Graves wrote:
>
> ????? R-Forge was wonderful for me when I started using it.? Then 
> several years ago, I started having problems like you described. A few 
> years ago I migrated from R-Forge to GitHub.
>
>
> ????? One problem I encountered in the transition:? On R-Forge, I had 
> multiple packages in the same R-Forge project.? I had to split them 
> apart for GitHub.


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Fri Jan 13 09:54:50 2023
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Fri, 13 Jan 2023 08:54:50 +0000
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
Message-ID: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Dear list members,

I am getting the following response when I try to upload growthPheno_2.1.17.tar.gz:

Detected package information [non-editable]
In case of errors reupload the package or contact cran team

The package was successfully uploaded on 2022-11-15. It is available on https://github.com/briencj/growthPheno.

I have scoured the DESCRIPTION file and compared it with the DESCRIPTION file for dae, another of my packages that has been successfully uploaded in the last 12 hours.

I have run R CMD  --as-cran growthPheno_2.1.17.tar.gz with the final status being OK.

I am stumped as to what is causing the problem. Can anyone throw any lot on what the problem might be?

Thanks in advance,

Cheers,

 Chris

Chris Brien | Senior Biostatistician
Australian Plant Phenomics Facility


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan 13 15:06:33 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 13 Jan 2023 17:06:33 +0300
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
In-Reply-To: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
References: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <20230113170633.55feee95@arachnoid>

? Fri, 13 Jan 2023 08:54:50 +0000
Chris Brien <chris.brien at adelaide.edu.au> ?????:

> I am getting the following response when I try to upload
> growthPheno_2.1.17.tar.gz:
> 
> Detected package information [non-editable]
> In case of errors reupload the package or contact cran team

That's not an error. This message is to inform you that the following
fields have been extracted from your DESCRIPTION file and aren't
supposed to be edited by hand. Is there a better way to phrase that?

Do you see anything out of place in the form? If the form content seems
OK, click the "Submit package" button near the bottom of the page to
continue.

-- 
Best regards,
Ivan


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Fri Jan 13 22:51:01 2023
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Fri, 13 Jan 2023 21:51:01 +0000
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
In-Reply-To: <20230113170633.55feee95@arachnoid>
References: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <20230113170633.55feee95@arachnoid>
Message-ID: <ME4P282MB12871E95DE9FD0305FC00159A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Hi Ivan,

Thanks for taking up my query.

I realized after I sent the message that I should have added that the package files is being dropped as well. It replaces my file name with "No file chosen".  Consequently I cannot continue submit the package.

I saw it as an error message because it is not a message that I have seen in the many times that I have uploaded a package to CRAN.

My interpretation of the message was that there is some "non-editable" material in the package information, most likely the DESCRIPTION file.

However, I doubted that this could be the case because the only changes in the DESCRIPTION file since I uploaded Version 2.1.16 two months ago are in the Version, Date, Packaged and Suggests, the latter having writeXLS removed because it is no longer needed.  I have verified that these are the only changed by extracting the DESCRIPTION file from both growthPheno_2.1.16 and 2.1.17 and doing a file comparison on them.

This led me to think that the problem must be in other than the DESCRIPTION file.

Unfortunately, I remain unable to upload the package.

Cheers,

  Chris



> -----Original Message-----
> From: Ivan Krylov <krylov.r00t at gmail.com>
> Sent: Saturday, 14 January 2023 12:37 AM
> To: Chris Brien <chris.brien at adelaide.edu.au>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
>
> CAUTION: External email. Only click on links or open attachments from
> trusted senders.
>
> ? Fri, 13 Jan 2023 08:54:50 +0000
> Chris Brien <chris.brien at adelaide.edu.au> ?????:
>
> > I am getting the following response when I try to upload
> > growthPheno_2.1.17.tar.gz:
> >
> > Detected package information [non-editable] In case of errors reupload
> > the package or contact cran team
>
> That's not an error. This message is to inform you that the following fields
> have been extracted from your DESCRIPTION file and aren't supposed to be
> edited by hand. Is there a better way to phrase that?
>
> Do you see anything out of place in the form? If the form content seems OK,
> click the "Submit package" button near the bottom of the page to continue.
>
> --
> Best regards,
> Ivan


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan 13 23:15:13 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 14 Jan 2023 01:15:13 +0300
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
In-Reply-To: <ME4P282MB12871E95DE9FD0305FC00159A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
References: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <20230113170633.55feee95@arachnoid>
 <ME4P282MB12871E95DE9FD0305FC00159A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <20230114011513.4456b7b6@Tarkus>

On Fri, 13 Jan 2023 21:51:01 +0000
Chris Brien <chris.brien at adelaide.edu.au> wrote:

> the package files is being dropped as well. It replaces my file name
> with "No file chosen".  Consequently I cannot continue submit the
> package.

I understand that this behaviour is counter-intuitive, but that seems
to be the way it's supposed to work. Package submission is a multi-step
process:

Step 1 involves providing your name, your e-mail address and the
package file. Once uploaded, the package file stays somewhere at CRAN,
at least for a while.

Step 2 involves making sure that you've uploaded the right package.
You're shown your name, e-mail address, the optional comment and the
fields from the DESCRIPTION file. The "Package:" file upload field
should be empty because CRAN already has a copy of the file.

Pressing the "Re-upload the package/Edit information" will repeat the
step 1 and take you back to the same place, just before the step 2. In
order to progress, you need to press the "Submit package" button below
the form, despite the "Package:" file upload field is empty.

Do the "Title:", "Description:", "Authors(s):" fields contain the
information for your package? Does the "Submit package" button work for
you? Are there any other messages there?

Perhaps the CRAN submission form should show some indication that the
file has been uploaded near the file entry field during step 2?

-- 
Best regards,
Ivan


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Fri Jan 13 23:59:45 2023
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Fri, 13 Jan 2023 22:59:45 +0000
Subject: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
In-Reply-To: <20230114011513.4456b7b6@Tarkus>
References: <ME4P282MB12876CF9D4A135C5381582B9A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <20230113170633.55feee95@arachnoid>
 <ME4P282MB12871E95DE9FD0305FC00159A0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <20230114011513.4456b7b6@Tarkus>
Message-ID: <ME4P282MB1287C1704A5378D233B1CA7FA0C29@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Hi Ivan,

The submit button has worked!!!!

You are right that it is counterintuitive and I have been well trained not to submit things to CRAN that contain errors :-)

I agree that something like "Package uploaded" would be better than "No file chosen" in Stage 2, afterall I have chosen a file.

Thanks very much for your help. All's well that ends well.

Cheers,

  Chris



> -----Original Message-----
> From: Ivan Krylov <krylov.r00t at gmail.com>
> Sent: Saturday, 14 January 2023 8:45 AM
> To: Chris Brien <chris.brien at adelaide.edu.au>
> Cc: r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] Failed CRAN tar.gz upload to CRAN
>
> CAUTION: External email. Only click on links or open attachments from
> trusted senders.
>
> On Fri, 13 Jan 2023 21:51:01 +0000
> Chris Brien <chris.brien at adelaide.edu.au> wrote:
>
> > the package files is being dropped as well. It replaces my file name
> > with "No file chosen".  Consequently I cannot continue submit the
> > package.
>
> I understand that this behaviour is counter-intuitive, but that seems to be
> the way it's supposed to work. Package submission is a multi-step
> process:
>
> Step 1 involves providing your name, your e-mail address and the package
> file. Once uploaded, the package file stays somewhere at CRAN, at least for a
> while.
>
> Step 2 involves making sure that you've uploaded the right package.
> You're shown your name, e-mail address, the optional comment and the
> fields from the DESCRIPTION file. The "Package:" file upload field should be
> empty because CRAN already has a copy of the file.
>
> Pressing the "Re-upload the package/Edit information" will repeat the step 1
> and take you back to the same place, just before the step 2. In order to
> progress, you need to press the "Submit package" button below the form,
> despite the "Package:" file upload field is empty.
>
> Do the "Title:", "Description:", "Authors(s):" fields contain the information for
> your package? Does the "Submit package" button work for you? Are there
> any other messages there?
>
> Perhaps the CRAN submission form should show some indication that the file
> has been uploaded near the file entry field during step 2?
>
> --
> Best regards,
> Ivan


From m@|zhou @end|ng |rom gm@||@com  Thu Jan 19 05:00:35 2023
From: m@|zhou @end|ng |rom gm@||@com (mai zhou)
Date: Wed, 18 Jan 2023 23:00:35 -0500
Subject: [R-pkg-devel] Rcmd check skip example
Message-ID: <CAJGy0hd219xgqs0_gfiu_gQRNfZHcq+u7Qx1+hXV9iNQE2TjJA@mail.gmail.com>

Hi,

In the process of adding examples to the .RD file, I noticed
Rcmd check seems to skip certain example code.

I put my example code  x%*%y%*%z  (matrix multiplication) in the
RD file. After running Rcmd check
(on windows) and look into the xxx.Rcheck directory,
  xxx-EX.ROUT  file, it seems that the example check stopped
 at x (i.e. everything after % sign is ignored, like LaTeX).

That seems like a bug. Can anyone confirm on newer version?

Mine:

> sessionInfo()
R version 4.1.2 (2021-11-01)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 22621)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.2    emplikAUC_0.3     rootSolve_1.8.2.3 emplik2_1.32
>


Mm... I have Win11, why the sessionInfo() say W10 ?  (but that is something
else)

best,

Mai Zhou

	[[alternative HTML version deleted]]


From @kw@|mmo @end|ng |rom gm@||@com  Thu Jan 19 05:17:57 2023
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Wed, 18 Jan 2023 23:17:57 -0500
Subject: [R-pkg-devel] Rcmd check skip example
In-Reply-To: <CAJGy0hd219xgqs0_gfiu_gQRNfZHcq+u7Qx1+hXV9iNQE2TjJA@mail.gmail.com>
References: <CAJGy0hd219xgqs0_gfiu_gQRNfZHcq+u7Qx1+hXV9iNQE2TjJA@mail.gmail.com>
Message-ID: <CAPcHnpQguvFBWCmCQBObcu9UXvtLQ=yTdiJKzZjrdH5ExARBBQ@mail.gmail.com>

Rd documentation is latex like, so comments can be included with a percent
symbol. You should write \% if you intend to write a literal percent
symbol.

On Wed, Jan 18, 2023, 23:00 mai zhou <maizhou at gmail.com> wrote:

> Hi,
>
> In the process of adding examples to the .RD file, I noticed
> Rcmd check seems to skip certain example code.
>
> I put my example code  x%*%y%*%z  (matrix multiplication) in the
> RD file. After running Rcmd check
> (on windows) and look into the xxx.Rcheck directory,
>   xxx-EX.ROUT  file, it seems that the example check stopped
>  at x (i.e. everything after % sign is ignored, like LaTeX).
>
> That seems like a bug. Can anyone confirm on newer version?
>
> Mine:
>
> > sessionInfo()
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 10 x64 (build 22621)
>
> Matrix products: default
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2    emplikAUC_0.3     rootSolve_1.8.2.3 emplik2_1.32
> >
>
>
> Mm... I have Win11, why the sessionInfo() say W10 ?  (but that is something
> else)
>
> best,
>
> Mai Zhou
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Thu Jan 19 11:57:21 2023
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Thu, 19 Jan 2023 11:57:21 +0100
Subject: [R-pkg-devel] Rcmd check skip example
In-Reply-To: <CAJGy0hd219xgqs0_gfiu_gQRNfZHcq+u7Qx1+hXV9iNQE2TjJA@mail.gmail.com>
References: <CAJGy0hd219xgqs0_gfiu_gQRNfZHcq+u7Qx1+hXV9iNQE2TjJA@mail.gmail.com>
Message-ID: <1ac52482-6907-e516-a371-2cb850c82015@gmail.com>


On 1/19/23 05:00, mai zhou wrote:
> Hi,
>
> In the process of adding examples to the .RD file, I noticed
> Rcmd check seems to skip certain example code.
>
> I put my example code  x%*%y%*%z  (matrix multiplication) in the
> RD file. After running Rcmd check
> (on windows) and look into the xxx.Rcheck directory,
>    xxx-EX.ROUT  file, it seems that the example check stopped
>   at x (i.e. everything after % sign is ignored, like LaTeX).
>
> That seems like a bug. Can anyone confirm on newer version?
>
> Mine:
>
>> sessionInfo()
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 10 x64 (build 22621)
>
> Matrix products: default
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2    emplikAUC_0.3     rootSolve_1.8.2.3 emplik2_1.32
>
> Mm... I have Win11, why the sessionInfo() say W10 ?  (but that is something
> else)

R 4.1.0 was released before Windows 11, but even in R-devel, 
sessionInfo() reports "Windows 10" on "Windows 11". The problem is that 
the information comes from win.version()/GetVersionEx() and, as also 
documented in ?win.version, this may return "compatibility version".

With the already released versions of R and current R-devel, one can 
tell Windows 11 from the build number (your 22621 is Windows 11 22H2, 
22000 is Windows 11 21H2).

Thanks for spotting and reporting this.

Tomas

>
> best,
>
> Mai Zhou
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Thu Jan 19 12:33:42 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Thu, 19 Jan 2023 12:33:42 +0100
Subject: [R-pkg-devel] Rcmd check skip example
In-Reply-To: <1ac52482-6907-e516-a371-2cb850c82015@gmail.com>
References: <CAJGy0hd219xgqs0_gfiu_gQRNfZHcq+u7Qx1+hXV9iNQE2TjJA@mail.gmail.com>
 <1ac52482-6907-e516-a371-2cb850c82015@gmail.com>
Message-ID: <f4428811-9949-414e-3722-2ae795f836b8@statistik.tu-dortmund.de>



On 19.01.2023 11:57, Tomas Kalibera wrote:
> 
> On 1/19/23 05:00, mai zhou wrote:
>> Hi,
>>
>> In the process of adding examples to the .RD file, I noticed
>> Rcmd check seems to skip certain example code.
>>
>> I put my example code? x%*%y%*%z? (matrix multiplication) in the
>> RD file. After running Rcmd check
>> (on windows) and look into the xxx.Rcheck directory,
>> ?? xxx-EX.ROUT? file, it seems that the example check stopped
>> ? at x (i.e. everything after % sign is ignored, like LaTeX).
>>
>> That seems like a bug. Can anyone confirm on newer version?
>>
>> Mine:
>>
>>> sessionInfo()
>> R version 4.1.2 (2021-11-01)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows 10 x64 (build 22621)
>>
>> Matrix products: default
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252
>> [2] LC_CTYPE=English_United States.1252
>> [3] LC_MONETARY=English_United States.1252
>> [4] LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats???? graphics? grDevices utils???? datasets? methods?? base
>>
>> loaded via a namespace (and not attached):
>> [1] compiler_4.1.2??? emplikAUC_0.3???? rootSolve_1.8.2.3 emplik2_1.32
>>
>> Mm... I have Win11, why the sessionInfo() say W10 ?? (but that is 
>> something
>> else)
> 
> R 4.1.0 was released before Windows 11, but even in R-devel, 
> sessionInfo() reports "Windows 10" on "Windows 11". The problem is that 
> the information comes from win.version()/GetVersionEx() and, as also 
> documented in ?win.version, this may return "compatibility version".
> 
> With the already released versions of R and current R-devel, one can 
> tell Windows 11 from the build number (your 22621 is Windows 11 22H2, 
> 22000 is Windows 11 21H2).

Indeed, the versions from 10.0.22000 are called Windows 11.
Windows 10 builds are expected to stay below 10.0.22000.
It is up to Microsoft why the label their version 10.x.y as Windows 11 
(well, they labelled version 5.x.y as Windows 2000 etc., so nothing new 
here).

Best,
Uwe Ligges



> 
> Thanks for spotting and reporting this.
> 
> Tomas
> 
>>
>> best,
>>
>> Mai Zhou
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Fri Jan 20 15:41:25 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Fri, 20 Jan 2023 08:41:25 -0600
Subject: [R-pkg-devel] corrupted NAMESPACE file
Message-ID: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>

Hello, All:


	  The NAMESPACE file in


https://github.com/JamesRamsay5/fda


is corrupted.  RStudio 2022.12.0+353 (the current version) won't open 
it, complaining, "File is binary rather than text so cannot be opened by 
the source editor."  TextEdit (macOS 11.7.2) opened it as normal, as did 
vi.  Both allowed me to make and save changes, but RStudio still gave 
the same error.  Worse, after "git push", GitHub Action on 5 platforms 
ended with:


** byte-compile and prepare package for lazy loading
Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
   1:1: unexpected input


	  That's the same error I've gotten with "R CMD build fda" locally.


	  Suggestions?
	  Thanks,
	  Spencer Graves


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Jan 20 15:53:56 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 20 Jan 2023 17:53:56 +0300
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
Message-ID: <20230120175356.5d529f5e@arachnoid>

? Fri, 20 Jan 2023 08:41:25 -0600
Spencer Graves <spencer.graves at effectivedefense.org> ?????:

> ** byte-compile and prepare package for lazy loading
> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>    1:1: unexpected input

tools::showNonASCIIfile('https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
# 1: <ef><bb><bf>export(AmpPhaseDecomp,

Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
You'll need to remove it, e.g. by re-creating the first line.

-- 
Best regards,
Ivan


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Fri Jan 20 16:22:46 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Fri, 20 Jan 2023 16:22:46 +0100
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <20230120175356.5d529f5e@arachnoid>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
Message-ID: <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>



On 20.01.2023 15:53, Ivan Krylov wrote:
> ? Fri, 20 Jan 2023 08:41:25 -0600
> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
> 
>> ** byte-compile and prepare package for lazy loading
>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>     1:1: unexpected input
> 
> tools::showNonASCIIfile('https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
> 
> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
> You'll need to remove it, e.g. by re-creating the first line.


Note that this is also called "byte order mark" (BOM). Tell your editor 
not to create files with BOM.

You can also fix in R:

x <- readLines(..., encoding="UTF-8-BOM")
writeLines(x, ......)

Best,
Uwe Ligges


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Fri Jan 20 18:15:52 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Fri, 20 Jan 2023 11:15:52 -0600
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
Message-ID: <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>

Hi, Ivan and Uwe:


	  Thanks for your suggestions, but I've so far been unable to get them 
to work.  see below.


On 1/20/23 9:22 AM, Uwe Ligges wrote:
> 
> 
> On 20.01.2023 15:53, Ivan Krylov wrote:
>> ? Fri, 20 Jan 2023 08:41:25 -0600
>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>
>>> ** byte-compile and prepare package for lazy loading
>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>> ??? 1:1: unexpected input
>>
>> tools::showNonASCIIfile('https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>
>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>> You'll need to remove it, e.g. by re-creating the first line.
> 
> 
> Note that this is also called "byte order mark" (BOM). Tell your editor 
> not to create files with BOM.
> 
> You can also fix in R:
> 
> x <- readLines(..., encoding="UTF-8-BOM")
> writeLines(x, ......)


	  In RStudio 2022.12.0+353 (the current version),


tools::showNonASCIIfile('https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')


returned "char(0)".  'readLines' and 'writeLines' as Uwe suggested 
failed to fix it for me.


	  The first problem I noticed with this was that RStudio could not read 
the NAMESPACE file.  When I tried, it said, "File is binary rather than 
text so cannot be opened by the source editor."  I changed something 
using a different editor and did "git commit" and "git push", and got 
the error on GitHub that I reported above.  I copied the file elsewhere, 
deleted it locally and from GitHub, then recreated it in LibreOffice by 
manually typing the first and last lines then copying the rest from a 
copy I had saved elsewhere.  The RStudio would open the file, but I 
still get the same error message as above from both "R CMD build fda" 
locally and from GitHub Action at:


https://github.com/JamesRamsay5/fda


	  Other suggestions?
	  Thanks,
	  Spencer Graves

> 
> Best,
> Uwe Ligges
> 
> 
> 
> 
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Jan 20 18:38:51 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 20 Jan 2023 12:38:51 -0500
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
Message-ID: <34d5c077-c429-8981-75c6-a7c9cc9c01ed@gmail.com>

On 20/01/2023 12:15 p.m., Spencer Graves wrote:
> Hi, Ivan and Uwe:
> 
> 
> 	  Thanks for your suggestions, but I've so far been unable to get them
> to work.  see below.
> 
> 
> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>
>>
>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>
>>>> ** byte-compile and prepare package for lazy loading
>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>  ??? 1:1: unexpected input
>>>
>>> tools::showNonASCIIfile('https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>
>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>>> You'll need to remove it, e.g. by re-creating the first line.
>>
>>
>> Note that this is also called "byte order mark" (BOM). Tell your editor
>> not to create files with BOM.
>>
>> You can also fix in R:
>>
>> x <- readLines(..., encoding="UTF-8-BOM")
>> writeLines(x, ......)
> 
> 
> 	  In RStudio 2022.12.0+353 (the current version),
> 
> 
> tools::showNonASCIIfile('https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> 
> 
> returned "char(0)".  'readLines' and 'writeLines' as Uwe suggested
> failed to fix it for me.
> 
> 
> 	  The first problem I noticed with this was that RStudio could not read
> the NAMESPACE file.  When I tried, it said, "File is binary rather than
> text so cannot be opened by the source editor."  I changed something
> using a different editor and did "git commit" and "git push", and got
> the error on GitHub that I reported above.  I copied the file elsewhere,
> deleted it locally and from GitHub, then recreated it in LibreOffice by
> manually typing the first and last lines then copying the rest from a
> copy I had saved elsewhere.  The RStudio would open the file, but I
> still get the same error message as above from both "R CMD build fda"
> locally and from GitHub Action at:
> 
> 
> https://github.com/JamesRamsay5/fda
> 
> 
> 	  Other suggestions?

I think Uwe's suggestion was to check out the file, apply his two steps, 
and commit it again.  Your showNonASCIIfile() call was trying to work on 
something else.  Maybe your other commands were too?

Another possibility is to roll back all your changes to that file until 
you have a copy you can work with.  I think commit ab455089 is probably 
the bad one; Github shows invisible changes to the first line.  You 
don't want those.

Duncan Murdoch


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Jan 20 19:03:42 2023
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Fri, 20 Jan 2023 10:03:42 -0800
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
Message-ID: <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>

Setting the locale to "C" (or perhaps some other non-UTF-8 locale) will
show the BOM bytes.  E.g., on Windows I get:

> Sys.getlocale()
[1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
States.utf8;LC_MONETARY=English_United
States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
> tools::showNonASCIIfile('
https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> rawToChar(readBin('
https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
what="raw", n=20))
[1] "?export(AmpPhasDec"
> Sys.setlocale(locale="C")
[1] "C"
> tools::showNonASCIIfile('
https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
1: <ef><bb><bf>export(AmpPhasDecomp,
> rawToChar(readBin('
https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
what="raw", n=20))
[1] "\357\273\277export(AmpPhasDec"

-Bill


On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
spencer.graves at effectivedefense.org> wrote:

> Hi, Ivan and Uwe:
>
>
>           Thanks for your suggestions, but I've so far been unable to get
> them
> to work.  see below.
>
>
> On 1/20/23 9:22 AM, Uwe Ligges wrote:
> >
> >
> > On 20.01.2023 15:53, Ivan Krylov wrote:
> >> ? Fri, 20 Jan 2023 08:41:25 -0600
> >> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
> >>
> >>> ** byte-compile and prepare package for lazy loading
> >>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
> >>>     1:1: unexpected input
> >>
> >> tools::showNonASCIIfile('
> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> >> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
> >>
> >> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
> >> You'll need to remove it, e.g. by re-creating the first line.
> >
> >
> > Note that this is also called "byte order mark" (BOM). Tell your editor
> > not to create files with BOM.
> >
> > You can also fix in R:
> >
> > x <- readLines(..., encoding="UTF-8-BOM")
> > writeLines(x, ......)
>
>
>           In RStudio 2022.12.0+353 (the current version),
>
>
> tools::showNonASCIIfile('
> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>
>
> returned "char(0)".  'readLines' and 'writeLines' as Uwe suggested
> failed to fix it for me.
>
>
>           The first problem I noticed with this was that RStudio could not
> read
> the NAMESPACE file.  When I tried, it said, "File is binary rather than
> text so cannot be opened by the source editor."  I changed something
> using a different editor and did "git commit" and "git push", and got
> the error on GitHub that I reported above.  I copied the file elsewhere,
> deleted it locally and from GitHub, then recreated it in LibreOffice by
> manually typing the first and last lines then copying the rest from a
> copy I had saved elsewhere.  The RStudio would open the file, but I
> still get the same error message as above from both "R CMD build fda"
> locally and from GitHub Action at:
>
>
> https://github.com/JamesRamsay5/fda
>
>
>           Other suggestions?
>           Thanks,
>           Spencer Graves
>
> >
> > Best,
> > Uwe Ligges
> >
> >
> >
> >
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From greg @end|ng |rom ||rm@n@y@h@com  Sat Jan 21 00:02:51 2023
From: greg @end|ng |rom ||rm@n@y@h@com (Greg Hunt)
Date: Sat, 21 Jan 2023 10:02:51 +1100
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
Message-ID: <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>

xFEFF isn't a BOM in a UTF-8 file, its not anything.   The UTF-8 BOM is a
different sequence of bits.  If tools treat it as a BOM, that is arguably a
problem.

On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com> wrote:

> Setting the locale to "C" (or perhaps some other non-UTF-8 locale) will
> show the BOM bytes.  E.g., on Windows I get:
>
> > Sys.getlocale()
> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
> States.utf8;LC_MONETARY=English_United
> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
> > tools::showNonASCIIfile('
> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> > rawToChar(readBin('
> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
> what="raw", n=20))
> [1] "?export(AmpPhasDec"
> > Sys.setlocale(locale="C")
> [1] "C"
> > tools::showNonASCIIfile('
> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> 1: <ef><bb><bf>export(AmpPhasDecomp,
> > rawToChar(readBin('
> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
> what="raw", n=20))
> [1] "\357\273\277export(AmpPhasDec"
>
> -Bill
>
>
> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
> spencer.graves at effectivedefense.org> wrote:
>
> > Hi, Ivan and Uwe:
> >
> >
> >           Thanks for your suggestions, but I've so far been unable to get
> > them
> > to work.  see below.
> >
> >
> > On 1/20/23 9:22 AM, Uwe Ligges wrote:
> > >
> > >
> > > On 20.01.2023 15:53, Ivan Krylov wrote:
> > >> ? Fri, 20 Jan 2023 08:41:25 -0600
> > >> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
> > >>
> > >>> ** byte-compile and prepare package for lazy loading
> > >>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
> > >>>     1:1: unexpected input
> > >>
> > >> tools::showNonASCIIfile('
> > https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> > >> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
> > >>
> > >> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
> > >> You'll need to remove it, e.g. by re-creating the first line.
> > >
> > >
> > > Note that this is also called "byte order mark" (BOM). Tell your editor
> > > not to create files with BOM.
> > >
> > > You can also fix in R:
> > >
> > > x <- readLines(..., encoding="UTF-8-BOM")
> > > writeLines(x, ......)
> >
> >
> >           In RStudio 2022.12.0+353 (the current version),
> >
> >
> > tools::showNonASCIIfile('
> > https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
> >
> >
> > returned "char(0)".  'readLines' and 'writeLines' as Uwe suggested
> > failed to fix it for me.
> >
> >
> >           The first problem I noticed with this was that RStudio could
> not
> > read
> > the NAMESPACE file.  When I tried, it said, "File is binary rather than
> > text so cannot be opened by the source editor."  I changed something
> > using a different editor and did "git commit" and "git push", and got
> > the error on GitHub that I reported above.  I copied the file elsewhere,
> > deleted it locally and from GitHub, then recreated it in LibreOffice by
> > manually typing the first and last lines then copying the rest from a
> > copy I had saved elsewhere.  The RStudio would open the file, but I
> > still get the same error message as above from both "R CMD build fda"
> > locally and from GitHub Action at:
> >
> >
> > https://github.com/JamesRamsay5/fda
> >
> >
> >           Other suggestions?
> >           Thanks,
> >           Spencer Graves
> >
> > >
> > > Best,
> > > Uwe Ligges
> > >
> > >
> > >
> > >
> > >
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jan 21 00:08:34 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 20 Jan 2023 18:08:34 -0500
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
 <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
Message-ID: <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>

On 20/01/2023 6:02 p.m., Greg Hunt wrote:
> xFEFF isn't a BOM in a UTF-8 file, its not anything.   The UTF-8 BOM is a
> different sequence of bits.  If tools treat it as a BOM, that is arguably a
> problem.

You're right.  FEFF is the UTF-16 big endian BOM.  UTF-16 is a 16 bit 
encoding, not at all the same as UTF-8.  I don't know how to read UTF-16 
in R. Uwe's advice was for UTF-8.

Duncan Murdoch

> 
> On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com> wrote:
> 
>> Setting the locale to "C" (or perhaps some other non-UTF-8 locale) will
>> show the BOM bytes.  E.g., on Windows I get:
>>
>>> Sys.getlocale()
>> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
>> States.utf8;LC_MONETARY=English_United
>> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
>>> tools::showNonASCIIfile('
>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>> rawToChar(readBin('
>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>> what="raw", n=20))
>> [1] "?export(AmpPhasDec"
>>> Sys.setlocale(locale="C")
>> [1] "C"
>>> tools::showNonASCIIfile('
>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>> 1: <ef><bb><bf>export(AmpPhasDecomp,
>>> rawToChar(readBin('
>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>> what="raw", n=20))
>> [1] "\357\273\277export(AmpPhasDec"
>>
>> -Bill
>>
>>
>> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
>> spencer.graves at effectivedefense.org> wrote:
>>
>>> Hi, Ivan and Uwe:
>>>
>>>
>>>            Thanks for your suggestions, but I've so far been unable to get
>>> them
>>> to work.  see below.
>>>
>>>
>>> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>>>
>>>>
>>>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>>>
>>>>>> ** byte-compile and prepare package for lazy loading
>>>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>>>      1:1: unexpected input
>>>>>
>>>>> tools::showNonASCIIfile('
>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>>>
>>>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>>>>> You'll need to remove it, e.g. by re-creating the first line.
>>>>
>>>>
>>>> Note that this is also called "byte order mark" (BOM). Tell your editor
>>>> not to create files with BOM.
>>>>
>>>> You can also fix in R:
>>>>
>>>> x <- readLines(..., encoding="UTF-8-BOM")
>>>> writeLines(x, ......)
>>>
>>>
>>>            In RStudio 2022.12.0+353 (the current version),
>>>
>>>
>>> tools::showNonASCIIfile('
>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>
>>>
>>> returned "char(0)".  'readLines' and 'writeLines' as Uwe suggested
>>> failed to fix it for me.
>>>
>>>
>>>            The first problem I noticed with this was that RStudio could
>> not
>>> read
>>> the NAMESPACE file.  When I tried, it said, "File is binary rather than
>>> text so cannot be opened by the source editor."  I changed something
>>> using a different editor and did "git commit" and "git push", and got
>>> the error on GitHub that I reported above.  I copied the file elsewhere,
>>> deleted it locally and from GitHub, then recreated it in LibreOffice by
>>> manually typing the first and last lines then copying the rest from a
>>> copy I had saved elsewhere.  The RStudio would open the file, but I
>>> still get the same error message as above from both "R CMD build fda"
>>> locally and from GitHub Action at:
>>>
>>>
>>> https://github.com/JamesRamsay5/fda
>>>
>>>
>>>            Other suggestions?
>>>            Thanks,
>>>            Spencer Graves
>>>
>>>>
>>>> Best,
>>>> Uwe Ligges
>>>>
>>>>
>>>>
>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sat Jan 21 02:16:58 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Fri, 20 Jan 2023 19:16:58 -0600
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
 <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
 <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>
Message-ID: <b80a813c-d02e-0f4f-d8f5-6671a39711c0@effectivedefense.org>

Hello, All:


	  My attempts to fix this problem exposed what seems to be a completely 
unrelated problem:  All five GitHub Actions end now with:


Error: package or namespace load failed for ?fda? in namespaceExport(ns, 
exports):
  undefined exports: refinery


	  The package includes ~man/refinery.Rd, ~data/refinery.rda, and 
NAMESPACE includes "export( ... refinery, ...)".


	  ???
	  I have Bitdefender installed on this computer.  A "Quick Scan" 
produced nothing just now.


	  Thanks,
	  Spencer


On 1/20/23 5:08 PM, Duncan Murdoch wrote:
> On 20/01/2023 6:02 p.m., Greg Hunt wrote:
>> xFEFF isn't a BOM in a UTF-8 file, its not anything.?? The UTF-8 BOM is a
>> different sequence of bits.? If tools treat it as a BOM, that is 
>> arguably a
>> problem.
> 
> You're right.? FEFF is the UTF-16 big endian BOM.? UTF-16 is a 16 bit 
> encoding, not at all the same as UTF-8.? I don't know how to read UTF-16 
> in R. Uwe's advice was for UTF-8.
> 
> Duncan Murdoch
> 
>>
>> On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com> 
>> wrote:
>>
>>> Setting the locale to "C" (or perhaps some other non-UTF-8 locale) will
>>> show the BOM bytes.? E.g., on Windows I get:
>>>
>>>> Sys.getlocale()
>>> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
>>> States.utf8;LC_MONETARY=English_United
>>> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
>>>> tools::showNonASCIIfile('
>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>> rawToChar(readBin('
>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>> what="raw", n=20))
>>> [1] "?export(AmpPhasDec"
>>>> Sys.setlocale(locale="C")
>>> [1] "C"
>>>> tools::showNonASCIIfile('
>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>> 1: <ef><bb><bf>export(AmpPhasDecomp,
>>>> rawToChar(readBin('
>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>> what="raw", n=20))
>>> [1] "\357\273\277export(AmpPhasDec"
>>>
>>> -Bill
>>>
>>>
>>> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
>>> spencer.graves at effectivedefense.org> wrote:
>>>
>>>> Hi, Ivan and Uwe:
>>>>
>>>>
>>>> ?????????? Thanks for your suggestions, but I've so far been unable 
>>>> to get
>>>> them
>>>> to work.? see below.
>>>>
>>>>
>>>> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>>>>
>>>>>
>>>>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>>>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>>>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>>>>
>>>>>>> ** byte-compile and prepare package for lazy loading
>>>>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>>>> ???? 1:1: unexpected input
>>>>>>
>>>>>> tools::showNonASCIIfile('
>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>>>>
>>>>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>>>>>> You'll need to remove it, e.g. by re-creating the first line.
>>>>>
>>>>>
>>>>> Note that this is also called "byte order mark" (BOM). Tell your 
>>>>> editor
>>>>> not to create files with BOM.
>>>>>
>>>>> You can also fix in R:
>>>>>
>>>>> x <- readLines(..., encoding="UTF-8-BOM")
>>>>> writeLines(x, ......)
>>>>
>>>>
>>>> ?????????? In RStudio 2022.12.0+353 (the current version),
>>>>
>>>>
>>>> tools::showNonASCIIfile('
>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>
>>>>
>>>> returned "char(0)".? 'readLines' and 'writeLines' as Uwe suggested
>>>> failed to fix it for me.
>>>>
>>>>
>>>> ?????????? The first problem I noticed with this was that RStudio could
>>> not
>>>> read
>>>> the NAMESPACE file.? When I tried, it said, "File is binary rather than
>>>> text so cannot be opened by the source editor."? I changed something
>>>> using a different editor and did "git commit" and "git push", and got
>>>> the error on GitHub that I reported above.? I copied the file 
>>>> elsewhere,
>>>> deleted it locally and from GitHub, then recreated it in LibreOffice by
>>>> manually typing the first and last lines then copying the rest from a
>>>> copy I had saved elsewhere.? The RStudio would open the file, but I
>>>> still get the same error message as above from both "R CMD build fda"
>>>> locally and from GitHub Action at:
>>>>
>>>>
>>>> https://github.com/JamesRamsay5/fda
>>>>
>>>>
>>>> ?????????? Other suggestions?
>>>> ?????????? Thanks,
>>>> ?????????? Spencer Graves
>>>>
>>>>>
>>>>> Best,
>>>>> Uwe Ligges
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>>> ???????? [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jan 21 02:32:45 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 20 Jan 2023 20:32:45 -0500
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <b80a813c-d02e-0f4f-d8f5-6671a39711c0@effectivedefense.org>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
 <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
 <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>
 <b80a813c-d02e-0f4f-d8f5-6671a39711c0@effectivedefense.org>
Message-ID: <5ee1615c-ad65-4985-8c39-55fd2be125de@gmail.com>

On 20/01/2023 8:16 p.m., Spencer Graves wrote:
> Hello, All:
> 
> 
> 	  My attempts to fix this problem exposed what seems to be a completely
> unrelated problem:  All five GitHub Actions end now with:
> 
> 
> Error: package or namespace load failed for ?fda? in namespaceExport(ns,
> exports):
>    undefined exports: refinery
> 
> 
> 	  The package includes ~man/refinery.Rd, ~data/refinery.rda, and
> NAMESPACE includes "export( ... refinery, ...)".


I think if you declare something as data by putting it in the data 
directory and using LazyData:true, you shouldn't also declare it as an 
export in the NAMESPACE file.

Duncan Murdoch

> 
> 
> 	  ???
> 	  I have Bitdefender installed on this computer.  A "Quick Scan"
> produced nothing just now.
> 
> 
> 	  Thanks,
> 	  Spencer
> 
> 
> On 1/20/23 5:08 PM, Duncan Murdoch wrote:
>> On 20/01/2023 6:02 p.m., Greg Hunt wrote:
>>> xFEFF isn't a BOM in a UTF-8 file, its not anything.?? The UTF-8 BOM is a
>>> different sequence of bits.? If tools treat it as a BOM, that is
>>> arguably a
>>> problem.
>>
>> You're right.? FEFF is the UTF-16 big endian BOM.? UTF-16 is a 16 bit
>> encoding, not at all the same as UTF-8.? I don't know how to read UTF-16
>> in R. Uwe's advice was for UTF-8.
>>
>> Duncan Murdoch
>>
>>>
>>> On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com>
>>> wrote:
>>>
>>>> Setting the locale to "C" (or perhaps some other non-UTF-8 locale) will
>>>> show the BOM bytes.? E.g., on Windows I get:
>>>>
>>>>> Sys.getlocale()
>>>> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
>>>> States.utf8;LC_MONETARY=English_United
>>>> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
>>>>> tools::showNonASCIIfile('
>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>> rawToChar(readBin('
>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>> what="raw", n=20))
>>>> [1] "?export(AmpPhasDec"
>>>>> Sys.setlocale(locale="C")
>>>> [1] "C"
>>>>> tools::showNonASCIIfile('
>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>> 1: <ef><bb><bf>export(AmpPhasDecomp,
>>>>> rawToChar(readBin('
>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>> what="raw", n=20))
>>>> [1] "\357\273\277export(AmpPhasDec"
>>>>
>>>> -Bill
>>>>
>>>>
>>>> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
>>>> spencer.graves at effectivedefense.org> wrote:
>>>>
>>>>> Hi, Ivan and Uwe:
>>>>>
>>>>>
>>>>>  ?????????? Thanks for your suggestions, but I've so far been unable
>>>>> to get
>>>>> them
>>>>> to work.? see below.
>>>>>
>>>>>
>>>>> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>>>>>
>>>>>>
>>>>>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>>>>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>>>>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>>>>>
>>>>>>>> ** byte-compile and prepare package for lazy loading
>>>>>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>>>>>  ???? 1:1: unexpected input
>>>>>>>
>>>>>>> tools::showNonASCIIfile('
>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>>>>>
>>>>>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>>>>>>> You'll need to remove it, e.g. by re-creating the first line.
>>>>>>
>>>>>>
>>>>>> Note that this is also called "byte order mark" (BOM). Tell your
>>>>>> editor
>>>>>> not to create files with BOM.
>>>>>>
>>>>>> You can also fix in R:
>>>>>>
>>>>>> x <- readLines(..., encoding="UTF-8-BOM")
>>>>>> writeLines(x, ......)
>>>>>
>>>>>
>>>>>  ?????????? In RStudio 2022.12.0+353 (the current version),
>>>>>
>>>>>
>>>>> tools::showNonASCIIfile('
>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>
>>>>>
>>>>> returned "char(0)".? 'readLines' and 'writeLines' as Uwe suggested
>>>>> failed to fix it for me.
>>>>>
>>>>>
>>>>>  ?????????? The first problem I noticed with this was that RStudio could
>>>> not
>>>>> read
>>>>> the NAMESPACE file.? When I tried, it said, "File is binary rather than
>>>>> text so cannot be opened by the source editor."? I changed something
>>>>> using a different editor and did "git commit" and "git push", and got
>>>>> the error on GitHub that I reported above.? I copied the file
>>>>> elsewhere,
>>>>> deleted it locally and from GitHub, then recreated it in LibreOffice by
>>>>> manually typing the first and last lines then copying the rest from a
>>>>> copy I had saved elsewhere.? The RStudio would open the file, but I
>>>>> still get the same error message as above from both "R CMD build fda"
>>>>> locally and from GitHub Action at:
>>>>>
>>>>>
>>>>> https://github.com/JamesRamsay5/fda
>>>>>
>>>>>
>>>>>  ?????????? Other suggestions?
>>>>>  ?????????? Thanks,
>>>>>  ?????????? Spencer Graves
>>>>>
>>>>>>
>>>>>> Best,
>>>>>> Uwe Ligges
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>
>>>>
>>>>  ???????? [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>>>  ????[[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sat Jan 21 03:47:34 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Fri, 20 Jan 2023 20:47:34 -0600
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <5ee1615c-ad65-4985-8c39-55fd2be125de@gmail.com>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
 <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
 <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>
 <b80a813c-d02e-0f4f-d8f5-6671a39711c0@effectivedefense.org>
 <5ee1615c-ad65-4985-8c39-55fd2be125de@gmail.com>
Message-ID: <21cf6c3c-07de-f0bf-8f80-c2cd5ab8f6b6@effectivedefense.org>



On 1/20/23 7:32 PM, Duncan Murdoch wrote:
> On 20/01/2023 8:16 p.m., Spencer Graves wrote:
>> Hello, All:
>>
>>
>> ????? My attempts to fix this problem exposed what seems to be a 
>> completely
>> unrelated problem:? All five GitHub Actions end now with:
>>
>>
>> Error: package or namespace load failed for ?fda? in namespaceExport(ns,
>> exports):
>> ?? undefined exports: refinery
>>
>>
>> ????? The package includes ~man/refinery.Rd, ~data/refinery.rda, and
>> NAMESPACE includes "export( ... refinery, ...)".
> 
> 
> I think if you declare something as data by putting it in the data 
> directory and using LazyData:true, you shouldn't also declare it as an 
> export in the NAMESPACE file.


	  I got the same negative results after deleting "LazyData: true" from 
DESCRIPTION.  (That's what I would expect, because there are 17 other 
*.rda files in the data subdirectory that are are mentioned in NAMESPACE 
and are not creating a problem.  In 2009 the package included both 
"data/refinery.rda" and "man/refinery.Rd".  They were erroneously 
removed at some point.  I'm now trying to restore them.)


	  Thanks,
	  Spencer

> 
> Duncan Murdoch
> 
>>
>>
>> ????? ???
>> ????? I have Bitdefender installed on this computer.? A "Quick Scan"
>> produced nothing just now.
>>
>>
>> ????? Thanks,
>> ????? Spencer
>>
>>
>> On 1/20/23 5:08 PM, Duncan Murdoch wrote:
>>> On 20/01/2023 6:02 p.m., Greg Hunt wrote:
>>>> xFEFF isn't a BOM in a UTF-8 file, its not anything.?? The UTF-8 BOM 
>>>> is a
>>>> different sequence of bits.? If tools treat it as a BOM, that is
>>>> arguably a
>>>> problem.
>>>
>>> You're right.? FEFF is the UTF-16 big endian BOM.? UTF-16 is a 16 bit
>>> encoding, not at all the same as UTF-8.? I don't know how to read UTF-16
>>> in R. Uwe's advice was for UTF-8.
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com>
>>>> wrote:
>>>>
>>>>> Setting the locale to "C" (or perhaps some other non-UTF-8 locale) 
>>>>> will
>>>>> show the BOM bytes.? E.g., on Windows I get:
>>>>>
>>>>>> Sys.getlocale()
>>>>> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
>>>>> States.utf8;LC_MONETARY=English_United
>>>>> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
>>>>>> tools::showNonASCIIfile('
>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>> rawToChar(readBin('
>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>>> what="raw", n=20))
>>>>> [1] "?export(AmpPhasDec"
>>>>>> Sys.setlocale(locale="C")
>>>>> [1] "C"
>>>>>> tools::showNonASCIIfile('
>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>> 1: <ef><bb><bf>export(AmpPhasDecomp,
>>>>>> rawToChar(readBin('
>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>>> what="raw", n=20))
>>>>> [1] "\357\273\277export(AmpPhasDec"
>>>>>
>>>>> -Bill
>>>>>
>>>>>
>>>>> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
>>>>> spencer.graves at effectivedefense.org> wrote:
>>>>>
>>>>>> Hi, Ivan and Uwe:
>>>>>>
>>>>>>
>>>>>> ??????????? Thanks for your suggestions, but I've so far been unable
>>>>>> to get
>>>>>> them
>>>>>> to work.? see below.
>>>>>>
>>>>>>
>>>>>> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>>>>>>
>>>>>>>
>>>>>>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>>>>>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>>>>>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>>>>>>
>>>>>>>>> ** byte-compile and prepare package for lazy loading
>>>>>>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>>>>>> ????? 1:1: unexpected input
>>>>>>>>
>>>>>>>> tools::showNonASCIIfile('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>>>>>>
>>>>>>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>>>>>>>> You'll need to remove it, e.g. by re-creating the first line.
>>>>>>>
>>>>>>>
>>>>>>> Note that this is also called "byte order mark" (BOM). Tell your
>>>>>>> editor
>>>>>>> not to create files with BOM.
>>>>>>>
>>>>>>> You can also fix in R:
>>>>>>>
>>>>>>> x <- readLines(..., encoding="UTF-8-BOM")
>>>>>>> writeLines(x, ......)
>>>>>>
>>>>>>
>>>>>> ??????????? In RStudio 2022.12.0+353 (the current version),
>>>>>>
>>>>>>
>>>>>> tools::showNonASCIIfile('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>
>>>>>>
>>>>>> returned "char(0)".? 'readLines' and 'writeLines' as Uwe suggested
>>>>>> failed to fix it for me.
>>>>>>
>>>>>>
>>>>>> ??????????? The first problem I noticed with this was that RStudio 
>>>>>> could
>>>>> not
>>>>>> read
>>>>>> the NAMESPACE file.? When I tried, it said, "File is binary rather 
>>>>>> than
>>>>>> text so cannot be opened by the source editor."? I changed something
>>>>>> using a different editor and did "git commit" and "git push", and got
>>>>>> the error on GitHub that I reported above.? I copied the file
>>>>>> elsewhere,
>>>>>> deleted it locally and from GitHub, then recreated it in 
>>>>>> LibreOffice by
>>>>>> manually typing the first and last lines then copying the rest from a
>>>>>> copy I had saved elsewhere.? The RStudio would open the file, but I
>>>>>> still get the same error message as above from both "R CMD build fda"
>>>>>> locally and from GitHub Action at:
>>>>>>
>>>>>>
>>>>>> https://github.com/JamesRamsay5/fda
>>>>>>
>>>>>>
>>>>>> ??????????? Other suggestions?
>>>>>> ??????????? Thanks,
>>>>>> ??????????? Spencer Graves
>>>>>>
>>>>>>>
>>>>>>> Best,
>>>>>>> Uwe Ligges
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>
>>>>> ????????? [[alternative HTML version deleted]]
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>
>>>>
>>>> ?????[[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sat Jan 21 08:47:35 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sat, 21 Jan 2023 08:47:35 +0100
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <21cf6c3c-07de-f0bf-8f80-c2cd5ab8f6b6@effectivedefense.org>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
 <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
 <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>
 <b80a813c-d02e-0f4f-d8f5-6671a39711c0@effectivedefense.org>
 <5ee1615c-ad65-4985-8c39-55fd2be125de@gmail.com>
 <21cf6c3c-07de-f0bf-8f80-c2cd5ab8f6b6@effectivedefense.org>
Message-ID: <d949af12-bb03-a0ac-8aa0-87f5880078f9@statistik.tu-dortmund.de>



On 21.01.2023 03:47, Spencer Graves wrote:
> 
> 
> On 1/20/23 7:32 PM, Duncan Murdoch wrote:
>> On 20/01/2023 8:16 p.m., Spencer Graves wrote:
>>> Hello, All:
>>>
>>>
>>> ????? My attempts to fix this problem exposed what seems to be a 
>>> completely
>>> unrelated problem:? All five GitHub Actions end now with:
>>>
>>>
>>> Error: package or namespace load failed for ?fda? in namespaceExport(ns,
>>> exports):
>>> ?? undefined exports: refinery
>>>
>>>
>>> ????? The package includes ~man/refinery.Rd, ~data/refinery.rda, and
>>> NAMESPACE includes "export( ... refinery, ...)".
>>
>>
>> I think if you declare something as data by putting it in the data 
>> directory and using LazyData:true, you shouldn't also declare it as an 
>> export in the NAMESPACE file.
> 
> 
>  ????? I got the same negative results after deleting "LazyData: true" 
> from DESCRIPTION.? (That's what I would expect, because there are 17 
> other *.rda files in the data subdirectory that are are mentioned in 
> NAMESPACE and are not creating a problem.? In 2009 the package included 
> both "data/refinery.rda" and "man/refinery.Rd".? They were erroneously 
> removed at some point.? I'm now trying to restore them.)

So you have declared LazyData: true?
How does the other package access the data object? By imprt directives?
Perhaps you exported the data in the past via the NAMSPACE file? But 
then it has to be in sysdata.rda?



Sorry for the confusion with the BOM.
The encoding sting for UTF-16  with byte order mark is "UTF-16BE".
I'd believe much more should have gone wrong then. Perhaps it was some 
editor that really messed it up?

Best,
Uwe Ligges



> 
>  ????? Thanks,
>  ????? Spencer
> 
>>
>> Duncan Murdoch
>>
>>>
>>>
>>> ????? ???
>>> ????? I have Bitdefender installed on this computer.? A "Quick Scan"
>>> produced nothing just now.
>>>
>>>
>>> ????? Thanks,
>>> ????? Spencer
>>>
>>>
>>> On 1/20/23 5:08 PM, Duncan Murdoch wrote:
>>>> On 20/01/2023 6:02 p.m., Greg Hunt wrote:
>>>>> xFEFF isn't a BOM in a UTF-8 file, its not anything.?? The UTF-8 
>>>>> BOM is a
>>>>> different sequence of bits.? If tools treat it as a BOM, that is
>>>>> arguably a
>>>>> problem.
>>>>
>>>> You're right.? FEFF is the UTF-16 big endian BOM.? UTF-16 is a 16 bit
>>>> encoding, not at all the same as UTF-8.? I don't know how to read 
>>>> UTF-16
>>>> in R. Uwe's advice was for UTF-8.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com>
>>>>> wrote:
>>>>>
>>>>>> Setting the locale to "C" (or perhaps some other non-UTF-8 locale) 
>>>>>> will
>>>>>> show the BOM bytes.? E.g., on Windows I get:
>>>>>>
>>>>>>> Sys.getlocale()
>>>>>> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
>>>>>> States.utf8;LC_MONETARY=English_United
>>>>>> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
>>>>>>> tools::showNonASCIIfile('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>> rawToChar(readBin('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>>>> what="raw", n=20))
>>>>>> [1] "?export(AmpPhasDec"
>>>>>>> Sys.setlocale(locale="C")
>>>>>> [1] "C"
>>>>>>> tools::showNonASCIIfile('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>> 1: <ef><bb><bf>export(AmpPhasDecomp,
>>>>>>> rawToChar(readBin('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>>>> what="raw", n=20))
>>>>>> [1] "\357\273\277export(AmpPhasDec"
>>>>>>
>>>>>> -Bill
>>>>>>
>>>>>>
>>>>>> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
>>>>>> spencer.graves at effectivedefense.org> wrote:
>>>>>>
>>>>>>> Hi, Ivan and Uwe:
>>>>>>>
>>>>>>>
>>>>>>> ??????????? Thanks for your suggestions, but I've so far been unable
>>>>>>> to get
>>>>>>> them
>>>>>>> to work.? see below.
>>>>>>>
>>>>>>>
>>>>>>> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>>>>>>>
>>>>>>>>
>>>>>>>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>>>>>>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>>>>>>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>>>>>>>
>>>>>>>>>> ** byte-compile and prepare package for lazy loading
>>>>>>>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>>>>>>> ????? 1:1: unexpected input
>>>>>>>>>
>>>>>>>>> tools::showNonASCIIfile('
>>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>>>>>>>
>>>>>>>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK 
>>>>>>>>> SPACE.
>>>>>>>>> You'll need to remove it, e.g. by re-creating the first line.
>>>>>>>>
>>>>>>>>
>>>>>>>> Note that this is also called "byte order mark" (BOM). Tell your
>>>>>>>> editor
>>>>>>>> not to create files with BOM.
>>>>>>>>
>>>>>>>> You can also fix in R:
>>>>>>>>
>>>>>>>> x <- readLines(..., encoding="UTF-8-BOM")
>>>>>>>> writeLines(x, ......)
>>>>>>>
>>>>>>>
>>>>>>> ??????????? In RStudio 2022.12.0+353 (the current version),
>>>>>>>
>>>>>>>
>>>>>>> tools::showNonASCIIfile('
>>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>>
>>>>>>>
>>>>>>> returned "char(0)".? 'readLines' and 'writeLines' as Uwe suggested
>>>>>>> failed to fix it for me.
>>>>>>>
>>>>>>>
>>>>>>> ??????????? The first problem I noticed with this was that 
>>>>>>> RStudio could
>>>>>> not
>>>>>>> read
>>>>>>> the NAMESPACE file.? When I tried, it said, "File is binary 
>>>>>>> rather than
>>>>>>> text so cannot be opened by the source editor."? I changed something
>>>>>>> using a different editor and did "git commit" and "git push", and 
>>>>>>> got
>>>>>>> the error on GitHub that I reported above.? I copied the file
>>>>>>> elsewhere,
>>>>>>> deleted it locally and from GitHub, then recreated it in 
>>>>>>> LibreOffice by
>>>>>>> manually typing the first and last lines then copying the rest 
>>>>>>> from a
>>>>>>> copy I had saved elsewhere.? The RStudio would open the file, but I
>>>>>>> still get the same error message as above from both "R CMD build 
>>>>>>> fda"
>>>>>>> locally and from GitHub Action at:
>>>>>>>
>>>>>>>
>>>>>>> https://github.com/JamesRamsay5/fda
>>>>>>>
>>>>>>>
>>>>>>> ??????????? Other suggestions?
>>>>>>> ??????????? Thanks,
>>>>>>> ??????????? Spencer Graves
>>>>>>>
>>>>>>>>
>>>>>>>> Best,
>>>>>>>> Uwe Ligges
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>>
>>>>>>
>>>>>> ????????? [[alternative HTML version deleted]]
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>
>>>>> ?????[[alternative HTML version deleted]]
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From hhoe|||n @end|ng |rom gm@||@com  Sat Jan 21 11:15:40 2023
From: hhoe|||n @end|ng |rom gm@||@com (Holger Hoefling)
Date: Sat, 21 Jan 2023 11:15:40 +0100
Subject: [R-pkg-devel] replacements of sprintf in compiled code
Message-ID: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>

Hi,

In my recent re-submission with a bug-fix of the hdf5r package, I got a new
set of warnings from the compiler, one being that I shouldn't be using
'sprintf'.

Is there a simple replacement that I can use?

Thanks

Holger Hoefling

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jan 21 11:27:03 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 21 Jan 2023 05:27:03 -0500
Subject: [R-pkg-devel] replacements of sprintf in compiled code
In-Reply-To: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
References: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
Message-ID: <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>

On 21/01/2023 5:15 a.m., Holger Hoefling wrote:
> Hi,
> 
> In my recent re-submission with a bug-fix of the hdf5r package, I got a new
> set of warnings from the compiler, one being that I shouldn't be using
> 'sprintf'.
> 
> Is there a simple replacement that I can use?

You should use snprintf() which has an extra argument to state the size 
of the buffer receiving the string.  For example,

  char text[32];
  sprintf(text, "%.4g", value);

could be written as

  char text[32];
  snprintf(text, 32, "%.4g", value);

This will write a string with at most 31 characters before the NUL at 
the end, and avoids the possibility of a buffer overrun.

Duncan Murdoch


From hhoe|||n @end|ng |rom gm@||@com  Sat Jan 21 11:33:22 2023
From: hhoe|||n @end|ng |rom gm@||@com (Holger Hoefling)
Date: Sat, 21 Jan 2023 11:33:22 +0100
Subject: [R-pkg-devel] replacements of sprintf in compiled code
In-Reply-To: <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
References: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
 <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
Message-ID: <CAFDswJuzj3PLPwO+3+4ocA--2KaOZ6iKzTmfLcVu_uxiVGuB9Q@mail.gmail.com>

Hi,

thanks for the tip! Is that available everywhere or do I need to set
compiler requirements?

Best

Holger Hoefling

On Sat, Jan 21, 2023 at 11:27 AM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 21/01/2023 5:15 a.m., Holger Hoefling wrote:
> > Hi,
> >
> > In my recent re-submission with a bug-fix of the hdf5r package, I got a
> new
> > set of warnings from the compiler, one being that I shouldn't be using
> > 'sprintf'.
> >
> > Is there a simple replacement that I can use?
>
> You should use snprintf() which has an extra argument to state the size
> of the buffer receiving the string.  For example,
>
>   char text[32];
>   sprintf(text, "%.4g", value);
>
> could be written as
>
>   char text[32];
>   snprintf(text, 32, "%.4g", value);
>
> This will write a string with at most 31 characters before the NUL at
> the end, and avoids the possibility of a buffer overrun.
>
> Duncan Murdoch
>

	[[alternative HTML version deleted]]


From m@tth|@@-gond@n @end|ng |rom gmx@de  Sat Jan 21 11:46:52 2023
From: m@tth|@@-gond@n @end|ng |rom gmx@de (Matthias Gondan)
Date: Sat, 21 Jan 2023 11:46:52 +0100
Subject: [R-pkg-devel] replacements of sprintf in compiled code
In-Reply-To: <CAFDswJuzj3PLPwO+3+4ocA--2KaOZ6iKzTmfLcVu_uxiVGuB9Q@mail.gmail.com>
References: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
 <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
 <CAFDswJuzj3PLPwO+3+4ocA--2KaOZ6iKzTmfLcVu_uxiVGuB9Q@mail.gmail.com>
Message-ID: <1MeU0k-1okx2X02tg-00aYUo@mail.gmx.net>

I think the function is more than 20 years old

https://en.cppreference.com/w/c/io/fprintf



Von: Holger Hoefling
Gesendet: Samstag, 21. Januar 2023 11:37
An: Duncan Murdoch
Cc: R Package Development
Betreff: Re: [R-pkg-devel] replacements of sprintf in compiled code

Hi,

thanks for the tip! Is that available everywhere or do I need to set
compiler requirements?

Best

Holger Hoefling

On Sat, Jan 21, 2023 at 11:27 AM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 21/01/2023 5:15 a.m., Holger Hoefling wrote:
> > Hi,
> >
> > In my recent re-submission with a bug-fix of the hdf5r package, I got a
> new
> > set of warnings from the compiler, one being that I shouldn't be using
> > 'sprintf'.
> >
> > Is there a simple replacement that I can use?
>
> You should use snprintf() which has an extra argument to state the size
> of the buffer receiving the string.  For example,
>
>   char text[32];
>   sprintf(text, "%.4g", value);
>
> could be written as
>
>   char text[32];
>   snprintf(text, 32, "%.4g", value);
>
> This will write a string with at most 31 characters before the NUL at
> the end, and avoids the possibility of a buffer overrun.
>
> Duncan Murdoch
>

	[[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jan 21 11:47:02 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 21 Jan 2023 05:47:02 -0500
Subject: [R-pkg-devel] replacements of sprintf in compiled code
In-Reply-To: <CAFDswJuzj3PLPwO+3+4ocA--2KaOZ6iKzTmfLcVu_uxiVGuB9Q@mail.gmail.com>
References: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
 <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
 <CAFDswJuzj3PLPwO+3+4ocA--2KaOZ6iKzTmfLcVu_uxiVGuB9Q@mail.gmail.com>
Message-ID: <4db9b982-42d7-ccb1-580b-d37f44f45f1d@gmail.com>

On 21/01/2023 5:33 a.m., Holger Hoefling wrote:
> Hi,
> 
> thanks for the tip! Is that available everywhere or do I need to set 
> compiler requirements?

You shouldn't need any special requirements.  I think this was 
standardized in C99, which is supported by default in R.  Not sure which 
C++ version adopted it, but it's available there too.

Duncan Murdoch

> 
> Best
> 
> Holger Hoefling
> 
> On Sat, Jan 21, 2023 at 11:27 AM Duncan Murdoch 
> <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>> wrote:
> 
>     On 21/01/2023 5:15 a.m., Holger Hoefling wrote:
>      > Hi,
>      >
>      > In my recent re-submission with a bug-fix of the hdf5r package, I
>     got a new
>      > set of warnings from the compiler, one being that I shouldn't be
>     using
>      > 'sprintf'.
>      >
>      > Is there a simple replacement that I can use?
> 
>     You should use snprintf() which has an extra argument to state the size
>     of the buffer receiving the string.? For example,
> 
>      ? char text[32];
>      ? sprintf(text, "%.4g", value);
> 
>     could be written as
> 
>      ? char text[32];
>      ? snprintf(text, 32, "%.4g", value);
> 
>     This will write a string with at most 31 characters before the NUL at
>     the end, and avoids the possibility of a buffer overrun.
> 
>     Duncan Murdoch
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jan 21 14:28:29 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 21 Jan 2023 08:28:29 -0500
Subject: [R-pkg-devel] corrupted NAMESPACE file
In-Reply-To: <21cf6c3c-07de-f0bf-8f80-c2cd5ab8f6b6@effectivedefense.org>
References: <992486ed-6a0c-4b12-f306-1a18cb573d4e@effectivedefense.org>
 <20230120175356.5d529f5e@arachnoid>
 <d056790f-4d02-2e62-ba07-231ed597479e@statistik.tu-dortmund.de>
 <776c66ca-e417-946b-0ce7-a84c327351d3@effectivedefense.org>
 <CAHqSRuScBCQPZq9jEw+zWHibQE8yXbbExoENxUzB+LrABz006w@mail.gmail.com>
 <CAAS8PAL17HH74yNxGGfrsgJT6ND+T2CvGHQtS=K8EK91EiiThA@mail.gmail.com>
 <ed1093ac-d50a-8f64-c48b-a3e4b02df0ea@gmail.com>
 <b80a813c-d02e-0f4f-d8f5-6671a39711c0@effectivedefense.org>
 <5ee1615c-ad65-4985-8c39-55fd2be125de@gmail.com>
 <21cf6c3c-07de-f0bf-8f80-c2cd5ab8f6b6@effectivedefense.org>
Message-ID: <13ba278a-1b46-a7c4-c27b-d9f9b17f6665@gmail.com>

On 20/01/2023 9:47 p.m., Spencer Graves wrote:
> 
> 
> On 1/20/23 7:32 PM, Duncan Murdoch wrote:
>> On 20/01/2023 8:16 p.m., Spencer Graves wrote:
>>> Hello, All:
>>>
>>>
>>>  ????? My attempts to fix this problem exposed what seems to be a
>>> completely
>>> unrelated problem:? All five GitHub Actions end now with:
>>>
>>>
>>> Error: package or namespace load failed for ?fda? in namespaceExport(ns,
>>> exports):
>>>  ?? undefined exports: refinery
>>>
>>>
>>>  ????? The package includes ~man/refinery.Rd, ~data/refinery.rda, and
>>> NAMESPACE includes "export( ... refinery, ...)".
>>
>>
>> I think if you declare something as data by putting it in the data
>> directory and using LazyData:true, you shouldn't also declare it as an
>> export in the NAMESPACE file.
> 
> 
> 	  I got the same negative results after deleting "LazyData: true" from
> DESCRIPTION.  (That's what I would expect, because there are 17 other
> *.rda files in the data subdirectory that are are mentioned in NAMESPACE
> and are not creating a problem.  In 2009 the package included both
> "data/refinery.rda" and "man/refinery.Rd".  They were erroneously
> removed at some point.  I'm now trying to restore them.)

I just cloned the repository, and saw the same error as you saw.  Then I 
followed my advice, and removed `refinery` from the NAMESPACE file, and 
the error went away.

Since you don't have `LazyData: true` in the current version, you need 
to run `data(refinery)` to make that dataset available.  That does work.

I also tried restoring `LazyData:true` as well as removing `refinery` 
from NAMESPACE, and that works too, without the need to call 
`data(refinery)`.  The variable is just available.

I'm not sure which *.rda files you are talking about that "are mentioned 
in NAMESPACE".  Now that I've removed `refinery` in my copy, I don't see 
any of them.

Duncan Murdoch

> 
> 
> 	  Thanks,
> 	  Spencer
> 
>>
>> Duncan Murdoch
>>
>>>
>>>
>>>  ????? ???
>>>  ????? I have Bitdefender installed on this computer.? A "Quick Scan"
>>> produced nothing just now.
>>>
>>>
>>>  ????? Thanks,
>>>  ????? Spencer
>>>
>>>
>>> On 1/20/23 5:08 PM, Duncan Murdoch wrote:
>>>> On 20/01/2023 6:02 p.m., Greg Hunt wrote:
>>>>> xFEFF isn't a BOM in a UTF-8 file, its not anything.?? The UTF-8 BOM
>>>>> is a
>>>>> different sequence of bits.? If tools treat it as a BOM, that is
>>>>> arguably a
>>>>> problem.
>>>>
>>>> You're right.? FEFF is the UTF-16 big endian BOM.? UTF-16 is a 16 bit
>>>> encoding, not at all the same as UTF-8.? I don't know how to read UTF-16
>>>> in R. Uwe's advice was for UTF-8.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> On Sat, 21 Jan 2023 at 05:09, Bill Dunlap <williamwdunlap at gmail.com>
>>>>> wrote:
>>>>>
>>>>>> Setting the locale to "C" (or perhaps some other non-UTF-8 locale)
>>>>>> will
>>>>>> show the BOM bytes.? E.g., on Windows I get:
>>>>>>
>>>>>>> Sys.getlocale()
>>>>>> [1] "LC_COLLATE=English_United States.utf8;LC_CTYPE=English_United
>>>>>> States.utf8;LC_MONETARY=English_United
>>>>>> States.utf8;LC_NUMERIC=C;LC_TIME=English_United States.utf8"
>>>>>>> tools::showNonASCIIfile('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>> rawToChar(readBin('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>>>> what="raw", n=20))
>>>>>> [1] "?export(AmpPhasDec"
>>>>>>> Sys.setlocale(locale="C")
>>>>>> [1] "C"
>>>>>>> tools::showNonASCIIfile('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>> 1: <ef><bb><bf>export(AmpPhasDecomp,
>>>>>>> rawToChar(readBin('
>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE',
>>>>>> what="raw", n=20))
>>>>>> [1] "\357\273\277export(AmpPhasDec"
>>>>>>
>>>>>> -Bill
>>>>>>
>>>>>>
>>>>>> On Fri, Jan 20, 2023 at 9:16 AM Spencer Graves <
>>>>>> spencer.graves at effectivedefense.org> wrote:
>>>>>>
>>>>>>> Hi, Ivan and Uwe:
>>>>>>>
>>>>>>>
>>>>>>>  ??????????? Thanks for your suggestions, but I've so far been unable
>>>>>>> to get
>>>>>>> them
>>>>>>> to work.? see below.
>>>>>>>
>>>>>>>
>>>>>>> On 1/20/23 9:22 AM, Uwe Ligges wrote:
>>>>>>>>
>>>>>>>>
>>>>>>>> On 20.01.2023 15:53, Ivan Krylov wrote:
>>>>>>>>> ? Fri, 20 Jan 2023 08:41:25 -0600
>>>>>>>>> Spencer Graves <spencer.graves at effectivedefense.org> ?????:
>>>>>>>>>
>>>>>>>>>> ** byte-compile and prepare package for lazy loading
>>>>>>>>>> Error in parse(nsFile, keep.source = FALSE, srcfile = NULL) :
>>>>>>>>>>  ????? 1:1: unexpected input
>>>>>>>>>
>>>>>>>>> tools::showNonASCIIfile('
>>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>>>> # 1: <ef><bb><bf>export(AmpPhaseDecomp,
>>>>>>>>>
>>>>>>>>> Your NAMESPACE file starts with a U+FEFF ZERO WIDTH NO-BREAK SPACE.
>>>>>>>>> You'll need to remove it, e.g. by re-creating the first line.
>>>>>>>>
>>>>>>>>
>>>>>>>> Note that this is also called "byte order mark" (BOM). Tell your
>>>>>>>> editor
>>>>>>>> not to create files with BOM.
>>>>>>>>
>>>>>>>> You can also fix in R:
>>>>>>>>
>>>>>>>> x <- readLines(..., encoding="UTF-8-BOM")
>>>>>>>> writeLines(x, ......)
>>>>>>>
>>>>>>>
>>>>>>>  ??????????? In RStudio 2022.12.0+353 (the current version),
>>>>>>>
>>>>>>>
>>>>>>> tools::showNonASCIIfile('
>>>>>>> https://raw.githubusercontent.com/JamesRamsay5/fda/master/NAMESPACE')
>>>>>>>
>>>>>>>
>>>>>>> returned "char(0)".? 'readLines' and 'writeLines' as Uwe suggested
>>>>>>> failed to fix it for me.
>>>>>>>
>>>>>>>
>>>>>>>  ??????????? The first problem I noticed with this was that RStudio
>>>>>>> could
>>>>>> not
>>>>>>> read
>>>>>>> the NAMESPACE file.? When I tried, it said, "File is binary rather
>>>>>>> than
>>>>>>> text so cannot be opened by the source editor."? I changed something
>>>>>>> using a different editor and did "git commit" and "git push", and got
>>>>>>> the error on GitHub that I reported above.? I copied the file
>>>>>>> elsewhere,
>>>>>>> deleted it locally and from GitHub, then recreated it in
>>>>>>> LibreOffice by
>>>>>>> manually typing the first and last lines then copying the rest from a
>>>>>>> copy I had saved elsewhere.? The RStudio would open the file, but I
>>>>>>> still get the same error message as above from both "R CMD build fda"
>>>>>>> locally and from GitHub Action at:
>>>>>>>
>>>>>>>
>>>>>>> https://github.com/JamesRamsay5/fda
>>>>>>>
>>>>>>>
>>>>>>>  ??????????? Other suggestions?
>>>>>>>  ??????????? Thanks,
>>>>>>>  ??????????? Spencer Graves
>>>>>>>
>>>>>>>>
>>>>>>>> Best,
>>>>>>>> Uwe Ligges
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>>
>>>>>>
>>>>>>  ????????? [[alternative HTML version deleted]]
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>
>>>>>  ?????[[alternative HTML version deleted]]
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>


From w||||@mwdun|@p @end|ng |rom gm@||@com  Sat Jan 21 16:52:48 2023
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Sat, 21 Jan 2023 07:52:48 -0800
Subject: [R-pkg-devel] replacements of sprintf in compiled code
In-Reply-To: <4db9b982-42d7-ccb1-580b-d37f44f45f1d@gmail.com>
References: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
 <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
 <CAFDswJuzj3PLPwO+3+4ocA--2KaOZ6iKzTmfLcVu_uxiVGuB9Q@mail.gmail.com>
 <4db9b982-42d7-ccb1-580b-d37f44f45f1d@gmail.com>
Message-ID: <CAHqSRuS1nkvvzmxqUQUELef0c+_7LCBm8QCqd-Jdfcjk9Ey-BQ@mail.gmail.com>

Even Microsoft added snprintf to Visual C++ in 2015 (not that that matters
for R).

-Bill

On Sat, Jan 21, 2023 at 2:47 AM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 21/01/2023 5:33 a.m., Holger Hoefling wrote:
> > Hi,
> >
> > thanks for the tip! Is that available everywhere or do I need to set
> > compiler requirements?
>
> You shouldn't need any special requirements.  I think this was
> standardized in C99, which is supported by default in R.  Not sure which
> C++ version adopted it, but it's available there too.
>
> Duncan Murdoch
>
> >
> > Best
> >
> > Holger Hoefling
> >
> > On Sat, Jan 21, 2023 at 11:27 AM Duncan Murdoch
> > <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>> wrote:
> >
> >     On 21/01/2023 5:15 a.m., Holger Hoefling wrote:
> >      > Hi,
> >      >
> >      > In my recent re-submission with a bug-fix of the hdf5r package, I
> >     got a new
> >      > set of warnings from the compiler, one being that I shouldn't be
> >     using
> >      > 'sprintf'.
> >      >
> >      > Is there a simple replacement that I can use?
> >
> >     You should use snprintf() which has an extra argument to state the
> size
> >     of the buffer receiving the string.  For example,
> >
> >        char text[32];
> >        sprintf(text, "%.4g", value);
> >
> >     could be written as
> >
> >        char text[32];
> >        snprintf(text, 32, "%.4g", value);
> >
> >     This will write a string with at most 31 characters before the NUL at
> >     the end, and avoids the possibility of a buffer overrun.
> >
> >     Duncan Murdoch
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Sat Jan 21 17:13:54 2023
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sat, 21 Jan 2023 10:13:54 -0600
Subject: [R-pkg-devel] replacements of sprintf in compiled code
In-Reply-To: <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
References: <CAFDswJvzbtDy8v0xdNZd+KOH-r_4hUFQupuHxbLTScobw2vmpg@mail.gmail.com>
 <eb689815-31b5-63d1-e832-0183f01fb25e@gmail.com>
Message-ID: <25548.3906.870374.764431@rob.eddelbuettel.com>


On 21 January 2023 at 05:27, Duncan Murdoch wrote:
| On 21/01/2023 5:15 a.m., Holger Hoefling wrote:
| > Is there a simple replacement that I can use?
| 
| You should use snprintf() which has an extra argument to state the size 
| of the buffer receiving the string.  For example,
| 
|   char text[32];
|   sprintf(text, "%.4g", value);
| 
| could be written as
| 
|   char text[32];
|   snprintf(text, 32, "%.4g", value);
| 
| This will write a string with at most 31 characters before the NUL at 
| the end, and avoids the possibility of a buffer overrun.

And even better idiom (which I only came to too late for the update of a few
of my packages) is to rely on sizeof() as in

    char text[32];
    snprintf(text, sizeof(text), "%.4g", value);

which works for many / most simple cases of such static buffers.

Sometimes this sprintf compiler 'noise' is shrapnel from other packages we
include as headers, and harder to fix.  Brian Ripley kindly alerted us to one
remaining instance in the Rcpp headers which we fixed in October; the updated
package is currently awaiting its fate during its bi-annual update cycle but
is held in the dark and deep bowels of CRAN awaiting inspection (nine days
and counting now) as is package BH which in its annual update got a number of
headers refreshed from its upstream, plus an extra round of polish from
me. It too is available as an update in its git repo, and otherwise hiding in
those dark CRAN bowels.  I keep telling myself I should remain hopeful that
maybe one day we get to take advantage of it. Hopefully soon.

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From k|@u@@@ch||ep @end|ng |rom gm@||@com  Sun Jan 22 19:51:30 2023
From: k|@u@@@ch||ep @end|ng |rom gm@||@com (Klaus Schliep)
Date: Sun, 22 Jan 2023 19:51:30 +0100
Subject: [R-pkg-devel] Pretest failed and I fail to find out what's the
 problem
Message-ID: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>

 Dear all,

I try to submit a new version of the package phangorn and got the mail back:

"Dear maintainer,

package phangorn_2.11.0.tar.gz does not pass the incoming checks
automatically, please see the following pre-tests:
Windows: <
https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Windows/00check.log
>
Status: OK
Debian: <
https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Debian/00check.log
>
Status: OK"

I am kind of puzzled as to what the problem is, but it might well be that I
missed something? I appreciate any suggestions.

Kind regards,
Klaus Schliep


-- 
Klaus Schliep

Senior Scientist
Institute of Molecular Biotechnology
TU Graz

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Sun Jan 22 19:55:21 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 22 Jan 2023 13:55:21 -0500
Subject: [R-pkg-devel] Pretest failed and I fail to find out what's the
 problem
In-Reply-To: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
References: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
Message-ID: <04a1a0cb-9020-e643-1f73-2de0cc9c108f@gmail.com>

   Seems pretty mysterious to me! (No cryptic NOTEs anywhere in the 
logs, other than the inevitable "Note_to_CRAN_maintainers")

   I will be curious to see if anyone else finds something, but my guess 
is a hiccup on the CRAN end (i.e., you'll end up sending e-mail to the 
CRAN maintainers to clarify what's going on)


On 2023-01-22 1:51 p.m., Klaus Schliep wrote:
>   Dear all,
> 
> I try to submit a new version of the package phangorn and got the mail back:
> 
> "Dear maintainer,
> 
> package phangorn_2.11.0.tar.gz does not pass the incoming checks
> automatically, please see the following pre-tests:
> Windows: <
> https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Windows/00check.log
>>
> Status: OK
> Debian: <
> https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Debian/00check.log
>>
> Status: OK"
> 
> I am kind of puzzled as to what the problem is, but it might well be that I
> missed something? I appreciate any suggestions.
> 
> Kind regards,
> Klaus Schliep
> 
> 

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Jan 22 20:11:43 2023
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sun, 22 Jan 2023 11:11:43 -0800
Subject: [R-pkg-devel] Pretest failed and I fail to find out what's the
 problem
In-Reply-To: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
References: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
Message-ID: <0A19FD5F-E1EE-4E94-9DEC-234DDDDB1522@dcn.davis.ca.us>

Long build time for vignettes?

On January 22, 2023 10:51:30 AM PST, Klaus Schliep <klaus.schliep at gmail.com> wrote:
> Dear all,
>
>I try to submit a new version of the package phangorn and got the mail back:
>
>"Dear maintainer,
>
>package phangorn_2.11.0.tar.gz does not pass the incoming checks
>automatically, please see the following pre-tests:
>Windows: <
>https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Windows/00check.log
>>
>Status: OK
>Debian: <
>https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Debian/00check.log
>>
>Status: OK"
>
>I am kind of puzzled as to what the problem is, but it might well be that I
>missed something? I appreciate any suggestions.
>
>Kind regards,
>Klaus Schliep
>
>

-- 
Sent from my phone. Please excuse my brevity.


From kry|ov@r00t @end|ng |rom gm@||@com  Sun Jan 22 20:15:05 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sun, 22 Jan 2023 22:15:05 +0300
Subject: [R-pkg-devel] Pretest failed and I fail to find out what's the
 problem
In-Reply-To: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
References: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
Message-ID: <20230122221505.746b4db3@Tarkus>

On Sun, 22 Jan 2023 19:51:30 +0100
Klaus Schliep <klaus.schliep at gmail.com> wrote:

> package phangorn_2.11.0.tar.gz does not pass the incoming checks
> automatically, please see the following pre-tests:

Is this the whole e-mail? There may be a list of problems at the end of
the message, right after the signature ("Best regards, CRAN teams'
auto-check service"). It may be about the time your vignette took to
build on Windows, but I'm not sure about that.

-- 
Best regards,
Ivan


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sun Jan 22 21:43:05 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sun, 22 Jan 2023 21:43:05 +0100
Subject: [R-pkg-devel] Pretest failed and I fail to find out what's the
 problem
In-Reply-To: <04a1a0cb-9020-e643-1f73-2de0cc9c108f@gmail.com>
References: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
 <04a1a0cb-9020-e643-1f73-2de0cc9c108f@gmail.com>
Message-ID: <aa09fe26-93f9-1881-2c1e-11fbe6127a56@statistik.tu-dortmund.de>

Indeed,


* checking re-building of vignette outputs ... [13m] OK

Please reduce the vignette build timings by using
  - small toy data only
  - few iterations
  - or by providing precomputed results for the most lengthy parts. 
Otherwise we cannot afford checking the vignette regularly on CRAN.

Best,
Uwe Ligges


On 22.01.2023 19:55, Ben Bolker wrote:
>  ? Seems pretty mysterious to me! (No cryptic NOTEs anywhere in the 
> logs, other than the inevitable "Note_to_CRAN_maintainers")
> 
>  ? I will be curious to see if anyone else finds something, but my guess 
> is a hiccup on the CRAN end (i.e., you'll end up sending e-mail to the 
> CRAN maintainers to clarify what's going on)
> 
> 
> On 2023-01-22 1:51 p.m., Klaus Schliep wrote:
>> ? Dear all,
>>
>> I try to submit a new version of the package phangorn and got the mail 
>> back:
>>
>> "Dear maintainer,
>>
>> package phangorn_2.11.0.tar.gz does not pass the incoming checks
>> automatically, please see the following pre-tests:
>> Windows: <
>> https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Windows/00check.log
>>>
>> Status: OK
>> Debian: <
>> https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Debian/00check.log
>>>
>> Status: OK"
>>
>> I am kind of puzzled as to what the problem is, but it might well be 
>> that I
>> missed something? I appreciate any suggestions.
>>
>> Kind regards,
>> Klaus Schliep
>>
>>
>


From k|@u@@@ch||ep @end|ng |rom gm@||@com  Sun Jan 22 21:47:02 2023
From: k|@u@@@ch||ep @end|ng |rom gm@||@com (Klaus Schliep)
Date: Sun, 22 Jan 2023 21:47:02 +0100
Subject: [R-pkg-devel] Pretest failed and I fail to find out what's the
 problem
In-Reply-To: <aa09fe26-93f9-1881-2c1e-11fbe6127a56@statistik.tu-dortmund.de>
References: <CAKB+p3WNrFzr5e4ODjDUix=LU5qy=qTw=Gid68RYgecQyw+thg@mail.gmail.com>
 <04a1a0cb-9020-e643-1f73-2de0cc9c108f@gmail.com>
 <aa09fe26-93f9-1881-2c1e-11fbe6127a56@statistik.tu-dortmund.de>
Message-ID: <CAKB+p3WzkyD1SXhkvTc0tHipdjMtGiQ0ti9OjGD7CxhP4N6KCg@mail.gmail.com>

Thanks a lot!
Kind regards,
Klaus Schliep

On Sun, Jan 22, 2023 at 9:43 PM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

> Indeed,
>
>
> * checking re-building of vignette outputs ... [13m] OK
>
> Please reduce the vignette build timings by using
>   - small toy data only
>   - few iterations
>   - or by providing precomputed results for the most lengthy parts.
> Otherwise we cannot afford checking the vignette regularly on CRAN.
>
> Best,
> Uwe Ligges
>
>
> On 22.01.2023 19:55, Ben Bolker wrote:
> >    Seems pretty mysterious to me! (No cryptic NOTEs anywhere in the
> > logs, other than the inevitable "Note_to_CRAN_maintainers")
> >
> >    I will be curious to see if anyone else finds something, but my guess
> > is a hiccup on the CRAN end (i.e., you'll end up sending e-mail to the
> > CRAN maintainers to clarify what's going on)
> >
> >
> > On 2023-01-22 1:51 p.m., Klaus Schliep wrote:
> >>   Dear all,
> >>
> >> I try to submit a new version of the package phangorn and got the mail
> >> back:
> >>
> >> "Dear maintainer,
> >>
> >> package phangorn_2.11.0.tar.gz does not pass the incoming checks
> >> automatically, please see the following pre-tests:
> >> Windows: <
> >>
> https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Windows/00check.log
> >>>
> >> Status: OK
> >> Debian: <
> >>
> https://win-builder.r-project.org/incoming_pretest/phangorn_2.11.0_20230122_175755/Debian/00check.log
> >>>
> >> Status: OK"
> >>
> >> I am kind of puzzled as to what the problem is, but it might well be
> >> that I
> >> missed something? I appreciate any suggestions.
> >>
> >> Kind regards,
> >> Klaus Schliep
> >>
> >>
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


-- 
Klaus Schliep

Senior Scientist
Institute of Molecular Biotechnology
TU Graz
https://ubt.tugraz.at <https://icbt.tugraz.at>

	[[alternative HTML version deleted]]


From m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu  Mon Jan 23 17:30:52 2023
From: m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu (Maxim Nazarov)
Date: Mon, 23 Jan 2023 16:30:52 +0000
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
Message-ID: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>

Hello all,

I am submitting a minor update to one of my CRAN package (BIGL), and get strange errors on R-devel on win-builder - https://win-builder.r-project.org/incoming_pretest/BIGL_1.6.7_20230119_225109/Windows/00check.log and https://win-builder.r-project.org/o339zPAR6pWG/00check.log (different symbols)

It shows strange output like "`1Y???hA?..." before tests and cryptic error-messages like "unable to translate '(<be><b1><a7>m' to a wide string"
I can also see similar output in examples - https://win-builder.r-project.org/o339zPAR6pWG/examples_and_tests/BIGL-Ex.Rout 

I don't get any isses on debian R-devel, on R-release on windows, and also can't reproduce the errors locally on a windows machine with R-devel, so I am a bit lost.
Would anyone have any idea of what goes wrong?

Kind regards,
Maxim Nazarov


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Mon Jan 23 21:49:56 2023
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Mon, 23 Jan 2023 21:49:56 +0100
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
In-Reply-To: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
References: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
Message-ID: <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>


On 1/23/23 17:30, Maxim Nazarov wrote:
> Hello all,
>
> I am submitting a minor update to one of my CRAN package (BIGL), and get strange errors on R-devel on win-builder - https://win-builder.r-project.org/incoming_pretest/BIGL_1.6.7_20230119_225109/Windows/00check.log and https://win-builder.r-project.org/o339zPAR6pWG/00check.log (different symbols)
>
> It shows strange output like "`1Y???hA?..." before tests and cryptic error-messages like "unable to translate '(<be><b1><a7>m' to a wide string"
> I can also see similar output in examples - https://win-builder.r-project.org/o339zPAR6pWG/examples_and_tests/BIGL-Ex.Rout

These are errors and warnings in regex operations (grep, gsub) due to 
that the input data is not a valid string (validly encoded string). 
Because it is not valid, it cannot be converted to a wide string, which 
is needed for the regex operation, as this uses TRE.

So, you need to find out why the input strings are invalid. Common 
causes of such problems are that they are in a different encoding from 
the one told to R or to some other software on the way. Also the data 
may be corrupted.

> I don't get any isses on debian R-devel, on R-release on windows, and also can't reproduce the errors locally on a windows machine with R-devel, so I am a bit lost.
> Would anyone have any idea of what goes wrong?

It should be fairly easy from the error output to find out which 
operations have failed in the vignette. Perhaps you could find out how 
their inputs were generated.

If you have a Windows machine with R running in UTF-8 as the native 
encoding, with recent R-devel, and the error is still not reproducible, 
try to confirm that the inputs for the failing operations are correct.

Best
Tomas

>
> Kind regards,
> Maxim Nazarov
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu  Tue Jan 24 18:33:10 2023
From: m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu (Maxim Nazarov)
Date: Tue, 24 Jan 2023 17:33:10 +0000
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
In-Reply-To: <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>
References: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
 <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>
Message-ID: <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>

Thank you, Tomas, for your insights!

I think I found the root cause of the problem - my package uses the `nlsLM` function from the `minpack.lm` package and coincidentally the new version of that package was submitted to CRAN recently.
Looking at https://win-builder.r-project.org/incoming_pretest/minpack.lm_1.2-3_20230117_110122/reverseDependencies/changes.txt - we can see that this new version of minpack.lm is causing similar errors in many of its reverse dependencies.

In fact if I install that version from https://cran.r-project.org/incoming/archive/ I get the strange output when running a simple example from `nlsLM` even on linux:
```
install.packages("https://cran.r-project.org/incoming/archive/minpack.lm_1.2-3.tar.gz")
library(minpack.lm)
DNase1 <- subset(DNase, Run == 1)
capture.output(fm1DNase1 <- nlsLM(density ~ SSlogis(log(conc), Asym, xmid, scal), DNase1))
## produces "\xa8\002\x8c\003\x9bU"
```
this seems to come from the C code, which I don't fully understand.

So I guess it is an unfortunate timing, and I just need to wait for the minpack.lm package to be fixed, but I'm wondering (philosophically) if it is correct that my package is checked against non-released (non-approved) version of minpack.lm and rejected because of its shortcomings?

Kind regards,
Maxim Nazarov


----- Original Message -----
From: "Tomas Kalibera" <tomas.kalibera at gmail.com>
To: "Maxim Nazarov" <maxim.nazarov at openanalytics.eu>, "r-package-devel" <r-package-devel at r-project.org>
Sent: Monday, 23 January, 2023 21:49:56
Subject: Re: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder R-devel

On 1/23/23 17:30, Maxim Nazarov wrote:
> Hello all,
>
> I am submitting a minor update to one of my CRAN package (BIGL), and get strange errors on R-devel on win-builder - https://win-builder.r-project.org/incoming_pretest/BIGL_1.6.7_20230119_225109/Windows/00check.log and https://win-builder.r-project.org/o339zPAR6pWG/00check.log (different symbols)
>
> It shows strange output like "`1Y???hA?..." before tests and cryptic error-messages like "unable to translate '(<be><b1><a7>m' to a wide string"
> I can also see similar output in examples - https://win-builder.r-project.org/o339zPAR6pWG/examples_and_tests/BIGL-Ex.Rout

These are errors and warnings in regex operations (grep, gsub) due to 
that the input data is not a valid string (validly encoded string). 
Because it is not valid, it cannot be converted to a wide string, which 
is needed for the regex operation, as this uses TRE.

So, you need to find out why the input strings are invalid. Common 
causes of such problems are that they are in a different encoding from 
the one told to R or to some other software on the way. Also the data 
may be corrupted.

> I don't get any isses on debian R-devel, on R-release on windows, and also can't reproduce the errors locally on a windows machine with R-devel, so I am a bit lost.
> Would anyone have any idea of what goes wrong?

It should be fairly easy from the error output to find out which 
operations have failed in the vignette. Perhaps you could find out how 
their inputs were generated.

If you have a Windows machine with R running in UTF-8 as the native 
encoding, with recent R-devel, and the error is still not reproducible, 
try to confirm that the inputs for the failing operations are correct.

Best
Tomas

>
> Kind regards,
> Maxim Nazarov
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Jan 24 18:43:18 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 24 Jan 2023 12:43:18 -0500
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
In-Reply-To: <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>
References: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
 <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>
 <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>
Message-ID: <a7e315b0-1b04-af8a-2cea-2de30729ddc3@gmail.com>

I think that is likely bad luck, in that your package was being 
evaluated at the same time as the new minpack.lm, and CRAN/winbuilder 
don't isolate the builds.  If you resubmit unchanged (I'd do this on 
winbuilder, not CRAN) you may get a more reasonable outcome.

Duncan Murdoch

On 24/01/2023 12:33 p.m., Maxim Nazarov wrote:
> Thank you, Tomas, for your insights!
> 
> I think I found the root cause of the problem - my package uses the `nlsLM` function from the `minpack.lm` package and coincidentally the new version of that package was submitted to CRAN recently.
> Looking at https://win-builder.r-project.org/incoming_pretest/minpack.lm_1.2-3_20230117_110122/reverseDependencies/changes.txt - we can see that this new version of minpack.lm is causing similar errors in many of its reverse dependencies.
> 
> In fact if I install that version from https://cran.r-project.org/incoming/archive/ I get the strange output when running a simple example from `nlsLM` even on linux:
> ```
> install.packages("https://cran.r-project.org/incoming/archive/minpack.lm_1.2-3.tar.gz")
> library(minpack.lm)
> DNase1 <- subset(DNase, Run == 1)
> capture.output(fm1DNase1 <- nlsLM(density ~ SSlogis(log(conc), Asym, xmid, scal), DNase1))
> ## produces "\xa8\002\x8c\003\x9bU"
> ```
> this seems to come from the C code, which I don't fully understand.
> 
> So I guess it is an unfortunate timing, and I just need to wait for the minpack.lm package to be fixed, but I'm wondering (philosophically) if it is correct that my package is checked against non-released (non-approved) version of minpack.lm and rejected because of its shortcomings?
> 
> Kind regards,
> Maxim Nazarov
> 
> 
> ----- Original Message -----
> From: "Tomas Kalibera" <tomas.kalibera at gmail.com>
> To: "Maxim Nazarov" <maxim.nazarov at openanalytics.eu>, "r-package-devel" <r-package-devel at r-project.org>
> Sent: Monday, 23 January, 2023 21:49:56
> Subject: Re: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder R-devel
> 
> On 1/23/23 17:30, Maxim Nazarov wrote:
>> Hello all,
>>
>> I am submitting a minor update to one of my CRAN package (BIGL), and get strange errors on R-devel on win-builder - https://win-builder.r-project.org/incoming_pretest/BIGL_1.6.7_20230119_225109/Windows/00check.log and https://win-builder.r-project.org/o339zPAR6pWG/00check.log (different symbols)
>>
>> It shows strange output like "`1Y???hA?..." before tests and cryptic error-messages like "unable to translate '(<be><b1><a7>m' to a wide string"
>> I can also see similar output in examples - https://win-builder.r-project.org/o339zPAR6pWG/examples_and_tests/BIGL-Ex.Rout
> 
> These are errors and warnings in regex operations (grep, gsub) due to
> that the input data is not a valid string (validly encoded string).
> Because it is not valid, it cannot be converted to a wide string, which
> is needed for the regex operation, as this uses TRE.
> 
> So, you need to find out why the input strings are invalid. Common
> causes of such problems are that they are in a different encoding from
> the one told to R or to some other software on the way. Also the data
> may be corrupted.
> 
>> I don't get any isses on debian R-devel, on R-release on windows, and also can't reproduce the errors locally on a windows machine with R-devel, so I am a bit lost.
>> Would anyone have any idea of what goes wrong?
> 
> It should be fairly easy from the error output to find out which
> operations have failed in the vignette. Perhaps you could find out how
> their inputs were generated.
> 
> If you have a Windows machine with R running in UTF-8 as the native
> encoding, with recent R-devel, and the error is still not reproducible,
> try to confirm that the inputs for the failing operations are correct.
> 
> Best
> Tomas
> 
>>
>> Kind regards,
>> Maxim Nazarov
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From kry|ov@r00t @end|ng |rom gm@||@com  Tue Jan 24 19:12:21 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 24 Jan 2023 21:12:21 +0300
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
In-Reply-To: <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>
References: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
 <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>
 <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>
Message-ID: <20230124211221.4fe18230@Tarkus>

On Tue, 24 Jan 2023 17:33:10 +0000
Maxim Nazarov <maxim.nazarov at openanalytics.eu> wrote:

> this seems to come from the C code

I'm 99% sure this comes from the following changes to the package:

--- minpack.lm_1.2-2/src/fcn_message.c  2020-03-23 10:54:03.000000000 +0300
+++ minpack.lm_1.2-3/src/fcn_message.c  2023-01-17 09:30:05.000000000 +0300
@@ -3,24 +3,24 @@
 char *fcn_message(char *msg, int info, int n, int nit)
 {
     if      (info == 1)
-        sprintf(msg, "Relative error in the sum of squares is at most `ftol'.");
+        Rprintf(msg, "Relative error in the sum of squares is at most `ftol'.");
     else if (info == 2)

(And so on for other values of `info`.)

sprintf() takes a string pointer to write into as its first argument.
Rprintf(), on the other hand, prints straight to the R console; its
first argument is the format string. Given a valid pointer to an
uninitialised string instead of the format string, Rprintf prints stack
garbage to the console, ignoring the following arguments. My guess is
that the maintainers either intended to remove the msg argument
altogether or needed to use snprintf() and pass the buffer size to
fcn_message().

-- 
Best regards,
Ivan


From ur|@@ohn @end|ng |rom gm@||@com  Sun Jan 22 22:36:52 2023
From: ur|@@ohn @end|ng |rom gm@||@com (Uri Simonsohn)
Date: Sun, 22 Jan 2023 21:36:52 +0000
Subject: [R-pkg-devel] 
 If you had to choose one binary to preserve for a pkg, which would it be?
Message-ID: <em688ae61e-9014-4e28-9c9b-7af67631a44a@6e5c1f4b.com>

This is not a perfect list for this question, but possibly a good list.

I maintain 'groundhog', a package that seeks to simplify reproducibility 
of R code based on R packages.
It has so far relied on MRAN  for binaries of older/archived versions of 
packages, but MRAN is shutting down.
Posit (R Studio) also has archived binaries, but they are less 
transparent about it,  they do not have Mac binaries, and I am a little 
uncomfortable relying on a 3rd party again, specially because their 
archive is more difficult to navigate and this is part of a for-profit 
venture so access is far from guaranteed. So...

I will create an independent archive of all binaries for packages for 
Windows and Mac machines.

Instead of having daily backups like MRAN does/did, i will keep just one 
binary per combination of package, version, R version, operating system.
So a single 'rio' 0.5.0 binary for Windows for R-4.2.x, for example 
(MRAN keeps a daily copy of such file instead, possibly with 100+ 
identical or nearly identical copies).

I need to decide whether to keep the first binary that was uploaded to 
CRAN, the last one, or one in the middle, etc.
In  concept binaries should work regardless of which file is chosen, but 
there is a reason, i guess they are rebuilt so often so it may make a 
difference in the margin which of the many builts available in MRAN is 
chosen to be preserved. I think it has to do with changes in underlying 
packages used to build them, but am not sure.
This decision will also guide future archiving, which of the many 
versions of to be uploaded to CRAN binaries are preserved.

So, if you have experience or knowledge on this, which of the many 
previously created binaries for a given package version would you choose 
to archive long-term?
Groundhog will always attempt to install from source if a binary fails, 
so a certain error rate is tolerable.

Uri

----------------------------------

Uri Simonsohn (urisohn.com)

Professor of Behavioral Science, ESADE, Barcelona

Senior Fellow, Wharton School, University of Pennsylvania

Blog at:  DataColada.org <www.DataColada.org>

Easy data sharing: ResearchBox.org

Twitter: @uri_sohn




	[[alternative HTML version deleted]]


From y||4013 @end|ng |rom med@corne||@edu  Mon Jan 23 17:51:42 2023
From: y||4013 @end|ng |rom med@corne||@edu (Ying Li)
Date: Mon, 23 Jan 2023 16:51:42 +0000
Subject: [R-pkg-devel] Inconsistent R CMD Check results
Message-ID: <PH0PR06MB71575B163CB7557D3E0E146AEDC89@PH0PR06MB7157.namprd06.prod.outlook.com>

Dear all,

Hope you are well! Recently, in the check before a re-submission, I got an unexpected note when doing R CMD Check using rhub::check_for_cran(), saying that "Examples with CPU (user + system) or elapsed time > 5s".

I didn't expect this note to appear because the same examples didn't cause this note in the previous submission last December. Compared with the previous submission, we only edited documentation, there was no change in the R code for functions of our package.

To double-check, I downloaded our previous submission from CRAN and checked it again. It's strange that this current CRAN version also has this note now. However, when submitting it last December, there were no such notes. Do you have any idea why the R CMD Check results are inconsistent?

Since the examples caused no note in the last submission and were successfully submitted to CRAN, I'm not sure whether I should change the examples in this re-submission to eliminate this sudden note. Any suggestions will be appreciated!

Thank you!
Ying

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Jan 24 20:55:21 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 24 Jan 2023 14:55:21 -0500
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
In-Reply-To: <20230124211221.4fe18230@Tarkus>
References: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
 <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>
 <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>
 <20230124211221.4fe18230@Tarkus>
Message-ID: <2da90e2c-1d18-dbde-507e-3f52544e65ce@gmail.com>

On 24/01/2023 1:12 p.m., Ivan Krylov wrote:
> On Tue, 24 Jan 2023 17:33:10 +0000
> Maxim Nazarov <maxim.nazarov at openanalytics.eu> wrote:
> 
>> this seems to come from the C code
> 
> I'm 99% sure this comes from the following changes to the package:
> 
> --- minpack.lm_1.2-2/src/fcn_message.c  2020-03-23 10:54:03.000000000 +0300
> +++ minpack.lm_1.2-3/src/fcn_message.c  2023-01-17 09:30:05.000000000 +0300
> @@ -3,24 +3,24 @@
>   char *fcn_message(char *msg, int info, int n, int nit)
>   {
>       if      (info == 1)
> -        sprintf(msg, "Relative error in the sum of squares is at most `ftol'.");
> +        Rprintf(msg, "Relative error in the sum of squares is at most `ftol'.");
>       else if (info == 2)
> 
> (And so on for other values of `info`.)
> 
> sprintf() takes a string pointer to write into as its first argument.
> Rprintf(), on the other hand, prints straight to the R console; its
> first argument is the format string. Given a valid pointer to an
> uninitialised string instead of the format string, Rprintf prints stack
> garbage to the console, ignoring the following arguments. My guess is
> that the maintainers either intended to remove the msg argument
> altogether or needed to use snprintf() and pass the buffer size to
> fcn_message().
> 

Package maintainers recently got a message telling us not to use 
sprintf() any more.  I guess the minpack.lm maintainer either didn't 
read the whole message carefully enough and used Rprintf as a substitute 
instead of snprintf(), or intended to use snprintf(), but typed 
Rprintf() out of habit.

Duncan Murdoch


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Tue Jan 24 21:55:31 2023
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Tue, 24 Jan 2023 21:55:31 +0100
Subject: [R-pkg-devel] 
 If you had to choose one binary to preserve for a pkg, which would it be?
In-Reply-To: <em688ae61e-9014-4e28-9c9b-7af67631a44a@6e5c1f4b.com>
References: <em688ae61e-9014-4e28-9c9b-7af67631a44a@6e5c1f4b.com>
Message-ID: <93e860ae-462a-2de2-aa6a-aea976f22c3d@gmail.com>

On 1/22/23 22:36, Uri Simonsohn wrote:
> This is not a perfect list for this question, but possibly a good list.
I think this is a good match.
> I maintain 'groundhog', a package that seeks to simplify reproducibility
> of R code based on R packages.
> It has so far relied on MRAN  for binaries of older/archived versions of
> packages, but MRAN is shutting down.
> Posit (R Studio) also has archived binaries, but they are less
> transparent about it,  they do not have Mac binaries, and I am a little
> uncomfortable relying on a 3rd party again, specially because their
> archive is more difficult to navigate and this is part of a for-profit
> venture so access is far from guaranteed. So...
>
> I will create an independent archive of all binaries for packages for
> Windows and Mac machines.
>
> Instead of having daily backups like MRAN does/did, i will keep just one
> binary per combination of package, version, R version, operating system.
> So a single 'rio' 0.5.0 binary for Windows for R-4.2.x, for example
> (MRAN keeps a daily copy of such file instead, possibly with 100+
> identical or nearly identical copies).
>
> I need to decide whether to keep the first binary that was uploaded to
> CRAN, the last one, or one in the middle, etc.
> In  concept binaries should work regardless of which file is chosen, but
> there is a reason, i guess they are rebuilt so often so it may make a
> difference in the margin which of the many builts available in MRAN is
> chosen to be preserved. I think it has to do with changes in underlying
> packages used to build them, but am not sure.
> This decision will also guide future archiving, which of the many
> versions of to be uploaded to CRAN binaries are preserved.

I think the date-based snapshots made sense, that corresponded to how 
packages were tested and built together. I am afraid you cannot get 
close to that by choosing a single version. If you really must use only 
one, probably the latest.

If I wanted some reasonably reliable repeatability of computations, I 
would though keep a virtual machine snapshot with the matching OS, 
matching version of R, the packages installed (probably from source in 
case debugging became needed), and all external dependencies. Ideally 
with disconnected network to make sure the computation works fully 
locally, and as I would not be updating the OS, for security as well. I 
would keep that snapshot intact - never save the machine state again to 
it. And if possible convert it to several image formats just in case the 
virtualization software stops being supported or no longer can read 
certain formats.

Tomas

>
> So, if you have experience or knowledge on this, which of the many
> previously created binaries for a given package version would you choose
> to archive long-term?
> Groundhog will always attempt to install from source if a binary fails,
> so a certain error rate is tolerable.
>
> Uri
>
> ----------------------------------
>
> Uri Simonsohn (urisohn.com)
>
> Professor of Behavioral Science, ESADE, Barcelona
>
> Senior Fellow, Wharton School, University of Pennsylvania
>
> Blog at:  DataColada.org <www.DataColada.org>
>
> Easy data sharing: ResearchBox.org
>
> Twitter: @uri_sohn
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @|mon@urb@nek @end|ng |rom R-project@org  Tue Jan 24 22:01:13 2023
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Wed, 25 Jan 2023 10:01:13 +1300
Subject: [R-pkg-devel] 
 If you had to choose one binary to preserve for a pkg, which would it be?
In-Reply-To: <em688ae61e-9014-4e28-9c9b-7af67631a44a@6e5c1f4b.com>
References: <em688ae61e-9014-4e28-9c9b-7af67631a44a@6e5c1f4b.com>
Message-ID: <C37B7C06-5DF2-46C2-8906-B0F84A2FE8AE@R-project.org>

Uri,

I can speak only for macOS package binaries and they have been rarely re-built. The only time when a re-build is necessary is when a dependency is updated and breaks its backward-compatibility (sadly, yes, that happens). It is relatively rare, but recently Matrix was one example with reasonably big fall-out. Those things are likely to happen more often in the future, but if you are mainly interested in an archive then you should be able to simply go by modification dates for the macOS binaries. However, I would add a black-out period after a major R release, because what happens is that I do a full re-build of all packages after a major R release (up til then the packages are build against the beta/RC) and that can take up to a few days, so I wouldn't keep packages built before that first set is done which can be few days after the release.

Cheers,
Simon


> On Jan 23, 2023, at 10:36 AM, Uri Simonsohn <uri.sohn at gmail.com> wrote:
> 
> This is not a perfect list for this question, but possibly a good list.
> 
> I maintain 'groundhog', a package that seeks to simplify reproducibility 
> of R code based on R packages.
> It has so far relied on MRAN  for binaries of older/archived versions of 
> packages, but MRAN is shutting down.
> Posit (R Studio) also has archived binaries, but they are less 
> transparent about it,  they do not have Mac binaries, and I am a little 
> uncomfortable relying on a 3rd party again, specially because their 
> archive is more difficult to navigate and this is part of a for-profit 
> venture so access is far from guaranteed. So...
> 
> I will create an independent archive of all binaries for packages for 
> Windows and Mac machines.
> 
> Instead of having daily backups like MRAN does/did, i will keep just one 
> binary per combination of package, version, R version, operating system.
> So a single 'rio' 0.5.0 binary for Windows for R-4.2.x, for example 
> (MRAN keeps a daily copy of such file instead, possibly with 100+ 
> identical or nearly identical copies).
> 
> I need to decide whether to keep the first binary that was uploaded to 
> CRAN, the last one, or one in the middle, etc.
> In  concept binaries should work regardless of which file is chosen, but 
> there is a reason, i guess they are rebuilt so often so it may make a 
> difference in the margin which of the many builts available in MRAN is 
> chosen to be preserved. I think it has to do with changes in underlying 
> packages used to build them, but am not sure.
> This decision will also guide future archiving, which of the many 
> versions of to be uploaded to CRAN binaries are preserved.
> 
> So, if you have experience or knowledge on this, which of the many 
> previously created binaries for a given package version would you choose 
> to archive long-term?
> Groundhog will always attempt to install from source if a binary fails, 
> so a certain error rate is tolerable.
> 
> Uri
> 
> ----------------------------------
> 
> Uri Simonsohn (urisohn.com)
> 
> Professor of Behavioral Science, ESADE, Barcelona
> 
> Senior Fellow, Wharton School, University of Pennsylvania
> 
> Blog at:  DataColada.org <www.DataColada.org>
> 
> Easy data sharing: ResearchBox.org
> 
> Twitter: @uri_sohn
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Tue Jan 24 22:03:45 2023
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Tue, 24 Jan 2023 22:03:45 +0100
Subject: [R-pkg-devel] Inconsistent R CMD Check results
In-Reply-To: <PH0PR06MB71575B163CB7557D3E0E146AEDC89@PH0PR06MB7157.namprd06.prod.outlook.com>
References: <PH0PR06MB71575B163CB7557D3E0E146AEDC89@PH0PR06MB7157.namprd06.prod.outlook.com>
Message-ID: <12190c88-46c6-600b-2ad2-af41b28cc01d@gmail.com>

On 1/23/23 17:51, Ying Li via R-package-devel wrote:
> Dear all,
>
> Hope you are well! Recently, in the check before a re-submission, I got an unexpected note when doing R CMD Check using rhub::check_for_cran(), saying that "Examples with CPU (user + system) or elapsed time > 5s".
>
> I didn't expect this note to appear because the same examples didn't cause this note in the previous submission last December. Compared with the previous submission, we only edited documentation, there was no change in the R code for functions of our package.
>
> To double-check, I downloaded our previous submission from CRAN and checked it again. It's strange that this current CRAN version also has this note now. However, when submitting it last December, there were no such notes. Do you have any idea why the R CMD Check results are inconsistent?

You could check on Winbuilder as that is a concrete setup used for 
incoming checks. But in principle, the computation may take longer 
because of changes in dependencies, external software and R. Which can 
be due to a performance regression, a bugfix, etc. Only 
debugging/profiling could reveal the true cause.

> Since the examples caused no note in the last submission and were successfully submitted to CRAN, I'm not sure whether I should change the examples in this re-submission to eliminate this sudden note. Any suggestions will be appreciated!
If you were close to the limit last time, it may be a coincidence and 
you might simply reduce the examples to be on the safe side.

Tomas

>
> Thank you!
> Ying
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Wed Jan 25 15:52:41 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Wed, 25 Jan 2023 15:52:41 +0100
Subject: [R-pkg-devel] Inconsistent R CMD Check results
In-Reply-To: <12190c88-46c6-600b-2ad2-af41b28cc01d@gmail.com>
References: <PH0PR06MB71575B163CB7557D3E0E146AEDC89@PH0PR06MB7157.namprd06.prod.outlook.com>
 <12190c88-46c6-600b-2ad2-af41b28cc01d@gmail.com>
Message-ID: <6cba36c3-5688-8795-0115-c48f5491fa00@statistik.tu-dortmund.de>



On 24.01.2023 22:03, Tomas Kalibera wrote:
> On 1/23/23 17:51, Ying Li via R-package-devel wrote:
>> Dear all,
>>
>> Hope you are well! Recently, in the check before a re-submission, I 
>> got an unexpected note when doing R CMD Check using 
>> rhub::check_for_cran(), saying that "Examples with CPU (user + system) 
>> or elapsed time > 5s".
>>
>> I didn't expect this note to appear because the same examples didn't 
>> cause this note in the previous submission last December. Compared 
>> with the previous submission, we only edited documentation, there was 
>> no change in the R code for functions of our package.
>>
>> To double-check, I downloaded our previous submission from CRAN and 
>> checked it again. It's strange that this current CRAN version also has 
>> this note now. However, when submitting it last December, there were 
>> no such notes. Do you have any idea why the R CMD Check results are 
>> inconsistent?
> 
> You could check on Winbuilder as that is a concrete setup used for 
> incoming checks. But in principle, the computation may take longer 
> because of changes in dependencies, external software and R. Which can 
> be due to a performance regression, a bugfix, etc. Only 
> debugging/profiling could reveal the true cause.

Yes, it may even be some OS update, or just coincidence that the system 
was idling the last time your package got checked.
Note that CRAN systems are expected to be slower than, e.g., your 
laptop, as the servers use multi core CPUs with rather low frequencies.

Best,
Uwe Ligges




>> Since the examples caused no note in the last submission and were 
>> successfully submitted to CRAN, I'm not sure whether I should change 
>> the examples in this re-submission to eliminate this sudden note. Any 
>> suggestions will be appreciated!
> If you were close to the limit last time, it may be a coincidence and 
> you might simply reduce the examples to be on the safe side.
> 
> Tomas
> 
>>
>> Thank you!
>> Ying
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From y||4013 @end|ng |rom med@corne||@edu  Wed Jan 25 16:35:36 2023
From: y||4013 @end|ng |rom med@corne||@edu (Ying Li)
Date: Wed, 25 Jan 2023 15:35:36 +0000
Subject: [R-pkg-devel] Inconsistent R CMD Check results
Message-ID: <PH0PR06MB7157C59C34D467A0558C3BC4EDCE9@PH0PR06MB7157.namprd06.prod.outlook.com>

That makes sense, thanks very much for your explanation and advice, Tomas and Uwe!

Best,
Ying
________________________________
From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
Sent: Wednesday, January 25, 2023 9:52
To: Tomas Kalibera <tomas.kalibera at gmail.com>; Ying Li <yil4013 at med.cornell.edu>; r-package-devel at r-project.org <r-package-devel at r-project.org>
Cc: Arindam RoyChoudhury <arr2014 at med.cornell.edu>
Subject: [EXTERNAL] Re: [R-pkg-devel] Inconsistent R CMD Check results



On 24.01.2023 22:03, Tomas Kalibera wrote:
> On 1/23/23 17:51, Ying Li via R-package-devel wrote:
>> Dear all,
>>
>> Hope you are well! Recently, in the check before a re-submission, I
>> got an unexpected note when doing R CMD Check using
>> rhub::check_for_cran(), saying that "Examples with CPU (user + system)
>> or elapsed time > 5s".
>>
>> I didn't expect this note to appear because the same examples didn't
>> cause this note in the previous submission last December. Compared
>> with the previous submission, we only edited documentation, there was
>> no change in the R code for functions of our package.
>>
>> To double-check, I downloaded our previous submission from CRAN and
>> checked it again. It's strange that this current CRAN version also has
>> this note now. However, when submitting it last December, there were
>> no such notes. Do you have any idea why the R CMD Check results are
>> inconsistent?
>
> You could check on Winbuilder as that is a concrete setup used for
> incoming checks. But in principle, the computation may take longer
> because of changes in dependencies, external software and R. Which can
> be due to a performance regression, a bugfix, etc. Only
> debugging/profiling could reveal the true cause.

Yes, it may even be some OS update, or just coincidence that the system
was idling the last time your package got checked.
Note that CRAN systems are expected to be slower than, e.g., your
laptop, as the servers use multi core CPUs with rather low frequencies.

Best,
Uwe Ligges




>> Since the examples caused no note in the last submission and were
>> successfully submitted to CRAN, I'm not sure whether I should change
>> the examples in this re-submission to eliminate this sudden note. Any
>> suggestions will be appreciated!
> If you were close to the limit last time, it may be a coincidence and
> you might simply reduce the examples to be on the safe side.
>
> Tomas
>
>>
>> Thank you!
>> Ying
>>
>>     [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dpackage-2Ddevel&d=DwIDaQ&c=lb62iw4YL4RFalcE2hQUQealT9-RXrryqt9KZX2qu2s&r=bP8EQnZ_JVp-Bf-Rt9gvjFVaFYbqdYei_Hbkmzh0LNc&m=eLlMF2DixVEB3UPnbyg6ZeQMZ1z2DEeFgsJnjG7ZOkd8aWS2QLCazYACWGs5Jb-_&s=J5wxZE1CYC6I4jZ-omVH9Fq0hOJuvUarBD9ckVePRe4&e=
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dpackage-2Ddevel&d=DwIDaQ&c=lb62iw4YL4RFalcE2hQUQealT9-RXrryqt9KZX2qu2s&r=bP8EQnZ_JVp-Bf-Rt9gvjFVaFYbqdYei_Hbkmzh0LNc&m=eLlMF2DixVEB3UPnbyg6ZeQMZ1z2DEeFgsJnjG7ZOkd8aWS2QLCazYACWGs5Jb-_&s=J5wxZE1CYC6I4jZ-omVH9Fq0hOJuvUarBD9ckVePRe4&e=

	[[alternative HTML version deleted]]


From m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu  Thu Jan 26 11:33:33 2023
From: m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu (Maxim Nazarov)
Date: Thu, 26 Jan 2023 10:33:33 +0000
Subject: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder
 R-devel
In-Reply-To: <2da90e2c-1d18-dbde-507e-3f52544e65ce@gmail.com>
References: <01020185df77dd2e-3108dd58-7188-43b5-96b8-1fc0bd934d69-000000@eu-west-1.amazonses.com>
 <93b9cd46-d84a-43a6-043b-ed775d077434@gmail.com>
 <01020185e4d740ca-5b632b76-ce54-4702-99c5-43446ea982ad-000000@eu-west-1.amazonses.com>
 <20230124211221.4fe18230@Tarkus>
 <2da90e2c-1d18-dbde-507e-3f52544e65ce@gmail.com>
Message-ID: <01020185eda3cc99-f47e3053-d8f0-40ef-9a3c-dbd4a4a7cbd0-000000@eu-west-1.amazonses.com>

Thank you, Duncan and Ivan for helpful feedback.
I reached out to the maintainer of the package, and she was able to quickly resolve the issue and resubmit.
Consequently my re-submission was accepted.

Kind regards,
Maxim Nazarov


----- Original Message -----
From: "Duncan Murdoch" <murdoch.duncan at gmail.com>
To: "Ivan Krylov" <krylov.r00t at gmail.com>, "Maxim Nazarov" <maxim.nazarov at openanalytics.eu>
Cc: "r-package-devel" <r-package-devel at r-project.org>
Sent: Tuesday, 24 January, 2023 20:55:21
Subject: Re: [R-pkg-devel] strange errors (non-ascii symbols) on win-builder R-devel

On 24/01/2023 1:12 p.m., Ivan Krylov wrote:
> On Tue, 24 Jan 2023 17:33:10 +0000
> Maxim Nazarov <maxim.nazarov at openanalytics.eu> wrote:
> 
>> this seems to come from the C code
> 
> I'm 99% sure this comes from the following changes to the package:
> 
> --- minpack.lm_1.2-2/src/fcn_message.c  2020-03-23 10:54:03.000000000 +0300
> +++ minpack.lm_1.2-3/src/fcn_message.c  2023-01-17 09:30:05.000000000 +0300
> @@ -3,24 +3,24 @@
>   char *fcn_message(char *msg, int info, int n, int nit)
>   {
>       if      (info == 1)
> -        sprintf(msg, "Relative error in the sum of squares is at most `ftol'.");
> +        Rprintf(msg, "Relative error in the sum of squares is at most `ftol'.");
>       else if (info == 2)
> 
> (And so on for other values of `info`.)
> 
> sprintf() takes a string pointer to write into as its first argument.
> Rprintf(), on the other hand, prints straight to the R console; its
> first argument is the format string. Given a valid pointer to an
> uninitialised string instead of the format string, Rprintf prints stack
> garbage to the console, ignoring the following arguments. My guess is
> that the maintainers either intended to remove the msg argument
> altogether or needed to use snprintf() and pass the buffer size to
> fcn_message().
> 

Package maintainers recently got a message telling us not to use 
sprintf() any more.  I guess the minpack.lm maintainer either didn't 
read the whole message carefully enough and used Rprintf as a substitute 
instead of snprintf(), or intended to use snprintf(), but typed 
Rprintf() out of habit.

Duncan Murdoch


From ur|@@ohn @end|ng |rom gm@||@com  Fri Jan 27 10:34:19 2023
From: ur|@@ohn @end|ng |rom gm@||@com (Uri Simonsohn)
Date: Fri, 27 Jan 2023 09:34:19 +0000
Subject: [R-pkg-devel] 
 If you had to choose one binary to preserve for a pkg, which would it be?
In-Reply-To: <C37B7C06-5DF2-46C2-8906-B0F84A2FE8AE@R-project.org>
References: <em688ae61e-9014-4e28-9c9b-7af67631a44a@6e5c1f4b.com>
 <C37B7C06-5DF2-46C2-8906-B0F84A2FE8AE@R-project.org>
Message-ID: <em262bb59c-da12-47b7-a34e-aa4d36964aba@8bdd459e.com>

Hi list,

I received a few emails, some off list, and replied privately to all.  
Based on the feedback, I decided to modify the approach to replacing 
MRAN.
To those interested, the updated plan follows:

1) Mac and Windows binaries from MRAN will be saved in a new archive, 
which will be called "GRAN" (G is for groundhog).  GRAN will also 
continue collecting new binaries from CRAN and archiving them for the 
foreseeable future.

2) In general, a given package, version, OS file will be saved once in 
the archive, using the 1st file posted to CRAN for that 
package-version-os (but looking at CRAN at least 10 days after a major R 
release, to ensure it was built with the released R version). There are 
two exceptions to this single binary rule (see (3) and (4))

3) The top 2% of packages on CRAN, with the most reverse dependencies, 
will be saved every 1st of the month even if it is the same package 
version. This mitigates the consequences of a given already built  
binary becoming incompatible with other packages (for example the binary 
for MASS is saved again, every 1st of the month, even if the version has 
not changed)

4) When a Mac binary is rebuilt, since they are are seldom rebuilt, it 
will be assumed that something happened, and that package version binary 
will be saved again for all OS. For example, if on 2021/05/03 MASS was 
rebuilt for Mac, the version for Windows and arm mac will also be saved 
again. Just in case. This is essentially piggybacking on Simon Urbanek's 
decisions to rebuild binaries, it assumes they are often diagnostic of 
needing a new build.

5) The package groundhog will automatically select the relevant binary 
to install, based on this architecture. Users will continue to simply 
need to run:
groundhog.library(pkg, date)

6) Once everything is rolled out and running smoothly, i will explore 
adding ubuntu binaries to GRAN

This should generate a fairly robust, if necessarily imperfect , archive 
of binaries, with a manageable GB footprint (ballpark <3TB  for all 
packages since 2014), and maximal ease-of-use.

The selective copying of MRAN-->GRAN is  taking place now, the version 
of groundhog that benefits from it should be released around May, 
several weeks before Microsoft erases MRAN.

Thanks for your feedback so far, very happy to receive further 
suggestions or thoughts off list.

Best,

Uri


------ Original Message ------
From "Simon Urbanek" <simon.urbanek at r-project.org>
To "Uri Simonsohn" <urisohn at gmail.com>
Cc R-package-devel at r-project.org
Date 1/24/2023 10:01:13 PM
Subject Re: [R-pkg-devel] If you had to choose one binary to preserve 
for a pkg, which would it be?

>Uri,
>
>I can speak only for macOS package binaries and they have been rarely re-built. The only time when a re-build is necessary is when a dependency is updated and breaks its backward-compatibility (sadly, yes, that happens). It is relatively rare, but recently Matrix was one example with reasonably big fall-out. Those things are likely to happen more often in the future, but if you are mainly interested in an archive then you should be able to simply go by modification dates for the macOS binaries. However, I would add a black-out period after a major R release, because what happens is that I do a full re-build of all packages after a major R release (up til then the packages are build against the beta/RC) and that can take up to a few days, so I wouldn't keep packages built before that first set is done which can be few days after the release.
>
>Cheers,
>Simon
>
>
>>  On Jan 23, 2023, at 10:36 AM, Uri Simonsohn <uri.sohn at gmail.com> wrote:
>>
>>  This is not a perfect list for this question, but possibly a good list.
>>
>>  I maintain 'groundhog', a package that seeks to simplify reproducibility
>>  of R code based on R packages.
>>  It has so far relied on MRAN  for binaries of older/archived versions of
>>  packages, but MRAN is shutting down.
>>  Posit (R Studio) also has archived binaries, but they are less
>>  transparent about it,  they do not have Mac binaries, and I am a little
>>  uncomfortable relying on a 3rd party again, specially because their
>>  archive is more difficult to navigate and this is part of a for-profit
>>  venture so access is far from guaranteed. So...
>>
>>  I will create an independent archive of all binaries for packages for
>>  Windows and Mac machines.
>>
>>  Instead of having daily backups like MRAN does/did, i will keep just one
>>  binary per combination of package, version, R version, operating system.
>>  So a single 'rio' 0.5.0 binary for Windows for R-4.2.x, for example
>>  (MRAN keeps a daily copy of such file instead, possibly with 100+
>>  identical or nearly identical copies).
>>
>>  I need to decide whether to keep the first binary that was uploaded to
>>  CRAN, the last one, or one in the middle, etc.
>>  In  concept binaries should work regardless of which file is chosen, but
>>  there is a reason, i guess they are rebuilt so often so it may make a
>>  difference in the margin which of the many builts available in MRAN is
>>  chosen to be preserved. I think it has to do with changes in underlying
>>  packages used to build them, but am not sure.
>>  This decision will also guide future archiving, which of the many
>>  versions of to be uploaded to CRAN binaries are preserved.
>>
>>  So, if you have experience or knowledge on this, which of the many
>>  previously created binaries for a given package version would you choose
>>  to archive long-term?
>>  Groundhog will always attempt to install from source if a binary fails,
>>  so a certain error rate is tolerable.
>>
>>  Uri
>>
>>  ----------------------------------
>>
>>  Uri Simonsohn (urisohn.com)
>>
>>  Professor of Behavioral Science, ESADE, Barcelona
>>
>>  Senior Fellow, Wharton School, University of Pennsylvania
>>
>>  Blog at:  DataColada.org <www.DataColada.org>
>>
>>  Easy data sharing: ResearchBox.org
>>
>>  Twitter: @uri_sohn
>>
>>
>>
>>
>>  	[[alternative HTML version deleted]]
>>
>>  ______________________________________________
>>R-package-devel at r-project.org mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
	[[alternative HTML version deleted]]


From |embry @end|ng |rom ecocc@@com  Sun Jan 29 19:53:53 2023
From: |embry @end|ng |rom ecocc@@com (EcoC2S - Irucka Embry)
Date: Sun, 29 Jan 2023 12:53:53 -0600
Subject: [R-pkg-devel] CRAN Packages over 5 MB & Time Length for Manual
 Inspection
In-Reply-To: <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
References: <dc713e6d764976c5f370cfb05ba38e92@ecoccs.com>
 <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
Message-ID: <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>

Greetings!

I submitted my USA.state.boundaries package on 6 January 2023 and Uwe 
responded back letting me know that it was over the 5 MB CRAN threshold. 
I responded back to Uwe letting him know that as of that date there were 
52 CRAN packages over 5 MB. As of today (29 January 2023), there are 
actually 53 CRAN packages over 5 MB.

As I heard no response back from Uwe, I re-submitted my 
USA.state.boundaries package on 12 January and 21 January. As of today, 
I have not heard any response back from Uwe or any other CRAN team 
volunteer.

There are 2 questions:

1) How long should it take to receive a response back from a CRAN team 
volunteer after a manual inspection of a CRAN package?

2) Why has my package been denied acceptance to CRAN while a new package 
over 5 MB has been allowed to be hosted on CRAN recently?

Thank you in advance.

Irucka Embry


-- 
--
No fear, Only Love! / ?No temas, solamente amor!
-Irucka Ajani Embry, 15 March 2020

Family Partners:
http://www.sustainlex.org/
https://www.schoolingsolutions.com/

---------------------------------------------------------------------------------------------------------------

The business collaboration between EConsulting (tm)
[https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to 
Nature.

Getting Back to Nature LocalHarvest --
https://www.localharvest.org/getting-back-to-nature-M73453
Getting Back to Nature -- https://www.gettingback2nature.farm/

-- Irucka and his twin brother, Obiora, are featured in the Middle
Tennessee Local Table Magazine Annual issue. The article discusses their
family farm history and the current work that they are doing under 
Getting
Back to Nature. The full magazine can be found here [the article begins 
on
page 18 of the PDF document]:

https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf

-- Obiora and Irucka were interviewed separately in early 2020 for the
Natural Resources Defense Council's (NRDC) "Regenerative Agriculture: 
Farm
Policy for the 21st Century: Policy Recommendations to Advance 
Regenerative
Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen Lee.
The PDF report is available below:

https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf

EcoC2S -- https://www.ecoccs.com/
Principal, Irucka Embry, EIT

Services:
Growing Food
Healthy Living Mentor
Data Analysis with R
R Training
Chemistry and Mathematics Tutoring
Free/Libre and Open Source Software (FLOSS) Consultation


From bbo|ker @end|ng |rom gm@||@com  Sun Jan 29 21:55:31 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 29 Jan 2023 15:55:31 -0500
Subject: [R-pkg-devel] CRAN Packages over 5 MB & Time Length for Manual
 Inspection
In-Reply-To: <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
References: <dc713e6d764976c5f370cfb05ba38e92@ecoccs.com>
 <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
 <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
Message-ID: <8ec6b8bf-7e85-21e6-bb43-dbeab3bba30d@gmail.com>

   Out of curiosity, what was the recently added package?

   It looks like the previous version of your package from about a year 
ago is only a 1.2MB tarball.  Also out of curiosity, what caused the 
increase?

   cheers
    Ben Bolker

On 2023-01-29 1:53 p.m., EcoC2S - Irucka Embry wrote:
> Greetings!
> 
> I submitted my USA.state.boundaries package on 6 January 2023 and Uwe 
> responded back letting me know that it was over the 5 MB CRAN threshold. 
> I responded back to Uwe letting him know that as of that date there were 
> 52 CRAN packages over 5 MB. As of today (29 January 2023), there are 
> actually 53 CRAN packages over 5 MB.
> 
> As I heard no response back from Uwe, I re-submitted my 
> USA.state.boundaries package on 12 January and 21 January. As of today, 
> I have not heard any response back from Uwe or any other CRAN team 
> volunteer.
> 
> There are 2 questions:
> 
> 1) How long should it take to receive a response back from a CRAN team 
> volunteer after a manual inspection of a CRAN package?
> 
> 2) Why has my package been denied acceptance to CRAN while a new package 
> over 5 MB has been allowed to be hosted on CRAN recently?
> 
> Thank you in advance.
> 
> Irucka Embry
> 
> 

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From cdorm @end|ng |rom g@ecc@u-tokyo@@c@jp  Sun Jan 29 23:41:33 2023
From: cdorm @end|ng |rom g@ecc@u-tokyo@@c@jp (Richard Shefferson)
Date: Mon, 30 Jan 2023 07:41:33 +0900
Subject: [R-pkg-devel] CRAN Packages over 5 MB & Time Length for Manual
 Inspection
In-Reply-To: <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
References: <dc713e6d764976c5f370cfb05ba38e92@ecoccs.com>
 <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
 <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
Message-ID: <CAD7xazvvDRT0jODNx5FK3fa=WuSb9cC0iyUz7G_AQKAEZUwroA@mail.gmail.com>

My understanding is that packages over 5MB are only allowed under
exceptional circumstances. You would need to include a note in your
submission explaining why it is over 5 MB. If it is not accepted, then the
reason provided is not sufficient. I believe that the CRAN guidelines
actually state this, and there may even be Stack Exchange cases related to
this, as well.

Not sure about how long to wait for a response, but since the CRAN team is
made up of volunteers who have plenty of other things on their plates, I
always interpret a lack of response as meaning that I missed something
obvious.

Rich Shefferson

On Mon, Jan 30, 2023 at 3:54 EcoC2S - Irucka Embry <iembry at ecoccs.com>
wrote:

> Greetings!
>
> I submitted my USA.state.boundaries package on 6 January 2023 and Uwe
> responded back letting me know that it was over the 5 MB CRAN threshold.
> I responded back to Uwe letting him know that as of that date there were
> 52 CRAN packages over 5 MB. As of today (29 January 2023), there are
> actually 53 CRAN packages over 5 MB.
>
> As I heard no response back from Uwe, I re-submitted my
> USA.state.boundaries package on 12 January and 21 January. As of today,
> I have not heard any response back from Uwe or any other CRAN team
> volunteer.
>
> There are 2 questions:
>
> 1) How long should it take to receive a response back from a CRAN team
> volunteer after a manual inspection of a CRAN package?
>
> 2) Why has my package been denied acceptance to CRAN while a new package
> over 5 MB has been allowed to be hosted on CRAN recently?
>
> Thank you in advance.
>
> Irucka Embry
>
>
> --
> --
> No fear, Only Love! / ?No temas, solamente amor!
> -Irucka Ajani Embry, 15 March 2020
>
> Family Partners:
> http://www.sustainlex.org/
> https://www.schoolingsolutions.com/
>
>
> ---------------------------------------------------------------------------------------------------------------
>
> The business collaboration between EConsulting (tm)
> [https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to
> Nature.
>
> Getting Back to Nature LocalHarvest --
> https://www.localharvest.org/getting-back-to-nature-M73453
> Getting Back to Nature -- https://www.gettingback2nature.farm/
>
> -- Irucka and his twin brother, Obiora, are featured in the Middle
> Tennessee Local Table Magazine Annual issue. The article discusses their
> family farm history and the current work that they are doing under
> Getting
> Back to Nature. The full magazine can be found here [the article begins
> on
> page 18 of the PDF document]:
>
> https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf
>
> -- Obiora and Irucka were interviewed separately in early 2020 for the
> Natural Resources Defense Council's (NRDC) "Regenerative Agriculture:
> Farm
> Policy for the 21st Century: Policy Recommendations to Advance
> Regenerative
> Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen Lee.
> The PDF report is available below:
>
>
> https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf
>
> EcoC2S -- https://www.ecoccs.com/
> Principal, Irucka Embry, EIT
>
> Services:
> Growing Food
> Healthy Living Mentor
> Data Analysis with R
> R Training
> Chemistry and Mathematics Tutoring
> Free/Libre and Open Source Software (FLOSS) Consultation
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
-- 
-------------------------------------------------------
Dr. Richard P. Shefferson
Associate Professor
Organization for Programs on Environmental Sciences
Graduate School of Arts and Sciences
University of Tokyo
3-8-1 Komaba
Meguro-ku, Tokyo 153-8902, Japan

???????????? ???
????????????????????
153-8902 ???????? 3-8-1 (?6??209A???

E-mail:cdorm at g.ecc.u-tokyo.ac.jp <cdorm at g.ecc.u-tokyo.ac.jp>
Tel: +81-3-5465-7235
Fax: +81-3-5465-7236

Web: www.sheffersonlab.com
Book on the Evolution of Senescence in the Tree of Life
http://tinyurl.com/SenescenceBook

	[[alternative HTML version deleted]]


From @vr@h@m@@d|er @end|ng |rom gm@||@com  Mon Jan 30 01:12:59 2023
From: @vr@h@m@@d|er @end|ng |rom gm@||@com (Avraham Adler)
Date: Mon, 30 Jan 2023 00:12:59 +0000
Subject: [R-pkg-devel] Proper way to express Fortran 2008 dependence for R
 package
Message-ID: <CAL6gwnL+7q5wKkittHkO4GEq=ri5thUBEEjjY_q=C9nwOrnEeQ@mail.gmail.com>

I would like to convert some of my hand-rolled Fortran code to Fortran
intrinsics which entered the language in Fortran 2008, which should be
extremely widely supported at this time. Specifically, I would like to
use the log_gamma function and ieee_arithmetic functions and values.
If it helps, the current package is at [1] and devel branch with new
code is at [2].

If I understand it correctly, WRE allows for dependence on Fortran
2008 by explicitly passing -std=f2008 in PKG_FFLAGS (WRE section 1.2.3
Using F9x code [3]). However, checking a package as-cran with that
addition delivers a warning (further confirmed by win-builder and
rhub).

My question is is it appropriate to submit a package with that warning
and note it in the submission or is there a better way to express
reliance on Fortran 2008. The implication from WRE 1.2.4 is that
passing standards in Makevars is preferable to stating them in
DESCRIPTION, at least as regards C++.

What somewhat complicates matters is that if I build my package
(Rtools43 on Windows 10) without passing "-std=f2008" it still builds
properly and passes all the tests because Rtools43 is based on GCC12.2
which supports Fortran 2008 intrinsics. So I can probably submit it
without the flag, but someone with a very old Fortran installation may
suffer.

I understand being told I should just address CRAN directly, but I
thought I would try the collected institutional memory here first.

Thank you,

Avi

[1] https://github.com/aadler/Delaporte
[2] https://github.com/aadler/Delaporte/tree/devel
[3] https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Using-F9x-code


From m|keb|@z@n|n @end|ng |rom gm@||@com  Tue Jan 31 16:02:04 2023
From: m|keb|@z@n|n @end|ng |rom gm@||@com (Mike Blazanin)
Date: Tue, 31 Jan 2023 10:02:04 -0500
Subject: [R-pkg-devel] Help with CRAN-only Windows-only package build error:
 System.Rd not found
Message-ID: <CAEbuDvJuzUn7JKdWeH6u8MtvETcMi4m3tvmZXtvQ3bSB8xGHpA@mail.gmail.com>

Hi all, trying to troubleshoot my way through my first CRAN package
submission. I've addressed all the other issues so far (much thanks to Uwe
from CRAN for that).

In the second-to-last version I submitted via devtools::release(), it
raised 1 WARNING on both Windows and Debian:
* checking sizes of PDF files under 'inst/doc' ... WARNING
  'gs+qpdf' made some significant size reductions:
     compacted 'noise.pdf' from 1.4Mb to 1.1Mb

To address this, I re-released to CRAN with vignette compaction active:
devtools::release(args = "--compact-vignettes=gs+qpdf")

However, this now raises 1 new NOTE (only on Windows) and 1 ERROR. The NOTE
is:
* checking CRAN incoming feasibility ... [7s] NOTE
Reading Rd files failed with
  cannot open the connection
Problems when formatting CITATION entries:
  cannot open file 'D:/RCompile/recent/R/share/Rd/macros/system.Rd': No
such file or directory

Which later produces the ERROR:
* checking whether package 'gcplyr' can be installed ... ERROR
Installation failed.
See 'd:/RCompile/CRANincoming/R-devel/gcplyr.Rcheck/00install.out' for
details.

If I check 00install.out, here's what I see:
* installing *source* package 'gcplyr' ...
** using staged installation
Warning in as.POSIXlt.POSIXct(x, tz) : unknown timezone 'Europe/Berlin'
Warning in as.POSIXlt.POSIXct(x, tz) : unknown timezone 'GMT'
Warning in as.POSIXlt.POSIXct(x, tz) :
  unknown timezone 'America/New_York'
Warning in as.POSIXlt.POSIXct(x, tz) : unknown timezone 'GMT'
Warning in as.POSIXlt.POSIXct(x, tz) :
  unknown timezone 'America/New_York'
** R
** data
*** moving datasets to lazyload DB
** inst
** byte-compile and prepare package for lazy loading
Error in if (file.size(codeFile) == file.size(loaderFile)) warning("package
seems to be using lazy loading already") else { :
  missing value where TRUE/FALSE needed
Calls: <Anonymous>
Execution halted
ERROR: lazy loading failed for package 'gcplyr'
* removing 'd:/RCompile/CRANincoming/R-devel/lib/gcplyr'
* restoring previous 'd:/RCompile/CRANincoming/R-devel/lib/gcplyr'

There were no changes to the code between two submissions, and when I
googled around to try to figure out what might be causing this error, I
couldn't find anything that would explain why a submission that was
successful other than a single too-large vignette pdf now raises an error
when the pdf's are compacted before submission.

The full package source code is available at
https://github.com/mikeblazanin/gcplyr.

Let me know if you have any ideas what could be causing this or what to
look into! This isn't an issue I've been able to reproduce on my local
machine nor on the rhub checker so it's a bit difficult for me to debug and
I don't want to take up any more of the CRAN volunteers' time

Thanks!
Mike Blazanin

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Tue Jan 31 17:57:20 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Tue, 31 Jan 2023 17:57:20 +0100
Subject: [R-pkg-devel] 
 Help with CRAN-only Windows-only package build error:
 System.Rd not found
In-Reply-To: <CAEbuDvJuzUn7JKdWeH6u8MtvETcMi4m3tvmZXtvQ3bSB8xGHpA@mail.gmail.com>
References: <CAEbuDvJuzUn7JKdWeH6u8MtvETcMi4m3tvmZXtvQ3bSB8xGHpA@mail.gmail.com>
Message-ID: <a6c6934a-c982-9079-9593-85a4634cb3ae@statistik.tu-dortmund.de>

This was a temporary hicc up on the Windows machine, all check should 
have been triggered again.

Best,
Uwe Ligges


On 31.01.2023 16:02, Mike Blazanin wrote:
> Hi all, trying to troubleshoot my way through my first CRAN package
> submission. I've addressed all the other issues so far (much thanks to Uwe
> from CRAN for that).
> 
> In the second-to-last version I submitted via devtools::release(), it
> raised 1 WARNING on both Windows and Debian:
> * checking sizes of PDF files under 'inst/doc' ... WARNING
>    'gs+qpdf' made some significant size reductions:
>       compacted 'noise.pdf' from 1.4Mb to 1.1Mb
> 
> To address this, I re-released to CRAN with vignette compaction active:
> devtools::release(args = "--compact-vignettes=gs+qpdf")
> 
> However, this now raises 1 new NOTE (only on Windows) and 1 ERROR. The NOTE
> is:
> * checking CRAN incoming feasibility ... [7s] NOTE
> Reading Rd files failed with
>    cannot open the connection
> Problems when formatting CITATION entries:
>    cannot open file 'D:/RCompile/recent/R/share/Rd/macros/system.Rd': No
> such file or directory
> 
> Which later produces the ERROR:
> * checking whether package 'gcplyr' can be installed ... ERROR
> Installation failed.
> See 'd:/RCompile/CRANincoming/R-devel/gcplyr.Rcheck/00install.out' for
> details.
> 
> If I check 00install.out, here's what I see:
> * installing *source* package 'gcplyr' ...
> ** using staged installation
> Warning in as.POSIXlt.POSIXct(x, tz) : unknown timezone 'Europe/Berlin'
> Warning in as.POSIXlt.POSIXct(x, tz) : unknown timezone 'GMT'
> Warning in as.POSIXlt.POSIXct(x, tz) :
>    unknown timezone 'America/New_York'
> Warning in as.POSIXlt.POSIXct(x, tz) : unknown timezone 'GMT'
> Warning in as.POSIXlt.POSIXct(x, tz) :
>    unknown timezone 'America/New_York'
> ** R
> ** data
> *** moving datasets to lazyload DB
> ** inst
> ** byte-compile and prepare package for lazy loading
> Error in if (file.size(codeFile) == file.size(loaderFile)) warning("package
> seems to be using lazy loading already") else { :
>    missing value where TRUE/FALSE needed
> Calls: <Anonymous>
> Execution halted
> ERROR: lazy loading failed for package 'gcplyr'
> * removing 'd:/RCompile/CRANincoming/R-devel/lib/gcplyr'
> * restoring previous 'd:/RCompile/CRANincoming/R-devel/lib/gcplyr'
> 
> There were no changes to the code between two submissions, and when I
> googled around to try to figure out what might be causing this error, I
> couldn't find anything that would explain why a submission that was
> successful other than a single too-large vignette pdf now raises an error
> when the pdf's are compacted before submission.
> 
> The full package source code is available at
> https://github.com/mikeblazanin/gcplyr.
> 
> Let me know if you have any ideas what could be causing this or what to
> look into! This isn't an issue I've been able to reproduce on my local
> machine nor on the rhub checker so it's a bit difficult for me to debug and
> I don't want to take up any more of the CRAN volunteers' time
> 
> Thanks!
> Mike Blazanin
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Feb  2 22:53:34 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 2 Feb 2023 16:53:34 -0500
Subject: [R-pkg-devel] Best current way to hook into the event loop?
Message-ID: <3e315cd1-d4fb-8bff-f801-7fad9eddbac5@gmail.com>

I'm updating low level stuff in the rgl package.  I'm exploring using 
the GLFW library to handle low level stuff instead of trying to do that 
myself.

Currently rgl has fairly ugly code to link into the R event loop.  (It 
needs to do this so that it hears about mouse movement, etc.)  I'm 
hoping that someone else has written better code than I could to do 
this.  Is there a currently recommended way to hook into the loop?

The kinds of things I need are getting events fairly frequently (e.g. 
0.03 second delay if things aren't too busy) for code that doesn't 
involve R at all.

I will also occasionally want to call back into R; I don't really mind 
if there's a bigger delay to wait for that to be safe.

I've seen the "later" package:  it looks as though it might do what I 
need, but the protection for R code seems to be all or nothing, i.e. if 
I want to evaluate an R expression nothing else can be running, or if I 
want action while R code is running, I can't involve R at all.

Duncan Murdoch


From @|mon@urb@nek @end|ng |rom R-project@org  Fri Feb  3 01:24:53 2023
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Fri, 3 Feb 2023 13:24:53 +1300
Subject: [R-pkg-devel] Best current way to hook into the event loop?
In-Reply-To: <3e315cd1-d4fb-8bff-f801-7fad9eddbac5@gmail.com>
References: <3e315cd1-d4fb-8bff-f801-7fad9eddbac5@gmail.com>
Message-ID: <EA3B6EA4-36D7-4980-8332-53F0B0FB712F@R-project.org>

Duncan,

I don't know if it is best, but you can have a look at "background"[1] which is I believe what "later" was inspired by. It is a very minimal example so should give you ideas on how to do that in your package - it runs the R code on the main thread so it should be as close to safe as one can get with asynchronous calls, just beware of reentrance. In your case I suspect that you may already have an X11 fd that you can use in the unix handler - not sure what signaling you need on Windows, though.

Cheers,
Simon

[1] - https://github.com/s-u/background


> On Feb 3, 2023, at 10:53 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> I'm updating low level stuff in the rgl package.  I'm exploring using the GLFW library to handle low level stuff instead of trying to do that myself.
> 
> Currently rgl has fairly ugly code to link into the R event loop.  (It needs to do this so that it hears about mouse movement, etc.)  I'm hoping that someone else has written better code than I could to do this.  Is there a currently recommended way to hook into the loop?
> 
> The kinds of things I need are getting events fairly frequently (e.g. 0.03 second delay if things aren't too busy) for code that doesn't involve R at all.
> 
> I will also occasionally want to call back into R; I don't really mind if there's a bigger delay to wait for that to be safe.
> 
> I've seen the "later" package:  it looks as though it might do what I need, but the protection for R code seems to be all or nothing, i.e. if I want to evaluate an R expression nothing else can be running, or if I want action while R code is running, I can't involve R at all.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Feb  3 11:40:20 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 3 Feb 2023 05:40:20 -0500
Subject: [R-pkg-devel] Best current way to hook into the event loop?
In-Reply-To: <EA3B6EA4-36D7-4980-8332-53F0B0FB712F@R-project.org>
References: <3e315cd1-d4fb-8bff-f801-7fad9eddbac5@gmail.com>
 <EA3B6EA4-36D7-4980-8332-53F0B0FB712F@R-project.org>
Message-ID: <c4e37b44-c98e-3e4a-bbb4-794c86db8d4d@gmail.com>

On 02/02/2023 7:24 p.m., Simon Urbanek wrote:
> Duncan,
> 
> I don't know if it is best, but you can have a look at "background"[1] which is I believe what "later" was inspired by. It is a very minimal example so should give you ideas on how to do that in your package - it runs the R code on the main thread so it should be as close to safe as one can get with asynchronous calls, just beware of reentrance. In your case I suspect that you may already have an X11 fd that you can use in the unix handler - not sure what signaling you need on Windows, though.

Thanks.  Yours appears to have the advantage of being able to run R code 
in the middle of a function call if that function calls R_ProcessEvents, 
as Sys.sleep() does.  I wonder why "later" didn't support that?

What I was hoping for would be something like R_PolledEvents, but it 
should work on all systems, not just Unix-alikes.  My goal is to 
simplify rgl.  Part of this means I'd like to minimize the system 
dependence, since I no longer have easy access to a Windows machine for 
testing.

Duncan

> 
> Cheers,
> Simon
> 
> [1] - https://github.com/s-u/background
> 
> 
>> On Feb 3, 2023, at 10:53 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> I'm updating low level stuff in the rgl package.  I'm exploring using the GLFW library to handle low level stuff instead of trying to do that myself.
>>
>> Currently rgl has fairly ugly code to link into the R event loop.  (It needs to do this so that it hears about mouse movement, etc.)  I'm hoping that someone else has written better code than I could to do this.  Is there a currently recommended way to hook into the loop?
>>
>> The kinds of things I need are getting events fairly frequently (e.g. 0.03 second delay if things aren't too busy) for code that doesn't involve R at all.
>>
>> I will also occasionally want to call back into R; I don't really mind if there's a bigger delay to wait for that to be safe.
>>
>> I've seen the "later" package:  it looks as though it might do what I need, but the protection for R code seems to be all or nothing, i.e. if I want to evaluate an R expression nothing else can be running, or if I want action while R code is running, I can't involve R at all.
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>


From br@d|eyjeck @end|ng |rom gm@||@com  Fri Feb  3 17:28:23 2023
From: br@d|eyjeck @end|ng |rom gm@||@com (Brad Eck)
Date: Fri, 3 Feb 2023 16:28:23 +0000
Subject: [R-pkg-devel] reproducing cran warnings
Message-ID: <CALECgPYrOi1dcS_LfyuW5A+DQqjmC5SxepVof0Q64oWbFdt_Lw@mail.gmail.com>

Dear List -

What?s the latest best practice on trying to reproduce warnings raised
on CRAN checks?

I updated my epanet2toolkit package earlier this week.
R CMD check ?as-cran was clean on RHUB and Winbuilder and my local
machines.  But on CRAN a few variations are causing warnings.

For example R-devel-debian-gcc is ok on rhub
https://builder.r-hub.io/status/epanet2toolkit_0.6.1.tar.gz-58c1ce1e316317307679f58450a5e17a

But
not on CRAN:
https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-gcc/epanet2toolkit-00check.html

Thanks in advance for any suggestions.

Brad

	[[alternative HTML version deleted]]


From jpno|@n @end|ng |rom @mer|c@n@edu  Fri Feb  3 18:00:00 2023
From: jpno|@n @end|ng |rom @mer|c@n@edu (John P. Nolan)
Date: Fri, 3 Feb 2023 17:00:00 +0000
Subject: [R-pkg-devel] splitting an R package into two
Message-ID: <BL0PR06MB4371458D1DC48087B8F6E780C6D79@BL0PR06MB4371.namprd06.prod.outlook.com>

Dear R-package-devel,

I am updating package mvmesh that is on CRAN.  I would like to split that package into two parts, mvmesh (multivariate meshes/grids) and mvhist (multivariate histograms). Does CRAN have a policy/practice on this?   I did  a search, but found nothing on this.

I would do this in two steps:

  1.  Extract some of the functions in the current package into a new package.   Submit that package as mvhist and wait for approval.
  2.  Remove the extracted functions from the current package, and submit it with a new version number.
There is a short term problem that some functions would exist in two places during the time period it takes to do step 2.  After that, users who want to use the functions in mvhist will have install both packages.

I don't want to add work for the CRAN team, so please let me know if this is forbidden or there is a better way.

Thanks,  John
............................................................................................
John P. Nolan
Math/Stat Dept., American University
106J Myers Hall, 4400 Massachusetts Ave, NW, Washington, DC 20016-8050
Phone: 202-885-3140   E-mail:  jpnolan at american.edu
Web:   https://edspace.american.edu/jpnolan/



	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Feb  3 18:07:05 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 3 Feb 2023 12:07:05 -0500
Subject: [R-pkg-devel] splitting an R package into two
In-Reply-To: <BL0PR06MB4371458D1DC48087B8F6E780C6D79@BL0PR06MB4371.namprd06.prod.outlook.com>
References: <BL0PR06MB4371458D1DC48087B8F6E780C6D79@BL0PR06MB4371.namprd06.prod.outlook.com>
Message-ID: <5db9511d-d98d-a3d2-b292-1546fa984cf0@gmail.com>

On 03/02/2023 12:00 p.m., John P. Nolan wrote:
> Dear R-package-devel,
> 
> I am updating package mvmesh that is on CRAN.  I would like to split that package into two parts, mvmesh (multivariate meshes/grids) and mvhist (multivariate histograms). Does CRAN have a policy/practice on this?   I did  a search, but found nothing on this.
> 
> I would do this in two steps:
> 
>    1.  Extract some of the functions in the current package into a new package.   Submit that package as mvhist and wait for approval.
>    2.  Remove the extracted functions from the current package, and submit it with a new version number.
> There is a short term problem that some functions would exist in two places during the time period it takes to do step 2.  After that, users who want to use the functions in mvhist will have install both packages.
> 
> I don't want to add work for the CRAN team, so please let me know if this is forbidden or there is a better way.

I think your plan is good, though it is missing one step that should 
happen between 1 and 2:

Contact maintainers of all packages that use mvmesh and tell them what 
changes they need to make.  According to the CRAN page for mvmesh, 
that's just two packages, both of which you maintain:  gensphere, 
SphericalCubature, but you may know of others (e.g. on Bioconductor or 
elsewhere) who should be informed.

If those are the only two, then the step should be to send any necessary 
updates to them before proceeding to step 2.  When you do get to step 2, 
mention what steps you took to inform mvmesh users.

Duncan Murdoch


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Feb  3 18:18:42 2023
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Fri, 3 Feb 2023 09:18:42 -0800
Subject: [R-pkg-devel] reproducing cran warnings
In-Reply-To: <CALECgPYrOi1dcS_LfyuW5A+DQqjmC5SxepVof0Q64oWbFdt_Lw@mail.gmail.com>
References: <CALECgPYrOi1dcS_LfyuW5A+DQqjmC5SxepVof0Q64oWbFdt_Lw@mail.gmail.com>
Message-ID: <CAHqSRuQW1vcy-4kbAZR87dN4QHtNDZp02sRBLFv8hsLXpWeOmw@mail.gmail.com>

checking whether package ?epanet2toolkit? can be installed ... WARNING
Found the following significant warnings:
  report.c:1466:37: warning: argument to ?sizeof? in ?snprintf? call is the
same expression as the destination; did you mean to provide an explicit
length? [-Wsizeof-pointer-memaccess]
  report.c:1466:61: warning: ?__builtin___snprintf_chk? output may be
truncated before the last format character [-Wformat-truncation=]
  rules.c:1364:40: warning: argument to ?sizeof? in ?snprintf? call is the
same expression as the destination; did you mean to provide an explicit
length? [-Wsizeof-pointer-memaccess]
  rules.c:1371:43: warning: argument to ?sizeof? in ?snprintf? call is the
same expression as the destination; did you mean to provide an explicit
length? [-Wsizeof-pointer-memaccess]
  rules.c:1371:58: warning: ?%02d? directive output may be truncated
writing between 2 and 11 bytes into a region of size between 0 and 6
[-Wformat-truncation=]
See
https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-gcc/epanet2toolkit-00install.html
for details.


You will get these warnings if you do things like
    char *string = (char*)malloc(length);
    snprintf(string, sizeof(string), "format ...");
sizeof(string) here is 8 (on a 64 bit machine), no matter what length is.

Change this to either
   char string[64] // 64 had better be big enough
   snprintf(string, sizeof(string), "format ..");
or
   char *string = (char*)malloc(length);
   snprintf(string, length, "format ...");

-Bill


On Fri, Feb 3, 2023 at 8:28 AM Brad Eck <bradleyjeck at gmail.com> wrote:

> Dear List -
>
> What?s the latest best practice on trying to reproduce warnings raised
> on CRAN checks?
>
> I updated my epanet2toolkit package earlier this week.
> R CMD check ?as-cran was clean on RHUB and Winbuilder and my local
> machines.  But on CRAN a few variations are causing warnings.
>
> For example R-devel-debian-gcc is ok on rhub
>
> https://builder.r-hub.io/status/epanet2toolkit_0.6.1.tar.gz-58c1ce1e316317307679f58450a5e17a
>
> But
> not on CRAN:
>
> https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-gcc/epanet2toolkit-00check.html
>
> Thanks in advance for any suggestions.
>
> Brad
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From @vr@h@m@@d|er @end|ng |rom gm@||@com  Fri Feb  3 19:08:48 2023
From: @vr@h@m@@d|er @end|ng |rom gm@||@com (Avraham Adler)
Date: Fri, 3 Feb 2023 18:08:48 +0000
Subject: [R-pkg-devel] 
 Proper way to express Fortran 2008 dependence for R package
In-Reply-To: <CAL6gwnL+7q5wKkittHkO4GEq=ri5thUBEEjjY_q=C9nwOrnEeQ@mail.gmail.com>
References: <CAL6gwnL+7q5wKkittHkO4GEq=ri5thUBEEjjY_q=C9nwOrnEeQ@mail.gmail.com>
Message-ID: <CAL6gwn+eNC3zbTKARDKoBVc5uFAC3R25VNZzPN+8PLxWDc1DEQ@mail.gmail.com>

For closure, I was advised by Professor Ripley to both pass
"-std=f008" in Makevars and add "SystemRequirements: A version of
gfortran supporting Fortran 2008" to the DESCRIPTION. CRAN accepted
the package with those two changes. I also note that the R Daily News
of 2023-02-03 [1] has the following entry under "R-devel": ?check?'s
?checking compilation flags in Makevars? has been relaxed to accept
the use of flags such as ?-std=f2008? in ?PKG_FFLAGS?. Hopefully, this
means future packages will have an easier time relying on more modern
features, albeit they are 5 or 15 years old by now :).

Thank you,

Avi

[1]: https://developer.r-project.org/blosxom.cgi/R-devel/NEWS/2023/02/02#n2023-02-02

On Mon, Jan 30, 2023 at 12:12 AM Avraham Adler <avraham.adler at gmail.com> wrote:
>
> I would like to convert some of my hand-rolled Fortran code to Fortran
> intrinsics which entered the language in Fortran 2008, which should be
> extremely widely supported at this time. Specifically, I would like to
> use the log_gamma function and ieee_arithmetic functions and values.
> If it helps, the current package is at [1] and devel branch with new
> code is at [2].
>
> If I understand it correctly, WRE allows for dependence on Fortran
> 2008 by explicitly passing -std=f2008 in PKG_FFLAGS (WRE section 1.2.3
> Using F9x code [3]). However, checking a package as-cran with that
> addition delivers a warning (further confirmed by win-builder and
> rhub).
>
> My question is is it appropriate to submit a package with that warning
> and note it in the submission or is there a better way to express
> reliance on Fortran 2008. The implication from WRE 1.2.4 is that
> passing standards in Makevars is preferable to stating them in
> DESCRIPTION, at least as regards C++.
>
> What somewhat complicates matters is that if I build my package
> (Rtools43 on Windows 10) without passing "-std=f2008" it still builds
> properly and passes all the tests because Rtools43 is based on GCC12.2
> which supports Fortran 2008 intrinsics. So I can probably submit it
> without the flag, but someone with a very old Fortran installation may
> suffer.
>
> I understand being told I should just address CRAN directly, but I
> thought I would try the collected institutional memory here first.
>
> Thank you,
>
> Avi
>
> [1] https://github.com/aadler/Delaporte
> [2] https://github.com/aadler/Delaporte/tree/devel
> [3] https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Using-F9x-code


From |embry @end|ng |rom ecocc@@com  Sat Feb  4 00:46:24 2023
From: |embry @end|ng |rom ecocc@@com (EcoC2S - Irucka Embry)
Date: Fri, 03 Feb 2023 17:46:24 -0600
Subject: [R-pkg-devel] CRAN Packages over 5 MB & Time Length for Manual
 Inspection
In-Reply-To: <8ec6b8bf-7e85-21e6-bb43-dbeab3bba30d@gmail.com>
References: <dc713e6d764976c5f370cfb05ba38e92@ecoccs.com>
 <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
 <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
 <8ec6b8bf-7e85-21e6-bb43-dbeab3bba30d@gmail.com>
Message-ID: <8d798859c89743748becc79fcccf0bd8@ecoccs.com>

Ben, thank you for your response.

The text2sdg package was added on 24 January 2023.

I had created a drat repository called USA.state.boundaries.data to 
store the full set of maps (1 of which is needed for my iemisc package) 
and I had only a subset of the maps in the USA.state.boundaries package 
which appears on CRAN.

In order to submit the revised iemisc package to CRAN, I had to add the 
map data set from USA.state.boundaries.data which iemisc requires for 
key functions to the USA.state.boundaries package. I first tried to 
submit the revised USA.state.boundaries package with the map that iemisc 
requires to CRAN back in December 2022. I exchanged some e-mails with 
Uwe prior to the holiday break.

Irucka




On 29-01-2023 14:55, Ben Bolker wrote:
> Out of curiosity, what was the recently added package?
> 
>   It looks like the previous version of your package from about a year
> ago is only a 1.2MB tarball.  Also out of curiosity, what caused the
> increase?
> 
>   cheers
>    Ben Bolker
> 
> On 2023-01-29 1:53 p.m., EcoC2S - Irucka Embry wrote:
>> Greetings!
>> 
>> I submitted my USA.state.boundaries package on 6 January 2023 and Uwe 
>> responded back letting me know that it was over the 5 MB CRAN 
>> threshold. I responded back to Uwe letting him know that as of that 
>> date there were 52 CRAN packages over 5 MB. As of today (29 January 
>> 2023), there are actually 53 CRAN packages over 5 MB.
>> 
>> As I heard no response back from Uwe, I re-submitted my 
>> USA.state.boundaries package on 12 January and 21 January. As of 
>> today, I have not heard any response back from Uwe or any other CRAN 
>> team volunteer.
>> 
>> There are 2 questions:
>> 
>> 1) How long should it take to receive a response back from a CRAN team 
>> volunteer after a manual inspection of a CRAN package?
>> 
>> 2) Why has my package been denied acceptance to CRAN while a new 
>> package over 5 MB has been allowed to be hosted on CRAN recently?
>> 
>> Thank you in advance.
>> 
>> Irucka Embry
>> 
>> 
> 
> --
> Dr. Benjamin Bolker
> Professor, Mathematics & Statistics and Biology, McMaster University
> Director, School of Computational Science and Engineering
> (Acting) Graduate chair, Mathematics & Statistics
>> E-mail is sent at my convenience; I don't expect replies outside of 
>> working hours.
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
--
No fear, Only Love! / ?No temas, solamente amor!
-Irucka Ajani Embry, 15 March 2020

Family Partners:
http://www.sustainlex.org/
https://www.schoolingsolutions.com/

---------------------------------------------------------------------------------------------------------------

The business collaboration between EConsulting (tm)
[https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to 
Nature.

Getting Back to Nature LocalHarvest --
https://www.localharvest.org/getting-back-to-nature-M73453
Getting Back to Nature -- https://www.gettingback2nature.farm/

-- Irucka and his twin brother, Obiora, are featured in the Middle
Tennessee Local Table Magazine Annual issue. The article discusses their
family farm history and the current work that they are doing under 
Getting
Back to Nature. The full magazine can be found here [the article begins 
on
page 18 of the PDF document]:

https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf

-- Obiora and Irucka were interviewed separately in early 2020 for the
Natural Resources Defense Council's (NRDC) "Regenerative Agriculture: 
Farm
Policy for the 21st Century: Policy Recommendations to Advance 
Regenerative
Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen Lee.
The PDF report is available below:

https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf

EcoC2S -- https://www.ecoccs.com/
Principal, Irucka Embry, EIT

Services:
Growing Food
Healthy Living Mentor
Data Analysis with R
R Training
Chemistry and Mathematics Tutoring
Free/Libre and Open Source Software (FLOSS) Consultation


From |embry @end|ng |rom ecocc@@com  Sat Feb  4 01:00:22 2023
From: |embry @end|ng |rom ecocc@@com (EcoC2S - Irucka Embry)
Date: Fri, 03 Feb 2023 18:00:22 -0600
Subject: [R-pkg-devel] CRAN Packages over 5 MB & Time Length for Manual
 Inspection
In-Reply-To: <CAD7xazvvDRT0jODNx5FK3fa=WuSb9cC0iyUz7G_AQKAEZUwroA@mail.gmail.com>
References: <dc713e6d764976c5f370cfb05ba38e92@ecoccs.com>
 <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
 <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
 <CAD7xazvvDRT0jODNx5FK3fa=WuSb9cC0iyUz7G_AQKAEZUwroA@mail.gmail.com>
Message-ID: <4d2c89ba3adc910d3e8a8480cd1d7806@ecoccs.com>

Hey Rich, thank you for your response.

In my case, I explained the reasoning to justify the 
USA.state.boundaries package being over 5 MB and why it is needed by 
iemisc, including providing previous e-mail discussions between Uwe and 
myself, on the various re-submittals of the USA.state.boundaries 
package.

Part of the reason why I wrote the e-mail to this list serve is that I 
have seen Uwe respond back to e-mail threads in this R-pkg-devel list, 
but I have not received any response from him nor any other CRAN 
volunteer since 6 January (almost a month as of today, 3 February 2023).

I responded back to Uwe on 6 January 2023.

In terms of Uwe and others being volunteers, I understand that 
completely. I myself volunteer on a variety of projects and I do a 
variety of projects for pay as well & I have done that for a couple of 
decades now.

I believe that a response should be made in less than a month's time.

Irucka



On 29-01-2023 16:41, Richard Shefferson wrote:
> My understanding is that packages over 5MB are only allowed under
> exceptional circumstances. You would need to include a note in your
> submission explaining why it is over 5 MB. If it is not accepted, then
> the reason provided is not sufficient. I believe that the CRAN
> guidelines actually state this, and there may even be Stack Exchange
> cases related to this, as well.
> 
> Not sure about how long to wait for a response, but since the CRAN
> team is made up of volunteers who have plenty of other things on their
> plates, I always interpret a lack of response as meaning that I missed
> something obvious.
> 
> Rich Shefferson
> 
> On Mon, Jan 30, 2023 at 3:54 EcoC2S - Irucka Embry <iembry at ecoccs.com>
> wrote:
> 
>> Greetings!
>> 
>> I submitted my USA.state.boundaries package on 6 January 2023 and
>> Uwe
>> responded back letting me know that it was over the 5 MB CRAN
>> threshold.
>> I responded back to Uwe letting him know that as of that date there
>> were
>> 52 CRAN packages over 5 MB. As of today (29 January 2023), there are
>> 
>> actually 53 CRAN packages over 5 MB.
>> 
>> As I heard no response back from Uwe, I re-submitted my
>> USA.state.boundaries package on 12 January and 21 January. As of
>> today,
>> I have not heard any response back from Uwe or any other CRAN team
>> volunteer.
>> 
>> There are 2 questions:
>> 
>> 1) How long should it take to receive a response back from a CRAN
>> team
>> volunteer after a manual inspection of a CRAN package?
>> 
>> 2) Why has my package been denied acceptance to CRAN while a new
>> package
>> over 5 MB has been allowed to be hosted on CRAN recently?
>> 
>> Thank you in advance.
>> 
>> Irucka Embry
>> 
>> --
>> --
>> No fear, Only Love! / ?No temas, solamente amor!
>> -Irucka Ajani Embry, 15 March 2020
>> 
>> Family Partners:
>> http://www.sustainlex.org/
>> https://www.schoolingsolutions.com/
>> 
>> 
> ---------------------------------------------------------------------------------------------------------------
>> 
>> The business collaboration between EConsulting (tm)
>> [https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to
>> Nature.
>> 
>> Getting Back to Nature LocalHarvest --
>> https://www.localharvest.org/getting-back-to-nature-M73453
>> Getting Back to Nature -- https://www.gettingback2nature.farm/
>> 
>> -- Irucka and his twin brother, Obiora, are featured in the Middle
>> Tennessee Local Table Magazine Annual issue. The article discusses
>> their
>> family farm history and the current work that they are doing under
>> Getting
>> Back to Nature. The full magazine can be found here [the article
>> begins
>> on
>> page 18 of the PDF document]:
>> 
>> 
> https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf
>> 
>> -- Obiora and Irucka were interviewed separately in early 2020 for
>> the
>> Natural Resources Defense Council's (NRDC) "Regenerative
>> Agriculture:
>> Farm
>> Policy for the 21st Century: Policy Recommendations to Advance
>> Regenerative
>> Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen
>> Lee.
>> The PDF report is available below:
>> 
>> 
> https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf
>> 
>> EcoC2S -- https://www.ecoccs.com/
>> Principal, Irucka Embry, EIT
>> 
>> Services:
>> Growing Food
>> Healthy Living Mentor
>> Data Analysis with R
>> R Training
>> Chemistry and Mathematics Tutoring
>> Free/Libre and Open Source Software (FLOSS) Consultation
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>  --
> 
> -------------------------------------------------------
> 
> Dr. Richard P. Shefferson
> Associate Professor
> Organization for Programs on Environmental Sciences
> Graduate School of Arts and Sciences
> University of Tokyo
> 3-8-1 Komaba
> Meguro-ku, Tokyo 153-8902, Japan
> 
> ????????????????
> ????????????????????
> 153-8902 ???????? 3-8-1 (?6??209A???
> 
> E-mail:cdorm at g.ecc.u-tokyo.ac.jp
> Tel: +81-3-5465-7235
> Fax: +81-3-5465-7236
> 
> Web: www.sheffersonlab.com [1]
> 
> Book on the Evolution of Senescence in the Tree of Life
> http://tinyurl.com/SenescenceBook
> 
> 
> 
> Links:
> ------
> [1] http://www.sheffersonlab.com/

-- 
--
No fear, Only Love! / ?No temas, solamente amor!
-Irucka Ajani Embry, 15 March 2020

Family Partners:
http://www.sustainlex.org/
https://www.schoolingsolutions.com/

---------------------------------------------------------------------------------------------------------------

The business collaboration between EConsulting (tm)
[https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to 
Nature.

Getting Back to Nature LocalHarvest --
https://www.localharvest.org/getting-back-to-nature-M73453
Getting Back to Nature -- https://www.gettingback2nature.farm/

-- Irucka and his twin brother, Obiora, are featured in the Middle
Tennessee Local Table Magazine Annual issue. The article discusses their
family farm history and the current work that they are doing under 
Getting
Back to Nature. The full magazine can be found here [the article begins 
on
page 18 of the PDF document]:

https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf

-- Obiora and Irucka were interviewed separately in early 2020 for the
Natural Resources Defense Council's (NRDC) "Regenerative Agriculture: 
Farm
Policy for the 21st Century: Policy Recommendations to Advance 
Regenerative
Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen Lee.
The PDF report is available below:

https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf

EcoC2S -- https://www.ecoccs.com/
Principal, Irucka Embry, EIT

Services:
Growing Food
Healthy Living Mentor
Data Analysis with R
R Training
Chemistry and Mathematics Tutoring
Free/Libre and Open Source Software (FLOSS) Consultation


From kry|ov@r00t @end|ng |rom gm@||@com  Sat Feb  4 12:09:26 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 4 Feb 2023 14:09:26 +0300
Subject: [R-pkg-devel] reproducing cran warnings
In-Reply-To: <CALECgPYrOi1dcS_LfyuW5A+DQqjmC5SxepVof0Q64oWbFdt_Lw@mail.gmail.com>
References: <CALECgPYrOi1dcS_LfyuW5A+DQqjmC5SxepVof0Q64oWbFdt_Lw@mail.gmail.com>
Message-ID: <20230204140926.4e5f2a23@Tarkus>

On Fri, 3 Feb 2023 16:28:23 +0000
Brad Eck <bradleyjeck at gmail.com> wrote:

> For example R-devel-debian-gcc is ok on rhub
> https://builder.r-hub.io/status/epanet2toolkit_0.6.1.tar.gz-58c1ce1e316317307679f58450a5e17a
> 
> But not on CRAN:
> https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian-gcc/epanet2toolkit-00check.html

Speaking of reproducing the warnings, the CRAN checks pass -Wall
-Wstrict-prototypes -pedantic to the compiler, while on Rhub, only the
UB sanitizer is used without any statical analysis warning flags.

It may be possible to see the extra warnings if you set CFLAGS = -Wall
-Wextra -Wpedantic in ~/.R/Makevars.

-- 
Best regards,
Ivan


From w@r@||e|@berger @end|ng |rom un|@tr@@|r  Mon Feb  6 16:00:38 2023
From: w@r@||e|@berger @end|ng |rom un|@tr@@|r (RAFFELSBERGER Wolfgang (IGBMC))
Date: Mon, 6 Feb 2023 16:00:38 +0100 (CET)
Subject: [R-pkg-devel] splitting an R package into two
In-Reply-To: <5db9511d-d98d-a3d2-b292-1546fa984cf0@gmail.com>
References: <BL0PR06MB4371458D1DC48087B8F6E780C6D79@BL0PR06MB4371.namprd06.prod.outlook.com>
 <5db9511d-d98d-a3d2-b292-1546fa984cf0@gmail.com>
Message-ID: <1061463386.7807230.1675695638568.JavaMail.zimbra@unistra.fr>

As complement to Duncan's nice answer I also suggest to use the function .Deprecated() for an additional transition time.
(see eg https://stackoverflow.com/questions/44622054/mark-a-function-as-deprecated-in-customised-r-package)

Baseline, if other people/packages use your package, alert them (via a message/warning due to .Deprecated()) and give them time to adopt...

Wolfgang Raffelsberger


----- Mail original -----
De: "Duncan Murdoch" <murdoch.duncan at gmail.com>
?: "John P. Nolan" <jpnolan at american.edu>, "r-package-devel" <r-package-devel at r-project.org>
Envoy?: Vendredi 3 F?vrier 2023 18:07:05
Objet: Re: [R-pkg-devel] splitting an R package into two

On 03/02/2023 12:00 p.m., John P. Nolan wrote:
> Dear R-package-devel,
> 
> I am updating package mvmesh that is on CRAN.  I would like to split that package into two parts, mvmesh (multivariate meshes/grids) and mvhist (multivariate histograms). Does CRAN have a policy/practice on this?   I did  a search, but found nothing on this.
> 
> I would do this in two steps:
> 
>    1.  Extract some of the functions in the current package into a new package.   Submit that package as mvhist and wait for approval.
>    2.  Remove the extracted functions from the current package, and submit it with a new version number.
> There is a short term problem that some functions would exist in two places during the time period it takes to do step 2.  After that, users who want to use the functions in mvhist will have install both packages.
> 
> I don't want to add work for the CRAN team, so please let me know if this is forbidden or there is a better way.

I think your plan is good, though it is missing one step that should 
happen between 1 and 2:

Contact maintainers of all packages that use mvmesh and tell them what 
changes they need to make.  According to the CRAN page for mvmesh, 
that's just two packages, both of which you maintain:  gensphere, 
SphericalCubature, but you may know of others (e.g. on Bioconductor or 
elsewhere) who should be informed.

If those are the only two, then the step should be to send any necessary 
updates to them before proceeding to step 2.  When you do get to step 2, 
mention what steps you took to inform mvmesh users.

Duncan Murdoch

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


From w|n@tonch@ng1 @end|ng |rom gm@||@com  Mon Feb  6 21:46:16 2023
From: w|n@tonch@ng1 @end|ng |rom gm@||@com (Winston Chang)
Date: Mon, 6 Feb 2023 14:46:16 -0600
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
Message-ID: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>

I recently submitted a package to CRAN with "SystemRequirements: C++11".
This raises the following NOTE on R-devel, and I was asked to fix and
resubmit:

* checking C++ specification ... NOTE
  Specified C++11: please update to current default of C++17

If I understand correctly, I have two options, neither of which will work:
1. Remove "SystemRequirements: C++11" entirely. The problem with this is
that on systems with older versions of R (3.6 and below, I believe), it may
try to compile the package with an older C++ standard, which will fail.
2. Update it to "SystemRequirements: C++17". The problem here is that on
systems that don't have a C++17 compiler, the package won't build -- even
though the package only actually requires a C++11 compiler.

How should I deal with this?

-Winston

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Feb  6 22:01:40 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 6 Feb 2023 16:01:40 -0500
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
Message-ID: <a1d3353c-7a9f-c2bf-c29c-7dda17a66c84@gmail.com>

On 06/02/2023 3:46 p.m., Winston Chang wrote:
> I recently submitted a package to CRAN with "SystemRequirements: C++11".
> This raises the following NOTE on R-devel, and I was asked to fix and
> resubmit:
> 
> * checking C++ specification ... NOTE
>    Specified C++11: please update to current default of C++17
> 
> If I understand correctly, I have two options, neither of which will work:
> 1. Remove "SystemRequirements: C++11" entirely. The problem with this is
> that on systems with older versions of R (3.6 and below, I believe), it may
> try to compile the package with an older C++ standard, which will fail.
> 2. Update it to "SystemRequirements: C++17". The problem here is that on
> systems that don't have a C++17 compiler, the package won't build -- even
> though the package only actually requires a C++11 compiler.
> 
> How should I deal with this?

Are you allowed to say "C++11 or C++17"?

Duncan Murdoch


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Feb  6 22:45:57 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 6 Feb 2023 16:45:57 -0500
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <a1d3353c-7a9f-c2bf-c29c-7dda17a66c84@gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
 <a1d3353c-7a9f-c2bf-c29c-7dda17a66c84@gmail.com>
Message-ID: <94e2e2bb-85b4-f831-b3ed-b66cdd469e81@gmail.com>

On 06/02/2023 4:01 p.m., Duncan Murdoch wrote:
> On 06/02/2023 3:46 p.m., Winston Chang wrote:
>> I recently submitted a package to CRAN with "SystemRequirements: C++11".
>> This raises the following NOTE on R-devel, and I was asked to fix and
>> resubmit:
>>
>> * checking C++ specification ... NOTE
>>     Specified C++11: please update to current default of C++17
>>
>> If I understand correctly, I have two options, neither of which will work:
>> 1. Remove "SystemRequirements: C++11" entirely. The problem with this is
>> that on systems with older versions of R (3.6 and below, I believe), it may
>> try to compile the package with an older C++ standard, which will fail.
>> 2. Update it to "SystemRequirements: C++17". The problem here is that on
>> systems that don't have a C++17 compiler, the package won't build -- even
>> though the package only actually requires a C++11 compiler.
>>
>> How should I deal with this?
> 
> Are you allowed to say "C++11 or C++17"?

Actually I can partially answer this:  the test is not based on 
SystemRequirements, but on the log of the build, which now contains 
lines like this:

   using C compiler: ?Apple clang version 12.0.0 (clang-1200.0.32.28)?
   using C++ compiler: ?Apple clang version 12.0.0 (clang-1200.0.32.28)?
   using C++11
   using SDK: ?MacOSX11.1.sdk?

I get "using C++11" because of this line in Makevars:

   CXX_STD = CXX11

So I guess the answer is to change your Makevars to make that line 
conditional on running under an old version of R.  If you figure out how 
to do that, could you post the recipe here?

Duncan Murdoch


From kry|ov@r00t @end|ng |rom gm@||@com  Mon Feb  6 23:10:49 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 7 Feb 2023 01:10:49 +0300
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
Message-ID: <20230207011049.5756a9be@parabola>

? Mon, 6 Feb 2023 14:46:16 -0600
Winston Chang <winstonchang1 at gmail.com> ?????:

> 1. Remove "SystemRequirements: C++11" entirely. The problem with this
> is that on systems with older versions of R (3.6 and below, I
> believe), it may try to compile the package with an older C++
> standard, which will fail.
> 2. Update it to "SystemRequirements: C++17". The problem here is
> that on systems that don't have a C++17 compiler, the package won't
> build -- even though the package only actually requires a C++11
> compiler.

One way to resolve that conundrum could be to add a configure script
that detects a C++17/C++14/C++11 compiler known to R and sets that in
Makevars. I haven't published an update on CRAN yet, but R CMD check
seems satisfied with this under multiple versions of R between 3.3 and
R-devel:
https://github.com/aitap/Ropj/commit/e1ed8122d6d9a380a4f7e1505478dd07f4dd83a4

-- 
Best regards,
Ivan


From @vr@h@m@@d|er @end|ng |rom gm@||@com  Mon Feb  6 23:22:12 2023
From: @vr@h@m@@d|er @end|ng |rom gm@||@com (Avraham Adler)
Date: Mon, 6 Feb 2023 22:22:12 +0000
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <94e2e2bb-85b4-f831-b3ed-b66cdd469e81@gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
 <a1d3353c-7a9f-c2bf-c29c-7dda17a66c84@gmail.com>
 <94e2e2bb-85b4-f831-b3ed-b66cdd469e81@gmail.com>
Message-ID: <CAL6gwn+ggnKWybzeaqO5KhdT7iq-0iDgzeOBa+sDLDp8j+qaQw@mail.gmail.com>

On Mon, Feb 6, 2023 at 9:46 PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> On 06/02/2023 4:01 p.m., Duncan Murdoch wrote:
> > On 06/02/2023 3:46 p.m., Winston Chang wrote:
> >> I recently submitted a package to CRAN with "SystemRequirements: C++11".
> >> This raises the following NOTE on R-devel, and I was asked to fix and
> >> resubmit:
> >>
> >> * checking C++ specification ... NOTE
> >>     Specified C++11: please update to current default of C++17
> >>
> >> If I understand correctly, I have two options, neither of which will work:
> >> 1. Remove "SystemRequirements: C++11" entirely. The problem with this is
> >> that on systems with older versions of R (3.6 and below, I believe), it may
> >> try to compile the package with an older C++ standard, which will fail.
> >> 2. Update it to "SystemRequirements: C++17". The problem here is that on
> >> systems that don't have a C++17 compiler, the package won't build -- even
> >> though the package only actually requires a C++11 compiler.
> >>
> >> How should I deal with this?
> >
> > Are you allowed to say "C++11 or C++17"?
>
> Actually I can partially answer this:  the test is not based on
> SystemRequirements, but on the log of the build, which now contains
> lines like this:
>
>    using C compiler: ?Apple clang version 12.0.0 (clang-1200.0.32.28)?
>    using C++ compiler: ?Apple clang version 12.0.0 (clang-1200.0.32.28)?
>    using C++11
>    using SDK: ?MacOSX11.1.sdk?
>
> I get "using C++11" because of this line in Makevars:
>
>    CXX_STD = CXX11
>
> So I guess the answer is to change your Makevars to make that line
> conditional on running under an old version of R.  If you figure out how
> to do that, could you post the recipe here?

I believe this is closely related to this email [1]. Dirk and I and
Aymeric have been going through the same issue with nloptr as well.
Our current opinion is to leave it out, as it would restrict more
users to demand C++17, which is unneeded, than to have users with over
a decade old compiler which does not have C++11. Dirk and Aymeric,
please chime in if I have misstated. Regardless, according to
Professor Ripley, if you require specific features, you should mark
them in _both_ Makevars and SystemRequirements, which is implied in
the "r-devel" version of WRE which adds the words "also" in section
1.2.4.

Thanks,

Avi

[1] https://stat.ethz.ch/pipermail/r-package-devel/2023q1/008865.html

>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From |uc@r @end|ng |rom |edor@project@org  Mon Feb  6 23:58:20 2023
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Mon, 6 Feb 2023 23:58:20 +0100
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <CAL6gwn+ggnKWybzeaqO5KhdT7iq-0iDgzeOBa+sDLDp8j+qaQw@mail.gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
 <a1d3353c-7a9f-c2bf-c29c-7dda17a66c84@gmail.com>
 <94e2e2bb-85b4-f831-b3ed-b66cdd469e81@gmail.com>
 <CAL6gwn+ggnKWybzeaqO5KhdT7iq-0iDgzeOBa+sDLDp8j+qaQw@mail.gmail.com>
Message-ID: <CALEXWq0NGchgJZL7VQ6KLyrA-fkrhP00pjyywnRWUCNqmA-0ow@mail.gmail.com>

On Mon, 6 Feb 2023 at 23:27, Avraham Adler <avraham.adler at gmail.com> wrote:
>
> On Mon, Feb 6, 2023 at 9:46 PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> >
> > On 06/02/2023 4:01 p.m., Duncan Murdoch wrote:
> > > On 06/02/2023 3:46 p.m., Winston Chang wrote:
> > >> I recently submitted a package to CRAN with "SystemRequirements: C++11".
> > >> This raises the following NOTE on R-devel, and I was asked to fix and
> > >> resubmit:
> > >>
> > >> * checking C++ specification ... NOTE
> > >>     Specified C++11: please update to current default of C++17
> > >>
> > >> If I understand correctly, I have two options, neither of which will work:
> > >> 1. Remove "SystemRequirements: C++11" entirely. The problem with this is
> > >> that on systems with older versions of R (3.6 and below, I believe), it may
> > >> try to compile the package with an older C++ standard, which will fail.
> > >> 2. Update it to "SystemRequirements: C++17". The problem here is that on
> > >> systems that don't have a C++17 compiler, the package won't build -- even
> > >> though the package only actually requires a C++11 compiler.
> > >>
> > >> How should I deal with this?
> > >
> > > Are you allowed to say "C++11 or C++17"?
> >
> > Actually I can partially answer this:  the test is not based on
> > SystemRequirements, but on the log of the build, which now contains
> > lines like this:
> >
> >    using C compiler: ?Apple clang version 12.0.0 (clang-1200.0.32.28)?
> >    using C++ compiler: ?Apple clang version 12.0.0 (clang-1200.0.32.28)?
> >    using C++11
> >    using SDK: ?MacOSX11.1.sdk?
> >
> > I get "using C++11" because of this line in Makevars:
> >
> >    CXX_STD = CXX11
> >
> > So I guess the answer is to change your Makevars to make that line
> > conditional on running under an old version of R.  If you figure out how
> > to do that, could you post the recipe here?
>
> I believe this is closely related to this email [1]. Dirk and I and
> Aymeric have been going through the same issue with nloptr as well.
> Our current opinion is to leave it out, as it would restrict more
> users to demand C++17, which is unneeded, than to have users with over
> a decade old compiler which does not have C++11. Dirk and Aymeric,
> please chime in if I have misstated. Regardless, according to
> Professor Ripley, if you require specific features, you should mark
> them in _both_ Makevars and SystemRequirements, which is implied in
> the "r-devel" version of WRE which adds the words "also" in section
> 1.2.4.

Could you please point to the specific passage? According to [1],
section 1.2.4, declaring the C++ standard in SystemRequirements is
only mandatory for C++17 or later.

[1] https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Using-C_002b_002b-code

-- 
I?aki ?car


From @vr@h@m@@d|er @end|ng |rom gm@||@com  Tue Feb  7 00:09:39 2023
From: @vr@h@m@@d|er @end|ng |rom gm@||@com (Avraham Adler)
Date: Mon, 6 Feb 2023 23:09:39 +0000
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <CALEXWq0NGchgJZL7VQ6KLyrA-fkrhP00pjyywnRWUCNqmA-0ow@mail.gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
 <a1d3353c-7a9f-c2bf-c29c-7dda17a66c84@gmail.com>
 <94e2e2bb-85b4-f831-b3ed-b66cdd469e81@gmail.com>
 <CAL6gwn+ggnKWybzeaqO5KhdT7iq-0iDgzeOBa+sDLDp8j+qaQw@mail.gmail.com>
 <CALEXWq0NGchgJZL7VQ6KLyrA-fkrhP00pjyywnRWUCNqmA-0ow@mail.gmail.com>
Message-ID: <CAL6gwnJXmh1qjOWAtknJVZB+1MMGgdchYFgy5XptfweCyXENDA@mail.gmail.com>

"If a package does have a src/Makevars[.win] file then also setting
the make variable ?CXX_STD? there is recommended,"

Avi

On Mon, Feb 6, 2023 at 10:58 PM I?aki Ucar <iucar at fedoraproject.org> wrote:
>
> On Mon, 6 Feb 2023 at 23:27, Avraham Adler <avraham.adler at gmail.com> wrote:
> >
> > On Mon, Feb 6, 2023 at 9:46 PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> > >
> > > On 06/02/2023 4:01 p.m., Duncan Murdoch wrote:
> > > > On 06/02/2023 3:46 p.m., Winston Chang wrote:
> > > >> I recently submitted a package to CRAN with "SystemRequirements: C++11".
> > > >> This raises the following NOTE on R-devel, and I was asked to fix and
> > > >> resubmit:
> > > >>
> > > >> * checking C++ specification ... NOTE
> > > >>     Specified C++11: please update to current default of C++17
> > > >>
> > > >> If I understand correctly, I have two options, neither of which will work:
> > > >> 1. Remove "SystemRequirements: C++11" entirely. The problem with this is
> > > >> that on systems with older versions of R (3.6 and below, I believe), it may
> > > >> try to compile the package with an older C++ standard, which will fail.
> > > >> 2. Update it to "SystemRequirements: C++17". The problem here is that on
> > > >> systems that don't have a C++17 compiler, the package won't build -- even
> > > >> though the package only actually requires a C++11 compiler.
> > > >>
> > > >> How should I deal with this?
> > > >
> > > > Are you allowed to say "C++11 or C++17"?
> > >
> > > Actually I can partially answer this:  the test is not based on
> > > SystemRequirements, but on the log of the build, which now contains
> > > lines like this:
> > >
> > >    using C compiler: ?Apple clang version 12.0.0 (clang-1200.0.32.28)?
> > >    using C++ compiler: ?Apple clang version 12.0.0 (clang-1200.0.32.28)?
> > >    using C++11
> > >    using SDK: ?MacOSX11.1.sdk?
> > >
> > > I get "using C++11" because of this line in Makevars:
> > >
> > >    CXX_STD = CXX11
> > >
> > > So I guess the answer is to change your Makevars to make that line
> > > conditional on running under an old version of R.  If you figure out how
> > > to do that, could you post the recipe here?
> >
> > I believe this is closely related to this email [1]. Dirk and I and
> > Aymeric have been going through the same issue with nloptr as well.
> > Our current opinion is to leave it out, as it would restrict more
> > users to demand C++17, which is unneeded, than to have users with over
> > a decade old compiler which does not have C++11. Dirk and Aymeric,
> > please chime in if I have misstated. Regardless, according to
> > Professor Ripley, if you require specific features, you should mark
> > them in _both_ Makevars and SystemRequirements, which is implied in
> > the "r-devel" version of WRE which adds the words "also" in section
> > 1.2.4.
>
> Could you please point to the specific passage? According to [1],
> section 1.2.4, declaring the C++ standard in SystemRequirements is
> only mandatory for C++17 or later.
>
> [1] https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Using-C_002b_002b-code
>
> --
> I?aki ?car


From |uc@r @end|ng |rom |edor@project@org  Tue Feb  7 01:10:05 2023
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Tue, 7 Feb 2023 01:10:05 +0100
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <CAL6gwnJXmh1qjOWAtknJVZB+1MMGgdchYFgy5XptfweCyXENDA@mail.gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
 <a1d3353c-7a9f-c2bf-c29c-7dda17a66c84@gmail.com>
 <94e2e2bb-85b4-f831-b3ed-b66cdd469e81@gmail.com>
 <CAL6gwn+ggnKWybzeaqO5KhdT7iq-0iDgzeOBa+sDLDp8j+qaQw@mail.gmail.com>
 <CALEXWq0NGchgJZL7VQ6KLyrA-fkrhP00pjyywnRWUCNqmA-0ow@mail.gmail.com>
 <CAL6gwnJXmh1qjOWAtknJVZB+1MMGgdchYFgy5XptfweCyXENDA@mail.gmail.com>
Message-ID: <CALEXWq2gX4gmZAvyjF6etw-Ymg4nDmESz6cm3TkSWvWyT5_0ZQ@mail.gmail.com>

On Tue, 7 Feb 2023 at 00:09, Avraham Adler <avraham.adler at gmail.com> wrote:
>
> "If a package does have a src/Makevars[.win] file then also setting
> the make variable ?CXX_STD? there is recommended,"

That doesn't refer to the SystemRequirements field.

I?aki

>
> Avi
>
> On Mon, Feb 6, 2023 at 10:58 PM I?aki Ucar <iucar at fedoraproject.org> wrote:
> >
> > On Mon, 6 Feb 2023 at 23:27, Avraham Adler <avraham.adler at gmail.com> wrote:
> > >
> > > On Mon, Feb 6, 2023 at 9:46 PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> > > >
> > > > On 06/02/2023 4:01 p.m., Duncan Murdoch wrote:
> > > > > On 06/02/2023 3:46 p.m., Winston Chang wrote:
> > > > >> I recently submitted a package to CRAN with "SystemRequirements: C++11".
> > > > >> This raises the following NOTE on R-devel, and I was asked to fix and
> > > > >> resubmit:
> > > > >>
> > > > >> * checking C++ specification ... NOTE
> > > > >>     Specified C++11: please update to current default of C++17
> > > > >>
> > > > >> If I understand correctly, I have two options, neither of which will work:
> > > > >> 1. Remove "SystemRequirements: C++11" entirely. The problem with this is
> > > > >> that on systems with older versions of R (3.6 and below, I believe), it may
> > > > >> try to compile the package with an older C++ standard, which will fail.
> > > > >> 2. Update it to "SystemRequirements: C++17". The problem here is that on
> > > > >> systems that don't have a C++17 compiler, the package won't build -- even
> > > > >> though the package only actually requires a C++11 compiler.
> > > > >>
> > > > >> How should I deal with this?
> > > > >
> > > > > Are you allowed to say "C++11 or C++17"?
> > > >
> > > > Actually I can partially answer this:  the test is not based on
> > > > SystemRequirements, but on the log of the build, which now contains
> > > > lines like this:
> > > >
> > > >    using C compiler: ?Apple clang version 12.0.0 (clang-1200.0.32.28)?
> > > >    using C++ compiler: ?Apple clang version 12.0.0 (clang-1200.0.32.28)?
> > > >    using C++11
> > > >    using SDK: ?MacOSX11.1.sdk?
> > > >
> > > > I get "using C++11" because of this line in Makevars:
> > > >
> > > >    CXX_STD = CXX11
> > > >
> > > > So I guess the answer is to change your Makevars to make that line
> > > > conditional on running under an old version of R.  If you figure out how
> > > > to do that, could you post the recipe here?
> > >
> > > I believe this is closely related to this email [1]. Dirk and I and
> > > Aymeric have been going through the same issue with nloptr as well.
> > > Our current opinion is to leave it out, as it would restrict more
> > > users to demand C++17, which is unneeded, than to have users with over
> > > a decade old compiler which does not have C++11. Dirk and Aymeric,
> > > please chime in if I have misstated. Regardless, according to
> > > Professor Ripley, if you require specific features, you should mark
> > > them in _both_ Makevars and SystemRequirements, which is implied in
> > > the "r-devel" version of WRE which adds the words "also" in section
> > > 1.2.4.
> >
> > Could you please point to the specific passage? According to [1],
> > section 1.2.4, declaring the C++ standard in SystemRequirements is
> > only mandatory for C++17 or later.
> >
> > [1] https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Using-C_002b_002b-code
> >
> > --
> > I?aki ?car



-- 
I?aki ?car


From @vr@h@m@@d|er @end|ng |rom gm@||@com  Tue Feb  7 01:21:56 2023
From: @vr@h@m@@d|er @end|ng |rom gm@||@com (Avraham Adler)
Date: Tue, 7 Feb 2023 00:21:56 +0000
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <CALEXWq2gX4gmZAvyjF6etw-Ymg4nDmESz6cm3TkSWvWyT5_0ZQ@mail.gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
 <a1d3353c-7a9f-c2bf-c29c-7dda17a66c84@gmail.com>
 <94e2e2bb-85b4-f831-b3ed-b66cdd469e81@gmail.com>
 <CAL6gwn+ggnKWybzeaqO5KhdT7iq-0iDgzeOBa+sDLDp8j+qaQw@mail.gmail.com>
 <CALEXWq0NGchgJZL7VQ6KLyrA-fkrhP00pjyywnRWUCNqmA-0ow@mail.gmail.com>
 <CAL6gwnJXmh1qjOWAtknJVZB+1MMGgdchYFgy5XptfweCyXENDA@mail.gmail.com>
 <CALEXWq2gX4gmZAvyjF6etw-Ymg4nDmESz6cm3TkSWvWyT5_0ZQ@mail.gmail.com>
Message-ID: <CAL6gwnJxM5LyYs84-sJo5H+pAr3nXHb43BcYOwh+JgL=9DcmfA@mail.gmail.com>

On Tue, Feb 7, 2023 at 12:10 AM I?aki Ucar <iucar at fedoraproject.org> wrote:
>
> On Tue, 7 Feb 2023 at 00:09, Avraham Adler <avraham.adler at gmail.com> wrote:
> >
> > "If a package does have a src/Makevars[.win] file then also setting
> > the make variable ?CXX_STD? there is recommended,"
>
> That doesn't refer to the SystemRequirements field.
>
> I?aki
>

No, but the prior sentence does. The complete excerpt is:

  ::Packages without a src/Makevars or src/Makefile file may specify a
C++ standard for code in the src directory by including something like
?C++14? in the ?SystemRequirements? field of the DESCRIPTION file,
e.g.
  ::::SystemRequirements: C++14
 ::If a package does have a src/Makevars[.win] file then also setting
the make variable ?CXX_STD? there is recommended, as it allows R CMD
SHLIB to work correctly in the package?s src directory.

So one is supposed to add the requirement to DESCRIPTION via
SystemRequitements. If there is a Makevars, one should ALSO set the
variable in there.

If you wish, I can forward you personal communication with Professor
Ripley from last week where he makes this clear as well.

Thanks,

Avi


> >
> > Avi
> >
> > On Mon, Feb 6, 2023 at 10:58 PM I?aki Ucar <iucar at fedoraproject.org> wrote:
> > >
> > > On Mon, 6 Feb 2023 at 23:27, Avraham Adler <avraham.adler at gmail.com> wrote:
> > > >
> > > > On Mon, Feb 6, 2023 at 9:46 PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> > > > >
> > > > > On 06/02/2023 4:01 p.m., Duncan Murdoch wrote:
> > > > > > On 06/02/2023 3:46 p.m., Winston Chang wrote:
> > > > > >> I recently submitted a package to CRAN with "SystemRequirements: C++11".
> > > > > >> This raises the following NOTE on R-devel, and I was asked to fix and
> > > > > >> resubmit:
> > > > > >>
> > > > > >> * checking C++ specification ... NOTE
> > > > > >>     Specified C++11: please update to current default of C++17
> > > > > >>
> > > > > >> If I understand correctly, I have two options, neither of which will work:
> > > > > >> 1. Remove "SystemRequirements: C++11" entirely. The problem with this is
> > > > > >> that on systems with older versions of R (3.6 and below, I believe), it may
> > > > > >> try to compile the package with an older C++ standard, which will fail.
> > > > > >> 2. Update it to "SystemRequirements: C++17". The problem here is that on
> > > > > >> systems that don't have a C++17 compiler, the package won't build -- even
> > > > > >> though the package only actually requires a C++11 compiler.
> > > > > >>
> > > > > >> How should I deal with this?
> > > > > >
> > > > > > Are you allowed to say "C++11 or C++17"?
> > > > >
> > > > > Actually I can partially answer this:  the test is not based on
> > > > > SystemRequirements, but on the log of the build, which now contains
> > > > > lines like this:
> > > > >
> > > > >    using C compiler: ?Apple clang version 12.0.0 (clang-1200.0.32.28)?
> > > > >    using C++ compiler: ?Apple clang version 12.0.0 (clang-1200.0.32.28)?
> > > > >    using C++11
> > > > >    using SDK: ?MacOSX11.1.sdk?
> > > > >
> > > > > I get "using C++11" because of this line in Makevars:
> > > > >
> > > > >    CXX_STD = CXX11
> > > > >
> > > > > So I guess the answer is to change your Makevars to make that line
> > > > > conditional on running under an old version of R.  If you figure out how
> > > > > to do that, could you post the recipe here?
> > > >
> > > > I believe this is closely related to this email [1]. Dirk and I and
> > > > Aymeric have been going through the same issue with nloptr as well.
> > > > Our current opinion is to leave it out, as it would restrict more
> > > > users to demand C++17, which is unneeded, than to have users with over
> > > > a decade old compiler which does not have C++11. Dirk and Aymeric,
> > > > please chime in if I have misstated. Regardless, according to
> > > > Professor Ripley, if you require specific features, you should mark
> > > > them in _both_ Makevars and SystemRequirements, which is implied in
> > > > the "r-devel" version of WRE which adds the words "also" in section
> > > > 1.2.4.
> > >
> > > Could you please point to the specific passage? According to [1],
> > > section 1.2.4, declaring the C++ standard in SystemRequirements is
> > > only mandatory for C++17 or later.
> > >
> > > [1] https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Using-C_002b_002b-code
> > >
> > > --
> > > I?aki ?car
>
>
>
> --
> I?aki ?car


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Feb  7 01:44:27 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 6 Feb 2023 19:44:27 -0500
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
Message-ID: <49242657-333b-2523-f26b-a9c7e408082e@gmail.com>

On 06/02/2023 3:46 p.m., Winston Chang wrote:
> I recently submitted a package to CRAN with "SystemRequirements: C++11".
> This raises the following NOTE on R-devel, and I was asked to fix and
> resubmit:
> 
> * checking C++ specification ... NOTE
>    Specified C++11: please update to current default of C++17
> 
> If I understand correctly, I have two options, neither of which will work:
> 1. Remove "SystemRequirements: C++11" entirely. The problem with this is
> that on systems with older versions of R (3.6 and below, I believe), it may
> try to compile the package with an older C++ standard, which will fail.
> 2. Update it to "SystemRequirements: C++17". The problem here is that on
> systems that don't have a C++17 compiler, the package won't build -- even
> though the package only actually requires a C++11 compiler.
> 
> How should I deal with this?

After reading the discussion here and the manuals, I think this is how 
to do it.  I'm assuming your code is compatible with both C++11 and 
C++17, but not some earlier standards.

1.  In SystemRequirements, state that it needs C++11 or higher.  That 
field is supposed to be human readable (though I think there are scripts 
that try to read it; maybe they will suggest a particular wording to use).

2.  Have a configure script (e.g. like the one Ivan posted) that 
specifies CXX_STD=CXX11 in Makevars if the R version is less than 4.0.0, 
and gives no specification otherwise (because from 4.0.0 onwards, if C++ 
is available, it will be C++11 or higher).

I think it wouldn't hurt to look through the available versions and pick 
from them, but I don't think it's supposed to be necessary.

If it eventually turns out that your code is not compatible with some 
later standard, I'm sure CRAN will let you know.

Duncan Murdoch


From w|n@tonch@ng1 @end|ng |rom gm@||@com  Tue Feb  7 05:55:29 2023
From: w|n@tonch@ng1 @end|ng |rom gm@||@com (Winston Chang)
Date: Mon, 6 Feb 2023 22:55:29 -0600
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <49242657-333b-2523-f26b-a9c7e408082e@gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
 <49242657-333b-2523-f26b-a9c7e408082e@gmail.com>
Message-ID: <CAFOpNVEvPJgTbPhe6N63zpE_m9B=twzZ=t7EwcYWRn7Exz8R7w@mail.gmail.com>

On Mon, Feb 6, 2023 at 6:44 PM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 06/02/2023 3:46 p.m., Winston Chang wrote:
> > I recently submitted a package to CRAN with "SystemRequirements: C++11".
> > This raises the following NOTE on R-devel, and I was asked to fix and
> > resubmit:
> >
> > * checking C++ specification ... NOTE
> >    Specified C++11: please update to current default of C++17
> >
> > If I understand correctly, I have two options, neither of which will
> work:
> > 1. Remove "SystemRequirements: C++11" entirely. The problem with this is
> > that on systems with older versions of R (3.6 and below, I believe), it
> may
> > try to compile the package with an older C++ standard, which will fail.
> > 2. Update it to "SystemRequirements: C++17". The problem here is that on
> > systems that don't have a C++17 compiler, the package won't build -- even
> > though the package only actually requires a C++11 compiler.
> >
> > How should I deal with this?
>
> After reading the discussion here and the manuals, I think this is how
> to do it.  I'm assuming your code is compatible with both C++11 and
> C++17, but not some earlier standards.
>
> 1.  In SystemRequirements, state that it needs C++11 or higher.  That
> field is supposed to be human readable (though I think there are scripts
> that try to read it; maybe they will suggest a particular wording to use).
>
> 2.  Have a configure script (e.g. like the one Ivan posted) that
> specifies CXX_STD=CXX11 in Makevars if the R version is less than 4.0.0,
> and gives no specification otherwise (because from 4.0.0 onwards, if C++
> is available, it will be C++11 or higher).
>
> I think it wouldn't hurt to look through the available versions and pick
> from them, but I don't think it's supposed to be necessary.
>
> If it eventually turns out that your code is not compatible with some
> later standard, I'm sure CRAN will let you know.


Now that I think about it some more, I think I can do the following:

1. In the DESCRIPTION file, remove "SystemRequirements: C++11". I believe
this field is used only for R CMD check, not for actually installing
packages. CRAN only runs R CMD check on r-oldrel, r-release, and r-devel,
and all of those versions (4.1, 4.2, and 4.3) have C++11. For older
versions of R, the package might not pass R CMD check, but it will still
install (provided there's a C++11 compiler).

2. In my case, I think I can skip the configure script. This is because I
also have GNU Make as a requirement, and it allows you to conditionally set
the CXX_STD variable only when R < 4.0, by putting this in the Makevars
file:

R_VERSION=$(shell $(R_HOME)/bin/Rscript --vanilla -e 'if (getRversion()<4)
cat("lt4") else cat("ge4")')
ifeq ($(R_VERSION), lt4)
CXX_STD=CXX11
endif


-Winston

	[[alternative HTML version deleted]]


From vdor|e @end|ng |rom gm@||@com  Tue Feb  7 00:42:57 2023
From: vdor|e @end|ng |rom gm@||@com (Vincent Dorie)
Date: Mon, 6 Feb 2023 18:42:57 -0500
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <CAL6gwnJXmh1qjOWAtknJVZB+1MMGgdchYFgy5XptfweCyXENDA@mail.gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
 <a1d3353c-7a9f-c2bf-c29c-7dda17a66c84@gmail.com>
 <94e2e2bb-85b4-f831-b3ed-b66cdd469e81@gmail.com>
 <CAL6gwn+ggnKWybzeaqO5KhdT7iq-0iDgzeOBa+sDLDp8j+qaQw@mail.gmail.com>
 <CALEXWq0NGchgJZL7VQ6KLyrA-fkrhP00pjyywnRWUCNqmA-0ow@mail.gmail.com>
 <CAL6gwnJXmh1qjOWAtknJVZB+1MMGgdchYFgy5XptfweCyXENDA@mail.gmail.com>
Message-ID: <CA+++UwT77+4Q3ZMCy0LsZdXYixfL-99Q9+qJMOhA=PXsEwjKEg@mail.gmail.com>

This might be helpful. Using autoconf and ax_cxx_compile_stdcxx (
https://www.gnu.org/software/autoconf-archive/ax_cxx_compile_stdcxx.html)
in package_root/tools/m4:

configure.ac
------------
AC_PREREQ(2.64)
AC_INIT(yourpackagename, 1.0, your at email.com)
AC_CONFIG_SRCDIR([src/main.cpp])
AC_CONFIG_AUX_DIR([tools/build-aux])
AC_CONFIG_FILES([src/Makevars])

m4_include([tools/m4/ax_cxx_compile_stdcxx.m4])

AX_CXX_COMPILE_STDCXX([11], [], [mandatory])
AX_CXX_COMPILE_STDCXX([14], [], [optional])
AX_CXX_COMPILE_STDCXX([17], [], [optional])

MAX_SUPPORTED_CXX_VERSION=CXX11
if test -z "$HAVECXX14"; then
  MAX_SUPPORTED_CXX_VERSION=CXX14
  if test -z "$HAVECXX17"; then
    MAX_SUPPORTED_CXX_VERSION=CXX17
  fi
fi

AC_SUBST(MAX_SUPPORTED_CXX_VERSION)

AC_OUTPUT

Makevars.in
-----------
CXX_STD = @MAX_SUPPORTED_CXX_VERSION@
# usual make stuff

DESCRIPTION
-----------
# usual description stuff
SystemRequirements: C++11
# add authors of compiler macro to authors field


On Mon, Feb 6, 2023 at 6:10 PM Avraham Adler <avraham.adler at gmail.com>
wrote:

> "If a package does have a src/Makevars[.win] file then also setting
> the make variable ?CXX_STD? there is recommended,"
>
> Avi
>
> On Mon, Feb 6, 2023 at 10:58 PM I?aki Ucar <iucar at fedoraproject.org>
> wrote:
> >
> > On Mon, 6 Feb 2023 at 23:27, Avraham Adler <avraham.adler at gmail.com>
> wrote:
> > >
> > > On Mon, Feb 6, 2023 at 9:46 PM Duncan Murdoch <
> murdoch.duncan at gmail.com> wrote:
> > > >
> > > > On 06/02/2023 4:01 p.m., Duncan Murdoch wrote:
> > > > > On 06/02/2023 3:46 p.m., Winston Chang wrote:
> > > > >> I recently submitted a package to CRAN with "SystemRequirements:
> C++11".
> > > > >> This raises the following NOTE on R-devel, and I was asked to fix
> and
> > > > >> resubmit:
> > > > >>
> > > > >> * checking C++ specification ... NOTE
> > > > >>     Specified C++11: please update to current default of C++17
> > > > >>
> > > > >> If I understand correctly, I have two options, neither of which
> will work:
> > > > >> 1. Remove "SystemRequirements: C++11" entirely. The problem with
> this is
> > > > >> that on systems with older versions of R (3.6 and below, I
> believe), it may
> > > > >> try to compile the package with an older C++ standard, which will
> fail.
> > > > >> 2. Update it to "SystemRequirements: C++17". The problem here is
> that on
> > > > >> systems that don't have a C++17 compiler, the package won't build
> -- even
> > > > >> though the package only actually requires a C++11 compiler.
> > > > >>
> > > > >> How should I deal with this?
> > > > >
> > > > > Are you allowed to say "C++11 or C++17"?
> > > >
> > > > Actually I can partially answer this:  the test is not based on
> > > > SystemRequirements, but on the log of the build, which now contains
> > > > lines like this:
> > > >
> > > >    using C compiler: ?Apple clang version 12.0.0
> (clang-1200.0.32.28)?
> > > >    using C++ compiler: ?Apple clang version 12.0.0
> (clang-1200.0.32.28)?
> > > >    using C++11
> > > >    using SDK: ?MacOSX11.1.sdk?
> > > >
> > > > I get "using C++11" because of this line in Makevars:
> > > >
> > > >    CXX_STD = CXX11
> > > >
> > > > So I guess the answer is to change your Makevars to make that line
> > > > conditional on running under an old version of R.  If you figure out
> how
> > > > to do that, could you post the recipe here?
> > >
> > > I believe this is closely related to this email [1]. Dirk and I and
> > > Aymeric have been going through the same issue with nloptr as well.
> > > Our current opinion is to leave it out, as it would restrict more
> > > users to demand C++17, which is unneeded, than to have users with over
> > > a decade old compiler which does not have C++11. Dirk and Aymeric,
> > > please chime in if I have misstated. Regardless, according to
> > > Professor Ripley, if you require specific features, you should mark
> > > them in _both_ Makevars and SystemRequirements, which is implied in
> > > the "r-devel" version of WRE which adds the words "also" in section
> > > 1.2.4.
> >
> > Could you please point to the specific passage? According to [1],
> > section 1.2.4, declaring the C++ standard in SystemRequirements is
> > only mandatory for C++17 or later.
> >
> > [1]
> https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Using-C_002b_002b-code
> >
> > --
> > I?aki ?car
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From |uc@r @end|ng |rom |edor@project@org  Tue Feb  7 10:54:03 2023
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Tue, 7 Feb 2023 10:54:03 +0100
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <CAL6gwnJxM5LyYs84-sJo5H+pAr3nXHb43BcYOwh+JgL=9DcmfA@mail.gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
 <a1d3353c-7a9f-c2bf-c29c-7dda17a66c84@gmail.com>
 <94e2e2bb-85b4-f831-b3ed-b66cdd469e81@gmail.com>
 <CAL6gwn+ggnKWybzeaqO5KhdT7iq-0iDgzeOBa+sDLDp8j+qaQw@mail.gmail.com>
 <CALEXWq0NGchgJZL7VQ6KLyrA-fkrhP00pjyywnRWUCNqmA-0ow@mail.gmail.com>
 <CAL6gwnJXmh1qjOWAtknJVZB+1MMGgdchYFgy5XptfweCyXENDA@mail.gmail.com>
 <CALEXWq2gX4gmZAvyjF6etw-Ymg4nDmESz6cm3TkSWvWyT5_0ZQ@mail.gmail.com>
 <CAL6gwnJxM5LyYs84-sJo5H+pAr3nXHb43BcYOwh+JgL=9DcmfA@mail.gmail.com>
Message-ID: <CALEXWq33TdEb8eL1HaNeY_h-7mDM8TrTemQHcTikeDrG-viaCw@mail.gmail.com>

On Tue, 7 Feb 2023 at 01:50, Avraham Adler <avraham.adler at gmail.com> wrote:
>
> On Tue, Feb 7, 2023 at 12:10 AM I?aki Ucar <iucar at fedoraproject.org> wrote:
> >
> > On Tue, 7 Feb 2023 at 00:09, Avraham Adler <avraham.adler at gmail.com> wrote:
> > >
> > > "If a package does have a src/Makevars[.win] file then also setting
> > > the make variable ?CXX_STD? there is recommended,"
> >
> > That doesn't refer to the SystemRequirements field.
> >
> > I?aki
> >
>
> No, but the prior sentence does. The complete excerpt is:
>
>   ::Packages without a src/Makevars or src/Makefile file may specify a
> C++ standard for code in the src directory by including something like
> ?C++14? in the ?SystemRequirements? field of the DESCRIPTION file,
> e.g.
>   ::::SystemRequirements: C++14
>  ::If a package does have a src/Makevars[.win] file then also setting
> the make variable ?CXX_STD? there is recommended, as it allows R CMD
> SHLIB to work correctly in the package?s src directory.
>
> So one is supposed to add the requirement to DESCRIPTION via
> SystemRequitements. If there is a Makevars, one should ALSO set the
> variable in there.
>
> If you wish, I can forward you personal communication with Professor
> Ripley from last week where he makes this clear as well.

No need. But with all due respect, in such a case, I do not agree with
Prof. Ripley. By no means I'm a native English speaker, but I'm quite
accustomed to the "MAY, SHOULD, MUST" language that is common in
software guidelines. And there is a clear "may" in the first sentence,
implying that you may, or may not, add this to SystemRequirements.
Therefore, with the current wording, adding the standard to
SystemRequirements is only mandatory in the case in which your minimum
supported version is above the default (which makes sense to me, BTW).

If this was meant to be always mandatory, I would suggest to the
authors of WRE to modify that section.

-- 
I?aki ?car


From Qu|r|n_St|er @end|ng |rom gmx@de  Tue Feb  7 17:08:25 2023
From: Qu|r|n_St|er @end|ng |rom gmx@de (Quirin Stier)
Date: Tue, 7 Feb 2023 17:08:25 +0100
Subject: [R-pkg-devel] R OpenCL on an AMD GPU
Message-ID: <cc5f12ed-0df3-9c27-842c-7ebc2dd5b5a9@gmx.de>

Hi,

I am trying to set up the CRAN package "OpenCL" to run on a Windows 10
machine with an AMD GPU (Radeon 7900 XTX).

I installed the AMD drivers (which carry the OpenCL.dll) and the
installation of OpenCL in R didnt work. So I also downloaded the AMD SDK
to set up the environment variables OCL64LIB, OCL32LIB and OCLINC. The
installation worked, but the built package was broke (OpenCL kernels
didnt execute due to a multiplicity of errors - the OpenCL set up must
have been wrong).

The installation of OpenCL was done with install.packages("OpenCL",
INSTALL_opts = "--no-test-load") trying it with and without the
install_opts option.

Does anyone have a clue?

Best regards,

Quirin


From @|mon@urb@nek @end|ng |rom R-project@org  Tue Feb  7 19:46:54 2023
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Wed, 8 Feb 2023 07:46:54 +1300
Subject: [R-pkg-devel] R OpenCL on an AMD GPU
In-Reply-To: <cc5f12ed-0df3-9c27-842c-7ebc2dd5b5a9@gmx.de>
References: <cc5f12ed-0df3-9c27-842c-7ebc2dd5b5a9@gmx.de>
Message-ID: <5E41C644-96EF-408B-8B42-952629B64B09@R-project.org>

Quirin,

this is a contributed package question, so you should either use the GitHub issues (https://github.com/s-u/OpenCL/issues) for the package or contact the maintainer (me). But before you do so, you have to provide a lot more details including exact code you used and the full output of the errors you saw. Finally, on Windows, make sure you refer to the instructions posted here to pre-load your run-time DLL: https://github.com/s-u/OpenCL/issues/6#issuecomment-899114747

Cheers,
Simon


> On Feb 8, 2023, at 5:08 AM, Quirin Stier <Quirin_Stier at gmx.de> wrote:
> 
> Hi,
> 
> I am trying to set up the CRAN package "OpenCL" to run on a Windows 10
> machine with an AMD GPU (Radeon 7900 XTX).
> 
> I installed the AMD drivers (which carry the OpenCL.dll) and the
> installation of OpenCL in R didnt work. So I also downloaded the AMD SDK
> to set up the environment variables OCL64LIB, OCL32LIB and OCLINC. The
> installation worked, but the built package was broke (OpenCL kernels
> didnt execute due to a multiplicity of errors - the OpenCL set up must
> have been wrong).
> 
> The installation of OpenCL was done with install.packages("OpenCL",
> INSTALL_opts = "--no-test-load") trying it with and without the
> install_opts option.
> 
> Does anyone have a clue?
> 
> Best regards,
> 
> Quirin
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 


From |gor|@|tu| @end|ng |rom gm@||@com  Wed Feb  8 15:32:36 2023
From: |gor|@|tu| @end|ng |rom gm@||@com (Igor L)
Date: Wed, 8 Feb 2023 11:32:36 -0300
Subject: [R-pkg-devel] Problem with package containing spatial data
Message-ID: <CAHGVjrktvXFs=RA+sMTQiKTq=4v91wtt8tAAU2Y8ALWOJ=R4xA@mail.gmail.com>

Hello all,

I'm developing a package that contains spatial data about public safety in
Rio de Janeiro.

The problem is that when I use the usethis::use_data function which
transforms the shapefile data into a file with the .rda extension, I cannot
use the geometry attribute to create a map.

E.g.:

# Raw-data script:

spatial_aisp <- sf::st_read('data-raw/shp_aisp/lm_aisp_2019.shp')

plot(spatial_aisp) # works

# Same data from .rda file after use usethis::use_data(spatial_aisp,
overwrite = TRUE)

x <- ispdata::spatial_aisp

plot(x) # do not work

Error message:
Error in data.matrix(x) :
  'list' object cannot be coerced to type 'double'


This is happening with all spatial data in the package. I'm using lazydata:
true and have already disabled file compression options, but the problem
persists.

Any ideas?

Scripts can be accessed at https://github.com/igorlaltuf/ispdata

Thanks!
-- 
*Igor Laltuf Marques*
Economist (UFF)
Master in Urban and Regional Planning (IPPUR-UFRJ)
Researcher at ETTERN and CiDMob Laboratories
https://igorlaltuf.github.io/

	[[alternative HTML version deleted]]


From w|n@tonch@ng1 @end|ng |rom gm@||@com  Wed Feb  8 15:35:08 2023
From: w|n@tonch@ng1 @end|ng |rom gm@||@com (Winston Chang)
Date: Wed, 8 Feb 2023 08:35:08 -0600
Subject: [R-pkg-devel] How to update "SystemRequirements: C++11"?
In-Reply-To: <CAFOpNVEvPJgTbPhe6N63zpE_m9B=twzZ=t7EwcYWRn7Exz8R7w@mail.gmail.com>
References: <CAFOpNVFTGcrsURZC9TOv=KSceKr_WFPsMV0TJoCZKrppkkSFdw@mail.gmail.com>
 <49242657-333b-2523-f26b-a9c7e408082e@gmail.com>
 <CAFOpNVEvPJgTbPhe6N63zpE_m9B=twzZ=t7EwcYWRn7Exz8R7w@mail.gmail.com>
Message-ID: <CAFOpNVEjnrVZ=dGc01zPTK=MkTS6oNDCVc1Af4aYKdHPCjx-vQ@mail.gmail.com>

>
> Now that I think about it some more, I think I can do the following:
>
> 1. In the DESCRIPTION file, remove "SystemRequirements: C++11". I believe
> this field is used only for R CMD check, not for actually installing
> packages. CRAN only runs R CMD check on r-oldrel, r-release, and r-devel,
> and all of those versions (4.1, 4.2, and 4.3) have C++11. For older
> versions of R, the package might not pass R CMD check, but it will still
> install (provided there's a C++11 compiler).
>
> 2. In my case, I think I can skip the configure script. This is because I
> also have GNU Make as a requirement, and it allows you to conditionally set
> the CXX_STD variable only when R < 4.0, by putting this in the Makevars
> file:
>
> R_VERSION=$(shell $(R_HOME)/bin/Rscript --vanilla -e 'if (getRversion()<4)
> cat("lt4") else cat("ge4")')
> ifeq ($(R_VERSION), lt4)
> CXX_STD=CXX11
> endif
>
>
I found that this strategy doesn't work. It turns out that R detects the
C++ version by simply grepping for CXX_STD in  the Makevars file, so even
with my fancy ifeq() statement, it still thinks that the package uses C++11.

So now my plan is to simply remove "CXX_STD" from Makevars and
"SystemRequirements: C++11" from DESCRIPTION. My understanding is that this
will cause the package to no longer build on R 3.5, but as of R 3.6.2,
C++11 became the default, so it should build on that version of R or higher.

-Winston

	[[alternative HTML version deleted]]


From |embry @end|ng |rom ecocc@@com  Wed Feb  8 20:03:23 2023
From: |embry @end|ng |rom ecocc@@com (EcoC2S - Irucka Embry)
Date: Wed, 08 Feb 2023 13:03:23 -0600
Subject: [R-pkg-devel] CRAN Package Submission Policy
In-Reply-To: <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
References: <dc713e6d764976c5f370cfb05ba38e92@ecoccs.com>
 <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
 <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
Message-ID: <5017c9b9f2222982e6031a5d3d83ea5b@ecoccs.com>

Hi, I want to share the following information due to some of the 
feedback that I received with regards to the extreme lag on getting a 
response to my USA.state.boundaries package submissions.

The following text is taken verbatim from 
https://cran.r-project.org/web/packages/policies.html:

Submission

...

In more detail:

...

Once uploaded, no further submissions of that package should be made 
whilst the uploaded version is pending processing (which may take a few 
days) and you have not received a reply from a CRAN maintainer.




There is no question here, I just want to share information that will 
hopefully be useful to all of the R developers.

Thank you.

Irucka Embry



-- 
--
No fear, Only Love! / ?No temas, solamente amor!
-Irucka Ajani Embry, 15 March 2020

Family Partners:
http://www.sustainlex.org/
https://www.schoolingsolutions.com/

---------------------------------------------------------------------------------------------------------------

The business collaboration between EConsulting (tm)
[https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to 
Nature.

Getting Back to Nature LocalHarvest --
https://www.localharvest.org/getting-back-to-nature-M73453
Getting Back to Nature -- https://www.gettingback2nature.farm/

-- Irucka and his twin brother, Obiora, are featured in the Middle
Tennessee Local Table Magazine Annual issue. The article discusses their
family farm history and the current work that they are doing under 
Getting
Back to Nature. The full magazine can be found here [the article begins 
on
page 18 of the PDF document]:

https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf

-- Obiora and Irucka were interviewed separately in early 2020 for the
Natural Resources Defense Council's (NRDC) "Regenerative Agriculture: 
Farm
Policy for the 21st Century: Policy Recommendations to Advance 
Regenerative
Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen Lee.
The PDF report is available below:

https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf

EcoC2S -- https://www.ecoccs.com/
Principal, Irucka Embry, EIT

Services:
Growing Food
Healthy Living Mentor
Data Analysis with R
R Training
Chemistry and Mathematics Tutoring
Free/Libre and Open Source Software (FLOSS) Consultation


From @d@mh@p@rk@ @end|ng |rom gm@||@com  Thu Feb  9 00:46:50 2023
From: @d@mh@p@rk@ @end|ng |rom gm@||@com (Adam H. Sparks)
Date: Thu, 9 Feb 2023 07:46:50 +0800
Subject: [R-pkg-devel] Problem with package containing spatial data
In-Reply-To: <CAHGVjrktvXFs=RA+sMTQiKTq=4v91wtt8tAAU2Y8ALWOJ=R4xA@mail.gmail.com>
References: <CAHGVjrktvXFs=RA+sMTQiKTq=4v91wtt8tAAU2Y8ALWOJ=R4xA@mail.gmail.com>
Message-ID: <72C586E4-2D6F-4CE0-B256-5A47F9AC26C4@gmail.com>

Hi Igor,
I?ve a couple packages that have spatial data in them that I maintain. I?ve opted to package up the data as a geopackage file and import it as an {sf} object. Edzer Pebesma suggests this to circumvent changes in the {sf} package from affecting native {sf} objects that are distributed as part of a package. Maybe this is an option for you?

In https://github.com/adamhsparks/extractOz, see /inst/extdata for the geopackage file and https://github.com/adamhsparks/extractOz/blob/main/R/data.R for handling the data importing and making available in the R session on package load.

Best,
Adam

> On 8 Feb 2023, at 10:32 pm, Igor L <igorlaltuf at gmail.com> wrote:
> 
> Hello all,
> 
> I'm developing a package that contains spatial data about public safety in
> Rio de Janeiro.
> 
> The problem is that when I use the usethis::use_data function which
> transforms the shapefile data into a file with the .rda extension, I cannot
> use the geometry attribute to create a map.
> 
> E.g.:
> 
> # Raw-data script:
> 
> spatial_aisp <- sf::st_read('data-raw/shp_aisp/lm_aisp_2019.shp')
> 
> plot(spatial_aisp) # works
> 
> # Same data from .rda file after use usethis::use_data(spatial_aisp,
> overwrite = TRUE)
> 
> x <- ispdata::spatial_aisp
> 
> plot(x) # do not work
> 
> Error message:
> Error in data.matrix(x) :
>  'list' object cannot be coerced to type 'double'
> 
> 
> This is happening with all spatial data in the package. I'm using lazydata:
> true and have already disabled file compression options, but the problem
> persists.
> 
> Any ideas?
> 
> Scripts can be accessed at https://github.com/igorlaltuf/ispdata
> 
> Thanks!
> -- 
> *Igor Laltuf Marques*
> Economist (UFF)
> Master in Urban and Regional Planning (IPPUR-UFRJ)
> Researcher at ETTERN and CiDMob Laboratories
> https://igorlaltuf.github.io/
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Feb  9 09:56:24 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 9 Feb 2023 11:56:24 +0300
Subject: [R-pkg-devel] Problem with package containing spatial data
In-Reply-To: <CAHGVjrktvXFs=RA+sMTQiKTq=4v91wtt8tAAU2Y8ALWOJ=R4xA@mail.gmail.com>
References: <CAHGVjrktvXFs=RA+sMTQiKTq=4v91wtt8tAAU2Y8ALWOJ=R4xA@mail.gmail.com>
Message-ID: <20230209115624.71f594cd@arachnoid>

? Wed, 8 Feb 2023 11:32:36 -0300
Igor L <igorlaltuf at gmail.com> ?????:

> spatial_aisp <- sf::st_read('data-raw/shp_aisp/lm_aisp_2019.shp')
> 
> plot(spatial_aisp) # works
> 
> # Same data from .rda file after use usethis::use_data(spatial_aisp,
> overwrite = TRUE)
> 
> x <- ispdata::spatial_aisp
> 
> plot(x) # do not work

Does this break in a new R session, but start working when you load the
sf namespace? I think that your package needs to depend on sf in order
for this to work. Specifying it in Imports may be enough to make the
plot.sf S3 method available to the user.

You may encounter other problems if you go this way, like R CMD check
complaining that you don't use the package you're importing. Loading
the data from a file on demand would also load the sf namespace and
thus solve the problem.

-- 
Best regards,
Ivan


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Feb  9 11:11:10 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 9 Feb 2023 05:11:10 -0500
Subject: [R-pkg-devel] Problem with package containing spatial data
In-Reply-To: <20230209115624.71f594cd@arachnoid>
References: <CAHGVjrktvXFs=RA+sMTQiKTq=4v91wtt8tAAU2Y8ALWOJ=R4xA@mail.gmail.com>
 <20230209115624.71f594cd@arachnoid>
Message-ID: <26a37def-b1ab-0e75-d71a-2de2607b76e1@gmail.com>

On 09/02/2023 3:56 a.m., Ivan Krylov wrote:
> ? Wed, 8 Feb 2023 11:32:36 -0300
> Igor L <igorlaltuf at gmail.com> ?????:
> 
>> spatial_aisp <- sf::st_read('data-raw/shp_aisp/lm_aisp_2019.shp')
>>
>> plot(spatial_aisp) # works
>>
>> # Same data from .rda file after use usethis::use_data(spatial_aisp,
>> overwrite = TRUE)
>>
>> x <- ispdata::spatial_aisp
>>
>> plot(x) # do not work
> 
> Does this break in a new R session, but start working when you load the
> sf namespace? I think that your package needs to depend on sf in order
> for this to work. Specifying it in Imports may be enough to make the
> plot.sf S3 method available to the user.

Specifying a package in the Imports field of DESCRIPTION guarantees that 
it will be available to load, but doesn't load it.  Importing something 
from it via the NAMESPACE triggers a load, as does executing code like 
pkg::fn, or explicitly calling loadNamespace("pkg"), or loading a 
package that does one of these things.


> You may encounter other problems if you go this way, like R CMD check
> complaining that you don't use the package you're importing. Loading
> the data from a file on demand would also load the sf namespace and
> thus solve the problem.

Workarounds for the check complaints are discussed here, among other 
places:  https://stackoverflow.com/a/75384338/2554330 .

Duncan Murdoch


From @|ex@ndre@court|o| @end|ng |rom gm@||@com  Thu Feb  9 18:41:40 2023
From: @|ex@ndre@court|o| @end|ng |rom gm@||@com (Alexandre Courtiol)
Date: Thu, 9 Feb 2023 18:41:40 +0100
Subject: [R-pkg-devel] Problem with package containing spatial data
In-Reply-To: <26a37def-b1ab-0e75-d71a-2de2607b76e1@gmail.com>
References: <CAHGVjrktvXFs=RA+sMTQiKTq=4v91wtt8tAAU2Y8ALWOJ=R4xA@mail.gmail.com>
 <20230209115624.71f594cd@arachnoid>
 <26a37def-b1ab-0e75-d71a-2de2607b76e1@gmail.com>
Message-ID: <CAERMt4dWH4MXTH1ge7j+LaKos2P0WyUdTqViptVdadGOwattgg@mail.gmail.com>

Hi Igor,

I had the same issue using terra rather than sf a couple of weeks ago.

I thought of solving the issue as follow:


   1.

   store the shapefiles under extdata.
   2.

   create a function that loads the files:

.build_internal_files <- function() {
  ## This function should not be called by the user.
  ## It performs the lazy loading of the data since terra cannot
handle rda files
  assign("CountryBorders",
terra::vect(system.file("extdata/CountryBorders.shp", package =
"IsoriX")), envir = as.environment("package:IsoriX"))
  assign("OceanMask", terra::vect(system.file("extdata/OceanMask.shp",
package = "IsoriX")), envir = as.environment("package:IsoriX"))
}


   1. call that function automatically upon attach using .onAttach():

.onAttach <- function(libname, pkgname) {
    .build_internal_files() ## lazy loading of the internal data
}

It seems to work...

Note that .onAttach() is a standard way of defining a function that is
recognised by R and ran when the package is attached.

++

Alex

On Thu, 9 Feb 2023 at 11:11, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 09/02/2023 3:56 a.m., Ivan Krylov wrote:
> > ? Wed, 8 Feb 2023 11:32:36 -0300
> > Igor L <igorlaltuf at gmail.com> ?????:
> >
> >> spatial_aisp <- sf::st_read('data-raw/shp_aisp/lm_aisp_2019.shp')
> >>
> >> plot(spatial_aisp) # works
> >>
> >> # Same data from .rda file after use usethis::use_data(spatial_aisp,
> >> overwrite = TRUE)
> >>
> >> x <- ispdata::spatial_aisp
> >>
> >> plot(x) # do not work
> >
> > Does this break in a new R session, but start working when you load the
> > sf namespace? I think that your package needs to depend on sf in order
> > for this to work. Specifying it in Imports may be enough to make the
> > plot.sf S3 method available to the user.
>
> Specifying a package in the Imports field of DESCRIPTION guarantees that
> it will be available to load, but doesn't load it.  Importing something
> from it via the NAMESPACE triggers a load, as does executing code like
> pkg::fn, or explicitly calling loadNamespace("pkg"), or loading a
> package that does one of these things.
>
>
> > You may encounter other problems if you go this way, like R CMD check
> > complaining that you don't use the package you're importing. Loading
> > the data from a file on demand would also load the sf namespace and
> > thus solve the problem.
>
> Workarounds for the check complaints are discussed here, among other
> places:  https://stackoverflow.com/a/75384338/2554330 .
>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


-- 
Alexandre Courtiol, www.datazoogang.de

	[[alternative HTML version deleted]]


From m|keb|@z@n|n @end|ng |rom gm@||@com  Thu Feb  9 16:27:04 2023
From: m|keb|@z@n|n @end|ng |rom gm@||@com (Mike Blazanin)
Date: Thu, 9 Feb 2023 10:27:04 -0500
Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer
Message-ID: <CAEbuDvKgn6YQM9LZRozRP_hzU0RXZEjVoPY4VVJu58xaMZrmvA@mail.gmail.com>

Hi all, my package gcplyr has several vignettes which, from CRAN, appear
garbled when opened with Firefox's pdf viewer (
https://cran.r-project.org/web/packages/gcplyr/index.html). Specifically,
instead of regular characters, there are numerous black-outlined white
boxes with text inside like "EO 88" or "EO 55". This doesn't occur with the
pdf vignettes on Github (https://github.com/mikeblazanin/gcplyr/). This
also doesn't occur when CRAN pdfs are opened with Chrome's pdf viewer or
Microsoft Edge's pdf viewer, nor when files are downloaded from CRAN and
opened with a local pdf viewer.

The issue was documented here:
https://github.com/mikeblazanin/gcplyr/issues/112

Anyone have any suggestions for what could be causing this?

Thanks!
Mike Blazanin

	[[alternative HTML version deleted]]


From |gor|@|tu| @end|ng |rom gm@||@com  Thu Feb  9 20:04:21 2023
From: |gor|@|tu| @end|ng |rom gm@||@com (Igor L)
Date: Thu, 9 Feb 2023 16:04:21 -0300
Subject: [R-pkg-devel] Problem with package containing spatial data
In-Reply-To: <CAERMt4dWH4MXTH1ge7j+LaKos2P0WyUdTqViptVdadGOwattgg@mail.gmail.com>
References: <CAHGVjrktvXFs=RA+sMTQiKTq=4v91wtt8tAAU2Y8ALWOJ=R4xA@mail.gmail.com>
 <20230209115624.71f594cd@arachnoid>
 <26a37def-b1ab-0e75-d71a-2de2607b76e1@gmail.com>
 <CAERMt4dWH4MXTH1ge7j+LaKos2P0WyUdTqViptVdadGOwattgg@mail.gmail.com>
Message-ID: <CAHGVjrkq5XoMc41tPFoy-1WjhfFFTpU3ib9vNNOT5FZ24uGEig@mail.gmail.com>

Thank you all for your help.

Adam, I followed your suggestion, but I still can't figure out why the data
is only available locally when I run the devtools::load_all() function.

When I install the package from GitHub, the data does not appear (even
using the data() function).

Extdata: https://github.com/igorlaltuf/ispdata/tree/main/inst/extdata
Import: https://github.com/igorlaltuf/ispdata/blob/main/R/spatial_cisp.R

And is there any way to reduce the size of files in gpkg format? The
package increased from 5 to 10 megabytes. I tried to make it smaller with
the function sf::st_write("inst/extdata/spatial_aisp.gpkg", compress =
"deflate", append = F), but the size remained the same.

Thanks again for all the help.

Em qui., 9 de fev. de 2023 ?s 14:41, Alexandre Courtiol <
alexandre.courtiol at gmail.com> escreveu:

> Hi Igor,
>
> I had the same issue using terra rather than sf a couple of weeks ago.
>
> I thought of solving the issue as follow:
>
>
>    1.
>
>    store the shapefiles under extdata.
>    2.
>
>    create a function that loads the files:
>
> .build_internal_files <- function() {
>   ## This function should not be called by the user.
>   ## It performs the lazy loading of the data since terra cannot handle rda files
>   assign("CountryBorders", terra::vect(system.file("extdata/CountryBorders.shp", package = "IsoriX")), envir = as.environment("package:IsoriX"))
>   assign("OceanMask", terra::vect(system.file("extdata/OceanMask.shp", package = "IsoriX")), envir = as.environment("package:IsoriX"))
> }
>
>
>    1. call that function automatically upon attach using .onAttach():
>
> .onAttach <- function(libname, pkgname) {
>     .build_internal_files() ## lazy loading of the internal data
> }
>
> It seems to work...
>
> Note that .onAttach() is a standard way of defining a function that is
> recognised by R and ran when the package is attached.
>
> ++
>
> Alex
>
> On Thu, 9 Feb 2023 at 11:11, Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
>
>> On 09/02/2023 3:56 a.m., Ivan Krylov wrote:
>> > ? Wed, 8 Feb 2023 11:32:36 -0300
>> > Igor L <igorlaltuf at gmail.com> ?????:
>> >
>> >> spatial_aisp <- sf::st_read('data-raw/shp_aisp/lm_aisp_2019.shp')
>> >>
>> >> plot(spatial_aisp) # works
>> >>
>> >> # Same data from .rda file after use usethis::use_data(spatial_aisp,
>> >> overwrite = TRUE)
>> >>
>> >> x <- ispdata::spatial_aisp
>> >>
>> >> plot(x) # do not work
>> >
>> > Does this break in a new R session, but start working when you load the
>> > sf namespace? I think that your package needs to depend on sf in order
>> > for this to work. Specifying it in Imports may be enough to make the
>> > plot.sf S3 method available to the user.
>>
>> Specifying a package in the Imports field of DESCRIPTION guarantees that
>> it will be available to load, but doesn't load it.  Importing something
>> from it via the NAMESPACE triggers a load, as does executing code like
>> pkg::fn, or explicitly calling loadNamespace("pkg"), or loading a
>> package that does one of these things.
>>
>>
>> > You may encounter other problems if you go this way, like R CMD check
>> > complaining that you don't use the package you're importing. Loading
>> > the data from a file on demand would also load the sf namespace and
>> > thus solve the problem.
>>
>> Workarounds for the check complaints are discussed here, among other
>> places:  https://stackoverflow.com/a/75384338/2554330 .
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
>
> --
> Alexandre Courtiol, www.datazoogang.de
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Feb  9 21:18:02 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 9 Feb 2023 15:18:02 -0500
Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer
In-Reply-To: <CAEbuDvKgn6YQM9LZRozRP_hzU0RXZEjVoPY4VVJu58xaMZrmvA@mail.gmail.com>
References: <CAEbuDvKgn6YQM9LZRozRP_hzU0RXZEjVoPY4VVJu58xaMZrmvA@mail.gmail.com>
Message-ID: <a2625536-5efe-dfd5-c2c5-8d63ce3b1783@gmail.com>

On 09/02/2023 10:27 a.m., Mike Blazanin wrote:
> Hi all, my package gcplyr has several vignettes which, from CRAN, appear
> garbled when opened with Firefox's pdf viewer (
> https://cran.r-project.org/web/packages/gcplyr/index.html). Specifically,
> instead of regular characters, there are numerous black-outlined white
> boxes with text inside like "EO 88" or "EO 55". This doesn't occur with the
> pdf vignettes on Github (https://github.com/mikeblazanin/gcplyr/). This
> also doesn't occur when CRAN pdfs are opened with Chrome's pdf viewer or
> Microsoft Edge's pdf viewer, nor when files are downloaded from CRAN and
> opened with a local pdf viewer.

I don't see a problem in Firefox 109.0.1 on a Mac.  Maybe the "0.1" is a 
bug fix?  Or maybe I looked in the wrong place.  Could you be very 
specific, i.e. URL, page, line.


Duncan Murdoch


> 
> The issue was documented here:
> https://github.com/mikeblazanin/gcplyr/issues/112
> 
> Anyone have any suggestions for what could be causing this?
> 
> Thanks!
> Mike Blazanin
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Feb  9 21:21:11 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 9 Feb 2023 15:21:11 -0500
Subject: [R-pkg-devel] Problem with package containing spatial data
In-Reply-To: <CAERMt4dWH4MXTH1ge7j+LaKos2P0WyUdTqViptVdadGOwattgg@mail.gmail.com>
References: <CAHGVjrktvXFs=RA+sMTQiKTq=4v91wtt8tAAU2Y8ALWOJ=R4xA@mail.gmail.com>
 <20230209115624.71f594cd@arachnoid>
 <26a37def-b1ab-0e75-d71a-2de2607b76e1@gmail.com>
 <CAERMt4dWH4MXTH1ge7j+LaKos2P0WyUdTqViptVdadGOwattgg@mail.gmail.com>
Message-ID: <f681abff-7084-8f60-688d-02f2e83b2622@gmail.com>

On 09/02/2023 12:41 p.m., Alexandre Courtiol wrote:
> Hi Igor,
> 
> I had the same issue using terra rather than sf a couple of weeks ago.
> 
> I thought of solving the issue as follow:
> 
>  1.
> 
>     store the shapefiles under extdata.
> 
>  2.
> 
>     create a function that loads the files:
> 
> .build_internal_files  <-  function() {
>    ## This function should not be called by the user.
>    ## It performs the lazy loading of the data since terra cannot handle 
> rda files
>    assign("CountryBorders",terra::vect(system.file("extdata/CountryBorders.shp",package  =  "IsoriX")),envir  =  as.environment("package:IsoriX"))
>    assign("OceanMask",terra::vect(system.file("extdata/OceanMask.shp",package  =  "IsoriX")),envir  =  as.environment("package:IsoriX"))
> }
> 
>  3. call that function automatically upon attach using |.onAttach()|:
> 
> .onAttach  <-  function(libname,pkgname) {
>      .build_internal_files()## lazy loading of the internal data
> }
> 
> It seems to work...
> 
> Note that .onAttach() is a standard way of defining a function that is 
> recognised by R and ran when the package is attached.

Would these files ever be used when your package is not attached, e.g. 
through a function imported by a different package?  If so, you should 
use .onLoad(), not .onAttach().

Duncan Murdoch

> 
> ++
> 
> Alex
> 
> 
> On Thu, 9 Feb 2023 at 11:11, Duncan Murdoch <murdoch.duncan at gmail.com 
> <mailto:murdoch.duncan at gmail.com>> wrote:
> 
>     On 09/02/2023 3:56 a.m., Ivan Krylov wrote:
>      > ? Wed, 8 Feb 2023 11:32:36 -0300
>      > Igor L <igorlaltuf at gmail.com <mailto:igorlaltuf at gmail.com>> ?????:
>      >
>      >> spatial_aisp <- sf::st_read('data-raw/shp_aisp/lm_aisp_2019.shp')
>      >>
>      >> plot(spatial_aisp) # works
>      >>
>      >> # Same data from .rda file after use usethis::use_data(spatial_aisp,
>      >> overwrite = TRUE)
>      >>
>      >> x <- ispdata::spatial_aisp
>      >>
>      >> plot(x) # do not work
>      >
>      > Does this break in a new R session, but start working when you
>     load the
>      > sf namespace? I think that your package needs to depend on sf in
>     order
>      > for this to work. Specifying it in Imports may be enough to make the
>      > plot.sf S3 method available to the user.
> 
>     Specifying a package in the Imports field of DESCRIPTION guarantees
>     that
>     it will be available to load, but doesn't load it.? Importing something
>     from it via the NAMESPACE triggers a load, as does executing code like
>     pkg::fn, or explicitly calling loadNamespace("pkg"), or loading a
>     package that does one of these things.
> 
> 
>      > You may encounter other problems if you go this way, like R CMD check
>      > complaining that you don't use the package you're importing. Loading
>      > the data from a file on demand would also load the sf namespace and
>      > thus solve the problem.
> 
>     Workarounds for the check complaints are discussed here, among other
>     places: https://stackoverflow.com/a/75384338/2554330
>     <https://stackoverflow.com/a/75384338/2554330> .
> 
>     Duncan Murdoch
> 
>     ______________________________________________
>     R-package-devel at r-project.org <mailto:R-package-devel at r-project.org>
>     mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> 
> 
> 
> -- 
> Alexandre Courtiol, www.datazoogang.de <http://www.datazoogang.de>


From ||u|@@rev|||@ @end|ng |rom gm@||@com  Fri Feb 10 13:03:49 2023
From: ||u|@@rev|||@ @end|ng |rom gm@||@com (=?UTF-8?Q?Llu=C3=ADs_Revilla?=)
Date: Fri, 10 Feb 2023 13:03:49 +0100
Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer
In-Reply-To: <a2625536-5efe-dfd5-c2c5-8d63ce3b1783@gmail.com>
References: <CAEbuDvKgn6YQM9LZRozRP_hzU0RXZEjVoPY4VVJu58xaMZrmvA@mail.gmail.com>
 <a2625536-5efe-dfd5-c2c5-8d63ce3b1783@gmail.com>
Message-ID: <CAN+W6_tihLH3a3OFShx_Q4fD3v_W3i7TJ-beRVF1PdyDy86j4w@mail.gmail.com>

Hi,

I can't read any vignettes of gcplyr in Firefox 109.0.1 from a Windows 10.
But sorry, I don't have any solution.

On Thu, 9 Feb 2023 at 21:18, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 09/02/2023 10:27 a.m., Mike Blazanin wrote:
> > Hi all, my package gcplyr has several vignettes which, from CRAN, appear
> > garbled when opened with Firefox's pdf viewer (
> > https://cran.r-project.org/web/packages/gcplyr/index.html).
> Specifically,
> > instead of regular characters, there are numerous black-outlined white
> > boxes with text inside like "EO 88" or "EO 55". This doesn't occur with
> the
> > pdf vignettes on Github (https://github.com/mikeblazanin/gcplyr/). This
> > also doesn't occur when CRAN pdfs are opened with Chrome's pdf viewer or
> > Microsoft Edge's pdf viewer, nor when files are downloaded from CRAN and
> > opened with a local pdf viewer.
>
> I don't see a problem in Firefox 109.0.1 on a Mac.  Maybe the "0.1" is a
> bug fix?  Or maybe I looked in the wrong place.  Could you be very
> specific, i.e. URL, page, line.
>
>
> Duncan Murdoch
>
>
> >
> > The issue was documented here:
> > https://github.com/mikeblazanin/gcplyr/issues/112
> >
> > Anyone have any suggestions for what could be causing this?
> >
> > Thanks!
> > Mike Blazanin
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From j|nghu@zh@o @end|ng |rom hotm@||@com  Fri Feb 10 09:23:00 2023
From: j|nghu@zh@o @end|ng |rom hotm@||@com (jing hua zhao)
Date: Fri, 10 Feb 2023 08:23:00 +0000
Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer
In-Reply-To: <CAEbuDvKgn6YQM9LZRozRP_hzU0RXZEjVoPY4VVJu58xaMZrmvA@mail.gmail.com>
References: <CAEbuDvKgn6YQM9LZRozRP_hzU0RXZEjVoPY4VVJu58xaMZrmvA@mail.gmail.com>
Message-ID: <CWLP123MB4466FF7E7457266097A85896A5DE9@CWLP123MB4466.GBRP123.PROD.OUTLOOK.COM>

This is apparently  due to compression as needed fort package building, e.g., R CMD build --compact-vignettes=both --md5 --resave-data --log gap so mine has the same problem: https://cran.r-project.org/web/packages/gap/vignettes/jss.pdf
________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Mike Blazanin <mikeblazanin at gmail.com>
Sent: 09 February 2023 15:27
To: r-package-devel at r-project.org <r-package-devel at r-project.org>
Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer

Hi all, my package gcplyr has several vignettes which, from CRAN, appear
garbled when opened with Firefox's pdf viewer (
https://cran.r-project.org/web/packages/gcplyr/index.html). Specifically,
instead of regular characters, there are numerous black-outlined white
boxes with text inside like "EO 88" or "EO 55". This doesn't occur with the
pdf vignettes on Github (https://github.com/mikeblazanin/gcplyr/). This
also doesn't occur when CRAN pdfs are opened with Chrome's pdf viewer or

opened with a local pdf viewer.

The issue was documented here:
https://github.com/mikeblazanin/gcplyr/issues/112

Anyone have any suggestions for what could be causing this?

Thanks!
Mike Blazanin

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From m|keb|@z@n|n @end|ng |rom gm@||@com  Fri Feb 10 17:29:38 2023
From: m|keb|@z@n|n @end|ng |rom gm@||@com (Mike Blazanin)
Date: Fri, 10 Feb 2023 11:29:38 -0500
Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer
In-Reply-To: <CANOYX1T5Vj=L+eWDqDHGXma5Verg6xN=jwCf-j=COB0mAGjQ0g@mail.gmail.com>
References: <CAEbuDvKgn6YQM9LZRozRP_hzU0RXZEjVoPY4VVJu58xaMZrmvA@mail.gmail.com>
 <CWLP123MB4466FF7E7457266097A85896A5DE9@CWLP123MB4466.GBRP123.PROD.OUTLOOK.COM>
 <CANOYX1T5Vj=L+eWDqDHGXma5Verg6xN=jwCf-j=COB0mAGjQ0g@mail.gmail.com>
Message-ID: <CAEbuDvKHCUXzv0LmnDyDjT+SM0qrLXr2-izH9vr8HEHM+6R4yw@mail.gmail.com>

Awesome, thanks so much!

Mike

On Fri, Feb 10, 2023 at 11:22 AM Shota Ochi <shotaochi1990 at gmail.com> wrote:

> I reported the bug to bugzilla.
>
> https://bugzilla.mozilla.org/show_bug.cgi?id=1816128
>
> The bug is already fixed.
> We should use higher version of firefox or firefox nightly.
>
> 2023?2?10?(?) 22:23 jing hua zhao <jinghuazhao at hotmail.com>:
>
>> This is apparently  due to compression as needed fort package building,
>> e.g., R CMD build --compact-vignettes=both --md5 --resave-data --log gap so
>> mine has the same problem:
>> https://cran.r-project.org/web/packages/gap/vignettes/jss.pdf
>> ________________________________
>> From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf
>> of Mike Blazanin <mikeblazanin at gmail.com>
>> Sent: 09 February 2023 15:27
>> To: r-package-devel at r-project.org <r-package-devel at r-project.org>
>> Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer
>>
>> Hi all, my package gcplyr has several vignettes which, from CRAN, appear
>> garbled when opened with Firefox's pdf viewer (
>> https://cran.r-project.org/web/packages/gcplyr/index.html). Specifically,
>> instead of regular characters, there are numerous black-outlined white
>> boxes with text inside like "EO 88" or "EO 55". This doesn't occur with
>> the
>> pdf vignettes on Github (https://github.com/mikeblazanin/gcplyr/). This
>> also doesn't occur when CRAN pdfs are opened with Chrome's pdf viewer or
>>
>> opened with a local pdf viewer.
>>
>> The issue was documented here:
>> https://github.com/mikeblazanin/gcplyr/issues/112
>>
>> Anyone have any suggestions for what could be causing this?
>>
>> Thanks!
>> Mike Blazanin
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>

-- 
Mike Blazanin

	[[alternative HTML version deleted]]


From @hot@och|1990 @end|ng |rom gm@||@com  Fri Feb 10 17:22:14 2023
From: @hot@och|1990 @end|ng |rom gm@||@com (Shota Ochi)
Date: Sat, 11 Feb 2023 01:22:14 +0900
Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer
In-Reply-To: <CWLP123MB4466FF7E7457266097A85896A5DE9@CWLP123MB4466.GBRP123.PROD.OUTLOOK.COM>
References: <CAEbuDvKgn6YQM9LZRozRP_hzU0RXZEjVoPY4VVJu58xaMZrmvA@mail.gmail.com>
 <CWLP123MB4466FF7E7457266097A85896A5DE9@CWLP123MB4466.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CANOYX1T5Vj=L+eWDqDHGXma5Verg6xN=jwCf-j=COB0mAGjQ0g@mail.gmail.com>

I reported the bug to bugzilla.

https://bugzilla.mozilla.org/show_bug.cgi?id=1816128

The bug is already fixed.
We should use higher version of firefox or firefox nightly.

2023?2?10?(?) 22:23 jing hua zhao <jinghuazhao at hotmail.com>:

> This is apparently  due to compression as needed fort package building,
> e.g., R CMD build --compact-vignettes=both --md5 --resave-data --log gap so
> mine has the same problem:
> https://cran.r-project.org/web/packages/gap/vignettes/jss.pdf
> ________________________________
> From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf
> of Mike Blazanin <mikeblazanin at gmail.com>
> Sent: 09 February 2023 15:27
> To: r-package-devel at r-project.org <r-package-devel at r-project.org>
> Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer
>
> Hi all, my package gcplyr has several vignettes which, from CRAN, appear
> garbled when opened with Firefox's pdf viewer (
> https://cran.r-project.org/web/packages/gcplyr/index.html). Specifically,
> instead of regular characters, there are numerous black-outlined white
> boxes with text inside like "EO 88" or "EO 55". This doesn't occur with the
> pdf vignettes on Github (https://github.com/mikeblazanin/gcplyr/). This
> also doesn't occur when CRAN pdfs are opened with Chrome's pdf viewer or
>
> opened with a local pdf viewer.
>
> The issue was documented here:
> https://github.com/mikeblazanin/gcplyr/issues/112
>
> Anyone have any suggestions for what could be causing this?
>
> Thanks!
> Mike Blazanin
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From j|nghu@zh@o @end|ng |rom hotm@||@com  Fri Feb 10 23:06:08 2023
From: j|nghu@zh@o @end|ng |rom hotm@||@com (jing hua zhao)
Date: Fri, 10 Feb 2023 22:06:08 +0000
Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer
In-Reply-To: <CAEbuDvKHCUXzv0LmnDyDjT+SM0qrLXr2-izH9vr8HEHM+6R4yw@mail.gmail.com>
References: <CAEbuDvKgn6YQM9LZRozRP_hzU0RXZEjVoPY4VVJu58xaMZrmvA@mail.gmail.com>
 <CWLP123MB4466FF7E7457266097A85896A5DE9@CWLP123MB4466.GBRP123.PROD.OUTLOOK.COM>
 <CANOYX1T5Vj=L+eWDqDHGXma5Verg6xN=jwCf-j=COB0mAGjQ0g@mail.gmail.com>
 <CAEbuDvKHCUXzv0LmnDyDjT+SM0qrLXr2-izH9vr8HEHM+6R4yw@mail.gmail.com>
Message-ID: <CWLP123MB4466AAB875E2104C6E9303C2A5DE9@CWLP123MB4466.GBRP123.PROD.OUTLOOK.COM>

The problem has been around for a while for me and thank you for raising it -- esp. with a fix!

Jing Hua
________________________________
From: Mike Blazanin <mikeblazanin at gmail.com>
Sent: 10 February 2023 16:29
To: Shota Ochi <shotaochi1990 at gmail.com>
Cc: jing hua zhao <jinghuazhao at hotmail.com>; r-package-devel at r-project.org <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer

[[elided Hotmail spam]]

Mike

On Fri, Feb 10, 2023 at 11:22 AM Shota Ochi <shotaochi1990 at gmail.com<mailto:shotaochi1990 at gmail.com>> wrote:
I reported the bug to bugzilla.

https://bugzilla.mozilla.org/show_bug.cgi?id=1816128

The bug is already fixed.
We should use higher version of firefox or firefox nightly.

2023$BG/(B2$B7n(B10$BF|(B($B6b(B) 22:23 jing hua zhao <jinghuazhao at hotmail.com<mailto:jinghuazhao at hotmail.com>>:
This is apparently  due to compression as needed fort package building, e.g., R CMD build --compact-vignettes=both --md5 --resave-data --log gap so mine has the same problem: https://cran.r-project.org/web/packages/gap/vignettes/jss.pdf
________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org<mailto:r-package-devel-bounces at r-project.org>> on behalf of Mike Blazanin <mikeblazanin at gmail.com<mailto:mikeblazanin at gmail.com>>
Sent: 09 February 2023 15:27
To: r-package-devel at r-project.org<mailto:r-package-devel at r-project.org> <r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>>
Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer

Hi all, my package gcplyr has several vignettes which, from CRAN, appear
garbled when opened with Firefox's pdf viewer (
https://cran.r-project.org/web/packages/gcplyr/index.html). Specifically,
instead of regular characters, there are numerous black-outlined white
boxes with text inside like "EO 88" or "EO 55". This doesn't occur with the
pdf vignettes on Github (https://github.com/mikeblazanin/gcplyr/). This
also doesn't occur when CRAN pdfs are opened with Chrome's pdf viewer or

opened with a local pdf viewer.

The issue was documented here:
https://github.com/mikeblazanin/gcplyr/issues/112

Anyone have any suggestions for what could be causing this?

Thanks!
Mike Blazanin

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


--
Mike Blazanin

	[[alternative HTML version deleted]]


From |embry @end|ng |rom ecocc@@com  Sat Feb 11 03:35:38 2023
From: |embry @end|ng |rom ecocc@@com (EcoC2S - Irucka Embry)
Date: Fri, 10 Feb 2023 20:35:38 -0600
Subject: [R-pkg-devel] Error in find_vignette_product(name, by = "weave",
 dir = docdir, engine = engine)
In-Reply-To: <5017c9b9f2222982e6031a5d3d83ea5b@ecoccs.com>
References: <dc713e6d764976c5f370cfb05ba38e92@ecoccs.com>
 <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
 <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
 <5017c9b9f2222982e6031a5d3d83ea5b@ecoccs.com>
Message-ID: <7fb09f8af3356fb804615fd3a7a27f52@ecoccs.com>

Hi, I am attempting to build my revised 'iemisc' package, but I am 
having trouble building one of the vignettes.

I am receiving the following error message:

* creating vignettes ...Error in find_vignette_product(name, by = 
"weave", dir = docdir, engine = engine) :
   Failed to locate ?weave? output file ?Engineering_Survey_Examples.pdf? 
or ?Engineering_Survey_Examples.html? for vignette with name 
?Engineering_Survey_Examples? and engine ?knitr::rmarkdown?.


This is odd because the following command correctly produces the PDF of 
the document:

library("rmarkdown")
render("/vignettes/Engineering_Survey_Examples.Rmd", 
pdf_document(latex_engine = "xelatex"))

I have attached the .Rmd file for the vignette to this e-mail.

Thank you.

Irucka Embry

-- 
--
No fear, Only Love! / ?No temas, solamente amor!
-Irucka Ajani Embry, 15 March 2020

Family Partners:
http://www.sustainlex.org/
https://www.schoolingsolutions.com/

---------------------------------------------------------------------------------------------------------------

The business collaboration between EConsulting (tm)
[https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to 
Nature.

Getting Back to Nature LocalHarvest --
https://www.localharvest.org/getting-back-to-nature-M73453
Getting Back to Nature -- https://www.gettingback2nature.farm/

-- Irucka and his twin brother, Obiora, are featured in the Middle
Tennessee Local Table Magazine Annual issue. The article discusses their
family farm history and the current work that they are doing under 
Getting
Back to Nature. The full magazine can be found here [the article begins 
on
page 18 of the PDF document]:

https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf

-- Obiora and Irucka were interviewed separately in early 2020 for the
Natural Resources Defense Council's (NRDC) "Regenerative Agriculture: 
Farm
Policy for the 21st Century: Policy Recommendations to Advance 
Regenerative
Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen Lee.
The PDF report is available below:

https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf

EcoC2S -- https://www.ecoccs.com/
Principal, Irucka Embry, EIT

Services:
Growing Food
Healthy Living Mentor
Data Analysis with R
R Training
Chemistry and Mathematics Tutoring
Free/Libre and Open Source Software (FLOSS) Consultation
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Engineering_Survey_Examples.Rmd
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20230210/bdd0192d/attachment.ksh>

From |embry @end|ng |rom ecocc@@com  Sat Feb 11 03:56:39 2023
From: |embry @end|ng |rom ecocc@@com (EcoC2S - Irucka Embry)
Date: Fri, 10 Feb 2023 20:56:39 -0600
Subject: [R-pkg-devel] IGNORE --- Error in find_vignette_product(name,
 by = "weave", dir = docdir, engine = engine)
In-Reply-To: <7fb09f8af3356fb804615fd3a7a27f52@ecoccs.com>
References: <dc713e6d764976c5f370cfb05ba38e92@ecoccs.com>
 <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
 <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
 <5017c9b9f2222982e6031a5d3d83ea5b@ecoccs.com>
 <7fb09f8af3356fb804615fd3a7a27f52@ecoccs.com>
Message-ID: <d16c224bc04243b54d3f1b3f59a7e022@ecoccs.com>

Hi all. I uncovered the error that caused the vignette not to print.

It had to do with one of the functions in the vignette.

Thank you.

Irucka



On 10-02-2023 20:35, EcoC2S - Irucka Embry wrote:
> Hi, I am attempting to build my revised 'iemisc' package, but I am
> having trouble building one of the vignettes.
> 
> I am receiving the following error message:
> 
> * creating vignettes ...Error in find_vignette_product(name, by =
> "weave", dir = docdir, engine = engine) :
>   Failed to locate ?weave? output file
> ?Engineering_Survey_Examples.pdf? or
> ?Engineering_Survey_Examples.html? for vignette with name
> ?Engineering_Survey_Examples? and engine ?knitr::rmarkdown?.
> 
> 
> This is odd because the following command correctly produces the PDF
> of the document:
> 
> library("rmarkdown")
> render("/vignettes/Engineering_Survey_Examples.Rmd",
> pdf_document(latex_engine = "xelatex"))
> 
> I have attached the .Rmd file for the vignette to this e-mail.
> 
> Thank you.
> 
> Irucka Embry
> 
> --
> --
> No fear, Only Love! / ?No temas, solamente amor!
> -Irucka Ajani Embry, 15 March 2020
> 
> Family Partners:
> http://www.sustainlex.org/
> https://www.schoolingsolutions.com/
> 
> ---------------------------------------------------------------------------------------------------------------
> 
> The business collaboration between EConsulting (tm)
> [https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to 
> Nature.
> 
> Getting Back to Nature LocalHarvest --
> https://www.localharvest.org/getting-back-to-nature-M73453
> Getting Back to Nature -- https://www.gettingback2nature.farm/
> 
> -- Irucka and his twin brother, Obiora, are featured in the Middle
> Tennessee Local Table Magazine Annual issue. The article discusses 
> their
> family farm history and the current work that they are doing under 
> Getting
> Back to Nature. The full magazine can be found here [the article begins 
> on
> page 18 of the PDF document]:
> 
> https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf
> 
> -- Obiora and Irucka were interviewed separately in early 2020 for the
> Natural Resources Defense Council's (NRDC) "Regenerative Agriculture: 
> Farm
> Policy for the 21st Century: Policy Recommendations to Advance 
> Regenerative
> Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen 
> Lee.
> The PDF report is available below:
> 
> https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf
> 
> EcoC2S -- https://www.ecoccs.com/
> Principal, Irucka Embry, EIT
> 
> Services:
> Growing Food
> Healthy Living Mentor
> Data Analysis with R
> R Training
> Chemistry and Mathematics Tutoring
> Free/Libre and Open Source Software (FLOSS) Consultation

-- 
--
No fear, Only Love! / ?No temas, solamente amor!
-Irucka Ajani Embry, 15 March 2020

Family Partners:
http://www.sustainlex.org/
https://www.schoolingsolutions.com/

---------------------------------------------------------------------------------------------------------------

The business collaboration between EConsulting (tm)
[https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to 
Nature.

Getting Back to Nature LocalHarvest --
https://www.localharvest.org/getting-back-to-nature-M73453
Getting Back to Nature -- https://www.gettingback2nature.farm/

-- Irucka and his twin brother, Obiora, are featured in the Middle
Tennessee Local Table Magazine Annual issue. The article discusses their
family farm history and the current work that they are doing under 
Getting
Back to Nature. The full magazine can be found here [the article begins 
on
page 18 of the PDF document]:

https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf

-- Obiora and Irucka were interviewed separately in early 2020 for the
Natural Resources Defense Council's (NRDC) "Regenerative Agriculture: 
Farm
Policy for the 21st Century: Policy Recommendations to Advance 
Regenerative
Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen Lee.
The PDF report is available below:

https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf

EcoC2S -- https://www.ecoccs.com/
Principal, Irucka Embry, EIT

Services:
Growing Food
Healthy Living Mentor
Data Analysis with R
R Training
Chemistry and Mathematics Tutoring
Free/Libre and Open Source Software (FLOSS) Consultation


From D@v|d@C@Sterr@tt @end|ng |rom ed@@c@uk  Sat Feb 11 12:19:42 2023
From: D@v|d@C@Sterr@tt @end|ng |rom ed@@c@uk (David Sterratt)
Date: Sat, 11 Feb 2023 11:19:42 +0000
Subject: [R-pkg-devel] Unable to load Windows NETIO.SYS and WINSPOOL.DRV DLLs
Message-ID: <eb7d1d333a2797d098418d092f19bd4f3542ce51.camel@ed.ac.uk>

[I've posted this to r-devel, and just realised that I should have
posted it to this list instead - apologies to those on both lists for
the extra email.]

I am trying to build the RGtk2 package
(https://github.com/lawremi/RGtk2) using R-devel and only the libraries
bundled with RTookl4.3 (currently RGtk2 is bundled with a compiled dll
and requires GTK libraries to be downloaded after installation into R).

I have used the instructions at
https://cran.r-project.org/bin/windows/base/howto-R-4.2.html
to create a Makevars.win file (appended, including description of how
the PKG_LIBS have been set).

The package can be installed, but the shared object created can't be
loaded:

   > library(RGtk2)
   Error in inDL(x, as.logical(local), as.logical(now), ...) :
     unable to load shared object 'C:/Users/David
   Sterratt/AppData/Local/R/win-library/4.3/RGtk2/libs/x
   64/RGtk2.dll':
     LoadLibrary failure:  The specified module could not be found.

WinDbg output reveals errors loading "NETIO.SYS" and "WINSPOOL.DRV"
when running "library(RGtk2)":

   0c64:0640 @ 44312812 - LdrpProcessWork - ERROR: Unable to load DLL:
"NETIO.SYS", Parent Module: "C:\Users\David
Sterratt\AppData\Local\R\win-library\4.3\RGtk2\libs\x64\RGtk2.dll",
Status: 0xc0000135
   ...
   0c64:1e5c @ 44312812 - LdrpProcessWork - ERROR: Unable to load DLL:
"WINSPOOL.DRV", Parent Module: "C:\Users\David
Sterratt\AppData\Local\R\win-library\4.3\RGtk2\libs\x64\RGtk2.dll",
Status: 0xc0000135
   ...
   0c64:00e4 @ 44312828 - LdrpProcessWork - ERROR: Unable to load DLL:
"C:\Users\David Sterratt\AppData\Local\R\win-
library\4.3\RGtk2\libs\x64\RGtk2.dll", Parent Module: "(null)", Status:
0xc0000135

I'm stuck at this point: I'm not a regular Windows User, and I've not
been able to find any trustworthy advice online about how to deal with
missing DLLs. Any help would be appreciated.

There is an issue on Github about this issue with full output from
WinDbg:
https://github.com/lawremi/RGtk2/issues/9

Best wishes,

David

* * *

Contents of Makevars.win:

# Use the linking_order script to determine library order
# Install the latest version of R-devel from
https://cran.r-project.org/
# Install Rtools43 from https://cran.r-project.org/
# Open the Rtools43 Bash shell
## Set Paths to R and various tools
# export PATH="/c/Program Files/R/R-devel/bin":$PATH
# export PATH=/x86_64-w64-mingw32.static.posix/bin/:$PATH
## Install pkg-config and add path
# pacman -Syy pkg-config
# PKG_CONFIG_PATH=/x86_64-w64-
mingw32.static.posix/lib/pkgconfig/:$PKG_CONFIG_PATH

# Install a package in R using install.pacakges(), which will set the
personal library path
# https://cran.r-project.org/bin/windows/base/howto-R-4.2.html
#  ./linking_order/findLinkingOrder RGtk2/RGtk2/ /tmp/RGtk2.libs
/c/rtools42/x86_64-w64-mingw32.static.posix/lib

# pkg-config.exe --static --cflags  gtk+-2.0
# Add these flags: -D_R_=1 -DUSE_R=1 -I. -I../inst/include
PKG_CPPFLAGS = -I/usr/lib/mxe/usr/x86_64-w64-
mingw32.static.posix/include/pango-1.0 -I/usr/lib/mxe/usr/x86_64-w64-
mingw32.static.posix/include/gtk-2.0 -I/usr/lib/mxe/usr/x86_64-w64-
mingw32.static.posix/lib/gtk-2.0/include -I/usr/lib/mxe/usr/x86_64-w64-
mingw32.static.posix/include/atk-1.0 -I/usr/lib/mxe/usr/x86_64-w64-
mingw32.static.posix/include -I/usr/lib/mxe/usr/x86_64-w64-
mingw32.static.posix/include/cairo -I/usr/lib/mxe/usr/x86_64-w64-
mingw32.static.posix/include/gdk-pixbuf-2.0 -DPCRE2_STATIC -
I/usr/lib/mxe/usr/x86_64-w64-mingw32.static.posix/include/libpng16 -
I/usr/lib/mxe/usr/x86_64-w64-mingw32.static.posix/include/harfbuzz -
I/usr/lib/mxe/usr/x86_64-w64-mingw32.static.posix/include/fribidi -
DFRIBIDI_LIB_STATIC -I/usr/lib/mxe/usr/x86_64-w64-
mingw32.static.posix/include/freetype2 -I/usr/lib/mxe/usr/x86_64-w64-
mingw32.static.posix/include/glib-2.0 -I/usr/lib/mxe/usr/x86_64-w64-
mingw32.static.posix/lib/glib-2.0/include -I/usr/lib/mxe/usr/x86_64-
w64-mingw32.static.posix/include/pixman-1 -pthread -mms-bitfields -
D_R_=1 -DUSE_R=1 -I. -I../inst/include

# Use the linking_order script to determine library order by setting
# the PKG_LIBS below, then running (repeatedly)
# ./linking_order/findLinkingOrder RGtk2/RGtk2/ /tmp/RGtk2.libs
# PKG_LIBS = -Wl,--no-demangle $(shell cat /tmp/RGtk2.libs)

# This is the set of PKG_LIBS found by findLinkingOrder
# PKG_LIBS = -lgtk-win32-2.0 -lwinspool -lspoolss -lgdk-win32-2.0 -
lcomdlg32 -lcomctl32 -latk-1.0 -lpangocairo-1.0 -lgdk_pixbuf-2.0 -
lpangowin32-1.0 -lpangoft2-1.0 -lcairo -ldwrite -lpango-1.0 -lpixman-1
-lmsimg32 -lfontconfig -lgio-2.0 -lfribidi -lexpat -lnetio -liphlpapi -
lgobject-2.0 -lgmodule-2.0 -ldnsapi -lffi -lharfbuzz_too -lfreetype_too
-lharfbuzz -lglib-2.0 -lfreetype -luuid -lpcre2-8 -lpng16 -lpng -lbz2 -
lole32 -limm32 -lgdi32 -ltiff -lwebpdecoder -lwebp -llzma -ljpeg -
lcfitsio -lzstd -lz -lintl -liconv -lwsock32 -lws2_32 -lshlwapi

# There are duplicated symbols between -lcfitsio and -lz - remove -
lcfitsio
PKG_LIBS = -lgtk-win32-2.0 -lwinspool -lspoolss -lgdk-win32-2.0 -
lcomdlg32 -lcomctl32 -latk-1.0 -lpangocairo-1.0 -lgdk_pixbuf-2.0 -
lpangowin32-1.0 -lpangoft2-1.0 -lcairo -ldwrite -lpango-1.0 -lpixman-1
-lmsimg32 -lfontconfig -lgio-2.0 -lfribidi -lexpat -lnetio -liphlpapi -
lgobject-2.0 -lgmodule-2.0 -ldnsapi -lffi -lharfbuzz_too -lfreetype_too
-lharfbuzz -lglib-2.0 -lfreetype -luuid -lpcre2-8 -lpng16 -lpng -lbz2 -
lole32 -limm32 -lgdi32 -ltiff -lwebpdecoder -lwebp -llzma -ljpeg -lzstd
-lz -lintl -liconv -lwsock32 -lws2_32 -lshlwapi



--
David Sterratt, Lecturer https://www.ed.ac.uk/profile/sterratt
Institute for Adaptive and Neural Computation     tel: +44 131 651 1739
School of Informatics, University of Edinburgh
Appleton Tower, 11 Crichton Street, Edinburgh EH8 9LE, Scotland
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
BOOK: Principles of Computational Modelling in Neuroscience
Sterratt, Graham, Gillies & Willshaw (CUP, 2011).
http://www.compneuroprinciples.org



The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336. Is e buidheann carthannais a th? ann an Oilthigh Dh?n ?ideann, cl?raichte an Alba, ?ireamh cl?raidh SC005336.

From kry|ov@r00t @end|ng |rom gm@||@com  Sat Feb 11 16:11:18 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 11 Feb 2023 18:11:18 +0300
Subject: [R-pkg-devel] Unable to load Windows NETIO.SYS and WINSPOOL.DRV
 DLLs
In-Reply-To: <eb7d1d333a2797d098418d092f19bd4f3542ce51.camel@ed.ac.uk>
References: <eb7d1d333a2797d098418d092f19bd4f3542ce51.camel@ed.ac.uk>
Message-ID: <20230211181118.18be1599@Tarkus>

On Sat, 11 Feb 2023 11:19:42 +0000
David Sterratt <David.C.Sterratt at ed.ac.uk> wrote:

> WinDbg output reveals errors loading "NETIO.SYS" and "WINSPOOL.DRV"
> when running "library(RGtk2)":
> 
>    0c64:0640 @ 44312812 - LdrpProcessWork - ERROR: Unable to load DLL:
> "NETIO.SYS", Parent Module: "C:\Users\David
> Sterratt\AppData\Local\R\win-library\4.3\RGtk2\libs\x64\RGtk2.dll",
> Status: 0xc0000135
>    ...
>    0c64:1e5c @ 44312812 - LdrpProcessWork - ERROR: Unable to load DLL:
> "WINSPOOL.DRV", Parent Module: "C:\Users\David
> Sterratt\AppData\Local\R\win-library\4.3\RGtk2\libs\x64\RGtk2.dll",
> Status: 0xc0000135

The failure to load WINSPOOL.DRV is perplexing (it should normally be
possible to load as it's a system DLL that applications are supposed to
link against in order to be able to print), but NETIO.SYS should
probably be absent from the import list. At least it seems to be linked
against some kernel-related stuff that shouldn't be reachable from
userspace applications.

By removing -lnetio from PKG_LIBS, I was able to load the package and
run some example code from the JSS article, but then Rgui.exe crashed
on exit. I'm running R-4.2.2 and Rtools43 on a Windows 7 machine, which
could also be a source of the difference.

Does the Dependency Walker <https://dependencywalker.com/> provide you
any useful information about the package DLL besides what you already
know? (Some warnings deep in the dependency tree are to be expected.
R.DLL is not on the PATH so won't be automatically found, but other
dependencies should exist.)

-- 
Best regards,
Ivan

-------------- next part --------------
A non-text attachment was scrubbed...
Name: jss-example-working.png
Type: image/png
Size: 10880 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20230211/9d715e79/attachment.png>

From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sun Feb 12 15:04:23 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sun, 12 Feb 2023 15:04:23 +0100
Subject: [R-pkg-devel] Unable to load Windows NETIO.SYS and WINSPOOL.DRV
 DLLs
In-Reply-To: <20230211181118.18be1599@Tarkus>
References: <eb7d1d333a2797d098418d092f19bd4f3542ce51.camel@ed.ac.uk>
 <20230211181118.18be1599@Tarkus>
Message-ID: <4e60d22c-9609-624e-b5cf-f445f58ded9c@statistik.tu-dortmund.de>

Note that Gtk2 is end of life, Gtk4 was released 3 years ago already.
There are reasons why neither the former RGtk2 maintainer nor the CRAN 
team decided to maintain RGtk2 further on.

Best,
Uwe Ligges



On 11.02.2023 16:11, Ivan Krylov wrote:
> On Sat, 11 Feb 2023 11:19:42 +0000
> David Sterratt <David.C.Sterratt at ed.ac.uk> wrote:
> 
>> WinDbg output reveals errors loading "NETIO.SYS" and "WINSPOOL.DRV"
>> when running "library(RGtk2)":
>>
>>     0c64:0640 @ 44312812 - LdrpProcessWork - ERROR: Unable to load DLL:
>> "NETIO.SYS", Parent Module: "C:\Users\David
>> Sterratt\AppData\Local\R\win-library\4.3\RGtk2\libs\x64\RGtk2.dll",
>> Status: 0xc0000135
>>     ...
>>     0c64:1e5c @ 44312812 - LdrpProcessWork - ERROR: Unable to load DLL:
>> "WINSPOOL.DRV", Parent Module: "C:\Users\David
>> Sterratt\AppData\Local\R\win-library\4.3\RGtk2\libs\x64\RGtk2.dll",
>> Status: 0xc0000135
> 
> The failure to load WINSPOOL.DRV is perplexing (it should normally be
> possible to load as it's a system DLL that applications are supposed to
> link against in order to be able to print), but NETIO.SYS should
> probably be absent from the import list. At least it seems to be linked
> against some kernel-related stuff that shouldn't be reachable from
> userspace applications.
> 
> By removing -lnetio from PKG_LIBS, I was able to load the package and
> run some example code from the JSS article, but then Rgui.exe crashed
> on exit. I'm running R-4.2.2 and Rtools43 on a Windows 7 machine, which
> could also be a source of the difference.
> 
> Does the Dependency Walker <https://dependencywalker.com/> provide you
> any useful information about the package DLL besides what you already
> know? (Some warnings deep in the dependency tree are to be expected.
> R.DLL is not on the PATH so won't be automatically found, but other
> dependencies should exist.)
> 
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From D@v|d@C@Sterr@tt @end|ng |rom ed@@c@uk  Sun Feb 12 17:23:08 2023
From: D@v|d@C@Sterr@tt @end|ng |rom ed@@c@uk (David Sterratt)
Date: Sun, 12 Feb 2023 16:23:08 +0000
Subject: [R-pkg-devel] Unable to load Windows NETIO.SYS and WINSPOOL.DRV
 DLLs
In-Reply-To: <4e60d22c-9609-624e-b5cf-f445f58ded9c@statistik.tu-dortmund.de>
References: <eb7d1d333a2797d098418d092f19bd4f3542ce51.camel@ed.ac.uk>
 <20230211181118.18be1599@Tarkus>
 <4e60d22c-9609-624e-b5cf-f445f58ded9c@statistik.tu-dortmund.de>
Message-ID: <453783b8fe8322e762746d96241da8ec0135618d.camel@ed.ac.uk>

On Sun, 2023-02-12 at 15:04 +0100, Uwe Ligges wrote:
> Note that Gtk2 is end of life, Gtk4 was released 3 years ago already.
> There are reasons why neither the former RGtk2 maintainer nor the
> CRAN team decided to maintain RGtk2 further on.

Thank you. I know that Gtk2 is end-of-life, but I was thinking that the
inclusion of the Gtk2 library in RTools4.3 meant that it was still seen
as usable. I have an R package that is built around the gWidgets2RGtk2
interface  - it had some features that the Tcl/Tk interface didn't
have.

Anyway, *supposing* that someone wanted to investigate updating RGtk2
to RGtk4 and upload the updated package to CRAN, what would be the
possible approaches (if any) to include the RGtk4 libraries, so that
the package could be compiled on the CRAN build servers? Either (1)
include the Gtk4 source code (and any necessary dependencies) in the R
package; or (2) have RGtk4 dev libraries installed on build servers
(I'm assuming that they are not currently installed).

Best wishes,

David

--
David Sterratt, Lecturer https://www.ed.ac.uk/profile/sterratt
Institute for Adaptive and Neural Computation     tel: +44 131 651 1739
School of Informatics, University of Edinburgh
Appleton Tower, 11 Crichton Street, Edinburgh EH8 9LE, Scotland
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
BOOK: Principles of Computational Modelling in Neuroscience
Sterratt, Graham, Gillies & Willshaw (CUP, 2011).
http://www.compneuroprinciples.org



The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336. Is e buidheann carthannais a th? ann an Oilthigh Dh?n ?ideann, cl?raichte an Alba, ?ireamh cl?raidh SC005336.

From D@v|d@C@Sterr@tt @end|ng |rom ed@@c@uk  Sun Feb 12 17:37:41 2023
From: D@v|d@C@Sterr@tt @end|ng |rom ed@@c@uk (David Sterratt)
Date: Sun, 12 Feb 2023 16:37:41 +0000
Subject: [R-pkg-devel] Unable to load Windows NETIO.SYS and WINSPOOL.DRV
 DLLs
In-Reply-To: <20230211181118.18be1599@Tarkus>
References: <eb7d1d333a2797d098418d092f19bd4f3542ce51.camel@ed.ac.uk>
 <20230211181118.18be1599@Tarkus>
Message-ID: <3a55d6a809ca09b8f8ab4ed8d908a94290f2ca7d.camel@ed.ac.uk>

On Sat, 2023-02-11 at 18:11 +0300, Ivan Krylov wrote:
> On Sat, 11 Feb 2023 11:19:42 +0000
> David Sterratt <David.C.Sterratt at ed.ac.uk> wrote:
>
> > WinDbg output reveals errors loading "NETIO.SYS" and "WINSPOOL.DRV"
> > when running "library(RGtk2)":
> >
> >    0c64:0640 @ 44312812 - LdrpProcessWork - ERROR: Unable to load
> > DLL:
> > "NETIO.SYS", Parent Module: "C:\Users\David
> > Sterratt\AppData\Local\R\win-library\4.3\RGtk2\libs\x64\RGtk2.dll",
> > Status: 0xc0000135
> >    ...
> >    0c64:1e5c @ 44312812 - LdrpProcessWork - ERROR: Unable to load
> > DLL:
> > "WINSPOOL.DRV", Parent Module: "C:\Users\David
> > Sterratt\AppData\Local\R\win-library\4.3\RGtk2\libs\x64\RGtk2.dll",
> > Status: 0xc0000135
>
> The failure to load WINSPOOL.DRV is perplexing (it should normally be
> possible to load as it's a system DLL that applications are supposed
> to
> link against in order to be able to print), but NETIO.SYS should
> probably be absent from the import list. At least it seems to be
> linked
> against some kernel-related stuff that shouldn't be reachable from
> userspace applications.
>
> By removing -lnetio from PKG_LIBS, I was able to load the package and
> run some example code from the JSS article, but then Rgui.exe crashed
> on exit. I'm running R-4.2.2 and Rtools43 on a Windows 7 machine,
> which
> could also be a source of the difference.

Thank you for looking at this. I tried removing -lnetio, but package
didn't install at all on Windows 10.

> Does the Dependency Walker <https://dependencywalker.com/> provide
> you
> any useful information about the package DLL besides what you already
> know? (Some warnings deep in the dependency tree are to be expected.
> R.DLL is not on the PATH so won't be automatically found, but other
> dependencies should exist.)

I looked at the Dependency Walker, but it was giving me many messages
about missing DLLs with names like:

  API-MS-WIN-CORE-STRING-L2-1-0.DLL  Error opening file. The system
cannot find the file specified (2).

These libraries seem to be part of the UCRT system. However, when
looked at the DLL of a package that *did* load in Dependency Walker, I
got the same messages, so I think the path to the UCRT files may be
missing.

Dependency Walker did seem to find:

  c:\windows\system32\WINSPOOL.DRV

For NETIO.SYS it gave the " Error opening file. The system cannot find
the file specified (2)." There was also this table in the output.

     [ ? ] NETIO.SYS

          Import  Ordinal  Hint          Function                Entry
Point
          ------  -------  ------------  ----------------------  ------
-----
          [CE ]       N/A    4 (0x0004)  CancelMibChangeNotify2  Not
Bound
          [CE ]       N/A   79 (0x004F)  GetIpForwardTable2      Not
Bound
          [CE ]       N/A  364 (0x016C)  NotifyRouteChange2      Not
Bound
          [CE ]       N/A  529 (0x0211)  if_nametoindex          Not
Bound

If you're really interested, I can send you the output, but from what
Uwe says, I'm wondering if this is a lost cause!

Best wishes,

David.


--
David Sterratt, Lecturer https://www.ed.ac.uk/profile/sterratt
Institute for Adaptive and Neural Computation     tel: +44 131 651 1739
School of Informatics, University of Edinburgh
Appleton Tower, 11 Crichton Street, Edinburgh EH8 9LE, Scotland
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
BOOK: Principles of Computational Modelling in Neuroscience
Sterratt, Graham, Gillies & Willshaw (CUP, 2011).
http://www.compneuroprinciples.org



The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336. Is e buidheann carthannais a th? ann an Oilthigh Dh?n ?ideann, cl?raichte an Alba, ?ireamh cl?raidh SC005336.

From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sun Feb 12 23:12:24 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sun, 12 Feb 2023 23:12:24 +0100
Subject: [R-pkg-devel] Unable to load Windows NETIO.SYS and WINSPOOL.DRV
 DLLs
In-Reply-To: <3a55d6a809ca09b8f8ab4ed8d908a94290f2ca7d.camel@ed.ac.uk>
References: <eb7d1d333a2797d098418d092f19bd4f3542ce51.camel@ed.ac.uk>
 <20230211181118.18be1599@Tarkus>
 <3a55d6a809ca09b8f8ab4ed8d908a94290f2ca7d.camel@ed.ac.uk>
Message-ID: <4d477334-5ef5-5bfc-b85d-8f08d5961718@statistik.tu-dortmund.de>

If you need some details, perhaps simply ask Michael Lawrence.
He certainly knows better than most readers what the issues are, or at 
least were when RGtk2 got archived.

Best,
Uwe Ligges

On 12.02.2023 17:37, David Sterratt wrote:
> On Sat, 2023-02-11 at 18:11 +0300, Ivan Krylov wrote:
>> On Sat, 11 Feb 2023 11:19:42 +0000
>> David Sterratt <David.C.Sterratt at ed.ac.uk> wrote:
>>
>>> WinDbg output reveals errors loading "NETIO.SYS" and "WINSPOOL.DRV"
>>> when running "library(RGtk2)":
>>>
>>>     0c64:0640 @ 44312812 - LdrpProcessWork - ERROR: Unable to load
>>> DLL:
>>> "NETIO.SYS", Parent Module: "C:\Users\David
>>> Sterratt\AppData\Local\R\win-library\4.3\RGtk2\libs\x64\RGtk2.dll",
>>> Status: 0xc0000135
>>>     ...
>>>     0c64:1e5c @ 44312812 - LdrpProcessWork - ERROR: Unable to load
>>> DLL:
>>> "WINSPOOL.DRV", Parent Module: "C:\Users\David
>>> Sterratt\AppData\Local\R\win-library\4.3\RGtk2\libs\x64\RGtk2.dll",
>>> Status: 0xc0000135
>>
>> The failure to load WINSPOOL.DRV is perplexing (it should normally be
>> possible to load as it's a system DLL that applications are supposed
>> to
>> link against in order to be able to print), but NETIO.SYS should
>> probably be absent from the import list. At least it seems to be
>> linked
>> against some kernel-related stuff that shouldn't be reachable from
>> userspace applications.
>>
>> By removing -lnetio from PKG_LIBS, I was able to load the package and
>> run some example code from the JSS article, but then Rgui.exe crashed
>> on exit. I'm running R-4.2.2 and Rtools43 on a Windows 7 machine,
>> which
>> could also be a source of the difference.
> 
> Thank you for looking at this. I tried removing -lnetio, but package
> didn't install at all on Windows 10.
> 
>> Does the Dependency Walker <https://dependencywalker.com/> provide
>> you
>> any useful information about the package DLL besides what you already
>> know? (Some warnings deep in the dependency tree are to be expected.
>> R.DLL is not on the PATH so won't be automatically found, but other
>> dependencies should exist.)
> 
> I looked at the Dependency Walker, but it was giving me many messages
> about missing DLLs with names like:
> 
>    API-MS-WIN-CORE-STRING-L2-1-0.DLL  Error opening file. The system
> cannot find the file specified (2).
> 
> These libraries seem to be part of the UCRT system. However, when
> looked at the DLL of a package that *did* load in Dependency Walker, I
> got the same messages, so I think the path to the UCRT files may be
> missing.
> 
> Dependency Walker did seem to find:
> 
>    c:\windows\system32\WINSPOOL.DRV
> 
> For NETIO.SYS it gave the " Error opening file. The system cannot find
> the file specified (2)." There was also this table in the output.
> 
>       [ ? ] NETIO.SYS
> 
>            Import  Ordinal  Hint          Function                Entry
> Point
>            ------  -------  ------------  ----------------------  ------
> -----
>            [CE ]       N/A    4 (0x0004)  CancelMibChangeNotify2  Not
> Bound
>            [CE ]       N/A   79 (0x004F)  GetIpForwardTable2      Not
> Bound
>            [CE ]       N/A  364 (0x016C)  NotifyRouteChange2      Not
> Bound
>            [CE ]       N/A  529 (0x0211)  if_nametoindex          Not
> Bound
> 
> If you're really interested, I can send you the output, but from what
> Uwe says, I'm wondering if this is a lost cause!
> 
> Best wishes,
> 
> David.
> 
> 
> --
> David Sterratt, Lecturer https://www.ed.ac.uk/profile/sterratt
> Institute for Adaptive and Neural Computation     tel: +44 131 651 1739
> School of Informatics, University of Edinburgh
> Appleton Tower, 11 Crichton Street, Edinburgh EH8 9LE, Scotland
> * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
> BOOK: Principles of Computational Modelling in Neuroscience
> Sterratt, Graham, Gillies & Willshaw (CUP, 2011).
> http://www.compneuroprinciples.org
> 
> 
> 
> The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336. Is e buidheann carthannais a th? ann an Oilthigh Dh?n ?ideann, cl?raichte an Alba, ?ireamh cl?raidh SC005336.
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Mon Feb 13 19:08:38 2023
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Mon, 13 Feb 2023 19:08:38 +0100
Subject: [R-pkg-devel] Unable to load Windows NETIO.SYS and WINSPOOL.DRV
 DLLs
In-Reply-To: <3a55d6a809ca09b8f8ab4ed8d908a94290f2ca7d.camel@ed.ac.uk>
References: <eb7d1d333a2797d098418d092f19bd4f3542ce51.camel@ed.ac.uk>
 <20230211181118.18be1599@Tarkus>
 <3a55d6a809ca09b8f8ab4ed8d908a94290f2ca7d.camel@ed.ac.uk>
Message-ID: <583889be-a48d-8ef1-44f2-77a41211282b@gmail.com>


On 2/12/23 17:37, David Sterratt wrote:
> On Sat, 2023-02-11 at 18:11 +0300, Ivan Krylov wrote:
>> On Sat, 11 Feb 2023 11:19:42 +0000
>> David Sterratt <David.C.Sterratt at ed.ac.uk> wrote:
>>
>>> WinDbg output reveals errors loading "NETIO.SYS" and "WINSPOOL.DRV"
>>> when running "library(RGtk2)":
>>>
>>>     0c64:0640 @ 44312812 - LdrpProcessWork - ERROR: Unable to load
>>> DLL:
>>> "NETIO.SYS", Parent Module: "C:\Users\David
>>> Sterratt\AppData\Local\R\win-library\4.3\RGtk2\libs\x64\RGtk2.dll",
>>> Status: 0xc0000135
>>>     ...
>>>     0c64:1e5c @ 44312812 - LdrpProcessWork - ERROR: Unable to load
>>> DLL:
>>> "WINSPOOL.DRV", Parent Module: "C:\Users\David
>>> Sterratt\AppData\Local\R\win-library\4.3\RGtk2\libs\x64\RGtk2.dll",
>>> Status: 0xc0000135
>> The failure to load WINSPOOL.DRV is perplexing (it should normally be
>> possible to load as it's a system DLL that applications are supposed
>> to
>> link against in order to be able to print), but NETIO.SYS should
>> probably be absent from the import list. At least it seems to be
>> linked
>> against some kernel-related stuff that shouldn't be reachable from
>> userspace applications.
>>
>> By removing -lnetio from PKG_LIBS, I was able to load the package and
>> run some example code from the JSS article, but then Rgui.exe crashed
>> on exit. I'm running R-4.2.2 and Rtools43 on a Windows 7 machine,
>> which
>> could also be a source of the difference.
> Thank you for looking at this. I tried removing -lnetio, but package
> didn't install at all on Windows 10.

For reference, there is an old patch for RGtk2 package that I had 
created when working on Rtools42, though I am not very optimistic it 
will help in this case:

https://svn.r-project.org/R-dev-web/trunk/WindowsBuilds/winutf8/ucrt3/r_packages/old_patches/CRAN/RGtk2.diff

I've added gtk2 libraries to Rtools42 as they were needed by a CRAN 
package (RGtk2) at that time and available in MXE. Now MXE has gtk3, but 
not gtk4.

If there is a need for gtk4 in a CRAN package, the best way forward 
would be to contribute gtk4 build configuration to MXE, ideally also 
after testing it builds as part of Rtools43 (which is a subset of MXE 
but with some updates not yet upstream). We could then replace gtk2 by 
gtk4 in Rtools. CRAN servers will then get gtk4 simply via updating Rtools.

This is only what would be needed for Windows. For macOS, gtk4 would 
have to be added to the recipes. For Linux, the package should work with 
gtk4 distributions available in main distributions.

If you wanted to use gtk from a package, perhaps it would be easier to 
try directly, not via the archived RGtk2 package.

Best
Tomas
>
>> Does the Dependency Walker <https://dependencywalker.com/> provide
>> you
>> any useful information about the package DLL besides what you already
>> know? (Some warnings deep in the dependency tree are to be expected.
>> R.DLL is not on the PATH so won't be automatically found, but other
>> dependencies should exist.)
> I looked at the Dependency Walker, but it was giving me many messages
> about missing DLLs with names like:
>
>    API-MS-WIN-CORE-STRING-L2-1-0.DLL  Error opening file. The system
> cannot find the file specified (2).
>
> These libraries seem to be part of the UCRT system. However, when
> looked at the DLL of a package that *did* load in Dependency Walker, I
> got the same messages, so I think the path to the UCRT files may be
> missing.
>
> Dependency Walker did seem to find:
>
>    c:\windows\system32\WINSPOOL.DRV
>
> For NETIO.SYS it gave the " Error opening file. The system cannot find
> the file specified (2)." There was also this table in the output.
>
>       [ ? ] NETIO.SYS
>
>            Import  Ordinal  Hint          Function                Entry
> Point
>            ------  -------  ------------  ----------------------  ------
> -----
>            [CE ]       N/A    4 (0x0004)  CancelMibChangeNotify2  Not
> Bound
>            [CE ]       N/A   79 (0x004F)  GetIpForwardTable2      Not
> Bound
>            [CE ]       N/A  364 (0x016C)  NotifyRouteChange2      Not
> Bound
>            [CE ]       N/A  529 (0x0211)  if_nametoindex          Not
> Bound
>
> If you're really interested, I can send you the output, but from what
> Uwe says, I'm wondering if this is a lost cause!
>
> Best wishes,
>
> David.
>
>
> --
> David Sterratt, Lecturer https://www.ed.ac.uk/profile/sterratt
> Institute for Adaptive and Neural Computation     tel: +44 131 651 1739
> School of Informatics, University of Edinburgh
> Appleton Tower, 11 Crichton Street, Edinburgh EH8 9LE, Scotland
> * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
> BOOK: Principles of Computational Modelling in Neuroscience
> Sterratt, Graham, Gillies & Willshaw (CUP, 2011).
> http://www.compneuroprinciples.org
>
>
>
> The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336. Is e buidheann carthannais a th? ann an Oilthigh Dh?n ?ideann, cl?raichte an Alba, ?ireamh cl?raidh SC005336.
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From D@v|d@C@Sterr@tt @end|ng |rom ed@@c@uk  Tue Feb 14 13:26:35 2023
From: D@v|d@C@Sterr@tt @end|ng |rom ed@@c@uk (David Sterratt)
Date: Tue, 14 Feb 2023 12:26:35 +0000
Subject: [R-pkg-devel] Unable to load Windows NETIO.SYS and WINSPOOL.DRV
 DLLs
In-Reply-To: <583889be-a48d-8ef1-44f2-77a41211282b@gmail.com>
References: <eb7d1d333a2797d098418d092f19bd4f3542ce51.camel@ed.ac.uk>
 <20230211181118.18be1599@Tarkus>
 <3a55d6a809ca09b8f8ab4ed8d908a94290f2ca7d.camel@ed.ac.uk>
 <583889be-a48d-8ef1-44f2-77a41211282b@gmail.com>
Message-ID: <f7204d7a1b30452eb095fb029799210fe03047e0.camel@ed.ac.uk>

On Mon, 2023-02-13 at 19:08 +0100, Tomas Kalibera wrote:
> For reference, there is an old patch for RGtk2 package that I had
> created when working on Rtools42, though I am not very optimistic it
> will help in this case:
>
> https://svn.r-project.org/R-dev-web/trunk/WindowsBuilds/winutf8/ucrt3/r_packages/old_patches/CRAN/RGtk2.diff

Many thanks. I've not tried this patch yet, but it looks like it's not
made the development version of RGtk2, which is what I had been working
with. I will try out the archived RGtk2_2.20.36.3.tar.gz

> I've added gtk2 libraries to Rtools42 as they were needed by a CRAN
> package (RGtk2) at that time and available in MXE. Now MXE has gtk3,
> but
> not gtk4.
>
> If there is a need for gtk4 in a CRAN package, the best way forward
> would be to contribute gtk4 build configuration to MXE, ideally also
> after testing it builds as part of Rtools43 (which is a subset of MXE
> but with some updates not yet upstream). We could then replace gtk2
> by
> gtk4 in Rtools. CRAN servers will then get gtk4 simply via updating
> Rtools.
>
> This is only what would be needed for Windows. For macOS, gtk4 would
> have to be added to the recipes. For Linux, the package should work
> with
> gtk4 distributions available in main distributions.

This is helpful to know, as it suggests that if RGtk2 could be updated
to work with Gtk4, installed into MXE, and if the Mac recipies could be
updated, the changes RTools might be accepted, and then RGtk2 (perhaps
renamed RGtk4) might be uploadable to CRAN.

From this message, and Uwe's it's clear that the long-term future of
RGtk2 depends on an update to Gtk4, and I've asked the maintainer about
what the prospects of that might be:
https://github.com/lawremi/RGtk2/issues/12

Best wishes,

David
The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336. Is e buidheann carthannais a th? ann an Oilthigh Dh?n ?ideann, cl?raichte an Alba, ?ireamh cl?raidh SC005336.

From tom@@@k@||ber@ @end|ng |rom gm@||@com  Tue Feb 14 16:08:53 2023
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Tue, 14 Feb 2023 16:08:53 +0100
Subject: [R-pkg-devel] Unable to load Windows NETIO.SYS and WINSPOOL.DRV
 DLLs
In-Reply-To: <f7204d7a1b30452eb095fb029799210fe03047e0.camel@ed.ac.uk>
References: <eb7d1d333a2797d098418d092f19bd4f3542ce51.camel@ed.ac.uk>
 <20230211181118.18be1599@Tarkus>
 <3a55d6a809ca09b8f8ab4ed8d908a94290f2ca7d.camel@ed.ac.uk>
 <583889be-a48d-8ef1-44f2-77a41211282b@gmail.com>
 <f7204d7a1b30452eb095fb029799210fe03047e0.camel@ed.ac.uk>
Message-ID: <b0c46d28-9f19-4de9-0ad9-57be18ef8a7d@gmail.com>

On 2/14/23 13:26, David Sterratt wrote:
> On Mon, 2023-02-13 at 19:08 +0100, Tomas Kalibera wrote:
>> For reference, there is an old patch for RGtk2 package that I had
>> created when working on Rtools42, though I am not very optimistic it
>> will help in this case:
>>
>> https://svn.r-project.org/R-dev-web/trunk/WindowsBuilds/winutf8/ucrt3/r_packages/old_patches/CRAN/RGtk2.diff
> Many thanks. I've not tried this patch yet, but it looks like it's not
> made the development version of RGtk2, which is what I had been working
> with. I will try out the archived RGtk2_2.20.36.3.tar.gz

Yes, it was for the CRAN version (when it was still on CRAN). It is very 
likely you would have to manually update the list of libraries to link 
in this complicated case, after what you get from the script. As it was 
well illustrated also by Ivan's findings.

>> I've added gtk2 libraries to Rtools42 as they were needed by a CRAN
>> package (RGtk2) at that time and available in MXE. Now MXE has gtk3,
>> but
>> not gtk4.
>>
>> If there is a need for gtk4 in a CRAN package, the best way forward
>> would be to contribute gtk4 build configuration to MXE, ideally also
>> after testing it builds as part of Rtools43 (which is a subset of MXE
>> but with some updates not yet upstream). We could then replace gtk2
>> by
>> gtk4 in Rtools. CRAN servers will then get gtk4 simply via updating
>> Rtools.
>>
>> This is only what would be needed for Windows. For macOS, gtk4 would
>> have to be added to the recipes. For Linux, the package should work
>> with
>> gtk4 distributions available in main distributions.
> This is helpful to know, as it suggests that if RGtk2 could be updated
> to work with Gtk4, installed into MXE, and if the Mac recipies could be
> updated, the changes RTools might be accepted, and then RGtk2 (perhaps
> renamed RGtk4) might be uploadable to CRAN.
>
>  From this message, and Uwe's it's clear that the long-term future of
> RGtk2 depends on an update to Gtk4, and I've asked the maintainer about
> what the prospects of that might be:
> https://github.com/lawremi/RGtk2/issues/12

In principle it is easy to add any open-source software with a 
compatible license, but someone has to volunteer to do the work of 
adding it to and maintaining it in the software distributions used, and 
of persuading the maintainers of those distributions to accept it.

Tomas

>
> Best wishes,
>
> David
> The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336. Is e buidheann carthannais a th? ann an Oilthigh Dh?n ?ideann, cl?raichte an Alba, ?ireamh cl?raidh SC005336.


From j|nghu@zh@o @end|ng |rom hotm@||@com  Sat Feb 18 09:54:24 2023
From: j|nghu@zh@o @end|ng |rom hotm@||@com (jing hua zhao)
Date: Sat, 18 Feb 2023 08:54:24 +0000
Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer
In-Reply-To: <CWLP123MB4466AAB875E2104C6E9303C2A5DE9@CWLP123MB4466.GBRP123.PROD.OUTLOOK.COM>
References: <CAEbuDvKgn6YQM9LZRozRP_hzU0RXZEjVoPY4VVJu58xaMZrmvA@mail.gmail.com>
 <CWLP123MB4466FF7E7457266097A85896A5DE9@CWLP123MB4466.GBRP123.PROD.OUTLOOK.COM>
 <CANOYX1T5Vj=L+eWDqDHGXma5Verg6xN=jwCf-j=COB0mAGjQ0g@mail.gmail.com>
 <CAEbuDvKHCUXzv0LmnDyDjT+SM0qrLXr2-izH9vr8HEHM+6R4yw@mail.gmail.com>
 <CWLP123MB4466AAB875E2104C6E9303C2A5DE9@CWLP123MB4466.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CWLP123MB4466399775E58A1AD969885EA5A69@CWLP123MB4466.GBRP123.PROD.OUTLOOK.COM>

Hi Mike, Shota and all,

Upon update to Firefox 110 (ahead of the nightly 112) this morning the bug is also fixed.

BW,

Jing Hua
________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of jing hua zhao <jinghuazhao at hotmail.com>
Sent: 10 February 2023 22:06
To: Mike Blazanin <mikeblazanin at gmail.com>; Shota Ochi <shotaochi1990 at gmail.com>
Cc: r-package-devel at r-project.org <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer

The problem has been around for a while for me and thank you for raising it -- esp. with a fix!

Jing Hua
________________________________
From: Mike Blazanin <mikeblazanin at gmail.com>
Sent: 10 February 2023 16:29
To: Shota Ochi <shotaochi1990 at gmail.com>
Cc: jing hua zhao <jinghuazhao at hotmail.com>; r-package-devel at r-project.org <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer

[[elided Hotmail spam]]

Mike

On Fri, Feb 10, 2023 at 11:22 AM Shota Ochi <shotaochi1990 at gmail.com<mailto:shotaochi1990 at gmail.com>> wrote:
I reported the bug to bugzilla.

https://bugzilla.mozilla.org/show_bug.cgi?id=1816128

The bug is already fixed.
We should use higher version of firefox or firefox nightly.

2023$BG/(B2$B7n(B10$BF|(B($B6b(B) 22:23 jing hua zhao <jinghuazhao at hotmail.com<mailto:jinghuazhao at hotmail.com>>:
This is apparently  due to compression as needed fort package building, e.g., R CMD build --compact-vignettes=both --md5 --resave-data --log gap so mine has the same problem: https://cran.r-project.org/web/packages/gap/vignettes/jss.pdf
________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org<mailto:r-package-devel-bounces at r-project.org>> on behalf of Mike Blazanin <mikeblazanin at gmail.com<mailto:mikeblazanin at gmail.com>>
Sent: 09 February 2023 15:27
To: r-package-devel at r-project.org<mailto:r-package-devel at r-project.org> <r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>>
Subject: [R-pkg-devel] CRAN Vignette pdfs garbled in Firefox pdf viewer

Hi all, my package gcplyr has several vignettes which, from CRAN, appear
garbled when opened with Firefox's pdf viewer (
https://cran.r-project.org/web/packages/gcplyr/index.html). Specifically,
instead of regular characters, there are numerous black-outlined white
boxes with text inside like "EO 88" or "EO 55". This doesn't occur with the
pdf vignettes on Github (https://github.com/mikeblazanin/gcplyr/). This
also doesn't occur when CRAN pdfs are opened with Chrome's pdf viewer or

opened with a local pdf viewer.

The issue was documented here:
https://github.com/mikeblazanin/gcplyr/issues/112

Anyone have any suggestions for what could be causing this?

Thanks!
Mike Blazanin

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


--
Mike Blazanin

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From v@n|ko|@|d|@ @end|ng |rom uop@gr  Mon Feb 20 13:38:25 2023
From: v@n|ko|@|d|@ @end|ng |rom uop@gr (Vasileios Nikolaidis)
Date: Mon, 20 Feb 2023 14:38:25 +0200
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
Message-ID: <9f139ef7aa30500603cc4230b7346e81@uop.gr>

Dear R-developers, I apologize for posting something that has probably 
been discussed before (but missed it while searching the archives).

While trying to submit a newer version of my package to CRAN, it is 
rejected as it fails on Debian. I will call this package APACKAGE below 
(although it is named differently). It has passed all checks on my 
Windows system (no errors or warnings).

The package (for many versions now) is configured as follows:
Imports: 	Rcpp , methods
LinkingTo: 	Rcpp
Suggests: 	R.rsp

The previous version of the package (already on CRAN) shows no errors on 
CRAN checks, only NOTES for some platforms. Interestingly, a couple of 
days ago I checked the CRAN checks and noticed that this exact 
(previous) version of the package had one ERROR indicated, occurring in 
some Debian flavor (r-devel-linux-x86_64-debian-gcc, if I remember 
correctly). I changed nothing, but now it shows no errors for all 
platforms (including Debian).

Now I am trying to submit a newer version and it not accepted as it 
fails on Debian. Checking the log I see no syntax errors or warnings.

** testing if installed package can be loaded from temporary location
Error: package or namespace load failed for ?APACKAGE? in dyn.load(file, 
DLLpath = DLLpath, ...):
  unable to load shared object 
?/srv/hornik/tmp/CRAN/APACKAGE.Rcheck/00LOCK-APACKAGE/00new/APACKAGE/libs/APACKAGE.so?:
   
/srv/hornik/tmp/CRAN/APACKAGE.Rcheck/00LOCK-APACKAGE/00new/APACKAGE/libs/APACKAGE.so: 
undefined symbol: _ZTIN6nnlib25layerE
Error: loading failed.


I tried the R-Hub builder and it also fails for Platform Debian Linux, 
R-devel, GCC. The process goes fine until the following:

Error: package or namespace load failed for ?APACKAGE? in dyn.load(file, 
DLLpath = DLLpath, ...):
  unable to load shared object 
'/home/docker/R/00LOCK-APACKAGE/00new/APACKAGE/libs/APACKAGE.so':
   /home/docker/R/00LOCK-APACKAGE/00new/APACKAGE/libs/APACKAGE.so: 
undefined symbol: _ZTIN6nnlib25layerE
Error: loading failed
Execution halted
ERROR: loading failed
* removing ?/home/docker/R/APACKAGE?
Warning message:
In i.p(...) :
   installation of package 
?/tmp/Rtmp7eBDvE/file1377f5861e3/APACKAGE_0.2.0.tar.gz? had non-zero 
exit status

It maybe something obvious, but I really cannot think of what else to 
try to fix this issue.
Any help will be greatly appreciated.


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Mon Feb 20 19:52:16 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Mon, 20 Feb 2023 12:52:16 -0600
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
Message-ID: <81ce05ac-8666-39ad-4d50-e853d9601573@effectivedefense.org>

Hi, Vasileios:


	  Do you have it on GitHub?


	  If yes, do you use "GitHub Action" to test the package on multiple 
platforms?  I'm a contributor to the "fda" package.  It's version on 
GitHub is configured so every "git push" triggers auto tests on five 
different platforms, testing it against the current "release" version of 
R on the latest versions of macOS, Windows and Ubuntu plus the 
development and previous release on Ubuntu.[1]  I don't know if GitHub 
action would support testing under Debian nor if testing under Ubuntu 
would catch the problem that CRAN is catching on Debian.


	  However, having the package on GitHub also makes it easier for 
someone else to clone the package and test it it for you ;-) This 
community of R developers provides very valuable support for problems 
like this.


	  Hope this help.
	  Spencer Graves


[1]https://github.com/JamesRamsay5/fda/blob/master/.github/workflows/R-CMD-check.yaml


On 2/20/23 6:38 AM, Vasileios Nikolaidis wrote:
> Dear R-developers, I apologize for posting something that has probably 
> been discussed before (but missed it while searching the archives).
> 
> While trying to submit a newer version of my package to CRAN, it is 
> rejected as it fails on Debian. I will call this package APACKAGE below 
> (although it is named differently). It has passed all checks on my 
> Windows system (no errors or warnings).
> 
> The package (for many versions now) is configured as follows:
> Imports:???? Rcpp , methods
> LinkingTo:???? Rcpp
> Suggests:???? R.rsp
> 
> The previous version of the package (already on CRAN) shows no errors on 
> CRAN checks, only NOTES for some platforms. Interestingly, a couple of 
> days ago I checked the CRAN checks and noticed that this exact 
> (previous) version of the package had one ERROR indicated, occurring in 
> some Debian flavor (r-devel-linux-x86_64-debian-gcc, if I remember 
> correctly). I changed nothing, but now it shows no errors for all 
> platforms (including Debian).
> 
> Now I am trying to submit a newer version and it not accepted as it 
> fails on Debian. Checking the log I see no syntax errors or warnings.
> 
> ** testing if installed package can be loaded from temporary location
> Error: package or namespace load failed for ?APACKAGE? in dyn.load(file, 
> DLLpath = DLLpath, ...):
>  ?unable to load shared object 
> ?/srv/hornik/tmp/CRAN/APACKAGE.Rcheck/00LOCK-APACKAGE/00new/APACKAGE/libs/APACKAGE.so?:
> /srv/hornik/tmp/CRAN/APACKAGE.Rcheck/00LOCK-APACKAGE/00new/APACKAGE/libs/APACKAGE.so: undefined symbol: _ZTIN6nnlib25layerE
> Error: loading failed.
> 
> 
> I tried the R-Hub builder and it also fails for Platform Debian Linux, 
> R-devel, GCC. The process goes fine until the following:
> 
> Error: package or namespace load failed for ?APACKAGE? in dyn.load(file, 
> DLLpath = DLLpath, ...):
>  ?unable to load shared object 
> '/home/docker/R/00LOCK-APACKAGE/00new/APACKAGE/libs/APACKAGE.so':
>  ? /home/docker/R/00LOCK-APACKAGE/00new/APACKAGE/libs/APACKAGE.so: 
> undefined symbol: _ZTIN6nnlib25layerE
> Error: loading failed
> Execution halted
> ERROR: loading failed
> * removing ?/home/docker/R/APACKAGE?
> Warning message:
> In i.p(...) :
>  ? installation of package 
> ?/tmp/Rtmp7eBDvE/file1377f5861e3/APACKAGE_0.2.0.tar.gz? had non-zero 
> exit status
> 
> It maybe something obvious, but I really cannot think of what else to 
> try to fix this issue.
> Any help will be greatly appreciated.
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From v@n|ko|@|d|@ @end|ng |rom uop@gr  Mon Feb 20 20:15:55 2023
From: v@n|ko|@|d|@ @end|ng |rom uop@gr (Vasileios Nikolaidis)
Date: Mon, 20 Feb 2023 21:15:55 +0200
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <81ce05ac-8666-39ad-4d50-e853d9601573@effectivedefense.org>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <81ce05ac-8666-39ad-4d50-e853d9601573@effectivedefense.org>
Message-ID: <7a01994781241fd9c3815cbdbfe75c5c@uop.gr>

Hello Spencer and thank you for your reply.

This is a good point as the package is indeed on GitHub, so I will 
investigate it. But, like you pointed out, it is doubtful if testing on 
these other systems (including Ubuntu) will catch a problem that is 
reported on Debian.

And what causes it seems even more of a mystery to me.

Thanks again.
V.


???? 2023-02-20 20:52, Spencer Graves ??????:
> Hi, Vasileios:
> 
> 
> 	  Do you have it on GitHub?
> 
> 
> 	  If yes, do you use "GitHub Action" to test the package on multiple
> platforms?  I'm a contributor to the "fda" package.  It's version on
> GitHub is configured so every "git push" triggers auto tests on five
> different platforms, testing it against the current "release" version
> of R on the latest versions of macOS, Windows and Ubuntu plus the
> development and previous release on Ubuntu.[1]  I don't know if GitHub
> action would support testing under Debian nor if testing under Ubuntu
> would catch the problem that CRAN is catching on Debian.
> 
> 
> 	  However, having the package on GitHub also makes it easier for
> someone else to clone the package and test it it for you ;-) This
> community of R developers provides very valuable support for problems
> like this.
> 
> 
> 	  Hope this help.
> 	  Spencer Graves
> 
> 
> [1]https://github.com/JamesRamsay5/fda/blob/master/.github/workflows/R-CMD-check.yaml
> 
> 
> On 2/20/23 6:38 AM, Vasileios Nikolaidis wrote:
>> Dear R-developers, I apologize for posting something that has probably 
>> been discussed before (but missed it while searching the archives).
>> 
>> While trying to submit a newer version of my package to CRAN, it is 
>> rejected as it fails on Debian. I will call this package APACKAGE 
>> below (although it is named differently). It has passed all checks on 
>> my Windows system (no errors or warnings).
>> 
>> The package (for many versions now) is configured as follows:
>> Imports:???? Rcpp , methods
>> LinkingTo:???? Rcpp
>> Suggests:???? R.rsp
>> 
>> The previous version of the package (already on CRAN) shows no errors 
>> on CRAN checks, only NOTES for some platforms. Interestingly, a couple 
>> of days ago I checked the CRAN checks and noticed that this exact 
>> (previous) version of the package had one ERROR indicated, occurring 
>> in some Debian flavor (r-devel-linux-x86_64-debian-gcc, if I remember 
>> correctly). I changed nothing, but now it shows no errors for all 
>> platforms (including Debian).
>> 
>> Now I am trying to submit a newer version and it not accepted as it 
>> fails on Debian. Checking the log I see no syntax errors or warnings.
>> 
>> ** testing if installed package can be loaded from temporary location
>> Error: package or namespace load failed for ?APACKAGE? in 
>> dyn.load(file, DLLpath = DLLpath, ...):
>>  ?unable to load shared object 
>> ?/srv/hornik/tmp/CRAN/APACKAGE.Rcheck/00LOCK-APACKAGE/00new/APACKAGE/libs/APACKAGE.so?:
>> /srv/hornik/tmp/CRAN/APACKAGE.Rcheck/00LOCK-APACKAGE/00new/APACKAGE/libs/APACKAGE.so: 
>> undefined symbol: _ZTIN6nnlib25layerE
>> Error: loading failed.
>> 
>> 
>> I tried the R-Hub builder and it also fails for Platform Debian Linux, 
>> R-devel, GCC. The process goes fine until the following:
>> 
>> Error: package or namespace load failed for ?APACKAGE? in 
>> dyn.load(file, DLLpath = DLLpath, ...):
>>  ?unable to load shared object 
>> '/home/docker/R/00LOCK-APACKAGE/00new/APACKAGE/libs/APACKAGE.so':
>>  ? /home/docker/R/00LOCK-APACKAGE/00new/APACKAGE/libs/APACKAGE.so: 
>> undefined symbol: _ZTIN6nnlib25layerE
>> Error: loading failed
>> Execution halted
>> ERROR: loading failed
>> * removing ?/home/docker/R/APACKAGE?
>> Warning message:
>> In i.p(...) :
>>  ? installation of package 
>> ?/tmp/Rtmp7eBDvE/file1377f5861e3/APACKAGE_0.2.0.tar.gz? had non-zero 
>> exit status
>> 
>> It maybe something obvious, but I really cannot think of what else to 
>> try to fix this issue.
>> Any help will be greatly appreciated.
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From edd @end|ng |rom deb|@n@org  Mon Feb 20 20:23:29 2023
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 20 Feb 2023 13:23:29 -0600
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
Message-ID: <25587.51377.202386.848689@rob.eddelbuettel.com>


Can you share the repo URL?  It may be a a fairly simple and standard issue
some of us can spot easily.

Hth,  Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From v@n|ko|@|d|@ @end|ng |rom uop@gr  Mon Feb 20 20:41:51 2023
From: v@n|ko|@|d|@ @end|ng |rom uop@gr (Vasileios Nikolaidis)
Date: Mon, 20 Feb 2023 21:41:51 +0200
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <25587.51377.202386.848689@rob.eddelbuettel.com>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <25587.51377.202386.848689@rob.eddelbuettel.com>
Message-ID: <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>

Oh yes thank you. I just realized I did not mention the repo on my 
previous reply. It is
https://github.com/VNNikolaidis/nnlib2Rcpp

???? 2023-02-20 21:23, Dirk Eddelbuettel ??????:
> Can you share the repo URL?  It may be a a fairly simple and standard 
> issue
> some of us can spot easily.
> 
> Hth,  Dirk


From edd @end|ng |rom deb|@n@org  Mon Feb 20 21:06:05 2023
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 20 Feb 2023 14:06:05 -0600
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <25587.51377.202386.848689@rob.eddelbuettel.com>
 <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>
Message-ID: <25587.53933.900731.503495@rob.eddelbuettel.com>


On 20 February 2023 at 21:41, Vasileios Nikolaidis wrote:
| Oh yes thank you. I just realized I did not mention the repo on my 
| previous reply. It is
| https://github.com/VNNikolaidis/nnlib2Rcpp

Thanks for that -- I can confirm the error.

The packages compiles all source files without issue or warnings (under my
default flags), links and then fails to load with the error you reported:

  ** testing if installed package can be loaded from temporary location
  Error: package or namespace load failed for ?nnlib2Rcpp? in dyn.load(file, DLLpath = DLLpath, ...):
   unable to load shared object '/tmp/rcpp/lib/00LOCK-nnlib2Rcpp/00new/nnlib2Rcpp/libs/nnlib2Rcpp.so':
    /tmp/rcpp/lib/00LOCK-nnlib2Rcpp/00new/nnlib2Rcpp/libs/nnlib2Rcpp.so: undefined symbol: _ZTIN6nnlib25layerE
  Error: loading failed
  Execution halted
  ERROR: loading failed

Now, `c++filt` on that symbol reveals

  $ c++filt _ZTIN6nnlib25layerE
  typeinfo for nnlib2::layer
  $

and a glance at your header nnlib2::layer reveals that the class is virtual.
I don't have time right to do more digging but if I had to guess you may have
a slip up somewhere in your classes: something that worked beforehand with
your virtual (abstract) classes and derived (concrete) classes now seems to
want an concrete instance of 'layer'.  And if I had to guess some more the
reason this works in Windows is that the linker there is more lenient.

Maybe you can try an earlier version of nnlib2Rcpp and then bisect the
changes.  rhub gives you (fairly) easy access to Linux machines for builds
outside of your main Windows machine.

Sorry I cannot be of more help right now.

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From v@n|ko|@|d|@ @end|ng |rom uop@gr  Mon Feb 20 21:37:03 2023
From: v@n|ko|@|d|@ @end|ng |rom uop@gr (Vasileios Nikolaidis)
Date: Mon, 20 Feb 2023 22:37:03 +0200
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <25587.53933.900731.503495@rob.eddelbuettel.com>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <25587.51377.202386.848689@rob.eddelbuettel.com>
 <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>
 <25587.53933.900731.503495@rob.eddelbuettel.com>
Message-ID: <aa66ea2bf58c87674b62aed6c4824292@uop.gr>

Thanks for taking the time to check it. The hint about the virtual 
'layer' class is valuable.
I will look into it.
Best Regards,
V.Nikolaidis

PS I am tempted to set up a Debian test platform to speed up fixing the 
package.
(Or abandon submitting the package to CRAN alltogether.)



???? 2023-02-20 22:06, Dirk Eddelbuettel ??????:
> On 20 February 2023 at 21:41, Vasileios Nikolaidis wrote:
> | Oh yes thank you. I just realized I did not mention the repo on my
> | previous reply. It is
> | https://github.com/VNNikolaidis/nnlib2Rcpp
> 
> Thanks for that -- I can confirm the error.
> 
> The packages compiles all source files without issue or warnings (under 
> my
> default flags), links and then fails to load with the error you 
> reported:
> 
>   ** testing if installed package can be loaded from temporary location
>   Error: package or namespace load failed for ?nnlib2Rcpp? in
> dyn.load(file, DLLpath = DLLpath, ...):
>    unable to load shared object
> '/tmp/rcpp/lib/00LOCK-nnlib2Rcpp/00new/nnlib2Rcpp/libs/nnlib2Rcpp.so':
> 
> /tmp/rcpp/lib/00LOCK-nnlib2Rcpp/00new/nnlib2Rcpp/libs/nnlib2Rcpp.so:
> undefined symbol: _ZTIN6nnlib25layerE
>   Error: loading failed
>   Execution halted
>   ERROR: loading failed
> 
> Now, `c++filt` on that symbol reveals
> 
>   $ c++filt _ZTIN6nnlib25layerE
>   typeinfo for nnlib2::layer
>   $
> 
> and a glance at your header nnlib2::layer reveals that the class is 
> virtual.
> I don't have time right to do more digging but if I had to guess you 
> may have
> a slip up somewhere in your classes: something that worked beforehand 
> with
> your virtual (abstract) classes and derived (concrete) classes now 
> seems to
> want an concrete instance of 'layer'.  And if I had to guess some more 
> the
> reason this works in Windows is that the linker there is more lenient.
> 
> Maybe you can try an earlier version of nnlib2Rcpp and then bisect the
> changes.  rhub gives you (fairly) easy access to Linux machines for 
> builds
> outside of your main Windows machine.
> 
> Sorry I cannot be of more help right now.
> 
> Dirk


From edd @end|ng |rom deb|@n@org  Mon Feb 20 22:09:58 2023
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 20 Feb 2023 15:09:58 -0600
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <aa66ea2bf58c87674b62aed6c4824292@uop.gr>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <25587.51377.202386.848689@rob.eddelbuettel.com>
 <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>
 <25587.53933.900731.503495@rob.eddelbuettel.com>
 <aa66ea2bf58c87674b62aed6c4824292@uop.gr>
Message-ID: <25587.57766.240718.390310@rob.eddelbuettel.com>


On 20 February 2023 at 22:37, Vasileios Nikolaidis wrote:
| Thanks for taking the time to check it. The hint about the virtual 
| 'layer' class is valuable.
| I will look into it.

Sounds good, glad to have been of assistance.  On a lark, I also tried your
most recent CRAN release, and it installs and loads fine here.
 
| PS I am tempted to set up a Debian test platform to speed up fixing the 
| package.
| (Or abandon submitting the package to CRAN alltogether.)

I love working on Linux. And these days I hear from some friends that having
WSL2 on a (recent enough) Windows computer is also good as it effectively
gives a second machine with Ubuntu on it.  Docker can also be helpful, as are
the online resources -- rhub has helped me with both macos and windows builds.

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From v@n|ko|@|d|@ @end|ng |rom uop@gr  Tue Feb 21 09:34:23 2023
From: v@n|ko|@|d|@ @end|ng |rom uop@gr (Vasileios Nikolaidis)
Date: Tue, 21 Feb 2023 10:34:23 +0200
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <25587.57766.240718.390310@rob.eddelbuettel.com>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <25587.51377.202386.848689@rob.eddelbuettel.com>
 <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>
 <25587.53933.900731.503495@rob.eddelbuettel.com>
 <aa66ea2bf58c87674b62aed6c4824292@uop.gr>
 <25587.57766.240718.390310@rob.eddelbuettel.com>
Message-ID: <2fa635d315f271fb4d52de1a7d94c4d7@uop.gr>

Yes, with all this I can think where I may have messed up. So thanks for 
the help, at least it verified it is indeed an issue with the code. As 
far as OSs, I use Ubuntu variants a lot and (on several machines) but 
these days I have easier access to Windows (with WSL2 btw). I also like 
a strict compiler (and linker), there is usually a reason why they are 
strict. So if it is not obvious from examining the code,  I will set up 
something (be it WSL, VM or Docker) for testing.

Thanks again,

Vasilis



???? 2023-02-20 23:09, Dirk Eddelbuettel ??????:
> On 20 February 2023 at 22:37, Vasileios Nikolaidis wrote:
> | Thanks for taking the time to check it. The hint about the virtual
> | 'layer' class is valuable.
> | I will look into it.
> 
> Sounds good, glad to have been of assistance.  On a lark, I also tried 
> your
> most recent CRAN release, and it installs and loads fine here.
> 
> | PS I am tempted to set up a Debian test platform to speed up fixing 
> the
> | package.
> | (Or abandon submitting the package to CRAN alltogether.)
> 
> I love working on Linux. And these days I hear from some friends that 
> having
> WSL2 on a (recent enough) Windows computer is also good as it 
> effectively
> gives a second machine with Ubuntu on it.  Docker can also be helpful, 
> as are
> the online resources -- rhub has helped me with both macos and windows 
> builds.
> 
> Dirk


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Tue Feb 21 12:25:39 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Tue, 21 Feb 2023 05:25:39 -0600
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <2fa635d315f271fb4d52de1a7d94c4d7@uop.gr>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <25587.51377.202386.848689@rob.eddelbuettel.com>
 <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>
 <25587.53933.900731.503495@rob.eddelbuettel.com>
 <aa66ea2bf58c87674b62aed6c4824292@uop.gr>
 <25587.57766.240718.390310@rob.eddelbuettel.com>
 <2fa635d315f271fb4d52de1a7d94c4d7@uop.gr>
Message-ID: <1f3ec96c-aebf-f5ff-5331-6196a39fc552@effectivedefense.org>



On 2/21/23 2:34 AM, Vasileios Nikolaidis wrote:
> Yes, with all this I can think where I may have messed up. So thanks for 
> the help, at least it verified it is indeed an issue with the code. As 
> far as OSs, I use Ubuntu variants a lot and (on several machines) but 
> these days I have easier access to Windows (with WSL2 btw). I also like 
> a strict compiler (and linker), there is usually a reason why they are 
> strict. So if it is not obvious from examining the code,? I will set up 
> something (be it WSL, VM or Docker) for testing.


	  If you have NOT tried "GitHub Action" yet, I highly recommend it. 
For my packages, every time I do "git push", it automatically runs "R 
CMD build / check" on 5 different platforms -- with no further effort on 
my part other than checking the results.


	  It should be easy to get something to work following the instructions 
in Wickham and Bryan, R Packages[1] or copying the code from another 
package.[2] If that fails, you might be able to get help from this list. 
  I got valuable suggestions from Dir Eddelbuettel and Duncan Murdoch.


	  I don't know if any version of Debian is available on GitHub Action. 
However, if CRAN is rejecting your package on GitHub Action, a question 
about that to this list might help make it available.  If you have 
special Ubuntu configuration issues that are not provided in the 
standard GitHub Action configurations, asking here might help you with 
that.


	  Hope this helps,
	  Spencer Graves


[1]


https://r-pkgs.org


[2] e.g.,


https://github.com/JamesRamsay5/fda

> 
> Thanks again,
> 
> Vasilis
> 
> 
> 
> ???? 2023-02-20 23:09, Dirk Eddelbuettel ??????:
>> On 20 February 2023 at 22:37, Vasileios Nikolaidis wrote:
>> | Thanks for taking the time to check it. The hint about the virtual
>> | 'layer' class is valuable.
>> | I will look into it.
>>
>> Sounds good, glad to have been of assistance.? On a lark, I also tried 
>> your
>> most recent CRAN release, and it installs and loads fine here.
>>
>> | PS I am tempted to set up a Debian test platform to speed up fixing the
>> | package.
>> | (Or abandon submitting the package to CRAN alltogether.)
>>
>> I love working on Linux. And these days I hear from some friends that 
>> having
>> WSL2 on a (recent enough) Windows computer is also good as it effectively
>> gives a second machine with Ubuntu on it.? Docker can also be helpful, 
>> as are
>> the online resources -- rhub has helped me with both macos and windows 
>> builds.
>>
>> Dirk
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From v@n|ko|@|d|@ @end|ng |rom uop@gr  Tue Feb 21 12:39:41 2023
From: v@n|ko|@|d|@ @end|ng |rom uop@gr (Vasileios Nikolaidis)
Date: Tue, 21 Feb 2023 13:39:41 +0200
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <1f3ec96c-aebf-f5ff-5331-6196a39fc552@effectivedefense.org>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <25587.51377.202386.848689@rob.eddelbuettel.com>
 <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>
 <25587.53933.900731.503495@rob.eddelbuettel.com>
 <aa66ea2bf58c87674b62aed6c4824292@uop.gr>
 <25587.57766.240718.390310@rob.eddelbuettel.com>
 <2fa635d315f271fb4d52de1a7d94c4d7@uop.gr>
 <1f3ec96c-aebf-f5ff-5331-6196a39fc552@effectivedefense.org>
Message-ID: <08567a8f3266bfbcbcb22ee3408a5bc3@uop.gr>

I will try it the "Github Action" it seems very useful indeed.

I already found the (extremely obvious and tiny) error that caused all 
this mess. I am surprised the compile/link system on my Windows machine 
passed on that without reporting anything. That really threw me off on 
what the cause may be. Getting back on Linux for development and checks 
(like I used to use and trust).

Problem solved, moral of the story is never code tired, and use all 
tools available.
Thank you everyone for your comments and help.

Regards,
Vasilis.


???? 2023-02-21 13:25, Spencer Graves ??????:
> On 2/21/23 2:34 AM, Vasileios Nikolaidis wrote:
>> Yes, with all this I can think where I may have messed up. So thanks 
>> for the help, at least it verified it is indeed an issue with the 
>> code. As far as OSs, I use Ubuntu variants a lot and (on several 
>> machines) but these days I have easier access to Windows (with WSL2 
>> btw). I also like a strict compiler (and linker), there is usually a 
>> reason why they are strict. So if it is not obvious from examining the 
>> code,? I will set up something (be it WSL, VM or Docker) for testing.
> 
> 
> 	  If you have NOT tried "GitHub Action" yet, I highly recommend it.
> For my packages, every time I do "git push", it automatically runs "R
> CMD build / check" on 5 different platforms -- with no further effort
> on my part other than checking the results.
> 
> 
> 	  It should be easy to get something to work following the
> instructions in Wickham and Bryan, R Packages[1] or copying the code
> from another package.[2] If that fails, you might be able to get help
> from this list.  I got valuable suggestions from Dir Eddelbuettel and
> Duncan Murdoch.
> 
> 
> 	  I don't know if any version of Debian is available on GitHub
> Action. However, if CRAN is rejecting your package on GitHub Action, a
> question about that to this list might help make it available.  If you
> have special Ubuntu configuration issues that are not provided in the
> standard GitHub Action configurations, asking here might help you with
> that.
> 
> 
> 	  Hope this helps,
> 	  Spencer Graves
> 
> 
> [1]
> 
> 
> https://r-pkgs.org
> 
> 
> [2] e.g.,
> 
> 
> https://github.com/JamesRamsay5/fda
> 
>> 
>> Thanks again,
>> 
>> Vasilis
>> 
>> 
>> 
>> ???? 2023-02-20 23:09, Dirk Eddelbuettel ??????:
>>> On 20 February 2023 at 22:37, Vasileios Nikolaidis wrote:
>>> | Thanks for taking the time to check it. The hint about the virtual
>>> | 'layer' class is valuable.
>>> | I will look into it.
>>> 
>>> Sounds good, glad to have been of assistance.? On a lark, I also 
>>> tried your
>>> most recent CRAN release, and it installs and loads fine here.
>>> 
>>> | PS I am tempted to set up a Debian test platform to speed up fixing 
>>> the
>>> | package.
>>> | (Or abandon submitting the package to CRAN alltogether.)
>>> 
>>> I love working on Linux. And these days I hear from some friends that 
>>> having
>>> WSL2 on a (recent enough) Windows computer is also good as it 
>>> effectively
>>> gives a second machine with Ubuntu on it.? Docker can also be 
>>> helpful, as are
>>> the online resources -- rhub has helped me with both macos and 
>>> windows builds.
>>> 
>>> Dirk
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Thu Feb 23 17:29:44 2023
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Thu, 23 Feb 2023 17:29:44 +0100
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <1f3ec96c-aebf-f5ff-5331-6196a39fc552@effectivedefense.org>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <25587.51377.202386.848689@rob.eddelbuettel.com>
 <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>
 <25587.53933.900731.503495@rob.eddelbuettel.com>
 <aa66ea2bf58c87674b62aed6c4824292@uop.gr>
 <25587.57766.240718.390310@rob.eddelbuettel.com>
 <2fa635d315f271fb4d52de1a7d94c4d7@uop.gr>
 <1f3ec96c-aebf-f5ff-5331-6196a39fc552@effectivedefense.org>
Message-ID: <25591.38008.892584.500445@stat.math.ethz.ch>

>>>>> Spencer Graves 
>>>>>     on Tue, 21 Feb 2023 05:25:39 -0600 writes:

    > On 2/21/23 2:34 AM, Vasileios Nikolaidis wrote:
    >> Yes, with all this I can think where I may have messed up. So thanks for 
    >> the help, at least it verified it is indeed an issue with the code. As 
    >> far as OSs, I use Ubuntu variants a lot and (on several machines) but 
    >> these days I have easier access to Windows (with WSL2 btw). I also like 
    >> a strict compiler (and linker), there is usually a reason why they are 
    >> strict. So if it is not obvious from examining the code,? I will set up 
    >> something (be it WSL, VM or Docker) for testing.


    > If you have NOT tried "GitHub Action" yet, I highly recommend it. 
    > For my packages, every time I do "git push", it automatically runs "R 
    > CMD build / check" on 5 different platforms -- with no further effort on 
    > my part other than checking the results.

[ Sorry, but for once I'd like to raise this here ...]:

well... how many "trees" does that cost every time you push?
I guess it will be less than one, but I'd also guess it be more
than 1% of one.. and even if that was more than reality, ...

I hope you are all aware that even though this looks "free", all
this mostly unnecessary (rebuilding some of the things *every*
time from scratch, downloading lots of stuff, even though from a
closeby server) traffic and server run time will partly be paid
by the kids and grand kids of people living in Bangladesh,
Polynesia, ... (and maybe even in say Amsterdam)
Global Warming *is* a threat, and we living in rich nations letting run
more and more computer networks and servers (cooling, heating,
gray energy including lots of CO2 produce by building construction, ...)
does add to it.

[[[yes, I may be partly wrong,  and
    no, it's a loss of time if we start a flame/mud/... war here about this;
    just consider it a small outlier voice ...
]]]


    > It should be easy to get something to work following the instructions 
    > in Wickham and Bryan, R Packages[1] or copying the code from another 
    > package.[2] If that fails, you might be able to get help from this list. 
    > I got valuable suggestions from Dir Eddelbuettel and Duncan Murdoch.


    > I don't know if any version of Debian is available on GitHub Action. 
    > However, if CRAN is rejecting your package on GitHub Action, a question 
    > about that to this list might help make it available.  If you have 
    > special Ubuntu configuration issues that are not provided in the 
    > standard GitHub Action configurations, asking here might help you with 
    > that.


    > Hope this helps,
    > Spencer Graves


    > [1]


    > https://r-pkgs.org


    > [2] e.g.,


    > https://github.com/JamesRamsay5/fda

    >> 
    >> Thanks again,
    >> 
    >> Vasilis
    >> 
    >> 
    >> 
    >> ???? 2023-02-20 23:09, Dirk Eddelbuettel ??????:
    >>> On 20 February 2023 at 22:37, Vasileios Nikolaidis wrote:
    >>> | Thanks for taking the time to check it. The hint about the virtual
    >>> | 'layer' class is valuable.
    >>> | I will look into it.
    >>> 
    >>> Sounds good, glad to have been of assistance.? On a lark, I also tried 
    >>> your
    >>> most recent CRAN release, and it installs and loads fine here.
    >>> 
    >>> | PS I am tempted to set up a Debian test platform to speed up fixing the
    >>> | package.
    >>> | (Or abandon submitting the package to CRAN alltogether.)
    >>> 
    >>> I love working on Linux. And these days I hear from some friends that 
    >>> having
    >>> WSL2 on a (recent enough) Windows computer is also good as it effectively
    >>> gives a second machine with Ubuntu on it.? Docker can also be helpful, 
    >>> as are
    >>> the online resources -- rhub has helped me with both macos and windows 
    >>> builds.
    >>> 
    >>> Dirk
    >> 
    >> ______________________________________________
    >> R-package-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-package-devel

    > ______________________________________________
    > R-package-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Feb 23 18:59:35 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 23 Feb 2023 12:59:35 -0500
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <25591.38008.892584.500445@stat.math.ethz.ch>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <25587.51377.202386.848689@rob.eddelbuettel.com>
 <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>
 <25587.53933.900731.503495@rob.eddelbuettel.com>
 <aa66ea2bf58c87674b62aed6c4824292@uop.gr>
 <25587.57766.240718.390310@rob.eddelbuettel.com>
 <2fa635d315f271fb4d52de1a7d94c4d7@uop.gr>
 <1f3ec96c-aebf-f5ff-5331-6196a39fc552@effectivedefense.org>
 <25591.38008.892584.500445@stat.math.ethz.ch>
Message-ID: <a0707643-814a-09e0-7dae-79fc709a4134@gmail.com>

Hi Martin.

I think your calculations are way off.  A one-tonne tree contains about 
5000 kWh of energy.  A typical computer server uses about 200 watts, and 
can process many jobs simultaneously on different cores, but let's say 
the whole server is dedicated to the Github action.  Then it would 
consume 1 kWh in 5 hours, and would take about 10 days to consume 1% of 
a tree.

Duncan Murdoch

On 23/02/2023 11:29 a.m., Martin Maechler wrote:
>>>>>> Spencer Graves
>>>>>>      on Tue, 21 Feb 2023 05:25:39 -0600 writes:
> 
>      > On 2/21/23 2:34 AM, Vasileios Nikolaidis wrote:
>      >> Yes, with all this I can think where I may have messed up. So thanks for
>      >> the help, at least it verified it is indeed an issue with the code. As
>      >> far as OSs, I use Ubuntu variants a lot and (on several machines) but
>      >> these days I have easier access to Windows (with WSL2 btw). I also like
>      >> a strict compiler (and linker), there is usually a reason why they are
>      >> strict. So if it is not obvious from examining the code,? I will set up
>      >> something (be it WSL, VM or Docker) for testing.
> 
> 
>      > If you have NOT tried "GitHub Action" yet, I highly recommend it.
>      > For my packages, every time I do "git push", it automatically runs "R
>      > CMD build / check" on 5 different platforms -- with no further effort on
>      > my part other than checking the results.
> 
> [ Sorry, but for once I'd like to raise this here ...]:
> 
> well... how many "trees" does that cost every time you push?
> I guess it will be less than one, but I'd also guess it be more
> than 1% of one.. and even if that was more than reality, ...
> 
> I hope you are all aware that even though this looks "free", all
> this mostly unnecessary (rebuilding some of the things *every*
> time from scratch, downloading lots of stuff, even though from a
> closeby server) traffic and server run time will partly be paid
> by the kids and grand kids of people living in Bangladesh,
> Polynesia, ... (and maybe even in say Amsterdam)
> Global Warming *is* a threat, and we living in rich nations letting run
> more and more computer networks and servers (cooling, heating,
> gray energy including lots of CO2 produce by building construction, ...)
> does add to it.
> 
> [[[yes, I may be partly wrong,  and
>      no, it's a loss of time if we start a flame/mud/... war here about this;
>      just consider it a small outlier voice ...
> ]]]
> 
> 
>      > It should be easy to get something to work following the instructions
>      > in Wickham and Bryan, R Packages[1] or copying the code from another
>      > package.[2] If that fails, you might be able to get help from this list.
>      > I got valuable suggestions from Dir Eddelbuettel and Duncan Murdoch.
> 
> 
>      > I don't know if any version of Debian is available on GitHub Action.
>      > However, if CRAN is rejecting your package on GitHub Action, a question
>      > about that to this list might help make it available.  If you have
>      > special Ubuntu configuration issues that are not provided in the
>      > standard GitHub Action configurations, asking here might help you with
>      > that.
> 
> 
>      > Hope this helps,
>      > Spencer Graves
> 
> 
>      > [1]
> 
> 
>      > https://r-pkgs.org
> 
> 
>      > [2] e.g.,
> 
> 
>      > https://github.com/JamesRamsay5/fda
> 
>      >>
>      >> Thanks again,
>      >>
>      >> Vasilis
>      >>
>      >>
>      >>
>      >> ???? 2023-02-20 23:09, Dirk Eddelbuettel ??????:
>      >>> On 20 February 2023 at 22:37, Vasileios Nikolaidis wrote:
>      >>> | Thanks for taking the time to check it. The hint about the virtual
>      >>> | 'layer' class is valuable.
>      >>> | I will look into it.
>      >>>
>      >>> Sounds good, glad to have been of assistance.? On a lark, I also tried
>      >>> your
>      >>> most recent CRAN release, and it installs and loads fine here.
>      >>>
>      >>> | PS I am tempted to set up a Debian test platform to speed up fixing the
>      >>> | package.
>      >>> | (Or abandon submitting the package to CRAN alltogether.)
>      >>>
>      >>> I love working on Linux. And these days I hear from some friends that
>      >>> having
>      >>> WSL2 on a (recent enough) Windows computer is also good as it effectively
>      >>> gives a second machine with Ubuntu on it.? Docker can also be helpful,
>      >>> as are
>      >>> the online resources -- rhub has helped me with both macos and windows
>      >>> builds.
>      >>>
>      >>> Dirk
>      >>
>      >> ______________________________________________
>      >> R-package-devel at r-project.org mailing list
>      >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
>      > ______________________________________________
>      > R-package-devel at r-project.org mailing list
>      > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From bbo|ker @end|ng |rom gm@||@com  Thu Feb 23 19:11:48 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Thu, 23 Feb 2023 13:11:48 -0500
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <a0707643-814a-09e0-7dae-79fc709a4134@gmail.com>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <25587.51377.202386.848689@rob.eddelbuettel.com>
 <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>
 <25587.53933.900731.503495@rob.eddelbuettel.com>
 <aa66ea2bf58c87674b62aed6c4824292@uop.gr>
 <25587.57766.240718.390310@rob.eddelbuettel.com>
 <2fa635d315f271fb4d52de1a7d94c4d7@uop.gr>
 <1f3ec96c-aebf-f5ff-5331-6196a39fc552@effectivedefense.org>
 <25591.38008.892584.500445@stat.math.ethz.ch>
 <a0707643-814a-09e0-7dae-79fc709a4134@gmail.com>
Message-ID: <45fdc9c7-7f97-7d3b-04d4-4fc6abaf96b8@gmail.com>

   Not important (of course) but where does the 5000 kWh per tree number 
come from?  Is that (dry weight) x (50% carbon per dry weight) / (carbon 
content of CO2 emissions per kWh) ?

https://www.epa.gov/energy/greenhouse-gas-equivalencies-calculator#results

   If we say 200 watts x 15 minutes (allowing us to take up the whole 
server for checking on 5 different platforms) we have .05 kWh. Let's say 
we do this 300 times/year for a package, so 15 kWh. Hard to get 'tree 
equivalents' from the EPA web site, but this is equivalent to 1.2 
gallons of petrol/gasoline consumption (0.011 metric tonnes)


On 2023-02-23 12:59 p.m., Duncan Murdoch wrote:
> Hi Martin.
> 
> I think your calculations are way off.? A one-tonne tree contains about 
> 5000 kWh of energy.? A typical computer server uses about 200 watts, and 
> can process many jobs simultaneously on different cores, but let's say 
> the whole server is dedicated to the Github action.? Then it would 
> consume 1 kWh in 5 hours, and would take about 10 days to consume 1% of 
> a tree.
> 
> Duncan Murdoch
> 
> On 23/02/2023 11:29 a.m., Martin Maechler wrote:
>>>>>>> Spencer Graves
>>>>>>> ???? on Tue, 21 Feb 2023 05:25:39 -0600 writes:
>>
>> ???? > On 2/21/23 2:34 AM, Vasileios Nikolaidis wrote:
>> ???? >> Yes, with all this I can think where I may have messed up. So 
>> thanks for
>> ???? >> the help, at least it verified it is indeed an issue with the 
>> code. As
>> ???? >> far as OSs, I use Ubuntu variants a lot and (on several 
>> machines) but
>> ???? >> these days I have easier access to Windows (with WSL2 btw). I 
>> also like
>> ???? >> a strict compiler (and linker), there is usually a reason why 
>> they are
>> ???? >> strict. So if it is not obvious from examining the code,? I 
>> will set up
>> ???? >> something (be it WSL, VM or Docker) for testing.
>>
>>
>> ???? > If you have NOT tried "GitHub Action" yet, I highly recommend it.
>> ???? > For my packages, every time I do "git push", it automatically 
>> runs "R
>> ???? > CMD build / check" on 5 different platforms -- with no further 
>> effort on
>> ???? > my part other than checking the results.
>>
>> [ Sorry, but for once I'd like to raise this here ...]:
>>
>> well... how many "trees" does that cost every time you push?
>> I guess it will be less than one, but I'd also guess it be more
>> than 1% of one.. and even if that was more than reality, ...
>>
>> I hope you are all aware that even though this looks "free", all
>> this mostly unnecessary (rebuilding some of the things *every*
>> time from scratch, downloading lots of stuff, even though from a
>> closeby server) traffic and server run time will partly be paid
>> by the kids and grand kids of people living in Bangladesh,
>> Polynesia, ... (and maybe even in say Amsterdam)
>> Global Warming *is* a threat, and we living in rich nations letting run
>> more and more computer networks and servers (cooling, heating,
>> gray energy including lots of CO2 produce by building construction, ...)
>> does add to it.
>>
>> [[[yes, I may be partly wrong,? and
>> ???? no, it's a loss of time if we start a flame/mud/... war here 
>> about this;
>> ???? just consider it a small outlier voice ...
>> ]]]
>>
>>
>> ???? > It should be easy to get something to work following the 
>> instructions
>> ???? > in Wickham and Bryan, R Packages[1] or copying the code from 
>> another
>> ???? > package.[2] If that fails, you might be able to get help from 
>> this list.
>> ???? > I got valuable suggestions from Dir Eddelbuettel and Duncan 
>> Murdoch.
>>
>>
>> ???? > I don't know if any version of Debian is available on GitHub 
>> Action.
>> ???? > However, if CRAN is rejecting your package on GitHub Action, a 
>> question
>> ???? > about that to this list might help make it available.? If you have
>> ???? > special Ubuntu configuration issues that are not provided in the
>> ???? > standard GitHub Action configurations, asking here might help 
>> you with
>> ???? > that.
>>
>>
>> ???? > Hope this helps,
>> ???? > Spencer Graves
>>
>>
>> ???? > [1]
>>
>>
>> ???? > https://r-pkgs.org
>>
>>
>> ???? > [2] e.g.,
>>
>>
>> ???? > https://github.com/JamesRamsay5/fda
>>
>> ???? >>
>> ???? >> Thanks again,
>> ???? >>
>> ???? >> Vasilis
>> ???? >>
>> ???? >>
>> ???? >>
>> ???? >> ???? 2023-02-20 23:09, Dirk Eddelbuettel ??????:
>> ???? >>> On 20 February 2023 at 22:37, Vasileios Nikolaidis wrote:
>> ???? >>> | Thanks for taking the time to check it. The hint about the 
>> virtual
>> ???? >>> | 'layer' class is valuable.
>> ???? >>> | I will look into it.
>> ???? >>>
>> ???? >>> Sounds good, glad to have been of assistance.? On a lark, I 
>> also tried
>> ???? >>> your
>> ???? >>> most recent CRAN release, and it installs and loads fine here.
>> ???? >>>
>> ???? >>> | PS I am tempted to set up a Debian test platform to speed 
>> up fixing the
>> ???? >>> | package.
>> ???? >>> | (Or abandon submitting the package to CRAN alltogether.)
>> ???? >>>
>> ???? >>> I love working on Linux. And these days I hear from some 
>> friends that
>> ???? >>> having
>> ???? >>> WSL2 on a (recent enough) Windows computer is also good as it 
>> effectively
>> ???? >>> gives a second machine with Ubuntu on it.? Docker can also be 
>> helpful,
>> ???? >>> as are
>> ???? >>> the online resources -- rhub has helped me with both macos 
>> and windows
>> ???? >>> builds.
>> ???? >>>
>> ???? >>> Dirk
>> ???? >>
>> ???? >> ______________________________________________
>> ???? >> R-package-devel at r-project.org mailing list
>> ???? >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ???? > ______________________________________________
>> ???? > R-package-devel at r-project.org mailing list
>> ???? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Feb 23 19:50:07 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 23 Feb 2023 13:50:07 -0500
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <45fdc9c7-7f97-7d3b-04d4-4fc6abaf96b8@gmail.com>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <25587.51377.202386.848689@rob.eddelbuettel.com>
 <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>
 <25587.53933.900731.503495@rob.eddelbuettel.com>
 <aa66ea2bf58c87674b62aed6c4824292@uop.gr>
 <25587.57766.240718.390310@rob.eddelbuettel.com>
 <2fa635d315f271fb4d52de1a7d94c4d7@uop.gr>
 <1f3ec96c-aebf-f5ff-5331-6196a39fc552@effectivedefense.org>
 <25591.38008.892584.500445@stat.math.ethz.ch>
 <a0707643-814a-09e0-7dae-79fc709a4134@gmail.com>
 <45fdc9c7-7f97-7d3b-04d4-4fc6abaf96b8@gmail.com>
Message-ID: <d2b3f0a7-365f-88f6-9505-c96c6abe2e0c@gmail.com>

On 23/02/2023 1:11 p.m., Ben Bolker wrote:
>     Not important (of course) but where does the 5000 kWh per tree number
> come from?  Is that (dry weight) x (50% carbon per dry weight) / (carbon
> content of CO2 emissions per kWh) ?

That's just made up, but it is close to the numbers here for dry wood:

   https://wood-energy.extension.org/energy-basics/

The 1 tonne weight of dry wood for a "tree" is also made up.

Duncan

> 
> https://www.epa.gov/energy/greenhouse-gas-equivalencies-calculator#results
> 
>     If we say 200 watts x 15 minutes (allowing us to take up the whole
> server for checking on 5 different platforms) we have .05 kWh. Let's say
> we do this 300 times/year for a package, so 15 kWh. Hard to get 'tree
> equivalents' from the EPA web site, but this is equivalent to 1.2
> gallons of petrol/gasoline consumption (0.011 metric tonnes)
> 
> 
> On 2023-02-23 12:59 p.m., Duncan Murdoch wrote:
>> Hi Martin.
>>
>> I think your calculations are way off.? A one-tonne tree contains about
>> 5000 kWh of energy.? A typical computer server uses about 200 watts, and
>> can process many jobs simultaneously on different cores, but let's say
>> the whole server is dedicated to the Github action.? Then it would
>> consume 1 kWh in 5 hours, and would take about 10 days to consume 1% of
>> a tree.
>>
>> Duncan Murdoch
>>
>> On 23/02/2023 11:29 a.m., Martin Maechler wrote:
>>>>>>>> Spencer Graves
>>>>>>>>  ???? on Tue, 21 Feb 2023 05:25:39 -0600 writes:
>>>
>>>  ???? > On 2/21/23 2:34 AM, Vasileios Nikolaidis wrote:
>>>  ???? >> Yes, with all this I can think where I may have messed up. So
>>> thanks for
>>>  ???? >> the help, at least it verified it is indeed an issue with the
>>> code. As
>>>  ???? >> far as OSs, I use Ubuntu variants a lot and (on several
>>> machines) but
>>>  ???? >> these days I have easier access to Windows (with WSL2 btw). I
>>> also like
>>>  ???? >> a strict compiler (and linker), there is usually a reason why
>>> they are
>>>  ???? >> strict. So if it is not obvious from examining the code,? I
>>> will set up
>>>  ???? >> something (be it WSL, VM or Docker) for testing.
>>>
>>>
>>>  ???? > If you have NOT tried "GitHub Action" yet, I highly recommend it.
>>>  ???? > For my packages, every time I do "git push", it automatically
>>> runs "R
>>>  ???? > CMD build / check" on 5 different platforms -- with no further
>>> effort on
>>>  ???? > my part other than checking the results.
>>>
>>> [ Sorry, but for once I'd like to raise this here ...]:
>>>
>>> well... how many "trees" does that cost every time you push?
>>> I guess it will be less than one, but I'd also guess it be more
>>> than 1% of one.. and even if that was more than reality, ...
>>>
>>> I hope you are all aware that even though this looks "free", all
>>> this mostly unnecessary (rebuilding some of the things *every*
>>> time from scratch, downloading lots of stuff, even though from a
>>> closeby server) traffic and server run time will partly be paid
>>> by the kids and grand kids of people living in Bangladesh,
>>> Polynesia, ... (and maybe even in say Amsterdam)
>>> Global Warming *is* a threat, and we living in rich nations letting run
>>> more and more computer networks and servers (cooling, heating,
>>> gray energy including lots of CO2 produce by building construction, ...)
>>> does add to it.
>>>
>>> [[[yes, I may be partly wrong,? and
>>>  ???? no, it's a loss of time if we start a flame/mud/... war here
>>> about this;
>>>  ???? just consider it a small outlier voice ...
>>> ]]]
>>>
>>>
>>>  ???? > It should be easy to get something to work following the
>>> instructions
>>>  ???? > in Wickham and Bryan, R Packages[1] or copying the code from
>>> another
>>>  ???? > package.[2] If that fails, you might be able to get help from
>>> this list.
>>>  ???? > I got valuable suggestions from Dir Eddelbuettel and Duncan
>>> Murdoch.
>>>
>>>
>>>  ???? > I don't know if any version of Debian is available on GitHub
>>> Action.
>>>  ???? > However, if CRAN is rejecting your package on GitHub Action, a
>>> question
>>>  ???? > about that to this list might help make it available.? If you have
>>>  ???? > special Ubuntu configuration issues that are not provided in the
>>>  ???? > standard GitHub Action configurations, asking here might help
>>> you with
>>>  ???? > that.
>>>
>>>
>>>  ???? > Hope this helps,
>>>  ???? > Spencer Graves
>>>
>>>
>>>  ???? > [1]
>>>
>>>
>>>  ???? > https://r-pkgs.org
>>>
>>>
>>>  ???? > [2] e.g.,
>>>
>>>
>>>  ???? > https://github.com/JamesRamsay5/fda
>>>
>>>  ???? >>
>>>  ???? >> Thanks again,
>>>  ???? >>
>>>  ???? >> Vasilis
>>>  ???? >>
>>>  ???? >>
>>>  ???? >>
>>>  ???? >> ???? 2023-02-20 23:09, Dirk Eddelbuettel ??????:
>>>  ???? >>> On 20 February 2023 at 22:37, Vasileios Nikolaidis wrote:
>>>  ???? >>> | Thanks for taking the time to check it. The hint about the
>>> virtual
>>>  ???? >>> | 'layer' class is valuable.
>>>  ???? >>> | I will look into it.
>>>  ???? >>>
>>>  ???? >>> Sounds good, glad to have been of assistance.? On a lark, I
>>> also tried
>>>  ???? >>> your
>>>  ???? >>> most recent CRAN release, and it installs and loads fine here.
>>>  ???? >>>
>>>  ???? >>> | PS I am tempted to set up a Debian test platform to speed
>>> up fixing the
>>>  ???? >>> | package.
>>>  ???? >>> | (Or abandon submitting the package to CRAN alltogether.)
>>>  ???? >>>
>>>  ???? >>> I love working on Linux. And these days I hear from some
>>> friends that
>>>  ???? >>> having
>>>  ???? >>> WSL2 on a (recent enough) Windows computer is also good as it
>>> effectively
>>>  ???? >>> gives a second machine with Ubuntu on it.? Docker can also be
>>> helpful,
>>>  ???? >>> as are
>>>  ???? >>> the online resources -- rhub has helped me with both macos
>>> and windows
>>>  ???? >>> builds.
>>>  ???? >>>
>>>  ???? >>> Dirk
>>>  ???? >>
>>>  ???? >> ______________________________________________
>>>  ???? >> R-package-devel at r-project.org mailing list
>>>  ???? >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>>  ???? > ______________________________________________
>>>  ???? > R-package-devel at r-project.org mailing list
>>>  ???? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Feb 23 20:09:09 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 23 Feb 2023 14:09:09 -0500
Subject: [R-pkg-devel] Package submission rejected as it fails checks on
 Debian
In-Reply-To: <45fdc9c7-7f97-7d3b-04d4-4fc6abaf96b8@gmail.com>
References: <9f139ef7aa30500603cc4230b7346e81@uop.gr>
 <25587.51377.202386.848689@rob.eddelbuettel.com>
 <7c3a50a005854bdb6d74bc2935870e1a@uop.gr>
 <25587.53933.900731.503495@rob.eddelbuettel.com>
 <aa66ea2bf58c87674b62aed6c4824292@uop.gr>
 <25587.57766.240718.390310@rob.eddelbuettel.com>
 <2fa635d315f271fb4d52de1a7d94c4d7@uop.gr>
 <1f3ec96c-aebf-f5ff-5331-6196a39fc552@effectivedefense.org>
 <25591.38008.892584.500445@stat.math.ethz.ch>
 <a0707643-814a-09e0-7dae-79fc709a4134@gmail.com>
 <45fdc9c7-7f97-7d3b-04d4-4fc6abaf96b8@gmail.com>
Message-ID: <431fada6-6690-1ba2-c11b-709d3bd45e54@gmail.com>

On 23/02/2023 1:11 p.m., Ben Bolker wrote:
>     Not important (of course) but where does the 5000 kWh per tree number
> come from?  Is that (dry weight) x (50% carbon per dry weight) / (carbon
> content of CO2 emissions per kWh) ?
> 
> https://www.epa.gov/energy/greenhouse-gas-equivalencies-calculator#results
> 
>     If we say 200 watts x 15 minutes (allowing us to take up the whole
> server for checking on 5 different platforms) we have .05 kWh. Let's say
> we do this 300 times/year for a package, so 15 kWh. Hard to get 'tree
> equivalents' from the EPA web site, but this is equivalent to 1.2
> gallons of petrol/gasoline consumption (0.011 metric tonnes)

Another missing part of the calculation is how many kWh are saved 
because frequent checks find bugs early and prevent the need to throw 
away long simulation runs.

And Github claims to have been carbon neutral since 2019...

Duncan
> 
> 
> On 2023-02-23 12:59 p.m., Duncan Murdoch wrote:
>> Hi Martin.
>>
>> I think your calculations are way off.? A one-tonne tree contains about
>> 5000 kWh of energy.? A typical computer server uses about 200 watts, and
>> can process many jobs simultaneously on different cores, but let's say
>> the whole server is dedicated to the Github action.? Then it would
>> consume 1 kWh in 5 hours, and would take about 10 days to consume 1% of
>> a tree.
>>
>> Duncan Murdoch
>>
>> On 23/02/2023 11:29 a.m., Martin Maechler wrote:
>>>>>>>> Spencer Graves
>>>>>>>>  ???? on Tue, 21 Feb 2023 05:25:39 -0600 writes:
>>>
>>>  ???? > On 2/21/23 2:34 AM, Vasileios Nikolaidis wrote:
>>>  ???? >> Yes, with all this I can think where I may have messed up. So
>>> thanks for
>>>  ???? >> the help, at least it verified it is indeed an issue with the
>>> code. As
>>>  ???? >> far as OSs, I use Ubuntu variants a lot and (on several
>>> machines) but
>>>  ???? >> these days I have easier access to Windows (with WSL2 btw). I
>>> also like
>>>  ???? >> a strict compiler (and linker), there is usually a reason why
>>> they are
>>>  ???? >> strict. So if it is not obvious from examining the code,? I
>>> will set up
>>>  ???? >> something (be it WSL, VM or Docker) for testing.
>>>
>>>
>>>  ???? > If you have NOT tried "GitHub Action" yet, I highly recommend it.
>>>  ???? > For my packages, every time I do "git push", it automatically
>>> runs "R
>>>  ???? > CMD build / check" on 5 different platforms -- with no further
>>> effort on
>>>  ???? > my part other than checking the results.
>>>
>>> [ Sorry, but for once I'd like to raise this here ...]:
>>>
>>> well... how many "trees" does that cost every time you push?
>>> I guess it will be less than one, but I'd also guess it be more
>>> than 1% of one.. and even if that was more than reality, ...
>>>
>>> I hope you are all aware that even though this looks "free", all
>>> this mostly unnecessary (rebuilding some of the things *every*
>>> time from scratch, downloading lots of stuff, even though from a
>>> closeby server) traffic and server run time will partly be paid
>>> by the kids and grand kids of people living in Bangladesh,
>>> Polynesia, ... (and maybe even in say Amsterdam)
>>> Global Warming *is* a threat, and we living in rich nations letting run
>>> more and more computer networks and servers (cooling, heating,
>>> gray energy including lots of CO2 produce by building construction, ...)
>>> does add to it.
>>>
>>> [[[yes, I may be partly wrong,? and
>>>  ???? no, it's a loss of time if we start a flame/mud/... war here
>>> about this;
>>>  ???? just consider it a small outlier voice ...
>>> ]]]
>>>
>>>
>>>  ???? > It should be easy to get something to work following the
>>> instructions
>>>  ???? > in Wickham and Bryan, R Packages[1] or copying the code from
>>> another
>>>  ???? > package.[2] If that fails, you might be able to get help from
>>> this list.
>>>  ???? > I got valuable suggestions from Dir Eddelbuettel and Duncan
>>> Murdoch.
>>>
>>>
>>>  ???? > I don't know if any version of Debian is available on GitHub
>>> Action.
>>>  ???? > However, if CRAN is rejecting your package on GitHub Action, a
>>> question
>>>  ???? > about that to this list might help make it available.? If you have
>>>  ???? > special Ubuntu configuration issues that are not provided in the
>>>  ???? > standard GitHub Action configurations, asking here might help
>>> you with
>>>  ???? > that.
>>>
>>>
>>>  ???? > Hope this helps,
>>>  ???? > Spencer Graves
>>>
>>>
>>>  ???? > [1]
>>>
>>>
>>>  ???? > https://r-pkgs.org
>>>
>>>
>>>  ???? > [2] e.g.,
>>>
>>>
>>>  ???? > https://github.com/JamesRamsay5/fda
>>>
>>>  ???? >>
>>>  ???? >> Thanks again,
>>>  ???? >>
>>>  ???? >> Vasilis
>>>  ???? >>
>>>  ???? >>
>>>  ???? >>
>>>  ???? >> ???? 2023-02-20 23:09, Dirk Eddelbuettel ??????:
>>>  ???? >>> On 20 February 2023 at 22:37, Vasileios Nikolaidis wrote:
>>>  ???? >>> | Thanks for taking the time to check it. The hint about the
>>> virtual
>>>  ???? >>> | 'layer' class is valuable.
>>>  ???? >>> | I will look into it.
>>>  ???? >>>
>>>  ???? >>> Sounds good, glad to have been of assistance.? On a lark, I
>>> also tried
>>>  ???? >>> your
>>>  ???? >>> most recent CRAN release, and it installs and loads fine here.
>>>  ???? >>>
>>>  ???? >>> | PS I am tempted to set up a Debian test platform to speed
>>> up fixing the
>>>  ???? >>> | package.
>>>  ???? >>> | (Or abandon submitting the package to CRAN alltogether.)
>>>  ???? >>>
>>>  ???? >>> I love working on Linux. And these days I hear from some
>>> friends that
>>>  ???? >>> having
>>>  ???? >>> WSL2 on a (recent enough) Windows computer is also good as it
>>> effectively
>>>  ???? >>> gives a second machine with Ubuntu on it.? Docker can also be
>>> helpful,
>>>  ???? >>> as are
>>>  ???? >>> the online resources -- rhub has helped me with both macos
>>> and windows
>>>  ???? >>> builds.
>>>  ???? >>>
>>>  ???? >>> Dirk
>>>  ???? >>
>>>  ???? >> ______________________________________________
>>>  ???? >> R-package-devel at r-project.org mailing list
>>>  ???? >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>>  ???? > ______________________________________________
>>>  ???? > R-package-devel at r-project.org mailing list
>>>  ???? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From @98107020 @end|ng |rom g@@ncku@edu@tw  Thu Feb 23 08:20:27 2023
From: @98107020 @end|ng |rom g@@ncku@edu@tw (=?utf-8?B?5a6J5ouJ57atIEFBTEEgV0lMU09OIEpSIFM5ODEwNzAyMA==?=)
Date: Thu, 23 Feb 2023 15:20:27 +0800
Subject: [R-pkg-devel] CRAN-pretest install error on r-devel-windows-x86_64
Message-ID: <CB3AB810-31DA-48BE-A600-027D4113010F@gs.ncku.edu.tw>

Hi everyone,

I am trying to submit a new package in CRAN. The results from devtools::check() returned with no errors, warnings, nor notes. Upon submitting the package tarball, i received the following error on the r-devel-windows-x86_64 version:

Flavor: r-devel-windows-x86_64
Check: whether package can be installed, Result: ERROR
 Installation failed.
 See 'd:/RCompile/CRANincoming/R-devel/qPCRhelper.Rcheck/00install.out' for details.

Following the install log:

* installing *source* package 'qPCRhelper' ...
** using staged installation
Warning in as.POSIXlt.POSIXct(x, tz) : unknown timezone 'Europe/Berlin'
Warning in as.POSIXlt.POSIXct(x, tz) : unknown timezone 'GMT'
Warning in as.POSIXlt.POSIXct(x, tz) :
  unknown timezone 'America/New_York'
Warning in as.POSIXlt.POSIXct(x, tz) : unknown timezone 'GMT'
Warning in as.POSIXlt.POSIXct(x, tz) :
  unknown timezone 'America/New_York'
** R
** inst
** byte-compile and prepare package for lazy loading
Error in if (file.size(codeFile) == file.size(loaderFile)) warning("package seems to be using lazy loading already") else { : 
  missing value where TRUE/FALSE needed
Calls: <Anonymous>
Execution halted
ERROR: lazy loading failed for package 'qPCRhelper'
* removing 'd:/RCompile/CRANincoming/R-devel/lib/qPCRhelper'
* restoring previous 'd:/RCompile/CRANincoming/R-devel/lib/qPCRhelper?

I have submitted this package quite a few times prior and this did not show up.

This is the entire result from the CRAN-pretest:
Flavor: r-devel-windows-x86_64
Check: CRAN incoming feasibility, Result: NOTE
 Maintainer: 'Wilson Jr. Aala <s98107020 at gs.ncku.edu.tw <mailto:s98107020 at gs.ncku.edu.tw>>'

 New submission

 Possibly misspelled words in DESCRIPTION:
   Livak (11:5)
   Schmittgen (11:13)
   polymerase (7:95)
   qPCR (3:8, 8:21)

 Reading Rd files failed with
   cannot open the connection

Flavor: r-devel-windows-x86_64
Check: whether package can be installed, Result: ERROR
 Installation failed.
 See 'd:/RCompile/CRANincoming/R-devel/qPCRhelper.Rcheck/00install.out' for details.

Flavor: r-devel-linux-x86_64-debian-gcc
Check: CRAN incoming feasibility, Result: NOTE
 Maintainer: 'Wilson Jr. Aala <s98107020 at gs.ncku.edu.tw <mailto:s98107020 at gs.ncku.edu.tw>>'

 New submission

 Possibly misspelled words in DESCRIPTION:
   Livak (11:5)
   Schmittgen (11:13)
   polymerase (7:95)
   qPCR (3:8, 8:21)

How can i resolve this issue?

Respectfully,

Wilson F. Aala, Jr.
Ph.D. Student
Institute of Clinical Medicine
National Cheng Kung University
????????????????
## Google Scholar <https://scholar.google.com.ph/citations?user=m0Ks560AAAAJ&hl=en>
## Publons <https://publons.com/researcher/1910770/wilson-jr-florendo-aala/>
## ORCID <https://orcid.org/0000-0003-4557-1109>
 <https://orcid.org/0000-0003-4557-1109>


	[[alternative HTML version deleted]]


From |embry @end|ng |rom ecocc@@com  Fri Feb 24 22:11:38 2023
From: |embry @end|ng |rom ecocc@@com (EcoC2S - Irucka Embry)
Date: Fri, 24 Feb 2023 15:11:38 -0600
Subject: [R-pkg-devel] Package internal function / Undocumented code objects
 warning
In-Reply-To: <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
References: <dc713e6d764976c5f370cfb05ba38e92@ecoccs.com>
 <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
 <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
Message-ID: <9af164459ac3917b728959892a48ead6@ecoccs.com>

Greetings, I am attaching the complete R file for your review. The 
vlookup_internal function and all of the functions in the package are 
derived from the expss package version 0.10.7. The vlookup function was 
modified in later versions so I gathered what I needed from that 
previous version and included in the attached R file.

The vlookup_internal function is meant to be an internal function that 
is used by the vlookup and other functions. I have documented the 
vlookup_internal function to escape the warning message, but it doesn't 
seem to work.

I am enclosing the warning message below:

* checking for missing documentation entries ... WARNING
Undocumented code objects:
   ?vlookup_internal?
All user-level objects in a package should have documentation entries.
See chapter ?Writing R documentation files? in the ?Writing R
Extensions? manual.

Thank you.

Irucka Embry


-- 
--
No fear, Only Love! / ?No temas, solamente amor!
-Irucka Ajani Embry, 15 March 2020

Family Partners:
http://www.sustainlex.org/
https://www.schoolingsolutions.com/

---------------------------------------------------------------------------------------------------------------

The business collaboration between EConsulting (tm)
[https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to 
Nature.

Getting Back to Nature LocalHarvest --
https://www.localharvest.org/getting-back-to-nature-M73453
Getting Back to Nature -- https://www.gettingback2nature.farm/

-- Irucka and his twin brother, Obiora, are featured in the Middle
Tennessee Local Table Magazine Annual issue. The article discusses their
family farm history and the current work that they are doing under 
Getting
Back to Nature. The full magazine can be found here [the article begins 
on
page 18 of the PDF document]:

https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf

-- Obiora and Irucka were interviewed separately in early 2020 for the
Natural Resources Defense Council's (NRDC) "Regenerative Agriculture: 
Farm
Policy for the 21st Century: Policy Recommendations to Advance 
Regenerative
Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen Lee.
The PDF report is available below:

https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf

EcoC2S -- https://www.ecoccs.com/
Principal, Irucka Embry, EIT

Services:
Growing Food
Healthy Living Mentor
Data Analysis with R
R Training
Chemistry and Mathematics Tutoring
Free/Libre and Open Source Software (FLOSS) Consultation
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: vlookup.R
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20230224/0ab3cc1b/attachment.ksh>

From n|u|tz @end|ng |rom gm@||@com  Fri Feb 24 22:21:19 2023
From: n|u|tz @end|ng |rom gm@||@com (Neal Fultz)
Date: Fri, 24 Feb 2023 13:21:19 -0800
Subject: [R-pkg-devel] 
 Package internal function / Undocumented code objects warning
In-Reply-To: <9af164459ac3917b728959892a48ead6@ecoccs.com>
References: <dc713e6d764976c5f370cfb05ba38e92@ecoccs.com>
 <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
 <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
 <9af164459ac3917b728959892a48ead6@ecoccs.com>
Message-ID: <CAL9B2veHAy_hAd__2TF2eLcsf3vXyZLO3+3aKgzAVbNgKosPHQ@mail.gmail.com>

If it's an internal-only function check if it's exported in your NAMESPACE
file.

On Fri, Feb 24, 2023 at 1:12 PM EcoC2S - Irucka Embry <iembry at ecoccs.com>
wrote:

> Greetings, I am attaching the complete R file for your review. The
> vlookup_internal function and all of the functions in the package are
> derived from the expss package version 0.10.7. The vlookup function was
> modified in later versions so I gathered what I needed from that
> previous version and included in the attached R file.
>
> The vlookup_internal function is meant to be an internal function that
> is used by the vlookup and other functions. I have documented the
> vlookup_internal function to escape the warning message, but it doesn't
> seem to work.
>
> I am enclosing the warning message below:
>
> * checking for missing documentation entries ... WARNING
> Undocumented code objects:
>    ?vlookup_internal?
> All user-level objects in a package should have documentation entries.
> See chapter ?Writing R documentation files? in the ?Writing R
> Extensions? manual.
>
> Thank you.
>
> Irucka Embry
>
>
> --
> --
> No fear, Only Love! / ?No temas, solamente amor!
> -Irucka Ajani Embry, 15 March 2020
>
> Family Partners:
> http://www.sustainlex.org/
> https://www.schoolingsolutions.com/
>
>
> ---------------------------------------------------------------------------------------------------------------
>
> The business collaboration between EConsulting (tm)
> [https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to
> Nature.
>
> Getting Back to Nature LocalHarvest --
> https://www.localharvest.org/getting-back-to-nature-M73453
> Getting Back to Nature -- https://www.gettingback2nature.farm/
>
> -- Irucka and his twin brother, Obiora, are featured in the Middle
> Tennessee Local Table Magazine Annual issue. The article discusses their
> family farm history and the current work that they are doing under
> Getting
> Back to Nature. The full magazine can be found here [the article begins
> on
> page 18 of the PDF document]:
>
> https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf
>
> -- Obiora and Irucka were interviewed separately in early 2020 for the
> Natural Resources Defense Council's (NRDC) "Regenerative Agriculture:
> Farm
> Policy for the 21st Century: Policy Recommendations to Advance
> Regenerative
> Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen Lee.
> The PDF report is available below:
>
>
> https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf
>
> EcoC2S -- https://www.ecoccs.com/
> Principal, Irucka Embry, EIT
>
> Services:
> Growing Food
> Healthy Living Mentor
> Data Analysis with R
> R Training
> Chemistry and Mathematics Tutoring
> Free/Libre and Open Source Software (FLOSS)
> Consultation______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From @kw@|mmo @end|ng |rom gm@||@com  Fri Feb 24 22:22:56 2023
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Fri, 24 Feb 2023 16:22:56 -0500
Subject: [R-pkg-devel] 
 Package internal function / Undocumented code objects warning
In-Reply-To: <9af164459ac3917b728959892a48ead6@ecoccs.com>
References: <dc713e6d764976c5f370cfb05ba38e92@ecoccs.com>
 <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
 <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
 <9af164459ac3917b728959892a48ead6@ecoccs.com>
Message-ID: <CAPcHnpRq4AWWhe_kRi_7DLpet5Y3=PhetqbeSmPGhoYMBMehFw@mail.gmail.com>

I'm not very familiar with Roxygen, so I might be making incorrect
assumptions here.

Why are you exporting a function if it's meant to be internal?

And the @noRd would indicate that a documentation file is not created. I
would remove @noRd or @export

On Fri, Feb 24, 2023, 16:11 EcoC2S - Irucka Embry <iembry at ecoccs.com> wrote:

> Greetings, I am attaching the complete R file for your review. The
> vlookup_internal function and all of the functions in the package are
> derived from the expss package version 0.10.7. The vlookup function was
> modified in later versions so I gathered what I needed from that
> previous version and included in the attached R file.
>
> The vlookup_internal function is meant to be an internal function that
> is used by the vlookup and other functions. I have documented the
> vlookup_internal function to escape the warning message, but it doesn't
> seem to work.
>
> I am enclosing the warning message below:
>
> * checking for missing documentation entries ... WARNING
> Undocumented code objects:
>    ?vlookup_internal?
> All user-level objects in a package should have documentation entries.
> See chapter ?Writing R documentation files? in the ?Writing R
> Extensions? manual.
>
> Thank you.
>
> Irucka Embry
>
>
> --
> --
> No fear, Only Love! / ?No temas, solamente amor!
> -Irucka Ajani Embry, 15 March 2020
>
> Family Partners:
> http://www.sustainlex.org/
> https://www.schoolingsolutions.com/
>
>
> ---------------------------------------------------------------------------------------------------------------
>
> The business collaboration between EConsulting (tm)
> [https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to
> Nature.
>
> Getting Back to Nature LocalHarvest --
> https://www.localharvest.org/getting-back-to-nature-M73453
> Getting Back to Nature -- https://www.gettingback2nature.farm/
>
> -- Irucka and his twin brother, Obiora, are featured in the Middle
> Tennessee Local Table Magazine Annual issue. The article discusses their
> family farm history and the current work that they are doing under
> Getting
> Back to Nature. The full magazine can be found here [the article begins
> on
> page 18 of the PDF document]:
>
> https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf
>
> -- Obiora and Irucka were interviewed separately in early 2020 for the
> Natural Resources Defense Council's (NRDC) "Regenerative Agriculture:
> Farm
> Policy for the 21st Century: Policy Recommendations to Advance
> Regenerative
> Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen Lee.
> The PDF report is available below:
>
>
> https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf
>
> EcoC2S -- https://www.ecoccs.com/
> Principal, Irucka Embry, EIT
>
> Services:
> Growing Food
> Healthy Living Mentor
> Data Analysis with R
> R Training
> Chemistry and Mathematics Tutoring
> Free/Libre and Open Source Software (FLOSS)
> Consultation______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From @ndy@teucher @end|ng |rom gm@||@com  Fri Feb 24 22:34:43 2023
From: @ndy@teucher @end|ng |rom gm@||@com (Andy Teucher)
Date: Fri, 24 Feb 2023 13:34:43 -0800
Subject: [R-pkg-devel] 
 Package internal function / Undocumented code objects warning
In-Reply-To: <9af164459ac3917b728959892a48ead6@ecoccs.com>
References: <dc713e6d764976c5f370cfb05ba38e92@ecoccs.com>
 <1fba4982cf0839bd7443542b325dc6eb@ecoccs.com>
 <0d964412c3dd5d1c7730e30e010d0348@ecoccs.com>
 <9af164459ac3917b728959892a48ead6@ecoccs.com>
Message-ID: <ADE6C391-C51D-4AA2-A972-7D1319AF40BA@gmail.com>

You have included the @export tag in the roxygen block for vlookup_internal(), which will place it in the NAMESPACE with an export directive, but also included @noRd which prevents the creation of the .Rd file for the function. So these two are in conflict. Remove the @export tag from vlookup_internal and when you re-run devtools::document() it should no longer be in the NAMESPACE.

Cheers,
Andy Teucher

> On Feb 24, 2023, at 1:11 PM, EcoC2S - Irucka Embry <iembry at ecoccs.com> wrote:
> 
> Greetings, I am attaching the complete R file for your review. The vlookup_internal function and all of the functions in the package are derived from the expss package version 0.10.7. The vlookup function was modified in later versions so I gathered what I needed from that previous version and included in the attached R file.
> 
> The vlookup_internal function is meant to be an internal function that is used by the vlookup and other functions. I have documented the vlookup_internal function to escape the warning message, but it doesn't seem to work.
> 
> I am enclosing the warning message below:
> 
> * checking for missing documentation entries ... WARNING
> Undocumented code objects:
>  ?vlookup_internal?
> All user-level objects in a package should have documentation entries.
> See chapter ?Writing R documentation files? in the ?Writing R
> Extensions? manual.
> 
> Thank you.
> 
> Irucka Embry
> 
> 
> -- 
> --
> No fear, Only Love! / ?No temas, solamente amor!
> -Irucka Ajani Embry, 15 March 2020
> 
> Family Partners:
> http://www.sustainlex.org/
> https://www.schoolingsolutions.com/
> 
> ---------------------------------------------------------------------------------------------------------------
> 
> The business collaboration between EConsulting (tm)
> [https://www.econsultingllc.org/] and EcoC^2S, is Getting Back to Nature.
> 
> Getting Back to Nature LocalHarvest --
> https://www.localharvest.org/getting-back-to-nature-M73453
> Getting Back to Nature -- https://www.gettingback2nature.farm/
> 
> -- Irucka and his twin brother, Obiora, are featured in the Middle
> Tennessee Local Table Magazine Annual issue. The article discusses their
> family farm history and the current work that they are doing under Getting
> Back to Nature. The full magazine can be found here [the article begins on
> page 18 of the PDF document]:
> 
> https://media.gettingback2nature.farm/pdf/LocalTable_ANNUAL_2020_lo_res.pdf
> 
> -- Obiora and Irucka were interviewed separately in early 2020 for the
> Natural Resources Defense Council's (NRDC) "Regenerative Agriculture: Farm
> Policy for the 21st Century: Policy Recommendations to Advance Regenerative
> Agriculture" report written By Arohi Sharma, Lara Bryant, and Ellen Lee.
> The PDF report is available below:
> 
> https://www.nrdc.org/sites/default/files/regenerative-agriculture-farm-policy-21st-century-report.pdf
> 
> EcoC2S -- https://www.ecoccs.com/
> Principal, Irucka Embry, EIT
> 
> Services:
> Growing Food
> Healthy Living Mentor
> Data Analysis with R
> R Training
> Chemistry and Mathematics Tutoring
> Free/Libre and Open Source Software (FLOSS) Consultation<vlookup.R>______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From biii m@iii@g oii de@@ey@ws  Sun Feb 26 20:36:22 2023
From: biii m@iii@g oii de@@ey@ws (biii m@iii@g oii de@@ey@ws)
Date: Sun, 26 Feb 2023 14:36:22 -0500
Subject: [R-pkg-devel] Sanitize Input Code for a Shiny App
Message-ID: <013901d94a19$9b8569f0$d2903dd0$@denney.ws>

Hello,

 

I'm working to develop a Shiny app where I'd like to have an advanced
capability to accept user input and run the code.  For the code received,
I'd like to be able to prevent R from doing things other than working within
the R session.  For example, I want to prevent `system("rm -rf /*")`.

 

One method to achieve this is to run the R session within a Docker container
and perform the security around the container.  The user could do some
things within the container, but they would be limited.

 

What I'd like to be able to do is to sanitize the inputs to ensure that it
won't to things including installing packages, running system commands,
reading and writing to the filesystem, and accessing the network.  I'd like
to allow the user to do almost anything they want within R, so making a list
of acceptable commands is not accomplishing the goal.  I could try to do
something like:

 

*	have acceptable packages loaded, only,
*	don't allow loading additional packages,
*	deny a set of known-bad commands (e.g. system, system2, etc.)
*	deny any attempt to run from additional packages (exclude calls with
a double-colon or triple-colon)

 

The method I just described seems like it would not work well because it
assumes that the known-bad commands is comprehensive and that I'm being
creative enough in ways that users could try to break things.

 

Is there a good way to sanitize arbitrary code from users to prevent
malicious behavior?


Thanks,

 

Bill


	[[alternative HTML version deleted]]


From m@tth|@@-gond@n @end|ng |rom gmx@de  Sun Feb 26 21:16:48 2023
From: m@tth|@@-gond@n @end|ng |rom gmx@de (Matthias Gondan)
Date: Sun, 26 Feb 2023 21:16:48 +0100
Subject: [R-pkg-devel] Sanitize Input Code for a Shiny App
In-Reply-To: <013901d94a19$9b8569f0$d2903dd0$@denney.ws>
References: <013901d94a19$9b8569f0$d2903dd0$@denney.ws>
Message-ID: <1Mj8mb-1otRnJ0KU1-00fDuD@mail.gmx.net>

Hi Bill,

just for the records, the response could also be interesting for learnr developers

https://github.com/rstudio/learnr

Best wishes,

Matthias


Von: bill at denney.ws
Gesendet: Sonntag, 26. Februar 2023 20:36
An: r-package-devel at r-project.org
Betreff: [R-pkg-devel] Sanitize Input Code for a Shiny App

Hello,

 

I'm working to develop a Shiny app where I'd like to have an advanced
capability to accept user input and run the code.  For the code received,
I'd like to be able to prevent R from doing things other than working within
the R session.  For example, I want to prevent `system("rm -rf /*")`.

 

One method to achieve this is to run the R session within a Docker container
and perform the security around the container.  The user could do some
things within the container, but they would be limited.

 

What I'd like to be able to do is to sanitize the inputs to ensure that it
won't to things including installing packages, running system commands,
reading and writing to the filesystem, and accessing the network.  I'd like
to allow the user to do almost anything they want within R, so making a list
of acceptable commands is not accomplishing the goal.  I could try to do
something like:

 

*	have acceptable packages loaded, only,
*	don't allow loading additional packages,
*	deny a set of known-bad commands (e.g. system, system2, etc.)
*	deny any attempt to run from additional packages (exclude calls with
a double-colon or triple-colon)

 

The method I just described seems like it would not work well because it
assumes that the known-bad commands is comprehensive and that I'm being
creative enough in ways that users could try to break things.

 

Is there a good way to sanitize arbitrary code from users to prevent
malicious behavior?


Thanks,

 

Bill


	[[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Sun Feb 26 22:42:35 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Mon, 27 Feb 2023 00:42:35 +0300
Subject: [R-pkg-devel] Sanitize Input Code for a Shiny App
In-Reply-To: <013901d94a19$9b8569f0$d2903dd0$@denney.ws>
References: <013901d94a19$9b8569f0$d2903dd0$@denney.ws>
Message-ID: <20230227004235.6225df01@Tarkus>

On Sun, 26 Feb 2023 14:36:22 -0500
<bill at denney.ws> wrote:

> What I'd like to be able to do is to sanitize the inputs to ensure
> that it won't to things including installing packages, running system
> commands, reading and writing to the filesystem, and accessing the
> network.  I'd like to allow the user to do almost anything they want
> within R, so making a list of acceptable commands is not
> accomplishing the goal.  

How untrusted will the user be?

You will most likely have to forbid Rcpp and any similar packages (and
likely anything that depends on them), because running arbitrary C++
will definitely include system commands, filesystem I/O and sockets.

To think of it, you will also have to forbid dyn.load(): otherwise it's
relatively easy to compile a ELF shared object that would load on any
64-bit Linux and provide an entry point that performs a system call of
the user's choice.

While the base R packages set R_forceSymbols(dll, TRUE) on their
.C/.Call/.Fortran/.External routines, making them unavailable to a bare
.Call("symbol_name", whatever_arguments, ...), some of the packages
deemed acceptable might provide C symbols without disabling the dynamic
lookup, and those C symbols may be convinced to run user-supplied code
either by mistake of the programmer (user supplies data, programmer
misses a buffer overrun or a use-after-free, suddenly data gets
executed as code; normally not considered a security issue because "the
user is already on the inner side of the airtight hatchway and could
have run system()") or even by design (the C programmer relied on the
R code to provide safety features). CRAN checks with Valgrind and
address-/undefined behaviour sanitizers help a lot against this kind of
C bugs, but they aren't 100% effective. Either way, top-level .C and
friends must be forbidden too. (Forbidding them anywhere in the call
chain will break almost all of R, even lm() and read.table().)

A CRAN package deemed acceptable may still have system() shell
injections in it and other ways to convince it to run user code.

The triple-colon protection can probably be bypassed in lots of clever
ways, starting with a perfectly normal R function `get()` combined with
a package function that has the private symbols visible to it. Similar
techniques may bypass the top-level .C/dyn.load()/system() restrictions.

Will the user be allowed to upload data? I think that R's serialization
engine is not designed to handle untrusted data. It has known stack
overflows [*], so a dedicated attacker is likely to be able to find a
code execution pathway from unserialize().

R code is also data, so a "forbidden" function or call could be
smuggled as data, parsed/deserialized and then evaluated. There are
standard classes in at least one of the base packages that use a lot of
closures, so a print() call on a doctored object can already be running
user-supplied code. You may forbid parse(), but some well-meaning code
inside R or a CRAN package may be convinced to run as.formula() on a
string, which may be enough for an attacker.

Some simple restrictions may be implemented by recursively walking the
return value of parse(user_input), but that ignores the possibility of
attacks on the parser itself. More significant restrictions may require
you to patch R and somehow determine at the point of an unsafe
(socket() / dlopen() / system() / ...) call whether it's
user-controlled or required for R to function normally (or both?).

I think it's a better idea to put the user-controlled process in a
virtual machine or a container or use a sandbox such as firejail or
bubblewrap. Make R run as an unprivileged user (this matters much less
once inside a sandbox, but let's not help the attacker skip privilege
escalation exploits before they try sandbox breakout exploits). Put
some firewall rules into place. Some attackers will doubtlessly try to
run a cryptocurrency miner without destroying the system/sending
spam/breaching your data, so make sure to limit CPU time, the size of
the temporary storage you're giving to the process and the amount of
RAM it can allocate.

In a game of walls and ladders, nothing will give you perfect
protection from attackers breaking out of such a sandbox (have I
mentioned the Spectre-class attack on the branch predictor in most
modern CPUs that makes it (very very hard but) possible to read from
address space not belonging to your process? The rowhammer attack on
non-ECC DRAM that (probabilistically) overwrites memory that is not
yours?), but in this case, the operating system is in a much better
position to restrict the user than R itself. Some languages (like Lua)
have such a tiny standard library that putting them in a sandbox is a
simple exercise, though both parser and bytecode execution
vulnerabilities (which might lead to code execution) still surface from
time to time. (SQLite went through a lot of fuzz-testing before its
authors could say that both its SQL parser and its database file parser
were safe against attacker-supplied input.) R (and the packages you
might want to run) just weren't designed with the idea of being a
security boundary on the user input side.

The JavaScript engines running in our browsers (well, the 2.5 browser
engines that are left) try to provide both the sandbox and the
performance to go with it, at the cost of a never-ending stream of
client-side vulnerabilities that have to be frequently patched. The
Python project now has Pyodide <https://pyodide.org/en/stable/>, an
interpreter that runs in the client's browser instead of your server,
which shifts the costs and the liabilities of user-supplied code on the
user. Maybe it's time to try to compile R for the browser?

-- 
Best regards,
Ivan

[*] https://bugs.r-project.org/show_bug.cgi?id=16034


From @|mon@urb@nek @end|ng |rom R-project@org  Sun Feb 26 22:57:10 2023
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Mon, 27 Feb 2023 10:57:10 +1300
Subject: [R-pkg-devel] Sanitize Input Code for a Shiny App
In-Reply-To: <013901d94a19$9b8569f0$d2903dd0$@denney.ws>
References: <013901d94a19$9b8569f0$d2903dd0$@denney.ws>
Message-ID: <D65C46C3-A4B7-4358-A8EC-CD5DBA3B7028@R-project.org>

Bill,

the short answer is you can't limit anything at R level. Any attempts to create a list of "bad" commands are trivial to circumvent since you can compute on the language in R, so you can construct and call functions with trivial operations. Similarly, since R allows the loading of binary code the same applies for arbitrary code. So if you give users access to R, you should assume that is equivalent to allowing arbitrary code execution. Therefore all you can do is limit the resources and reach - as you pointed out using a container is a good idea so each session is only limited to a single container that goes away when the session ends. Similarly you can restrict main parts of R and the system to be read-only in the container.

In practice, that's why real analytic systems are about provenance rather than prevention. For example, in RCloud all code is first committed to a git repository outside of the container before it can be executed, so malicious users can do whatever they want, but they cannot hide the malicious code they used as the container cannot manipulate the history.

As for package installation - again, it's impossible to prevent it in general unless you make everything read-only which also prevents the users from doing meaningful work. So the real question what do you want to allow the user to do - why would you need to allow literal R code evaluation? The other alternative is to simply limit the interaction not allowing the user to submit arbitrary code, only tweak parameters or use GUI to select particular choices. Obviously, that is a lot easier to secure.

Cheers,
Simon


> On 27/02/2023, at 8:36 AM, bill at denney.ws wrote:
> 
> Hello,
> 
> 
> 
> I'm working to develop a Shiny app where I'd like to have an advanced
> capability to accept user input and run the code.  For the code received,
> I'd like to be able to prevent R from doing things other than working within
> the R session.  For example, I want to prevent `system("rm -rf /*")`.
> 
> 
> 
> One method to achieve this is to run the R session within a Docker container
> and perform the security around the container.  The user could do some
> things within the container, but they would be limited.
> 
> 
> 
> What I'd like to be able to do is to sanitize the inputs to ensure that it
> won't to things including installing packages, running system commands,
> reading and writing to the filesystem, and accessing the network.  I'd like
> to allow the user to do almost anything they want within R, so making a list
> of acceptable commands is not accomplishing the goal.  I could try to do
> something like:
> 
> 
> 
> *	have acceptable packages loaded, only,
> *	don't allow loading additional packages,
> *	deny a set of known-bad commands (e.g. system, system2, etc.)
> *	deny any attempt to run from additional packages (exclude calls with
> a double-colon or triple-colon)
> 
> 
> 
> The method I just described seems like it would not work well because it
> assumes that the known-bad commands is comprehensive and that I'm being
> creative enough in ways that users could try to break things.
> 
> 
> 
> Is there a good way to sanitize arbitrary code from users to prevent
> malicious behavior?
> 
> 
> Thanks,
> 
> 
> 
> Bill
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 


From d||r@nce@co@r|cc@rdo96 @end|ng |rom gm@||@com  Mon Feb 27 10:25:55 2023
From: d||r@nce@co@r|cc@rdo96 @end|ng |rom gm@||@com (Riccardo Di Francesco)
Date: Mon, 27 Feb 2023 10:25:55 +0100
Subject: [R-pkg-devel] CRAN submission - Specified C++11
Message-ID: <CABBvn+eO5H=YQv7Amb-3Wggiitp4mkZEB-W4GzhCi6T0wN6RGw@mail.gmail.com>

Dear R-developers,

I apologize if this issue has been already resolved, I could not find any
solution in your archives.

I recently submitted a package to CRAN. In the "src/Makevars" file I
put CXX_STD
= CXX11 to specify C++11 code. This causes my package to fail the automatic
checks, which raise the following note:

*"checking C++ specification ... NOTE*
* Specified C++11: please drop specification unless essential"*

Specifying C++11 is necessary to make my package work. How can I solve
this?

Best
-- 
*Riccardo Di Francesco*
Ph.D. candidate
Department of Economics and Finance
University of Rome Tor Vergata
Website <https://riccardo-df.github.io/>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Feb 27 10:37:51 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 27 Feb 2023 04:37:51 -0500
Subject: [R-pkg-devel] CRAN submission - Specified C++11
In-Reply-To: <CABBvn+eO5H=YQv7Amb-3Wggiitp4mkZEB-W4GzhCi6T0wN6RGw@mail.gmail.com>
References: <CABBvn+eO5H=YQv7Amb-3Wggiitp4mkZEB-W4GzhCi6T0wN6RGw@mail.gmail.com>
Message-ID: <917147d5-4476-88d5-92a7-f85fb3a438f4@gmail.com>

On 27/02/2023 4:25 a.m., Riccardo Di Francesco wrote:
> Dear R-developers,
> 
> I apologize if this issue has been already resolved, I could not find any
> solution in your archives.
> 
> I recently submitted a package to CRAN. In the "src/Makevars" file I
> put CXX_STD
> = CXX11 to specify C++11 code. This causes my package to fail the automatic
> checks, which raise the following note:
> 
> *"checking C++ specification ... NOTE*
> * Specified C++11: please drop specification unless essential"*
> 
> Specifying C++11 is necessary to make my package work. How can I solve
> this?

You could change the code so it will work in newer standards, but if 
that is not feasible, you need to write to CRAN and explain why you need 
this older standard.

Duncan Murdoch


From d||r@nce@co@r|cc@rdo96 @end|ng |rom gm@||@com  Mon Feb 27 10:42:33 2023
From: d||r@nce@co@r|cc@rdo96 @end|ng |rom gm@||@com (Riccardo Di Francesco)
Date: Mon, 27 Feb 2023 10:42:33 +0100
Subject: [R-pkg-devel] CRAN submission - Specified C++11
In-Reply-To: <917147d5-4476-88d5-92a7-f85fb3a438f4@gmail.com>
References: <CABBvn+eO5H=YQv7Amb-3Wggiitp4mkZEB-W4GzhCi6T0wN6RGw@mail.gmail.com>
 <917147d5-4476-88d5-92a7-f85fb3a438f4@gmail.com>
Message-ID: <CABBvn+fdFUjrCqhFsdDsx2+ALsxR6yZ4RQQsMhM0rz3tvWdKvg@mail.gmail.com>

Thanks for the suggestions.
I will try to change the code.

Il giorno lun 27 feb 2023 alle ore 10:37 Duncan Murdoch <
murdoch.duncan at gmail.com> ha scritto:

> On 27/02/2023 4:25 a.m., Riccardo Di Francesco wrote:
> > Dear R-developers,
> >
> > I apologize if this issue has been already resolved, I could not find any
> > solution in your archives.
> >
> > I recently submitted a package to CRAN. In the "src/Makevars" file I
> > put CXX_STD
> > = CXX11 to specify C++11 code. This causes my package to fail the
> automatic
> > checks, which raise the following note:
> >
> > *"checking C++ specification ... NOTE*
> > * Specified C++11: please drop specification unless essential"*
> >
> > Specifying C++11 is necessary to make my package work. How can I solve
> > this?
>
> You could change the code so it will work in newer standards, but if
> that is not feasible, you need to write to CRAN and explain why you need
> this older standard.
>
> Duncan Murdoch
>
>

-- 
*Riccardo Di Francesco*
Ph.D. candidate
Department of Economics and Finance
University of Rome Tor Vergata
Website <https://riccardo-df.github.io/>

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Mon Feb 27 10:44:54 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Mon, 27 Feb 2023 12:44:54 +0300
Subject: [R-pkg-devel] CRAN submission - Specified C++11
In-Reply-To: <CABBvn+eO5H=YQv7Amb-3Wggiitp4mkZEB-W4GzhCi6T0wN6RGw@mail.gmail.com>
References: <CABBvn+eO5H=YQv7Amb-3Wggiitp4mkZEB-W4GzhCi6T0wN6RGw@mail.gmail.com>
Message-ID: <20230227124454.0e7b5018@arachnoid>

? Mon, 27 Feb 2023 10:25:55 +0100
Riccardo Di Francesco <difrancesco.riccardo96 at gmail.com> ?????:

> Specifying C++11 is necessary to make my package work. How can I solve
> this?

Is it C++11 exactly or C++ ? 11? If the former, you're 100% right to
specify this (but may have problems in unspecified future when someone
decides to stop supporting C++11). If the latter, the answer is more
complicated, especially if you want your package to continue working on
older versions of R.

My own solution is to use the default C++ standard on R ? 3.6.2, i.e.
omit the CXX_STD specification entirely (which is at least C++11 there,
and my code has been tested on C++11 to C++17), but explicitly request
at least C++11 on R ? 3.1 using a configure script:
https://github.com/aitap/Ropj/commit/cc94320bd5b8b68c879ff604787e71831fff8108

Prior to R-3.1, there seems to have been no way to ask for C++11, so I
don't expect my code to work there.

See also: this R-pkg-devel thread
https://stat.ethz.ch/pipermail/r-package-devel/2023q1/008870.html

-- 
Best regards,
Ivan


From rd|@z02 @end|ng |rom gm@||@com  Mon Feb 27 10:50:02 2023
From: rd|@z02 @end|ng |rom gm@||@com (Ramon Diaz-Uriarte)
Date: Mon, 27 Feb 2023 10:50:02 +0100
Subject: [R-pkg-devel] CRAN submission - Specified C++11
In-Reply-To: <CABBvn+eO5H=YQv7Amb-3Wggiitp4mkZEB-W4GzhCi6T0wN6RGw@mail.gmail.com>
References: <CABBvn+eO5H=YQv7Amb-3Wggiitp4mkZEB-W4GzhCi6T0wN6RGw@mail.gmail.com>
Message-ID: <87bklfpguw.fsf@gmail.com>

Dear Riccardo,

See, for example, here:  https://github.com/mlpack/mlpack/issues/3407


As explained there (https://github.com/mlpack/mlpack/issues/3407#issuecomment-1426249703) "R 4.1.0, the base of the current r-oldrel (aka "previous release") already defaulted to C++14."


So, unless you really need C++11 and cannot use newer standards, you can probably remove

CXX_STD = CXX11


Best,

R.


On Mon, 27-February-2023, at 10:25:55, Riccardo Di Francesco <difrancesco.riccardo96 at gmail.com> wrote:
> Dear R-developers,
>
> I apologize if this issue has been already resolved, I could not find any
> solution in your archives.
>
> I recently submitted a package to CRAN. In the "src/Makevars" file I
> put CXX_STD
> = CXX11 to specify C++11 code. This causes my package to fail the automatic
> checks, which raise the following note:
>
> *"checking C++ specification ... NOTE*
> * Specified C++11: please drop specification unless essential"*
>
> Specifying C++11 is necessary to make my package work. How can I solve
> this?
>
> Best


-- 
Ramon Diaz-Uriarte
Department of Biochemistry, Lab B-31
Facultad de Medicina 
Universidad Aut?noma de Madrid 
Arzobispo Morcillo, 4
28029 Madrid
Spain

Phone: +34-91-497-2412

Email: rdiaz02 at gmail.com
       r.diaz at uam.es
       ramon.diaz at iib.uam.es

https://ligarto.org/rdiaz



From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Feb 27 20:32:58 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 27 Feb 2023 14:32:58 -0500
Subject: [R-pkg-devel] Ignoring a compiler warning?
Message-ID: <d4cbfd4b-0a4c-e724-ee55-2ff1421b8f87@gmail.com>

I am in the process of updating rgl to use the glad loader 
(https://github.com/Dav1dde/glad).  This replaces system standard gl.h 
and glext.h files with new ones that include function pointers to be 
filled in at run-time, so that rgl can use OpenGL features supported by 
updated drivers if they are present.

However, I'm getting a NOTE from checking:

File which contains pragma(s) suppressing diagnostics:
   ?src/ext/glad/include/glad/gl.h?

It is correct:  that file contains this:

#ifdef __clang__
#pragma clang diagnostic push
#pragma clang diagnostic ignored "-Wreserved-id-macro"
#endif
#ifdef __gl_h_
   #error OpenGL (gl.h) header already included (API: gl), remove 
previous include!
#endif
#define __gl_h_ 1

... more like this ...


The compiler would issue a warning for defining "__gl_h_" because of the 
two leading underscores.

Is that an ignorable NOTE, or if not, is there some acceptable way to 
suppress it?

Duncan Murdoch


From edd @end|ng |rom deb|@n@org  Mon Feb 27 21:34:11 2023
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 27 Feb 2023 14:34:11 -0600
Subject: [R-pkg-devel] Ignoring a compiler warning?
In-Reply-To: <d4cbfd4b-0a4c-e724-ee55-2ff1421b8f87@gmail.com>
References: <d4cbfd4b-0a4c-e724-ee55-2ff1421b8f87@gmail.com>
Message-ID: <25597.5059.520342.473446@rob.eddelbuettel.com>


On 27 February 2023 at 14:32, Duncan Murdoch wrote:
| I am in the process of updating rgl to use the glad loader 
| (https://github.com/Dav1dde/glad).  This replaces system standard gl.h 
| and glext.h files with new ones that include function pointers to be 
| filled in at run-time, so that rgl can use OpenGL features supported by 
| updated drivers if they are present.
| 
| However, I'm getting a NOTE from checking:
| 
| File which contains pragma(s) suppressing diagnostics:
|    ?src/ext/glad/include/glad/gl.h?
| 
| It is correct:  that file contains this:
| 
| #ifdef __clang__
| #pragma clang diagnostic push
| #pragma clang diagnostic ignored "-Wreserved-id-macro"
| #endif
| #ifdef __gl_h_
|    #error OpenGL (gl.h) header already included (API: gl), remove 
| previous include!
| #endif
| #define __gl_h_ 1
| 
| ... more like this ...
| 
| 
| The compiler would issue a warning for defining "__gl_h_" because of the 
| two leading underscores.
| 
| Is that an ignorable NOTE, or if not, is there some acceptable way to 
| suppress it?

There is not (AFAIK), and package BH has edited out such pragmas for many
years (as have other packages, I think it bites me in at least one other
package). In essence I recursively search for '#pragma clang diagnostic
ignored' and ditto for gcc and precede the line with //. The BH repo has the
diffs in a subdirectory. And not that it matters because I do not get to make
the rules, but I also consider this wrong as it makes builds _much_ more
'noisy' leading to the real possibiity of missing more meaningful message.

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Tue Feb 28 09:34:43 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Tue, 28 Feb 2023 09:34:43 +0100
Subject: [R-pkg-devel] 
 CRAN-pretest install error on r-devel-windows-x86_64
In-Reply-To: <CB3AB810-31DA-48BE-A600-027D4113010F@gs.ncku.edu.tw>
References: <CB3AB810-31DA-48BE-A600-027D4113010F@gs.ncku.edu.tw>
Message-ID: <2c2955dd-18f1-b87f-6255-a14ef9536f79@statistik.tu-dortmund.de>

Can you try again?

Best,
Uwe Ligges


On 23.02.2023 08:20, ??? AALA WILSON JR S98107020 wrote:
> Hi everyone,
> 
> I am trying to submit a new package in CRAN. The results from devtools::check() returned with no errors, warnings, nor notes. Upon submitting the package tarball, i received the following error on the r-devel-windows-x86_64 version:
> 
> Flavor: r-devel-windows-x86_64
> Check: whether package can be installed, Result: ERROR
>   Installation failed.
>   See 'd:/RCompile/CRANincoming/R-devel/qPCRhelper.Rcheck/00install.out' for details.
> 
> Following the install log:
> 
> * installing *source* package 'qPCRhelper' ...
> ** using staged installation
> Warning in as.POSIXlt.POSIXct(x, tz) : unknown timezone 'Europe/Berlin'
> Warning in as.POSIXlt.POSIXct(x, tz) : unknown timezone 'GMT'
> Warning in as.POSIXlt.POSIXct(x, tz) :
>    unknown timezone 'America/New_York'
> Warning in as.POSIXlt.POSIXct(x, tz) : unknown timezone 'GMT'
> Warning in as.POSIXlt.POSIXct(x, tz) :
>    unknown timezone 'America/New_York'
> ** R
> ** inst
> ** byte-compile and prepare package for lazy loading
> Error in if (file.size(codeFile) == file.size(loaderFile)) warning("package seems to be using lazy loading already") else { :
>    missing value where TRUE/FALSE needed
> Calls: <Anonymous>
> Execution halted
> ERROR: lazy loading failed for package 'qPCRhelper'
> * removing 'd:/RCompile/CRANincoming/R-devel/lib/qPCRhelper'
> * restoring previous 'd:/RCompile/CRANincoming/R-devel/lib/qPCRhelper?
> 
> I have submitted this package quite a few times prior and this did not show up.
> 
> This is the entire result from the CRAN-pretest:
> Flavor: r-devel-windows-x86_64
> Check: CRAN incoming feasibility, Result: NOTE
>   Maintainer: 'Wilson Jr. Aala <s98107020 at gs.ncku.edu.tw <mailto:s98107020 at gs.ncku.edu.tw>>'
> 
>   New submission
> 
>   Possibly misspelled words in DESCRIPTION:
>     Livak (11:5)
>     Schmittgen (11:13)
>     polymerase (7:95)
>     qPCR (3:8, 8:21)
> 
>   Reading Rd files failed with
>     cannot open the connection
> 
> Flavor: r-devel-windows-x86_64
> Check: whether package can be installed, Result: ERROR
>   Installation failed.
>   See 'd:/RCompile/CRANincoming/R-devel/qPCRhelper.Rcheck/00install.out' for details.
> 
> Flavor: r-devel-linux-x86_64-debian-gcc
> Check: CRAN incoming feasibility, Result: NOTE
>   Maintainer: 'Wilson Jr. Aala <s98107020 at gs.ncku.edu.tw <mailto:s98107020 at gs.ncku.edu.tw>>'
> 
>   New submission
> 
>   Possibly misspelled words in DESCRIPTION:
>     Livak (11:5)
>     Schmittgen (11:13)
>     polymerase (7:95)
>     qPCR (3:8, 8:21)
> 
> How can i resolve this issue?
> 
> Respectfully,
> 
> Wilson F. Aala, Jr.
> Ph.D. Student
> Institute of Clinical Medicine
> National Cheng Kung University
> ????????????????
> ## Google Scholar <https://scholar.google.com.ph/citations?user=m0Ks560AAAAJ&hl=en>
> ## Publons <https://publons.com/researcher/1910770/wilson-jr-florendo-aala/>
> ## ORCID <https://orcid.org/0000-0003-4557-1109>
>   <https://orcid.org/0000-0003-4557-1109>
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From b||| @end|ng |rom denney@w@  Wed Mar  1 01:52:53 2023
From: b||| @end|ng |rom denney@w@ (Bill Denney)
Date: Tue, 28 Feb 2023 19:52:53 -0500
Subject: [R-pkg-devel] Sanitize Input Code for a Shiny App
In-Reply-To: <D65C46C3-A4B7-4358-A8EC-CD5DBA3B7028@R-project.org>
References: <013901d94a19$9b8569f0$d2903dd0$@denney.ws>
 <D65C46C3-A4B7-4358-A8EC-CD5DBA3B7028@R-project.org>
Message-ID: <CADxuEGqNjs0ha4c=X8m2RW_uL5edAOgh4tQfgYACf+vR+EA8NQ@mail.gmail.com>

Hi Simon and Ivan,

Thanks for confirming my suspicions.  The most common case for our code
would be generally trusted users within an organization.  So, the main
threat is lower.  But, there may be scenarios that also allow use outside
organizations.

I think that in the end, we will likely do some minimal sanitization of the
input, but then we will also ensure that we do anything in a container with
limits applied from the outside, too.

Thanks,

Bill

On Sun, Feb 26, 2023, 4:57 PM Simon Urbanek <simon.urbanek at r-project.org>
wrote:

> Bill,
>
> the short answer is you can't limit anything at R level. Any attempts to
> create a list of "bad" commands are trivial to circumvent since you can
> compute on the language in R, so you can construct and call functions with
> trivial operations. Similarly, since R allows the loading of binary code
> the same applies for arbitrary code. So if you give users access to R, you
> should assume that is equivalent to allowing arbitrary code execution.
> Therefore all you can do is limit the resources and reach - as you pointed
> out using a container is a good idea so each session is only limited to a
> single container that goes away when the session ends. Similarly you can
> restrict main parts of R and the system to be read-only in the container.
>
> In practice, that's why real analytic systems are about provenance rather
> than prevention. For example, in RCloud all code is first committed to a
> git repository outside of the container before it can be executed, so
> malicious users can do whatever they want, but they cannot hide the
> malicious code they used as the container cannot manipulate the history.
>
> As for package installation - again, it's impossible to prevent it in
> general unless you make everything read-only which also prevents the users
> from doing meaningful work. So the real question what do you want to allow
> the user to do - why would you need to allow literal R code evaluation? The
> other alternative is to simply limit the interaction not allowing the user
> to submit arbitrary code, only tweak parameters or use GUI to select
> particular choices. Obviously, that is a lot easier to secure.
>
> Cheers,
> Simon
>
>
> > On 27/02/2023, at 8:36 AM, bill at denney.ws wrote:
> >
> > Hello,
> >
> >
> >
> > I'm working to develop a Shiny app where I'd like to have an advanced
> > capability to accept user input and run the code.  For the code received,
> > I'd like to be able to prevent R from doing things other than working
> within
> > the R session.  For example, I want to prevent `system("rm -rf /*")`.
> >
> >
> >
> > One method to achieve this is to run the R session within a Docker
> container
> > and perform the security around the container.  The user could do some
> > things within the container, but they would be limited.
> >
> >
> >
> > What I'd like to be able to do is to sanitize the inputs to ensure that
> it
> > won't to things including installing packages, running system commands,
> > reading and writing to the filesystem, and accessing the network.  I'd
> like
> > to allow the user to do almost anything they want within R, so making a
> list
> > of acceptable commands is not accomplishing the goal.  I could try to do
> > something like:
> >
> >
> >
> > *     have acceptable packages loaded, only,
> > *     don't allow loading additional packages,
> > *     deny a set of known-bad commands (e.g. system, system2, etc.)
> > *     deny any attempt to run from additional packages (exclude calls
> with
> > a double-colon or triple-colon)
> >
> >
> >
> > The method I just described seems like it would not work well because it
> > assumes that the known-bad commands is comprehensive and that I'm being
> > creative enough in ways that users could try to break things.
> >
> >
> >
> > Is there a good way to sanitize arbitrary code from users to prevent
> > malicious behavior?
> >
> >
> > Thanks,
> >
> >
> >
> > Bill
> >
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>
>

	[[alternative HTML version deleted]]


From m@tth|@@-gond@n @end|ng |rom gmx@de  Wed Mar  1 07:35:22 2023
From: m@tth|@@-gond@n @end|ng |rom gmx@de (Matthias Gondan)
Date: Wed, 1 Mar 2023 07:35:22 +0100
Subject: [R-pkg-devel] Sanitize Input Code for a Shiny App
In-Reply-To: <CADxuEGqNjs0ha4c=X8m2RW_uL5edAOgh4tQfgYACf+vR+EA8NQ@mail.gmail.com>
References: <013901d94a19$9b8569f0$d2903dd0$@denney.ws>
 <D65C46C3-A4B7-4358-A8EC-CD5DBA3B7028@R-project.org>
 <CADxuEGqNjs0ha4c=X8m2RW_uL5edAOgh4tQfgYACf+vR+EA8NQ@mail.gmail.com>
Message-ID: <5EBA5FCF-ACB6-4041-84B9-86C8826C8348@gmx.de>

For the record, here's the documentation of the Prolog sandbox,

https://www.swi-prolog.org/pldoc/doc/_SWI_/library/sandbox.pl

You get an idea of the implementation by clicking at the ":-" icons. It does not seem too complicated, but I might be too optimistic. It would be very nice to have such a thing in R, and I would be willing to help if someone takes the lead.

Best regards,

Matthias

> Am 01.03.2023 um 01:52 schrieb Bill Denney <bill at denney.ws>:
> 
> Hi Simon and Ivan,
> 
> Thanks for confirming my suspicions.  The most common case for our code
> would be generally trusted users within an organization.  So, the main
> threat is lower.  But, there may be scenarios that also allow use outside
> organizations.
> 
> I think that in the end, we will likely do some minimal sanitization of the
> input, but then we will also ensure that we do anything in a container with
> limits applied from the outside, too.
> 
> Thanks,
> 
> Bill
> 
> On Sun, Feb 26, 2023, 4:57 PM Simon Urbanek <simon.urbanek at r-project.org>
> wrote:
> 
>> Bill,
>> 
>> the short answer is you can't limit anything at R level. Any attempts to
>> create a list of "bad" commands are trivial to circumvent since you can
>> compute on the language in R, so you can construct and call functions with
>> trivial operations. Similarly, since R allows the loading of binary code
>> the same applies for arbitrary code. So if you give users access to R, you
>> should assume that is equivalent to allowing arbitrary code execution.
>> Therefore all you can do is limit the resources and reach - as you pointed
>> out using a container is a good idea so each session is only limited to a
>> single container that goes away when the session ends. Similarly you can
>> restrict main parts of R and the system to be read-only in the container.
>> 
>> In practice, that's why real analytic systems are about provenance rather
>> than prevention. For example, in RCloud all code is first committed to a
>> git repository outside of the container before it can be executed, so
>> malicious users can do whatever they want, but they cannot hide the
>> malicious code they used as the container cannot manipulate the history.
>> 
>> As for package installation - again, it's impossible to prevent it in
>> general unless you make everything read-only which also prevents the users
>> from doing meaningful work. So the real question what do you want to allow

	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Wed Mar  1 09:01:26 2023
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Wed, 1 Mar 2023 09:01:26 +0100
Subject: [R-pkg-devel] Sanitize Input Code for a Shiny App
In-Reply-To: <5EBA5FCF-ACB6-4041-84B9-86C8826C8348@gmx.de>
References: <013901d94a19$9b8569f0$d2903dd0$@denney.ws>
 <D65C46C3-A4B7-4358-A8EC-CD5DBA3B7028@R-project.org>
 <CADxuEGqNjs0ha4c=X8m2RW_uL5edAOgh4tQfgYACf+vR+EA8NQ@mail.gmail.com>
 <5EBA5FCF-ACB6-4041-84B9-86C8826C8348@gmx.de>
Message-ID: <f5e8aeb1-a9ad-fdc6-d7fd-10141ba2aabf@gmail.com>


On 3/1/23 07:35, Matthias Gondan wrote:
> For the record, here's the documentation of the Prolog sandbox,
>
> https://www.swi-prolog.org/pldoc/doc/_SWI_/library/sandbox.pl
>
> You get an idea of the implementation by clicking at the ":-" icons. It does not seem too complicated, but I might be too optimistic. It would be very nice to have such a thing in R, and I would be willing to help if someone takes the lead.

 From my (very quick) look at the page, my understanding is that it is 
analyzing Prolog code to decide whether it is safe to execute or not. If 
my reading is correct, please let me reiterate that this would not be a 
good strategy for R. As Simon already wrote, R is a very dynamic 
language allowing to change almost anything at runtime. It is not 
possible to correctly and effectively reason about what an R program 
could do. Trying to do this would be a waste of effort which might only 
provide false sense of security. R cannot be made safe for such uses 
this way. While enough as a show stopper, it is more than that, R 
doesn't have a specification, any such tools would have to be written 
against a specific R release. Also, in practice one would probably also 
want to use some extension packages, which may again do anything (in 
native code).

With R, I would only think of ensuring security at the machine level, as 
discussed already - via virtual machines, containers (with care, not all 
are sandboxes), etc. That would be much safer, much less work, and could 
re-use existing technologies.

Tomas


>
> Best regards,
>
> Matthias
>
>> Am 01.03.2023 um 01:52 schrieb Bill Denney <bill at denney.ws>:
>>
>> Hi Simon and Ivan,
>>
>> Thanks for confirming my suspicions.  The most common case for our code
>> would be generally trusted users within an organization.  So, the main
>> threat is lower.  But, there may be scenarios that also allow use outside
>> organizations.
>>
>> I think that in the end, we will likely do some minimal sanitization of the
>> input, but then we will also ensure that we do anything in a container with
>> limits applied from the outside, too.
>>
>> Thanks,
>>
>> Bill
>>
>> On Sun, Feb 26, 2023, 4:57 PM Simon Urbanek <simon.urbanek at r-project.org>
>> wrote:
>>
>>> Bill,
>>>
>>> the short answer is you can't limit anything at R level. Any attempts to
>>> create a list of "bad" commands are trivial to circumvent since you can
>>> compute on the language in R, so you can construct and call functions with
>>> trivial operations. Similarly, since R allows the loading of binary code
>>> the same applies for arbitrary code. So if you give users access to R, you
>>> should assume that is equivalent to allowing arbitrary code execution.
>>> Therefore all you can do is limit the resources and reach - as you pointed
>>> out using a container is a good idea so each session is only limited to a
>>> single container that goes away when the session ends. Similarly you can
>>> restrict main parts of R and the system to be read-only in the container.
>>>
>>> In practice, that's why real analytic systems are about provenance rather
>>> than prevention. For example, in RCloud all code is first committed to a
>>> git repository outside of the container before it can be executed, so
>>> malicious users can do whatever they want, but they cannot hide the
>>> malicious code they used as the container cannot manipulate the history.
>>>
>>> As for package installation - again, it's impossible to prevent it in
>>> general unless you make everything read-only which also prevents the users
>>> from doing meaningful work. So the real question what do you want to allow
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From m@tth|@@-gond@n @end|ng |rom gmx@de  Wed Mar  1 09:14:49 2023
From: m@tth|@@-gond@n @end|ng |rom gmx@de (Matthias Gondan)
Date: Wed, 1 Mar 2023 09:14:49 +0100
Subject: [R-pkg-devel] Sanitize Input Code for a Shiny App
In-Reply-To: <f5e8aeb1-a9ad-fdc6-d7fd-10141ba2aabf@gmail.com>
References: <013901d94a19$9b8569f0$d2903dd0$@denney.ws>
 <D65C46C3-A4B7-4358-A8EC-CD5DBA3B7028@R-project.org>
 <CADxuEGqNjs0ha4c=X8m2RW_uL5edAOgh4tQfgYACf+vR+EA8NQ@mail.gmail.com>
 <5EBA5FCF-ACB6-4041-84B9-86C8826C8348@gmx.de>
 <f5e8aeb1-a9ad-fdc6-d7fd-10141ba2aabf@gmail.com>
Message-ID: <1MCbIn-1pNh5X21D9-009e3q@mail.gmx.net>

Dear Tomas,

thank you, I understand. The thing I was wondering about, and sorry for being persistent: Prolog is basically the same, it is similarly dynamic, and anything can be changed at runtime (well, unsure if I can redefine pi in Prolog ?), and still they run a ?swish? server (swish.swi-prolog.org), based on a list of allowed predicates considered to be safe. Of course, this generalization may a bit superficial, and something similar for R would probably boil down to a rather restricted set of functions (e.g., quite limited support for ?apply? and friends, no packages).

I?ll think about it and I?ll come back if I happen to put together a proof of concept.

Best wishes,

Matthias


Von: Tomas Kalibera
Gesendet: Mittwoch, 1. M?rz 2023 09:01
An: Matthias Gondan; Bill Denney
Cc: R Package Devel
Betreff: Re: [R-pkg-devel] Sanitize Input Code for a Shiny App


On 3/1/23 07:35, Matthias Gondan wrote:
> For the record, here's the documentation of the Prolog sandbox,
>
> https://www.swi-prolog.org/pldoc/doc/_SWI_/library/sandbox.pl
>
> You get an idea of the implementation by clicking at the ":-" icons. It does not seem too complicated, but I might be too optimistic. It would be very nice to have such a thing in R, and I would be willing to help if someone takes the lead.

 From my (very quick) look at the page, my understanding is that it is 
analyzing Prolog code to decide whether it is safe to execute or not. If 
my reading is correct, please let me reiterate that this would not be a 
good strategy for R. As Simon already wrote, R is a very dynamic 
language allowing to change almost anything at runtime. It is not 
possible to correctly and effectively reason about what an R program 
could do. Trying to do this would be a waste of effort which might only 
provide false sense of security. R cannot be made safe for such uses 
this way. While enough as a show stopper, it is more than that, R 
doesn't have a specification, any such tools would have to be written 
against a specific R release. Also, in practice one would probably also 
want to use some extension packages, which may again do anything (in 
native code).

With R, I would only think of ensuring security at the machine level, as 
discussed already - via virtual machines, containers (with care, not all 
are sandboxes), etc. That would be much safer, much less work, and could 
re-use existing technologies.

Tomas


>
> Best regards,
>
> Matthias
>
>> Am 01.03.2023 um 01:52 schrieb Bill Denney <bill at denney.ws>:
>>
>> Hi Simon and Ivan,
>>
>> Thanks for confirming my suspicions.  The most common case for our code
>> would be generally trusted users within an organization.  So, the main
>> threat is lower.  But, there may be scenarios that also allow use outside
>> organizations.
>>
>> I think that in the end, we will likely do some minimal sanitization of the
>> input, but then we will also ensure that we do anything in a container with
>> limits applied from the outside, too.
>>
>> Thanks,
>>
>> Bill
>>
>> On Sun, Feb 26, 2023, 4:57 PM Simon Urbanek <simon.urbanek at r-project.org>
>> wrote:
>>
>>> Bill,
>>>
>>> the short answer is you can't limit anything at R level. Any attempts to
>>> create a list of "bad" commands are trivial to circumvent since you can
>>> compute on the language in R, so you can construct and call functions with
>>> trivial operations. Similarly, since R allows the loading of binary code
>>> the same applies for arbitrary code. So if you give users access to R, you
>>> should assume that is equivalent to allowing arbitrary code execution.
>>> Therefore all you can do is limit the resources and reach - as you pointed
>>> out using a container is a good idea so each session is only limited to a
>>> single container that goes away when the session ends. Similarly you can
>>> restrict main parts of R and the system to be read-only in the container.
>>>
>>> In practice, that's why real analytic systems are about provenance rather
>>> than prevention. For example, in RCloud all code is first committed to a
>>> git repository outside of the container before it can be executed, so
>>> malicious users can do whatever they want, but they cannot hide the
>>> malicious code they used as the container cannot manipulate the history.
>>>
>>> As for package installation - again, it's impossible to prevent it in
>>> general unless you make everything read-only which also prevents the users
>>> from doing meaningful work. So the real question what do you want to allow
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Wed Mar  8 19:13:50 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 8 Mar 2023 13:13:50 -0500
Subject: [R-pkg-devel] FAIL output in CRAN checks?
In-Reply-To: <mailman.8951.181.1678299121.1527.r-package-devel@r-project.org>
References: <mailman.8951.181.1678299121.1527.r-package-devel@r-project.org>
Message-ID: <7b44a9a8-9206-3b34-0043-ac450eb5be2a@gmail.com>


 ? I don't know that I've ever seen this one before: a result of FAIL 
for a CRAN check.

 ? There's a WARNING which I already know about, but this build seems to 
get hung up on "checking re-building of vignette outputs ..." (which 
takes about 70/95 seconds on most other platforms)

https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-fedora-clang/lme4-00check.html 


 ? Does anyone have ideas about this? Is this something I should worry 
about/try to diagnose and fix?? (r-hub does appear to have a 
fedora/clang platform)

 ? For what it's worth:

 > rhub::platforms()
Error in curl::curl_fetch_memory(url, handle = handle) :
 ? Peer certificate cannot be authenticated with given CA certificates: 
[builder.r-hub.io] SSL certificate problem: certificate has expired

 ? I guess I could report that ...


 ? cheers

 ?? Ben Bolker


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Thu Mar  9 11:37:38 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Thu, 9 Mar 2023 11:37:38 +0100
Subject: [R-pkg-devel] FAIL output in CRAN checks?
In-Reply-To: <7b44a9a8-9206-3b34-0043-ac450eb5be2a@gmail.com>
References: <mailman.8951.181.1678299121.1527.r-package-devel@r-project.org>
 <7b44a9a8-9206-3b34-0043-ac450eb5be2a@gmail.com>
Message-ID: <21bc3931-6810-2405-9688-519ceb6c901c@statistik.tu-dortmund.de>



On 08.03.2023 19:13, Ben Bolker wrote:
> 
>  ? I don't know that I've ever seen this one before: a result of FAIL 
> for a CRAN check.
> 
>  ? There's a WARNING which I already know about, but this build seems to 
> get hung up on "checking re-building of vignette outputs ..." (which 
> takes about 70/95 seconds on most other platforms)
> 
> https://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-fedora-clang/lme4-00check.html

Not shown anymore, I guess ome hicc up on the check machine.
Or in case you download data some internet access issue?

Best,
Uwe Ligges



>  ? Does anyone have ideas about this? Is this something I should worry 
> about/try to diagnose and fix?? (r-hub does appear to have a 
> fedora/clang platform)
> 
>  ? For what it's worth:
> 
>  > rhub::platforms()
> Error in curl::curl_fetch_memory(url, handle = handle) :
>  ? Peer certificate cannot be authenticated with given CA certificates: 
> [builder.r-hub.io] SSL certificate problem: certificate has expired
> 
>  ? I guess I could report that ...
 >
  >
>  ? cheers
> 
>  ?? Ben Bolker
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Mar 12 12:33:38 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 12 Mar 2023 07:33:38 -0400
Subject: [R-pkg-devel] Tools for reducing dependencies?
Message-ID: <8055110c-82e9-4b58-3a29-2efed0a61f8a@gmail.com>

The rgl package has a really large number of dependencies, especially if 
I include soft (Suggested) dependencies.  It would be nice to reduce 
that number.

To do that, I can imagine a tool that gives the following information:

  - For each export from rgl, which dependencies are needed?

  - For each dependency, which exports are supported?

  - Are there other ways to get the same support with fewer 
dependencies? E.g. if rgl used devtools::install_github, it could be 
replaced with remotes::install_github.

Does a tool already exist that addresses these questions?

Duncan Murdoch


From jo@h@m@u|r|ch @end|ng |rom gm@||@com  Sun Mar 12 21:14:03 2023
From: jo@h@m@u|r|ch @end|ng |rom gm@||@com (Joshua Ulrich)
Date: Sun, 12 Mar 2023 15:14:03 -0500
Subject: [R-pkg-devel] Tools for reducing dependencies?
In-Reply-To: <8055110c-82e9-4b58-3a29-2efed0a61f8a@gmail.com>
References: <8055110c-82e9-4b58-3a29-2efed0a61f8a@gmail.com>
Message-ID: <CAPPM_gS_7yZYUfYAVMy0+YijsVGDCdMNzg_+rSsz0dmnm7j9wg@mail.gmail.com>

Hi Duncan,

On Sun, Mar 12, 2023 at 6:34?AM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> The rgl package has a really large number of dependencies, especially if
> I include soft (Suggested) dependencies.  It would be nice to reduce
> that number.
>
> To do that, I can imagine a tool that gives the following information:
>
>   - For each export from rgl, which dependencies are needed?
>
>   - For each dependency, which exports are supported?
>
>   - Are there other ways to get the same support with fewer
> dependencies? E.g. if rgl used devtools::install_github, it could be
> replaced with remotes::install_github.
>
> Does a tool already exist that addresses these questions?
>
I've never used it, but there's some relevant functionality in
https://github.com/r-lib/itdepends

Best,
Josh

> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


From |n|o @end|ng |rom b|@ck-@now@net  Sun Mar 12 21:20:14 2023
From: |n|o @end|ng |rom b|@ck-@now@net (Ronald Bergmann)
Date: Sun, 12 Mar 2023 21:20:14 +0100 (CET)
Subject: [R-pkg-devel] First CRAN submission - quick feedback
Message-ID: <1841500546.5778.1678652414953@ud-mail.de>

Hi r-package-devel,

we'll soon make our first submission to CRAN (hopefully). While there's still stuff to do* and while we're waiting for an update to one of the dependencies I'd kindly like to ask if anyone would mind taking a quick look at the repository to assess if the overall structure seems fine.

Here's the repo: https://github.com/haganjam/FW_invert_biomass_allometry

One thing is that the package requires a couple of database files, which are about 20 MB in size and rather growing than shrinking. A standalone data package didn't seem like a good solution to me, so I added a zzz.R file to load the required files on install time (well, initialization / load time, it is). Makes sense to me but I don't know if this will be fine with CRAN.

Thanks a lot in advance and have a great week!
Cheers


* pipelines are pretty much copypasta and failing
* waiting for fixes in one of the dependencies
* tests need some love
* still gotta test file path resolution / whether to drop here


From zk@mv@r @end|ng |rom gm@||@com  Sun Mar 12 21:33:14 2023
From: zk@mv@r @end|ng |rom gm@||@com (Zhian Kamvar)
Date: Sun, 12 Mar 2023 13:33:14 -0700
Subject: [R-pkg-devel] First CRAN submission - quick feedback
In-Reply-To: <1841500546.5778.1678652414953@ud-mail.de>
References: <1841500546.5778.1678652414953@ud-mail.de>
Message-ID: <CAPsXksL0wok6B5R3iVRoz1uZjepHHz+Amw3S4C-s29mdrcZaPw@mail.gmail.com>

Generally you will want to use an application directory for storing these
files (a la rappdirs) and, importantly, allow the user to consent to these
files being downloaded and installed, which should not be done on load.


On Sun, Mar 12, 2023 at 13:24 Ronald Bergmann <info at black-snow.net> wrote:

> Hi r-package-devel,
>
> we'll soon make our first submission to CRAN (hopefully). While there's
> still stuff to do* and while we're waiting for an update to one of the
> dependencies I'd kindly like to ask if anyone would mind taking a quick
> look at the repository to assess if the overall structure seems fine.
>
> Here's the repo: https://github.com/haganjam/FW_invert_biomass_allometry
>
> One thing is that the package requires a couple of database files, which
> are about 20 MB in size and rather growing than shrinking. A standalone
> data package didn't seem like a good solution to me, so I added a zzz.R
> file to load the required files on install time (well, initialization /
> load time, it is). Makes sense to me but I don't know if this will be fine
> with CRAN.
>
> Thanks a lot in advance and have a great week!
> Cheers
>
>
> * pipelines are pretty much copypasta and failing
> * waiting for fixes in one of the dependencies
> * tests need some love
> * still gotta test file path resolution / whether to drop here
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From Qu|r|n_St|er @end|ng |rom gmx@de  Mon Mar 13 11:43:03 2023
From: Qu|r|n_St|er @end|ng |rom gmx@de (quirin stier)
Date: Mon, 13 Mar 2023 11:43:03 +0100
Subject: [R-pkg-devel] OpenCL R packages on CRAN
Message-ID: <79b5d7f3-1629-a5c4-367c-bfe2be79c7ca@gmx.de>

Hi,

I would like to ask what the current situation is regarding R packages
for computations on the GPU. There are no more official CRAN packages
using CUDA or OpenCL as foundation. There are only packages providing
either access to OpenCL, tensorflow or similar and packages using
directives in C++ via OpenMP.

My aim is to provide an R package using OpenCL. However, as far as I
know, such package would not run in Windows. Does CRAN accept packages
which are not compatible with every os?

Best regards


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon Mar 13 12:25:16 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 13 Mar 2023 12:25:16 +0100
Subject: [R-pkg-devel] OpenCL R packages on CRAN
In-Reply-To: <79b5d7f3-1629-a5c4-367c-bfe2be79c7ca@gmx.de>
References: <79b5d7f3-1629-a5c4-367c-bfe2be79c7ca@gmx.de>
Message-ID: <85fc4e20-5b21-8b9b-82c3-2cf8c2aab064@statistik.tu-dortmund.de>



On 13.03.2023 11:43, quirin stier wrote:
> Hi,
> 
> I would like to ask what the current situation is regarding R packages
> for computations on the GPU. There are no more official CRAN packages
> using CUDA or OpenCL as foundation. There are only packages providing
> either access to OpenCL, tensorflow or similar and packages using
> directives in C++ via OpenMP.
> 
> My aim is to provide an R package using OpenCL. However, as far as I
> know, such package would not run in Windows. Does CRAN accept packages
> which are not compatible with every os?

CRAN asks for cross plattform code if possible. In some situations where 
it is not possible to provide cross plattform code, CRAN also accepts 
code that works for many (but not all) plattforms.

OpenCL and Windows: Why would a package using OpenCL not work on Windows?
We may have difficulties providimg binaries of the package (and checking 
it) as corresponding graphics hardware is not available on the 
build/check machines, but if possible you shopudl support that users 
with the required hardware can compile the package from sources on 
Windows, too.

Best,
Uwe Ligges


From er|nm@hodge@@ @end|ng |rom gm@||@com  Mon Mar 13 12:41:49 2023
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Mon, 13 Mar 2023 05:41:49 -0600
Subject: [R-pkg-devel] OpenCL R packages on CRAN
In-Reply-To: <85fc4e20-5b21-8b9b-82c3-2cf8c2aab064@statistik.tu-dortmund.de>
References: <79b5d7f3-1629-a5c4-367c-bfe2be79c7ca@gmx.de>
 <85fc4e20-5b21-8b9b-82c3-2cf8c2aab064@statistik.tu-dortmund.de>
Message-ID: <CACxE24kFMuJi70Qt5Zx56FbYy3R4VSo56hGcrL6sy0oVjBPwNQ@mail.gmail.com>

Hello!

What about using WSL on Windows, please?  Would that help?

Thank you,
Sincerely,
Erin


On Mon, Mar 13, 2023 at 5:25 AM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

>
>
> On 13.03.2023 11:43, quirin stier wrote:
> > Hi,
> >
> > I would like to ask what the current situation is regarding R packages
> > for computations on the GPU. There are no more official CRAN packages
> > using CUDA or OpenCL as foundation. There are only packages providing
> > either access to OpenCL, tensorflow or similar and packages using
> > directives in C++ via OpenMP.
> >
> > My aim is to provide an R package using OpenCL. However, as far as I
> > know, such package would not run in Windows. Does CRAN accept packages
> > which are not compatible with every os?
>
> CRAN asks for cross plattform code if possible. In some situations where
> it is not possible to provide cross plattform code, CRAN also accepts
> code that works for many (but not all) plattforms.
>
> OpenCL and Windows: Why would a package using OpenCL not work on Windows?
> We may have difficulties providimg binaries of the package (and checking
> it) as corresponding graphics hardware is not available on the
> build/check machines, but if possible you shopudl support that users
> with the required hardware can compile the package from sources on
> Windows, too.
>
> Best,
> Uwe Ligges
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
-- 
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Mon Mar 13 15:28:13 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Mon, 13 Mar 2023 10:28:13 -0400
Subject: [R-pkg-devel] URL timeout in win-builder check: suggestions?
Message-ID: <f8d2b57d-8f4b-b9d8-f15c-d32425569508@gmail.com>


   I have a URL in my documentation that got a timeout error from 
win-builder, possibly because of some kind of service provider filtering 
of bots (I think there was a previous issue with Cloudflare links?)

   I can get to it fine interactively/in a browser.

   This link is a harmless bit of fluff (click through if you want to 
see), but I don't want it causing hiccups in my CRAN submission (i.e., I 
could take it out if necessary but would prefer not to ...)

     Suggestions?

===
* checking CRAN incoming feasibility ... NOTE
Maintainer: 'Ben Bolker <bbolker+lme4 at gmail.com>'

Found the following (possibly) invalid URLs:
   URL: https://phdcomics.com/comics/archive.php?comicid=905
     From: man/pvalues.Rd
     Status: Error
     Message: Operation timed out after 60010 milliseconds with 0 bytes 
received


From kry|ov@r00t @end|ng |rom gm@||@com  Mon Mar 13 15:39:52 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Mon, 13 Mar 2023 17:39:52 +0300
Subject: [R-pkg-devel] URL timeout in win-builder check: suggestions?
In-Reply-To: <f8d2b57d-8f4b-b9d8-f15c-d32425569508@gmail.com>
References: <f8d2b57d-8f4b-b9d8-f15c-d32425569508@gmail.com>
Message-ID: <20230313173952.37d19331@arachnoid>

? Mon, 13 Mar 2023 10:28:13 -0400
Ben Bolker <bbolker at gmail.com> ?????:

> Found the following (possibly) invalid URLs:
>    URL: https://phdcomics.com/comics/archive.php?comicid=905
>      From: man/pvalues.Rd
>      Status: Error
>      Message: Operation timed out after 60010 milliseconds with 0
> bytes received

Does it happen all the time? I used to binge-read PhD Comics, and they
timed out on me from time to time, but then worked again. Currently, I
can access this URL with a HEAD request using cURL over Tor, which
should have raised a lot of red flags if they were using a bot detector.

-- 
Best regards,
Ivan


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon Mar 13 15:45:27 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 13 Mar 2023 15:45:27 +0100
Subject: [R-pkg-devel] URL timeout in win-builder check: suggestions?
In-Reply-To: <f8d2b57d-8f4b-b9d8-f15c-d32425569508@gmail.com>
References: <f8d2b57d-8f4b-b9d8-f15c-d32425569508@gmail.com>
Message-ID: <b8d7d223-78fe-fe0f-2830-503d5765c7ac@statistik.tu-dortmund.de>



On 13.03.2023 15:28, Ben Bolker wrote:
> 
>  ? I have a URL in my documentation that got a timeout error from 
> win-builder, possibly because of some kind of service provider filtering 
> of bots (I think there was a previous issue with Cloudflare links?)
> 
>  ? I can get to it fine interactively/in a browser.
> 
>  ? This link is a harmless bit of fluff (click through if you want to 
> see), but I don't want it causing hiccups in my CRAN submission (i.e., I 
> could take it out if necessary but would prefer not to ...)
> 
>  ??? Suggestions?

Keep and submit.

Best,
Uwe Ligges


> ===
> * checking CRAN incoming feasibility ... NOTE
> Maintainer: 'Ben Bolker <bbolker+lme4 at gmail.com>'
> 
> Found the following (possibly) invalid URLs:
>  ? URL: https://phdcomics.com/comics/archive.php?comicid=905
>  ??? From: man/pvalues.Rd
>  ??? Status: Error
>  ??? Message: Operation timed out after 60010 milliseconds with 0 bytes 
> received
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


